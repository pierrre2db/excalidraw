var zZ=Object.defineProperty;var HZ=(e,t,n)=>t in e?zZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var F=(e,t,n)=>(HZ(e,typeof t!="symbol"?t+"":t,n),n);function VZ(e,t){for(var n=0;n<t.length;n++){const i=t[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in e)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(e,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var Fa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wl(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var DN={exports:{}},A5={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $Z=Symbol.for("react.transitional.element"),GZ=Symbol.for("react.fragment");function LN(e,t,n){var i=null;if(n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),"key"in t){n={};for(var r in t)r!=="key"&&(n[r]=t[r])}else n=t;return t=n.ref,{$$typeof:$Z,type:e,key:i,ref:t!==void 0?t:null,props:n}}A5.Fragment=GZ;A5.jsx=LN;A5.jsxs=LN;DN.exports=A5;var _w=DN.exports;const fe=_w.Fragment,g=_w.jsx,N=_w.jsxs;var NN={exports:{}},Ke={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tw=Symbol.for("react.transitional.element"),XZ=Symbol.for("react.portal"),jZ=Symbol.for("react.fragment"),YZ=Symbol.for("react.strict_mode"),WZ=Symbol.for("react.profiler"),KZ=Symbol.for("react.consumer"),ZZ=Symbol.for("react.context"),qZ=Symbol.for("react.forward_ref"),QZ=Symbol.for("react.suspense"),JZ=Symbol.for("react.memo"),ON=Symbol.for("react.lazy"),cx=Symbol.iterator;function eq(e){return e===null||typeof e!="object"?null:(e=cx&&e[cx]||e["@@iterator"],typeof e=="function"?e:null)}var PN={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},FN=Object.assign,BN={};function fg(e,t,n){this.props=e,this.context=t,this.refs=BN,this.updater=n||PN}fg.prototype.isReactComponent={};fg.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};fg.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function zN(){}zN.prototype=fg.prototype;function Iw(e,t,n){this.props=e,this.context=t,this.refs=BN,this.updater=n||PN}var Sw=Iw.prototype=new zN;Sw.constructor=Iw;FN(Sw,fg.prototype);Sw.isPureReactComponent=!0;var dx=Array.isArray,Un={H:null,A:null,T:null,S:null},HN=Object.prototype.hasOwnProperty;function xw(e,t,n,i,r,s){return n=s.ref,{$$typeof:Tw,type:e,key:t,ref:n!==void 0?n:null,props:s}}function tq(e,t){return xw(e.type,t,void 0,void 0,void 0,e.props)}function Cw(e){return typeof e=="object"&&e!==null&&e.$$typeof===Tw}function nq(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var ux=/\/+/g;function HE(e,t){return typeof e=="object"&&e!==null&&e.key!=null?nq(""+e.key):t.toString(36)}function fx(){}function iq(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch(typeof e.status=="string"?e.then(fx,fx):(e.status="pending",e.then(function(t){e.status==="pending"&&(e.status="fulfilled",e.value=t)},function(t){e.status==="pending"&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}function bf(e,t,n,i,r){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"bigint":case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Tw:case XZ:o=!0;break;case ON:return o=e._init,bf(o(e._payload),t,n,i,r)}}if(o)return r=r(e),o=i===""?"."+HE(e,0):i,dx(r)?(n="",o!=null&&(n=o.replace(ux,"$&/")+"/"),bf(r,t,n,"",function(c){return c})):r!=null&&(Cw(r)&&(r=tq(r,n+(r.key==null||e&&e.key===r.key?"":(""+r.key).replace(ux,"$&/")+"/")+o)),t.push(r)),1;o=0;var a=i===""?".":i+":";if(dx(e))for(var l=0;l<e.length;l++)i=e[l],s=a+HE(i,l),o+=bf(i,t,n,s,r);else if(l=eq(e),typeof l=="function")for(e=l.call(e),l=0;!(i=e.next()).done;)i=i.value,s=a+HE(i,l++),o+=bf(i,t,n,s,r);else if(s==="object"){if(typeof e.then=="function")return bf(iq(e),t,n,i,r);throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return o}function gU(e,t,n){if(e==null)return e;var i=[],r=0;return bf(e,i,"","",function(s){return t.call(n,s,r++)}),i}function rq(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var hx=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function sq(){}Ke.Children={map:gU,forEach:function(e,t,n){gU(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return gU(e,function(){t++}),t},toArray:function(e){return gU(e,function(t){return t})||[]},only:function(e){if(!Cw(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ke.Component=fg;Ke.Fragment=jZ;Ke.Profiler=WZ;Ke.PureComponent=Iw;Ke.StrictMode=YZ;Ke.Suspense=QZ;Ke.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Un;Ke.act=function(){throw Error("act(...) is not supported in production builds of React.")};Ke.cache=function(e){return function(){return e.apply(null,arguments)}};Ke.cloneElement=function(e,t,n){if(e==null)throw Error("The argument must be a React element, but you passed "+e+".");var i=FN({},e.props),r=e.key,s=void 0;if(t!=null)for(o in t.ref!==void 0&&(s=void 0),t.key!==void 0&&(r=""+t.key),t)!HN.call(t,o)||o==="key"||o==="__self"||o==="__source"||o==="ref"&&t.ref===void 0||(i[o]=t[o]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var a=Array(o),l=0;l<o;l++)a[l]=arguments[l+2];i.children=a}return xw(e.type,r,void 0,void 0,s,i)};Ke.createContext=function(e){return e={$$typeof:ZZ,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider=e,e.Consumer={$$typeof:KZ,_context:e},e};Ke.createElement=function(e,t,n){var i,r={},s=null;if(t!=null)for(i in t.key!==void 0&&(s=""+t.key),t)HN.call(t,i)&&i!=="key"&&i!=="__self"&&i!=="__source"&&(r[i]=t[i]);var o=arguments.length-2;if(o===1)r.children=n;else if(1<o){for(var a=Array(o),l=0;l<o;l++)a[l]=arguments[l+2];r.children=a}if(e&&e.defaultProps)for(i in o=e.defaultProps,o)r[i]===void 0&&(r[i]=o[i]);return xw(e,s,void 0,void 0,null,r)};Ke.createRef=function(){return{current:null}};Ke.forwardRef=function(e){return{$$typeof:qZ,render:e}};Ke.isValidElement=Cw;Ke.lazy=function(e){return{$$typeof:ON,_payload:{_status:-1,_result:e},_init:rq}};Ke.memo=function(e,t){return{$$typeof:JZ,type:e,compare:t===void 0?null:t}};Ke.startTransition=function(e){var t=Un.T,n={};Un.T=n;try{var i=e(),r=Un.S;r!==null&&r(n,i),typeof i=="object"&&i!==null&&typeof i.then=="function"&&i.then(sq,hx)}catch(s){hx(s)}finally{Un.T=t}};Ke.unstable_useCacheRefresh=function(){return Un.H.useCacheRefresh()};Ke.use=function(e){return Un.H.use(e)};Ke.useActionState=function(e,t,n){return Un.H.useActionState(e,t,n)};Ke.useCallback=function(e,t){return Un.H.useCallback(e,t)};Ke.useContext=function(e){return Un.H.useContext(e)};Ke.useDebugValue=function(){};Ke.useDeferredValue=function(e,t){return Un.H.useDeferredValue(e,t)};Ke.useEffect=function(e,t){return Un.H.useEffect(e,t)};Ke.useId=function(){return Un.H.useId()};Ke.useImperativeHandle=function(e,t,n){return Un.H.useImperativeHandle(e,t,n)};Ke.useInsertionEffect=function(e,t){return Un.H.useInsertionEffect(e,t)};Ke.useLayoutEffect=function(e,t){return Un.H.useLayoutEffect(e,t)};Ke.useMemo=function(e,t){return Un.H.useMemo(e,t)};Ke.useOptimistic=function(e,t){return Un.H.useOptimistic(e,t)};Ke.useReducer=function(e,t,n){return Un.H.useReducer(e,t,n)};Ke.useRef=function(e){return Un.H.useRef(e)};Ke.useState=function(e){return Un.H.useState(e)};Ke.useSyncExternalStore=function(e,t,n){return Un.H.useSyncExternalStore(e,t,n)};Ke.useTransition=function(){return Un.H.useTransition()};Ke.version="19.0.0";NN.exports=Ke;var R=NN.exports;const de=wl(R),oq=VZ({__proto__:null,default:de},[R]);var VN={exports:{}},M5={},$N={exports:{}},GN={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(H,z){var G=H.length;H.push(z);e:for(;0<G;){var j=G-1>>>1,X=H[j];if(0<r(X,z))H[j]=z,H[G]=X,G=j;else break e}}function n(H){return H.length===0?null:H[0]}function i(H){if(H.length===0)return null;var z=H[0],G=H.pop();if(G!==z){H[0]=G;e:for(var j=0,X=H.length,K=X>>>1;j<K;){var ne=2*(j+1)-1,se=H[ne],oe=ne+1,Ee=H[oe];if(0>r(se,G))oe<X&&0>r(Ee,se)?(H[j]=Ee,H[oe]=G,j=oe):(H[j]=se,H[ne]=G,j=ne);else if(oe<X&&0>r(Ee,G))H[j]=Ee,H[oe]=G,j=oe;else break e}}return z}function r(H,z){var G=H.sortIndex-z.sortIndex;return G!==0?G:H.id-z.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],c=[],d=1,u=null,f=3,h=!1,m=!1,p=!1,U=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;function w(H){for(var z=n(c);z!==null;){if(z.callback===null)i(c);else if(z.startTime<=H)i(c),z.sortIndex=z.expirationTime,t(l,z);else break;z=n(c)}}function v(H){if(p=!1,w(H),!m)if(n(l)!==null)m=!0,Y();else{var z=n(c);z!==null&&$(v,z.startTime-H)}}var I=!1,C=-1,_=5,T=-1;function k(){return!(e.unstable_now()-T<_)}function x(){if(I){var H=e.unstable_now();T=H;var z=!0;try{e:{m=!1,p&&(p=!1,b(C),C=-1),h=!0;var G=f;try{t:{for(w(H),u=n(l);u!==null&&!(u.expirationTime>H&&k());){var j=u.callback;if(typeof j=="function"){u.callback=null,f=u.priorityLevel;var X=j(u.expirationTime<=H);if(H=e.unstable_now(),typeof X=="function"){u.callback=X,w(H),z=!0;break t}u===n(l)&&i(l),w(H)}else i(l);u=n(l)}if(u!==null)z=!0;else{var K=n(c);K!==null&&$(v,K.startTime-H),z=!1}}break e}finally{u=null,f=G,h=!1}z=void 0}}finally{z?D():I=!1}}}var D;if(typeof y=="function")D=function(){y(x)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,L=O.port2;O.port1.onmessage=x,D=function(){L.postMessage(null)}}else D=function(){U(x,0)};function Y(){I||(I=!0,D())}function $(H,z){C=U(function(){H(e.unstable_now())},z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(H){H.callback=null},e.unstable_continueExecution=function(){m||h||(m=!0,Y())},e.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<H?Math.floor(1e3/H):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(H){switch(f){case 1:case 2:case 3:var z=3;break;default:z=f}var G=f;f=z;try{return H()}finally{f=G}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(H,z){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var G=f;f=H;try{return z()}finally{f=G}},e.unstable_scheduleCallback=function(H,z,G){var j=e.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?j+G:j):G=j,H){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=G+X,H={id:d++,callback:z,priorityLevel:H,startTime:G,expirationTime:X,sortIndex:-1},G>j?(H.sortIndex=G,t(c,H),n(l)===null&&H===n(c)&&(p?(b(C),C=-1):p=!0,$(v,G-j))):(H.sortIndex=X,t(l,H),m||h||(m=!0,Y())),H},e.unstable_shouldYield=k,e.unstable_wrapCallback=function(H){var z=f;return function(){var G=f;f=z;try{return H.apply(this,arguments)}finally{f=G}}}})(GN);$N.exports=GN;var aq=$N.exports,XN={exports:{}},Ur={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lq=R;function jN(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Dl(){}var dr={d:{f:Dl,r:function(){throw Error(jN(522))},D:Dl,C:Dl,L:Dl,m:Dl,X:Dl,S:Dl,M:Dl},p:0,findDOMNode:null},cq=Symbol.for("react.portal");function dq(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:cq,key:i==null?null:""+i,children:e,containerInfo:t,implementation:n}}var n0=lq.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function k5(e,t){if(e==="font")return"";if(typeof t=="string")return t==="use-credentials"?t:""}Ur.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=dr;Ur.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)throw Error(jN(299));return dq(e,t,null,n)};Ur.flushSync=function(e){var t=n0.T,n=dr.p;try{if(n0.T=null,dr.p=2,e)return e()}finally{n0.T=t,dr.p=n,dr.d.f()}};Ur.preconnect=function(e,t){typeof e=="string"&&(t?(t=t.crossOrigin,t=typeof t=="string"?t==="use-credentials"?t:"":void 0):t=null,dr.d.C(e,t))};Ur.prefetchDNS=function(e){typeof e=="string"&&dr.d.D(e)};Ur.preinit=function(e,t){if(typeof e=="string"&&t&&typeof t.as=="string"){var n=t.as,i=k5(n,t.crossOrigin),r=typeof t.integrity=="string"?t.integrity:void 0,s=typeof t.fetchPriority=="string"?t.fetchPriority:void 0;n==="style"?dr.d.S(e,typeof t.precedence=="string"?t.precedence:void 0,{crossOrigin:i,integrity:r,fetchPriority:s}):n==="script"&&dr.d.X(e,{crossOrigin:i,integrity:r,fetchPriority:s,nonce:typeof t.nonce=="string"?t.nonce:void 0})}};Ur.preinitModule=function(e,t){if(typeof e=="string")if(typeof t=="object"&&t!==null){if(t.as==null||t.as==="script"){var n=k5(t.as,t.crossOrigin);dr.d.M(e,{crossOrigin:n,integrity:typeof t.integrity=="string"?t.integrity:void 0,nonce:typeof t.nonce=="string"?t.nonce:void 0})}}else t==null&&dr.d.M(e)};Ur.preload=function(e,t){if(typeof e=="string"&&typeof t=="object"&&t!==null&&typeof t.as=="string"){var n=t.as,i=k5(n,t.crossOrigin);dr.d.L(e,n,{crossOrigin:i,integrity:typeof t.integrity=="string"?t.integrity:void 0,nonce:typeof t.nonce=="string"?t.nonce:void 0,type:typeof t.type=="string"?t.type:void 0,fetchPriority:typeof t.fetchPriority=="string"?t.fetchPriority:void 0,referrerPolicy:typeof t.referrerPolicy=="string"?t.referrerPolicy:void 0,imageSrcSet:typeof t.imageSrcSet=="string"?t.imageSrcSet:void 0,imageSizes:typeof t.imageSizes=="string"?t.imageSizes:void 0,media:typeof t.media=="string"?t.media:void 0})}};Ur.preloadModule=function(e,t){if(typeof e=="string")if(t){var n=k5(t.as,t.crossOrigin);dr.d.m(e,{as:typeof t.as=="string"&&t.as!=="script"?t.as:void 0,crossOrigin:n,integrity:typeof t.integrity=="string"?t.integrity:void 0})}else dr.d.m(e)};Ur.requestFormReset=function(e){dr.d.r(e)};Ur.unstable_batchedUpdates=function(e,t){return e(t)};Ur.useFormState=function(e,t,n){return n0.H.useFormState(e,t,n)};Ur.useFormStatus=function(){return n0.H.useHostTransitionStatus()};Ur.version="19.0.0";function YN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(YN)}catch(e){console.error(e)}}YN(),XN.exports=Ur;var mi=XN.exports;const uq=wl(mi);/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ri=aq,WN=R,fq=mi;function ie(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function KN(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}var hq=Symbol.for("react.element"),mU=Symbol.for("react.transitional.element"),k1=Symbol.for("react.portal"),kf=Symbol.for("react.fragment"),ZN=Symbol.for("react.strict_mode"),f7=Symbol.for("react.profiler"),gq=Symbol.for("react.provider"),qN=Symbol.for("react.consumer"),Ba=Symbol.for("react.context"),Aw=Symbol.for("react.forward_ref"),h7=Symbol.for("react.suspense"),g7=Symbol.for("react.suspense_list"),Mw=Symbol.for("react.memo"),jl=Symbol.for("react.lazy"),QN=Symbol.for("react.offscreen"),mq=Symbol.for("react.memo_cache_sentinel"),gx=Symbol.iterator;function e1(e){return e===null||typeof e!="object"?null:(e=gx&&e[gx]||e["@@iterator"],typeof e=="function"?e:null)}var pq=Symbol.for("react.client.reference");function m7(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===pq?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case kf:return"Fragment";case k1:return"Portal";case f7:return"Profiler";case ZN:return"StrictMode";case h7:return"Suspense";case g7:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ba:return(e.displayName||"Context")+".Provider";case qN:return(e._context.displayName||"Context")+".Consumer";case Aw:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Mw:return t=e.displayName||null,t!==null?t:m7(e.type)||"Memo";case jl:t=e._payload,e=e._init;try{return m7(e(t))}catch{}}return null}var We=WN.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,sn=Object.assign,VE,mx;function R1(e){if(VE===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);VE=t&&t[1]||"",mx=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+VE+e+mx}var $E=!1;function GE(e,t){if(!e||$E)return"";$E=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var u=function(){throw Error()};if(Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(h){var f=h}Reflect.construct(e,[],u)}else{try{u.call()}catch(h){f=h}e.call(u.prototype)}}else{try{throw Error()}catch(h){f=h}(u=e())&&typeof u.catch=="function"&&u.catch(function(){})}}catch(h){if(h&&f&&typeof h.stack=="string")return[h.stack,f.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=i.DetermineComponentFrameRoot(),o=s[0],a=s[1];if(o&&a){var l=o.split(`
`),c=a.split(`
`);for(r=i=0;i<l.length&&!l[i].includes("DetermineComponentFrameRoot");)i++;for(;r<c.length&&!c[r].includes("DetermineComponentFrameRoot");)r++;if(i===l.length||r===c.length)for(i=l.length-1,r=c.length-1;1<=i&&0<=r&&l[i]!==c[r];)r--;for(;1<=i&&0<=r;i--,r--)if(l[i]!==c[r]){if(i!==1||r!==1)do if(i--,r--,0>r||l[i]!==c[r]){var d=`
`+l[i].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=i&&0<=r);break}}}finally{$E=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?R1(n):""}function Uq(e){switch(e.tag){case 26:case 27:case 5:return R1(e.type);case 16:return R1("Lazy");case 13:return R1("Suspense");case 19:return R1("SuspenseList");case 0:case 15:return e=GE(e.type,!1),e;case 11:return e=GE(e.type.render,!1),e;case 1:return e=GE(e.type,!0),e;default:return""}}function px(e){try{var t="";do t+=Uq(e),e=e.return;while(e);return t}catch(n){return`
Error generating stack: `+n.message+`
`+n.stack}}function hg(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function JN(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Ux(e){if(hg(e)!==e)throw Error(ie(188))}function bq(e){var t=e.alternate;if(!t){if(t=hg(e),t===null)throw Error(ie(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return Ux(r),e;if(s===i)return Ux(r),t;s=s.sibling}throw Error(ie(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o)throw Error(ie(189))}}if(n.alternate!==i)throw Error(ie(190))}if(n.tag!==3)throw Error(ie(188));return n.stateNode.current===n?e:t}function eO(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=eO(e),t!==null)return t;e=e.sibling}return null}var D1=Array.isArray,rn=fq.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Xd={pending:!1,data:null,method:null,action:null},p7=[],Rf=-1;function la(e){return{current:e}}function vi(e){0>Rf||(e.current=p7[Rf],p7[Rf]=null,Rf--)}function dn(e,t){Rf++,p7[Rf]=e.current,e.current=t}var Vo=la(null),Y0=la(null),gc=la(null),mb=la(null);function pb(e,t){switch(dn(gc,t),dn(Y0,e),dn(Vo,null),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)&&(t=t.namespaceURI)?bC(t):0;break;default:if(e=e===8?t.parentNode:t,t=e.tagName,e=e.namespaceURI)e=bC(e),t=fF(e,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}vi(Vo),dn(Vo,t)}function Ih(){vi(Vo),vi(Y0),vi(gc)}function U7(e){e.memoizedState!==null&&dn(mb,e);var t=Vo.current,n=fF(t,e.type);t!==n&&(dn(Y0,e),dn(Vo,n))}function Ub(e){Y0.current===e&&(vi(Vo),vi(Y0)),mb.current===e&&(vi(mb),rm._currentValue=Xd)}var b7=Object.prototype.hasOwnProperty,kw=ri.unstable_scheduleCallback,XE=ri.unstable_cancelCallback,yq=ri.unstable_shouldYield,Eq=ri.unstable_requestPaint,$o=ri.unstable_now,vq=ri.unstable_getCurrentPriorityLevel,tO=ri.unstable_ImmediatePriority,nO=ri.unstable_UserBlockingPriority,bb=ri.unstable_NormalPriority,wq=ri.unstable_LowPriority,iO=ri.unstable_IdlePriority,_q=ri.log,Tq=ri.unstable_setDisableYieldValue,np=null,Zr=null;function Iq(e){if(Zr&&typeof Zr.onCommitFiberRoot=="function")try{Zr.onCommitFiberRoot(np,e,void 0,(e.current.flags&128)===128)}catch{}}function oc(e){if(typeof _q=="function"&&Tq(e),Zr&&typeof Zr.setStrictMode=="function")try{Zr.setStrictMode(np,e)}catch{}}var qr=Math.clz32?Math.clz32:Cq,Sq=Math.log,xq=Math.LN2;function Cq(e){return e>>>=0,e===0?32:31-(Sq(e)/xq|0)|0}var pU=128,UU=4194304;function wd(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function R5(e,t){var n=e.pendingLanes;if(n===0)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,o=e.warmLanes;e=e.finishedLanes!==0;var a=n&134217727;return a!==0?(n=a&~r,n!==0?i=wd(n):(s&=a,s!==0?i=wd(s):e||(o=a&~o,o!==0&&(i=wd(o))))):(a=n&~r,a!==0?i=wd(a):s!==0?i=wd(s):e||(o=n&~o,o!==0&&(i=wd(o)))),i===0?0:t!==0&&t!==i&&!(t&r)&&(r=i&-i,o=t&-t,r>=o||r===32&&(o&4194176)!==0)?t:i}function ip(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Aq(e,t){switch(e){case 1:case 2:case 4:case 8:return t+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rO(){var e=pU;return pU<<=1,!(pU&4194176)&&(pU=128),e}function sO(){var e=UU;return UU<<=1,!(UU&62914560)&&(UU=4194304),e}function jE(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function rp(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Mq(e,t,n,i,r,s){var o=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var a=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=o&~n;0<n;){var d=31-qr(n),u=1<<d;a[d]=0,l[d]=-1;var f=c[d];if(f!==null)for(c[d]=null,d=0;d<f.length;d++){var h=f[d];h!==null&&(h.lane&=-536870913)}n&=~u}i!==0&&oO(e,i,0),s!==0&&r===0&&e.tag!==0&&(e.suspendedLanes|=s&~(o&~t))}function oO(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-qr(t);e.entangledLanes|=t,e.entanglements[i]=e.entanglements[i]|1073741824|n&4194218}function aO(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-qr(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}function lO(e){return e&=-e,2<e?8<e?e&134217727?32:268435456:8:2}function cO(){var e=rn.p;return e!==0?e:(e=window.event,e===void 0?32:wF(e.type))}function kq(e,t){var n=rn.p;try{return rn.p=e,t()}finally{rn.p=n}}var id=Math.random().toString(36).slice(2),Yi="__reactFiber$"+id,Ar="__reactProps$"+id,gg="__reactContainer$"+id,y7="__reactEvents$"+id,Rq="__reactListeners$"+id,Dq="__reactHandles$"+id,bx="__reactResources$"+id,W0="__reactMarker$"+id;function Rw(e){delete e[Yi],delete e[Ar],delete e[y7],delete e[Rq],delete e[Dq]}function Ld(e){var t=e[Yi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[gg]||n[Yi]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=EC(e);e!==null;){if(n=e[Yi])return n;e=EC(e)}return t}e=n,n=e.parentNode}return null}function mg(e){if(e=e[Yi]||e[gg]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function L1(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(ie(33))}function eh(e){var t=e[bx];return t||(t=e[bx]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function pi(e){e[W0]=!0}var dO=new Set,uO={};function Du(e,t){Sh(e,t),Sh(e+"Capture",t)}function Sh(e,t){for(uO[e]=t,e=0;e<t.length;e++)dO.add(t[e])}var rl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Lq=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),yx={},Ex={};function Nq(e){return b7.call(Ex,e)?!0:b7.call(yx,e)?!1:Lq.test(e)?Ex[e]=!0:(yx[e]=!0,!1)}function E2(e,t,n){if(Nq(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var i=t.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function bU(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function ma(e,t,n,i){if(i===null)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+i)}}function ms(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function fO(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Oq(e){var t=fO(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function yb(e){e._valueTracker||(e._valueTracker=Oq(e))}function hO(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=fO(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function Eb(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Pq=/[\n"\\]/g;function bs(e){return e.replace(Pq,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function E7(e,t,n,i,r,s,o,a){e.name="",o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?e.type=o:e.removeAttribute("type"),t!=null?o==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+ms(t)):e.value!==""+ms(t)&&(e.value=""+ms(t)):o!=="submit"&&o!=="reset"||e.removeAttribute("value"),t!=null?v7(e,o,ms(t)):n!=null?v7(e,o,ms(n)):i!=null&&e.removeAttribute("value"),r==null&&s!=null&&(e.defaultChecked=!!s),r!=null&&(e.checked=r&&typeof r!="function"&&typeof r!="symbol"),a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"?e.name=""+ms(a):e.removeAttribute("name")}function gO(e,t,n,i,r,s,o,a){if(s!=null&&typeof s!="function"&&typeof s!="symbol"&&typeof s!="boolean"&&(e.type=s),t!=null||n!=null){if(!(s!=="submit"&&s!=="reset"||t!=null))return;n=n!=null?""+ms(n):"",t=t!=null?""+ms(t):n,a||t===e.value||(e.value=t),e.defaultValue=t}i=i??r,i=typeof i!="function"&&typeof i!="symbol"&&!!i,e.checked=a?e.checked:!!i,e.defaultChecked=!!i,o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"&&(e.name=o)}function v7(e,t,n){t==="number"&&Eb(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function th(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+ms(n),t=null,r=0;r<e.length;r++){if(e[r].value===n){e[r].selected=!0,i&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function mO(e,t,n){if(t!=null&&(t=""+ms(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+ms(n):""}function pO(e,t,n,i){if(t==null){if(i!=null){if(n!=null)throw Error(ie(92));if(D1(i)){if(1<i.length)throw Error(ie(93));i=i[0]}n=i}n==null&&(n=""),t=n}n=ms(t),e.defaultValue=n,i=e.textContent,i===n&&i!==""&&i!==null&&(e.value=i)}function xh(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Fq=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function vx(e,t,n){var i=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?i?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":i?e.setProperty(t,n):typeof n!="number"||n===0||Fq.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function UO(e,t,n){if(t!=null&&typeof t!="object")throw Error(ie(62));if(e=e.style,n!=null){for(var i in n)!n.hasOwnProperty(i)||t!=null&&t.hasOwnProperty(i)||(i.indexOf("--")===0?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="");for(var r in t)i=t[r],t.hasOwnProperty(r)&&n[r]!==i&&vx(e,r,i)}else for(var s in t)t.hasOwnProperty(s)&&vx(e,s,t[s])}function Dw(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bq=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),zq=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function v2(e){return zq.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var w7=null;function Lw(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Df=null,nh=null;function wx(e){var t=mg(e);if(t&&(e=t.stateNode)){var n=e[Ar]||null;e:switch(e=t.stateNode,t.type){case"input":if(E7(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+bs(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=i[Ar]||null;if(!r)throw Error(ie(90));E7(i,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(t=0;t<n.length;t++)i=n[t],i.form===e.form&&hO(i)}break e;case"textarea":mO(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&th(e,!!n.multiple,t,!1)}}}var YE=!1;function bO(e,t,n){if(YE)return e(t,n);YE=!0;try{var i=e(t);return i}finally{if(YE=!1,(Df!==null||nh!==null)&&(V5(),Df&&(t=Df,e=nh,nh=Df=null,wx(t),e)))for(t=0;t<e.length;t++)wx(e[t])}}function K0(e,t){var n=e.stateNode;if(n===null)return null;var i=n[Ar]||null;if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ie(231,t,typeof n));return n}var _7=!1;if(rl)try{var t1={};Object.defineProperty(t1,"passive",{get:function(){_7=!0}}),window.addEventListener("test",t1,t1),window.removeEventListener("test",t1,t1)}catch{_7=!1}var ac=null,Nw=null,w2=null;function yO(){if(w2)return w2;var e,t=Nw,n=t.length,i,r="value"in ac?ac.value:ac.textContent,s=r.length;for(e=0;e<n&&t[e]===r[e];e++);var o=n-e;for(i=1;i<=o&&t[n-i]===r[s-i];i++);return w2=r.slice(e,1<i?1-i:void 0)}function _2(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function yU(){return!0}function _x(){return!1}function kr(e){function t(n,i,r,s,o){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?yU:_x,this.isPropagationStopped=_x,this}return sn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=yU)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=yU)},persist:function(){},isPersistent:yU}),t}var Lu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},D5=kr(Lu),sp=sn({},Lu,{view:0,detail:0}),Hq=kr(sp),WE,KE,n1,L5=sn({},sp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ow,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==n1&&(n1&&e.type==="mousemove"?(WE=e.screenX-n1.screenX,KE=e.screenY-n1.screenY):KE=WE=0,n1=e),WE)},movementY:function(e){return"movementY"in e?e.movementY:KE}}),Tx=kr(L5),Vq=sn({},L5,{dataTransfer:0}),$q=kr(Vq),Gq=sn({},sp,{relatedTarget:0}),ZE=kr(Gq),Xq=sn({},Lu,{animationName:0,elapsedTime:0,pseudoElement:0}),jq=kr(Xq),Yq=sn({},Lu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Wq=kr(Yq),Kq=sn({},Lu,{data:0}),Ix=kr(Kq),Zq={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qq={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Qq={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Jq(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Qq[e])?!!t[e]:!1}function Ow(){return Jq}var eQ=sn({},sp,{key:function(e){if(e.key){var t=Zq[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=_2(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?qq[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ow,charCode:function(e){return e.type==="keypress"?_2(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?_2(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),tQ=kr(eQ),nQ=sn({},L5,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sx=kr(nQ),iQ=sn({},sp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ow}),rQ=kr(iQ),sQ=sn({},Lu,{propertyName:0,elapsedTime:0,pseudoElement:0}),oQ=kr(sQ),aQ=sn({},L5,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),lQ=kr(aQ),cQ=sn({},Lu,{newState:0,oldState:0}),dQ=kr(cQ),uQ=[9,13,27,32],Pw=rl&&"CompositionEvent"in window,i0=null;rl&&"documentMode"in document&&(i0=document.documentMode);var fQ=rl&&"TextEvent"in window&&!i0,EO=rl&&(!Pw||i0&&8<i0&&11>=i0),xx=" ",Cx=!1;function vO(e,t){switch(e){case"keyup":return uQ.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wO(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Lf=!1;function hQ(e,t){switch(e){case"compositionend":return wO(t);case"keypress":return t.which!==32?null:(Cx=!0,xx);case"textInput":return e=t.data,e===xx&&Cx?null:e;default:return null}}function gQ(e,t){if(Lf)return e==="compositionend"||!Pw&&vO(e,t)?(e=yO(),w2=Nw=ac=null,Lf=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return EO&&t.locale!=="ko"?null:t.data;default:return null}}var mQ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ax(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!mQ[e.type]:t==="textarea"}function _O(e,t,n,i){Df?nh?nh.push(i):nh=[i]:Df=i,t=Ob(t,"onChange"),0<t.length&&(n=new D5("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var r0=null,Z0=null;function pQ(e){cF(e,0)}function N5(e){var t=L1(e);if(hO(t))return e}function Mx(e,t){if(e==="change")return t}var TO=!1;if(rl){var qE;if(rl){var QE="oninput"in document;if(!QE){var kx=document.createElement("div");kx.setAttribute("oninput","return;"),QE=typeof kx.oninput=="function"}qE=QE}else qE=!1;TO=qE&&(!document.documentMode||9<document.documentMode)}function Rx(){r0&&(r0.detachEvent("onpropertychange",IO),Z0=r0=null)}function IO(e){if(e.propertyName==="value"&&N5(Z0)){var t=[];_O(t,Z0,e,Lw(e)),bO(pQ,t)}}function UQ(e,t,n){e==="focusin"?(Rx(),r0=t,Z0=n,r0.attachEvent("onpropertychange",IO)):e==="focusout"&&Rx()}function bQ(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return N5(Z0)}function yQ(e,t){if(e==="click")return N5(t)}function EQ(e,t){if(e==="input"||e==="change")return N5(t)}function vQ(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var rs=typeof Object.is=="function"?Object.is:vQ;function q0(e,t){if(rs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!b7.call(t,r)||!rs(e[r],t[r]))return!1}return!0}function Dx(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Lx(e,t){var n=Dx(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Dx(n)}}function SO(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?SO(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function xO(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Eb(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Eb(e.document)}return t}function Fw(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function wQ(e,t){var n=xO(t);t=e.focusedElem;var i=e.selectionRange;if(n!==t&&t&&t.ownerDocument&&SO(t.ownerDocument.documentElement,t)){if(i!==null&&Fw(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var r=t.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!n.extend&&s>i&&(r=i,i=s,s=r),r=Lx(t,s);var o=Lx(t,i);r&&o&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),n.removeAllRanges(),s>i?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var _Q=rl&&"documentMode"in document&&11>=document.documentMode,Nf=null,T7=null,s0=null,I7=!1;function Nx(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;I7||Nf==null||Nf!==Eb(i)||(i=Nf,"selectionStart"in i&&Fw(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),s0&&q0(s0,i)||(s0=i,i=Ob(T7,"onSelect"),0<i.length&&(t=new D5("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=Nf)))}function Ud(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Of={animationend:Ud("Animation","AnimationEnd"),animationiteration:Ud("Animation","AnimationIteration"),animationstart:Ud("Animation","AnimationStart"),transitionrun:Ud("Transition","TransitionRun"),transitionstart:Ud("Transition","TransitionStart"),transitioncancel:Ud("Transition","TransitionCancel"),transitionend:Ud("Transition","TransitionEnd")},JE={},CO={};rl&&(CO=document.createElement("div").style,"AnimationEvent"in window||(delete Of.animationend.animation,delete Of.animationiteration.animation,delete Of.animationstart.animation),"TransitionEvent"in window||delete Of.transitionend.transition);function Nu(e){if(JE[e])return JE[e];if(!Of[e])return e;var t=Of[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in CO)return JE[e]=t[n];return e}var AO=Nu("animationend"),MO=Nu("animationiteration"),kO=Nu("animationstart"),TQ=Nu("transitionrun"),IQ=Nu("transitionstart"),SQ=Nu("transitioncancel"),RO=Nu("transitionend"),DO=new Map,Ox="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Uo(e,t){DO.set(e,t),Du(t,[e])}var hs=[],Pf=0,Bw=0;function O5(){for(var e=Pf,t=Bw=Pf=0;t<e;){var n=hs[t];hs[t++]=null;var i=hs[t];hs[t++]=null;var r=hs[t];hs[t++]=null;var s=hs[t];if(hs[t++]=null,i!==null&&r!==null){var o=i.pending;o===null?r.next=r:(r.next=o.next,o.next=r),i.pending=r}s!==0&&LO(n,r,s)}}function P5(e,t,n,i){hs[Pf++]=e,hs[Pf++]=t,hs[Pf++]=n,hs[Pf++]=i,Bw|=i,e.lanes|=i,e=e.alternate,e!==null&&(e.lanes|=i)}function zw(e,t,n,i){return P5(e,t,n,i),vb(e)}function Lc(e,t){return P5(e,null,null,t),vb(e)}function LO(e,t,n){e.lanes|=n;var i=e.alternate;i!==null&&(i.lanes|=n);for(var r=!1,s=e.return;s!==null;)s.childLanes|=n,i=s.alternate,i!==null&&(i.childLanes|=n),s.tag===22&&(e=s.stateNode,e===null||e._visibility&1||(r=!0)),e=s,s=s.return;r&&t!==null&&e.tag===3&&(s=e.stateNode,r=31-qr(n),s=s.hiddenUpdates,e=s[r],e===null?s[r]=[t]:e.push(t),t.lane=n|536870912)}function vb(e){if(50<U0)throw U0=0,Y7=null,Error(ie(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Ff={},Px=new WeakMap;function ys(e,t){if(typeof e=="object"&&e!==null){var n=Px.get(e);return n!==void 0?n:(t={value:e,source:t,stack:px(t)},Px.set(e,t),t)}return{value:e,source:t,stack:px(t)}}var Bf=[],zf=0,wb=null,_b=0,ps=[],Us=0,jd=null,za=1,Ha="";function _d(e,t){Bf[zf++]=_b,Bf[zf++]=wb,wb=e,_b=t}function NO(e,t,n){ps[Us++]=za,ps[Us++]=Ha,ps[Us++]=jd,jd=e;var i=za;e=Ha;var r=32-qr(i)-1;i&=~(1<<r),n+=1;var s=32-qr(t)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,za=1<<32-qr(t)+r|n<<r|i,Ha=s+e}else za=1<<s|n<<r|i,Ha=e}function Hw(e){e.return!==null&&(_d(e,1),NO(e,1,0))}function Vw(e){for(;e===wb;)wb=Bf[--zf],Bf[zf]=null,_b=Bf[--zf],Bf[zf]=null;for(;e===jd;)jd=ps[--Us],ps[Us]=null,Ha=ps[--Us],ps[Us]=null,za=ps[--Us],ps[Us]=null}var lr=null,Mi=null,St=!1,Qs=null,Do=!1,S7=Error(ie(519));function su(e){var t=Error(ie(418,""));throw Q0(ys(t,e)),S7}function Fx(e){var t=e.stateNode,n=e.type,i=e.memoizedProps;switch(t[Yi]=e,t[Ar]=i,n){case"dialog":at("cancel",t),at("close",t);break;case"iframe":case"object":case"embed":at("load",t);break;case"video":case"audio":for(n=0;n<tm.length;n++)at(tm[n],t);break;case"source":at("error",t);break;case"img":case"image":case"link":at("error",t),at("load",t);break;case"details":at("toggle",t);break;case"input":at("invalid",t),gO(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0),yb(t);break;case"select":at("invalid",t);break;case"textarea":at("invalid",t),pO(t,i.value,i.defaultValue,i.children),yb(t)}n=i.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||i.suppressHydrationWarning===!0||uF(t.textContent,n)?(i.popover!=null&&(at("beforetoggle",t),at("toggle",t)),i.onScroll!=null&&at("scroll",t),i.onScrollEnd!=null&&at("scrollend",t),i.onClick!=null&&(t.onclick=G5),t=!0):t=!1,t||su(e)}function Bx(e){for(lr=e.return;lr;)switch(lr.tag){case 3:case 27:Do=!0;return;case 5:case 13:Do=!1;return;default:lr=lr.return}}function i1(e){if(e!==lr)return!1;if(!St)return Bx(e),St=!0,!1;var t=!1,n;if((n=e.tag!==3&&e.tag!==27)&&((n=e.tag===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||e4(e.type,e.memoizedProps)),n=!n),n&&(t=!0),t&&Mi&&su(e),Bx(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ie(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(n=e.data,n==="/$"){if(t===0){Mi=ro(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++;e=e.nextSibling}Mi=null}}else Mi=lr?ro(e.stateNode.nextSibling):null;return!0}function op(){Mi=lr=null,St=!1}function Q0(e){Qs===null?Qs=[e]:Qs.push(e)}var o0=Error(ie(460)),OO=Error(ie(474)),x7={then:function(){}};function zx(e){return e=e.status,e==="fulfilled"||e==="rejected"}function EU(){}function PO(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(EU,EU),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,e===o0?Error(ie(483)):e;default:if(typeof t.status=="string")t.then(EU,EU);else{if(e=Qt,e!==null&&100<e.shellSuspendCounter)throw Error(ie(482));e=t,e.status="pending",e.then(function(i){if(t.status==="pending"){var r=t;r.status="fulfilled",r.value=i}},function(i){if(t.status==="pending"){var r=t;r.status="rejected",r.reason=i}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,e===o0?Error(ie(483)):e}throw a0=t,o0}}var a0=null;function Hx(){if(a0===null)throw Error(ie(459));var e=a0;return a0=null,e}var ih=null,J0=0;function vU(e){var t=J0;return J0+=1,ih===null&&(ih=[]),PO(ih,e,t)}function r1(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function wU(e,t){throw t.$$typeof===hq?Error(ie(525)):(e=Object.prototype.toString.call(t),Error(ie(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Vx(e){var t=e._init;return t(e._payload)}function FO(e){function t(b,y){if(e){var w=b.deletions;w===null?(b.deletions=[y],b.flags|=16):w.push(y)}}function n(b,y){if(!e)return null;for(;y!==null;)t(b,y),y=y.sibling;return null}function i(b){for(var y=new Map;b!==null;)b.key!==null?y.set(b.key,b):y.set(b.index,b),b=b.sibling;return y}function r(b,y){return b=Uc(b,y),b.index=0,b.sibling=null,b}function s(b,y,w){return b.index=w,e?(w=b.alternate,w!==null?(w=w.index,w<y?(b.flags|=33554434,y):w):(b.flags|=33554434,y)):(b.flags|=1048576,y)}function o(b){return e&&b.alternate===null&&(b.flags|=33554434),b}function a(b,y,w,v){return y===null||y.tag!==6?(y=u8(w,b.mode,v),y.return=b,y):(y=r(y,w),y.return=b,y)}function l(b,y,w,v){var I=w.type;return I===kf?d(b,y,w.props.children,v,w.key):y!==null&&(y.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===jl&&Vx(I)===y.type)?(y=r(y,w.props),r1(y,w),y.return=b,y):(y=C2(w.type,w.key,w.props,null,b.mode,v),r1(y,w),y.return=b,y)}function c(b,y,w,v){return y===null||y.tag!==4||y.stateNode.containerInfo!==w.containerInfo||y.stateNode.implementation!==w.implementation?(y=f8(w,b.mode,v),y.return=b,y):(y=r(y,w.children||[]),y.return=b,y)}function d(b,y,w,v,I){return y===null||y.tag!==7?(y=Wd(w,b.mode,v,I),y.return=b,y):(y=r(y,w),y.return=b,y)}function u(b,y,w){if(typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint")return y=u8(""+y,b.mode,w),y.return=b,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case mU:return w=C2(y.type,y.key,y.props,null,b.mode,w),r1(w,y),w.return=b,w;case k1:return y=f8(y,b.mode,w),y.return=b,y;case jl:var v=y._init;return y=v(y._payload),u(b,y,w)}if(D1(y)||e1(y))return y=Wd(y,b.mode,w,null),y.return=b,y;if(typeof y.then=="function")return u(b,vU(y),w);if(y.$$typeof===Ba)return u(b,_U(b,y),w);wU(b,y)}return null}function f(b,y,w,v){var I=y!==null?y.key:null;if(typeof w=="string"&&w!==""||typeof w=="number"||typeof w=="bigint")return I!==null?null:a(b,y,""+w,v);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case mU:return w.key===I?l(b,y,w,v):null;case k1:return w.key===I?c(b,y,w,v):null;case jl:return I=w._init,w=I(w._payload),f(b,y,w,v)}if(D1(w)||e1(w))return I!==null?null:d(b,y,w,v,null);if(typeof w.then=="function")return f(b,y,vU(w),v);if(w.$$typeof===Ba)return f(b,y,_U(b,w),v);wU(b,w)}return null}function h(b,y,w,v,I){if(typeof v=="string"&&v!==""||typeof v=="number"||typeof v=="bigint")return b=b.get(w)||null,a(y,b,""+v,I);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case mU:return b=b.get(v.key===null?w:v.key)||null,l(y,b,v,I);case k1:return b=b.get(v.key===null?w:v.key)||null,c(y,b,v,I);case jl:var C=v._init;return v=C(v._payload),h(b,y,w,v,I)}if(D1(v)||e1(v))return b=b.get(w)||null,d(y,b,v,I,null);if(typeof v.then=="function")return h(b,y,w,vU(v),I);if(v.$$typeof===Ba)return h(b,y,w,_U(y,v),I);wU(y,v)}return null}function m(b,y,w,v){for(var I=null,C=null,_=y,T=y=0,k=null;_!==null&&T<w.length;T++){_.index>T?(k=_,_=null):k=_.sibling;var x=f(b,_,w[T],v);if(x===null){_===null&&(_=k);break}e&&_&&x.alternate===null&&t(b,_),y=s(x,y,T),C===null?I=x:C.sibling=x,C=x,_=k}if(T===w.length)return n(b,_),St&&_d(b,T),I;if(_===null){for(;T<w.length;T++)_=u(b,w[T],v),_!==null&&(y=s(_,y,T),C===null?I=_:C.sibling=_,C=_);return St&&_d(b,T),I}for(_=i(_);T<w.length;T++)k=h(_,b,T,w[T],v),k!==null&&(e&&k.alternate!==null&&_.delete(k.key===null?T:k.key),y=s(k,y,T),C===null?I=k:C.sibling=k,C=k);return e&&_.forEach(function(D){return t(b,D)}),St&&_d(b,T),I}function p(b,y,w,v){if(w==null)throw Error(ie(151));for(var I=null,C=null,_=y,T=y=0,k=null,x=w.next();_!==null&&!x.done;T++,x=w.next()){_.index>T?(k=_,_=null):k=_.sibling;var D=f(b,_,x.value,v);if(D===null){_===null&&(_=k);break}e&&_&&D.alternate===null&&t(b,_),y=s(D,y,T),C===null?I=D:C.sibling=D,C=D,_=k}if(x.done)return n(b,_),St&&_d(b,T),I;if(_===null){for(;!x.done;T++,x=w.next())x=u(b,x.value,v),x!==null&&(y=s(x,y,T),C===null?I=x:C.sibling=x,C=x);return St&&_d(b,T),I}for(_=i(_);!x.done;T++,x=w.next())x=h(_,b,T,x.value,v),x!==null&&(e&&x.alternate!==null&&_.delete(x.key===null?T:x.key),y=s(x,y,T),C===null?I=x:C.sibling=x,C=x);return e&&_.forEach(function(O){return t(b,O)}),St&&_d(b,T),I}function U(b,y,w,v){if(typeof w=="object"&&w!==null&&w.type===kf&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case mU:e:{for(var I=w.key;y!==null;){if(y.key===I){if(I=w.type,I===kf){if(y.tag===7){n(b,y.sibling),v=r(y,w.props.children),v.return=b,b=v;break e}}else if(y.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===jl&&Vx(I)===y.type){n(b,y.sibling),v=r(y,w.props),r1(v,w),v.return=b,b=v;break e}n(b,y);break}else t(b,y);y=y.sibling}w.type===kf?(v=Wd(w.props.children,b.mode,v,w.key),v.return=b,b=v):(v=C2(w.type,w.key,w.props,null,b.mode,v),r1(v,w),v.return=b,b=v)}return o(b);case k1:e:{for(I=w.key;y!==null;){if(y.key===I)if(y.tag===4&&y.stateNode.containerInfo===w.containerInfo&&y.stateNode.implementation===w.implementation){n(b,y.sibling),v=r(y,w.children||[]),v.return=b,b=v;break e}else{n(b,y);break}else t(b,y);y=y.sibling}v=f8(w,b.mode,v),v.return=b,b=v}return o(b);case jl:return I=w._init,w=I(w._payload),U(b,y,w,v)}if(D1(w))return m(b,y,w,v);if(e1(w)){if(I=e1(w),typeof I!="function")throw Error(ie(150));return w=I.call(w),p(b,y,w,v)}if(typeof w.then=="function")return U(b,y,vU(w),v);if(w.$$typeof===Ba)return U(b,y,_U(b,w),v);wU(b,w)}return typeof w=="string"&&w!==""||typeof w=="number"||typeof w=="bigint"?(w=""+w,y!==null&&y.tag===6?(n(b,y.sibling),v=r(y,w),v.return=b,b=v):(n(b,y),v=u8(w,b.mode,v),v.return=b,b=v),o(b)):n(b,y)}return function(b,y,w,v){try{J0=0;var I=U(b,y,w,v);return ih=null,I}catch(_){if(_===o0)throw _;var C=_s(29,_,null,b.mode);return C.lanes=v,C.return=b,C}finally{}}}var ou=FO(!0),BO=FO(!1),Ch=la(null),Tb=la(0);function $x(e,t){e=al,dn(Tb,e),dn(Ch,t),al=e|t.baseLanes}function C7(){dn(Tb,al),dn(Ch,Ch.current)}function $w(){al=Tb.current,vi(Ch),vi(Tb)}var Ls=la(null),Go=null;function Jl(e){var t=e.alternate;dn(ei,ei.current&1),dn(Ls,e),Go===null&&(t===null||Ch.current!==null||t.memoizedState!==null)&&(Go=e)}function zO(e){if(e.tag===22){if(dn(ei,ei.current),dn(Ls,e),Go===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(Go=e)}}else ec()}function ec(){dn(ei,ei.current),dn(Ls,Ls.current)}function Va(e){vi(Ls),Go===e&&(Go=null),vi(ei)}var ei=la(0);function Ib(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var xQ=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,i){e.push(i)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},CQ=ri.unstable_scheduleCallback,AQ=ri.unstable_NormalPriority,Jn={$$typeof:Ba,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Gw(){return{controller:new xQ,data:new Map,refCount:0}}function ap(e){e.refCount--,e.refCount===0&&CQ(AQ,function(){e.controller.abort()})}var l0=null,A7=0,Ah=0,rh=null;function MQ(e,t){if(l0===null){var n=l0=[];A7=0,Ah=h_(),rh={status:"pending",value:void 0,then:function(i){n.push(i)}}}return A7++,t.then(Gx,Gx),t}function Gx(){if(--A7===0&&l0!==null){rh!==null&&(rh.status="fulfilled");var e=l0;l0=null,Ah=0,rh=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function kQ(e,t){var n=[],i={status:"pending",value:null,reason:null,then:function(r){n.push(r)}};return e.then(function(){i.status="fulfilled",i.value=t;for(var r=0;r<n.length;r++)(0,n[r])(t)},function(r){for(i.status="rejected",i.reason=r,r=0;r<n.length;r++)(0,n[r])(void 0)}),i}var Xx=We.S;We.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&MQ(e,t),Xx!==null&&Xx(e,t)};var Yd=la(null);function Xw(){var e=Yd.current;return e!==null?e:Qt.pooledCache}function T2(e,t){t===null?dn(Yd,Yd.current):dn(Yd,t.pool)}function HO(){var e=Xw();return e===null?null:{parent:Jn._currentValue,pool:e}}var Nc=0,qe=null,Bt=null,zn=null,Sb=!1,sh=!1,au=!1,xb=0,em=0,oh=null,RQ=0;function Cn(){throw Error(ie(321))}function jw(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!rs(e[n],t[n]))return!1;return!0}function Yw(e,t,n,i,r,s){return Nc=s,qe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,We.H=e===null||e.memoizedState===null?Ou:rd,au=!1,s=n(i,r),au=!1,sh&&(s=$O(t,n,i,r)),VO(e),s}function VO(e){We.H=Ko;var t=Bt!==null&&Bt.next!==null;if(Nc=0,zn=Bt=qe=null,Sb=!1,em=0,oh=null,t)throw Error(ie(300));e===null||bi||(e=e.dependencies,e!==null&&Mb(e)&&(bi=!0))}function $O(e,t,n,i){qe=e;var r=0;do{if(sh&&(oh=null),em=0,sh=!1,25<=r)throw Error(ie(301));if(r+=1,zn=Bt=null,e.updateQueue!=null){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,s.memoCache!=null&&(s.memoCache.index=0)}We.H=Pu,s=t(n,i)}while(sh);return s}function DQ(){var e=We.H,t=e.useState()[0];return t=typeof t.then=="function"?lp(t):t,e=e.useState()[0],(Bt!==null?Bt.memoizedState:null)!==e&&(qe.flags|=1024),t}function Ww(){var e=xb!==0;return xb=0,e}function Kw(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Zw(e){if(Sb){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Sb=!1}Nc=0,zn=Bt=qe=null,sh=!1,em=xb=0,oh=null}function Er(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zn===null?qe.memoizedState=zn=e:zn=zn.next=e,zn}function Xn(){if(Bt===null){var e=qe.alternate;e=e!==null?e.memoizedState:null}else e=Bt.next;var t=zn===null?qe.memoizedState:zn.next;if(t!==null)zn=t,Bt=e;else{if(e===null)throw qe.alternate===null?Error(ie(467)):Error(ie(310));Bt=e,e={memoizedState:Bt.memoizedState,baseState:Bt.baseState,baseQueue:Bt.baseQueue,queue:Bt.queue,next:null},zn===null?qe.memoizedState=zn=e:zn=zn.next=e}return zn}var F5;F5=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function lp(e){var t=em;return em+=1,oh===null&&(oh=[]),e=PO(oh,e,t),t=qe,(zn===null?t.memoizedState:zn.next)===null&&(t=t.alternate,We.H=t===null||t.memoizedState===null?Ou:rd),e}function B5(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return lp(e);if(e.$$typeof===Ba)return Wi(e)}throw Error(ie(438,String(e)))}function qw(e){var t=null,n=qe.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var i=qe.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(t={data:i.data.map(function(r){return r.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=F5(),qe.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),i=0;i<e;i++)n[i]=mq;return t.index++,n}function sl(e,t){return typeof t=="function"?t(e):t}function I2(e){var t=Xn();return Qw(t,Bt,e)}function Qw(e,t,n){var i=e.queue;if(i===null)throw Error(ie(311));i.lastRenderedReducer=n;var r=e.baseQueue,s=i.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}t.baseQueue=r=s,i.pending=null}if(s=e.baseState,r===null)e.memoizedState=s;else{t=r.next;var a=o=null,l=null,c=t,d=!1;do{var u=c.lane&-536870913;if(u!==c.lane?(gt&u)===u:(Nc&u)===u){var f=c.revertLane;if(f===0)l!==null&&(l=l.next={lane:0,revertLane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),u===Ah&&(d=!0);else if((Nc&f)===f){c=c.next,f===Ah&&(d=!0);continue}else u={lane:0,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},l===null?(a=l=u,o=s):l=l.next=u,qe.lanes|=f,Pc|=f;u=c.action,au&&n(s,u),s=c.hasEagerState?c.eagerState:n(s,u)}else f={lane:u,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},l===null?(a=l=f,o=s):l=l.next=f,qe.lanes|=u,Pc|=u;c=c.next}while(c!==null&&c!==t);if(l===null?o=s:l.next=a,!rs(s,e.memoizedState)&&(bi=!0,d&&(n=rh,n!==null)))throw n;e.memoizedState=s,e.baseState=o,e.baseQueue=l,i.lastRenderedState=s}return r===null&&(i.lanes=0),[e.memoizedState,i.dispatch]}function e8(e){var t=Xn(),n=t.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,s=t.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do s=e(s,o.action),o=o.next;while(o!==r);rs(s,t.memoizedState)||(bi=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,i]}function GO(e,t,n){var i=qe,r=Xn(),s=St;if(s){if(n===void 0)throw Error(ie(407));n=n()}else n=t();var o=!rs((Bt||r).memoizedState,n);if(o&&(r.memoizedState=n,bi=!0),r=r.queue,Jw(YO.bind(null,i,r,e),[e]),r.getSnapshot!==t||o||zn!==null&&zn.memoizedState.tag&1){if(i.flags|=2048,Mh(9,jO.bind(null,i,r,n,t),{destroy:void 0},null),Qt===null)throw Error(ie(349));s||Nc&60||XO(i,t,n)}return n}function XO(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=qe.updateQueue,t===null?(t=F5(),qe.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function jO(e,t,n,i){t.value=n,t.getSnapshot=i,WO(t)&&KO(e)}function YO(e,t,n){return n(function(){WO(t)&&KO(e)})}function WO(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!rs(e,n)}catch{return!0}}function KO(e){var t=Lc(e,2);t!==null&&hr(t,e,2)}function M7(e){var t=Er();if(typeof e=="function"){var n=e;if(e=n(),au){oc(!0);try{n()}finally{oc(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sl,lastRenderedState:e},t}function ZO(e,t,n,i){return e.baseState=n,Qw(e,Bt,typeof i=="function"?i:sl)}function LQ(e,t,n,i,r){if(H5(e))throw Error(ie(485));if(e=t.action,e!==null){var s={payload:r,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(o){s.listeners.push(o)}};We.T!==null?n(!0):s.isTransition=!1,i(s),n=t.pending,n===null?(s.next=t.pending=s,qO(t,s)):(s.next=n.next,t.pending=n.next=s)}}function qO(e,t){var n=t.action,i=t.payload,r=e.state;if(t.isTransition){var s=We.T,o={};We.T=o;try{var a=n(r,i),l=We.S;l!==null&&l(o,a),jx(e,t,a)}catch(c){k7(e,t,c)}finally{We.T=s}}else try{s=n(r,i),jx(e,t,s)}catch(c){k7(e,t,c)}}function jx(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(i){Yx(e,t,i)},function(i){return k7(e,t,i)}):Yx(e,t,n)}function Yx(e,t,n){t.status="fulfilled",t.value=n,QO(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,qO(e,n)))}function k7(e,t,n){var i=e.pending;if(e.pending=null,i!==null){i=i.next;do t.status="rejected",t.reason=n,QO(t),t=t.next;while(t!==i)}e.action=null}function QO(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function JO(e,t){return t}function eP(e,t){if(St){var n=Qt.formState;if(n!==null){e:{var i=qe;if(St){if(Mi){t:{for(var r=Mi,s=Do;r.nodeType!==8;){if(!s){r=null;break t}if(r=ro(r.nextSibling),r===null){r=null;break t}}s=r.data,r=s==="F!"||s==="F"?r:null}if(r){Mi=ro(r.nextSibling),i=r.data==="F!";break e}}su(i)}i=!1}i&&(t=n[0])}}return n=Er(),n.memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:JO,lastRenderedState:t},n.queue=i,n=UP.bind(null,qe,i),i.dispatch=n,i=M7(!1),s=i_.bind(null,qe,!1,i.queue),i=Er(),r={state:t,dispatch:null,action:e,pending:null},i.queue=r,n=LQ.bind(null,qe,r,s,n),r.dispatch=n,i.memoizedState=e,[t,n,!1]}function tP(e){var t=Xn();return nP(t,Bt,e)}function nP(e,t,n){t=Qw(e,t,JO)[0],e=I2(sl)[0],t=typeof t=="object"&&t!==null&&typeof t.then=="function"?lp(t):t;var i=Xn(),r=i.queue,s=r.dispatch;return n!==i.memoizedState&&(qe.flags|=2048,Mh(9,NQ.bind(null,r,n),{destroy:void 0},null)),[t,s,e]}function NQ(e,t){e.action=t}function iP(e){var t=Xn(),n=Bt;if(n!==null)return nP(t,n,e);Xn(),t=t.memoizedState,n=Xn();var i=n.queue.dispatch;return n.memoizedState=e,[t,i,!1]}function Mh(e,t,n,i){return e={tag:e,create:t,inst:n,deps:i,next:null},t=qe.updateQueue,t===null&&(t=F5(),qe.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function rP(){return Xn().memoizedState}function S2(e,t,n,i){var r=Er();qe.flags|=e,r.memoizedState=Mh(1|t,n,{destroy:void 0},i===void 0?null:i)}function z5(e,t,n,i){var r=Xn();i=i===void 0?null:i;var s=r.memoizedState.inst;Bt!==null&&i!==null&&jw(i,Bt.memoizedState.deps)?r.memoizedState=Mh(t,n,s,i):(qe.flags|=e,r.memoizedState=Mh(1|t,n,s,i))}function Wx(e,t){S2(8390656,8,e,t)}function Jw(e,t){z5(2048,8,e,t)}function sP(e,t){return z5(4,2,e,t)}function oP(e,t){return z5(4,4,e,t)}function aP(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function lP(e,t,n){n=n!=null?n.concat([e]):null,z5(4,4,aP.bind(null,t,e),n)}function e_(){}function cP(e,t){var n=Xn();t=t===void 0?null:t;var i=n.memoizedState;return t!==null&&jw(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function dP(e,t){var n=Xn();t=t===void 0?null:t;var i=n.memoizedState;if(t!==null&&jw(t,i[1]))return i[0];if(i=e(),au){oc(!0);try{e()}finally{oc(!1)}}return n.memoizedState=[i,t],i}function t_(e,t,n){return n===void 0||Nc&1073741824?e.memoizedState=t:(e.memoizedState=n,e=QP(),qe.lanes|=e,Pc|=e,n)}function uP(e,t,n,i){return rs(n,t)?n:Ch.current!==null?(e=t_(e,n,i),rs(e,t)||(bi=!0),e):Nc&42?(e=QP(),qe.lanes|=e,Pc|=e,t):(bi=!0,e.memoizedState=n)}function fP(e,t,n,i,r){var s=rn.p;rn.p=s!==0&&8>s?s:8;var o=We.T,a={};We.T=a,i_(e,!1,t,n);try{var l=r(),c=We.S;if(c!==null&&c(a,l),l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=kQ(l,i);c0(e,t,d,Qr(e))}else c0(e,t,i,Qr(e))}catch(u){c0(e,t,{then:function(){},status:"rejected",reason:u},Qr())}finally{rn.p=s,We.T=o}}function OQ(){}function R7(e,t,n,i){if(e.tag!==5)throw Error(ie(476));var r=hP(e).queue;fP(e,r,t,Xd,n===null?OQ:function(){return gP(e),n(i)})}function hP(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:Xd,baseState:Xd,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sl,lastRenderedState:Xd},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sl,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function gP(e){var t=hP(e).next.queue;c0(e,t,{},Qr())}function n_(){return Wi(rm)}function mP(){return Xn().memoizedState}function pP(){return Xn().memoizedState}function PQ(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=Qr();e=mc(n);var i=pc(t,e,n);i!==null&&(hr(i,t,n),u0(i,t,n)),t={cache:Gw()},e.payload=t;return}t=t.return}}function FQ(e,t,n){var i=Qr();n={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},H5(e)?bP(t,n):(n=zw(e,t,n,i),n!==null&&(hr(n,e,i),yP(n,t,i)))}function UP(e,t,n){var i=Qr();c0(e,t,n,i)}function c0(e,t,n,i){var r={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(H5(e))bP(t,r);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,rs(a,o))return P5(e,t,r,0),Qt===null&&O5(),!1}catch{}finally{}if(n=zw(e,t,r,i),n!==null)return hr(n,e,i),yP(n,t,i),!0}return!1}function i_(e,t,n,i){if(i={lane:2,revertLane:h_(),action:i,hasEagerState:!1,eagerState:null,next:null},H5(e)){if(t)throw Error(ie(479))}else t=zw(e,n,i,2),t!==null&&hr(t,e,2)}function H5(e){var t=e.alternate;return e===qe||t!==null&&t===qe}function bP(e,t){sh=Sb=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function yP(e,t,n){if(n&4194176){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,aO(e,n)}}var Ko={readContext:Wi,use:B5,useCallback:Cn,useContext:Cn,useEffect:Cn,useImperativeHandle:Cn,useLayoutEffect:Cn,useInsertionEffect:Cn,useMemo:Cn,useReducer:Cn,useRef:Cn,useState:Cn,useDebugValue:Cn,useDeferredValue:Cn,useTransition:Cn,useSyncExternalStore:Cn,useId:Cn};Ko.useCacheRefresh=Cn;Ko.useMemoCache=Cn;Ko.useHostTransitionStatus=Cn;Ko.useFormState=Cn;Ko.useActionState=Cn;Ko.useOptimistic=Cn;var Ou={readContext:Wi,use:B5,useCallback:function(e,t){return Er().memoizedState=[e,t===void 0?null:t],e},useContext:Wi,useEffect:Wx,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,S2(4194308,4,aP.bind(null,t,e),n)},useLayoutEffect:function(e,t){return S2(4194308,4,e,t)},useInsertionEffect:function(e,t){S2(4,2,e,t)},useMemo:function(e,t){var n=Er();t=t===void 0?null:t;var i=e();if(au){oc(!0);try{e()}finally{oc(!1)}}return n.memoizedState=[i,t],i},useReducer:function(e,t,n){var i=Er();if(n!==void 0){var r=n(t);if(au){oc(!0);try{n(t)}finally{oc(!1)}}}else r=t;return i.memoizedState=i.baseState=r,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},i.queue=e,e=e.dispatch=FQ.bind(null,qe,e),[i.memoizedState,e]},useRef:function(e){var t=Er();return e={current:e},t.memoizedState=e},useState:function(e){e=M7(e);var t=e.queue,n=UP.bind(null,qe,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:e_,useDeferredValue:function(e,t){var n=Er();return t_(n,e,t)},useTransition:function(){var e=M7(!1);return e=fP.bind(null,qe,e.queue,!0,!1),Er().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var i=qe,r=Er();if(St){if(n===void 0)throw Error(ie(407));n=n()}else{if(n=t(),Qt===null)throw Error(ie(349));gt&60||XO(i,t,n)}r.memoizedState=n;var s={value:n,getSnapshot:t};return r.queue=s,Wx(YO.bind(null,i,s,e),[e]),i.flags|=2048,Mh(9,jO.bind(null,i,s,n,t),{destroy:void 0},null),n},useId:function(){var e=Er(),t=Qt.identifierPrefix;if(St){var n=Ha,i=za;n=(i&~(1<<32-qr(i)-1)).toString(32)+n,t=":"+t+"R"+n,n=xb++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=RQ++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},useCacheRefresh:function(){return Er().memoizedState=PQ.bind(null,qe)}};Ou.useMemoCache=qw;Ou.useHostTransitionStatus=n_;Ou.useFormState=eP;Ou.useActionState=eP;Ou.useOptimistic=function(e){var t=Er();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=i_.bind(null,qe,!0,n),n.dispatch=t,[e,t]};var rd={readContext:Wi,use:B5,useCallback:cP,useContext:Wi,useEffect:Jw,useImperativeHandle:lP,useInsertionEffect:sP,useLayoutEffect:oP,useMemo:dP,useReducer:I2,useRef:rP,useState:function(){return I2(sl)},useDebugValue:e_,useDeferredValue:function(e,t){var n=Xn();return uP(n,Bt.memoizedState,e,t)},useTransition:function(){var e=I2(sl)[0],t=Xn().memoizedState;return[typeof e=="boolean"?e:lp(e),t]},useSyncExternalStore:GO,useId:mP};rd.useCacheRefresh=pP;rd.useMemoCache=qw;rd.useHostTransitionStatus=n_;rd.useFormState=tP;rd.useActionState=tP;rd.useOptimistic=function(e,t){var n=Xn();return ZO(n,Bt,e,t)};var Pu={readContext:Wi,use:B5,useCallback:cP,useContext:Wi,useEffect:Jw,useImperativeHandle:lP,useInsertionEffect:sP,useLayoutEffect:oP,useMemo:dP,useReducer:e8,useRef:rP,useState:function(){return e8(sl)},useDebugValue:e_,useDeferredValue:function(e,t){var n=Xn();return Bt===null?t_(n,e,t):uP(n,Bt.memoizedState,e,t)},useTransition:function(){var e=e8(sl)[0],t=Xn().memoizedState;return[typeof e=="boolean"?e:lp(e),t]},useSyncExternalStore:GO,useId:mP};Pu.useCacheRefresh=pP;Pu.useMemoCache=qw;Pu.useHostTransitionStatus=n_;Pu.useFormState=iP;Pu.useActionState=iP;Pu.useOptimistic=function(e,t){var n=Xn();return Bt!==null?ZO(n,Bt,e,t):(n.baseState=e,[e,n.queue.dispatch])};function t8(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:sn({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var D7={isMounted:function(e){return(e=e._reactInternals)?hg(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=Qr(),r=mc(i);r.payload=t,n!=null&&(r.callback=n),t=pc(e,r,i),t!==null&&(hr(t,e,i),u0(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=Qr(),r=mc(i);r.tag=1,r.payload=t,n!=null&&(r.callback=n),t=pc(e,r,i),t!==null&&(hr(t,e,i),u0(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Qr(),i=mc(n);i.tag=2,t!=null&&(i.callback=t),t=pc(e,i,n),t!==null&&(hr(t,e,n),u0(t,e,n))}};function Kx(e,t,n,i,r,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,s,o):t.prototype&&t.prototype.isPureReactComponent?!q0(n,i)||!q0(r,s):!0}function Zx(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&D7.enqueueReplaceState(t,t.state,null)}function lu(e,t){var n=t;if("ref"in t){n={};for(var i in t)i!=="ref"&&(n[i]=t[i])}if(e=e.defaultProps){n===t&&(n=sn({},n));for(var r in e)n[r]===void 0&&(n[r]=e[r])}return n}var Cb=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function EP(e){Cb(e)}function vP(e){console.error(e)}function wP(e){Cb(e)}function Ab(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(i){setTimeout(function(){throw i})}}function qx(e,t,n){try{var i=e.onCaughtError;i(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function L7(e,t,n){return n=mc(n),n.tag=3,n.payload={element:null},n.callback=function(){Ab(e,t)},n}function _P(e){return e=mc(e),e.tag=3,e}function TP(e,t,n,i){var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var s=i.value;e.payload=function(){return r(s)},e.callback=function(){qx(t,n,i)}}var o=n.stateNode;o!==null&&typeof o.componentDidCatch=="function"&&(e.callback=function(){qx(t,n,i),typeof r!="function"&&(bc===null?bc=new Set([this]):bc.add(this));var a=i.stack;this.componentDidCatch(i.value,{componentStack:a!==null?a:""})})}function BQ(e,t,n,i,r){if(n.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(t=n.alternate,t!==null&&cp(t,n,r,!0),n=Ls.current,n!==null){switch(n.tag){case 13:return Go===null?K7():n.alternate===null&&Tn===0&&(Tn=3),n.flags&=-257,n.flags|=65536,n.lanes=r,i===x7?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([i]):t.add(i),g8(e,i,r)),!1;case 22:return n.flags|=65536,i===x7?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([i]):n.add(i)),g8(e,i,r)),!1}throw Error(ie(435,n.tag))}return g8(e,i,r),K7(),!1}if(St)return t=Ls.current,t!==null?(!(t.flags&65536)&&(t.flags|=256),t.flags|=65536,t.lanes=r,i!==S7&&(e=Error(ie(422),{cause:i}),Q0(ys(e,n)))):(i!==S7&&(t=Error(ie(423),{cause:i}),Q0(ys(t,n))),e=e.current.alternate,e.flags|=65536,r&=-r,e.lanes|=r,i=ys(i,n),r=L7(e.stateNode,i,r),a8(e,r),Tn!==4&&(Tn=2)),!1;var s=Error(ie(520),{cause:i});if(s=ys(s,n),m0===null?m0=[s]:m0.push(s),Tn!==4&&(Tn=2),t===null)return!0;i=ys(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=r&-r,n.lanes|=e,e=L7(n.stateNode,i,e),a8(n,e),!1;case 1:if(t=n.type,s=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||s!==null&&typeof s.componentDidCatch=="function"&&(bc===null||!bc.has(s))))return n.flags|=65536,r&=-r,n.lanes|=r,r=_P(r),TP(r,e,n,i),a8(n,r),!1}n=n.return}while(n!==null);return!1}var IP=Error(ie(461)),bi=!1;function xi(e,t,n,i){t.child=e===null?BO(t,null,n,i):ou(t,e.child,n,i)}function Qx(e,t,n,i,r){n=n.render;var s=t.ref;if("ref"in i){var o={};for(var a in i)a!=="ref"&&(o[a]=i[a])}else o=i;return cu(t),i=Yw(e,t,n,o,s,r),a=Ww(),e!==null&&!bi?(Kw(e,t,r),ol(e,t,r)):(St&&a&&Hw(t),t.flags|=1,xi(e,t,i,r),t.child)}function Jx(e,t,n,i,r){if(e===null){var s=n.type;return typeof s=="function"&&!l_(s)&&s.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=s,SP(e,t,s,i,r)):(e=C2(n.type,null,i,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!r_(e,r)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:q0,n(o,i)&&e.ref===t.ref)return ol(e,t,r)}return t.flags|=1,e=Uc(s,i),e.ref=t.ref,e.return=t,t.child=e}function SP(e,t,n,i,r){if(e!==null){var s=e.memoizedProps;if(q0(s,i)&&e.ref===t.ref)if(bi=!1,t.pendingProps=i=s,r_(e,r))e.flags&131072&&(bi=!0);else return t.lanes=e.lanes,ol(e,t,r)}return N7(e,t,n,i,r)}function xP(e,t,n){var i=t.pendingProps,r=i.children,s=(t.stateNode._pendingVisibility&2)!==0,o=e!==null?e.memoizedState:null;if(d0(e,t),i.mode==="hidden"||s){if(t.flags&128){if(i=o!==null?o.baseLanes|n:n,e!==null){for(r=t.child=e.child,s=0;r!==null;)s=s|r.lanes|r.childLanes,r=r.sibling;t.childLanes=s&~i}else t.childLanes=0,t.child=null;return eC(e,t,i,n)}if(n&536870912)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&T2(t,o!==null?o.cachePool:null),o!==null?$x(t,o):C7(),zO(t);else return t.lanes=t.childLanes=536870912,eC(e,t,o!==null?o.baseLanes|n:n,n)}else o!==null?(T2(t,o.cachePool),$x(t,o),ec(),t.memoizedState=null):(e!==null&&T2(t,null),C7(),ec());return xi(e,t,r,n),t.child}function eC(e,t,n,i){var r=Xw();return r=r===null?null:{parent:Jn._currentValue,pool:r},t.memoizedState={baseLanes:n,cachePool:r},e!==null&&T2(t,null),C7(),zO(t),e!==null&&cp(e,t,i,!0),null}function d0(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=2097664);else{if(typeof n!="function"&&typeof n!="object")throw Error(ie(284));(e===null||e.ref!==n)&&(t.flags|=2097664)}}function N7(e,t,n,i,r){return cu(t),n=Yw(e,t,n,i,void 0,r),i=Ww(),e!==null&&!bi?(Kw(e,t,r),ol(e,t,r)):(St&&i&&Hw(t),t.flags|=1,xi(e,t,n,r),t.child)}function tC(e,t,n,i,r,s){return cu(t),t.updateQueue=null,n=$O(t,i,n,r),VO(e),i=Ww(),e!==null&&!bi?(Kw(e,t,s),ol(e,t,s)):(St&&i&&Hw(t),t.flags|=1,xi(e,t,n,s),t.child)}function nC(e,t,n,i,r){if(cu(t),t.stateNode===null){var s=Ff,o=n.contextType;typeof o=="object"&&o!==null&&(s=Wi(o)),s=new n(i,s),t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=D7,t.stateNode=s,s._reactInternals=t,s=t.stateNode,s.props=i,s.state=t.memoizedState,s.refs={},s_(t),o=n.contextType,s.context=typeof o=="object"&&o!==null?Wi(o):Ff,s.state=t.memoizedState,o=n.getDerivedStateFromProps,typeof o=="function"&&(t8(t,n,o,i),s.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(o=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),o!==s.state&&D7.enqueueReplaceState(s,s.state,null),h0(t,i,s,r),f0(),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308),i=!0}else if(e===null){s=t.stateNode;var a=t.memoizedProps,l=lu(n,a);s.props=l;var c=s.context,d=n.contextType;o=Ff,typeof d=="object"&&d!==null&&(o=Wi(d));var u=n.getDerivedStateFromProps;d=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function",a=t.pendingProps!==a,d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a||c!==o)&&Zx(t,s,i,o),Yl=!1;var f=t.memoizedState;s.state=f,h0(t,i,s,r),f0(),c=t.memoizedState,a||f!==c||Yl?(typeof u=="function"&&(t8(t,n,u,i),c=t.memoizedState),(l=Yl||Kx(t,n,l,i,f,c,o))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=c),s.props=i,s.state=c,s.context=o,i=l):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{s=t.stateNode,H7(e,t),o=t.memoizedProps,d=lu(n,o),s.props=d,u=t.pendingProps,f=s.context,c=n.contextType,l=Ff,typeof c=="object"&&c!==null&&(l=Wi(c)),a=n.getDerivedStateFromProps,(c=typeof a=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==u||f!==l)&&Zx(t,s,i,l),Yl=!1,f=t.memoizedState,s.state=f,h0(t,i,s,r),f0();var h=t.memoizedState;o!==u||f!==h||Yl||e!==null&&e.dependencies!==null&&Mb(e.dependencies)?(typeof a=="function"&&(t8(t,n,a,i),h=t.memoizedState),(d=Yl||Kx(t,n,d,i,f,h,l)||e!==null&&e.dependencies!==null&&Mb(e.dependencies))?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(i,h,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(i,h,l)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=h),s.props=i,s.state=h,s.context=l,i=d):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),i=!1)}return s=i,d0(e,t),i=(t.flags&128)!==0,s||i?(s=t.stateNode,n=i&&typeof n.getDerivedStateFromError!="function"?null:s.render(),t.flags|=1,e!==null&&i?(t.child=ou(t,e.child,null,r),t.child=ou(t,null,n,r)):xi(e,t,n,r),t.memoizedState=s.state,e=t.child):e=ol(e,t,r),e}function iC(e,t,n,i){return op(),t.flags|=256,xi(e,t,n,i),t.child}var n8={dehydrated:null,treeContext:null,retryLane:0};function i8(e){return{baseLanes:e,cachePool:HO()}}function r8(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=Ts),e}function CP(e,t,n){var i=t.pendingProps,r=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(ei.current&2)!==0),o&&(r=!0,t.flags&=-129),o=(t.flags&32)!==0,t.flags&=-33,e===null){if(St){if(r?Jl(t):ec(),St){var a=Mi,l;if(l=a){e:{for(l=a,a=Do;l.nodeType!==8;){if(!a){a=null;break e}if(l=ro(l.nextSibling),l===null){a=null;break e}}a=l}a!==null?(t.memoizedState={dehydrated:a,treeContext:jd!==null?{id:za,overflow:Ha}:null,retryLane:536870912},l=_s(18,null,null,0),l.stateNode=a,l.return=t,t.child=l,lr=t,Mi=null,l=!0):l=!1}l||su(t)}if(a=t.memoizedState,a!==null&&(a=a.dehydrated,a!==null))return a.data==="$!"?t.lanes=16:t.lanes=536870912,null;Va(t)}return a=i.children,i=i.fallback,r?(ec(),r=t.mode,a=P7({mode:"hidden",children:a},r),i=Wd(i,r,n,null),a.return=t,i.return=t,a.sibling=i,t.child=a,r=t.child,r.memoizedState=i8(n),r.childLanes=r8(e,o,n),t.memoizedState=n8,i):(Jl(t),O7(t,a))}if(l=e.memoizedState,l!==null&&(a=l.dehydrated,a!==null)){if(s)t.flags&256?(Jl(t),t.flags&=-257,t=s8(e,t,n)):t.memoizedState!==null?(ec(),t.child=e.child,t.flags|=128,t=null):(ec(),r=i.fallback,a=t.mode,i=P7({mode:"visible",children:i.children},a),r=Wd(r,a,n,null),r.flags|=2,i.return=t,r.return=t,i.sibling=r,t.child=i,ou(t,e.child,null,n),i=t.child,i.memoizedState=i8(n),i.childLanes=r8(e,o,n),t.memoizedState=n8,t=r);else if(Jl(t),a.data==="$!"){if(o=a.nextSibling&&a.nextSibling.dataset,o)var c=o.dgst;o=c,i=Error(ie(419)),i.stack="",i.digest=o,Q0({value:i,source:null,stack:null}),t=s8(e,t,n)}else if(bi||cp(e,t,n,!1),o=(n&e.childLanes)!==0,bi||o){if(o=Qt,o!==null){if(i=n&-n,i&42)i=1;else switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=64;break;case 268435456:i=134217728;break;default:i=0}if(i=i&(o.suspendedLanes|n)?0:i,i!==0&&i!==l.retryLane)throw l.retryLane=i,Lc(e,i),hr(o,e,i),IP}a.data==="$?"||K7(),t=s8(e,t,n)}else a.data==="$?"?(t.flags|=128,t.child=e.child,t=eJ.bind(null,e),a._reactRetry=t,t=null):(e=l.treeContext,Mi=ro(a.nextSibling),lr=t,St=!0,Qs=null,Do=!1,e!==null&&(ps[Us++]=za,ps[Us++]=Ha,ps[Us++]=jd,za=e.id,Ha=e.overflow,jd=t),t=O7(t,i.children),t.flags|=4096);return t}return r?(ec(),r=i.fallback,a=t.mode,l=e.child,c=l.sibling,i=Uc(l,{mode:"hidden",children:i.children}),i.subtreeFlags=l.subtreeFlags&31457280,c!==null?r=Uc(c,r):(r=Wd(r,a,n,null),r.flags|=2),r.return=t,i.return=t,i.sibling=r,t.child=i,i=r,r=t.child,a=e.child.memoizedState,a===null?a=i8(n):(l=a.cachePool,l!==null?(c=Jn._currentValue,l=l.parent!==c?{parent:c,pool:c}:l):l=HO(),a={baseLanes:a.baseLanes|n,cachePool:l}),r.memoizedState=a,r.childLanes=r8(e,o,n),t.memoizedState=n8,i):(Jl(t),n=e.child,e=n.sibling,n=Uc(n,{mode:"visible",children:i.children}),n.return=t,n.sibling=null,e!==null&&(o=t.deletions,o===null?(t.deletions=[e],t.flags|=16):o.push(e)),t.child=n,t.memoizedState=null,n)}function O7(e,t){return t=P7({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function P7(e,t){return ZP(e,t,0,null)}function s8(e,t,n){return ou(t,e.child,null,n),e=O7(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function rC(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),B7(e.return,t,n)}function o8(e,t,n,i,r){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function AP(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(xi(e,t,i.children,n),i=ei.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&rC(e,n,t);else if(e.tag===19)rC(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}switch(dn(ei,i),r){case"forwards":for(n=t.child,r=null;n!==null;)e=n.alternate,e!==null&&Ib(e)===null&&(r=n),n=n.sibling;n=r,n===null?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),o8(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&Ib(e)===null){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}o8(t,!0,n,null,s);break;case"together":o8(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ol(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Pc|=t.lanes,!(n&t.childLanes))if(e!==null){if(cp(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(ie(153));if(t.child!==null){for(e=t.child,n=Uc(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Uc(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function r_(e,t){return e.lanes&t?!0:(e=e.dependencies,!!(e!==null&&Mb(e)))}function zQ(e,t,n){switch(t.tag){case 3:pb(t,t.stateNode.containerInfo),tc(t,Jn,e.memoizedState.cache),op();break;case 27:case 5:U7(t);break;case 4:pb(t,t.stateNode.containerInfo);break;case 10:tc(t,t.type,t.memoizedProps.value);break;case 13:var i=t.memoizedState;if(i!==null)return i.dehydrated!==null?(Jl(t),t.flags|=128,null):n&t.child.childLanes?CP(e,t,n):(Jl(t),e=ol(e,t,n),e!==null?e.sibling:null);Jl(t);break;case 19:var r=(e.flags&128)!==0;if(i=(n&t.childLanes)!==0,i||(cp(e,t,n,!1),i=(n&t.childLanes)!==0),r){if(i)return AP(e,t,n);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),dn(ei,ei.current),i)break;return null;case 22:case 23:return t.lanes=0,xP(e,t,n);case 24:tc(t,Jn,e.memoizedState.cache)}return ol(e,t,n)}function MP(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)bi=!0;else{if(!r_(e,n)&&!(t.flags&128))return bi=!1,zQ(e,t,n);bi=!!(e.flags&131072)}else bi=!1,St&&t.flags&1048576&&NO(t,_b,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var i=t.elementType,r=i._init;if(i=r(i._payload),t.type=i,typeof i=="function")l_(i)?(e=lu(i,e),t.tag=1,t=nC(null,t,i,e,n)):(t.tag=0,t=N7(null,t,i,e,n));else{if(i!=null){if(r=i.$$typeof,r===Aw){t.tag=11,t=Qx(null,t,i,e,n);break e}else if(r===Mw){t.tag=14,t=Jx(null,t,i,e,n);break e}}throw t=m7(i)||i,Error(ie(306,t,""))}}return t;case 0:return N7(e,t,t.type,t.pendingProps,n);case 1:return i=t.type,r=lu(i,t.pendingProps),nC(e,t,i,r,n);case 3:e:{if(pb(t,t.stateNode.containerInfo),e===null)throw Error(ie(387));var s=t.pendingProps;r=t.memoizedState,i=r.element,H7(e,t),h0(t,s,null,n);var o=t.memoizedState;if(s=o.cache,tc(t,Jn,s),s!==r.cache&&z7(t,[Jn],n,!0),f0(),s=o.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=r,t.memoizedState=r,t.flags&256){t=iC(e,t,s,n);break e}else if(s!==i){i=ys(Error(ie(424)),t),Q0(i),t=iC(e,t,s,n);break e}else for(Mi=ro(t.stateNode.containerInfo.firstChild),lr=t,St=!0,Qs=null,Do=!0,n=BO(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(op(),s===i){t=ol(e,t,n);break e}xi(e,t,s,n)}t=t.child}return t;case 26:return d0(e,t),e===null?(n=wC(t.type,null,t.pendingProps,null))?t.memoizedState=n:St||(n=t.type,e=t.pendingProps,i=Pb(gc.current).createElement(n),i[Yi]=t,i[Ar]=e,ki(i,n,e),pi(i),t.stateNode=i):t.memoizedState=wC(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return U7(t),e===null&&St&&(i=t.stateNode=gF(t.type,t.pendingProps,gc.current),lr=t,Do=!0,Mi=ro(i.firstChild)),i=t.pendingProps.children,e!==null||St?xi(e,t,i,n):t.child=ou(t,null,i,n),d0(e,t),t.child;case 5:return e===null&&St&&((r=i=Mi)&&(i=pJ(i,t.type,t.pendingProps,Do),i!==null?(t.stateNode=i,lr=t,Mi=ro(i.firstChild),Do=!1,r=!0):r=!1),r||su(t)),U7(t),r=t.type,s=t.pendingProps,o=e!==null?e.memoizedProps:null,i=s.children,e4(r,s)?i=null:o!==null&&e4(r,o)&&(t.flags|=32),t.memoizedState!==null&&(r=Yw(e,t,DQ,null,null,n),rm._currentValue=r),d0(e,t),xi(e,t,i,n),t.child;case 6:return e===null&&St&&((e=n=Mi)&&(n=UJ(n,t.pendingProps,Do),n!==null?(t.stateNode=n,lr=t,Mi=null,e=!0):e=!1),e||su(t)),null;case 13:return CP(e,t,n);case 4:return pb(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=ou(t,null,i,n):xi(e,t,i,n),t.child;case 11:return Qx(e,t,t.type,t.pendingProps,n);case 7:return xi(e,t,t.pendingProps,n),t.child;case 8:return xi(e,t,t.pendingProps.children,n),t.child;case 12:return xi(e,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,tc(t,t.type,i.value),xi(e,t,i.children,n),t.child;case 9:return r=t.type._context,i=t.pendingProps.children,cu(t),r=Wi(r),i=i(r),t.flags|=1,xi(e,t,i,n),t.child;case 14:return Jx(e,t,t.type,t.pendingProps,n);case 15:return SP(e,t,t.type,t.pendingProps,n);case 19:return AP(e,t,n);case 22:return xP(e,t,n);case 24:return cu(t),i=Wi(Jn),e===null?(r=Xw(),r===null&&(r=Qt,s=Gw(),r.pooledCache=s,s.refCount++,s!==null&&(r.pooledCacheLanes|=n),r=s),t.memoizedState={parent:i,cache:r},s_(t),tc(t,Jn,r)):(e.lanes&n&&(H7(e,t),h0(t,null,null,n),f0()),r=e.memoizedState,s=t.memoizedState,r.parent!==i?(r={parent:i,cache:i},t.memoizedState=r,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=r),tc(t,Jn,i)):(i=s.cache,tc(t,Jn,i),i!==r.cache&&z7(t,[Jn],n,!0))),xi(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(ie(156,t.tag))}var F7=la(null),Fu=null,$a=null;function tc(e,t,n){dn(F7,t._currentValue),t._currentValue=n}function Ya(e){e._currentValue=F7.current,vi(F7)}function B7(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function z7(e,t,n,i){var r=e.child;for(r!==null&&(r.return=e);r!==null;){var s=r.dependencies;if(s!==null){var o=r.child;s=s.firstContext;e:for(;s!==null;){var a=s;s=r;for(var l=0;l<t.length;l++)if(a.context===t[l]){s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),B7(s.return,n,e),i||(o=null);break e}s=a.next}}else if(r.tag===18){if(o=r.return,o===null)throw Error(ie(341));o.lanes|=n,s=o.alternate,s!==null&&(s.lanes|=n),B7(o,n,e),o=null}else o=r.child;if(o!==null)o.return=r;else for(o=r;o!==null;){if(o===e){o=null;break}if(r=o.sibling,r!==null){r.return=o.return,o=r;break}o=o.return}r=o}}function cp(e,t,n,i){e=null;for(var r=t,s=!1;r!==null;){if(!s){if(r.flags&524288)s=!0;else if(r.flags&262144)break}if(r.tag===10){var o=r.alternate;if(o===null)throw Error(ie(387));if(o=o.memoizedProps,o!==null){var a=r.type;rs(r.pendingProps.value,o.value)||(e!==null?e.push(a):e=[a])}}else if(r===mb.current){if(o=r.alternate,o===null)throw Error(ie(387));o.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(e!==null?e.push(rm):e=[rm])}r=r.return}e!==null&&z7(t,e,n,i),t.flags|=262144}function Mb(e){for(e=e.firstContext;e!==null;){if(!rs(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function cu(e){Fu=e,$a=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Wi(e){return kP(Fu,e)}function _U(e,t){return Fu===null&&cu(e),kP(e,t)}function kP(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},$a===null){if(e===null)throw Error(ie(308));$a=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else $a=$a.next=t;return n}var Yl=!1;function s_(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function H7(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function mc(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function pc(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,bn&2){var r=i.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),i.pending=t,t=vb(e),LO(e,null,n),t}return P5(e,i,t,n),vb(e)}function u0(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194176)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,aO(e,n)}}function a8(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};s===null?r=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?r=s=t:s=s.next=t}else r=s=t;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,callbacks:i.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var V7=!1;function f0(){if(V7){var e=rh;if(e!==null)throw e}}function h0(e,t,n,i){V7=!1;var r=e.updateQueue;Yl=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var d=e.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=l))}if(s!==null){var u=r.baseState;o=0,d=c=l=null,a=s;do{var f=a.lane&-536870913,h=f!==a.lane;if(h?(gt&f)===f:(i&f)===f){f!==0&&f===Ah&&(V7=!0),d!==null&&(d=d.next={lane:0,tag:a.tag,payload:a.payload,callback:null,next:null});e:{var m=e,p=a;f=t;var U=n;switch(p.tag){case 1:if(m=p.payload,typeof m=="function"){u=m.call(U,u,f);break e}u=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,f=typeof m=="function"?m.call(U,u,f):m,f==null)break e;u=sn({},u,f);break e;case 2:Yl=!0}}f=a.callback,f!==null&&(e.flags|=64,h&&(e.flags|=8192),h=r.callbacks,h===null?r.callbacks=[f]:h.push(f))}else h={lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(c=d=h,l=u):d=d.next=h,o|=f;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;h=a,a=h.next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}while(!0);d===null&&(l=u),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=d,s===null&&(r.shared.lanes=0),Pc|=o,e.lanes=o,e.memoizedState=u}}function RP(e,t){if(typeof e!="function")throw Error(ie(191,e));e.call(t)}function DP(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)RP(n[e],t)}function dp(e,t){try{var n=t.updateQueue,i=n!==null?n.lastEffect:null;if(i!==null){var r=i.next;n=r;do{if((n.tag&e)===e){i=void 0;var s=n.create,o=n.inst;i=s(),o.destroy=i}n=n.next}while(n!==r)}}catch(a){Xt(t,t.return,a)}}function Oc(e,t,n){try{var i=t.updateQueue,r=i!==null?i.lastEffect:null;if(r!==null){var s=r.next;i=s;do{if((i.tag&e)===e){var o=i.inst,a=o.destroy;if(a!==void 0){o.destroy=void 0,r=t;var l=n;try{a()}catch(c){Xt(r,l,c)}}}i=i.next}while(i!==s)}}catch(c){Xt(t,t.return,c)}}function LP(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{DP(t,n)}catch(i){Xt(e,e.return,i)}}}function NP(e,t,n){n.props=lu(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(i){Xt(e,t,i)}}function Nd(e,t){try{var n=e.ref;if(n!==null){var i=e.stateNode;switch(e.tag){case 26:case 27:case 5:var r=i;break;default:r=i}typeof n=="function"?e.refCleanup=n(r):n.current=r}}catch(s){Xt(e,t,s)}}function $r(e,t){var n=e.ref,i=e.refCleanup;if(n!==null)if(typeof i=="function")try{i()}catch(r){Xt(e,t,r)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(r){Xt(e,t,r)}else n.current=null}function OP(e){var t=e.type,n=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(r){Xt(e,e.return,r)}}function sC(e,t,n){try{var i=e.stateNode;uJ(i,e.type,n,t),i[Ar]=t}catch(r){Xt(e,e.return,r)}}function PP(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27||e.tag===4}function l8(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||PP(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==27&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function $7(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=G5));else if(i!==4&&i!==27&&(e=e.child,e!==null))for($7(e,t,n),e=e.sibling;e!==null;)$7(e,t,n),e=e.sibling}function kb(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&i!==27&&(e=e.child,e!==null))for(kb(e,t,n),e=e.sibling;e!==null;)kb(e,t,n),e=e.sibling}var ka=!1,_n=!1,c8=!1,oC=typeof WeakSet=="function"?WeakSet:Set,gi=null,aC=!1;function HQ(e,t){if(e=e.containerInfo,Q7=Hb,e=xO(e),Fw(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,d=0,u=e,f=null;t:for(;;){for(var h;u!==n||r!==0&&u.nodeType!==3||(a=o+r),u!==s||i!==0&&u.nodeType!==3||(l=o+i),u.nodeType===3&&(o+=u.nodeValue.length),(h=u.firstChild)!==null;)f=u,u=h;for(;;){if(u===e)break t;if(f===n&&++c===r&&(a=o),f===s&&++d===i&&(l=o),(h=u.nextSibling)!==null)break;u=f,f=u.parentNode}u=h}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(J7={focusedElem:e,selectionRange:n},Hb=!1,gi=t;gi!==null;)if(t=gi,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,gi=e;else for(;gi!==null;){switch(t=gi,s=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if(e&1024&&s!==null){e=void 0,n=t,r=s.memoizedProps,s=s.memoizedState,i=n.stateNode;try{var m=lu(n.type,r,n.elementType===n.type);e=i.getSnapshotBeforeUpdate(m,s),i.__reactInternalSnapshotBeforeUpdate=e}catch(p){Xt(n,n.return,p)}}break;case 3:if(e&1024){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)t4(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":t4(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(e&1024)throw Error(ie(163))}if(e=t.sibling,e!==null){e.return=t.return,gi=e;break}gi=t.return}return m=aC,aC=!1,m}function FP(e,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:Ua(e,n),i&4&&dp(5,n);break;case 1:if(Ua(e,n),i&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(a){Xt(n,n.return,a)}else{var r=lu(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}catch(a){Xt(n,n.return,a)}}i&64&&LP(n),i&512&&Nd(n,n.return);break;case 3:if(Ua(e,n),i&64&&(i=n.updateQueue,i!==null)){if(e=null,n.child!==null)switch(n.child.tag){case 27:case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}try{DP(i,e)}catch(a){Xt(n,n.return,a)}}break;case 26:Ua(e,n),i&512&&Nd(n,n.return);break;case 27:case 5:Ua(e,n),t===null&&i&4&&OP(n),i&512&&Nd(n,n.return);break;case 12:Ua(e,n);break;case 13:Ua(e,n),i&4&&HP(e,n);break;case 22:if(r=n.memoizedState!==null||ka,!r){t=t!==null&&t.memoizedState!==null||_n;var s=ka,o=_n;ka=r,(_n=t)&&!o?Hl(e,n,(n.subtreeFlags&8772)!==0):Ua(e,n),ka=s,_n=o}i&512&&(n.memoizedProps.mode==="manual"?Nd(n,n.return):$r(n,n.return));break;default:Ua(e,n)}}function BP(e){var t=e.alternate;t!==null&&(e.alternate=null,BP(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Rw(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Bn=null,Pr=!1;function pa(e,t,n){for(n=n.child;n!==null;)zP(e,t,n),n=n.sibling}function zP(e,t,n){if(Zr&&typeof Zr.onCommitFiberUnmount=="function")try{Zr.onCommitFiberUnmount(np,n)}catch{}switch(n.tag){case 26:_n||$r(n,t),pa(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:_n||$r(n,t);var i=Bn,r=Pr;for(Bn=n.stateNode,pa(e,t,n),n=n.stateNode,t=n.attributes;t.length;)n.removeAttributeNode(t[0]);Rw(n),Bn=i,Pr=r;break;case 5:_n||$r(n,t);case 6:r=Bn;var s=Pr;if(Bn=null,pa(e,t,n),Bn=r,Pr=s,Bn!==null)if(Pr)try{e=Bn,i=n.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)}catch(o){Xt(n,t,o)}else try{Bn.removeChild(n.stateNode)}catch(o){Xt(n,t,o)}break;case 18:Bn!==null&&(Pr?(t=Bn,n=n.stateNode,t.nodeType===8?v8(t.parentNode,n):t.nodeType===1&&v8(t,n),am(t)):v8(Bn,n.stateNode));break;case 4:i=Bn,r=Pr,Bn=n.stateNode.containerInfo,Pr=!0,pa(e,t,n),Bn=i,Pr=r;break;case 0:case 11:case 14:case 15:_n||Oc(2,n,t),_n||Oc(4,n,t),pa(e,t,n);break;case 1:_n||($r(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"&&NP(n,t,i)),pa(e,t,n);break;case 21:pa(e,t,n);break;case 22:_n||$r(n,t),_n=(i=_n)||n.memoizedState!==null,pa(e,t,n),_n=i;break;default:pa(e,t,n)}}function HP(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{am(e)}catch(n){Xt(t,t.return,n)}}function VQ(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new oC),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new oC),t;default:throw Error(ie(435,e.tag))}}function d8(e,t){var n=VQ(e);t.forEach(function(i){var r=tJ.bind(null,e,i);n.has(i)||(n.add(i),i.then(r,r))})}function ls(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i],s=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 27:case 5:Bn=a.stateNode,Pr=!1;break e;case 3:Bn=a.stateNode.containerInfo,Pr=!0;break e;case 4:Bn=a.stateNode.containerInfo,Pr=!0;break e}a=a.return}if(Bn===null)throw Error(ie(160));zP(s,o,r),Bn=null,Pr=!1,s=r.alternate,s!==null&&(s.return=null),r.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)VP(t,e),t=t.sibling}var Ys=null;function VP(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:ls(t,e),cs(e),i&4&&(Oc(3,e,e.return),dp(3,e),Oc(5,e,e.return));break;case 1:ls(t,e),cs(e),i&512&&(_n||n===null||$r(n,n.return)),i&64&&ka&&(e=e.updateQueue,e!==null&&(i=e.callbacks,i!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?i:n.concat(i))));break;case 26:var r=Ys;if(ls(t,e),cs(e),i&512&&(_n||n===null||$r(n,n.return)),i&4){var s=n!==null?n.memoizedState:null;if(i=e.memoizedState,n===null)if(i===null)if(e.stateNode===null){e:{i=e.type,n=e.memoizedProps,r=r.ownerDocument||r;t:switch(i){case"title":s=r.getElementsByTagName("title")[0],(!s||s[W0]||s[Yi]||s.namespaceURI==="http://www.w3.org/2000/svg"||s.hasAttribute("itemprop"))&&(s=r.createElement(i),r.head.insertBefore(s,r.querySelector("head > title"))),ki(s,i,n),s[Yi]=e,pi(s),i=s;break e;case"link":var o=TC("link","href",r).get(i+(n.href||""));if(o){for(var a=0;a<o.length;a++)if(s=o[a],s.getAttribute("href")===(n.href==null?null:n.href)&&s.getAttribute("rel")===(n.rel==null?null:n.rel)&&s.getAttribute("title")===(n.title==null?null:n.title)&&s.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){o.splice(a,1);break t}}s=r.createElement(i),ki(s,i,n),r.head.appendChild(s);break;case"meta":if(o=TC("meta","content",r).get(i+(n.content||""))){for(a=0;a<o.length;a++)if(s=o[a],s.getAttribute("content")===(n.content==null?null:""+n.content)&&s.getAttribute("name")===(n.name==null?null:n.name)&&s.getAttribute("property")===(n.property==null?null:n.property)&&s.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&s.getAttribute("charset")===(n.charSet==null?null:n.charSet)){o.splice(a,1);break t}}s=r.createElement(i),ki(s,i,n),r.head.appendChild(s);break;default:throw Error(ie(468,i))}s[Yi]=e,pi(s),i=s}e.stateNode=i}else IC(r,e.type,e.stateNode);else e.stateNode=_C(r,i,e.memoizedProps);else s!==i?(s===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):s.count--,i===null?IC(r,e.type,e.stateNode):_C(r,i,e.memoizedProps)):i===null&&e.stateNode!==null&&sC(e,e.memoizedProps,n.memoizedProps)}break;case 27:if(i&4&&e.alternate===null){r=e.stateNode,s=e.memoizedProps;try{for(var l=r.firstChild;l;){var c=l.nextSibling,d=l.nodeName;l[W0]||d==="HEAD"||d==="BODY"||d==="SCRIPT"||d==="STYLE"||d==="LINK"&&l.rel.toLowerCase()==="stylesheet"||r.removeChild(l),l=c}for(var u=e.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);ki(r,u,s),r[Yi]=e,r[Ar]=s}catch(m){Xt(e,e.return,m)}}case 5:if(ls(t,e),cs(e),i&512&&(_n||n===null||$r(n,n.return)),e.flags&32){r=e.stateNode;try{xh(r,"")}catch(m){Xt(e,e.return,m)}}i&4&&e.stateNode!=null&&(r=e.memoizedProps,sC(e,r,n!==null?n.memoizedProps:r)),i&1024&&(c8=!0);break;case 6:if(ls(t,e),cs(e),i&4){if(e.stateNode===null)throw Error(ie(162));i=e.memoizedProps,n=e.stateNode;try{n.nodeValue=i}catch(m){Xt(e,e.return,m)}}break;case 3:if(M2=null,r=Ys,Ys=Fb(t.containerInfo),ls(t,e),Ys=r,cs(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{am(t.containerInfo)}catch(m){Xt(e,e.return,m)}c8&&(c8=!1,$P(e));break;case 4:i=Ys,Ys=Fb(e.stateNode.containerInfo),ls(t,e),cs(e),Ys=i;break;case 12:ls(t,e),cs(e);break;case 13:ls(t,e),cs(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(u_=$o()),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,d8(e,i)));break;case 22:if(i&512&&(_n||n===null||$r(n,n.return)),l=e.memoizedState!==null,c=n!==null&&n.memoizedState!==null,d=ka,u=_n,ka=d||l,_n=u||c,ls(t,e),_n=u,ka=d,cs(e),t=e.stateNode,t._current=e,t._visibility&=-3,t._visibility|=t._pendingVisibility&2,i&8192&&(t._visibility=l?t._visibility&-2:t._visibility|1,l&&(t=ka||_n,n===null||c||t||yf(e)),e.memoizedProps===null||e.memoizedProps.mode!=="manual"))e:for(n=null,t=e;;){if(t.tag===5||t.tag===26||t.tag===27){if(n===null){c=n=t;try{if(r=c.stateNode,l)s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none";else{o=c.stateNode,a=c.memoizedProps.style;var h=a!=null&&a.hasOwnProperty("display")?a.display:null;o.style.display=h==null||typeof h=="boolean"?"":(""+h).trim()}}catch(m){Xt(c,c.return,m)}}}else if(t.tag===6){if(n===null){c=t;try{c.stateNode.nodeValue=l?"":c.memoizedProps}catch(m){Xt(c,c.return,m)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}i&4&&(i=e.updateQueue,i!==null&&(n=i.retryQueue,n!==null&&(i.retryQueue=null,d8(e,n))));break;case 19:ls(t,e),cs(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,d8(e,i)));break;case 21:break;default:ls(t,e),cs(e)}}function cs(e){var t=e.flags;if(t&2){try{if(e.tag!==27){e:{for(var n=e.return;n!==null;){if(PP(n)){var i=n;break e}n=n.return}throw Error(ie(160))}switch(i.tag){case 27:var r=i.stateNode,s=l8(e);kb(e,s,r);break;case 5:var o=i.stateNode;i.flags&32&&(xh(o,""),i.flags&=-33);var a=l8(e);kb(e,a,o);break;case 3:case 4:var l=i.stateNode.containerInfo,c=l8(e);$7(e,c,l);break;default:throw Error(ie(161))}}}catch(d){Xt(e,e.return,d)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function $P(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;$P(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Ua(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)FP(e,t.alternate,t),t=t.sibling}function yf(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Oc(4,t,t.return),yf(t);break;case 1:$r(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&NP(t,t.return,n),yf(t);break;case 26:case 27:case 5:$r(t,t.return),yf(t);break;case 22:$r(t,t.return),t.memoizedState===null&&yf(t);break;default:yf(t)}e=e.sibling}}function Hl(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var i=t.alternate,r=e,s=t,o=s.flags;switch(s.tag){case 0:case 11:case 15:Hl(r,s,n),dp(4,s);break;case 1:if(Hl(r,s,n),i=s,r=i.stateNode,typeof r.componentDidMount=="function")try{r.componentDidMount()}catch(c){Xt(i,i.return,c)}if(i=s,r=i.updateQueue,r!==null){var a=i.stateNode;try{var l=r.shared.hiddenCallbacks;if(l!==null)for(r.shared.hiddenCallbacks=null,r=0;r<l.length;r++)RP(l[r],a)}catch(c){Xt(i,i.return,c)}}n&&o&64&&LP(s),Nd(s,s.return);break;case 26:case 27:case 5:Hl(r,s,n),n&&i===null&&o&4&&OP(s),Nd(s,s.return);break;case 12:Hl(r,s,n);break;case 13:Hl(r,s,n),n&&o&4&&HP(r,s);break;case 22:s.memoizedState===null&&Hl(r,s,n),Nd(s,s.return);break;default:Hl(r,s,n)}t=t.sibling}}function o_(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&ap(n))}function a_(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&ap(e))}function Ll(e,t,n,i){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)GP(e,t,n,i),t=t.sibling}function GP(e,t,n,i){var r=t.flags;switch(t.tag){case 0:case 11:case 15:Ll(e,t,n,i),r&2048&&dp(9,t);break;case 3:Ll(e,t,n,i),r&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&ap(e)));break;case 12:if(r&2048){Ll(e,t,n,i),e=t.stateNode;try{var s=t.memoizedProps,o=s.id,a=s.onPostCommit;typeof a=="function"&&a(o,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(l){Xt(t,t.return,l)}}else Ll(e,t,n,i);break;case 23:break;case 22:s=t.stateNode,t.memoizedState!==null?s._visibility&4?Ll(e,t,n,i):g0(e,t):s._visibility&4?Ll(e,t,n,i):(s._visibility|=4,Ef(e,t,n,i,(t.subtreeFlags&10256)!==0)),r&2048&&o_(t.alternate,t);break;case 24:Ll(e,t,n,i),r&2048&&a_(t.alternate,t);break;default:Ll(e,t,n,i)}}function Ef(e,t,n,i,r){for(r=r&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var s=e,o=t,a=n,l=i,c=o.flags;switch(o.tag){case 0:case 11:case 15:Ef(s,o,a,l,r),dp(8,o);break;case 23:break;case 22:var d=o.stateNode;o.memoizedState!==null?d._visibility&4?Ef(s,o,a,l,r):g0(s,o):(d._visibility|=4,Ef(s,o,a,l,r)),r&&c&2048&&o_(o.alternate,o);break;case 24:Ef(s,o,a,l,r),r&&c&2048&&a_(o.alternate,o);break;default:Ef(s,o,a,l,r)}t=t.sibling}}function g0(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,i=t,r=i.flags;switch(i.tag){case 22:g0(n,i),r&2048&&o_(i.alternate,i);break;case 24:g0(n,i),r&2048&&a_(i.alternate,i);break;default:g0(n,i)}t=t.sibling}}var N1=8192;function sf(e){if(e.subtreeFlags&N1)for(e=e.child;e!==null;)XP(e),e=e.sibling}function XP(e){switch(e.tag){case 26:sf(e),e.flags&N1&&e.memoizedState!==null&&MJ(Ys,e.memoizedState,e.memoizedProps);break;case 5:sf(e);break;case 3:case 4:var t=Ys;Ys=Fb(e.stateNode.containerInfo),sf(e),Ys=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=N1,N1=16777216,sf(e),N1=t):sf(e));break;default:sf(e)}}function jP(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function s1(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];gi=i,WP(i,e)}jP(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)YP(e),e=e.sibling}function YP(e){switch(e.tag){case 0:case 11:case 15:s1(e),e.flags&2048&&Oc(9,e,e.return);break;case 3:s1(e);break;case 12:s1(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&4&&(e.return===null||e.return.tag!==13)?(t._visibility&=-5,x2(e)):s1(e);break;default:s1(e)}}function x2(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];gi=i,WP(i,e)}jP(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Oc(8,t,t.return),x2(t);break;case 22:n=t.stateNode,n._visibility&4&&(n._visibility&=-5,x2(t));break;default:x2(t)}e=e.sibling}}function WP(e,t){for(;gi!==null;){var n=gi;switch(n.tag){case 0:case 11:case 15:Oc(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var i=n.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:ap(n.memoizedState.cache)}if(i=n.child,i!==null)i.return=n,gi=i;else e:for(n=e;gi!==null;){i=gi;var r=i.sibling,s=i.return;if(BP(i),i===n){gi=null;break e}if(r!==null){r.return=s,gi=r;break e}gi=s}}}function $Q(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _s(e,t,n,i){return new $Q(e,t,n,i)}function l_(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Uc(e,t){var n=e.alternate;return n===null?(n=_s(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&31457280,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function KP(e,t){e.flags&=31457282;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function C2(e,t,n,i,r,s){var o=0;if(i=e,typeof e=="function")l_(e)&&(o=1);else if(typeof e=="string")o=CJ(e,n,Vo.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case kf:return Wd(n.children,r,s,t);case ZN:o=8,r|=24;break;case f7:return e=_s(12,n,t,r|2),e.elementType=f7,e.lanes=s,e;case h7:return e=_s(13,n,t,r),e.elementType=h7,e.lanes=s,e;case g7:return e=_s(19,n,t,r),e.elementType=g7,e.lanes=s,e;case QN:return ZP(n,r,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case gq:case Ba:o=10;break e;case qN:o=9;break e;case Aw:o=11;break e;case Mw:o=14;break e;case jl:o=16,i=null;break e}o=29,n=Error(ie(130,e===null?"null":typeof e,"")),i=null}return t=_s(o,n,t,r),t.elementType=e,t.type=i,t.lanes=s,t}function Wd(e,t,n,i){return e=_s(7,e,i,t),e.lanes=n,e}function ZP(e,t,n,i){e=_s(22,e,i,t),e.elementType=QN,e.lanes=n;var r={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var s=r._current;if(s===null)throw Error(ie(456));if(!(r._pendingVisibility&2)){var o=Lc(s,2);o!==null&&(r._pendingVisibility|=2,hr(o,s,2))}},attach:function(){var s=r._current;if(s===null)throw Error(ie(456));if(r._pendingVisibility&2){var o=Lc(s,2);o!==null&&(r._pendingVisibility&=-3,hr(o,s,2))}}};return e.stateNode=r,e}function u8(e,t,n){return e=_s(6,e,null,t),e.lanes=n,e}function f8(e,t,n){return t=_s(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ba(e){e.flags|=4}function lC(e,t){if(t.type!=="stylesheet"||t.state.loading&4)e.flags&=-16777217;else if(e.flags|=16777216,!UF(t)){if(t=Ls.current,t!==null&&((gt&4194176)===gt?Go!==null:(gt&62914560)!==gt&&!(gt&536870912)||t!==Go))throw a0=x7,OO;e.flags|=8192}}function TU(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?sO():536870912,e.lanes|=t,kh|=t)}function o1(e,t){if(!St)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function hn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&31457280,i|=r.flags&31457280,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function GQ(e,t,n){var i=t.pendingProps;switch(Vw(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hn(t),null;case 1:return hn(t),null;case 3:return n=t.stateNode,i=null,e!==null&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),Ya(Jn),Ih(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(i1(t)?ba(t):e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Qs!==null&&(W7(Qs),Qs=null))),hn(t),null;case 26:return n=t.memoizedState,e===null?(ba(t),n!==null?(hn(t),lC(t,n)):(hn(t),t.flags&=-16777217)):n?n!==e.memoizedState?(ba(t),hn(t),lC(t,n)):(hn(t),t.flags&=-16777217):(e.memoizedProps!==i&&ba(t),hn(t),t.flags&=-16777217),null;case 27:Ub(t),n=gc.current;var r=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==i&&ba(t);else{if(!i){if(t.stateNode===null)throw Error(ie(166));return hn(t),null}e=Vo.current,i1(t)?Fx(t):(e=gF(r,i,n),t.stateNode=e,ba(t))}return hn(t),null;case 5:if(Ub(t),n=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&ba(t);else{if(!i){if(t.stateNode===null)throw Error(ie(166));return hn(t),null}if(e=Vo.current,i1(t))Fx(t);else{switch(r=Pb(gc.current),e){case 1:e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":e=r.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof i.is=="string"?r.createElement("select",{is:i.is}):r.createElement("select"),i.multiple?e.multiple=!0:i.size&&(e.size=i.size);break;default:e=typeof i.is=="string"?r.createElement(n,{is:i.is}):r.createElement(n)}}e[Yi]=t,e[Ar]=i;e:for(r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.tag!==27&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;r.sibling===null;){if(r.return===null||r.return===t)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}t.stateNode=e;e:switch(ki(e,n,i),n){case"button":case"input":case"select":case"textarea":e=!!i.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&ba(t)}}return hn(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==i&&ba(t);else{if(typeof i!="string"&&t.stateNode===null)throw Error(ie(166));if(e=gc.current,i1(t)){if(e=t.stateNode,n=t.memoizedProps,i=null,r=lr,r!==null)switch(r.tag){case 27:case 5:i=r.memoizedProps}e[Yi]=t,e=!!(e.nodeValue===n||i!==null&&i.suppressHydrationWarning===!0||uF(e.nodeValue,n)),e||su(t)}else e=Pb(e).createTextNode(i),e[Yi]=t,t.stateNode=e}return hn(t),null;case 13:if(i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(r=i1(t),i!==null&&i.dehydrated!==null){if(e===null){if(!r)throw Error(ie(318));if(r=t.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(ie(317));r[Yi]=t}else op(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;hn(t),r=!1}else Qs!==null&&(W7(Qs),Qs=null),r=!0;if(!r)return t.flags&256?(Va(t),t):(Va(t),null)}if(Va(t),t.flags&128)return t.lanes=n,t;if(n=i!==null,e=e!==null&&e.memoizedState!==null,n){i=t.child,r=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(r=i.alternate.memoizedState.cachePool.pool);var s=null;i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==r&&(i.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),TU(t,t.updateQueue),hn(t),null;case 4:return Ih(),e===null&&g_(t.stateNode.containerInfo),hn(t),null;case 10:return Ya(t.type),hn(t),null;case 19:if(vi(ei),r=t.memoizedState,r===null)return hn(t),null;if(i=(t.flags&128)!==0,s=r.rendering,s===null)if(i)o1(r,!1);else{if(Tn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=Ib(e),s!==null){for(t.flags|=128,o1(r,!1),e=s.updateQueue,t.updateQueue=e,TU(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)KP(n,e),n=n.sibling;return dn(ei,ei.current&1|2),t.child}e=e.sibling}r.tail!==null&&$o()>Rb&&(t.flags|=128,i=!0,o1(r,!1),t.lanes=4194304)}else{if(!i)if(e=Ib(s),e!==null){if(t.flags|=128,i=!0,e=e.updateQueue,t.updateQueue=e,TU(t,e),o1(r,!0),r.tail===null&&r.tailMode==="hidden"&&!s.alternate&&!St)return hn(t),null}else 2*$o()-r.renderingStartTime>Rb&&n!==536870912&&(t.flags|=128,i=!0,o1(r,!1),t.lanes=4194304);r.isBackwards?(s.sibling=t.child,t.child=s):(e=r.last,e!==null?e.sibling=s:t.child=s,r.last=s)}return r.tail!==null?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=$o(),t.sibling=null,e=ei.current,dn(ei,i?e&1|2:e&1),t):(hn(t),null);case 22:case 23:return Va(t),$w(),i=t.memoizedState!==null,e!==null?e.memoizedState!==null!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?n&536870912&&!(t.flags&128)&&(hn(t),t.subtreeFlags&6&&(t.flags|=8192)):hn(t),n=t.updateQueue,n!==null&&TU(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),i=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),e!==null&&vi(Yd),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Ya(Jn),hn(t),null;case 25:return null}throw Error(ie(156,t.tag))}function XQ(e,t){switch(Vw(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ya(Jn),Ih(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Ub(t),null;case 13:if(Va(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ie(340));op()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return vi(ei),null;case 4:return Ih(),null;case 10:return Ya(t.type),null;case 22:case 23:return Va(t),$w(),e!==null&&vi(Yd),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Ya(Jn),null;case 25:return null;default:return null}}function qP(e,t){switch(Vw(t),t.tag){case 3:Ya(Jn),Ih();break;case 26:case 27:case 5:Ub(t);break;case 4:Ih();break;case 13:Va(t);break;case 19:vi(ei);break;case 10:Ya(t.type);break;case 22:case 23:Va(t),$w(),e!==null&&vi(Yd);break;case 24:Ya(Jn)}}var jQ={getCacheForType:function(e){var t=Wi(Jn),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n}},YQ=typeof WeakMap=="function"?WeakMap:Map,bn=0,Qt=null,tt=null,gt=0,Zt=0,Fr=null,Ra=!1,pg=!1,c_=!1,al=0,Tn=0,Pc=0,Kd=0,d_=0,Ts=0,kh=0,m0=null,Lo=null,G7=!1,u_=0,Rb=1/0,Db=null,bc=null,IU=!1,Cd=null,p0=0,X7=0,j7=null,U0=0,Y7=null;function Qr(){if(bn&2&&gt!==0)return gt&-gt;if(We.T!==null){var e=Ah;return e!==0?e:h_()}return cO()}function QP(){Ts===0&&(Ts=!(gt&536870912)||St?rO():536870912);var e=Ls.current;return e!==null&&(e.flags|=32),Ts}function hr(e,t,n){(e===Qt&&Zt===2||e.cancelPendingCommit!==null)&&(Rh(e,0),Da(e,gt,Ts,!1)),rp(e,n),(!(bn&2)||e!==Qt)&&(e===Qt&&(!(bn&2)&&(Kd|=n),Tn===4&&Da(e,gt,Ts,!1)),ca(e))}function JP(e,t,n){if(bn&6)throw Error(ie(327));var i=!n&&(t&60)===0&&(t&e.expiredLanes)===0||ip(e,t),r=i?ZQ(e,t):h8(e,t,!0),s=i;do{if(r===0){pg&&!i&&Da(e,t,0,!1);break}else if(r===6)Da(e,t,0,!Ra);else{if(n=e.current.alternate,s&&!WQ(n)){r=h8(e,t,!1),s=!1;continue}if(r===2){if(s=t,e.errorRecoveryDisabledLanes&s)var o=0;else o=e.pendingLanes&-536870913,o=o!==0?o:o&536870912?536870912:0;if(o!==0){t=o;e:{var a=e;r=m0;var l=a.current.memoizedState.isDehydrated;if(l&&(Rh(a,o).flags|=256),o=h8(a,o,!1),o!==2){if(c_&&!l){a.errorRecoveryDisabledLanes|=s,Kd|=s,r=4;break e}s=Lo,Lo=r,s!==null&&W7(s)}r=o}if(s=!1,r!==2)continue}}if(r===1){Rh(e,0),Da(e,t,0,!0);break}e:{switch(i=e,r){case 0:case 1:throw Error(ie(345));case 4:if((t&4194176)===t){Da(i,t,Ts,!Ra);break e}break;case 2:Lo=null;break;case 3:case 5:break;default:throw Error(ie(329))}if(i.finishedWork=n,i.finishedLanes=t,(t&62914560)===t&&(s=u_+300-$o(),10<s)){if(Da(i,t,Ts,!Ra),R5(i,0)!==0)break e;i.timeoutHandle=hF(cC.bind(null,i,n,Lo,Db,G7,t,Ts,Kd,kh,Ra,2,-0,0),s);break e}cC(i,n,Lo,Db,G7,t,Ts,Kd,kh,Ra,0,-0,0)}}break}while(!0);ca(e)}function W7(e){Lo===null?Lo=e:Lo.push.apply(Lo,e)}function cC(e,t,n,i,r,s,o,a,l,c,d,u,f){var h=t.subtreeFlags;if((h&8192||(h&16785408)===16785408)&&(im={stylesheets:null,count:0,unsuspend:AJ},XP(t),t=kJ(),t!==null)){e.cancelPendingCommit=t(uC.bind(null,e,n,i,r,o,a,l,1,u,f)),Da(e,s,o,!c);return}uC(e,n,i,r,o,a,l,d,u,f)}function WQ(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!rs(s(),r))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Da(e,t,n,i){t&=~d_,t&=~Kd,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var r=t;0<r;){var s=31-qr(r),o=1<<s;i[s]=-1,r&=~o}n!==0&&oO(e,n,t)}function V5(){return bn&6?!0:(up(0),!1)}function f_(){if(tt!==null){if(Zt===0)var e=tt.return;else e=tt,$a=Fu=null,Zw(e),ih=null,J0=0,e=tt;for(;e!==null;)qP(e.alternate,e),e=e.return;tt=null}}function Rh(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,hJ(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),f_(),Qt=e,tt=n=Uc(e.current,null),gt=t,Zt=0,Fr=null,Ra=!1,pg=ip(e,t),c_=!1,kh=Ts=d_=Kd=Pc=Tn=0,Lo=m0=null,G7=!1,t&8&&(t|=t&32);var i=e.entangledLanes;if(i!==0)for(e=e.entanglements,i&=t;0<i;){var r=31-qr(i),s=1<<r;t|=e[r],i&=~s}return al=t,O5(),n}function eF(e,t){qe=null,We.H=Ko,t===o0?(t=Hx(),Zt=3):t===OO?(t=Hx(),Zt=4):Zt=t===IP?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Fr=t,tt===null&&(Tn=1,Ab(e,ys(t,e.current)))}function tF(){var e=We.H;return We.H=Ko,e===null?Ko:e}function nF(){var e=We.A;return We.A=jQ,e}function K7(){Tn=4,Ra||(gt&4194176)!==gt&&Ls.current!==null||(pg=!0),!(Pc&134217727)&&!(Kd&134217727)||Qt===null||Da(Qt,gt,Ts,!1)}function h8(e,t,n){var i=bn;bn|=2;var r=tF(),s=nF();(Qt!==e||gt!==t)&&(Db=null,Rh(e,t)),t=!1;var o=Tn;e:do try{if(Zt!==0&&tt!==null){var a=tt,l=Fr;switch(Zt){case 8:f_(),o=6;break e;case 3:case 2:case 6:Ls.current===null&&(t=!0);var c=Zt;if(Zt=0,Fr=null,Hf(e,a,l,c),n&&pg){o=0;break e}break;default:c=Zt,Zt=0,Fr=null,Hf(e,a,l,c)}}KQ(),o=Tn;break}catch(d){eF(e,d)}while(!0);return t&&e.shellSuspendCounter++,$a=Fu=null,bn=i,We.H=r,We.A=s,tt===null&&(Qt=null,gt=0,O5()),o}function KQ(){for(;tt!==null;)iF(tt)}function ZQ(e,t){var n=bn;bn|=2;var i=tF(),r=nF();Qt!==e||gt!==t?(Db=null,Rb=$o()+500,Rh(e,t)):pg=ip(e,t);e:do try{if(Zt!==0&&tt!==null){t=tt;var s=Fr;t:switch(Zt){case 1:Zt=0,Fr=null,Hf(e,t,s,1);break;case 2:if(zx(s)){Zt=0,Fr=null,dC(t);break}t=function(){Zt===2&&Qt===e&&(Zt=7),ca(e)},s.then(t,t);break e;case 3:Zt=7;break e;case 4:Zt=5;break e;case 7:zx(s)?(Zt=0,Fr=null,dC(t)):(Zt=0,Fr=null,Hf(e,t,s,7));break;case 5:var o=null;switch(tt.tag){case 26:o=tt.memoizedState;case 5:case 27:var a=tt;if(!o||UF(o)){Zt=0,Fr=null;var l=a.sibling;if(l!==null)tt=l;else{var c=a.return;c!==null?(tt=c,$5(c)):tt=null}break t}}Zt=0,Fr=null,Hf(e,t,s,5);break;case 6:Zt=0,Fr=null,Hf(e,t,s,6);break;case 8:f_(),Tn=6;break e;default:throw Error(ie(462))}}qQ();break}catch(d){eF(e,d)}while(!0);return $a=Fu=null,We.H=i,We.A=r,bn=n,tt!==null?0:(Qt=null,gt=0,O5(),Tn)}function qQ(){for(;tt!==null&&!yq();)iF(tt)}function iF(e){var t=MP(e.alternate,e,al);e.memoizedProps=e.pendingProps,t===null?$5(e):tt=t}function dC(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=tC(n,t,t.pendingProps,t.type,void 0,gt);break;case 11:t=tC(n,t,t.pendingProps,t.type.render,t.ref,gt);break;case 5:Zw(t);default:qP(n,t),t=tt=KP(t,al),t=MP(n,t,al)}e.memoizedProps=e.pendingProps,t===null?$5(e):tt=t}function Hf(e,t,n,i){$a=Fu=null,Zw(t),ih=null,J0=0;var r=t.return;try{if(BQ(e,r,t,n,gt)){Tn=1,Ab(e,ys(n,e.current)),tt=null;return}}catch(s){if(r!==null)throw tt=r,s;Tn=1,Ab(e,ys(n,e.current)),tt=null;return}t.flags&32768?(St||i===1?e=!0:pg||gt&536870912?e=!1:(Ra=e=!0,(i===2||i===3||i===6)&&(i=Ls.current,i!==null&&i.tag===13&&(i.flags|=16384))),rF(t,e)):$5(t)}function $5(e){var t=e;do{if(t.flags&32768){rF(t,Ra);return}e=t.return;var n=GQ(t.alternate,t,al);if(n!==null){tt=n;return}if(t=t.sibling,t!==null){tt=t;return}tt=t=e}while(t!==null);Tn===0&&(Tn=5)}function rF(e,t){do{var n=XQ(e.alternate,e);if(n!==null){n.flags&=32767,tt=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){tt=e;return}tt=e=n}while(e!==null);Tn=6,tt=null}function uC(e,t,n,i,r,s,o,a,l,c){var d=We.T,u=rn.p;try{rn.p=2,We.T=null,QQ(e,t,n,i,u,r,s,o,a,l,c)}finally{We.T=d,rn.p=u}}function QQ(e,t,n,i,r,s,o,a){do ah();while(Cd!==null);if(bn&6)throw Error(ie(327));var l=e.finishedWork;if(i=e.finishedLanes,l===null)return null;if(e.finishedWork=null,e.finishedLanes=0,l===e.current)throw Error(ie(177));e.callbackNode=null,e.callbackPriority=0,e.cancelPendingCommit=null;var c=l.lanes|l.childLanes;if(c|=Bw,Mq(e,i,c,s,o,a),e===Qt&&(tt=Qt=null,gt=0),!(l.subtreeFlags&10256)&&!(l.flags&10256)||IU||(IU=!0,X7=c,j7=n,nJ(bb,function(){return ah(),null})),n=(l.flags&15990)!==0,l.subtreeFlags&15990||n?(n=We.T,We.T=null,s=rn.p,rn.p=2,o=bn,bn|=4,HQ(e,l),VP(l,e),wQ(J7,e.containerInfo),Hb=!!Q7,J7=Q7=null,e.current=l,FP(e,l.alternate,l),Eq(),bn=o,rn.p=s,We.T=n):e.current=l,IU?(IU=!1,Cd=e,p0=i):sF(e,c),c=e.pendingLanes,c===0&&(bc=null),Iq(l.stateNode),ca(e),t!==null)for(r=e.onRecoverableError,l=0;l<t.length;l++)c=t[l],r(c.value,{componentStack:c.stack});return p0&3&&ah(),c=e.pendingLanes,i&4194218&&c&42?e===Y7?U0++:(U0=0,Y7=e):U0=0,up(0),null}function sF(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,ap(t)))}function ah(){if(Cd!==null){var e=Cd,t=X7;X7=0;var n=lO(p0),i=We.T,r=rn.p;try{if(rn.p=32>n?32:n,We.T=null,Cd===null)var s=!1;else{n=j7,j7=null;var o=Cd,a=p0;if(Cd=null,p0=0,bn&6)throw Error(ie(331));var l=bn;if(bn|=4,YP(o.current),GP(o,o.current,a,n),bn=l,up(0,!1),Zr&&typeof Zr.onPostCommitFiberRoot=="function")try{Zr.onPostCommitFiberRoot(np,o)}catch{}s=!0}return s}finally{rn.p=r,We.T=i,sF(e,t)}}return!1}function fC(e,t,n){t=ys(n,t),t=L7(e.stateNode,t,2),e=pc(e,t,2),e!==null&&(rp(e,2),ca(e))}function Xt(e,t,n){if(e.tag===3)fC(e,e,n);else for(;t!==null;){if(t.tag===3){fC(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(bc===null||!bc.has(i))){e=ys(n,e),n=_P(2),i=pc(t,n,2),i!==null&&(TP(n,i,t,e),rp(i,2),ca(i));break}}t=t.return}}function g8(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new YQ;var r=new Set;i.set(t,r)}else r=i.get(t),r===void 0&&(r=new Set,i.set(t,r));r.has(n)||(c_=!0,r.add(n),e=JQ.bind(null,e,t,n),t.then(e,e))}function JQ(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,Qt===e&&(gt&n)===n&&(Tn===4||Tn===3&&(gt&62914560)===gt&&300>$o()-u_?!(bn&2)&&Rh(e,0):d_|=n,kh===gt&&(kh=0)),ca(e)}function oF(e,t){t===0&&(t=sO()),e=Lc(e,t),e!==null&&(rp(e,t),ca(e))}function eJ(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),oF(e,n)}function tJ(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(ie(314))}i!==null&&i.delete(t),oF(e,n)}function nJ(e,t){return kw(e,t)}var Lb=null,vf=null,Z7=!1,Nb=!1,m8=!1,Zd=0;function ca(e){e!==vf&&e.next===null&&(vf===null?Lb=vf=e:vf=vf.next=e),Nb=!0,Z7||(Z7=!0,rJ(iJ))}function up(e,t){if(!m8&&Nb){m8=!0;do for(var n=!1,i=Lb;i!==null;){if(e!==0){var r=i.pendingLanes;if(r===0)var s=0;else{var o=i.suspendedLanes,a=i.pingedLanes;s=(1<<31-qr(42|e)+1)-1,s&=r&~(o&~a),s=s&201326677?s&201326677|1:s?s|2:0}s!==0&&(n=!0,hC(i,s))}else s=gt,s=R5(i,i===Qt?s:0),!(s&3)||ip(i,s)||(n=!0,hC(i,s));i=i.next}while(n);m8=!1}}function iJ(){Nb=Z7=!1;var e=0;Zd!==0&&(fJ()&&(e=Zd),Zd=0);for(var t=$o(),n=null,i=Lb;i!==null;){var r=i.next,s=aF(i,t);s===0?(i.next=null,n===null?Lb=r:n.next=r,r===null&&(vf=n)):(n=i,(e!==0||s&3)&&(Nb=!0)),i=r}up(e)}function aF(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes&-62914561;0<s;){var o=31-qr(s),a=1<<o,l=r[o];l===-1?(!(a&n)||a&i)&&(r[o]=Aq(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}if(t=Qt,n=gt,n=R5(e,e===t?n:0),i=e.callbackNode,n===0||e===t&&Zt===2||e.cancelPendingCommit!==null)return i!==null&&i!==null&&XE(i),e.callbackNode=null,e.callbackPriority=0;if(!(n&3)||ip(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(i!==null&&XE(i),lO(n)){case 2:case 8:n=nO;break;case 32:n=bb;break;case 268435456:n=iO;break;default:n=bb}return i=lF.bind(null,e),n=kw(n,i),e.callbackPriority=t,e.callbackNode=n,t}return i!==null&&i!==null&&XE(i),e.callbackPriority=2,e.callbackNode=null,2}function lF(e,t){var n=e.callbackNode;if(ah()&&e.callbackNode!==n)return null;var i=gt;return i=R5(e,e===Qt?i:0),i===0?null:(JP(e,i,t),aF(e,$o()),e.callbackNode!=null&&e.callbackNode===n?lF.bind(null,e):null)}function hC(e,t){if(ah())return null;JP(e,t,!0)}function rJ(e){gJ(function(){bn&6?kw(tO,e):e()})}function h_(){return Zd===0&&(Zd=rO()),Zd}function gC(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:v2(""+e)}function mC(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function sJ(e,t,n,i,r){if(t==="submit"&&n&&n.stateNode===r){var s=gC((r[Ar]||null).action),o=i.submitter;o&&(t=(t=o[Ar]||null)?gC(t.formAction):o.getAttribute("formAction"),t!==null&&(s=t,o=null));var a=new D5("action","action",null,i,r);e.push({event:a,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(Zd!==0){var l=o?mC(r,o):new FormData(r);R7(n,{pending:!0,data:l,method:r.method,action:s},null,l)}}else typeof s=="function"&&(a.preventDefault(),l=o?mC(r,o):new FormData(r),R7(n,{pending:!0,data:l,method:r.method,action:s},s,l))},currentTarget:r}]})}}for(var p8=0;p8<Ox.length;p8++){var U8=Ox[p8],oJ=U8.toLowerCase(),aJ=U8[0].toUpperCase()+U8.slice(1);Uo(oJ,"on"+aJ)}Uo(AO,"onAnimationEnd");Uo(MO,"onAnimationIteration");Uo(kO,"onAnimationStart");Uo("dblclick","onDoubleClick");Uo("focusin","onFocus");Uo("focusout","onBlur");Uo(TQ,"onTransitionRun");Uo(IQ,"onTransitionStart");Uo(SQ,"onTransitionCancel");Uo(RO,"onTransitionEnd");Sh("onMouseEnter",["mouseout","mouseover"]);Sh("onMouseLeave",["mouseout","mouseover"]);Sh("onPointerEnter",["pointerout","pointerover"]);Sh("onPointerLeave",["pointerout","pointerover"]);Du("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Du("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Du("onBeforeInput",["compositionend","keypress","textInput","paste"]);Du("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Du("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Du("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var tm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lJ=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(tm));function cF(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;s=a,r.currentTarget=c;try{s(r)}catch(d){Cb(d)}r.currentTarget=null,s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;s=a,r.currentTarget=c;try{s(r)}catch(d){Cb(d)}r.currentTarget=null,s=l}}}}function at(e,t){var n=t[y7];n===void 0&&(n=t[y7]=new Set);var i=e+"__bubble";n.has(i)||(dF(t,e,2,!1),n.add(i))}function b8(e,t,n){var i=0;t&&(i|=4),dF(n,e,i,t)}var SU="_reactListening"+Math.random().toString(36).slice(2);function g_(e){if(!e[SU]){e[SU]=!0,dO.forEach(function(n){n!=="selectionchange"&&(lJ.has(n)||b8(n,!1,e),b8(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[SU]||(t[SU]=!0,b8("selectionchange",!1,t))}}function dF(e,t,n,i){switch(wF(t)){case 2:var r=LJ;break;case 8:r=NJ;break;default:r=b_}n=r.bind(null,t,n,e),r=void 0,!_7||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),i?r!==void 0?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):r!==void 0?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function y8(e,t,n,i,r){var s=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Ld(a),o===null)return;if(l=o.tag,l===5||l===6||l===26||l===27){i=s=o;continue e}a=a.parentNode}}i=i.return}bO(function(){var c=s,d=Lw(n),u=[];e:{var f=DO.get(e);if(f!==void 0){var h=D5,m=e;switch(e){case"keypress":if(_2(n)===0)break e;case"keydown":case"keyup":h=tQ;break;case"focusin":m="focus",h=ZE;break;case"focusout":m="blur",h=ZE;break;case"beforeblur":case"afterblur":h=ZE;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Tx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=$q;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=rQ;break;case AO:case MO:case kO:h=jq;break;case RO:h=oQ;break;case"scroll":case"scrollend":h=Hq;break;case"wheel":h=lQ;break;case"copy":case"cut":case"paste":h=Wq;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Sx;break;case"toggle":case"beforetoggle":h=dQ}var p=(t&4)!==0,U=!p&&(e==="scroll"||e==="scrollend"),b=p?f!==null?f+"Capture":null:f;p=[];for(var y=c,w;y!==null;){var v=y;if(w=v.stateNode,v=v.tag,v!==5&&v!==26&&v!==27||w===null||b===null||(v=K0(y,b),v!=null&&p.push(nm(y,v,w))),U)break;y=y.return}0<p.length&&(f=new h(f,m,null,n,d),u.push({event:f,listeners:p}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",f&&n!==w7&&(m=n.relatedTarget||n.fromElement)&&(Ld(m)||m[gg]))break e;if((h||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,h?(m=n.relatedTarget||n.toElement,h=c,m=m?Ld(m):null,m!==null&&(U=hg(m),p=m.tag,m!==U||p!==5&&p!==27&&p!==6)&&(m=null)):(h=null,m=c),h!==m)){if(p=Tx,v="onMouseLeave",b="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(p=Sx,v="onPointerLeave",b="onPointerEnter",y="pointer"),U=h==null?f:L1(h),w=m==null?f:L1(m),f=new p(v,y+"leave",h,n,d),f.target=U,f.relatedTarget=w,v=null,Ld(d)===c&&(p=new p(b,y+"enter",m,n,d),p.target=w,p.relatedTarget=U,v=p),U=v,h&&m)t:{for(p=h,b=m,y=0,w=p;w;w=of(w))y++;for(w=0,v=b;v;v=of(v))w++;for(;0<y-w;)p=of(p),y--;for(;0<w-y;)b=of(b),w--;for(;y--;){if(p===b||b!==null&&p===b.alternate)break t;p=of(p),b=of(b)}p=null}else p=null;h!==null&&pC(u,f,h,p,!1),m!==null&&U!==null&&pC(u,U,m,p,!0)}}e:{if(f=c?L1(c):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var I=Mx;else if(Ax(f))if(TO)I=EQ;else{I=bQ;var C=UQ}else h=f.nodeName,!h||h.toLowerCase()!=="input"||f.type!=="checkbox"&&f.type!=="radio"?c&&Dw(c.elementType)&&(I=Mx):I=yQ;if(I&&(I=I(e,c))){_O(u,I,n,d);break e}C&&C(e,f,c),e==="focusout"&&c&&f.type==="number"&&c.memoizedProps.value!=null&&v7(f,"number",f.value)}switch(C=c?L1(c):window,e){case"focusin":(Ax(C)||C.contentEditable==="true")&&(Nf=C,T7=c,s0=null);break;case"focusout":s0=T7=Nf=null;break;case"mousedown":I7=!0;break;case"contextmenu":case"mouseup":case"dragend":I7=!1,Nx(u,n,d);break;case"selectionchange":if(_Q)break;case"keydown":case"keyup":Nx(u,n,d)}var _;if(Pw)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Lf?vO(e,n)&&(T="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(EO&&n.locale!=="ko"&&(Lf||T!=="onCompositionStart"?T==="onCompositionEnd"&&Lf&&(_=yO()):(ac=d,Nw="value"in ac?ac.value:ac.textContent,Lf=!0)),C=Ob(c,T),0<C.length&&(T=new Ix(T,e,null,n,d),u.push({event:T,listeners:C}),_?T.data=_:(_=wO(n),_!==null&&(T.data=_)))),(_=fQ?hQ(e,n):gQ(e,n))&&(T=Ob(c,"onBeforeInput"),0<T.length&&(C=new Ix("onBeforeInput","beforeinput",null,n,d),u.push({event:C,listeners:T}),C.data=_)),sJ(u,e,c,n,d)}cF(u,t)})}function nm(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ob(e,t){for(var n=t+"Capture",i=[];e!==null;){var r=e,s=r.stateNode;r=r.tag,r!==5&&r!==26&&r!==27||s===null||(r=K0(e,n),r!=null&&i.unshift(nm(e,r,s)),r=K0(e,t),r!=null&&i.push(nm(e,r,s))),e=e.return}return i}function of(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function pC(e,t,n,i,r){for(var s=t._reactName,o=[];n!==null&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(a=a.tag,l!==null&&l===i)break;a!==5&&a!==26&&a!==27||c===null||(l=c,r?(c=K0(n,s),c!=null&&o.unshift(nm(n,c,l))):r||(c=K0(n,s),c!=null&&o.push(nm(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var cJ=/\r\n?/g,dJ=/\u0000|\uFFFD/g;function UC(e){return(typeof e=="string"?e:""+e).replace(cJ,`
`).replace(dJ,"")}function uF(e,t){return t=UC(t),UC(e)===t}function G5(){}function Ft(e,t,n,i,r,s){switch(n){case"children":typeof i=="string"?t==="body"||t==="textarea"&&i===""||xh(e,i):(typeof i=="number"||typeof i=="bigint")&&t!=="body"&&xh(e,""+i);break;case"className":bU(e,"class",i);break;case"tabIndex":bU(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":bU(e,n,i);break;case"style":UO(e,i,s);break;case"data":if(t!=="object"){bU(e,"data",i);break}case"src":case"href":if(i===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(n);break}i=v2(""+i),e.setAttribute(n,i);break;case"action":case"formAction":if(typeof i=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof s=="function"&&(n==="formAction"?(t!=="input"&&Ft(e,t,"name",r.name,r,null),Ft(e,t,"formEncType",r.formEncType,r,null),Ft(e,t,"formMethod",r.formMethod,r,null),Ft(e,t,"formTarget",r.formTarget,r,null)):(Ft(e,t,"encType",r.encType,r,null),Ft(e,t,"method",r.method,r,null),Ft(e,t,"target",r.target,r,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(n);break}i=v2(""+i),e.setAttribute(n,i);break;case"onClick":i!=null&&(e.onclick=G5);break;case"onScroll":i!=null&&at("scroll",e);break;case"onScrollEnd":i!=null&&at("scrollend",e);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(ie(61));if(n=i.__html,n!=null){if(r.children!=null)throw Error(ie(60));e.innerHTML=n}}break;case"multiple":e.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":e.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){e.removeAttribute("xlink:href");break}n=v2(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,""+i):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":i===!0?e.setAttribute(n,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,i):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?e.setAttribute(n,i):e.removeAttribute(n);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?e.removeAttribute(n):e.setAttribute(n,i);break;case"popover":at("beforetoggle",e),at("toggle",e),E2(e,"popover",i);break;case"xlinkActuate":ma(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":ma(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":ma(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":ma(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":ma(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":ma(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":ma(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":ma(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":ma(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":E2(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=Bq.get(n)||n,E2(e,n,i))}}function q7(e,t,n,i,r,s){switch(n){case"style":UO(e,i,s);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(ie(61));if(n=i.__html,n!=null){if(r.children!=null)throw Error(ie(60));e.innerHTML=n}}break;case"children":typeof i=="string"?xh(e,i):(typeof i=="number"||typeof i=="bigint")&&xh(e,""+i);break;case"onScroll":i!=null&&at("scroll",e);break;case"onScrollEnd":i!=null&&at("scrollend",e);break;case"onClick":i!=null&&(e.onclick=G5);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!uO.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(r=n.endsWith("Capture"),t=n.slice(2,r?n.length-7:void 0),s=e[Ar]||null,s=s!=null?s[n]:null,typeof s=="function"&&e.removeEventListener(t,s,r),typeof i=="function")){typeof s!="function"&&s!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,i,r);break e}n in e?e[n]=i:i===!0?e.setAttribute(n,""):E2(e,n,i)}}}function ki(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":at("error",e),at("load",e);var i=!1,r=!1,s;for(s in n)if(n.hasOwnProperty(s)){var o=n[s];if(o!=null)switch(s){case"src":i=!0;break;case"srcSet":r=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(ie(137,t));default:Ft(e,t,s,o,n,null)}}r&&Ft(e,t,"srcSet",n.srcSet,n,null),i&&Ft(e,t,"src",n.src,n,null);return;case"input":at("invalid",e);var a=s=o=r=null,l=null,c=null;for(i in n)if(n.hasOwnProperty(i)){var d=n[i];if(d!=null)switch(i){case"name":r=d;break;case"type":o=d;break;case"checked":l=d;break;case"defaultChecked":c=d;break;case"value":s=d;break;case"defaultValue":a=d;break;case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(ie(137,t));break;default:Ft(e,t,i,d,n,null)}}gO(e,s,a,l,c,o,r,!1),yb(e);return;case"select":at("invalid",e),i=o=s=null;for(r in n)if(n.hasOwnProperty(r)&&(a=n[r],a!=null))switch(r){case"value":s=a;break;case"defaultValue":o=a;break;case"multiple":i=a;default:Ft(e,t,r,a,n,null)}t=s,n=o,e.multiple=!!i,t!=null?th(e,!!i,t,!1):n!=null&&th(e,!!i,n,!0);return;case"textarea":at("invalid",e),s=r=i=null;for(o in n)if(n.hasOwnProperty(o)&&(a=n[o],a!=null))switch(o){case"value":i=a;break;case"defaultValue":r=a;break;case"children":s=a;break;case"dangerouslySetInnerHTML":if(a!=null)throw Error(ie(91));break;default:Ft(e,t,o,a,n,null)}pO(e,i,r,s),yb(e);return;case"option":for(l in n)if(n.hasOwnProperty(l)&&(i=n[l],i!=null))switch(l){case"selected":e.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:Ft(e,t,l,i,n,null)}return;case"dialog":at("cancel",e),at("close",e);break;case"iframe":case"object":at("load",e);break;case"video":case"audio":for(i=0;i<tm.length;i++)at(tm[i],e);break;case"image":at("error",e),at("load",e);break;case"details":at("toggle",e);break;case"embed":case"source":case"link":at("error",e),at("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(c in n)if(n.hasOwnProperty(c)&&(i=n[c],i!=null))switch(c){case"children":case"dangerouslySetInnerHTML":throw Error(ie(137,t));default:Ft(e,t,c,i,n,null)}return;default:if(Dw(t)){for(d in n)n.hasOwnProperty(d)&&(i=n[d],i!==void 0&&q7(e,t,d,i,n,void 0));return}}for(a in n)n.hasOwnProperty(a)&&(i=n[a],i!=null&&Ft(e,t,a,i,n,null))}function uJ(e,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,s=null,o=null,a=null,l=null,c=null,d=null;for(h in n){var u=n[h];if(n.hasOwnProperty(h)&&u!=null)switch(h){case"checked":break;case"value":break;case"defaultValue":l=u;default:i.hasOwnProperty(h)||Ft(e,t,h,null,i,u)}}for(var f in i){var h=i[f];if(u=n[f],i.hasOwnProperty(f)&&(h!=null||u!=null))switch(f){case"type":s=h;break;case"name":r=h;break;case"checked":c=h;break;case"defaultChecked":d=h;break;case"value":o=h;break;case"defaultValue":a=h;break;case"children":case"dangerouslySetInnerHTML":if(h!=null)throw Error(ie(137,t));break;default:h!==u&&Ft(e,t,f,h,i,u)}}E7(e,o,a,l,c,d,s,r);return;case"select":h=o=a=f=null;for(s in n)if(l=n[s],n.hasOwnProperty(s)&&l!=null)switch(s){case"value":break;case"multiple":h=l;default:i.hasOwnProperty(s)||Ft(e,t,s,null,i,l)}for(r in i)if(s=i[r],l=n[r],i.hasOwnProperty(r)&&(s!=null||l!=null))switch(r){case"value":f=s;break;case"defaultValue":a=s;break;case"multiple":o=s;default:s!==l&&Ft(e,t,r,s,i,l)}t=a,n=o,i=h,f!=null?th(e,!!n,f,!1):!!i!=!!n&&(t!=null?th(e,!!n,t,!0):th(e,!!n,n?[]:"",!1));return;case"textarea":h=f=null;for(a in n)if(r=n[a],n.hasOwnProperty(a)&&r!=null&&!i.hasOwnProperty(a))switch(a){case"value":break;case"children":break;default:Ft(e,t,a,null,i,r)}for(o in i)if(r=i[o],s=n[o],i.hasOwnProperty(o)&&(r!=null||s!=null))switch(o){case"value":f=r;break;case"defaultValue":h=r;break;case"children":break;case"dangerouslySetInnerHTML":if(r!=null)throw Error(ie(91));break;default:r!==s&&Ft(e,t,o,r,i,s)}mO(e,f,h);return;case"option":for(var m in n)if(f=n[m],n.hasOwnProperty(m)&&f!=null&&!i.hasOwnProperty(m))switch(m){case"selected":e.selected=!1;break;default:Ft(e,t,m,null,i,f)}for(l in i)if(f=i[l],h=n[l],i.hasOwnProperty(l)&&f!==h&&(f!=null||h!=null))switch(l){case"selected":e.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Ft(e,t,l,f,i,h)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var p in n)f=n[p],n.hasOwnProperty(p)&&f!=null&&!i.hasOwnProperty(p)&&Ft(e,t,p,null,i,f);for(c in i)if(f=i[c],h=n[c],i.hasOwnProperty(c)&&f!==h&&(f!=null||h!=null))switch(c){case"children":case"dangerouslySetInnerHTML":if(f!=null)throw Error(ie(137,t));break;default:Ft(e,t,c,f,i,h)}return;default:if(Dw(t)){for(var U in n)f=n[U],n.hasOwnProperty(U)&&f!==void 0&&!i.hasOwnProperty(U)&&q7(e,t,U,void 0,i,f);for(d in i)f=i[d],h=n[d],!i.hasOwnProperty(d)||f===h||f===void 0&&h===void 0||q7(e,t,d,f,i,h);return}}for(var b in n)f=n[b],n.hasOwnProperty(b)&&f!=null&&!i.hasOwnProperty(b)&&Ft(e,t,b,null,i,f);for(u in i)f=i[u],h=n[u],!i.hasOwnProperty(u)||f===h||f==null&&h==null||Ft(e,t,u,f,i,h)}var Q7=null,J7=null;function Pb(e){return e.nodeType===9?e:e.ownerDocument}function bC(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function fF(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function e4(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var E8=null;function fJ(){var e=window.event;return e&&e.type==="popstate"?e===E8?!1:(E8=e,!0):(E8=null,!1)}var hF=typeof setTimeout=="function"?setTimeout:void 0,hJ=typeof clearTimeout=="function"?clearTimeout:void 0,yC=typeof Promise=="function"?Promise:void 0,gJ=typeof queueMicrotask=="function"?queueMicrotask:typeof yC<"u"?function(e){return yC.resolve(null).then(e).catch(mJ)}:hF;function mJ(e){setTimeout(function(){throw e})}function v8(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){e.removeChild(r),am(t);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);am(t)}function t4(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":t4(n),Rw(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function pJ(e,t,n,i){for(;e.nodeType===1;){var r=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(i){if(!e[W0])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(s=e.getAttribute("rel"),s==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(s!==r.rel||e.getAttribute("href")!==(r.href==null?null:r.href)||e.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin)||e.getAttribute("title")!==(r.title==null?null:r.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(s=e.getAttribute("src"),(s!==(r.src==null?null:r.src)||e.getAttribute("type")!==(r.type==null?null:r.type)||e.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var s=r.name==null?null:""+r.name;if(r.type==="hidden"&&e.getAttribute("name")===s)return e}else return e;if(e=ro(e.nextSibling),e===null)break}return null}function UJ(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=ro(e.nextSibling),e===null))return null;return e}function ro(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}function EC(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}function gF(e,t,n){switch(t=Pb(n),e){case"html":if(e=t.documentElement,!e)throw Error(ie(452));return e;case"head":if(e=t.head,!e)throw Error(ie(453));return e;case"body":if(e=t.body,!e)throw Error(ie(454));return e;default:throw Error(ie(451))}}var Ns=new Map,vC=new Set;function Fb(e){return typeof e.getRootNode=="function"?e.getRootNode():e.ownerDocument}var _l=rn.d;rn.d={f:bJ,r:yJ,D:EJ,C:vJ,L:wJ,m:_J,X:IJ,S:TJ,M:SJ};function bJ(){var e=_l.f(),t=V5();return e||t}function yJ(e){var t=mg(e);t!==null&&t.tag===5&&t.type==="form"?gP(t):_l.r(e)}var Ug=typeof document>"u"?null:document;function mF(e,t,n){var i=Ug;if(i&&typeof t=="string"&&t){var r=bs(t);r='link[rel="'+e+'"][href="'+r+'"]',typeof n=="string"&&(r+='[crossorigin="'+n+'"]'),vC.has(r)||(vC.add(r),e={rel:e,crossOrigin:n,href:t},i.querySelector(r)===null&&(t=i.createElement("link"),ki(t,"link",e),pi(t),i.head.appendChild(t)))}}function EJ(e){_l.D(e),mF("dns-prefetch",e,null)}function vJ(e,t){_l.C(e,t),mF("preconnect",e,t)}function wJ(e,t,n){_l.L(e,t,n);var i=Ug;if(i&&e&&t){var r='link[rel="preload"][as="'+bs(t)+'"]';t==="image"&&n&&n.imageSrcSet?(r+='[imagesrcset="'+bs(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(r+='[imagesizes="'+bs(n.imageSizes)+'"]')):r+='[href="'+bs(e)+'"]';var s=r;switch(t){case"style":s=Dh(e);break;case"script":s=bg(e)}Ns.has(s)||(e=sn({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),Ns.set(s,e),i.querySelector(r)!==null||t==="style"&&i.querySelector(fp(s))||t==="script"&&i.querySelector(hp(s))||(t=i.createElement("link"),ki(t,"link",e),pi(t),i.head.appendChild(t)))}}function _J(e,t){_l.m(e,t);var n=Ug;if(n&&e){var i=t&&typeof t.as=="string"?t.as:"script",r='link[rel="modulepreload"][as="'+bs(i)+'"][href="'+bs(e)+'"]',s=r;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=bg(e)}if(!Ns.has(s)&&(e=sn({rel:"modulepreload",href:e},t),Ns.set(s,e),n.querySelector(r)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(hp(s)))return}i=n.createElement("link"),ki(i,"link",e),pi(i),n.head.appendChild(i)}}}function TJ(e,t,n){_l.S(e,t,n);var i=Ug;if(i&&e){var r=eh(i).hoistableStyles,s=Dh(e);t=t||"default";var o=r.get(s);if(!o){var a={loading:0,preload:null};if(o=i.querySelector(fp(s)))a.loading=5;else{e=sn({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Ns.get(s))&&m_(e,n);var l=o=i.createElement("link");pi(l),ki(l,"link",e),l._p=new Promise(function(c,d){l.onload=c,l.onerror=d}),l.addEventListener("load",function(){a.loading|=1}),l.addEventListener("error",function(){a.loading|=2}),a.loading|=4,A2(o,t,i)}o={type:"stylesheet",instance:o,count:1,state:a},r.set(s,o)}}}function IJ(e,t){_l.X(e,t);var n=Ug;if(n&&e){var i=eh(n).hoistableScripts,r=bg(e),s=i.get(r);s||(s=n.querySelector(hp(r)),s||(e=sn({src:e,async:!0},t),(t=Ns.get(r))&&p_(e,t),s=n.createElement("script"),pi(s),ki(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},i.set(r,s))}}function SJ(e,t){_l.M(e,t);var n=Ug;if(n&&e){var i=eh(n).hoistableScripts,r=bg(e),s=i.get(r);s||(s=n.querySelector(hp(r)),s||(e=sn({src:e,async:!0,type:"module"},t),(t=Ns.get(r))&&p_(e,t),s=n.createElement("script"),pi(s),ki(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},i.set(r,s))}}function wC(e,t,n,i){var r=(r=gc.current)?Fb(r):null;if(!r)throw Error(ie(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Dh(n.href),n=eh(r).hoistableStyles,i=n.get(t),i||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=Dh(n.href);var s=eh(r).hoistableStyles,o=s.get(e);if(o||(r=r.ownerDocument||r,o={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},s.set(e,o),(s=r.querySelector(fp(e)))&&!s._p&&(o.instance=s,o.state.loading=5),Ns.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Ns.set(e,n),s||xJ(r,e,n,o.state))),t&&i===null)throw Error(ie(528,""));return o}if(t&&i!==null)throw Error(ie(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=bg(n),n=eh(r).hoistableScripts,i=n.get(t),i||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(ie(444,e))}}function Dh(e){return'href="'+bs(e)+'"'}function fp(e){return'link[rel="stylesheet"]['+e+"]"}function pF(e){return sn({},e,{"data-precedence":e.precedence,precedence:null})}function xJ(e,t,n,i){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?i.loading=1:(t=e.createElement("link"),i.preload=t,t.addEventListener("load",function(){return i.loading|=1}),t.addEventListener("error",function(){return i.loading|=2}),ki(t,"link",n),pi(t),e.head.appendChild(t))}function bg(e){return'[src="'+bs(e)+'"]'}function hp(e){return"script[async]"+e}function _C(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+bs(n.href)+'"]');if(i)return t.instance=i,pi(i),i;var r=sn({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return i=(e.ownerDocument||e).createElement("style"),pi(i),ki(i,"style",r),A2(i,n.precedence,e),t.instance=i;case"stylesheet":r=Dh(n.href);var s=e.querySelector(fp(r));if(s)return t.state.loading|=4,t.instance=s,pi(s),s;i=pF(n),(r=Ns.get(r))&&m_(i,r),s=(e.ownerDocument||e).createElement("link"),pi(s);var o=s;return o._p=new Promise(function(a,l){o.onload=a,o.onerror=l}),ki(s,"link",i),t.state.loading|=4,A2(s,n.precedence,e),t.instance=s;case"script":return s=bg(n.src),(r=e.querySelector(hp(s)))?(t.instance=r,pi(r),r):(i=n,(r=Ns.get(s))&&(i=sn({},n),p_(i,r)),e=e.ownerDocument||e,r=e.createElement("script"),pi(r),ki(r,"link",i),e.head.appendChild(r),t.instance=r);case"void":return null;default:throw Error(ie(443,t.type))}else t.type==="stylesheet"&&!(t.state.loading&4)&&(i=t.instance,t.state.loading|=4,A2(i,n.precedence,e));return t.instance}function A2(e,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=i.length?i[i.length-1]:null,s=r,o=0;o<i.length;o++){var a=i[o];if(a.dataset.precedence===t)s=a;else if(s!==r)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function m_(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function p_(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var M2=null;function TC(e,t,n){if(M2===null){var i=new Map,r=M2=new Map;r.set(n,i)}else r=M2,i=r.get(n),i||(i=new Map,r.set(n,i));if(i.has(e))return i;for(i.set(e,null),n=n.getElementsByTagName(e),r=0;r<n.length;r++){var s=n[r];if(!(s[W0]||s[Yi]||e==="link"&&s.getAttribute("rel")==="stylesheet")&&s.namespaceURI!=="http://www.w3.org/2000/svg"){var o=s.getAttribute(t)||"";o=e+o;var a=i.get(o);a?a.push(s):i.set(o,[s])}}return i}function IC(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function CJ(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function UF(e){return!(e.type==="stylesheet"&&!(e.state.loading&3))}var im=null;function AJ(){}function MJ(e,t,n){if(im===null)throw Error(ie(475));var i=im;if(t.type==="stylesheet"&&(typeof n.media!="string"||matchMedia(n.media).matches!==!1)&&!(t.state.loading&4)){if(t.instance===null){var r=Dh(n.href),s=e.querySelector(fp(r));if(s){e=s._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(i.count++,i=Bb.bind(i),e.then(i,i)),t.state.loading|=4,t.instance=s,pi(s);return}s=e.ownerDocument||e,n=pF(n),(r=Ns.get(r))&&m_(n,r),s=s.createElement("link"),pi(s);var o=s;o._p=new Promise(function(a,l){o.onload=a,o.onerror=l}),ki(s,"link",n),t.instance=s}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(t,e),(e=t.state.preload)&&!(t.state.loading&3)&&(i.count++,t=Bb.bind(i),e.addEventListener("load",t),e.addEventListener("error",t))}}function kJ(){if(im===null)throw Error(ie(475));var e=im;return e.stylesheets&&e.count===0&&n4(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&n4(e,e.stylesheets),e.unsuspend){var i=e.unsuspend;e.unsuspend=null,i()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}function Bb(){if(this.count--,this.count===0){if(this.stylesheets)n4(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var zb=null;function n4(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,zb=new Map,t.forEach(RJ,e),zb=null,Bb.call(e))}function RJ(e,t){if(!(t.state.loading&4)){var n=zb.get(e);if(n)var i=n.get(null);else{n=new Map,zb.set(e,n);for(var r=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<r.length;s++){var o=r[s];(o.nodeName==="LINK"||o.getAttribute("media")!=="not all")&&(n.set(o.dataset.precedence,o),i=o)}i&&n.set(null,i)}r=t.instance,o=r.getAttribute("data-precedence"),s=n.get(o)||i,s===i&&n.set(null,r),n.set(o,r),this.count++,i=Bb.bind(this),r.addEventListener("load",i),r.addEventListener("error",i),s?s.parentNode.insertBefore(r,s.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(r,e.firstChild)),t.state.loading|=4}}var rm={$$typeof:Ba,Provider:null,Consumer:null,_currentValue:Xd,_currentValue2:Xd,_threadCount:0};function DJ(e,t,n,i,r,s,o,a){this.tag=1,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=jE(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jE(0),this.hiddenUpdates=jE(null),this.identifierPrefix=i,this.onUncaughtError=r,this.onCaughtError=s,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=a,this.incompleteTransitions=new Map}function bF(e,t,n,i,r,s,o,a,l,c,d,u){return e=new DJ(e,t,n,o,a,l,c,u),t=1,s===!0&&(t|=24),s=_s(3,null,null,t),e.current=s,s.stateNode=e,t=Gw(),t.refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:i,isDehydrated:n,cache:t},s_(s),e}function yF(e){return e?(e=Ff,e):Ff}function EF(e,t,n,i,r,s){r=yF(r),i.context===null?i.context=r:i.pendingContext=r,i=mc(t),i.payload={element:n},s=s===void 0?null:s,s!==null&&(i.callback=s),n=pc(e,i,t),n!==null&&(hr(n,e,t),u0(n,e,t))}function SC(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function U_(e,t){SC(e,t),(e=e.alternate)&&SC(e,t)}function vF(e){if(e.tag===13){var t=Lc(e,67108864);t!==null&&hr(t,e,67108864),U_(e,67108864)}}var Hb=!0;function LJ(e,t,n,i){var r=We.T;We.T=null;var s=rn.p;try{rn.p=2,b_(e,t,n,i)}finally{rn.p=s,We.T=r}}function NJ(e,t,n,i){var r=We.T;We.T=null;var s=rn.p;try{rn.p=8,b_(e,t,n,i)}finally{rn.p=s,We.T=r}}function b_(e,t,n,i){if(Hb){var r=i4(i);if(r===null)y8(e,t,i,Vb,n),xC(e,i);else if(PJ(r,e,t,n,i))i.stopPropagation();else if(xC(e,i),t&4&&-1<OJ.indexOf(e)){for(;r!==null;){var s=mg(r);if(s!==null)switch(s.tag){case 3:if(s=s.stateNode,s.current.memoizedState.isDehydrated){var o=wd(s.pendingLanes);if(o!==0){var a=s;for(a.pendingLanes|=2,a.entangledLanes|=2;o;){var l=1<<31-qr(o);a.entanglements[1]|=l,o&=~l}ca(s),!(bn&6)&&(Rb=$o()+500,up(0))}}break;case 13:a=Lc(s,2),a!==null&&hr(a,s,2),V5(),U_(s,2)}if(s=i4(i),s===null&&y8(e,t,i,Vb,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else y8(e,t,i,null,n)}}function i4(e){return e=Lw(e),y_(e)}var Vb=null;function y_(e){if(Vb=null,e=Ld(e),e!==null){var t=hg(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=JN(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Vb=e,null}function wF(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(vq()){case tO:return 2;case nO:return 8;case bb:case wq:return 32;case iO:return 268435456;default:return 32}default:return 32}}var r4=!1,yc=null,Ec=null,vc=null,sm=new Map,om=new Map,nc=[],OJ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function xC(e,t){switch(e){case"focusin":case"focusout":yc=null;break;case"dragenter":case"dragleave":Ec=null;break;case"mouseover":case"mouseout":vc=null;break;case"pointerover":case"pointerout":sm.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":om.delete(t.pointerId)}}function a1(e,t,n,i,r,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},t!==null&&(t=mg(t),t!==null&&vF(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function PJ(e,t,n,i,r){switch(t){case"focusin":return yc=a1(yc,e,t,n,i,r),!0;case"dragenter":return Ec=a1(Ec,e,t,n,i,r),!0;case"mouseover":return vc=a1(vc,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return sm.set(s,a1(sm.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,om.set(s,a1(om.get(s)||null,e,t,n,i,r)),!0}return!1}function _F(e){var t=Ld(e.target);if(t!==null){var n=hg(t);if(n!==null){if(t=n.tag,t===13){if(t=JN(n),t!==null){e.blockedOn=t,kq(e.priority,function(){if(n.tag===13){var i=Qr(),r=Lc(n,i);r!==null&&hr(r,n,i),U_(n,i)}});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function k2(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=i4(e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);w7=i,n.target.dispatchEvent(i),w7=null}else return t=mg(n),t!==null&&vF(t),e.blockedOn=n,!1;t.shift()}return!0}function CC(e,t,n){k2(e)&&n.delete(t)}function FJ(){r4=!1,yc!==null&&k2(yc)&&(yc=null),Ec!==null&&k2(Ec)&&(Ec=null),vc!==null&&k2(vc)&&(vc=null),sm.forEach(CC),om.forEach(CC)}function xU(e,t){e.blockedOn===t&&(e.blockedOn=null,r4||(r4=!0,ri.unstable_scheduleCallback(ri.unstable_NormalPriority,FJ)))}var CU=null;function AC(e){CU!==e&&(CU=e,ri.unstable_scheduleCallback(ri.unstable_NormalPriority,function(){CU===e&&(CU=null);for(var t=0;t<e.length;t+=3){var n=e[t],i=e[t+1],r=e[t+2];if(typeof i!="function"){if(y_(i||n)===null)continue;break}var s=mg(n);s!==null&&(e.splice(t,3),t-=3,R7(s,{pending:!0,data:r,method:n.method,action:i},i,r))}}))}function am(e){function t(l){return xU(l,e)}yc!==null&&xU(yc,e),Ec!==null&&xU(Ec,e),vc!==null&&xU(vc,e),sm.forEach(t),om.forEach(t);for(var n=0;n<nc.length;n++){var i=nc[n];i.blockedOn===e&&(i.blockedOn=null)}for(;0<nc.length&&(n=nc[0],n.blockedOn===null);)_F(n),n.blockedOn===null&&nc.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(i=0;i<n.length;i+=3){var r=n[i],s=n[i+1],o=r[Ar]||null;if(typeof s=="function")o||AC(n);else if(o){var a=null;if(s&&s.hasAttribute("formAction")){if(r=s,o=s[Ar]||null)a=o.formAction;else if(y_(r)!==null)continue}else a=o.action;typeof a=="function"?n[i+1]=a:(n.splice(i,3),i-=3),AC(n)}}}function E_(e){this._internalRoot=e}X5.prototype.render=E_.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ie(409));var n=t.current,i=Qr();EF(n,i,e,t,null,null)};X5.prototype.unmount=E_.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;e.tag===0&&ah(),EF(e.current,2,null,e,null,null),V5(),t[gg]=null}};function X5(e){this._internalRoot=e}X5.prototype.unstable_scheduleHydration=function(e){if(e){var t=cO();e={blockedOn:null,target:e,priority:t};for(var n=0;n<nc.length&&t!==0&&t<nc[n].priority;n++);nc.splice(n,0,e),n===0&&_F(e)}};var MC=WN.version;if(MC!=="19.0.0")throw Error(ie(527,MC,"19.0.0"));rn.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ie(188)):(e=Object.keys(e).join(","),Error(ie(268,e)));return e=bq(t),e=e!==null?eO(e):null,e=e===null?null:e.stateNode,e};var BJ={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:We,findFiberByHostInstance:Ld,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var AU=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!AU.isDisabled&&AU.supportsFiber)try{np=AU.inject(BJ),Zr=AU}catch{}}M5.createRoot=function(e,t){if(!KN(e))throw Error(ie(299));var n=!1,i="",r=EP,s=vP,o=wP,a=null;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(r=t.onUncaughtError),t.onCaughtError!==void 0&&(s=t.onCaughtError),t.onRecoverableError!==void 0&&(o=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(a=t.unstable_transitionCallbacks)),t=bF(e,1,!1,null,null,n,i,r,s,o,a,null),e[gg]=t.current,g_(e.nodeType===8?e.parentNode:e),new E_(t)};M5.hydrateRoot=function(e,t,n){if(!KN(e))throw Error(ie(299));var i=!1,r="",s=EP,o=vP,a=wP,l=null,c=null;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onUncaughtError!==void 0&&(s=n.onUncaughtError),n.onCaughtError!==void 0&&(o=n.onCaughtError),n.onRecoverableError!==void 0&&(a=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(l=n.unstable_transitionCallbacks),n.formState!==void 0&&(c=n.formState)),t=bF(e,1,!0,t,n??null,i,r,s,o,a,l,c),t.context=yF(null),n=t.current,i=Qr(),r=mc(i),r.callback=null,pc(n,r,i),t.current.lanes=i,rp(t,i),ca(t),e[gg]=t.current,g_(e),new X5(t)};M5.version="19.0.0";function TF(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(TF)}catch(e){console.error(e)}}TF(),VN.exports=M5;var zJ=VN.exports;const HJ="modulepreload",VJ=function(e){return"/excalidraw/"+e},kC={},ye=function(t,n,i){let r=Promise.resolve();return n&&n.length>0&&(document.getElementsByTagName("link"),r=Promise.all(n.map(s=>{if(s=VJ(s),s in kC)return;kC[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${a}`))return;const l=document.createElement("link");if(l.rel=o?"stylesheet":HJ,o||(l.as="script",l.crossOrigin=""),l.href=s,document.head.appendChild(l),o)return new Promise((c,d)=>{l.addEventListener("load",c),l.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${s}`)))})}))),r.then(()=>t()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};function $J(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:i,onRegistered:r,onRegisteredSW:s,onRegisterError:o}=e;let a,l;const c=async(u=!0)=>{await l};async function d(){if("serviceWorker"in navigator){if(a=await ye(()=>import("./workbox-window.prod.es5-B9K5rw8f.js"),__vite__mapDeps([])).then(({Workbox:u})=>new u("/excalidraw/sw.js",{scope:"/excalidraw/",type:"classic"})).catch(u=>{o==null||o(u)}),!a)return;a.addEventListener("activated",u=>{(u.isUpdate||u.isExternal)&&window.location.reload()}),a.addEventListener("installed",u=>{u.isUpdate||i==null||i()}),a.register({immediate:t}).then(u=>{s?s("/excalidraw/sw.js",u):r==null||r(u)}).catch(u=>{o==null||o(u)})}}return l=d(),c}const Ot=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Ht=globalThis,Bu=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,qd="9.0.1";function j5(){return Y5(Ht),Ht}function Y5(e){const t=e.__SENTRY__=e.__SENTRY__||{};return t.version=t.version||qd,t[qd]=t[qd]||{}}function W5(e,t,n=Ht){const i=n.__SENTRY__=n.__SENTRY__||{},r=i[qd]=i[qd]||{};return r[e]||(r[e]=t())}const GJ="Sentry Logger ",$b=["debug","info","warn","error","log","assert","trace"],Gb={};function yg(e){if(!("console"in Ht))return e();const t=Ht.console,n={},i=Object.keys(Gb);i.forEach(r=>{const s=Gb[r];n[r]=t[r],t[r]=s});try{return e()}finally{i.forEach(r=>{t[r]=n[r]})}}function XJ(){let e=!1;const t={enable:()=>{e=!0},disable:()=>{e=!1},isEnabled:()=>e};return Bu?$b.forEach(n=>{t[n]=(...i)=>{e&&yg(()=>{Ht.console[n](`${GJ}[${n}]:`,...i)})}}):$b.forEach(n=>{t[n]=()=>{}}),t}const Ge=W5("logger",XJ),IF=50,du="?",RC=/\(error: (.*)\)/,DC=/captureMessage|captureException/;function SF(...e){const t=e.sort((n,i)=>n[0]-i[0]).map(n=>n[1]);return(n,i=0,r=0)=>{const s=[],o=n.split(`
`);for(let a=i;a<o.length;a++){const l=o[a];if(l.length>1024)continue;const c=RC.test(l)?l.replace(RC,"$1"):l;if(!c.match(/\S*Error: /)){for(const d of t){const u=d(c);if(u){s.push(u);break}}if(s.length>=IF+r)break}}return YJ(s.slice(r))}}function jJ(e){return Array.isArray(e)?SF(...e):e}function YJ(e){if(!e.length)return[];const t=Array.from(e);return/sentryWrapped/.test(MU(t).function||"")&&t.pop(),t.reverse(),DC.test(MU(t).function||"")&&(t.pop(),DC.test(MU(t).function||"")&&t.pop()),t.slice(0,IF).map(n=>({...n,filename:n.filename||MU(t).filename,function:n.function||du}))}function MU(e){return e[e.length-1]||{}}const w8="<anonymous>";function Fc(e){try{return!e||typeof e!="function"?w8:e.name||w8}catch{return w8}}function LC(e){const t=e.exception;if(t){const n=[];try{return t.values.forEach(i=>{i.stacktrace.frames&&n.push(...i.stacktrace.frames)}),n}catch{return}}}const R2={},NC={};function zu(e,t){R2[e]=R2[e]||[],R2[e].push(t)}function Hu(e,t){if(!NC[e]){NC[e]=!0;try{t()}catch(n){Bu&&Ge.error(`Error while instrumenting ${e}`,n)}}}function so(e,t){const n=e&&R2[e];if(n)for(const i of n)try{i(t)}catch(r){Bu&&Ge.error(`Error while triggering instrumentation handler.
Type: ${e}
Name: ${Fc(i)}
Error:`,r)}}let _8=null;function WJ(e){const t="error";zu(t,e),Hu(t,KJ)}function KJ(){_8=Ht.onerror,Ht.onerror=function(e,t,n,i,r){return so("error",{column:i,error:r,line:n,msg:e,url:t}),_8?_8.apply(this,arguments):!1},Ht.onerror.__SENTRY_INSTRUMENTED__=!0}let T8=null;function ZJ(e){const t="unhandledrejection";zu(t,e),Hu(t,qJ)}function qJ(){T8=Ht.onunhandledrejection,Ht.onunhandledrejection=function(e){return so("unhandledrejection",e),T8?T8.apply(this,arguments):!0},Ht.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const xF=Object.prototype.toString;function v_(e){switch(xF.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return uu(e,Error)}}function Eg(e,t){return xF.call(e)===`[object ${t}]`}function CF(e){return Eg(e,"ErrorEvent")}function OC(e){return Eg(e,"DOMError")}function QJ(e){return Eg(e,"DOMException")}function Wa(e){return Eg(e,"String")}function w_(e){return typeof e=="object"&&e!==null&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function __(e){return e===null||w_(e)||typeof e!="object"&&typeof e!="function"}function Lh(e){return Eg(e,"Object")}function K5(e){return typeof Event<"u"&&uu(e,Event)}function JJ(e){return typeof Element<"u"&&uu(e,Element)}function eee(e){return Eg(e,"RegExp")}function Z5(e){return!!(e!=null&&e.then&&typeof e.then=="function")}function tee(e){return Lh(e)&&"nativeEvent"in e&&"preventDefault"in e&&"stopPropagation"in e}function uu(e,t){try{return e instanceof t}catch{return!1}}function AF(e){return!!(typeof e=="object"&&e!==null&&(e.__isVue||e._isVue))}const T_=Ht,nee=80;function MF(e,t={}){if(!e)return"<unknown>";try{let n=e;const i=5,r=[];let s=0,o=0;const a=" > ",l=a.length;let c;const d=Array.isArray(t)?t:t.keyAttrs,u=!Array.isArray(t)&&t.maxStringLength||nee;for(;n&&s++<i&&(c=iee(n,d),!(c==="html"||s>1&&o+r.length*l+c.length>=u));)r.push(c),o+=c.length,n=n.parentNode;return r.reverse().join(a)}catch{return"<unknown>"}}function iee(e,t){const n=e,i=[];if(!(n!=null&&n.tagName))return"";if(T_.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}i.push(n.tagName.toLowerCase());const r=t!=null&&t.length?t.filter(o=>n.getAttribute(o)).map(o=>[o,n.getAttribute(o)]):null;if(r!=null&&r.length)r.forEach(o=>{i.push(`[${o[0]}="${o[1]}"]`)});else{n.id&&i.push(`#${n.id}`);const o=n.className;if(o&&Wa(o)){const a=o.split(/\s+/);for(const l of a)i.push(`.${l}`)}}const s=["aria-label","type","name","title","alt"];for(const o of s){const a=n.getAttribute(o);a&&i.push(`[${o}="${a}"]`)}return i.join("")}function I_(){try{return T_.document.location.href}catch{return""}}function ree(e){if(!T_.HTMLElement)return null;let t=e;const n=5;for(let i=0;i<n;i++){if(!t)return null;if(t instanceof HTMLElement){if(t.dataset.sentryComponent)return t.dataset.sentryComponent;if(t.dataset.sentryElement)return t.dataset.sentryElement}t=t.parentNode}return null}function lh(e,t=0){return typeof e!="string"||t===0||e.length<=t?e:`${e.slice(0,t)}...`}function Xb(e,t){if(!Array.isArray(e))return"";const n=[];for(let i=0;i<e.length;i++){const r=e[i];try{AF(r)?n.push("[VueViewModel]"):n.push(String(r))}catch{n.push("[value cannot be serialized]")}}return n.join(t)}function see(e,t,n=!1){return Wa(e)?eee(t)?t.test(e):Wa(t)?n?e===t:e.includes(t):!1:!1}function q5(e,t=[],n=!1){return t.some(i=>see(e,i,n))}function Xr(e,t,n){if(!(t in e))return;const i=e[t],r=n(i);typeof r=="function"&&kF(r,i);try{e[t]=r}catch{Bu&&Ge.log(`Failed to replace method "${t}" in object`,e)}}function fu(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch{Bu&&Ge.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function kF(e,t){try{const n=t.prototype||{};e.prototype=t.prototype=n,fu(e,"__sentry_original__",t)}catch{}}function S_(e){return e.__sentry_original__}function RF(e){if(v_(e))return{message:e.message,name:e.name,stack:e.stack,...FC(e)};if(K5(e)){const t={type:e.type,target:PC(e.target),currentTarget:PC(e.currentTarget),...FC(e)};return typeof CustomEvent<"u"&&uu(e,CustomEvent)&&(t.detail=e.detail),t}else return e}function PC(e){try{return JJ(e)?MF(e):Object.prototype.toString.call(e)}catch{return"<unknown>"}}function FC(e){if(typeof e=="object"&&e!==null){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}else return{}}function oee(e,t=40){const n=Object.keys(RF(e));n.sort();const i=n[0];if(!i)return"[object has no keys]";if(i.length>=t)return lh(i,t);for(let r=n.length;r>0;r--){const s=n.slice(0,r).join(", ");if(!(s.length>t))return r===n.length?s:lh(s,t)}return""}function jr(e){return s4(e,new Map)}function s4(e,t){if(aee(e)){const n=t.get(e);if(n!==void 0)return n;const i={};t.set(e,i);for(const r of Object.getOwnPropertyNames(e))typeof e[r]<"u"&&(i[r]=s4(e[r],t));return i}if(Array.isArray(e)){const n=t.get(e);if(n!==void 0)return n;const i=[];return t.set(e,i),e.forEach(r=>{i.push(s4(r,t))}),i}return e}function aee(e){if(!Lh(e))return!1;try{const t=Object.getPrototypeOf(e).constructor.name;return!t||t==="Object"}catch{return!0}}const DF=1e3;function gp(){return Date.now()/DF}function lee(){const{performance:e}=Ht;if(!(e!=null&&e.now))return gp;const t=Date.now()-e.now(),n=e.timeOrigin==null?t:e.timeOrigin;return()=>(n+e.now())/DF}const Ka=lee();function xs(){const e=Ht,t=e.crypto||e.msCrypto;let n=()=>Math.random()*16;try{if(t!=null&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t!=null&&t.getRandomValues&&(n=()=>{const i=new Uint8Array(1);return t.getRandomValues(i),i[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,i=>(i^(n()&15)>>i/4).toString(16))}function LF(e){var t,n;return(n=(t=e.exception)==null?void 0:t.values)==null?void 0:n[0]}function Wl(e){const{message:t,event_id:n}=e;if(t)return t;const i=LF(e);return i?i.type&&i.value?`${i.type}: ${i.value}`:i.type||i.value||n||"<unknown>":n||"<unknown>"}function o4(e,t,n){const i=e.exception=e.exception||{},r=i.values=i.values||[],s=r[0]=r[0]||{};s.value||(s.value=t||""),s.type||(s.type="Error")}function hu(e,t){const n=LF(e);if(!n)return;const i={type:"generic",handled:!0},r=n.mechanism;if(n.mechanism={...i,...r,...t},t&&"data"in t){const s={...r==null?void 0:r.data,...t.data};n.mechanism.data=s}}function BC(e){if(cee(e))return!0;try{fu(e,"__sentry_captured__",!0)}catch{}return!1}function cee(e){try{return e.__sentry_captured__}catch{}}var _a;(function(e){e[e.PENDING=0]="PENDING";const n=1;e[e.RESOLVED=n]="RESOLVED";const i=2;e[e.REJECTED=i]="REJECTED"})(_a||(_a={}));function gu(e){return new Bc(t=>{t(e)})}function jb(e){return new Bc((t,n)=>{n(e)})}class Bc{constructor(t){this._state=_a.PENDING,this._handlers=[],this._runExecutor(t)}then(t,n){return new Bc((i,r)=>{this._handlers.push([!1,s=>{if(!t)i(s);else try{i(t(s))}catch(o){r(o)}},s=>{if(!n)r(s);else try{i(n(s))}catch(o){r(o)}}]),this._executeHandlers()})}catch(t){return this.then(n=>n,t)}finally(t){return new Bc((n,i)=>{let r,s;return this.then(o=>{s=!1,r=o,t&&t()},o=>{s=!0,r=o,t&&t()}).then(()=>{if(s){i(r);return}n(r)})})}_executeHandlers(){if(this._state===_a.PENDING)return;const t=this._handlers.slice();this._handlers=[],t.forEach(n=>{n[0]||(this._state===_a.RESOLVED&&n[1](this._value),this._state===_a.REJECTED&&n[2](this._value),n[0]=!0)})}_runExecutor(t){const n=(s,o)=>{if(this._state===_a.PENDING){if(Z5(o)){o.then(i,r);return}this._state=s,this._value=o,this._executeHandlers()}},i=s=>{n(_a.RESOLVED,s)},r=s=>{n(_a.REJECTED,s)};try{t(i,r)}catch(s){r(s)}}}function dee(e){const t=Ka(),n={sid:xs(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>fee(n)};return e&&Nh(n,e),n}function Nh(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),!e.did&&!t.did&&(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||Ka(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=t.sid.length===32?t.sid:xs()),t.init!==void 0&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),typeof t.started=="number"&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if(typeof t.duration=="number")e.duration=t.duration;else{const n=e.timestamp-e.started;e.duration=n>=0?n:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),typeof t.errors=="number"&&(e.errors=t.errors),t.status&&(e.status=t.status)}function uee(e,t){let n={};e.status==="ok"&&(n={status:"exited"}),Nh(e,n)}function fee(e){return jr({sid:`${e.sid}`,init:e.init,started:new Date(e.started*1e3).toISOString(),timestamp:new Date(e.timestamp*1e3).toISOString(),status:e.status,errors:e.errors,did:typeof e.did=="number"||typeof e.did=="string"?`${e.did}`:void 0,duration:e.duration,abnormal_mechanism:e.abnormal_mechanism,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}})}function zC(){return xs()}function NF(){return xs().substring(16)}function mp(e,t,n=2){if(!t||typeof t!="object"||n<=0)return t;if(e&&Object.keys(t).length===0)return e;const i={...e};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=mp(i[r],t[r],n-1));return i}const a4="_sentrySpan";function HC(e,t){t?fu(e,a4,t):delete e[a4]}function VC(e){return e[a4]}const hee=100;class Zo{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:zC(),sampleRand:Math.random()}}clone(){const t=new Zo;return t._breadcrumbs=[...this._breadcrumbs],t._tags={...this._tags},t._extra={...this._extra},t._contexts={...this._contexts},this._contexts.flags&&(t._contexts.flags={values:[...this._contexts.flags.values]}),t._user=this._user,t._level=this._level,t._session=this._session,t._transactionName=this._transactionName,t._fingerprint=this._fingerprint,t._eventProcessors=[...this._eventProcessors],t._attachments=[...this._attachments],t._sdkProcessingMetadata={...this._sdkProcessingMetadata},t._propagationContext={...this._propagationContext},t._client=this._client,t._lastEventId=this._lastEventId,HC(t,VC(this)),t}setClient(t){this._client=t}setLastEventId(t){this._lastEventId=t}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(t){this._scopeListeners.push(t)}addEventProcessor(t){return this._eventProcessors.push(t),this}setUser(t){return this._user=t||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&Nh(this._session,{user:t}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(t){return this._tags={...this._tags,...t},this._notifyScopeListeners(),this}setTag(t,n){return this._tags={...this._tags,[t]:n},this._notifyScopeListeners(),this}setExtras(t){return this._extra={...this._extra,...t},this._notifyScopeListeners(),this}setExtra(t,n){return this._extra={...this._extra,[t]:n},this._notifyScopeListeners(),this}setFingerprint(t){return this._fingerprint=t,this._notifyScopeListeners(),this}setLevel(t){return this._level=t,this._notifyScopeListeners(),this}setTransactionName(t){return this._transactionName=t,this._notifyScopeListeners(),this}setContext(t,n){return n===null?delete this._contexts[t]:this._contexts[t]=n,this._notifyScopeListeners(),this}setSession(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(t){if(!t)return this;const n=typeof t=="function"?t(this):t,i=n instanceof Zo?n.getScopeData():Lh(n)?t:void 0,{tags:r,extra:s,user:o,contexts:a,level:l,fingerprint:c=[],propagationContext:d}=i||{};return this._tags={...this._tags,...r},this._extra={...this._extra,...s},this._contexts={...this._contexts,...a},o&&Object.keys(o).length&&(this._user=o),l&&(this._level=l),c.length&&(this._fingerprint=c),d&&(this._propagationContext=d),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,HC(this,void 0),this._attachments=[],this.setPropagationContext({traceId:zC(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(t,n){var s;const i=typeof n=="number"?n:hee;if(i<=0)return this;const r={timestamp:gp(),...t};return this._breadcrumbs.push(r),this._breadcrumbs.length>i&&(this._breadcrumbs=this._breadcrumbs.slice(-i),(s=this._client)==null||s.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(t){return this._attachments.push(t),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:VC(this)}}setSDKProcessingMetadata(t){return this._sdkProcessingMetadata=mp(this._sdkProcessingMetadata,t,2),this}setPropagationContext(t){return this._propagationContext=t,this}getPropagationContext(){return this._propagationContext}captureException(t,n){const i=(n==null?void 0:n.event_id)||xs();if(!this._client)return Ge.warn("No client configured on scope - will not capture exception!"),i;const r=new Error("Sentry syntheticException");return this._client.captureException(t,{originalException:t,syntheticException:r,...n,event_id:i},this),i}captureMessage(t,n,i){const r=(i==null?void 0:i.event_id)||xs();if(!this._client)return Ge.warn("No client configured on scope - will not capture message!"),r;const s=new Error(t);return this._client.captureMessage(t,n,{originalException:t,syntheticException:s,...i,event_id:r},this),r}captureEvent(t,n){const i=(n==null?void 0:n.event_id)||xs();return this._client?(this._client.captureEvent(t,{...n,event_id:i},this),i):(Ge.warn("No client configured on scope - will not capture event!"),i)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(t=>{t(this)}),this._notifyingListeners=!1)}}function gee(){return W5("defaultCurrentScope",()=>new Zo)}function mee(){return W5("defaultIsolationScope",()=>new Zo)}class pee{constructor(t,n){let i;t?i=t:i=new Zo;let r;n?r=n:r=new Zo,this._stack=[{scope:i}],this._isolationScope=r}withScope(t){const n=this._pushScope();let i;try{i=t(n)}catch(r){throw this._popScope(),r}return Z5(i)?i.then(r=>(this._popScope(),r),r=>{throw this._popScope(),r}):(this._popScope(),i)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const t=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:t}),t}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function Oh(){const e=j5(),t=Y5(e);return t.stack=t.stack||new pee(gee(),mee())}function Uee(e){return Oh().withScope(e)}function bee(e,t){const n=Oh();return n.withScope(()=>(n.getStackTop().scope=e,t(e)))}function $C(e){return Oh().withScope(()=>e(Oh().getIsolationScope()))}function yee(){return{withIsolationScope:$C,withScope:Uee,withSetScope:bee,withSetIsolationScope:(e,t)=>$C(t),getCurrentScope:()=>Oh().getScope(),getIsolationScope:()=>Oh().getIsolationScope()}}function x_(e){const t=Y5(e);return t.acs?t.acs:yee()}function Tl(){const e=j5();return x_(e).getCurrentScope()}function pp(){const e=j5();return x_(e).getIsolationScope()}function Eee(){return W5("globalScope",()=>new Zo)}function C_(...e){const t=j5(),n=x_(t);if(e.length===2){const[i,r]=e;return i?n.withSetScope(i,r):n.withScope(r)}return n.withScope(e[0])}function Ji(){return Tl().getClient()}function vee(e){const t=e.getPropagationContext(),{traceId:n,parentSpanId:i,propagationSpanId:r}=t;return jr({trace_id:n,span_id:r||NF(),parent_span_id:i})}const wee="sentry.source",_ee="sentry.sample_rate",Tee="sentry.op",Iee="sentry.origin",OF="sentry.profile_id",PF="sentry.exclusive_time",See=0,xee=1,Cee="_sentryScope",Aee="_sentryIsolationScope";function FF(e){return{scope:e[Cee],isolationScope:e[Aee]}}function Mee(e){if(typeof e=="boolean")return Number(e);const t=typeof e=="string"?parseFloat(e):e;if(!(typeof t!="number"||isNaN(t)||t<0||t>1))return t}const kee="sentry-",Ree=/^sentry-/;function Dee(e){const t=Lee(e);if(!t)return;const n=Object.entries(t).reduce((i,[r,s])=>{if(r.match(Ree)){const o=r.slice(kee.length);i[o]=s}return i},{});if(Object.keys(n).length>0)return n}function Lee(e){if(!(!e||!Wa(e)&&!Array.isArray(e)))return Array.isArray(e)?e.reduce((t,n)=>{const i=GC(n);return Object.entries(i).forEach(([r,s])=>{t[r]=s}),t},{}):GC(e)}function GC(e){return e.split(",").map(t=>t.split("=").map(n=>decodeURIComponent(n.trim()))).reduce((t,[n,i])=>(n&&i&&(t[n]=i),t),{})}const Nee=1;let XC=!1;function Oee(e){const{spanId:t,traceId:n,isRemote:i}=e.spanContext(),r=i?t:A_(e).parent_span_id,s=FF(e).scope,o=i?(s==null?void 0:s.getPropagationContext().propagationSpanId)||NF():t;return jr({parent_span_id:r,span_id:o,trace_id:n})}function jC(e){return typeof e=="number"?YC(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?YC(e.getTime()):Ka()}function YC(e){return e>9999999999?e/1e3:e}function A_(e){if(Fee(e))return e.getSpanJSON();const{spanId:t,traceId:n}=e.spanContext();if(Pee(e)){const{attributes:i,startTime:r,name:s,endTime:o,parentSpanId:a,status:l}=e;return jr({span_id:t,trace_id:n,data:i,description:s,parent_span_id:a,start_timestamp:jC(r),timestamp:jC(o)||void 0,status:zee(l),op:i[Tee],origin:i[Iee]})}return{span_id:t,trace_id:n,start_timestamp:0,data:{}}}function Pee(e){const t=e;return!!t.attributes&&!!t.startTime&&!!t.name&&!!t.endTime&&!!t.status}function Fee(e){return typeof e.getSpanJSON=="function"}function Bee(e){const{traceFlags:t}=e.spanContext();return t===Nee}function zee(e){if(!(!e||e.code===See))return e.code===xee?"ok":e.message||"unknown_error"}const Hee="_sentryRootSpan";function BF(e){return e[Hee]||e}function WC(){XC||(yg(()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly.")}),XC=!0)}function Vee(e){var n;if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const t=e||((n=Ji())==null?void 0:n.getOptions());return!!t&&(t.tracesSampleRate!=null||!!t.tracesSampler)}const M_="production",$ee="_frozenDsc";function zF(e,t){const n=t.getOptions(),{publicKey:i}=t.getDsn()||{},r=jr({environment:n.environment||M_,release:n.release,public_key:i,trace_id:e});return t.emit("createDsc",r),r}function Gee(e,t){const n=t.getPropagationContext();return n.dsc||zF(n.traceId,e)}function Xee(e){var m;const t=Ji();if(!t)return{};const n=BF(e),i=A_(n),r=i.data,s=n.spanContext().traceState,o=(s==null?void 0:s.get("sentry.sample_rate"))??r[_ee];function a(p){return(typeof o=="number"||typeof o=="string")&&(p.sample_rate=`${o}`),p}const l=n[$ee];if(l)return a(l);const c=s==null?void 0:s.get("sentry.dsc"),d=c&&Dee(c);if(d)return a(d);const u=zF(e.spanContext().traceId,t),f=r[wee],h=i.description;return f!=="url"&&h&&(u.transaction=h),Vee()&&(u.sampled=String(Bee(n)),u.sample_rand=(s==null?void 0:s.get("sentry.sample_rand"))??((m=FF(n).scope)==null?void 0:m.getPropagationContext().sampleRand.toString())),a(u),t.emit("createDsc",u,n),u}const jee=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Yee(e){return e==="http"||e==="https"}function k_(e,t=!1){const{host:n,path:i,pass:r,port:s,projectId:o,protocol:a,publicKey:l}=e;return`${a}://${l}${t&&r?`:${r}`:""}@${n}${s?`:${s}`:""}/${i&&`${i}/`}${o}`}function Wee(e){const t=jee.exec(e);if(!t){yg(()=>{console.error(`Invalid Sentry Dsn: ${e}`)});return}const[n,i,r="",s="",o="",a=""]=t.slice(1);let l="",c=a;const d=c.split("/");if(d.length>1&&(l=d.slice(0,-1).join("/"),c=d.pop()),c){const u=c.match(/^\d+/);u&&(c=u[0])}return HF({host:s,pass:r,path:l,projectId:c,port:o,protocol:n,publicKey:i})}function HF(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function Kee(e){if(!Bu)return!0;const{port:t,projectId:n,protocol:i}=e;return["protocol","publicKey","host","projectId"].find(o=>e[o]?!1:(Ge.error(`Invalid Sentry Dsn: ${o} missing`),!0))?!1:n.match(/^\d+$/)?Yee(i)?t&&isNaN(parseInt(t,10))?(Ge.error(`Invalid Sentry Dsn: Invalid port ${t}`),!1):!0:(Ge.error(`Invalid Sentry Dsn: Invalid protocol ${i}`),!1):(Ge.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function Zee(e){const t=typeof e=="string"?Wee(e):HF(e);if(!(!t||!Kee(t)))return t}function Ta(e,t=100,n=1/0){try{return l4("",e,t,n)}catch(i){return{ERROR:`**non-serializable** (${i})`}}}function VF(e,t=3,n=100*1024){const i=Ta(e,t);return ete(i)>n?VF(e,t-1,n):i}function l4(e,t,n=1/0,i=1/0,r=tte()){const[s,o]=r;if(t==null||["boolean","string"].includes(typeof t)||typeof t=="number"&&Number.isFinite(t))return t;const a=qee(e,t);if(!a.startsWith("[object "))return a;if(t.__sentry_skip_normalization__)return t;const l=typeof t.__sentry_override_normalization_depth__=="number"?t.__sentry_override_normalization_depth__:n;if(l===0)return a.replace("object ","");if(s(t))return"[Circular ~]";const c=t;if(c&&typeof c.toJSON=="function")try{const h=c.toJSON();return l4("",h,l-1,i,r)}catch{}const d=Array.isArray(t)?[]:{};let u=0;const f=RF(t);for(const h in f){if(!Object.prototype.hasOwnProperty.call(f,h))continue;if(u>=i){d[h]="[MaxProperties ~]";break}const m=f[h];d[h]=l4(h,m,l-1,i,r),u++}return o(t),d}function qee(e,t){try{if(e==="domain"&&t&&typeof t=="object"&&t._events)return"[Domain]";if(e==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&t===global)return"[Global]";if(typeof window<"u"&&t===window)return"[Window]";if(typeof document<"u"&&t===document)return"[Document]";if(AF(t))return"[VueViewModel]";if(tee(t))return"[SyntheticEvent]";if(typeof t=="number"&&!Number.isFinite(t))return`[${t}]`;if(typeof t=="function")return`[Function: ${Fc(t)}]`;if(typeof t=="symbol")return`[${String(t)}]`;if(typeof t=="bigint")return`[BigInt: ${String(t)}]`;const n=Qee(t);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function Qee(e){const t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}function Jee(e){return~-encodeURI(e).split(/%..|./).length}function ete(e){return Jee(JSON.stringify(e))}function tte(){const e=new WeakSet;function t(i){return e.has(i)?!0:(e.add(i),!1)}function n(i){e.delete(i)}return[t,n]}function Q5(e,t=[]){return[e,t]}function nte(e,t){const[n,i]=e;return[n,[...i,t]]}function KC(e,t){const n=e[1];for(const i of n){const r=i[0].type;if(t(i,r))return!0}return!1}function c4(e){const t=Y5(Ht);return t.encodePolyfill?t.encodePolyfill(e):new TextEncoder().encode(e)}function ite(e){const[t,n]=e;let i=JSON.stringify(t);function r(s){typeof i=="string"?i=typeof s=="string"?i+s:[c4(i),s]:i.push(typeof s=="string"?c4(s):s)}for(const s of n){const[o,a]=s;if(r(`
${JSON.stringify(o)}
`),typeof a=="string"||a instanceof Uint8Array)r(a);else{let l;try{l=JSON.stringify(a)}catch{l=JSON.stringify(Ta(a))}r(l)}}return typeof i=="string"?i:rte(i)}function rte(e){const t=e.reduce((r,s)=>r+s.length,0),n=new Uint8Array(t);let i=0;for(const r of e)n.set(r,i),i+=r.length;return n}function ste(e){const t=typeof e.data=="string"?c4(e.data):e.data;return[jr({type:"attachment",length:t.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),t]}const ote={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security"};function ZC(e){return ote[e]}function $F(e){if(!(e!=null&&e.sdk))return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}function ate(e,t,n,i){var s;const r=(s=e.sdkProcessingMetadata)==null?void 0:s.dynamicSamplingContext;return{event_id:e.event_id,sent_at:new Date().toISOString(),...t&&{sdk:t},...!!n&&i&&{dsn:k_(i)},...r&&{trace:jr({...r})}}}function lte(e,t){return t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]]),e}function cte(e,t,n,i){const r=$F(n),s={sent_at:new Date().toISOString(),...r&&{sdk:r},...!!i&&t&&{dsn:k_(t)}},o="aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()];return Q5(s,[o])}function dte(e,t,n,i){const r=$F(n),s=e.type&&e.type!=="replay_event"?e.type:"event";lte(e,n==null?void 0:n.sdk);const o=ate(e,r,i,t);return delete e.sdkProcessingMetadata,Q5(o,[[{type:s},e]])}function d4(e,t,n,i=0){return new Bc((r,s)=>{const o=e[i];if(t===null||typeof o!="function")r(t);else{const a=o({...t},n);Ot&&o.id&&a===null&&Ge.log(`Event processor "${o.id}" dropped event`),Z5(a)?a.then(l=>d4(e,l,n,i+1).then(r)).then(null,s):d4(e,a,n,i+1).then(r).then(null,s)}})}let kU,qC,RU;function ute(e){const t=Ht._sentryDebugIds;if(!t)return{};const n=Object.keys(t);return RU&&n.length===qC||(qC=n.length,RU=n.reduce((i,r)=>{kU||(kU={});const s=kU[r];if(s)i[s[0]]=s[1];else{const o=e(r);for(let a=o.length-1;a>=0;a--){const l=o[a],c=l==null?void 0:l.filename,d=t[r];if(c&&d){i[c]=d,kU[r]=[c,d];break}}}return i},{})),RU}function fte(e,t){const{fingerprint:n,span:i,breadcrumbs:r,sdkProcessingMetadata:s}=t;hte(e,t),i&&pte(e,i),Ute(e,n),gte(e,r),mte(e,s)}function QC(e,t){const{extra:n,tags:i,user:r,contexts:s,level:o,sdkProcessingMetadata:a,breadcrumbs:l,fingerprint:c,eventProcessors:d,attachments:u,propagationContext:f,transactionName:h,span:m}=t;DU(e,"extra",n),DU(e,"tags",i),DU(e,"user",r),DU(e,"contexts",s),e.sdkProcessingMetadata=mp(e.sdkProcessingMetadata,a,2),o&&(e.level=o),h&&(e.transactionName=h),m&&(e.span=m),l.length&&(e.breadcrumbs=[...e.breadcrumbs,...l]),c.length&&(e.fingerprint=[...e.fingerprint,...c]),d.length&&(e.eventProcessors=[...e.eventProcessors,...d]),u.length&&(e.attachments=[...e.attachments,...u]),e.propagationContext={...e.propagationContext,...f}}function DU(e,t,n){e[t]=mp(e[t],n,1)}function hte(e,t){const{extra:n,tags:i,user:r,contexts:s,level:o,transactionName:a}=t,l=jr(n);Object.keys(l).length&&(e.extra={...l,...e.extra});const c=jr(i);Object.keys(c).length&&(e.tags={...c,...e.tags});const d=jr(r);Object.keys(d).length&&(e.user={...d,...e.user});const u=jr(s);Object.keys(u).length&&(e.contexts={...u,...e.contexts}),o&&(e.level=o),a&&e.type!=="transaction"&&(e.transaction=a)}function gte(e,t){const n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}function mte(e,t){e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...t}}function pte(e,t){e.contexts={trace:Oee(t),...e.contexts},e.sdkProcessingMetadata={dynamicSamplingContext:Xee(t),...e.sdkProcessingMetadata};const n=BF(t),i=A_(n).description;i&&!e.transaction&&e.type==="transaction"&&(e.transaction=i)}function Ute(e,t){e.fingerprint=e.fingerprint?Array.isArray(e.fingerprint)?e.fingerprint:[e.fingerprint]:[],t&&(e.fingerprint=e.fingerprint.concat(t)),e.fingerprint.length||delete e.fingerprint}function bte(e,t,n,i,r,s){const{normalizeDepth:o=3,normalizeMaxBreadth:a=1e3}=e,l={...t,event_id:t.event_id||n.event_id||xs(),timestamp:t.timestamp||gp()},c=n.integrations||e.integrations.map(U=>U.name);yte(l,e),wte(l,c),r&&r.emit("applyFrameMetadata",t),t.type===void 0&&Ete(l,e.stackParser);const d=Tte(i,n.captureContext);n.mechanism&&hu(l,n.mechanism);const u=r?r.getEventProcessors():[],f=Eee().getScopeData();if(s){const U=s.getScopeData();QC(f,U)}if(d){const U=d.getScopeData();QC(f,U)}const h=[...n.attachments||[],...f.attachments];h.length&&(n.attachments=h),fte(l,f);const m=[...u,...f.eventProcessors];return d4(m,l,n).then(U=>(U&&vte(U),typeof o=="number"&&o>0?_te(U,o,a):U))}function yte(e,t){var l,c;const{environment:n,release:i,dist:r,maxValueLength:s=250}=t;e.environment=e.environment||n||M_,!e.release&&i&&(e.release=i),!e.dist&&r&&(e.dist=r),e.message&&(e.message=lh(e.message,s));const o=(c=(l=e.exception)==null?void 0:l.values)==null?void 0:c[0];o!=null&&o.value&&(o.value=lh(o.value,s));const a=e.request;a!=null&&a.url&&(a.url=lh(a.url,s))}function Ete(e,t){var i,r;const n=ute(t);(r=(i=e.exception)==null?void 0:i.values)==null||r.forEach(s=>{var o,a;(a=(o=s.stacktrace)==null?void 0:o.frames)==null||a.forEach(l=>{l.filename&&(l.debug_id=n[l.filename])})})}function vte(e){var i,r;const t={};if((r=(i=e.exception)==null?void 0:i.values)==null||r.forEach(s=>{var o,a;(a=(o=s.stacktrace)==null?void 0:o.frames)==null||a.forEach(l=>{l.debug_id&&(l.abs_path?t[l.abs_path]=l.debug_id:l.filename&&(t[l.filename]=l.debug_id),delete l.debug_id)})}),Object.keys(t).length===0)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const n=e.debug_meta.images;Object.entries(t).forEach(([s,o])=>{n.push({type:"sourcemap",code_file:s,debug_id:o})})}function wte(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}function _te(e,t,n){var r,s;if(!e)return null;const i={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map(o=>({...o,...o.data&&{data:Ta(o.data,t,n)}}))},...e.user&&{user:Ta(e.user,t,n)},...e.contexts&&{contexts:Ta(e.contexts,t,n)},...e.extra&&{extra:Ta(e.extra,t,n)}};return(r=e.contexts)!=null&&r.trace&&i.contexts&&(i.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(i.contexts.trace.data=Ta(e.contexts.trace.data,t,n))),e.spans&&(i.spans=e.spans.map(o=>({...o,...o.data&&{data:Ta(o.data,t,n)}}))),(s=e.contexts)!=null&&s.flags&&i.contexts&&(i.contexts.flags=Ta(e.contexts.flags,3,n)),i}function Tte(e,t){if(!t)return e;const n=e?e.clone():new Zo;return n.update(t),n}function Ite(e){if(e)return Ste(e)?{captureContext:e}:Cte(e)?{captureContext:e}:e}function Ste(e){return e instanceof Zo||typeof e=="function"}const xte=["user","level","extra","contexts","tags","fingerprint","propagationContext"];function Cte(e){return Object.keys(e).some(t=>xte.includes(t))}function R_(e,t){return Tl().captureException(e,Ite(t))}function JC(e,t){const n=typeof t=="string"?t:void 0,i=typeof t!="string"?{captureContext:t}:void 0;return Tl().captureMessage(e,n,i)}function GF(e,t){return Tl().captureEvent(e,t)}function eA(e){const t=pp(),n=Tl(),{userAgent:i}=Ht.navigator||{},r=dee({user:n.getUser()||t.getUser(),...i&&{userAgent:i},...e}),s=t.getSession();return(s==null?void 0:s.status)==="ok"&&Nh(s,{status:"exited"}),XF(),t.setSession(r),r}function XF(){const e=pp(),n=Tl().getSession()||e.getSession();n&&uee(n),jF(),e.setSession()}function jF(){const e=pp(),t=Ji(),n=e.getSession();n&&t&&t.captureSession(n)}function tA(e=!1){if(e){XF();return}jF()}const Ate="7";function Mte(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}function kte(e){return`${Mte(e)}${e.projectId}/envelope/`}function Rte(e,t){const n={sentry_version:Ate};return e.publicKey&&(n.sentry_key=e.publicKey),t&&(n.sentry_client=`${t.name}/${t.version}`),new URLSearchParams(n).toString()}function Dte(e,t,n){return t||`${kte(e)}?${Rte(e,n)}`}const nA=[];function Lte(e){const t={};return e.forEach(n=>{const{name:i}=n,r=t[i];r&&!r.isDefaultInstance&&n.isDefaultInstance||(t[i]=n)}),Object.values(t)}function Nte(e){const t=e.defaultIntegrations||[],n=e.integrations;t.forEach(r=>{r.isDefaultInstance=!0});let i;if(Array.isArray(n))i=[...t,...n];else if(typeof n=="function"){const r=n(t);i=Array.isArray(r)?r:[r]}else i=t;return Lte(i)}function Ote(e,t){const n={};return t.forEach(i=>{i&&YF(e,i,n)}),n}function iA(e,t){for(const n of t)n!=null&&n.afterAllSetup&&n.afterAllSetup(e)}function YF(e,t,n){if(n[t.name]){Ot&&Ge.log(`Integration skipped because it was already installed: ${t.name}`);return}if(n[t.name]=t,nA.indexOf(t.name)===-1&&typeof t.setupOnce=="function"&&(t.setupOnce(),nA.push(t.name)),t.setup&&typeof t.setup=="function"&&t.setup(e),typeof t.preprocessEvent=="function"){const i=t.preprocessEvent.bind(t);e.on("preprocessEvent",(r,s)=>i(r,s,e))}if(typeof t.processEvent=="function"){const i=t.processEvent.bind(t),r=Object.assign((s,o)=>i(s,o,e),{id:t.name});e.addEventProcessor(r)}Ot&&Ge.log(`Integration installed: ${t.name}`)}function Pte(e,t,n){const i=[{type:"client_report"},{timestamp:gp(),discarded_events:e}];return Q5(t?{dsn:t}:{},[i])}class Js extends Error{constructor(t,n="warn"){super(t),this.message=t,this.logLevel=n}}function WF(e){const t=[];e.message&&t.push(e.message);try{const n=e.exception.values[e.exception.values.length-1];n!=null&&n.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`))}catch{}return t}function Fte(e){var l;const{trace_id:t,parent_span_id:n,span_id:i,status:r,origin:s,data:o,op:a}=((l=e.contexts)==null?void 0:l.trace)??{};return jr({data:o??{},description:e.transaction,op:a,parent_span_id:n,span_id:i??"",start_timestamp:e.start_timestamp??0,status:r,timestamp:e.timestamp,trace_id:t??"",origin:s,profile_id:o==null?void 0:o[OF],exclusive_time:o==null?void 0:o[PF],measurements:e.measurements,is_segment:!0})}function Bte(e){const t={type:"transaction",timestamp:e.timestamp,start_timestamp:e.start_timestamp,transaction:e.description,contexts:{trace:{trace_id:e.trace_id,span_id:e.span_id,parent_span_id:e.parent_span_id,op:e.op,status:e.status,origin:e.origin,data:{...e.data,...e.profile_id&&{[OF]:e.profile_id},...e.exclusive_time&&{[PF]:e.exclusive_time}}}},measurements:e.measurements};return jr(t)}const rA="Not capturing exception because it's already been captured.",sA="Discarded session because of missing or non-string release";class zte{constructor(t){if(this._options=t,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],t.dsn?this._dsn=Zee(t.dsn):Ot&&Ge.warn("No DSN provided, client will not send events."),this._dsn){const n=Dte(this._dsn,t.tunnel,t._metadata?t._metadata.sdk:void 0);this._transport=t.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...t.transportOptions,url:n})}}captureException(t,n,i){const r=xs();if(BC(t))return Ot&&Ge.log(rA),r;const s={event_id:r,...n};return this._process(this.eventFromException(t,s).then(o=>this._captureEvent(o,s,i))),s.event_id}captureMessage(t,n,i,r){const s={event_id:xs(),...i},o=w_(t)?t:String(t),a=__(t)?this.eventFromMessage(o,n,s):this.eventFromException(t,s);return this._process(a.then(l=>this._captureEvent(l,s,r))),s.event_id}captureEvent(t,n,i){const r=xs();if(n!=null&&n.originalException&&BC(n.originalException))return Ot&&Ge.log(rA),r;const s={event_id:r,...n},o=t.sdkProcessingMetadata||{},a=o.capturedSpanScope,l=o.capturedSpanIsolationScope;return this._process(this._captureEvent(t,s,a||i,l)),s.event_id}captureSession(t){this.sendSession(t),Nh(t,{init:!1})}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(t){const n=this._transport;return n?(this.emit("flush"),this._isClientDoneProcessing(t).then(i=>n.flush(t).then(r=>i&&r))):gu(!0)}close(t){return this.flush(t).then(n=>(this.getOptions().enabled=!1,this.emit("close"),n))}getEventProcessors(){return this._eventProcessors}addEventProcessor(t){this._eventProcessors.push(t)}init(){(this._isEnabled()||this._options.integrations.some(({name:t})=>t.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(t){return this._integrations[t]}addIntegration(t){const n=this._integrations[t.name];YF(this,t,this._integrations),n||iA(this,[t])}sendEvent(t,n={}){this.emit("beforeSendEvent",t,n);let i=dte(t,this._dsn,this._options._metadata,this._options.tunnel);for(const s of n.attachments||[])i=nte(i,ste(s));const r=this.sendEnvelope(i);r&&r.then(s=>this.emit("afterSendEvent",t,s),null)}sendSession(t){const{release:n,environment:i=M_}=this._options;if("aggregates"in t){const s=t.attrs||{};if(!s.release&&!n){Ot&&Ge.warn(sA);return}s.release=s.release||n,s.environment=s.environment||i,t.attrs=s}else{if(!t.release&&!n){Ot&&Ge.warn(sA);return}t.release=t.release||n,t.environment=t.environment||i}this.emit("beforeSendSession",t);const r=cte(t,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(r)}recordDroppedEvent(t,n,i=1){if(this._options.sendClientReports){const r=`${t}:${n}`;Ot&&Ge.log(`Recording outcome: "${r}"${i>1?` (${i} times)`:""}`),this._outcomes[r]=(this._outcomes[r]||0)+i}}on(t,n){const i=this._hooks[t]=this._hooks[t]||[];return i.push(n),()=>{const r=i.indexOf(n);r>-1&&i.splice(r,1)}}emit(t,...n){const i=this._hooks[t];i&&i.forEach(r=>r(...n))}sendEnvelope(t){return this.emit("beforeEnvelope",t),this._isEnabled()&&this._transport?this._transport.send(t).then(null,n=>(Ot&&Ge.error("Error while sending envelope:",n),n)):(Ot&&Ge.error("Transport disabled"),gu({}))}_setupIntegrations(){const{integrations:t}=this._options;this._integrations=Ote(this,t),iA(this,t)}_updateSessionFromEvent(t,n){var l;let i=n.level==="fatal",r=!1;const s=(l=n.exception)==null?void 0:l.values;if(s){r=!0;for(const c of s){const d=c.mechanism;if((d==null?void 0:d.handled)===!1){i=!0;break}}}const o=t.status==="ok";(o&&t.errors===0||o&&i)&&(Nh(t,{...i&&{status:"crashed"},errors:t.errors||Number(r||i)}),this.captureSession(t))}_isClientDoneProcessing(t){return new Bc(n=>{let i=0;const r=1,s=setInterval(()=>{this._numProcessing==0?(clearInterval(s),n(!0)):(i+=r,t&&i>=t&&(clearInterval(s),n(!1)))},r)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(t,n,i,r){const s=this.getOptions(),o=Object.keys(this._integrations);return!n.integrations&&(o!=null&&o.length)&&(n.integrations=o),this.emit("preprocessEvent",t,n),t.type||r.setLastEventId(t.event_id||n.event_id),bte(s,t,n,i,this,r).then(a=>{if(a===null)return a;this.emit("postprocessEvent",a,n),a.contexts={trace:vee(i),...a.contexts};const l=Gee(this,i);return a.sdkProcessingMetadata={dynamicSamplingContext:l,...a.sdkProcessingMetadata},a})}_captureEvent(t,n={},i=Tl(),r=pp()){return Ot&&u4(t)&&Ge.log(`Captured error event \`${WF(t)[0]||"<unknown>"}\``),this._processEvent(t,n,i,r).then(s=>s.event_id,s=>{Ot&&(s instanceof Js&&s.logLevel==="log"?Ge.log(s.message):Ge.warn(s))})}_processEvent(t,n,i,r){const s=this.getOptions(),{sampleRate:o}=s,a=KF(t),l=u4(t),c=t.type||"error",d=`before send for type \`${c}\``,u=typeof o>"u"?void 0:Mee(o);if(l&&typeof u=="number"&&Math.random()>u)return this.recordDroppedEvent("sample_rate","error"),jb(new Js(`Discarding event because it's not included in the random sample (sampling rate = ${o})`,"log"));const f=c==="replay_event"?"replay":c;return this._prepareEvent(t,n,i,r).then(h=>{if(h===null)throw this.recordDroppedEvent("event_processor",f),new Js("An event processor returned `null`, will not send event.","log");if(n.data&&n.data.__sentry__===!0)return h;const p=Vte(this,s,h,n);return Hte(p,d)}).then(h=>{var U;if(h===null){if(this.recordDroppedEvent("before_send",f),a){const y=1+(t.spans||[]).length;this.recordDroppedEvent("before_send","span",y)}throw new Js(`${d} returned \`null\`, will not send event.`,"log")}const m=i.getSession()||r.getSession();if(l&&m&&this._updateSessionFromEvent(m,h),a){const b=((U=h.sdkProcessingMetadata)==null?void 0:U.spanCountBeforeProcessing)||0,y=h.spans?h.spans.length:0,w=b-y;w>0&&this.recordDroppedEvent("before_send","span",w)}const p=h.transaction_info;if(a&&p&&h.transaction!==t.transaction){const b="custom";h.transaction_info={...p,source:b}}return this.sendEvent(h,n),h}).then(null,h=>{throw h instanceof Js?h:(this.captureException(h,{data:{__sentry__:!0},originalException:h}),new Js(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${h}`))})}_process(t){this._numProcessing++,t.then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n))}_clearOutcomes(){const t=this._outcomes;return this._outcomes={},Object.entries(t).map(([n,i])=>{const[r,s]=n.split(":");return{reason:r,category:s,quantity:i}})}_flushOutcomes(){Ot&&Ge.log("Flushing outcomes...");const t=this._clearOutcomes();if(t.length===0){Ot&&Ge.log("No outcomes to send");return}if(!this._dsn){Ot&&Ge.log("No dsn provided, will not send outcomes");return}Ot&&Ge.log("Sending outcomes:",t);const n=Pte(t,this._options.tunnel&&k_(this._dsn));this.sendEnvelope(n)}}function Hte(e,t){const n=`${t} must return \`null\` or a valid event.`;if(Z5(e))return e.then(i=>{if(!Lh(i)&&i!==null)throw new Js(n);return i},i=>{throw new Js(`${t} rejected with ${i}`)});if(!Lh(e)&&e!==null)throw new Js(n);return e}function Vte(e,t,n,i){const{beforeSend:r,beforeSendTransaction:s,beforeSendSpan:o}=t;let a=n;if(u4(a)&&r)return r(a,i);if(KF(a)){if(o){const l=o(Fte(a));if(l?a=mp(n,Bte(l)):WC(),a.spans){const c=[];for(const d of a.spans){const u=o(d);u?c.push(u):(WC(),c.push(d))}a.spans=c}}if(s){if(a.spans){const l=a.spans.length;a.sdkProcessingMetadata={...n.sdkProcessingMetadata,spanCountBeforeProcessing:l}}return s(a,i)}}return a}function u4(e){return e.type===void 0}function KF(e){return e.type==="transaction"}function $te(e,t){t.debug===!0&&(Ot?Ge.enable():yg(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),Tl().update(t.initialScope);const i=new e(t);return Gte(i),i.init(),i}function Gte(e){Tl().setClient(e)}function Xte(e){const t=[];function n(){return e===void 0||t.length<e}function i(o){return t.splice(t.indexOf(o),1)[0]||Promise.resolve(void 0)}function r(o){if(!n())return jb(new Js("Not adding Promise because buffer limit was reached."));const a=o();return t.indexOf(a)===-1&&t.push(a),a.then(()=>i(a)).then(null,()=>i(a).then(null,()=>{})),a}function s(o){return new Bc((a,l)=>{let c=t.length;if(!c)return a(!0);const d=setTimeout(()=>{o&&o>0&&a(!1)},o);t.forEach(u=>{gu(u).then(()=>{--c||(clearTimeout(d),a(!0))},l)})})}return{$:t,add:r,drain:s}}const jte=60*1e3;function Yte(e,t=Date.now()){const n=parseInt(`${e}`,10);if(!isNaN(n))return n*1e3;const i=Date.parse(`${e}`);return isNaN(i)?jte:i-t}function Wte(e,t){return e[t]||e.all||0}function Kte(e,t,n=Date.now()){return Wte(e,t)>n}function Zte(e,{statusCode:t,headers:n},i=Date.now()){const r={...e},s=n==null?void 0:n["x-sentry-rate-limits"],o=n==null?void 0:n["retry-after"];if(s)for(const a of s.trim().split(",")){const[l,c,,,d]=a.split(":",5),u=parseInt(l,10),f=(isNaN(u)?60:u)*1e3;if(!c)r.all=i+f;else for(const h of c.split(";"))h==="metric_bucket"?(!d||d.split(";").includes("custom"))&&(r[h]=i+f):r[h]=i+f}else o?r.all=i+Yte(o,i):t===429&&(r.all=i+60*1e3);return r}const qte=64;function Qte(e,t,n=Xte(e.bufferSize||qte)){let i={};const r=o=>n.drain(o);function s(o){const a=[];if(KC(o,(u,f)=>{const h=ZC(f);Kte(i,h)?e.recordDroppedEvent("ratelimit_backoff",h):a.push(u)}),a.length===0)return gu({});const l=Q5(o[0],a),c=u=>{KC(l,(f,h)=>{e.recordDroppedEvent(u,ZC(h))})},d=()=>t({body:ite(l)}).then(u=>(u.statusCode!==void 0&&(u.statusCode<200||u.statusCode>=300)&&Ot&&Ge.warn(`Sentry responded with status code ${u.statusCode} to sent event.`),i=Zte(i,u),u),u=>{throw c("network_error"),u});return n.add(d).then(u=>u,u=>{if(u instanceof Js)return Ot&&Ge.error("Skipped sending event because buffer is full."),c("queue_overflow"),gu({});throw u})}return{send:s,flush:r}}function Jte(e){var t;((t=e.user)==null?void 0:t.ip_address)===void 0&&(e.user={...e.user,ip_address:"{{auto}}"})}function ene(e){var t;"aggregates"in e?((t=e.attrs)==null?void 0:t.ip_address)===void 0&&(e.attrs={...e.attrs,ip_address:"{{auto}}"}):e.ipAddress===void 0&&(e.ipAddress="{{auto}}")}function tne(e,t,n=[t],i="npm"){const r=e._metadata||{};r.sdk||(r.sdk={name:`sentry.javascript.${t}`,packages:n.map(s=>({name:`${i}:@sentry/${s}`,version:qd})),version:qd}),e._metadata=r}const nne=100;function mu(e,t){const n=Ji(),i=pp();if(!n)return;const{beforeBreadcrumb:r=null,maxBreadcrumbs:s=nne}=n.getOptions();if(s<=0)return;const a={timestamp:gp(),...e},l=r?yg(()=>r(a,t)):a;l!==null&&(n.emit&&n.emit("beforeAddBreadcrumb",l,t),i.addBreadcrumb(l,s))}let oA;const ine="FunctionToString",aA=new WeakMap,rne=()=>({name:ine,setupOnce(){oA=Function.prototype.toString;try{Function.prototype.toString=function(...e){const t=S_(this),n=aA.has(Ji())&&t!==void 0?t:this;return oA.apply(n,e)}}catch{}},setup(e){aA.set(e,!0)}}),sne=rne,one=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/],ane="InboundFilters",lne=(e={})=>({name:ane,processEvent(t,n,i){const r=i.getOptions(),s=dne(e,r);return une(t,s)?null:t}}),cne=lne;function dne(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:one],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[]],ignoreInternal:e.ignoreInternal!==void 0?e.ignoreInternal:!0}}function une(e,t){return t.ignoreInternal&&pne(e)?(Ot&&Ge.warn(`Event dropped due to being internal Sentry Error.
Event: ${Wl(e)}`),!0):fne(e,t.ignoreErrors)?(Ot&&Ge.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Wl(e)}`),!0):bne(e)?(Ot&&Ge.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${Wl(e)}`),!0):hne(e,t.ignoreTransactions)?(Ot&&Ge.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Wl(e)}`),!0):gne(e,t.denyUrls)?(Ot&&Ge.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Wl(e)}.
Url: ${Yb(e)}`),!0):mne(e,t.allowUrls)?!1:(Ot&&Ge.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Wl(e)}.
Url: ${Yb(e)}`),!0)}function fne(e,t){return e.type||!t||!t.length?!1:WF(e).some(n=>q5(n,t))}function hne(e,t){if(e.type!=="transaction"||!t||!t.length)return!1;const n=e.transaction;return n?q5(n,t):!1}function gne(e,t){if(!(t!=null&&t.length))return!1;const n=Yb(e);return n?q5(n,t):!1}function mne(e,t){if(!(t!=null&&t.length))return!0;const n=Yb(e);return n?q5(n,t):!0}function pne(e){try{return e.exception.values[0].type==="SentryError"}catch{}return!1}function Une(e=[]){for(let t=e.length-1;t>=0;t--){const n=e[t];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function Yb(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch{}return t?Une(t):null}catch{return Ot&&Ge.error(`Cannot extract url for event ${Wl(e)}`),null}}function bne(e){var t,n;return e.type||!((n=(t=e.exception)==null?void 0:t.values)!=null&&n.length)?!1:!e.message&&!e.exception.values.some(i=>i.stacktrace||i.type&&i.type!=="Error"||i.value)}function yne(e,t,n=250,i,r,s,o){var l;if(!((l=s.exception)!=null&&l.values)||!o||!uu(o.originalException,Error))return;const a=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;a&&(s.exception.values=Ene(f4(e,t,r,o.originalException,i,s.exception.values,a,0),n))}function f4(e,t,n,i,r,s,o,a){if(s.length>=n+1)return s;let l=[...s];if(uu(i[r],Error)){lA(o,a);const c=e(t,i[r]),d=l.length;cA(c,r,d,a),l=f4(e,t,n,i[r],r,[c,...l],c,d)}return Array.isArray(i.errors)&&i.errors.forEach((c,d)=>{if(uu(c,Error)){lA(o,a);const u=e(t,c),f=l.length;cA(u,`errors[${d}]`,f,a),l=f4(e,t,n,c,r,[u,...l],u,f)}}),l}function lA(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,...e.type==="AggregateError"&&{is_exception_group:!0},exception_id:t}}function cA(e,t,n,i){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:i}}function Ene(e,t){return e.map(n=>(n.value&&(n.value=lh(n.value,t)),n))}function ZF(e){const t="console";zu(t,e),Hu(t,vne)}function vne(){"console"in Ht&&$b.forEach(function(e){e in Ht.console&&Xr(Ht.console,e,function(t){return Gb[e]=t,function(...n){so("console",{args:n,level:e});const r=Gb[e];r==null||r.apply(Ht.console,n)}})})}function qF(e){return e==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(e)?e:"log"}const wne="CaptureConsole",_ne=(e={})=>{const t=e.levels||$b,n=e.handled??!0;return{name:wne,setup(i){"console"in Ht&&ZF(({args:r,level:s})=>{Ji()!==i||!t.includes(s)||Ine(r,s,n)})}}},Tne=_ne;function Ine(e,t,n){const i={level:qF(t),extra:{arguments:e}};C_(r=>{if(r.addEventProcessor(a=>(a.logger="console",hu(a,{handled:n,type:"console"}),a)),t==="assert"){if(!e[0]){const a=`Assertion failed: ${Xb(e.slice(1)," ")||"console.assert"}`;r.setExtra("arguments",e.slice(1)),JC(a,i)}return}const s=e.find(a=>a instanceof Error);if(s){R_(s,i);return}const o=Xb(e," ");JC(o,i)})}const Sne="Dedupe",xne=()=>{let e;return{name:Sne,processEvent(t){if(t.type)return t;try{if(Ane(t,e))return Ot&&Ge.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return e=t}}},Cne=xne;function Ane(e,t){return t?!!(Mne(e,t)||kne(e,t)):!1}function Mne(e,t){const n=e.message,i=t.message;return!(!n&&!i||n&&!i||!n&&i||n!==i||!JF(e,t)||!QF(e,t))}function kne(e,t){const n=dA(t),i=dA(e);return!(!n||!i||n.type!==i.type||n.value!==i.value||!JF(e,t)||!QF(e,t))}function QF(e,t){let n=LC(e),i=LC(t);if(!n&&!i)return!0;if(n&&!i||!n&&i||(n=n,i=i,i.length!==n.length))return!1;for(let r=0;r<i.length;r++){const s=i[r],o=n[r];if(s.filename!==o.filename||s.lineno!==o.lineno||s.colno!==o.colno||s.function!==o.function)return!1}return!0}function JF(e,t){let n=e.fingerprint,i=t.fingerprint;if(!n&&!i)return!0;if(n&&!i||!n&&i)return!1;n=n,i=i;try{return n.join("")===i.join("")}catch{return!1}}function dA(e){var t;return((t=e.exception)==null?void 0:t.values)&&e.exception.values[0]}function I8(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const n=t[6]||"",i=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:i,relative:t[5]+n+i}}function eB(e){if(e!==void 0)return e>=400&&e<500?"warning":e>=500?"error":void 0}const Wb=Ht;function Rne(){return"history"in Wb}function tB(){if(!("fetch"in Wb))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function h4(e){return e&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function Dne(){var n;if(typeof EdgeRuntime=="string")return!0;if(!tB())return!1;if(h4(Wb.fetch))return!0;let e=!1;const t=Wb.document;if(t&&typeof t.createElement=="function")try{const i=t.createElement("iframe");i.hidden=!0,t.head.appendChild(i),(n=i.contentWindow)!=null&&n.fetch&&(e=h4(i.contentWindow.fetch)),t.head.removeChild(i)}catch(i){Bu&&Ge.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",i)}return e}function Lne(e,t){const n="fetch";zu(n,e),Hu(n,()=>Nne(void 0,t))}function Nne(e,t=!1){t&&!Dne()||Xr(Ht,"fetch",function(n){return function(...i){const r=new Error,{method:s,url:o}=One(i),a={args:i,fetchData:{method:s,url:o},startTimestamp:Ka()*1e3,virtualError:r};return so("fetch",{...a}),n.apply(Ht,i).then(async l=>(so("fetch",{...a,endTimestamp:Ka()*1e3,response:l}),l),l=>{throw so("fetch",{...a,endTimestamp:Ka()*1e3,error:l}),v_(l)&&l.stack===void 0&&(l.stack=r.stack,fu(l,"framesToPop",1)),l})}})}function g4(e,t){return!!e&&typeof e=="object"&&!!e[t]}function uA(e){return typeof e=="string"?e:e?g4(e,"url")?e.url:e.toString?e.toString():"":""}function One(e){if(e.length===0)return{method:"GET",url:""};if(e.length===2){const[n,i]=e;return{url:uA(n),method:g4(i,"method")?String(i.method).toUpperCase():"GET"}}const t=e[0];return{url:uA(t),method:g4(t,"method")?String(t.method).toUpperCase():"GET"}}function Pne(){return"npm"}const Rn=Ht;let m4=0;function nB(){return m4>0}function Fne(){m4++,setTimeout(()=>{m4--})}function Ph(e,t={}){function n(r){return typeof r=="function"}if(!n(e))return e;try{const r=e.__sentry_wrapped__;if(r)return typeof r=="function"?r:e;if(S_(e))return e}catch{return e}const i=function(...r){try{const s=r.map(o=>Ph(o,t));return e.apply(this,s)}catch(s){throw Fne(),C_(o=>{o.addEventProcessor(a=>(t.mechanism&&(o4(a,void 0),hu(a,t.mechanism)),a.extra={...a.extra,arguments:r},a)),R_(s)}),s}};try{for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=e[r])}catch{}kF(i,e),fu(e,"__sentry_wrapped__",i);try{Object.getOwnPropertyDescriptor(i,"name").configurable&&Object.defineProperty(i,"name",{get(){return e.name}})}catch{}return i}function D_(e,t){const n=L_(e,t),i={type:$ne(t),value:Gne(t)};return n.length&&(i.stacktrace={frames:n}),i.type===void 0&&i.value===""&&(i.value="Unrecoverable error caught"),i}function Bne(e,t,n,i){const r=Ji(),s=r==null?void 0:r.getOptions().normalizeDepth,o=Kne(t),a={__serialized__:VF(t,s)};if(o)return{exception:{values:[D_(e,o)]},extra:a};const l={exception:{values:[{type:K5(t)?t.constructor.name:i?"UnhandledRejection":"Error",value:Yne(t,{isUnhandledRejection:i})}]},extra:a};if(n){const c=L_(e,n);c.length&&(l.exception.values[0].stacktrace={frames:c})}return l}function S8(e,t){return{exception:{values:[D_(e,t)]}}}function L_(e,t){const n=t.stacktrace||t.stack||"",i=Hne(t),r=Vne(t);try{return e(n,i,r)}catch{}return[]}const zne=/Minified React error #\d+;/i;function Hne(e){return e&&zne.test(e.message)?1:0}function Vne(e){return typeof e.framesToPop=="number"?e.framesToPop:0}function iB(e){return typeof WebAssembly<"u"&&typeof WebAssembly.Exception<"u"?e instanceof WebAssembly.Exception:!1}function $ne(e){const t=e==null?void 0:e.name;return!t&&iB(e)?e.message&&Array.isArray(e.message)&&e.message.length==2?e.message[0]:"WebAssembly.Exception":t}function Gne(e){const t=e==null?void 0:e.message;return iB(e)?Array.isArray(e.message)&&e.message.length==2?e.message[1]:"wasm exception":t?t.error&&typeof t.error.message=="string"?t.error.message:t:"No error message"}function Xne(e,t,n,i){const r=(n==null?void 0:n.syntheticException)||void 0,s=N_(e,t,r,i);return hu(s),s.level="error",n!=null&&n.event_id&&(s.event_id=n.event_id),gu(s)}function jne(e,t,n="info",i,r){const s=(i==null?void 0:i.syntheticException)||void 0,o=p4(e,t,s,r);return o.level=n,i!=null&&i.event_id&&(o.event_id=i.event_id),gu(o)}function N_(e,t,n,i,r){let s;if(CF(t)&&t.error)return S8(e,t.error);if(OC(t)||QJ(t)){const o=t;if("stack"in t)s=S8(e,t);else{const a=o.name||(OC(o)?"DOMError":"DOMException"),l=o.message?`${a}: ${o.message}`:a;s=p4(e,l,n,i),o4(s,l)}return"code"in o&&(s.tags={...s.tags,"DOMException.code":`${o.code}`}),s}return v_(t)?S8(e,t):Lh(t)||K5(t)?(s=Bne(e,t,n,r),hu(s,{synthetic:!0}),s):(s=p4(e,t,n,i),o4(s,`${t}`),hu(s,{synthetic:!0}),s)}function p4(e,t,n,i){const r={};if(i&&n){const s=L_(e,n);s.length&&(r.exception={values:[{value:t,stacktrace:{frames:s}}]}),hu(r,{synthetic:!0})}if(w_(t)){const{__sentry_template_string__:s,__sentry_template_values__:o}=t;return r.logentry={message:s,params:o},r}return r.message=t,r}function Yne(e,{isUnhandledRejection:t}){const n=oee(e),i=t?"promise rejection":"exception";return CF(e)?`Event \`ErrorEvent\` captured as ${i} with message \`${e.message}\``:K5(e)?`Event \`${Wne(e)}\` (type=${e.type}) captured as ${i}`:`Object captured as ${i} with keys: ${n}`}function Wne(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{}}function Kne(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];if(n instanceof Error)return n}}class Zne extends zte{constructor(t){const n={parentSpanIsAlwaysRootSpan:!0,...t},i=Rn.SENTRY_SDK_SOURCE||Pne();tne(n,"browser",["browser"],i),super(n),n.sendClientReports&&Rn.document&&Rn.document.addEventListener("visibilitychange",()=>{Rn.document.visibilityState==="hidden"&&this._flushOutcomes()}),this._options.sendDefaultPii&&(this.on("postprocessEvent",Jte),this.on("beforeSendSession",ene))}eventFromException(t,n){return Xne(this._options.stackParser,t,n,this._options.attachStacktrace)}eventFromMessage(t,n="info",i){return jne(this._options.stackParser,t,n,i,this._options.attachStacktrace)}_prepareEvent(t,n,i,r){return t.platform=t.platform||"javascript",super._prepareEvent(t,n,i,r)}}const qne=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Tr=Ht,Qne=1e3;let fA,U4,b4;function Jne(e){const t="dom";zu(t,e),Hu(t,eie)}function eie(){if(!Tr.document)return;const e=so.bind(null,"dom"),t=hA(e,!0);Tr.document.addEventListener("click",t,!1),Tr.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach(n=>{var s,o;const r=(s=Tr[n])==null?void 0:s.prototype;(o=r==null?void 0:r.hasOwnProperty)!=null&&o.call(r,"addEventListener")&&(Xr(r,"addEventListener",function(a){return function(l,c,d){if(l==="click"||l=="keypress")try{const u=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},f=u[l]=u[l]||{refCount:0};if(!f.handler){const h=hA(e);f.handler=h,a.call(this,l,h,d)}f.refCount++}catch{}return a.call(this,l,c,d)}}),Xr(r,"removeEventListener",function(a){return function(l,c,d){if(l==="click"||l=="keypress")try{const u=this.__sentry_instrumentation_handlers__||{},f=u[l];f&&(f.refCount--,f.refCount<=0&&(a.call(this,l,f.handler,d),f.handler=void 0,delete u[l]),Object.keys(u).length===0&&delete this.__sentry_instrumentation_handlers__)}catch{}return a.call(this,l,c,d)}}))})}function tie(e){if(e.type!==U4)return!1;try{if(!e.target||e.target._sentryId!==b4)return!1}catch{}return!0}function nie(e,t){return e!=="keypress"?!1:t!=null&&t.tagName?!(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable):!0}function hA(e,t=!1){return n=>{if(!n||n._sentryCaptured)return;const i=iie(n);if(nie(n.type,i))return;fu(n,"_sentryCaptured",!0),i&&!i._sentryId&&fu(i,"_sentryId",xs());const r=n.type==="keypress"?"input":n.type;tie(n)||(e({event:n,name:r,global:t}),U4=n.type,b4=i?i._sentryId:void 0),clearTimeout(fA),fA=Tr.setTimeout(()=>{b4=void 0,U4=void 0},Qne)}}function iie(e){try{return e.target}catch{return null}}let LU;function rB(e){const t="history";zu(t,e),Hu(t,rie)}function rie(){if(Tr.addEventListener("popstate",()=>{const t=Tr.location.href,n=LU;if(LU=t,n===t)return;so("history",{from:n,to:t})}),!Rne())return;function e(t){return function(...n){const i=n.length>2?n[2]:void 0;if(i){const r=LU,s=String(i);if(LU=s,r===s)return;so("history",{from:r,to:s})}return t.apply(this,n)}}Xr(Tr.history,"pushState",e),Xr(Tr.history,"replaceState",e)}const D2={};function sie(e){const t=D2[e];if(t)return t;let n=Tr[e];if(h4(n))return D2[e]=n.bind(Tr);const i=Tr.document;if(i&&typeof i.createElement=="function")try{const r=i.createElement("iframe");r.hidden=!0,i.head.appendChild(r);const s=r.contentWindow;s!=null&&s[e]&&(n=s[e]),i.head.removeChild(r)}catch(r){qne&&Ge.warn(`Could not create sandbox iframe for ${e} check, bailing to window.${e}: `,r)}return n&&(D2[e]=n.bind(Tr))}function gA(e){D2[e]=void 0}const O1="__sentry_xhr_v3__";function oie(e){const t="xhr";zu(t,e),Hu(t,aie)}function aie(){if(!Tr.XMLHttpRequest)return;const e=XMLHttpRequest.prototype;e.open=new Proxy(e.open,{apply(t,n,i){const r=new Error,s=Ka()*1e3,o=Wa(i[0])?i[0].toUpperCase():void 0,a=lie(i[1]);if(!o||!a)return t.apply(n,i);n[O1]={method:o,url:a,request_headers:{}},o==="POST"&&a.match(/sentry_key/)&&(n.__sentry_own_request__=!0);const l=()=>{const c=n[O1];if(c&&n.readyState===4){try{c.status_code=n.status}catch{}const d={endTimestamp:Ka()*1e3,startTimestamp:s,xhr:n,virtualError:r};so("xhr",d)}};return"onreadystatechange"in n&&typeof n.onreadystatechange=="function"?n.onreadystatechange=new Proxy(n.onreadystatechange,{apply(c,d,u){return l(),c.apply(d,u)}}):n.addEventListener("readystatechange",l),n.setRequestHeader=new Proxy(n.setRequestHeader,{apply(c,d,u){const[f,h]=u,m=d[O1];return m&&Wa(f)&&Wa(h)&&(m.request_headers[f.toLowerCase()]=h),c.apply(d,u)}}),t.apply(n,i)}}),e.send=new Proxy(e.send,{apply(t,n,i){const r=n[O1];if(!r)return t.apply(n,i);i[0]!==void 0&&(r.body=i[0]);const s={startTimestamp:Ka()*1e3,xhr:n};return so("xhr",s),t.apply(n,i)}})}function lie(e){if(Wa(e))return e;try{return e.toString()}catch{}}function cie(e,t=sie("fetch")){let n=0,i=0;function r(s){const o=s.body.length;n+=o,i++;const a={body:s.body,method:"POST",referrerPolicy:"strict-origin",headers:e.headers,keepalive:n<=6e4&&i<15,...e.fetchOptions};if(!t)return gA("fetch"),jb("No fetch implementation available");try{return t(e.url,a).then(l=>(n-=o,i--,{statusCode:l.status,headers:{"x-sentry-rate-limits":l.headers.get("X-Sentry-Rate-Limits"),"retry-after":l.headers.get("Retry-After")}}))}catch(l){return gA("fetch"),n-=o,i--,jb(l)}}return Qte(e,r)}const die=30,uie=50;function y4(e,t,n,i){const r={filename:e,function:t==="<anonymous>"?du:t,in_app:!0};return n!==void 0&&(r.lineno=n),i!==void 0&&(r.colno=i),r}const fie=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,hie=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,gie=/\((\S*)(?::(\d+))(?::(\d+))\)/,mie=e=>{const t=fie.exec(e);if(t){const[,i,r,s]=t;return y4(i,du,+r,+s)}const n=hie.exec(e);if(n){if(n[2]&&n[2].indexOf("eval")===0){const o=gie.exec(n[2]);o&&(n[2]=o[1],n[3]=o[2],n[4]=o[3])}const[r,s]=sB(n[1]||du,n[2]);return y4(s,r,n[3]?+n[3]:void 0,n[4]?+n[4]:void 0)}},pie=[die,mie],Uie=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,bie=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,yie=e=>{const t=Uie.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const s=bie.exec(t[3]);s&&(t[1]=t[1]||"eval",t[3]=s[1],t[4]=s[2],t[5]="")}let i=t[3],r=t[1]||du;return[r,i]=sB(r,i),y4(i,r,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}},Eie=[uie,yie],vie=[pie,Eie],wie=SF(...vie),sB=(e,t)=>{const n=e.indexOf("safari-extension")!==-1,i=e.indexOf("safari-web-extension")!==-1;return n||i?[e.indexOf("@")!==-1?e.split("@")[0]:du,n?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]},lm=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,NU=1024,_ie="Breadcrumbs",Tie=(e={})=>{const t={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e};return{name:_ie,setup(n){t.console&&ZF(Cie(n)),t.dom&&Jne(xie(n,t.dom)),t.xhr&&oie(Aie(n)),t.fetch&&Lne(Mie(n)),t.history&&rB(kie(n)),t.sentry&&n.on("beforeSendEvent",Sie(n))}}},Iie=Tie;function Sie(e){return function(n){Ji()===e&&mu({category:`sentry.${n.type==="transaction"?"transaction":"event"}`,event_id:n.event_id,level:n.level,message:Wl(n)},{event:n})}}function xie(e,t){return function(i){if(Ji()!==e)return;let r,s,o=typeof t=="object"?t.serializeAttribute:void 0,a=typeof t=="object"&&typeof t.maxStringLength=="number"?t.maxStringLength:void 0;a&&a>NU&&(lm&&Ge.warn(`\`dom.maxStringLength\` cannot exceed ${NU}, but a value of ${a} was configured. Sentry will use ${NU} instead.`),a=NU),typeof o=="string"&&(o=[o]);try{const c=i.event,d=Rie(c)?c.target:c;r=MF(d,{keyAttrs:o,maxStringLength:a}),s=ree(d)}catch{r="<unknown>"}if(r.length===0)return;const l={category:`ui.${i.name}`,message:r};s&&(l.data={"ui.component_name":s}),mu(l,{event:i.event,name:i.name,global:i.global})}}function Cie(e){return function(n){if(Ji()!==e)return;const i={category:"console",data:{arguments:n.args,logger:"console"},level:qF(n.level),message:Xb(n.args," ")};if(n.level==="assert")if(n.args[0]===!1)i.message=`Assertion failed: ${Xb(n.args.slice(1)," ")||"console.assert"}`,i.data.arguments=n.args.slice(1);else return;mu(i,{input:n.args,level:n.level})}}function Aie(e){return function(n){if(Ji()!==e)return;const{startTimestamp:i,endTimestamp:r}=n,s=n.xhr[O1];if(!i||!r||!s)return;const{method:o,url:a,status_code:l,body:c}=s,d={method:o,url:a,status_code:l},u={xhr:n.xhr,input:c,startTimestamp:i,endTimestamp:r},f=eB(l);mu({category:"xhr",data:d,type:"http",level:f},u)}}function Mie(e){return function(n){if(Ji()!==e)return;const{startTimestamp:i,endTimestamp:r}=n;if(!r||n.fetchData.url.match(/sentry_key/)&&n.fetchData.method==="POST")return;const s={method:n.fetchData.method,url:n.fetchData.url};if(n.error){const o={data:n.error,input:n.args,startTimestamp:i,endTimestamp:r};mu({category:"fetch",data:s,level:"error",type:"http"},o)}else{const o=n.response;s.request_body_size=n.fetchData.request_body_size,s.response_body_size=n.fetchData.response_body_size,s.status_code=o==null?void 0:o.status;const a={input:n.args,response:o,startTimestamp:i,endTimestamp:r},l=eB(s.status_code);mu({category:"fetch",data:s,type:"http",level:l},a)}}}function kie(e){return function(n){if(Ji()!==e)return;let i=n.from,r=n.to;const s=I8(Rn.location.href);let o=i?I8(i):void 0;const a=I8(r);o!=null&&o.path||(o=s),s.protocol===a.protocol&&s.host===a.host&&(r=a.relative),s.protocol===o.protocol&&s.host===o.host&&(i=o.relative),mu({category:"navigation",data:{from:i,to:r}})}}function Rie(e){return!!e&&!!e.target}const Die=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],Lie="BrowserApiErrors",Nie=(e={})=>{const t={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...e};return{name:Lie,setupOnce(){t.setTimeout&&Xr(Rn,"setTimeout",mA),t.setInterval&&Xr(Rn,"setInterval",mA),t.requestAnimationFrame&&Xr(Rn,"requestAnimationFrame",Pie),t.XMLHttpRequest&&"XMLHttpRequest"in Rn&&Xr(XMLHttpRequest.prototype,"send",Fie);const n=t.eventTarget;n&&(Array.isArray(n)?n:Die).forEach(Bie)}}},Oie=Nie;function mA(e){return function(...t){const n=t[0];return t[0]=Ph(n,{mechanism:{data:{function:Fc(e)},handled:!1,type:"instrument"}}),e.apply(this,t)}}function Pie(e){return function(t){return e.apply(this,[Ph(t,{mechanism:{data:{function:"requestAnimationFrame",handler:Fc(e)},handled:!1,type:"instrument"}})])}}function Fie(e){return function(...t){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(r=>{r in n&&typeof n[r]=="function"&&Xr(n,r,function(s){const o={mechanism:{data:{function:r,handler:Fc(s)},handled:!1,type:"instrument"}},a=S_(s);return a&&(o.mechanism.data.handler=Fc(a)),Ph(s,o)})}),e.apply(this,t)}}function Bie(e){var i,r;const n=(i=Rn[e])==null?void 0:i.prototype;(r=n==null?void 0:n.hasOwnProperty)!=null&&r.call(n,"addEventListener")&&(Xr(n,"addEventListener",function(s){return function(o,a,l){try{zie(a)&&(a.handleEvent=Ph(a.handleEvent,{mechanism:{data:{function:"handleEvent",handler:Fc(a),target:e},handled:!1,type:"instrument"}}))}catch{}return s.apply(this,[o,Ph(a,{mechanism:{data:{function:"addEventListener",handler:Fc(a),target:e},handled:!1,type:"instrument"}}),l])}}),Xr(n,"removeEventListener",function(s){return function(o,a,l){try{const c=a.__sentry_wrapped__;c&&s.call(this,o,c,l)}catch{}return s.call(this,o,a,l)}}))}function zie(e){return typeof e.handleEvent=="function"}const Hie=()=>({name:"BrowserSession",setupOnce(){if(typeof Rn.document>"u"){lm&&Ge.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.");return}eA({ignoreDuration:!0}),tA(),rB(({from:e,to:t})=>{e!==void 0&&e!==t&&(eA({ignoreDuration:!0}),tA())})}}),Vie="GlobalHandlers",$ie=(e={})=>{const t={onerror:!0,onunhandledrejection:!0,...e};return{name:Vie,setupOnce(){Error.stackTraceLimit=50},setup(n){t.onerror&&(Xie(n),pA("onerror")),t.onunhandledrejection&&(jie(n),pA("onunhandledrejection"))}}},Gie=$ie;function Xie(e){WJ(t=>{const{stackParser:n,attachStacktrace:i}=oB();if(Ji()!==e||nB())return;const{msg:r,url:s,line:o,column:a,error:l}=t,c=Kie(N_(n,l||r,void 0,i,!1),s,o,a);c.level="error",GF(c,{originalException:l,mechanism:{handled:!1,type:"onerror"}})})}function jie(e){ZJ(t=>{const{stackParser:n,attachStacktrace:i}=oB();if(Ji()!==e||nB())return;const r=Yie(t),s=__(r)?Wie(r):N_(n,r,void 0,i,!0);s.level="error",GF(s,{originalException:r,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function Yie(e){if(__(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return e}function Wie(e){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(e)}`}]}}}function Kie(e,t,n,i){const r=e.exception=e.exception||{},s=r.values=r.values||[],o=s[0]=s[0]||{},a=o.stacktrace=o.stacktrace||{},l=a.frames=a.frames||[],c=i,d=n,u=Wa(t)&&t.length>0?t:I_();return l.length===0&&l.push({colno:c,filename:u,function:du,in_app:!0,lineno:d}),e}function pA(e){lm&&Ge.log(`Global Handler attached: ${e}`)}function oB(){const e=Ji();return(e==null?void 0:e.getOptions())||{stackParser:()=>[],attachStacktrace:!1}}const Zie=()=>({name:"HttpContext",preprocessEvent(e){var o,a;if(!Rn.navigator&&!Rn.location&&!Rn.document)return;const t=((o=e.request)==null?void 0:o.url)||I_(),{referrer:n}=Rn.document||{},{userAgent:i}=Rn.navigator||{},r={...(a=e.request)==null?void 0:a.headers,...n&&{Referer:n},...i&&{"User-Agent":i}},s={...e.request,...t&&{url:t},headers:r};e.request=s}}),qie="cause",Qie=5,Jie="LinkedErrors",ere=(e={})=>{const t=e.limit||Qie,n=e.key||qie;return{name:Jie,preprocessEvent(i,r,s){const o=s.getOptions();yne(D_,o.stackParser,o.maxValueLength,n,t,i,r)}}},tre=ere;function nre(e){return[cne(),sne(),Oie(),Iie(),Gie(),tre(),Cne(),Zie(),Hie()]}function ire(e={}){var n;return{...{defaultIntegrations:nre(),release:typeof __SENTRY_RELEASE__=="string"?__SENTRY_RELEASE__:(n=Rn.SENTRY_RELEASE)==null?void 0:n.id,sendClientReports:!0},...rre(e)}}function rre(e){const t={};for(const n of Object.getOwnPropertyNames(e)){const i=n;e[i]!==void 0&&(t[i]=e[i])}return t}function sre(){var l;const e=typeof Rn.window<"u"&&Rn;if(!e)return!1;const t=e.chrome?"chrome":"browser",n=e[t],i=(l=n==null?void 0:n.runtime)==null?void 0:l.id,r=I_()||"",s=["chrome-extension:","moz-extension:","ms-browser-extension:","safari-web-extension:"],o=!!i&&Rn===Rn.top&&s.some(c=>r.startsWith(`${c}//`)),a=typeof e.nw<"u";return!!i&&!o&&!a}function ore(e={}){const t=ire(e);if(!t.skipBrowserExtensionCheck&&sre()){lm&&yg(()=>{console.error("[Sentry] You cannot run Sentry this way in a browser extension, check: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/")});return}lm&&!tB()&&Ge.warn("No Fetch API detected. The Sentry SDK requires a Fetch API compatible environment to send events. Please add a Fetch API polyfill.");const n={...t,stackParser:jJ(t.stackParser||wie),integrations:Nte(t),transport:t.transport||cie};return $te(Zne,n)}function are(){const e=Error.prepareStackTrace;try{let t=[];return Error.prepareStackTrace=(n,i)=>{const r=i.slice(1);return t=r,r},new Error().stack,t}finally{Error.prepareStackTrace=e}}var lre={};const aB={"excalidraw.com":"production","staging.excalidraw.com":"staging","vercel.app":"staging"},cre=lre.VITE_APP_DISABLE_SENTRY==="true",x8=!cre&&Object.keys(aB).find(e=>window.location.hostname.indexOf(e)>=0);ore({dsn:x8?"https://7bfc596a5bf945eda6b660d3015a5460@sentry.io/5179260":void 0,environment:x8?aB[x8]:void 0,release:"",ignoreErrors:["undefined is not an object (evaluating 'window.__pad.performLoop')","InvalidStateError: Failed to execute 'transaction' on 'IDBDatabase': The database connection is closing.",/(Failed to fetch|(fetch|loading) dynamically imported module)/i,/QuotaExceededError: (The quota has been exceeded|.*setItem.*Storage)/i,"Internal error opening backing store for indexedDB.open"],integrations:[Tne({levels:["error"]})],beforeSend(e){var t;return(t=e.request)!=null&&t.url&&(e.request.url=e.request.url.replace(/#.*$/,"")),e.exception||(e.exception={values:[{type:"ConsoleError",value:e.message??"Unknown error",stacktrace:{frames:are().slice(1).filter(n=>{var i;return n.getFileName()&&!((i=n.getFileName())!=null&&i.includes("@sentry_browser.js"))}).map(n=>{var i;return{filename:n.getFileName()??void 0,function:n.getFunctionName()??void 0,in_app:!(((i=n.getFileName())==null?void 0:i.includes("node_modules"))??!1),lineno:n.getLineNumber()??void 0,colno:n.getColumnNumber()??void 0}})},mechanism:{type:"instrument",handled:!0,data:{function:"console.error",handler:"Sentry.beforeSend"}}}]}),e}});class dre{constructor(t){F(this,"content",[]);this.scoreFunction=t}sinkDown(t){const n=this.content[t],i=this.scoreFunction(n);for(;t>0;){const r=(t+1>>1)-1,s=this.content[r];if(i<this.scoreFunction(s))this.content[t]=s,t=r;else break}this.content[t]=n}bubbleUp(t){const n=this.content.length,i=this.content[t],r=this.scoreFunction(i);for(;;){const s=(t+1<<1)-1,o=s+1;let a=t,l=r;if(s<n){const c=this.scoreFunction(this.content[s]);c<l&&(a=s,l=c)}if(o<n&&this.scoreFunction(this.content[o])<l&&(a=o),a===t)break;this.content[t]=this.content[a],t=a}this.content[t]=i}push(t){this.content.push(t),this.sinkDown(this.content.length-1)}pop(){if(this.content.length===0)return null;const t=this.content[0],n=this.content.pop();return this.content.length>0&&(this.content[0]=n,this.bubbleUp(0)),t}remove(t){if(this.content.length===0)return;const n=this.content.indexOf(t),i=this.content.pop();n<this.content.length&&(this.content[n]=i,this.scoreFunction(i)<this.scoreFunction(t)?this.sinkDown(n):this.bubbleUp(n))}size(){return this.content.length}rescoreElement(t){this.sinkDown(this.content.indexOf(t))}}const ure="#ffffff",fre="#000000",hre=["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],gre=["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],mre=["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],pre=["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],Ure=["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],bre=["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],yre=["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],Ere=["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],vre=["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],wre=["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],_re=["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],Tre=["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],Ire=["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"],yi={white:ure,black:fre,gray:hre,red:gre,pink:mre,grape:pre,violet:Ure,indigo:bre,blue:yre,cyan:Ere,teal:vre,green:wre,lime:_re,yellow:Tre,orange:Ire},E4=240,Sre=(e,t)=>t.reduce((n,i)=>(i in e&&(n[i]=e[i]),n),{}),xre=5,wf=5,Cre=4,P1=4,F1=1,zs=[0,2,4,6,8],Hs=(e,t)=>t.map(n=>yi[e][n]),Ye={transparent:"transparent",black:"#1e1e1e",white:"#ffffff",gray:Hs("gray",zs),red:Hs("red",zs),pink:Hs("pink",zs),grape:Hs("grape",zs),violet:Hs("violet",zs),blue:Hs("blue",zs),cyan:Hs("cyan",zs),teal:Hs("teal",zs),green:Hs("green",zs),yellow:Hs("yellow",zs),orange:Hs("orange",zs),bronze:["#f8f1ee","#eaddd7","#d2bab0","#a18072","#846358"]},lB=Sre(Ye,["cyan","blue","violet","grape","pink","green","teal","yellow","orange","red"]),cB=[Ye.black,Ye.red[P1],Ye.green[P1],Ye.blue[P1],Ye.yellow[P1]],dB=[Ye.transparent,Ye.red[F1],Ye.green[F1],Ye.blue[F1],Ye.yellow[F1]],uB=[Ye.white,"#f8f9fa","#f5faff","#fffce8","#fdf8f6"],Are={transparent:Ye.transparent,white:Ye.white,gray:Ye.gray,black:Ye.black,bronze:Ye.bronze,...lB},Mre={transparent:Ye.transparent,white:Ye.white,gray:Ye.gray,black:Ye.black,bronze:Ye.bronze,...lB},kre=e=>[Ye.cyan[e],Ye.blue[e],Ye.violet[e],Ye.grape[e],Ye.pink[e],Ye.green[e],Ye.teal[e],Ye.yellow[e],Ye.orange[e],Ye.red[e]],Rre=(e,t,n)=>`#${((1<<24)+(e<<16)+(t<<8)+n).toString(16).slice(1)}`,fB=typeof window<"u"&&"ResizeObserver"in window,wc="Excalidraw",Dre=36,hB=10,UA=20,L2=8,Lre=5,bA=1,Nre=30,Hr=Math.PI/12,Ore="red",Ct={TEXT:"text",CROSSHAIR:"crosshair",GRABBING:"grabbing",GRAB:"grab",POINTER:"pointer",MOVE:"move",AUTO:""},Vl={MAIN:0,WHEEL:1,SECONDARY:2,TOUCH:-1,ERASER:5},Td={enabled:"all",disabled:"none",inheritFromUI:"var(--ui-pointerEvents)"};var te=(e=>(e.COPY="copy",e.PASTE="paste",e.CUT="cut",e.KEYDOWN="keydown",e.KEYUP="keyup",e.MOUSE_MOVE="mousemove",e.RESIZE="resize",e.UNLOAD="unload",e.FOCUS="focus",e.BLUR="blur",e.DRAG_OVER="dragover",e.DROP="drop",e.GESTURE_END="gestureend",e.BEFORE_UNLOAD="beforeunload",e.GESTURE_START="gesturestart",e.GESTURE_CHANGE="gesturechange",e.POINTER_MOVE="pointermove",e.POINTER_DOWN="pointerdown",e.POINTER_UP="pointerup",e.STATE_CHANGE="statechange",e.WHEEL="wheel",e.TOUCH_START="touchstart",e.TOUCH_END="touchend",e.HASHCHANGE="hashchange",e.VISIBILITY_CHANGE="visibilitychange",e.SCROLL="scroll",e.EXCALIDRAW_LINK="excalidraw-link",e.MENU_ITEM_SELECT="menu.itemSelect",e.MESSAGE="message",e.FULLSCREENCHANGE="fullscreenchange",e))(te||{});const OU={UNSTARTED:-1,ENDED:0,PLAYING:1,PAUSED:2,BUFFERING:3,CUED:5},gB={TEST:"test",DEVELOPMENT:"development"},Jr={SIDEBAR:"sidebar",SHAPE_ACTIONS_MENU:"App-menu__left",ZOOM_ACTIONS:"zoom-actions",SEARCH_MENU_INPUT_WRAPPER:"layer-ui__search-inputWrapper",CONVERT_ELEMENT_TYPE_POPUP:"ConvertElementTypePopup",SHAPE_ACTIONS_THEME_SCOPE:"shape-actions-theme-scope"},Vf="Xiaolai",cm="Segoe UI Emoji",nt={Virgil:1,Helvetica:2,Cascadia:3,Excalifont:5,Nunito:6,"Lilita One":7,"Comic Shanns":8,"Liberation Sans":9,Assistant:10},mB="sans-serif",pB="monospace",Pre={[mB]:998,[pB]:999},$f={[Vf]:100,...Pre,[cm]:1e3};function Fre(e){switch(e){case nt.Cascadia:case nt["Comic Shanns"]:return pB;default:return mB}}const UB=e=>{const t=Fre(e);switch(e){case nt.Excalifont:return[Vf,t,cm];default:return[t,cm]}},ke={LIGHT:"light",DARK:"dark"},zt={strokeColor:"#bbb",strokeWidth:2,strokeStyle:"solid",fillStyle:"solid",roughness:0,roundness:null,backgroundColor:"transparent",radius:8,nameOffsetY:3,nameColorLightTheme:"#999999",nameColorDarkTheme:"#7a7a7a",nameFontSize:14,nameLineHeight:1.25},O_=1,Il=20,sd=nt.Excalifont,Up="left",Kb="top",bB="{version}",pu=2,Zb=2*pu,Bre=1e-5,yA=2*Zb-Bre,PU="#ffffff",zre="#1e1e1e",Hre="#a2f1a6",qb=20,yB=5,Fh={svg:"image/svg+xml",png:"image/png",jpg:"image/jpeg",gif:"image/gif",webp:"image/webp",bmp:"image/bmp",ico:"image/x-icon",avif:"image/avif",jfif:"image/jfif"},Vre={text:"text/plain",html:"text/html",json:"application/json",excalidraw:"application/vnd.excalidraw+json",excalidrawlib:"application/vnd.excalidrawlib+json",excalidrawlibIds:"application/vnd.excalidrawlib.ids+json"},Te={...Vre,"excalidraw.svg":"image/svg+xml","excalidraw.png":"image/png",binary:"application/octet-stream",...Fh},$re=[Te.text,Te.html,...Object.values(Fh)],C8={png:"png",svg:"svg",clipboard:"clipboard"},Cs={excalidraw:"excalidraw",excalidrawClipboard:"excalidraw/clipboard",excalidrawLibrary:"excalidrawlib",excalidrawClipboardWithAPI:"excalidraw-api/clipboard"},P_=()=>window.EXCALIDRAW_EXPORT_SOURCE||window.location.origin,Gre=500,Xre=300,jre=500,Yre=3e4,Wre=100,J5=.1,F_=.1,B_=30,Kre=300,EA=6e4,vA=3e3,z_="invert(93%) hue-rotate(180deg)",v4={addLibrary:"addLibrary"},w4={addLibrary:"addLibrary"},wA={canvasActions:{changeViewBackgroundColor:!0,clearCanvas:!0,export:{saveFileToDisk:!0},loadScene:!0,saveToActiveFile:!0,toggleTheme:null,saveAsImage:!0}},l1=2,H_=[1,2,3],vg=10,Zre=1440,_A=4*1024*1024,st="http://www.w3.org/2000/svg",qre=`<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`,EB=128,ey={excalidraw:2,excalidrawLibrary:2},$n=5,Qre=.7,Jre=11,Yr={TOP:"top",MIDDLE:"middle",BOTTOM:"bottom"},dm={LEFT:"left",CENTER:"center",RIGHT:"right"},ese=20,A8=.25,tse=32,yn={LEGACY:1,PROPORTIONAL_RADIUS:2,ADAPTIVE_RADIUS:3},vB={artist:1,cartoonist:2},M8={thin:1,bold:2,extraBold:4},mn={strokeColor:Ye.black,backgroundColor:Ye.transparent,fillStyle:"solid",strokeWidth:2,strokeStyle:"solid",roughness:vB.artist,opacity:100,locked:!1},Qb="library",Qd="search",As={name:"default",defaultTab:Qb},wB=new Set(["iframe","embeddable","image"]),Qn={selection:"selection",rectangle:"rectangle",diamond:"diamond",ellipse:"ellipse",text:"text",image:"image",eraser:"eraser",frame:"frame",magicframe:"magicframe",laser:"laser"},b0={MERMAID_TO_EXCALIDRAW:"mermaid-to-excalidraw",PUBLISH_LIBRARY:"publish-library-data"},_B="Untitled",Gf={generalStats:1,elementProperties:2},gs=1,fi={sharp:"sharp",round:"round",elbow:"elbow"},TB=.3,Jb="element";var Od=(e=>(e.ACTIVE="active",e.AWAY="away",e.IDLE="idle",e))(Od||{});const nse=20,ise=35,bp={background:"var(--mobile-action-button-bg)"},Bh={[nt.Excalifont]:{metrics:{unitsPerEm:1e3,ascender:886,descender:-374,lineHeight:1.25}},[nt.Nunito]:{metrics:{unitsPerEm:1e3,ascender:1011,descender:-353,lineHeight:1.25}},[nt["Lilita One"]]:{metrics:{unitsPerEm:1e3,ascender:923,descender:-220,lineHeight:1.15}},[nt["Comic Shanns"]]:{metrics:{unitsPerEm:1e3,ascender:750,descender:-250,lineHeight:1.25}},[nt.Virgil]:{metrics:{unitsPerEm:1e3,ascender:886,descender:-374,lineHeight:1.25},deprecated:!0},[nt.Helvetica]:{metrics:{unitsPerEm:2048,ascender:1577,descender:-471,lineHeight:1.15},deprecated:!0,local:!0},[nt.Cascadia]:{metrics:{unitsPerEm:2048,ascender:1900,descender:-480,lineHeight:1.2},deprecated:!0},[nt["Liberation Sans"]]:{metrics:{unitsPerEm:2048,ascender:1854,descender:-434,lineHeight:1.15},private:!0},[nt.Assistant]:{metrics:{unitsPerEm:2048,ascender:1021,descender:-287,lineHeight:1.25},private:!0},[$f.Xiaolai]:{metrics:{unitsPerEm:1e3,ascender:880,descender:-144,lineHeight:1.25},fallback:!0},[$f["Segoe UI Emoji"]]:{metrics:{unitsPerEm:1e3,ascender:886,descender:-374,lineHeight:1.25},local:!0,fallback:!0}},Ad={LATIN:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD",LATIN_EXT:"U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF",CYRILIC_EXT:"U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F",CYRILIC:"U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116",VIETNAMESE:"U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+0300-0301, U+0303-0304, U+0308-0309, U+0323, U+0329, U+1EA0-1EF9, U+20AB"},V_="local:",IB=(e,t,n)=>{var c;const{unitsPerEm:i,ascender:r,descender:s}=((c=Bh[e])==null?void 0:c.metrics)||Bh[nt.Excalifont].metrics,o=t/i,a=(n-o*r+o*s)/2;return o*r+a},zc=e=>{var n;const{lineHeight:t}=((n=Bh[e])==null?void 0:n.metrics)||Bh[nt.Excalifont].metrics;return t};class rse{constructor(){F(this,"jobs",[]);F(this,"running",!1)}tick(){if(this.running)return;const t=this.jobs.shift();t?(this.running=!0,t.promise.resolve(Hc(t.jobFactory,...t.args).finally(()=>{this.running=!1,this.tick()}))):this.running=!1}push(t,...n){const i=iy();return this.jobs.push({jobFactory:t,promise:i,args:n}),this.tick(),i}}const SB="excalidraw.desktopUIMode",xB=599,sse=1e3,ose=500,ase=xB+1,lse=1400,cse=1440,dse=1229,co=/Mac|iPod|iPhone|iPad/.test(navigator.platform),CB=/^Win/.test(navigator.platform),AB=/\b(android)\b/i.test(navigator.userAgent),um=typeof window<"u"&&"netscape"in window&&navigator.userAgent.indexOf("rv:")>1&&navigator.userAgent.indexOf("Gecko")>1,use=navigator.userAgent.indexOf("Chrome")!==-1,fse=!use&&navigator.userAgent.indexOf("Safari")!==-1,$_=/iPad|iPhone/i.test(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document,hse=()=>{var e,t;return((t=(e=navigator.brave)==null?void 0:e.isBrave)==null?void 0:t.name)==="isBrave"},gse=(e,t)=>e<=xB||t<ose&&e<sse,mse=(e,t)=>{const n=Math.min(e,t),i=Math.max(e,t);return n>=ase&&i<=lse},pse=()=>{const e=navigator.userAgent||"",t=navigator.platform||"",n=navigator.userAgentData;if(n){const r=(n.platform||"").toLowerCase(),s=r==="windows"||r==="macos"||r==="linux"||r==="chrome os";if(n.mobile===!0)return!0;if(n.mobile===!1&&r==="android")return(matchMedia==null?void 0:matchMedia("(hover: none)").matches)&&(matchMedia==null?void 0:matchMedia("(pointer: coarse)").matches);if(s)return!1}if($_)return!0;if(AB){const r=/Mobile/i.test(e);if(r||!r)return(matchMedia==null?void 0:matchMedia("(hover: none)").matches)&&(matchMedia==null?void 0:matchMedia("(pointer: coarse)").matches)}return/Win|Linux|CrOS|Mac/.test(t)||/Windows NT|X11|CrOS|Macintosh/.test(e),!1},Use=(e,t)=>gse(e,t)?"phone":mse(e,t)?"tablet":"desktop",y0=e=>e.formFactor==="phone"?"mobile":e.formFactor==="tablet"?"compact":e.desktopUIMode,MB=e=>{const t=e??"";let n="unknown";return $_?n="ios":AB?n="android":t&&(n="other"),{isMobileDevice:pse(),platform:n}},bse=()=>{if(typeof window>"u")return null;try{const e=window.localStorage.getItem(SB);if(e==="compact"||e==="full")return e}catch{}return null},yse=e=>{if(!(typeof window>"u"))try{window.localStorage.setItem(SB,e)}catch{}},Ese=e=>{if(!(e!=="compact"&&e!=="full"))return yse(e),e},it={EQUAL:"Equal",MINUS:"Minus",NUM_ADD:"NumpadAdd",NUM_SUBTRACT:"NumpadSubtract",NUM_ZERO:"Numpad0",BRACKET_RIGHT:"BracketRight",BRACKET_LEFT:"BracketLeft",ONE:"Digit1",TWO:"Digit2",THREE:"Digit3",QUOTE:"Quote",ZERO:"Digit0",SLASH:"Slash",C:"KeyC",D:"KeyD",H:"KeyH",V:"KeyV",Z:"KeyZ",Y:"KeyY",R:"KeyR",S:"KeyS"},V={ARROW_DOWN:"ArrowDown",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",ARROW_UP:"ArrowUp",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",BACKSPACE:"Backspace",ALT:"Alt",CTRL_OR_CMD:co?"metaKey":"ctrlKey",DELETE:"Delete",ENTER:"Enter",ESCAPE:"Escape",QUESTION_MARK:"?",SPACE:" ",TAB:"Tab",CHEVRON_LEFT:"<",CHEVRON_RIGHT:">",PERIOD:".",COMMA:",",SLASH:"/",A:"a",D:"d",E:"e",F:"f",G:"g",H:"h",I:"i",L:"l",O:"o",P:"p",Q:"q",R:"r",S:"s",T:"t",V:"v",X:"x",Y:"y",Z:"z",K:"k",0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9"},vse=new Map([[V.Z,it.Z],[V.Y,it.Y]]),wse=e=>/^[a-z]$/.test(e.toLowerCase()),_4=(e,t)=>{if(t===e.key.toLowerCase())return!0;const n=vse.get(t);return!!(n&&!wse(e.key)&&e.code===n)},B1=e=>e===V.ARROW_LEFT||e===V.ARROW_RIGHT||e===V.ARROW_DOWN||e===V.ARROW_UP,TA=e=>e.altKey,c1=e=>e.shiftKey,E0=e=>e.shiftKey,yp=1e-4,Ze=(e,t,n)=>Math.min(Math.max(e,t),n),Za=(e,t,n="round")=>{const i=Math.pow(10,t);return Math[n]((e+Number.EPSILON)*i)/i},_se=(e,t,n="round")=>{const i=1/t;return Math[n](e*i)/i},FU=(e,t)=>(e+t)/2,v0=e=>typeof e=="number"&&Number.isFinite(e),IA=(e,t,n=yp)=>Math.abs(e-t)<n,oo=e=>e<0?e%(2*Math.PI)+2*Math.PI:e%(2*Math.PI);function Jd(e){return e*Math.PI/180}function ty(e){return e*180/Math.PI}function Tse(e){return Math.abs(Math.sin(2*e))<yp}function Ise(e,t,n){return e=oo(e),t=oo(t),n=oo(n),t<n?e>=t&&e<=n:e>=t||e<=n}function Sse(e,t){e=oo(e),t=oo(t);let n=e-t;return n<-Math.PI?n=n+2*Math.PI:n>Math.PI&&(n=n-2*Math.PI),Math.abs(n)}function pn(e,t,n=0,i=0){return[e-n,t-i]}function he(e,t=[0,0],n,i=[0,1]){const r=pn(e[0]-t[0],e[1]-t[1]);return n&&kB(r)<n*n?i:r}function bt(e,t){return e[0]*t[1]-t[0]*e[1]}function w0(e,t){return e[0]*t[0]+e[1]*t[1]}function Xf(e,t){return[e[0]+t[0],e[1]+t[1]]}function e6(e,t){return[e[0]-t[0],e[1]-t[1]]}function In(e,t){return pn(e[0]*t,e[1]*t)}function kB(e){return e[0]*e[0]+e[1]*e[1]}function xse(e){return Math.sqrt(kB(e))}const es=e=>{const t=xse(e);return t===0?pn(0,0):pn(e[0]/t,e[1]/t)},RB=e=>pn(e[1],-e[0]);function S(e,t){return[e,t]}function ny(e){return e.length===2?S(e[0],e[1]):void 0}function Ei(e,t=S(0,0)){return S(t[0]+e[0],t[1]+e[1])}function jf(e){return Array.isArray(e)&&e.length===2&&typeof e[0]=="number"&&!isNaN(e[0])&&typeof e[1]=="number"&&!isNaN(e[1])}function Os(e,t,n=yp){const i=Math.abs;return i(e[0]-t[0])<n&&i(e[1]-t[1])<n}function Q([e,t],[n,i],r){return S((e-n)*Math.cos(r)-(t-i)*Math.sin(r)+n,(e-n)*Math.sin(r)+(t-i)*Math.cos(r)+i)}function t6(e,t=[0,0]){return S(e[0]+t[0],e[1]+t[1])}function n6(e,t){return S((e[0]+t[0])/2,(e[1]+t[1])/2)}function ct(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1])}function La(e,t){const n=t[0]-e[0],i=t[1]-e[1];return n*n+i*i}const z1=(e,t,n)=>t6(t,In(he(e,t),n)),fm=(e,t,n)=>t[0]<=Math.max(e[0],n[0])&&t[0]>=Math.min(e[0],n[0])&&t[1]<=Math.max(e[1],n[1])&&t[1]>=Math.min(e[1],n[1]),DB=[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],LB=[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872];function Hn(e,t,n,i){return[e,t,n,i]}function Cse(e,t,n,i,r=.001,s=10){let o=1/0,a=0;for(;o>=r;){if(a>=s)return null;const l=1-n,c=l*l,d=c*l,u=n*n,f=u*n,h=d*e[0][0]+3*c*n*e[1][0]+3*l*u*e[2][0]+f*e[3][0],m=d*e[0][1]+3*c*n*e[1][1]+3*l*u*e[2][1]+f*e[3][1],p=t[0][0]+i*(t[1][0]-t[0][0]),U=t[0][1]+i*(t[1][1]-t[0][1]),b=h-p,y=m-U;if(o=Math.abs(b)+Math.abs(y),o<r)break;const w=-3*c*e[0][0]+3*c*e[1][0]-6*l*n*e[1][0]-3*u*e[2][0]+6*l*n*e[2][0]+3*u*e[3][0],v=-3*c*e[0][1]+3*c*e[1][1]-6*l*n*e[1][1]-3*u*e[2][1]+6*l*n*e[2][1]+3*u*e[3][1],I=-(t[1][0]-t[0][0]),C=-(t[1][1]-t[0][1]),_=w*C-I*v;if(Math.abs(_)<1e-12)return null;const T=1/_,k=T*(C*-b-I*-y),x=T*(-v*-b+w*-y);n+=k,i+=x,a+=1}return[n,i]}const ch=(e,t)=>S((1-t)**3*e[0][0]+3*(1-t)**2*t*e[1][0]+3*(1-t)*t**2*e[2][0]+t**3*e[3][0],(1-t)**3*e[0][1]+3*(1-t)**2*t*e[1][1]+3*(1-t)*t**2*e[2][1]+t**3*e[3][1]),k8=[[.5,0],[.2,0],[.8,0]],R8=([e,t],n,i)=>{const r=Cse(i,n,e,t,.01,3);if(!r)return null;const[s,o]=r;return s<0||s>1||o<0||o>1?null:ch(i,s)};function NB(e,t){let n=R8(k8[0],t,e);return n?[n]:(n=R8(k8[1],t,e),n?[n]:(n=R8(k8[2],t,e),n?[n]:[]))}function Ase(e,t,n=.001){const i=(c,d,u,f=n)=>{let h=c,m=d,p;for(;m-h>f;)p=(m+h)/2,u(p-f)<u(p+f)?m=p:h=p;return p};let s=0;for(let c=1/0,d=0;d<30;d++){const u=ct(t,ch(e,d/30));u<c&&(c=u,s=d)}const o=Math.max((s-1)/30,0),a=Math.min((s+1)/30,1),l=i(o,a,c=>ct(t,ch(e,c)));return l?ch(e,l):null}function G_(e,t){const n=Ase(e,t);return n?ct(t,n):0}function Mse(e){return Array.isArray(e)&&e.length===4&&jf(e[0])&&jf(e[1])&&jf(e[2])&&jf(e[3])}function X_([e,t,n,i],r){return pn(-3*(1-r)*(1-r)*e[0]+3*(1-r)*(1-r)*t[0]-6*r*(1-r)*t[0]-3*r*r*n[0]+6*r*(1-r)*n[0]+3*r*r*i[0],-3*(1-r)*(1-r)*e[1]+3*(1-r)*(1-r)*t[1]-6*r*(1-r)*t[1]-3*r*r*n[1]+6*r*(1-r)*n[1]+3*r*r*i[1])}function kse(e,t=.5){if(e.length<2)return;const n=[];for(let i=0;i<e.length-1;i++){const r=e[i-1<0?0:i-1],s=e[i],o=e[i+1>=e.length?e.length-1:i+1],a=s[0]+(o[0]-r[0])*t/2,l=s[1]+(o[1]-r[1])*t/2;n.push([S(a,l),S(o[0],o[1])])}return n}function j_(e,t=.5){if(e.length<2)return;const n=[];for(let i=0;i<e.length-1;i++){const r=e[i-1<0?0:i-1],s=e[i],o=e[i+1>=e.length?e.length-1:i+1],a=e[i+2>=e.length?e.length-1:i+2],l=[(o[0]-r[0])*t,(o[1]-r[1])*t],c=[(a[0]-s[0])*t,(a[1]-s[1])*t],d=s[0]+l[0]/3,u=s[1]+l[1]/3,f=o[0]-c[0]/3,h=o[1]-c[1]/3;n.push(Hn(S(s[0],s[1]),S(d,u),S(f,h),S(o[0],o[1])))}return n}function To([e,t,n,i],r,s=50){const o=[];for(let a=0;a<=s;a++){const l=a/s,c=Hn(e,t,n,i),d=ch(c,l),u=es(X_(c,l)),f=RB(u);o.push(Ei(In(f,r),d))}return o}function Nl(e,t,n,i,r=50){const s=[];for(let o=0;o<=r;o++){const a=o/r,l=1-a,c=S(l*l*e[0]+2*l*a*t[0]+a*a*n[0],l*l*e[1]+2*l*a*t[1]+a*a*n[1]),d=2*(1-a)*(t[0]-e[0])+2*a*(n[0]-t[0]),u=2*(1-a)*(t[1]-e[1])+2*a*(n[1]-t[1]),f=es(pn(d,u)),h=RB(f);s.push(Ei(In(h,i),c))}return s}function Y_(e){let n=0;for(let i=0;i<24;i++){const r=.5*DB[i]+.5,s=X_(e,r),o=Math.sqrt(s[0]*s[0]+s[1]*s[1]);n+=LB[i]*o}return .5*n}function Rse(e,t){if(t<=0)return 0;if(t>=1)return Y_(e);const n=t/2,i=t/2;let r=0;for(let s=0;s<24;s++){const o=n*DB[s]+i,a=X_(e,o),l=Math.sqrt(a[0]*a[0]+a[1]*a[1]);r+=LB[s]*l}return n*r}function Dse(e,t){const n=Y_(e),i=n*t;let r=0,s=1,o=t,a=0;const l=n*1e-4,c=20;for(let d=0;d<c&&(a=Rse(e,o),!(Math.abs(a-i)<l));d++)a<i?r=o:s=o,o=(r+s)/2;return ch(e,o)}function OB(e,t,n){return{center:e,halfWidth:t,halfHeight:n}}const Lse=(e,t)=>{const{halfWidth:n,halfHeight:i,center:r}=t,s=n,o=i,a=Xf(he(e),In(he(r),-1)),l=Math.abs(a[0]),c=Math.abs(a[1]);let d=.707,u=.707;for(let m=0;m<3;m++){const p=s*d,U=o*u,b=(s*s-o*o)*d**3/s,y=(o*o-s*s)*u**3/o,w=p-b,v=U-y,I=l-b,C=c-y,_=Math.hypot(v,w),T=Math.hypot(C,I);d=Math.min(1,Math.max(0,(I*_/T+b)/s)),u=Math.min(1,Math.max(0,(C*_/T+y)/o));const k=Math.hypot(u,d);d/=k,u/=k}const[f,h]=[s*d*Math.sign(a[0]),o*u*Math.sign(a[1])];return ct(Ei(a),S(f,h))};function Nse(e,t){const n=e.halfWidth,i=e.halfHeight,r=he(t[1],t[0]),s=pn(t[0][0]-e.center[0],t[0][1]-e.center[1]),o=pn(r[0]/(n*n),r[1]/(i*i)),a=pn(s[0]/(n*n),s[1]/(i*i)),l=w0(r,o),c=w0(r,a),d=w0(s,a)-1,u=c*c-l*d,f=[];if(u>0){const h=(-c-Math.sqrt(u))/l,m=(-c+Math.sqrt(u))/l;0<=h&&h<=1&&f.push(S(t[0][0]+(t[1][0]-t[0][0])*h,t[0][1]+(t[1][1]-t[0][1])*h)),0<=m&&m<=1&&f.push(S(t[0][0]+(t[1][0]-t[0][0])*m,t[0][1]+(t[1][1]-t[0][1])*m))}else if(u===0){const h=-c/l;0<=h&&h<=1&&f.push(S(t[0][0]+(t[1][0]-t[0][0])*h,t[0][1]+(t[1][1]-t[0][1])*h))}return f}function SA(e,t){return[e,t]}function Ose(e,t){const n=e[1][1]-e[0][1],i=e[0][0]-e[1][0],r=t[1][1]-t[0][1],s=t[0][0]-t[1][0],o=n*s-r*i;if(o!==0){const a=n*e[0][0]+i*e[0][1],l=r*t[0][0]+s*t[0][1];return S((a*s-l*i)/o,(n*l-r*a)/o)}return null}function Me(e,t){return[e,t]}const Pse=e=>Array.isArray(e)&&e.length===2&&jf(e[0])&&jf(e[0]),i6=(e,t,n=yp)=>{const i=lc(e,t);return i===0?!0:i<n},lc=(e,t)=>{const[n,i]=e,[[r,s],[o,a]]=t,l=n-r,c=i-s,d=o-r,u=a-s,f=l*d+c*u,h=d*d+u*u;let m=-1;h!==0&&(m=f/h);let p,U;m<0?(p=r,U=s):m>1?(p=o,U=a):(p=r+m*d,U=s+m*u);const b=n-p,y=i-U;return Math.sqrt(b*b+y*y)};function hm(e,t,n){const i=Ose(SA(e[0],e[1]),SA(t[0],t[1]));return!i||!i6(i,t,n)||!i6(i,e,n)?null:i}function xA(e,t){return hm(e,t)?0:Math.min(lc(e[0],t),lc(e[1],t),lc(t[0],e),lc(t[1],e))}function T4(...e){return FB(e)}function r6(e){return FB(e)}const PB=(e,t)=>{const[n,i]=e;let r=0;for(let s=0;s<t.length;s++){const o=(s+1)%t.length,[a,l]=t[s],[c,d]=t[o];l<=i?d>i&&(c-a)*(i-l)-(n-a)*(d-l)>0&&r++:d<=i&&(c-a)*(i-l)-(n-a)*(d-l)<0&&r--}return r!==0};function FB(e){return Fse(e)?e:[...e,e[0]]}function Fse(e){return Os(e[0],e[e.length-1])}function Vi(e,t){return Qo([e,t])}const s6=([e,t],[n,i])=>e<=n?t>=n:e>=n?i>=e:!1,o6=([e,t],[n,i])=>{const r=Math.max(e,n),s=Math.min(t,i);return r<=s?Qo([r,s]):null},BU=(e,[t,n])=>e>=t&&e<=n;function Bse(e,t){return[e,t]}function D8([e,t,n],i){const r=(d,u,f)=>(d[0]-f[0])*(u[1]-f[1])-(u[0]-f[0])*(d[1]-f[1]),s=r(i,e,t),o=r(i,t,n),a=r(i,n,e),l=s<0||o<0||a<0,c=s>0||o>0||a>0;return!(l&&c)}const zh=e=>{const t=e.map(i=>i[0]),n=e.map(i=>i[1]);return{width:Math.max(...t)-Math.min(...t),height:Math.max(...n)-Math.min(...n)}},a6=(e,t,n,i)=>{const r=n.map(h=>h[e]),s=Math.max(...r),o=Math.min(...r),a=s-o,l=a===0?1:t/a;let c=1/0;const d=n.map(h=>{const m=h[e]*l,p=[...h];return p[e]=m,m<c&&(c=m),p});if(!i||d.length===2)return d;const u=o-c;return d.map(h=>h.map((m,p)=>p===e?m+u:m))},Pn=(e,t,n)=>n?[Math.round(e/n)*n,Math.round(t/n)*n]:[e,t];var BB={exports:{}};(function(e,t){(function(n,i){e.exports=i()})(Fa,function(){var n=function(){this._listeners={}};n.prototype.addEventListener=function(c,d){this._listeners[c]=this._listeners[c]||[],this._listeners[c].indexOf(d)<0&&this._listeners[c].push(d)},n.prototype.removeEventListener=function(c,d){if(this._listeners[c]){var u=this._listeners[c].indexOf(d);u>=0&&this._listeners[c].splice(u,1)}},n.prototype.dispatchEvent=function(c){if(this._listeners[c.type]&&this._listeners[c.type].length)for(var d=this._listeners[c.type].slice(),u=0,f=d.length;u<f;++u)d[u].call(this,c)};var i=function(c){return typeof c.constructor=="function"&&c.constructor.name==="GeneratorFunction"},r=function(c){return{next:function(){var d=c();return d?{value:d}:{done:!0}}}},s=function(c){var d=!1;return{next:function(){return d?{done:!0}:(d=!0,{value:c})}}},o=function(c,d){var u=typeof c;if(u==="object"){if(typeof c.next=="function")return c;if(typeof c.then=="function")return s(c)}return u==="function"?i(c)?c():r(c):s(d.resolve(c))},a=function(c,d,u){this.target=c,this.type=d,this.data=u},l=function(c,d,u){if(n.call(this),typeof d!="number"||Math.floor(d)!==d||d<1)throw new Error("Invalid concurrency");this._concurrency=d,this._options=u||{},this._options.promise=this._options.promise||Promise,this._iterator=o(c,this._options.promise),this._done=!1,this._size=0,this._promise=null,this._callbacks=null};return l.prototype=new n,l.prototype.constructor=l,l.prototype.concurrency=function(c){return typeof c<"u"&&(this._concurrency=c,this.active()&&this._proceed()),this._concurrency},l.prototype.size=function(){return this._size},l.prototype.active=function(){return!!this._promise},l.prototype.promise=function(){return this._promise},l.prototype.start=function(){var c=this,d=this._options.promise;return this._promise=new d(function(u,f){c._callbacks={reject:f,resolve:u},c._proceed()}),this._promise},l.prototype._fireEvent=function(c,d){this.dispatchEvent(new a(this,c,d))},l.prototype._settle=function(c){c?this._callbacks.reject(c):this._callbacks.resolve(),this._promise=null,this._callbacks=null},l.prototype._onPooledPromiseFulfilled=function(c,d){this._size--,this.active()&&(this._fireEvent("fulfilled",{promise:c,result:d}),this._proceed())},l.prototype._onPooledPromiseRejected=function(c,d){this._size--,this.active()&&(this._fireEvent("rejected",{promise:c,error:d}),this._settle(d||new Error("Unknown error")))},l.prototype._trackPromise=function(c){var d=this;c.then(function(u){d._onPooledPromiseFulfilled(c,u)},function(u){d._onPooledPromiseRejected(c,u)}).catch(function(u){d._settle(new Error("Promise processing failed: "+u))})},l.prototype._proceed=function(){if(!this._done){for(var c={done:!1};this._size<this._concurrency&&!(c=this._iterator.next()).done;)this._size++,this._trackPromise(c.value);this._done=c===null||!!c.done}this._done&&this._size===0&&this._settle()},l.PromisePoolEvent=a,l.PromisePool=l,l})})(BB);var zse=BB.exports;const Hse=wl(zse);class CA{constructor(t,n){F(this,"pool");F(this,"entries",{});this.pool=new Hse(t,n)}all(){const t=n=>{if(n.data.result){const[i,r]=n.data.result;this.entries[i]=r}};return this.pool.addEventListener("fulfilled",t),this.pool.start().then(()=>(setTimeout(()=>{this.pool.removeEventListener("fulfilled",t)}),Object.values(this.entries)))}}let zB=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,n)=>(n&=63,n<36?t+=n.toString(36):n<62?t+=(n-26).toString(36).toUpperCase():n>62?t+="-":t+="_",t),"");function Vse(){return Math.floor(Math.random()*2**31)}class HB{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const AA=()=>{const e=new Date,t=e.getFullYear(),n=`${e.getMonth()+1}`.padStart(2,"0"),i=`${e.getDate()}`.padStart(2,"0"),r=`${e.getHours()}`.padStart(2,"0"),s=`${e.getMinutes()}`.padStart(2,"0");return`${t}-${n}-${i}-${r}${s}`},kt=e=>e.charAt(0).toUpperCase()+e.slice(1),$se=e=>e instanceof HTMLElement&&e.className.includes("ToolIcon"),I4=e=>e instanceof HTMLElement&&e.dataset.type==="wysiwyg"||e instanceof HTMLBRElement||e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement,Gse=e=>I4(e)||e instanceof Element&&!!e.closest("label, button"),Na=e=>e instanceof HTMLElement&&e.dataset.type==="wysiwyg"||e instanceof HTMLBRElement||e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement&&(e.type==="text"||e.type==="number"||e.type==="password"||e.type==="search"),Ep=({fontFamily:e})=>{for(const[t,n]of Object.entries(nt))if(n===e)return`${t}${UB(n).map(i=>`, ${i}`).join("")}`;return cm},mt=({fontSize:e,fontFamily:t})=>`${e}px ${Ep({fontFamily:t})}`,Xse=async e=>{requestAnimationFrame(()=>requestAnimationFrame(e))},ll=(e,t)=>{let n=0,i=null;const r=(...s)=>{i=s,clearTimeout(n),n=window.setTimeout(()=>{i=null,e(...s)},t)};return r.flush=()=>{if(clearTimeout(n),i){const s=i;i=null,e(...s)}},r.cancel=()=>{i=null,clearTimeout(n)},r},vp=(e,t)=>{let n=null,i=null,r=null;const s=a=>{n=window.requestAnimationFrame(()=>{n=null,e(...a),i=null,r&&(i=r,r=null,s(i))})},o=(...a)=>{i=a,n===null?s(i):t!=null&&t.trailing&&(r=a)};return o.flush=()=>{n!==null&&(cancelAnimationFrame(n),n=null),i&&(e(...r||i),i=r=null)},o.cancel=()=>{i=r=null,n!==null&&(cancelAnimationFrame(n),n=null)},o},cl=e=>1-Math.pow(1-e,4),MA=(e,t,n)=>(t-e)*cl(n)+e,jse=({fromValues:e,toValues:t,onStep:n,duration:i=250,interpolateValue:r,onStart:s,onEnd:o,onCancel:a})=>{let l=!1,c=0,d;function u(f){if(l)return;d===void 0&&(d=f,s==null||s());const h=Math.min(f-d,i),m=cl(h/i),p={};if(Object.keys(e).forEach(U=>{const b=U,y=(t[b]-e[b])*m+e[b];p[b]=y}),n(p),h<i){const U=h/i,b={};Object.keys(e).forEach(y=>{const w=y,v=e[w],I=t[w];let C;C=r?r(v,I,U,w):MA(v,I,U),C==null&&(C=MA(v,I,U)),b[w]=C}),n(b),c=window.requestAnimationFrame(u)}else n(t),o==null||o()}return c=window.requestAnimationFrame(u),()=>{a==null||a(),l=!0,window.cancelAnimationFrame(c)}},Yse=(e,t)=>{if(!e.length||t<1)return[];let n=0,i=0;const r=Array(Math.ceil(e.length/t));for(;n<e.length;)r[i++]=e.slice(n,n+=t);return r},Gi=(e,t)=>Math.abs(e-t),tn=(e,t)=>t.type==="custom"?{...e.activeTool,type:"custom",customType:t.customType,locked:t.locked??e.activeTool.locked}:{...e.activeTool,lastActiveTool:t.lastActiveToolBeforeEraser===void 0?e.activeTool.lastActiveTool:t.lastActiveToolBeforeEraser,type:t.type,customType:null,locked:t.locked??e.activeTool.locked,fromSelection:t.fromSelection??!1},Nt=({clientX:e,clientY:t},{zoom:n,offsetLeft:i,offsetTop:r,scrollX:s,scrollY:o})=>{const a=(e-i)/n.value-s,l=(t-r)/n.value-o;return{x:a,y:l}},Wr=({sceneX:e,sceneY:t},{zoom:n,offsetLeft:i,offsetTop:r,scrollX:s,scrollY:o})=>{const a=(e+s)*n.value+i,l=(t+o)*n.value+r;return{x:a,y:l}},zU=e=>getComputedStyle(document.documentElement).getPropertyValue(`--${e}`),Wse="A-Za-z--------",Kse="---",Zse=new RegExp(`^[^${Wse}]*[${Kse}]`),VB=e=>Zse.test(e),qa=e=>{const[t,n]=e;return{x:t,y:n}},$B=e=>{if((e==null?void 0:e.name)==="AbortError"){console.warn(e);return}throw e},GB=(e,t,n=0)=>{n<0&&(n=e.length+n),n=Math.min(e.length,Math.max(n,0));let i=n-1;for(;++i<e.length;)if(t(e[i],i,e))return i;return-1},Md=(e,t,n=e.length-1)=>{n<0&&(n=e.length+n),n=Math.min(e.length-1,Math.max(n,0));let i=n+1;for(;--i>-1;)if(t(e[i],i,e))return i;return-1},qse=(e,t)=>{for(let n=0;n<e.length;n++){const i=t(e[n],n);if(i!=null)return i}},Ir=e=>{const t=e.length===5&&e.substr(4,1)==="0",n=e.length===9&&e.substr(7,2)==="00";return t||n||e===Ye.transparent},N2=e=>e.fillStyle!=="solid"||Ir(e.backgroundColor),iy=()=>{let e,t;const n=new Promise((i,r)=>{e=i,t=r});return n.resolve=e,n.reject=t,n},kA=(e,t)=>{const n=[{value:1,symbol:"b"},{value:1e3,symbol:"k"},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"}],i=/\.0+$|(\.[0-9]*[1-9])0+$/;let r;for(r=n.length-1;r>0&&!(e>=n[r].value);r--);return(e/n[r].value).toFixed(t).replace(i,"$1")+n[r].symbol},S4=()=>{var e;return((e=document.querySelector('meta[name="version"]'))==null?void 0:e.content)||bB},Qse=e=>{let t=e.parentElement;for(;t;){if(t===document.body)return document;const{overflowY:n}=window.getComputedStyle(t);if(t.scrollHeight>t.clientHeight&&(n==="auto"||n==="scroll"||n==="overlay"))return t;t=t.parentElement}return document},Jse=e=>{let t=e.parentElement;for(;t;){if(t.tabIndex>-1){t.focus();return}t=t.parentElement}},W_=e=>{e.preventDefault(),e.returnValue=""},XB=e=>Array.from(e).map(t=>`0${t.toString(16)}`.slice(-2)).join(""),wg=()=>Date.now(),ve=e=>e instanceof Map?e:e.reduce((t,n)=>(t.set(typeof n=="string"?n:n.id,n),t),new Map),eoe=e=>e.reduce((t,n,i)=>(t.set(n.id,[n,i]),t),new Map),ya=(e,t)=>e.reduce((n,i,r)=>(n[t?t(i):r]=i,n),{}),toe=e=>e.reduce((t,n,i)=>{const r={...n,prev:null,next:null};if(i!==0){const s=t[i-1];if(r.prev=s,s.next=r,i===e.length-1){const o=t[0];r.next=o,o.prev=r}}return t.push(r),t},[]),Kl=e=>Array.isArray(e)?e:e.values(),noe=e=>Array.isArray(e)?e:Array.from(Kl(e)),ioe=()=>gB.TEST==="production",K_=()=>gB.DEVELOPMENT==="production",roe=()=>typeof process<"u"&&!0,jB=(e,t)=>new CustomEvent(e,{detail:{nativeEvent:t},cancelable:!0}),O2=(e,t)=>{let n=!1;for(const i in t){const r=t[i];if(typeof r<"u"){if(e[i]===r&&(typeof r!="object"||r===null))continue;n=!0}}return n?{...e,...t}:e},wp=()=>{try{return window.self===window.top?"top":"iframe"}catch{return"iframe"}},soe=()=>wp()==="iframe",_p=e=>!!e&&typeof e=="object"&&"then"in e&&"catch"in e&&"finally"in e,x4=e=>{const t=e==null?void 0:e.querySelectorAll("button, a, input, select, textarea, div[tabindex], label[tabindex]");return t?Array.from(t).filter(n=>n.tabIndex>-1&&!n.disabled):[]},RA=(e,t)=>Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t,Ki=(e,t,n,i=!1)=>{const r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return i&&console.warn("%cisShallowEqual: objects don't have same properties ->","color: #8B4000",e,t),!1;if(n&&Array.isArray(n)){for(const o of n)if(!(e[o]===t[o]||RA(e[o],t[o])))return i&&console.warn(`%cisShallowEqual: ${o} not equal ->`,"color: #8B4000",e[o],t[o]),!1;return!0}return r.every(o=>{const a=n==null?void 0:n[o],l=a?a(e[o],t[o]):e[o]===t[o]||RA(e[o],t[o]);return!l&&i&&console.warn(`%cisShallowEqual: ${o} not equal ->`,"color: #8B4000",e[o],t[o]),l})},ry=(e,t,{checkForDefaultPrevented:n=!0}={})=>function(r){if(e==null||e(r),!n||!(r!=null&&r.defaultPrevented))return t==null?void 0:t(r)},qo=(e,t,n)=>{if(!t)return e;if(n)return console.error(t),e;throw new Error(t)};function gn(e,t){if(!e)throw new Error(t)}const ooe=e=>{let t,n;const i=function(r){const s=Object.entries(r);if(t){let a=!0;for(const[l,c]of s)if(t.get(l)!==c){a=!1;break}if(a)return n}const o=e(r);return t=new Map(s),n=o,o};return i.clear=()=>{t=void 0,n=void 0},i},YB=(e,t)=>e instanceof Set||e instanceof Map?e.has(t):"includes"in e?e.includes(t):e.hasOwnProperty(t),Qa=e=>JSON.parse(JSON.stringify(e)),d1=(e,t)=>Ki(e,t)?e:t;function en(e,t,n,i){var r;return e?((r=e==null?void 0:e.addEventListener)==null||r.call(e,t,n,i),()=>{var s;(s=e==null?void 0:e.removeEventListener)==null||s.call(e,t,n,i)}):()=>{}}function aoe(e,t=!0){const n=e.length;if(n<4)return"";let i=e[0],r=e[1];const s=e[2];let o=`M${i[0].toFixed(2)},${i[1].toFixed(2)} Q${r[0].toFixed(2)},${r[1].toFixed(2)} ${FU(r[0],s[0]).toFixed(2)},${FU(r[1],s[1]).toFixed(2)} T`;for(let a=2,l=n-1;a<l;a++)i=e[a],r=e[a+1],o+=`${FU(i[0],r[0]).toFixed(2)},${FU(i[1],r[1]).toFixed(2)} `;return t&&(o+="Z"),o}const WB=e=>e.replace(/\r?\n|\r/g,`
`),Qo=e=>e,Hc=async(e,...t)=>new Promise(n=>{n(e(...t))}),loe=(...e)=>Math.max(...e.map(t=>t?1:0))>0,coe=e=>{try{return JSON.parse(e)}catch{return null}},P2=e=>e.replace(/"/g,"&quot;"),L8=e=>Array.isArray(e)?e:[e],doe=e=>Array.isArray(e),KB=e=>doe(e)?e.length:e instanceof Map||e instanceof Set?e.size:Object.keys(e).length,ZB=(e,t)=>{if(KB(e)===0)return null;const n=t||(r=>r);let i=null;for(const r of e){const s=n(r);if((i===null||i===s)&&s!=null)i=s;else return null}return i};let uoe=new HB(Date.now());const Ps=()=>Math.floor(uoe.next()*2**31),gr=()=>zB();var Z_={};Object.defineProperty(Z_,"__esModule",{value:!0});var qB=Z_.sanitizeUrl=void 0,foe=/^([^\w]*)(javascript|data|vbscript)/im,hoe=/&#(\w+)(^\w|;)?/g,goe=/&(newline|tab);/gi,moe=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,poe=/^.+(:|&colon;)/gim,Uoe=[".","/"];function boe(e){return Uoe.indexOf(e[0])>-1}function yoe(e){return e.replace(hoe,function(t,n){return String.fromCharCode(n)})}function Eoe(e){var t=yoe(e||"").replace(goe,"").replace(moe,"").trim();if(!t)return"about:blank";if(boe(t))return t;var n=t.match(poe);if(!n)return t;var i=n[0];return foe.test(i)?"about:blank":t}qB=Z_.sanitizeUrl=Eoe;const ts=e=>(e=e.trim(),e&&qB(P2(e))),QB=e=>!!(e!=null&&e.includes(location.origin)||e!=null&&e.startsWith("/")),q_=e=>{if(e=ts(e),e.startsWith("/"))return`${location.origin}${e}`;try{new URL(e)}catch{return"about:blank"}return e};class Ws{constructor(){F(this,"subscribers",[])}on(...t){const n=t.flat().filter(i=>typeof i=="function");return this.subscribers.push(...n),()=>this.off(n)}once(...t){const n=t.flat().filter(r=>typeof r=="function");n.push(()=>i());const i=this.on(...n);return i}off(...t){const n=t.flat();this.subscribers=this.subscribers.filter(i=>!n.includes(i))}trigger(...t){for(const n of this.subscribers)n(...t);return this}clear(){this.subscribers=[]}}function C4(e,t,n){if(e&&e.length){const[i,r]=t,s=Math.PI/180*n,o=Math.cos(s),a=Math.sin(s);for(const l of e){const[c,d]=l;l[0]=(c-i)*o-(d-r)*a+i,l[1]=(c-i)*a+(d-r)*o+r}}}function voe(e,t,n){const i=[];e.forEach(r=>i.push(...r)),C4(i,t,n)}function woe(e,t){return e[0]===t[0]&&e[1]===t[1]}function _oe(e,t,n,i=1){const r=n,s=Math.max(t,.1),o=e[0]&&e[0][0]&&typeof e[0][0]=="number"?[e]:e,a=[0,0];if(r)for(const c of o)C4(c,a,r);const l=Toe(o,s,i);if(r){for(const c of o)C4(c,a,-r);voe(l,a,-r)}return l}function Toe(e,t,n){const i=[];for(const c of e){const d=[...c];woe(d[0],d[d.length-1])||d.push([d[0][0],d[0][1]]),d.length>2&&i.push(d)}const r=[];t=Math.max(t,.1);const s=[];for(const c of i)for(let d=0;d<c.length-1;d++){const u=c[d],f=c[d+1];if(u[1]!==f[1]){const h=Math.min(u[1],f[1]);s.push({ymin:h,ymax:Math.max(u[1],f[1]),x:h===u[1]?u[0]:f[0],islope:(f[0]-u[0])/(f[1]-u[1])})}}if(s.sort((c,d)=>c.ymin<d.ymin?-1:c.ymin>d.ymin?1:c.x<d.x?-1:c.x>d.x?1:c.ymax===d.ymax?0:(c.ymax-d.ymax)/Math.abs(c.ymax-d.ymax)),!s.length)return r;let o=[],a=s[0].ymin,l=0;for(;o.length||s.length;){if(s.length){let c=-1;for(let u=0;u<s.length&&!(s[u].ymin>a);u++)c=u;s.splice(0,c+1).forEach(u=>{o.push({s:a,edge:u})})}if(o=o.filter(c=>!(c.edge.ymax<=a)),o.sort((c,d)=>c.edge.x===d.edge.x?0:(c.edge.x-d.edge.x)/Math.abs(c.edge.x-d.edge.x)),(n!==1||l%t===0)&&o.length>1)for(let c=0;c<o.length;c=c+2){const d=c+1;if(d>=o.length)break;const u=o[c].edge,f=o[d].edge;r.push([[Math.round(u.x),a],[Math.round(f.x),a]])}a+=n,o.forEach(c=>{c.edge.x=c.edge.x+n*c.edge.islope}),l++}return r}function Tp(e,t){var n;const i=t.hachureAngle+90;let r=t.hachureGap;r<0&&(r=t.strokeWidth*4),r=Math.max(r,.1);let s=1;return t.roughness>=1&&(((n=t.randomizer)===null||n===void 0?void 0:n.next())||Math.random())>.7&&(s=r),_oe(e,r,i,s||1)}class Q_{constructor(t){this.helper=t}fillPolygons(t,n){return this._fillPolygons(t,n)}_fillPolygons(t,n){const i=Tp(t,n);return{type:"fillSketch",ops:this.renderLines(i,n)}}renderLines(t,n){const i=[];for(const r of t)i.push(...this.helper.doubleLineOps(r[0][0],r[0][1],r[1][0],r[1][1],n));return i}}function sy(e){const t=e[0],n=e[1];return Math.sqrt(Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2))}class Ioe extends Q_{fillPolygons(t,n){let i=n.hachureGap;i<0&&(i=n.strokeWidth*4),i=Math.max(i,.1);const r=Object.assign({},n,{hachureGap:i}),s=Tp(t,r),o=Math.PI/180*n.hachureAngle,a=[],l=i*.5*Math.cos(o),c=i*.5*Math.sin(o);for(const[u,f]of s)sy([u,f])&&a.push([[u[0]-l,u[1]+c],[...f]],[[u[0]+l,u[1]-c],[...f]]);return{type:"fillSketch",ops:this.renderLines(a,n)}}}class Soe extends Q_{fillPolygons(t,n){const i=this._fillPolygons(t,n),r=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),s=this._fillPolygons(t,r);return i.ops=i.ops.concat(s.ops),i}}class xoe{constructor(t){this.helper=t}fillPolygons(t,n){n=Object.assign({},n,{hachureAngle:0});const i=Tp(t,n);return this.dotsOnLines(i,n)}dotsOnLines(t,n){const i=[];let r=n.hachureGap;r<0&&(r=n.strokeWidth*4),r=Math.max(r,.1);let s=n.fillWeight;s<0&&(s=n.strokeWidth/2);const o=r/4;for(const a of t){const l=sy(a),c=l/r,d=Math.ceil(c)-1,u=l-d*r,f=(a[0][0]+a[1][0])/2-r/4,h=Math.min(a[0][1],a[1][1]);for(let m=0;m<d;m++){const p=h+u+m*r,U=f-o+Math.random()*2*o,b=p-o+Math.random()*2*o,y=this.helper.ellipse(U,b,s,s,n);i.push(...y.ops)}}return{type:"fillSketch",ops:i}}}class Coe{constructor(t){this.helper=t}fillPolygons(t,n){const i=Tp(t,n);return{type:"fillSketch",ops:this.dashedLine(i,n)}}dashedLine(t,n){const i=n.dashOffset<0?n.hachureGap<0?n.strokeWidth*4:n.hachureGap:n.dashOffset,r=n.dashGap<0?n.hachureGap<0?n.strokeWidth*4:n.hachureGap:n.dashGap,s=[];return t.forEach(o=>{const a=sy(o),l=Math.floor(a/(i+r)),c=(a+r-l*(i+r))/2;let d=o[0],u=o[1];d[0]>u[0]&&(d=o[1],u=o[0]);const f=Math.atan((u[1]-d[1])/(u[0]-d[0]));for(let h=0;h<l;h++){const m=h*(i+r),p=m+i,U=[d[0]+m*Math.cos(f)+c*Math.cos(f),d[1]+m*Math.sin(f)+c*Math.sin(f)],b=[d[0]+p*Math.cos(f)+c*Math.cos(f),d[1]+p*Math.sin(f)+c*Math.sin(f)];s.push(...this.helper.doubleLineOps(U[0],U[1],b[0],b[1],n))}}),s}}class Aoe{constructor(t){this.helper=t}fillPolygons(t,n){const i=n.hachureGap<0?n.strokeWidth*4:n.hachureGap,r=n.zigzagOffset<0?i:n.zigzagOffset;n=Object.assign({},n,{hachureGap:i+r});const s=Tp(t,n);return{type:"fillSketch",ops:this.zigzagLines(s,r,n)}}zigzagLines(t,n,i){const r=[];return t.forEach(s=>{const o=sy(s),a=Math.round(o/(2*n));let l=s[0],c=s[1];l[0]>c[0]&&(l=s[1],c=s[0]);const d=Math.atan((c[1]-l[1])/(c[0]-l[0]));for(let u=0;u<a;u++){const f=u*2*n,h=(u+1)*2*n,m=Math.sqrt(2*Math.pow(n,2)),p=[l[0]+f*Math.cos(d),l[1]+f*Math.sin(d)],U=[l[0]+h*Math.cos(d),l[1]+h*Math.sin(d)],b=[p[0]+m*Math.cos(d+Math.PI/4),p[1]+m*Math.sin(d+Math.PI/4)];r.push(...this.helper.doubleLineOps(p[0],p[1],b[0],b[1],i),...this.helper.doubleLineOps(b[0],b[1],U[0],U[1],i))}}),r}}const yr={};function Moe(e,t){let n=e.fillStyle||"hachure";if(!yr[n])switch(n){case"zigzag":yr[n]||(yr[n]=new Ioe(t));break;case"cross-hatch":yr[n]||(yr[n]=new Soe(t));break;case"dots":yr[n]||(yr[n]=new xoe(t));break;case"dashed":yr[n]||(yr[n]=new Coe(t));break;case"zigzag-line":yr[n]||(yr[n]=new Aoe(t));break;case"hachure":default:n="hachure",yr[n]||(yr[n]=new Q_(t));break}return yr[n]}const koe=0,A4=1,JB=2,HU={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function Roe(e){const t=new Array;for(;e!=="";)if(e.match(/^([ \t\r\n,]+)/))e=e.substr(RegExp.$1.length);else if(e.match(/^([aAcChHlLmMqQsStTvVzZ])/))t[t.length]={type:koe,text:RegExp.$1},e=e.substr(RegExp.$1.length);else if(e.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))t[t.length]={type:A4,text:`${parseFloat(RegExp.$1)}`},e=e.substr(RegExp.$1.length);else return[];return t[t.length]={type:JB,text:""},t}function N8(e,t){return e.type===t}function J_(e){const t=[],n=Roe(e);let i="BOD",r=0,s=n[r];for(;!N8(s,JB);){let o=0;const a=[];if(i==="BOD")if(s.text==="M"||s.text==="m")r++,o=HU[s.text],i=s.text;else return J_("M0,0"+e);else N8(s,A4)?o=HU[i]:(r++,o=HU[s.text],i=s.text);if(r+o<n.length){for(let l=r;l<r+o;l++){const c=n[l];if(N8(c,A4))a[a.length]=+c.text;else throw new Error("Param not a number: "+i+","+c.text)}if(typeof HU[i]=="number"){const l={key:i,data:a};t.push(l),r+=o,s=n[r],i==="M"&&(i="L"),i==="m"&&(i="l")}else throw new Error("Bad segment: "+i)}else throw new Error("Path data ended short")}return t}function ez(e){let t=0,n=0,i=0,r=0;const s=[];for(const{key:o,data:a}of e)switch(o){case"M":s.push({key:"M",data:[...a]}),[t,n]=a,[i,r]=a;break;case"m":t+=a[0],n+=a[1],s.push({key:"M",data:[t,n]}),i=t,r=n;break;case"L":s.push({key:"L",data:[...a]}),[t,n]=a;break;case"l":t+=a[0],n+=a[1],s.push({key:"L",data:[t,n]});break;case"C":s.push({key:"C",data:[...a]}),t=a[4],n=a[5];break;case"c":{const l=a.map((c,d)=>d%2?c+n:c+t);s.push({key:"C",data:l}),t=l[4],n=l[5];break}case"Q":s.push({key:"Q",data:[...a]}),t=a[2],n=a[3];break;case"q":{const l=a.map((c,d)=>d%2?c+n:c+t);s.push({key:"Q",data:l}),t=l[2],n=l[3];break}case"A":s.push({key:"A",data:[...a]}),t=a[5],n=a[6];break;case"a":t+=a[5],n+=a[6],s.push({key:"A",data:[a[0],a[1],a[2],a[3],a[4],t,n]});break;case"H":s.push({key:"H",data:[...a]}),t=a[0];break;case"h":t+=a[0],s.push({key:"H",data:[t]});break;case"V":s.push({key:"V",data:[...a]}),n=a[0];break;case"v":n+=a[0],s.push({key:"V",data:[n]});break;case"S":s.push({key:"S",data:[...a]}),t=a[2],n=a[3];break;case"s":{const l=a.map((c,d)=>d%2?c+n:c+t);s.push({key:"S",data:l}),t=l[2],n=l[3];break}case"T":s.push({key:"T",data:[...a]}),t=a[0],n=a[1];break;case"t":t+=a[0],n+=a[1],s.push({key:"T",data:[t,n]});break;case"Z":case"z":s.push({key:"Z",data:[]}),t=i,n=r;break}return s}function tz(e){const t=[];let n="",i=0,r=0,s=0,o=0,a=0,l=0;for(const{key:c,data:d}of e){switch(c){case"M":t.push({key:"M",data:[...d]}),[i,r]=d,[s,o]=d;break;case"C":t.push({key:"C",data:[...d]}),i=d[4],r=d[5],a=d[2],l=d[3];break;case"L":t.push({key:"L",data:[...d]}),[i,r]=d;break;case"H":i=d[0],t.push({key:"L",data:[i,r]});break;case"V":r=d[0],t.push({key:"L",data:[i,r]});break;case"S":{let u=0,f=0;n==="C"||n==="S"?(u=i+(i-a),f=r+(r-l)):(u=i,f=r),t.push({key:"C",data:[u,f,...d]}),a=d[0],l=d[1],i=d[2],r=d[3];break}case"T":{const[u,f]=d;let h=0,m=0;n==="Q"||n==="T"?(h=i+(i-a),m=r+(r-l)):(h=i,m=r);const p=i+2*(h-i)/3,U=r+2*(m-r)/3,b=u+2*(h-u)/3,y=f+2*(m-f)/3;t.push({key:"C",data:[p,U,b,y,u,f]}),a=h,l=m,i=u,r=f;break}case"Q":{const[u,f,h,m]=d,p=i+2*(u-i)/3,U=r+2*(f-r)/3,b=h+2*(u-h)/3,y=m+2*(f-m)/3;t.push({key:"C",data:[p,U,b,y,h,m]}),a=u,l=f,i=h,r=m;break}case"A":{const u=Math.abs(d[0]),f=Math.abs(d[1]),h=d[2],m=d[3],p=d[4],U=d[5],b=d[6];u===0||f===0?(t.push({key:"C",data:[i,r,U,b,U,b]}),i=U,r=b):(i!==U||r!==b)&&(nz(i,r,U,b,u,f,h,m,p).forEach(function(w){t.push({key:"C",data:w})}),i=U,r=b);break}case"Z":t.push({key:"Z",data:[]}),i=s,r=o;break}n=c}return t}function Doe(e){return Math.PI*e/180}function u1(e,t,n){const i=e*Math.cos(n)-t*Math.sin(n),r=e*Math.sin(n)+t*Math.cos(n);return[i,r]}function nz(e,t,n,i,r,s,o,a,l,c){const d=Doe(o);let u=[],f=0,h=0,m=0,p=0;if(c)[f,h,m,p]=c;else{[e,t]=u1(e,t,-d),[n,i]=u1(n,i,-d);const O=(e-n)/2,L=(t-i)/2;let Y=O*O/(r*r)+L*L/(s*s);Y>1&&(Y=Math.sqrt(Y),r=Y*r,s=Y*s);const $=a===l?-1:1,H=r*r,z=s*s,G=H*z-H*L*L-z*O*O,j=H*L*L+z*O*O,X=$*Math.sqrt(Math.abs(G/j));m=X*r*L/s+(e+n)/2,p=X*-s*O/r+(t+i)/2,f=Math.asin(parseFloat(((t-p)/s).toFixed(9))),h=Math.asin(parseFloat(((i-p)/s).toFixed(9))),e<m&&(f=Math.PI-f),n<m&&(h=Math.PI-h),f<0&&(f=Math.PI*2+f),h<0&&(h=Math.PI*2+h),l&&f>h&&(f=f-Math.PI*2),!l&&h>f&&(h=h-Math.PI*2)}let U=h-f;if(Math.abs(U)>Math.PI*120/180){const O=h,L=n,Y=i;l&&h>f?h=f+Math.PI*120/180*1:h=f+Math.PI*120/180*-1,n=m+r*Math.cos(h),i=p+s*Math.sin(h),u=nz(n,i,L,Y,r,s,o,0,l,[h,O,m,p])}U=h-f;const b=Math.cos(f),y=Math.sin(f),w=Math.cos(h),v=Math.sin(h),I=Math.tan(U/4),C=4/3*r*I,_=4/3*s*I,T=[e,t],k=[e+C*y,t-_*b],x=[n+C*v,i-_*w],D=[n,i];if(k[0]=2*T[0]-k[0],k[1]=2*T[1]-k[1],c)return[k,x,D].concat(u);{u=[k,x,D].concat(u);const O=[];for(let L=0;L<u.length;L+=3){const Y=u1(u[L][0],u[L][1],d),$=u1(u[L+1][0],u[L+1][1],d),H=u1(u[L+2][0],u[L+2][1],d);O.push([Y[0],Y[1],$[0],$[1],H[0],H[1]])}return O}}const Loe={randOffset:Boe,randOffsetWithRange:zoe,ellipse:Poe,doubleLineOps:Hoe};function iz(e,t,n,i,r){return{type:"path",ops:dl(e,t,n,i,r)}}function F2(e,t,n){const i=(e||[]).length;if(i>2){const r=[];for(let s=0;s<i-1;s++)r.push(...dl(e[s][0],e[s][1],e[s+1][0],e[s+1][1],n));return t&&r.push(...dl(e[i-1][0],e[i-1][1],e[0][0],e[0][1],n)),{type:"path",ops:r}}else if(i===2)return iz(e[0][0],e[0][1],e[1][0],e[1][1],n);return{type:"path",ops:[]}}function Noe(e,t){return F2(e,!0,t)}function Ooe(e,t,n,i,r){const s=[[e,t],[e+n,t],[e+n,t+i],[e,t+i]];return Noe(s,r)}function DA(e,t){let n=PA(e,1*(1+t.roughness*.2),t);if(!t.disableMultiStroke){const i=PA(e,1.5*(1+t.roughness*.22),Voe(t));n=n.concat(i)}return{type:"path",ops:n}}function Poe(e,t,n,i,r){const s=rz(n,i,r);return M4(e,t,r,s).opset}function rz(e,t,n){const i=Math.sqrt(Math.PI*2*Math.sqrt((Math.pow(e/2,2)+Math.pow(t/2,2))/2)),r=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*i)),s=Math.PI*2/r;let o=Math.abs(e/2),a=Math.abs(t/2);const l=1-n.curveFitting;return o+=Fe(o*l,n),a+=Fe(a*l,n),{increment:s,rx:o,ry:a}}function M4(e,t,n,i){const[r,s]=FA(i.increment,e,t,i.rx,i.ry,1,i.increment*l6(.1,l6(.4,1,n),n),n);let o=c6(r,null,n);if(!n.disableMultiStroke&&n.roughness!==0){const[a]=FA(i.increment,e,t,i.rx,i.ry,1.5,0,n),l=c6(a,null,n);o=o.concat(l)}return{estimatedPoints:s,opset:{type:"path",ops:o}}}function LA(e,t,n,i,r,s,o,a,l){const c=e,d=t;let u=Math.abs(n/2),f=Math.abs(i/2);u+=Fe(u*.01,l),f+=Fe(f*.01,l);let h=r,m=s;for(;h<0;)h+=Math.PI*2,m+=Math.PI*2;m-h>Math.PI*2&&(h=0,m=Math.PI*2);const p=Math.PI*2/l.curveStepCount,U=Math.min(p/2,(m-h)/2),b=BA(U,c,d,u,f,h,m,1,l);if(!l.disableMultiStroke){const y=BA(U,c,d,u,f,h,m,1.5,l);b.push(...y)}return o&&(a?b.push(...dl(c,d,c+u*Math.cos(h),d+f*Math.sin(h),l),...dl(c,d,c+u*Math.cos(m),d+f*Math.sin(m),l)):b.push({op:"lineTo",data:[c,d]},{op:"lineTo",data:[c+u*Math.cos(h),d+f*Math.sin(h)]})),{type:"path",ops:b}}function NA(e,t){const n=tz(ez(J_(e))),i=[];let r=[0,0],s=[0,0];for(const{key:o,data:a}of n)switch(o){case"M":{s=[a[0],a[1]],r=[a[0],a[1]];break}case"L":i.push(...dl(s[0],s[1],a[0],a[1],t)),s=[a[0],a[1]];break;case"C":{const[l,c,d,u,f,h]=a;i.push(...$oe(l,c,d,u,f,h,s,t)),s=[f,h];break}case"Z":i.push(...dl(s[0],s[1],r[0],r[1],t)),s=[r[0],r[1]];break}return{type:"path",ops:i}}function O8(e,t){const n=[];for(const i of e)if(i.length){const r=t.maxRandomnessOffset||0,s=i.length;if(s>2){n.push({op:"move",data:[i[0][0]+Fe(r,t),i[0][1]+Fe(r,t)]});for(let o=1;o<s;o++)n.push({op:"lineTo",data:[i[o][0]+Fe(r,t),i[o][1]+Fe(r,t)]})}}return{type:"fillPath",ops:n}}function _f(e,t){return Moe(t,Loe).fillPolygons(e,t)}function Foe(e,t,n,i,r,s,o){const a=e,l=t;let c=Math.abs(n/2),d=Math.abs(i/2);c+=Fe(c*.01,o),d+=Fe(d*.01,o);let u=r,f=s;for(;u<0;)u+=Math.PI*2,f+=Math.PI*2;f-u>Math.PI*2&&(u=0,f=Math.PI*2);const h=(f-u)/o.curveStepCount,m=[];for(let p=u;p<=f;p=p+h)m.push([a+c*Math.cos(p),l+d*Math.sin(p)]);return m.push([a+c*Math.cos(f),l+d*Math.sin(f)]),m.push([a,l]),_f([m],o)}function Boe(e,t){return Fe(e,t)}function zoe(e,t,n){return l6(e,t,n)}function Hoe(e,t,n,i,r){return dl(e,t,n,i,r,!0)}function Voe(e){const t=Object.assign({},e);return t.randomizer=void 0,e.seed&&(t.seed=e.seed+1),t}function sz(e){return e.randomizer||(e.randomizer=new HB(e.seed||0)),e.randomizer.next()}function l6(e,t,n,i=1){return n.roughness*i*(sz(n)*(t-e)+e)}function Fe(e,t,n=1){return l6(-e,e,t,n)}function dl(e,t,n,i,r,s=!1){const o=s?r.disableMultiStrokeFill:r.disableMultiStroke,a=OA(e,t,n,i,r,!0,!1);if(o)return a;const l=OA(e,t,n,i,r,!0,!0);return a.concat(l)}function OA(e,t,n,i,r,s,o){const a=Math.pow(e-n,2)+Math.pow(t-i,2),l=Math.sqrt(a);let c=1;l<200?c=1:l>500?c=.4:c=-.0016668*l+1.233334;let d=r.maxRandomnessOffset||0;d*d*100>a&&(d=l/10);const u=d/2,f=.2+sz(r)*.2;let h=r.bowing*r.maxRandomnessOffset*(i-t)/200,m=r.bowing*r.maxRandomnessOffset*(e-n)/200;h=Fe(h,r,c),m=Fe(m,r,c);const p=[],U=()=>Fe(u,r,c),b=()=>Fe(d,r,c),y=r.preserveVertices;return o?p.push({op:"move",data:[e+(y?0:U()),t+(y?0:U())]}):p.push({op:"move",data:[e+(y?0:Fe(d,r,c)),t+(y?0:Fe(d,r,c))]}),o?p.push({op:"bcurveTo",data:[h+e+(n-e)*f+U(),m+t+(i-t)*f+U(),h+e+2*(n-e)*f+U(),m+t+2*(i-t)*f+U(),n+(y?0:U()),i+(y?0:U())]}):p.push({op:"bcurveTo",data:[h+e+(n-e)*f+b(),m+t+(i-t)*f+b(),h+e+2*(n-e)*f+b(),m+t+2*(i-t)*f+b(),n+(y?0:b()),i+(y?0:b())]}),p}function PA(e,t,n){const i=[];i.push([e[0][0]+Fe(t,n),e[0][1]+Fe(t,n)]),i.push([e[0][0]+Fe(t,n),e[0][1]+Fe(t,n)]);for(let r=1;r<e.length;r++)i.push([e[r][0]+Fe(t,n),e[r][1]+Fe(t,n)]),r===e.length-1&&i.push([e[r][0]+Fe(t,n),e[r][1]+Fe(t,n)]);return c6(i,null,n)}function c6(e,t,n){const i=e.length,r=[];if(i>3){const s=[],o=1-n.curveTightness;r.push({op:"move",data:[e[1][0],e[1][1]]});for(let a=1;a+2<i;a++){const l=e[a];s[0]=[l[0],l[1]],s[1]=[l[0]+(o*e[a+1][0]-o*e[a-1][0])/6,l[1]+(o*e[a+1][1]-o*e[a-1][1])/6],s[2]=[e[a+1][0]+(o*e[a][0]-o*e[a+2][0])/6,e[a+1][1]+(o*e[a][1]-o*e[a+2][1])/6],s[3]=[e[a+1][0],e[a+1][1]],r.push({op:"bcurveTo",data:[s[1][0],s[1][1],s[2][0],s[2][1],s[3][0],s[3][1]]})}}else i===3?(r.push({op:"move",data:[e[1][0],e[1][1]]}),r.push({op:"bcurveTo",data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):i===2&&r.push(...dl(e[0][0],e[0][1],e[1][0],e[1][1],n));return r}function FA(e,t,n,i,r,s,o,a){const l=a.roughness===0,c=[],d=[];if(l){e=e/4,d.push([t+i*Math.cos(-e),n+r*Math.sin(-e)]);for(let u=0;u<=Math.PI*2;u=u+e){const f=[t+i*Math.cos(u),n+r*Math.sin(u)];c.push(f),d.push(f)}d.push([t+i*Math.cos(0),n+r*Math.sin(0)]),d.push([t+i*Math.cos(e),n+r*Math.sin(e)])}else{const u=Fe(.5,a)-Math.PI/2;d.push([Fe(s,a)+t+.9*i*Math.cos(u-e),Fe(s,a)+n+.9*r*Math.sin(u-e)]);const f=Math.PI*2+u-.01;for(let h=u;h<f;h=h+e){const m=[Fe(s,a)+t+i*Math.cos(h),Fe(s,a)+n+r*Math.sin(h)];c.push(m),d.push(m)}d.push([Fe(s,a)+t+i*Math.cos(u+Math.PI*2+o*.5),Fe(s,a)+n+r*Math.sin(u+Math.PI*2+o*.5)]),d.push([Fe(s,a)+t+.98*i*Math.cos(u+o),Fe(s,a)+n+.98*r*Math.sin(u+o)]),d.push([Fe(s,a)+t+.9*i*Math.cos(u+o*.5),Fe(s,a)+n+.9*r*Math.sin(u+o*.5)])}return[d,c]}function BA(e,t,n,i,r,s,o,a,l){const c=s+Fe(.1,l),d=[];d.push([Fe(a,l)+t+.9*i*Math.cos(c-e),Fe(a,l)+n+.9*r*Math.sin(c-e)]);for(let u=c;u<=o;u=u+e)d.push([Fe(a,l)+t+i*Math.cos(u),Fe(a,l)+n+r*Math.sin(u)]);return d.push([t+i*Math.cos(o),n+r*Math.sin(o)]),d.push([t+i*Math.cos(o),n+r*Math.sin(o)]),c6(d,null,l)}function $oe(e,t,n,i,r,s,o,a){const l=[],c=[a.maxRandomnessOffset||1,(a.maxRandomnessOffset||1)+.3];let d=[0,0];const u=a.disableMultiStroke?1:2,f=a.preserveVertices;for(let h=0;h<u;h++)h===0?l.push({op:"move",data:[o[0],o[1]]}):l.push({op:"move",data:[o[0]+(f?0:Fe(c[0],a)),o[1]+(f?0:Fe(c[0],a))]}),d=f?[r,s]:[r+Fe(c[h],a),s+Fe(c[h],a)],l.push({op:"bcurveTo",data:[e+Fe(c[h],a),t+Fe(c[h],a),n+Fe(c[h],a),i+Fe(c[h],a),d[0],d[1]]});return l}function f1(e){return[...e]}function Goe(e,t=0){const n=e.length;if(n<3)throw new Error("A curve must have at least three points.");const i=[];if(n===3)i.push(f1(e[0]),f1(e[1]),f1(e[2]),f1(e[2]));else{const r=[];r.push(e[0],e[0]);for(let a=1;a<e.length;a++)r.push(e[a]),a===e.length-1&&r.push(e[a]);const s=[],o=1-t;i.push(f1(r[0]));for(let a=1;a+2<r.length;a++){const l=r[a];s[0]=[l[0],l[1]],s[1]=[l[0]+(o*r[a+1][0]-o*r[a-1][0])/6,l[1]+(o*r[a+1][1]-o*r[a-1][1])/6],s[2]=[r[a+1][0]+(o*r[a][0]-o*r[a+2][0])/6,r[a+1][1]+(o*r[a][1]-o*r[a+2][1])/6],s[3]=[r[a+1][0],r[a+1][1]],i.push(s[1],s[2],s[3])}}return i}function Xoe(e,t){return Math.sqrt(B2(e,t))}function B2(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function joe(e,t,n){const i=B2(t,n);if(i===0)return B2(e,t);let r=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/i;return r=Math.max(0,Math.min(1,r)),B2(e,Id(t,n,r))}function Id(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function Yoe(e,t){const n=e[t+0],i=e[t+1],r=e[t+2],s=e[t+3];let o=3*i[0]-2*n[0]-s[0];o*=o;let a=3*i[1]-2*n[1]-s[1];a*=a;let l=3*r[0]-2*s[0]-n[0];l*=l;let c=3*r[1]-2*s[1]-n[1];return c*=c,o<l&&(o=l),a<c&&(a=c),o+a}function k4(e,t,n,i){const r=i||[];if(Yoe(e,t)<n){const s=e[t+0];r.length?Xoe(r[r.length-1],s)>1&&r.push(s):r.push(s),r.push(e[t+3])}else{const o=e[t+0],a=e[t+1],l=e[t+2],c=e[t+3],d=Id(o,a,.5),u=Id(a,l,.5),f=Id(l,c,.5),h=Id(d,u,.5),m=Id(u,f,.5),p=Id(h,m,.5);k4([o,d,h,p],0,n,r),k4([p,m,f,c],0,n,r)}return r}function e9(e,t){return d6(e,0,e.length,t)}function d6(e,t,n,i,r){const s=r||[],o=e[t],a=e[n-1];let l=0,c=1;for(let d=t+1;d<n-1;++d){const u=joe(e[d],o,a);u>l&&(l=u,c=d)}return Math.sqrt(l)>i?(d6(e,t,c+1,i,s),d6(e,c,n,i,s)):(s.length||s.push(o),s.push(a)),s}function Ip(e,t=.15,n){const i=[],r=(e.length-1)/3;for(let s=0;s<r;s++){const o=s*3;k4(e,o,t,i)}return n&&n>0?d6(i,0,i.length,n):i}function Woe(e,t,n){const i=J_(e),r=tz(ez(i)),s=[];let o=[],a=[0,0],l=[];const c=()=>{l.length>=4&&o.push(...Ip(l,t)),l=[]},d=()=>{c(),o.length&&(s.push(o),o=[])};for(const{key:f,data:h}of r)switch(f){case"M":d(),a=[h[0],h[1]],o.push(a);break;case"L":c(),o.push([h[0],h[1]]);break;case"C":if(!l.length){const m=o.length?o[o.length-1]:a;l.push([m[0],m[1]])}l.push([h[0],h[1]]),l.push([h[2],h[3]]),l.push([h[4],h[5]]);break;case"Z":c(),o.push([a[0],a[1]]);break}if(d(),!n)return s;const u=[];for(const f of s){const h=e9(f,n);h.length&&u.push(h)}return u}const Or="none";class Hh{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Vse()}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,n,i){return{shape:t,sets:n||[],options:i||this.defaultOptions}}line(t,n,i,r,s){const o=this._o(s);return this._d("line",[iz(t,n,i,r,o)],o)}rectangle(t,n,i,r,s){const o=this._o(s),a=[],l=Ooe(t,n,i,r,o);if(o.fill){const c=[[t,n],[t+i,n],[t+i,n+r],[t,n+r]];o.fillStyle==="solid"?a.push(O8([c],o)):a.push(_f([c],o))}return o.stroke!==Or&&a.push(l),this._d("rectangle",a,o)}ellipse(t,n,i,r,s){const o=this._o(s),a=[],l=rz(i,r,o),c=M4(t,n,o,l);if(o.fill)if(o.fillStyle==="solid"){const d=M4(t,n,o,l).opset;d.type="fillPath",a.push(d)}else a.push(_f([c.estimatedPoints],o));return o.stroke!==Or&&a.push(c.opset),this._d("ellipse",a,o)}circle(t,n,i,r){const s=this.ellipse(t,n,i,i,r);return s.shape="circle",s}linearPath(t,n){const i=this._o(n);return this._d("linearPath",[F2(t,!1,i)],i)}arc(t,n,i,r,s,o,a=!1,l){const c=this._o(l),d=[],u=LA(t,n,i,r,s,o,a,!0,c);if(a&&c.fill)if(c.fillStyle==="solid"){const f=Object.assign({},c);f.disableMultiStroke=!0;const h=LA(t,n,i,r,s,o,!0,!1,f);h.type="fillPath",d.push(h)}else d.push(Foe(t,n,i,r,s,o,c));return c.stroke!==Or&&d.push(u),this._d("arc",d,c)}curve(t,n){const i=this._o(n),r=[],s=DA(t,i);if(i.fill&&i.fill!==Or&&t.length>=3)if(i.fillStyle==="solid"){const o=DA(t,Object.assign(Object.assign({},i),{disableMultiStroke:!0,roughness:i.roughness?i.roughness+i.fillShapeRoughnessGain:0}));r.push({type:"fillPath",ops:this._mergedShape(o.ops)})}else{const o=Goe(t),a=Ip(o,10,(1+i.roughness)/2);r.push(_f([a],i))}return i.stroke!==Or&&r.push(s),this._d("curve",r,i)}polygon(t,n){const i=this._o(n),r=[],s=F2(t,!0,i);return i.fill&&(i.fillStyle==="solid"?r.push(O8([t],i)):r.push(_f([t],i))),i.stroke!==Or&&r.push(s),this._d("polygon",r,i)}path(t,n){const i=this._o(n),r=[];if(!t)return this._d("path",r,i);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const s=i.fill&&i.fill!=="transparent"&&i.fill!==Or,o=i.stroke!==Or,a=!!(i.simplification&&i.simplification<1),l=a?4-4*(i.simplification||1):(1+i.roughness)/2,c=Woe(t,1,l),d=NA(t,i);if(s)if(i.fillStyle==="solid")if(c.length===1){const u=NA(t,Object.assign(Object.assign({},i),{disableMultiStroke:!0,roughness:i.roughness?i.roughness+i.fillShapeRoughnessGain:0}));r.push({type:"fillPath",ops:this._mergedShape(u.ops)})}else r.push(O8(c,i));else r.push(_f(c,i));return o&&(a?c.forEach(u=>{r.push(F2(u,!1,i))}):r.push(d)),this._d("path",r,i)}opsToPath(t,n){let i="";for(const r of t.ops){const s=typeof n=="number"&&n>=0?r.data.map(o=>+o.toFixed(n)):r.data;switch(r.op){case"move":i+=`M${s[0]} ${s[1]} `;break;case"bcurveTo":i+=`C${s[0]} ${s[1]}, ${s[2]} ${s[3]}, ${s[4]} ${s[5]} `;break;case"lineTo":i+=`L${s[0]} ${s[1]} `;break}}return i.trim()}toPaths(t){const n=t.sets||[],i=t.options||this.defaultOptions,r=[];for(const s of n){let o=null;switch(s.type){case"path":o={d:this.opsToPath(s),stroke:i.stroke,strokeWidth:i.strokeWidth,fill:Or};break;case"fillPath":o={d:this.opsToPath(s),stroke:Or,strokeWidth:0,fill:i.fill||Or};break;case"fillSketch":o=this.fillSketch(s,i);break}o&&r.push(o)}return r}fillSketch(t,n){let i=n.fillWeight;return i<0&&(i=n.strokeWidth/2),{d:this.opsToPath(t),stroke:n.fill||Or,strokeWidth:i,fill:Or}}_mergedShape(t){return t.filter((n,i)=>i===0?!0:n.op!=="move")}}class Koe{constructor(t,n){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new Hh(n)}draw(t){const n=t.sets||[],i=t.options||this.getDefaultOptions(),r=this.ctx,s=t.options.fixedDecimalPlaceDigits;for(const o of n)switch(o.type){case"path":r.save(),r.strokeStyle=i.stroke==="none"?"transparent":i.stroke,r.lineWidth=i.strokeWidth,i.strokeLineDash&&r.setLineDash(i.strokeLineDash),i.strokeLineDashOffset&&(r.lineDashOffset=i.strokeLineDashOffset),this._drawToContext(r,o,s),r.restore();break;case"fillPath":{r.save(),r.fillStyle=i.fill||"";const a=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(r,o,s,a),r.restore();break}case"fillSketch":this.fillSketch(r,o,i);break}}fillSketch(t,n,i){let r=i.fillWeight;r<0&&(r=i.strokeWidth/2),t.save(),i.fillLineDash&&t.setLineDash(i.fillLineDash),i.fillLineDashOffset&&(t.lineDashOffset=i.fillLineDashOffset),t.strokeStyle=i.fill||"",t.lineWidth=r,this._drawToContext(t,n,i.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,n,i,r="nonzero"){t.beginPath();for(const s of n.ops){const o=typeof i=="number"&&i>=0?s.data.map(a=>+a.toFixed(i)):s.data;switch(s.op){case"move":t.moveTo(o[0],o[1]);break;case"bcurveTo":t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"lineTo":t.lineTo(o[0],o[1]);break}}n.type==="fillPath"?t.fill(r):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,n,i,r,s){const o=this.gen.line(t,n,i,r,s);return this.draw(o),o}rectangle(t,n,i,r,s){const o=this.gen.rectangle(t,n,i,r,s);return this.draw(o),o}ellipse(t,n,i,r,s){const o=this.gen.ellipse(t,n,i,r,s);return this.draw(o),o}circle(t,n,i,r){const s=this.gen.circle(t,n,i,r);return this.draw(s),s}linearPath(t,n){const i=this.gen.linearPath(t,n);return this.draw(i),i}polygon(t,n){const i=this.gen.polygon(t,n);return this.draw(i),i}arc(t,n,i,r,s,o,a=!1,l){const c=this.gen.arc(t,n,i,r,s,o,a,l);return this.draw(c),c}curve(t,n){const i=this.gen.curve(t,n);return this.draw(i),i}path(t,n){const i=this.gen.path(t,n);return this.draw(i),i}}const VU="http://www.w3.org/2000/svg";class Zoe{constructor(t,n){this.svg=t,this.gen=new Hh(n)}draw(t){const n=t.sets||[],i=t.options||this.getDefaultOptions(),r=this.svg.ownerDocument||window.document,s=r.createElementNS(VU,"g"),o=t.options.fixedDecimalPlaceDigits;for(const a of n){let l=null;switch(a.type){case"path":{l=r.createElementNS(VU,"path"),l.setAttribute("d",this.opsToPath(a,o)),l.setAttribute("stroke",i.stroke),l.setAttribute("stroke-width",i.strokeWidth+""),l.setAttribute("fill","none"),i.strokeLineDash&&l.setAttribute("stroke-dasharray",i.strokeLineDash.join(" ").trim()),i.strokeLineDashOffset&&l.setAttribute("stroke-dashoffset",`${i.strokeLineDashOffset}`);break}case"fillPath":{l=r.createElementNS(VU,"path"),l.setAttribute("d",this.opsToPath(a,o)),l.setAttribute("stroke","none"),l.setAttribute("stroke-width","0"),l.setAttribute("fill",i.fill||""),(t.shape==="curve"||t.shape==="polygon")&&l.setAttribute("fill-rule","evenodd");break}case"fillSketch":{l=this.fillSketch(r,a,i);break}}l&&s.appendChild(l)}return s}fillSketch(t,n,i){let r=i.fillWeight;r<0&&(r=i.strokeWidth/2);const s=t.createElementNS(VU,"path");return s.setAttribute("d",this.opsToPath(n,i.fixedDecimalPlaceDigits)),s.setAttribute("stroke",i.fill||""),s.setAttribute("stroke-width",r+""),s.setAttribute("fill","none"),i.fillLineDash&&s.setAttribute("stroke-dasharray",i.fillLineDash.join(" ").trim()),i.fillLineDashOffset&&s.setAttribute("stroke-dashoffset",`${i.fillLineDashOffset}`),s}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,n){return this.gen.opsToPath(t,n)}line(t,n,i,r,s){const o=this.gen.line(t,n,i,r,s);return this.draw(o)}rectangle(t,n,i,r,s){const o=this.gen.rectangle(t,n,i,r,s);return this.draw(o)}ellipse(t,n,i,r,s){const o=this.gen.ellipse(t,n,i,r,s);return this.draw(o)}circle(t,n,i,r){const s=this.gen.circle(t,n,i,r);return this.draw(s)}linearPath(t,n){const i=this.gen.linearPath(t,n);return this.draw(i)}polygon(t,n){const i=this.gen.polygon(t,n);return this.draw(i)}arc(t,n,i,r,s,o,a=!1,l){const c=this.gen.arc(t,n,i,r,s,o,a,l);return this.draw(c)}curve(t,n){const i=this.gen.curve(t,n);return this.draw(i)}path(t,n){const i=this.gen.path(t,n);return this.draw(i)}}const od={canvas(e,t){return new Koe(e,t)},svg(e,t){return new Zoe(e,t)},generator(e){return new Hh(e)},newSeed(){return Hh.newSeed()}},qoe=e=>{const{angle:t,width:n,height:i,x:r,y:s}=e,o=r+n/2,a=s+i/2,l=S(o,a);let c;return e.type==="diamond"?c=T4(Q(S(o,s),l,t),Q(S(r+n,a),l,t),Q(S(o,s+i),l,t),Q(S(r,a),l,t)):c=T4(Q(S(r,s),l,t),Q(S(r+n,s),l,t),Q(S(r+n,s+i),l,t),Q(S(r,s+i),l,t)),{type:"polygon",data:c}},Qoe=e=>{const{width:t,height:n,angle:i,x:r,y:s}=e;return{type:"ellipse",data:{center:S(r+t/2,s+n/2),angle:i,halfWidth:t/2,halfHeight:n/2}}},Vu=e=>{if(!e)return[];for(const t of e.sets)if(t.type==="path")return t.ops;return e.sets[0].ops},Joe=(e,t=S(0,0),n,i)=>{const r=l=>Q(S(l[0]+t[0],l[1]+t[1]),i,n),s=Vu(e),o=[];let a=S(0,0);for(const l of s){if(l.op==="move"){const c=ny(l.data);gn(c!=null,"Ops data is not a point"),a=r(c)}if(l.op==="bcurveTo"){const c=r(S(l.data[0],l.data[1])),d=r(S(l.data[2],l.data[3])),u=r(S(l.data[4],l.data[5]));o.push(Hn(a,c,d,u)),a=u}}return{type:"polycurve",data:o}},eae=e=>{let t=e[0];const n=[];for(let i=1;i<e.length;i++){const r=e[i];n.push(Me(t,r)),t=r}return n},tae=(e,t,n=!1)=>{const i=s=>Q(Ei(Xf(he(s),pn(e.x,e.y))),t,e.angle),r=eae(e.points.map(s=>i(s)));return n?{type:"polygon",data:r6(r.flat())}:{type:"polyline",data:r}},nae=(e,t,n=S(0,0),i,r)=>{const s=d=>Q(S(d[0]+n[0],d[1]+n[1]),r,i);if(e.roundness===null)return{type:"polygon",data:r6(e.points.map(d=>s(d)))};const o=Vu(t),a=[];let l=!1;for(const d of o)d.op==="move"?(l=!l,l&&a.push(S(d.data[0],d.data[1]))):d.op==="bcurveTo"?l&&(a.push(S(d.data[0],d.data[1])),a.push(S(d.data[2],d.data[3])),a.push(S(d.data[4],d.data[5]))):d.op==="lineTo"&&l&&a.push(S(d.data[0],d.data[1]));const c=Ip(a,10,5).map(d=>s(d));return{type:"polygon",data:r6(c)}};function zA(e,t,n,i=r=>r){return e*i(.5-t*(.5-n))}function iae(e){return[-e[0],-e[1]]}function js(e,t){return[e[0]+t[0],e[1]+t[1]]}function fs(e,t){return[e[0]-t[0],e[1]-t[1]]}function Gs(e,t){return[e[0]*t,e[1]*t]}function rae(e,t){return[e[0]/t,e[1]/t]}function h1(e){return[e[1],-e[0]]}function HA(e,t){return e[0]*t[0]+e[1]*t[1]}function sae(e,t){return e[0]===t[0]&&e[1]===t[1]}function oae(e){return Math.hypot(e[0],e[1])}function aae(e){return e[0]*e[0]+e[1]*e[1]}function VA(e,t){return aae(fs(e,t))}function oz(e){return rae(e,oae(e))}function lae(e,t){return Math.hypot(e[1]-t[1],e[0]-t[0])}function g1(e,t,n){let i=Math.sin(n),r=Math.cos(n),s=e[0]-t[0],o=e[1]-t[1],a=s*r-o*i,l=s*i+o*r;return[a+t[0],l+t[1]]}function R4(e,t,n){return js(e,Gs(fs(t,e),n))}function $A(e,t,n){return js(e,Gs(t,n))}var{min:af,PI:cae}=Math,GA=.275,m1=cae+1e-4;function dae(e,t={}){let{size:n=16,smoothing:i=.5,thinning:r=.5,simulatePressure:s=!0,easing:o=z=>z,start:a={},end:l={},last:c=!1}=t,{cap:d=!0,easing:u=z=>z*(2-z)}=a,{cap:f=!0,easing:h=z=>--z*z*z+1}=l;if(e.length===0||n<=0)return[];let m=e[e.length-1].runningLength,p=a.taper===!1?0:a.taper===!0?Math.max(n,m):a.taper,U=l.taper===!1?0:l.taper===!0?Math.max(n,m):l.taper,b=Math.pow(n*i,2),y=[],w=[],v=e.slice(0,10).reduce((z,G)=>{let j=G.pressure;if(s){let X=af(1,G.distance/n),K=af(1,1-X);j=af(1,z+(K-z)*(X*GA))}return(z+j)/2},e[0].pressure),I=zA(n,r,e[e.length-1].pressure,o),C,_=e[0].vector,T=e[0].point,k=T,x=T,D=k,O=!1;for(let z=0;z<e.length;z++){let{pressure:G}=e[z],{point:j,vector:X,distance:K,runningLength:ne}=e[z];if(z<e.length-1&&m-ne<3)continue;if(r){if(s){let Be=af(1,K/n),Qe=af(1,1-Be);G=af(1,v+(Qe-v)*(Be*GA))}I=zA(n,r,G,o)}else I=n/2;C===void 0&&(C=I);let se=ne<p?u(ne/p):1,oe=m-ne<U?h((m-ne)/U):1;I=Math.max(.01,I*Math.min(se,oe));let Ee=(z<e.length-1?e[z+1]:e[z]).vector,Re=z<e.length-1?HA(X,Ee):1,De=HA(X,_)<0&&!O,vt=Re!==null&&Re<0;if(De||vt){let Be=Gs(h1(_),I);for(let Qe=1/13,$t=0;$t<=1;$t+=Qe)x=g1(fs(j,Be),j,m1*$t),y.push(x),D=g1(js(j,Be),j,m1*-$t),w.push(D);T=x,k=D,vt&&(O=!0);continue}if(O=!1,z===e.length-1){let Be=Gs(h1(X),I);y.push(fs(j,Be)),w.push(js(j,Be));continue}let Vt=Gs(h1(R4(Ee,X,Re)),I);x=fs(j,Vt),(z<=1||VA(T,x)>b)&&(y.push(x),T=x),D=js(j,Vt),(z<=1||VA(k,D)>b)&&(w.push(D),k=D),v=G,_=X}let L=e[0].point.slice(0,2),Y=e.length>1?e[e.length-1].point.slice(0,2):js(e[0].point,[1,1]),$=[],H=[];if(e.length===1){if(!(p||U)||c){let z=$A(L,oz(h1(fs(L,Y))),-(C||I)),G=[];for(let j=1/13,X=j;X<=1;X+=j)G.push(g1(z,L,m1*2*X));return G}}else{if(!(p||U&&e.length===1))if(d)for(let G=1/13,j=G;j<=1;j+=G){let X=g1(w[0],L,m1*j);$.push(X)}else{let G=fs(y[0],w[0]),j=Gs(G,.5),X=Gs(G,.51);$.push(fs(L,j),fs(L,X),js(L,X),js(L,j))}let z=h1(iae(e[e.length-1].vector));if(U||p&&e.length===1)H.push(Y);else if(f){let G=$A(Y,z,I);for(let j=1/29,X=j;X<1;X+=j)H.push(g1(G,Y,m1*3*X))}else H.push(js(Y,Gs(z,I)),js(Y,Gs(z,I*.99)),fs(Y,Gs(z,I*.99)),fs(Y,Gs(z,I)))}return y.concat(H,w.reverse(),$)}function uae(e,t={}){var n;let{streamline:i=.5,size:r=16,last:s=!1}=t;if(e.length===0)return[];let o=.15+(1-i)*.85,a=Array.isArray(e[0])?e:e.map(({x:h,y:m,pressure:p=.5})=>[h,m,p]);if(a.length===2){let h=a[1];a=a.slice(0,-1);for(let m=1;m<5;m++)a.push(R4(a[0],h,m/4))}a.length===1&&(a=[...a,[...js(a[0],[1,1]),...a[0].slice(2)]]);let l=[{point:[a[0][0],a[0][1]],pressure:a[0][2]>=0?a[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],c=!1,d=0,u=l[0],f=a.length-1;for(let h=1;h<a.length;h++){let m=s&&h===f?a[h].slice(0,2):R4(u.point,a[h],o);if(sae(u.point,m))continue;let p=lae(m,u.point);if(d+=p,h<f&&!c){if(d<r)continue;c=!0}u={point:m,pressure:a[h][2]>=0?a[h][2]:.5,vector:oz(fs(u.point,m)),distance:p,runningLength:d},l.push(u)}return l[0].vector=((n=l[1])==null?void 0:n.vector)||[0,0],l}function fae(e,t={}){return dae(uae(e,t),t)}const ci=10,hae=(e,t,n,i,r,s,o,a)=>{var D,O;const{width:l,height:c}=ul(e),d=i/l,u=r/c,f=(((D=e.crop)==null?void 0:D.x)??0)/d,h=(((O=e.crop)==null?void 0:O.y)??0)/u,m=Q(S(s,o),oi(e,t),-e.angle);s=m[0],o=m[1];let p=e.width,U=e.height,b=e.crop??{x:0,y:0,width:i,height:r,naturalWidth:i,naturalHeight:r};const y=b.height,w=b.width,v=e.scale[0]===-1,I=e.scale[1]===-1;let C=o-e.y,_=s-e.x;n.includes("n")&&(U=Ze(e.height-C,ci,I?c-h:e.height+h)),n.includes("s")&&(C=o-e.y-e.height,U=Ze(e.height+C,ci,I?e.height+h:c-h)),n.includes("e")&&(_=s-e.x-e.width,p=Ze(e.width+_,ci,v?e.width+f:l-f)),n.includes("w")&&(p=Ze(e.width-_,ci,v?l-f:e.width+f));const T=L=>{L.height=U*u,L.width=p*d};T(b);const k=(L,Y)=>{T(Y),L.includes("n")&&(I||(Y.y+=y-Y.height)),L.includes("s")&&I&&(Y.y+=y-Y.height),L.includes("e")&&v&&(Y.x+=w-Y.width),L.includes("w")&&(v||(Y.x+=w-Y.width))};switch(n){case"n":{if(a){const L=f+e.width/2,Y=l-f-e.width/2,$=Math.min(L,Y)*2;p=Ze(U*a,ci,$),U=p/a}k(n,b),a&&(b.x+=(w-b.width)/2);break}case"s":{if(a){const L=f+e.width/2,Y=l-f-e.width/2,$=Math.min(L,Y)*2;p=Ze(U*a,ci,$),U=p/a}k(n,b),a&&(b.x+=(w-b.width)/2);break}case"w":{if(a){const L=h+e.height/2,Y=c-h-e.height/2,$=Math.min(L,Y)*2;U=Ze(p/a,ci,$),p=U*a}k(n,b),a&&(b.y+=(y-b.height)/2);break}case"e":{if(a){const L=h+e.height/2,Y=c-h-e.height/2,$=Math.min(L,Y)*2;U=Ze(p/a,ci,$),p=U*a}k(n,b),a&&(b.y+=(y-b.height)/2);break}case"ne":{if(a)if(_>-C){const L=I?c-h:h+e.height;U=Ze(p/a,ci,L),p=U*a}else{const L=v?f+e.width:l-f;p=Ze(U*a,ci,L),U=p/a}k(n,b);break}case"nw":{if(a)if(_<C){const L=I?c-h:h+e.height;U=Ze(p/a,ci,L),p=U*a}else{const L=v?l-f:f+e.width;p=Ze(U*a,ci,L),U=p/a}k(n,b);break}case"se":{if(a)if(_>C){const L=I?h+e.height:c-h;U=Ze(p/a,ci,L),p=U*a}else{const L=v?f+e.width:l-f;p=Ze(U*a,ci,L),U=p/a}k(n,b);break}case"sw":{if(a)if(-_>C){const L=I?h+e.height:c-h;U=Ze(p/a,ci,L),p=U*a}else{const L=v?l-f:f+e.width;p=Ze(U*a,ci,L),U=p/a}k(n,b);break}}const x=gae(e,n,p,U,!!a);return IA(b.width,b.naturalWidth)&&IA(b.height,b.naturalHeight)&&(b=null),{x:x[0],y:x[1],width:p,height:U,crop:b}},gae=(e,t,n,i,r)=>{const[s,o,a,l]=bm(e,e.width,e.height,!0),c=S(s,o),d=S(a,l),u=n6(c,d),[f,h,m,p]=bm(e,n,i,!0),U=m-f,b=p-h;let y=[...c];if(["n","w","nw"].includes(t)&&(y=[d[0]-Math.abs(U),d[1]-Math.abs(b)]),t==="ne"){const T=[c[0],d[1]];y=[T[0],T[1]-Math.abs(b)]}if(t==="sw"){const T=[d[0],c[1]];y=[T[0]-Math.abs(U),T[1]]}r&&(["s","n"].includes(t)&&(y[0]=u[0]-U/2),["e","w"].includes(t)&&(y[1]=u[1]-b/2));const w=e.angle,v=Q(y,u,w),I=[y[0]+Math.abs(U)/2,y[1]+Math.abs(b)/2],C=Q(I,u,w);y=Q(v,C,-w);const _=[...y];return _[0]+=e.x-f,_[1]+=e.y-h,_},mae=(e,t)=>{if(e.crop){const{width:n,height:i}=ul(e),[r,s,o,a,l,c]=$e(e,t),d=he(Q(S(r,s),S(l,c),e.angle)),u=he(Q(S(o,s),S(l,c),e.angle)),f=es(e6(u,d)),h=he(Q(S(r,a),S(l,c),e.angle)),m=e6(h,d),p=es(m),{cropX:U,cropY:b}=pae(e.crop,e.scale),y=Xf(Xf(d,In(f,-U*n/e.crop.naturalWidth)),In(p,-b*i/e.crop.naturalHeight)),w=Ei(Xf(Xf(y,In(f,n/2)),In(p,i/2))),v=Q(Ei(y),w,-e.angle);return{...e,x:v[0],y:v[1],width:n,height:i,crop:null}}return e},ul=e=>{if(e.crop){const t=e.width/(e.crop.width/e.crop.naturalWidth),n=e.height/(e.crop.height/e.crop.naturalHeight);return{width:t,height:n}}return{width:e.width,height:e.height}},pae=(e,t)=>{let n=e.x,i=e.y;const r=t[0]===-1,s=t[1]===-1;return r&&(n=e.naturalWidth-Math.abs(n)-e.width),s&&(i=e.naturalHeight-Math.abs(i)-e.height),{cropX:n,cropY:i}},Uae=(e,t=!1)=>{const n=e.crop;if(!n)return null;const i=e.scale[0]===-1,r=e.scale[1]===-1;let s=n.x,o=n.y;if(i&&(s=n.naturalWidth-n.width-n.x),r&&(o=n.naturalHeight-n.height-n.y),t)return{x:s,y:o};const{width:a,height:l}=ul(e);return{x:s/(n.naturalWidth/a),y:o/(n.naturalHeight/l)}},_0=new WeakMap,t9=(e,t)=>{const n=_0.get(e);if(!n)return;const{version:i,shapes:r}=n;if(i!==e.version){_0.delete(e);return}return r.get(t)},n9=(e,t,n)=>{const i=_0.get(e);if(!i){_0.set(e,{version:e.version,shapes:new Map([[n,t]])});return}const{version:r,shapes:s}=i;if(r!==e.version){_0.set(e,{version:e.version,shapes:new Map([[n,t]])});return}s.set(n,t)};function u6(e){const t=t9(e,0);if(t)return t;const n=gce(e),i=[],r=[];for(let o=0;o<n.length;o+=1){const a=n[o],l=n[o-1]&&ny(n[o-1].data.slice(-2));switch(a.op){case"move":continue;case"lineTo":if(!l)throw new Error("prevPoint is undefined");i.push(Me(S(e.x+l[0],e.y+l[1]),S(e.x+a.data[0],e.y+a.data[1])));continue;case"bcurveTo":if(!l)throw new Error("prevPoint is undefined");r.push(Hn(S(e.x+l[0],e.y+l[1]),S(e.x+a.data[0],e.y+a.data[1]),S(e.x+a.data[2],e.y+a.data[3]),S(e.x+a.data[4],e.y+a.data[5])));continue;default:console.error("Unknown op type",a.op)}}const s=[i,r];return n9(e,s,0),s}function i9(e,t=0){const n=t9(e,t);if(n)return n;let i=ur(Math.min(e.width,e.height),e);i===0&&(i=.01);const r=Bse(S(e.x,e.y),S(e.x+e.width,e.y+e.height)),s=Me(S(r[0][0]+i,r[0][1]),S(r[1][0]-i,r[0][1])),o=Me(S(r[1][0],r[0][1]+i),S(r[1][0],r[1][1]-i)),a=Me(S(r[0][0]+i,r[1][1]),S(r[1][0]-i,r[1][1])),l=Me(S(r[0][0],r[1][1]-i),S(r[0][0],r[0][1]+i)),c=[Hn(l[1],S(l[1][0]+2/3*(r[0][0]-l[1][0]),l[1][1]+2/3*(r[0][1]-l[1][1])),S(s[0][0]+2/3*(r[0][0]-s[0][0]),s[0][1]+2/3*(r[0][1]-s[0][1])),s[0]),Hn(s[1],S(s[1][0]+2/3*(r[1][0]-s[1][0]),s[1][1]+2/3*(r[0][1]-s[1][1])),S(o[0][0]+2/3*(r[1][0]-o[0][0]),o[0][1]+2/3*(r[0][1]-o[0][1])),o[0]),Hn(o[1],S(o[1][0]+2/3*(r[1][0]-o[1][0]),o[1][1]+2/3*(r[1][1]-o[1][1])),S(a[1][0]+2/3*(r[1][0]-a[1][0]),a[1][1]+2/3*(r[1][1]-a[1][1])),a[1]),Hn(a[0],S(a[0][0]+2/3*(r[0][0]-a[0][0]),a[0][1]+2/3*(r[1][1]-a[0][1])),S(l[0][0]+2/3*(r[0][0]-l[0][0]),l[0][1]+2/3*(r[1][1]-l[0][1])),l[0])],d=t>0?c.map(h=>j_(To(h,t))):[[c[0]],[c[1]],[c[2]],[c[3]]],f=[[Me(d[0][d[0].length-1][3],d[1][0][0]),Me(d[1][d[1].length-1][3],d[2][0][0]),Me(d[2][d[2].length-1][3],d[3][0][0]),Me(d[3][d[3].length-1][3],d[0][0][0])],d.flat()];return n9(e,f,t),f}function r9(e,t=0){const n=t9(e,t);if(n)return n;const[i,r,s,o,a,l,c,d]=C6(e),u=e.roundness?ur(Math.abs(i-c),e):(i-c)*.01,f=e.roundness?ur(Math.abs(o-r),e):(o-r)*.01,[h,m,p,U]=[S(e.x+i,e.y+r),S(e.x+s,e.y+o),S(e.x+a,e.y+l),S(e.x+c,e.y+d)],b=[Hn(S(m[0]-u,m[1]-f),m,m,S(m[0]-u,m[1]+f)),Hn(S(p[0]+u,p[1]-f),p,p,S(p[0]-u,p[1]-f)),Hn(S(U[0]+u,U[1]+f),U,U,S(U[0]+u,U[1]-f)),Hn(S(h[0]-u,h[1]+f),h,h,S(h[0]+u,h[1]+f))],y=t>0?b.map(I=>j_(To(I,t))):[[b[0]],[b[1]],[b[2]],[b[3]]],v=[[Me(y[0][y[0].length-1][3],y[1][0][0]),Me(y[1][y[1].length-1][3],y[2][0][0]),Me(y[2][y[2].length-1][3],y[3][0][0]),Me(y[3][y[3].length-1][3],y[0][0][0])],y.flat()];return n9(e,v,t),v}const Jo=(e,t=1)=>{if(e.length>=3){const[n,i]=[e[0],e[e.length-1]];return ct(n,i)<=L2/t}return!1},ur=(e,t)=>{var n,i,r,s;if(((n=t.roundness)==null?void 0:n.type)===yn.PROPORTIONAL_RADIUS||((i=t.roundness)==null?void 0:i.type)===yn.LEGACY)return e*A8;if(((r=t.roundness)==null?void 0:r.type)===yn.ADAPTIVE_RADIUS){const o=((s=t.roundness)==null?void 0:s.value)??tse,a=o/A8;return e<=a?e*A8:o}return 0},Dn=e=>!!e&&e.type==="image"&&!!e.fileId,yt=e=>!!e&&e.type==="image",or=e=>!!e&&e.type==="embeddable",Zl=e=>!!e&&e.type==="iframe",Es=e=>!!e&&(e.type==="iframe"||e.type==="embeddable"),ge=e=>e!=null&&e.type==="text",az=e=>e!=null&&e.type==="frame",z2=e=>e!=null&&e.type==="magicframe",we=e=>e!=null&&(e.type==="frame"||e.type==="magicframe"),qi=e=>e!=null&&bae(e.type),bae=e=>e==="freedraw",xe=e=>e!=null&&s9(e.type),nn=e=>e!=null&&e.type==="line",Ce=e=>e!=null&&e.type==="arrow",me=e=>Ce(e)&&e.elbowed,yae=e=>Ce(e)&&!e.elbowed,Eae=e=>Ce(e)&&!e.elbowed&&!e.roundness,vae=e=>Ce(e)&&!e.elbowed&&e.roundness!==null,s9=e=>e==="arrow"||e==="line",Ga=(e,t=!0)=>e!=null&&(!e.locked||t===!0)&&D4(e.type),D4=e=>e==="arrow",ss=(e,t=!0)=>e!=null&&(!e.locked||t===!0)&&(e.type==="rectangle"||e.type==="diamond"||e.type==="ellipse"||e.type==="image"||e.type==="iframe"||e.type==="embeddable"||e.type==="frame"||e.type==="magicframe"||e.type==="text"&&!e.containerId),wae=e=>e!=null&&(e.type==="rectangle"||e.type==="diamond"||e.type==="image"||e.type==="iframe"||e.type==="embeddable"||e.type==="frame"||e.type==="magicframe"||e.type==="text"&&!e.containerId),eu=(e,t=!0)=>e!=null&&(!e.locked||t===!0)&&(e.type==="rectangle"||e.type==="diamond"||e.type==="ellipse"||Ce(e)),lz=e=>{const t=e==null?void 0:e.type;if(!t)return!1;switch(t){case"text":case"diamond":case"rectangle":case"iframe":case"embeddable":case"ellipse":case"arrow":case"freedraw":case"line":case"frame":case"magicframe":case"image":case"selection":return!0;default:return qo(t,null),!1}},oy=e=>e.type==="rectangle"||e.type==="ellipse"||e.type==="diamond",Li=e=>{var t;return eu(e)&&!!((t=e.boundElements)!=null&&t.some(({type:n})=>n==="text"))},Dt=e=>e!==null&&"containerId"in e&&e.containerId!==null&&ge(e),cz=e=>!!e.startBinding||!!e.endBinding,$u=e=>e==="rectangle"||e==="embeddable"||e==="iframe"||e==="image",dz=e=>e==="line"||e==="arrow"||e==="diamond",_ae=(e,t)=>!!((e===yn.ADAPTIVE_RADIUS||e===yn.LEGACY)&&$u(t.type)||e===yn.PROPORTIONAL_RADIUS&&dz(t.type)),Tae=e=>dz(e.type)?{type:yn.PROPORTIONAL_RADIUS}:$u(e.type)?{type:yn.ADAPTIVE_RADIUS}:null,Vh=e=>Object.hasOwn(e,"fixedPoint")&&e.fixedPoint!=null,dh=e=>Eae(e)?"sharpArrow":vae(e)?"curvedArrow":me(e)?"elbowArrow":"line",L4=e=>e.length>3&&Os(e[0],e[e.length-1]),uz=e=>e.length>3||e.length===3&&!Os(e[0],e[e.length-1]),$h={},f6=(e,t)=>{const n=$h[e]||($h[e]={height:t});return n.height=t,n},fz=e=>{$h[e]&&delete $h[e]},Iae=e=>{var t;return((t=$h[e])==null?void 0:t.height)??null},jn=(e,t,n)=>{const i=e.split(`
`).map(a=>a||" ").join(`
`),r=parseFloat(t),s=Aae(i,r,n);return{width:l9(i,t),height:s}},hz="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".toLocaleUpperCase(),gz=(e,t)=>{const n=Mae(e);return n===0?jn(hz.split("").join(`
`),e,t).width+$n*2:n+$n*2},o9=(e,t)=>jn("",e,t).width+$n*2,Sae=()=>l9(hz,mt({fontSize:Il,fontFamily:sd}))>0,Gh=e=>WB(e).replace(/\t/g,"        "),a9=e=>Gh(e).split(`
`),xae=e=>{const t=a9(e.text).length;return e.height/t/e.fontSize},Sp=(e,t)=>e*t,mz=(e,t)=>Sp(e,t)+$n*2;let P8;class Cae{constructor(){F(this,"canvas");this.canvas=document.createElement("canvas")}getLineWidth(t,n){const i=this.canvas.getContext("2d");return i.font=n,i.measureText(t).width}}const Uu=(e,t)=>(P8||(P8=new Cae),P8.getLineWidth(e,t)),l9=(e,t)=>{const n=a9(e);let i=0;return n.forEach(r=>{i=Math.max(i,Uu(r,t))}),i},Aae=(e,t,n)=>{const i=a9(e).length;return Sp(t,n)*i},xp=(()=>{const e={};return{calculate:(r,s)=>{const o=r.charCodeAt(0);if(e[s]||(e[s]=[]),!e[s][o]){const a=Uu(r,s);e[s][o]=a}return e[s][o]},getCache:r=>e[r],clearCache:r=>{e[r]=[]}}})(),Mae=e=>{const t=xp.getCache(e);if(!t)return 0;const n=t.filter(i=>i!==void 0);return Math.max(...n)};let F8,$U,B8;const kae=e=>(F8||(F8=Tt.class(...Object.values(Ia))),F8.test(e)),Rae=()=>{if(!$U)try{$U=Lae()}catch{$U=Dae()}return $U},c9=()=>(B8||(B8=Nae()),B8),ds={WHITESPACE:/\s/u,HYPHEN:/-/u,OPENING:/<\(\[\{/u,CLOSING:/>\)\]\}.,:;!\?\//u},Ia={CHAR:new RegExp("\\p{Script=Han}\\p{Script=Hiragana}\\p{Script=Katakana}\\p{Script=Hangul}","u"),OPENING://u,CLOSING://u,CURRENCY://u},bd={FLAG:new RegExp("\\p{RI}\\p{RI}","u"),JOINER:new RegExp("(?:\\p{Emoji_Modifier}|\\uFE0F\\u20E3?|[\\u{E0020}-\\u{E007E}]+\\u{E007F})?","u"),ZWJ:/\u200D/u,ANY:/[\p{Emoji}]/u,MOST:/[\p{Extended_Pictographic}\p{Emoji_Presentation}]/u},Dae=()=>Tt.or(c9(),wn.On(ds.HYPHEN,ds.WHITESPACE,Ia.CHAR)),Lae=()=>Tt.or(c9(),wn.Before(ds.WHITESPACE).Build(),wn.After(ds.WHITESPACE,ds.HYPHEN).Build(),wn.Before(Ia.CHAR,Ia.CURRENCY).NotPrecededBy(ds.OPENING,Ia.OPENING).Build(),wn.After(Ia.CHAR).NotFollowedBy(ds.HYPHEN,ds.CLOSING,Ia.CLOSING).Build(),wn.BeforeMany(Ia.OPENING).NotPrecededBy(ds.OPENING).Build(),wn.AfterMany(Ia.CLOSING).NotFollowedBy(ds.CLOSING).Build(),wn.AfterMany(ds.CLOSING).FollowedBy(ds.OPENING).Build()),Nae=()=>Tt.group(Tt.or(bd.FLAG,Tt.and(bd.MOST,bd.JOINER,Tt.build(`(?:${bd.ZWJ.source}(?:${bd.FLAG.source}|${bd.ANY.source}${bd.JOINER.source}))*`)))),Tt={build:e=>new RegExp(e,"u"),join:(...e)=>e.map(t=>t.source).join(""),and:(...e)=>Tt.build(Tt.join(...e)),or:(...e)=>Tt.build(e.map(t=>t.source).join("|")),group:(...e)=>Tt.build(`(${Tt.join(...e)})`),class:(...e)=>Tt.build(`[${Tt.join(...e)}]`)},wn={On:(...e)=>{const t=Tt.join(...e);return Tt.build(`([${t}])`)},Before:(...e)=>{const t=Tt.join(...e),n=()=>Tt.build(`(?=[${t}])`);return wn.Chain(n)},After:(...e)=>{const t=Tt.join(...e),n=()=>Tt.build(`(?<=[${t}])`);return wn.Chain(n)},BeforeMany:(...e)=>{const t=Tt.join(...e),n=()=>Tt.build(`(?<![${t}])(?=[${t}])`);return wn.Chain(n)},AfterMany:(...e)=>{const t=Tt.join(...e),n=()=>Tt.build(`(?<=[${t}])(?![${t}])`);return wn.Chain(n)},NotBefore:(...e)=>{const t=Tt.join(...e),n=()=>Tt.build(`(?![${t}])`);return wn.Chain(n)},NotAfter:(...e)=>{const t=Tt.join(...e),n=()=>Tt.build(`(?<![${t}])`);return wn.Chain(n)},Chain:e=>({Build:e,PreceededBy:(...t)=>{const n=e(),i=wn.After(...t).Build(),r=()=>Tt.and(i,n);return wn.Chain(r)},FollowedBy:(...t)=>{const n=e(),i=wn.Before(...t).Build(),r=()=>Tt.and(n,i);return wn.Chain(r)},NotPrecededBy:(...t)=>{const n=e(),i=wn.NotAfter(...t).Build(),r=()=>Tt.and(i,n);return wn.Chain(r)},NotFollowedBy:(...t)=>{const n=e(),i=wn.NotBefore(...t).Build(),r=()=>Tt.and(n,i);return wn.Chain(r)}})},Oae=e=>{const t=Rae();return e.normalize("NFC").split(t).filter(Boolean)},ad=(e,t,n)=>{if(!Number.isFinite(n)||n<0)return e;const i=[],r=e.split(`
`);for(const s of r){if(Uu(s,t)<=n){i.push(s);continue}const a=Pae(s,t,n);i.push(...a)}return i.join(`
`)},Pae=(e,t,n)=>{const i=[],s=Oae(e)[Symbol.iterator]();let o="",a=0,l=s.next();for(;!l.done;){const c=l.value,d=o+c,u=zae(c)?a+xp.calculate(c,t):Uu(d,t);if(/\s/.test(c)||u<=n){o=d,a=u,l=s.next();continue}if(o)i.push(o.trimEnd()),o="",a=0;else{const f=Fae(c,t,n),h=f[f.length-1]??"",m=f.slice(0,-1);i.push(...m),o=h,a=Uu(h,t),l=s.next()}}if(o){const c=Bae(o,t,n);i.push(c)}return i},Fae=(e,t,n)=>{if(c9().test(e))return[e];const i=[],r=Array.from(e);let s="",o=0;for(const a of r){const l=xp.calculate(a,t),c=o+l;if(c<=n){s=s+a,o=c;continue}s&&i.push(s),s=a,o=l}return s&&i.push(s),i},Bae=(e,t,n)=>{if(!(Uu(e,t)>n))return e;let[,r,s]=e.match(/^(.+?)(\s+)$/)??[e,e.trimEnd(),""],o=Uu(r,t);for(const a of Array.from(s)){const l=xp.calculate(a,t),c=o+l;if(c>n)break;r=r+a,o=c}return r},zae=e=>e.codePointAt(0)!==void 0&&e.codePointAt(1)===void 0,Qi=(e,t,n)=>{const i=n.getNonDeletedElementsMap();let r;const s={x:e.x,y:e.y,text:e.text,width:e.width,height:e.height,angle:t?Ce(t)?0:t.angle:e.angle};s.text=e.text,(t||!e.autoResize)&&(r=t?ta(t,e):e.width,s.text=ad(e.originalText,mt(e),r));const o=jn(s.text,mt(e),e.lineHeight);if(e.autoResize&&(s.width=o.width),s.height=o.height,t){const a=Ap(t,e),l=ta(t,e);if(!Ce(t)&&o.height>a){const f=bu(o.height,t.type);n.mutateElement(t,{height:f}),f6(t.id,f)}if(o.width>l){const f=bu(o.width,t.type);n.mutateElement(t,{width:f})}const c={...e,...s},{x:d,y:u}=ld(t,c,i);s.x=d,s.y=u}n.mutateElement(e,s)},Cp=(e,t,n,i=!1)=>{const r=t.getNonDeletedElementsMap();if(!ea(e))return;fz(e.id);const o=Le(e,r);if(o&&o.text){if(!e)return;let a=o.text,l=o.height,c=o.width;const d=ta(e,o),u=Ap(e,o);let f=e.height;if(i||n!=="n"&&n!=="s"){a&&(a=ad(o.originalText,mt(o),d));const h=jn(a,mt(o),o.lineHeight);l=h.height,c=h.width}if(l>u){f=bu(l,e.type);const h=f-e.height,m=!Ce(e)&&(n==="ne"||n==="nw"||n==="n")?e.y-h:e.y;t.mutateElement(e,{height:f,y:m})}t.mutateElement(o,{text:a,width:c,height:l}),Ce(e)||t.mutateElement(o,ld(e,o,r))}},ld=(e,t,n)=>{if(Ce(e))return pe.getBoundTextElementPosition(e,t,n);const i=Hae(e),r=Ap(e,t),s=ta(e,t);let o,a;t.verticalAlign===Yr.TOP?a=i.y:t.verticalAlign===Yr.BOTTOM?a=i.y+(r-t.height):a=i.y+(r/2-t.height/2),t.textAlign===dm.LEFT?o=i.x:t.textAlign===dm.RIGHT?o=i.x+(s-t.width):o=i.x+(s/2-t.width/2);const l=e.angle??0;if(l!==0){const c=S(i.x+s/2,i.y+r/2),d=S(o+t.width/2,a+t.height/2),[u,f]=Q(d,c,l);return{x:u-t.width/2,y:f-t.height/2}}return{x:o,y:a}},ea=e=>{var t,n,i;return(t=e==null?void 0:e.boundElements)!=null&&t.length&&((i=(n=e==null?void 0:e.boundElements)==null?void 0:n.find(r=>r.type==="text"))==null?void 0:i.id)||null},Le=(e,t)=>{if(!e)return null;const n=ea(e);return n&&t.get(n)||null},Yn=(e,t)=>e&&e.containerId&&t.get(e.containerId)||null,z8=(e,t,n)=>{if(!Ce(e))return{x:e.x+e.width/2,y:e.y+e.height/2};if(pe.getPointsGlobalCoordinates(e,n).length%2===1){const o=Math.floor(e.points.length/2),a=pe.getPointGlobalCoordinates(e,e.points[o],n);return{x:a[0],y:a[1]}}const r=e.points.length/2-1;let s=pe.getEditorMidPoints(e,n,t)[r];return s||(s=pe.getSegmentMidPoint(e,r+1)),{x:s[0],y:s[1]}},Hae=e=>{let t=$n,n=$n;return e.type==="ellipse"&&(t+=e.width/2*(1-Math.sqrt(2)/2),n+=e.height/2*(1-Math.sqrt(2)/2)),e.type==="diamond"&&(t+=e.width/4,n+=e.height/4),{x:e.x+t,y:e.y+n}},Vae=(e,t)=>Ce(t)?0:t?t.angle:e.angle,pz=(e,t)=>e.some(n=>{if(Dt(n)){const i=Yn(n,t);return!Ce(i)}return!1}),Uz=(e,t)=>e.some(n=>{if(Dt(n)){const i=Yn(n,t);return!Ce(i)}return ge(n)}),$ae=new Set(["rectangle","ellipse","diamond","arrow"]),Gae=e=>$ae.has(e.type),bu=(e,t)=>{e=Math.ceil(e);const n=$n*2;return t==="ellipse"?Math.round((e+n)/Math.sqrt(2)*2):t==="arrow"?e+n*8:t==="diamond"?2*(e+n):e+n},ta=(e,t)=>{const{width:n}=e;if(Ce(e)){const i=((t==null?void 0:t.fontSize)??Il)*Jre;return Math.max(Qre*n,i)}return e.type==="ellipse"?Math.round(n/2*Math.sqrt(2))-$n*2:e.type==="diamond"?Math.round(n/2)-$n*2:n-$n*2},Ap=(e,t)=>{const{height:n}=e;return Ce(e)?n-$n*8*2<=0?t.height:n:e.type==="ellipse"?Math.round(n/2*Math.sqrt(2))-$n*2:e.type==="diamond"?Math.round(n/2)-$n*2:n-$n*2},bz=(e,t=`

`)=>e.reduce((i,r)=>(ge(r)&&i.push(r.text),i),[]).join(t),Mp=(e,t,n)=>{switch(e.type){case"selection":case"rectangle":case"image":case"text":case"iframe":case"embeddable":case"frame":case"magicframe":return Xae(e,t,n);case"diamond":return jae(e,t,n);case"ellipse":return Yae(e,t,n);case"line":case"arrow":case"freedraw":return Wae(e,n)}},Xae=(e,t,n)=>{const i=oi(e,t),r=Q(n,i,-e.angle),[s,o]=i9(e);return Math.min(...s.map(a=>lc(r,a)),...o.map(a=>G_(a,r)).filter(a=>a!==null))},jae=(e,t,n)=>{const i=oi(e,t),r=Q(n,i,-e.angle),[s,o]=r9(e);return Math.min(...s.map(a=>lc(r,a)),...o.map(a=>G_(a,r)).filter(a=>a!==null))},Yae=(e,t,n)=>{const i=oi(e,t);return Lse(Q(n,i,-e.angle),OB(i,e.width/2,e.height/2))},Wae=(e,t)=>{const[n,i]=u6(e);return Math.min(...n.map(r=>lc(t,r)),...i.map(r=>G_(r,t)))},h6=e=>{if(e.type==="arrow")return!1;const t=!Ir(e.backgroundColor)||Li(e)||Es(e)||ge(e);return e.type==="line"||e.type==="freedraw"?t&&Jo(e.points):t||yt(e)},Tf=({point:e,element:t,threshold:n,elementsMap:i,frameNameBound:r=null})=>{const s=r?fm(S(r.x-n,r.y-n),e,S(r.x+r.width+n,r.y+r.height+n)):!1,o=si(t,i,!0);return!fm(S(o[0]-n,o[1]-n),Q(e,Sg(o),-t.angle),S(o[2]+n,o[3]+n))&&!s?!1:h6(t)&&d9(e,t,i)||XA(e,t,i,n)||s},ay=(e,t,n,i=0)=>{let[r,s,o,a]=si(t,n);return r-=i,s-=i,o+=i,a+=i,fm(S(r,s),e,S(o,a))},Kae=(e,t)=>!Tf(e)&&!yz(e.point,e.element,t)&&ay(e.point,e.element,t),yz=(e,t,n)=>{const i=Le(t,n);if(!i)return!1;const r=xe(t)?{...i,...pe.getBoundTextElementPosition(t,i,n)}:i;return d9(e,r,n)},Xo=(e,t,n,i=0,r=!1)=>{const s=[Math.min(n[0][0]-i,n[1][0]-i),Math.min(n[0][1]-i,n[1][1]-i),Math.max(n[0][0]+i,n[1][0]+i),Math.max(n[0][1]+i,n[1][1]+i)],o=si(e,t);if(!Gu(s,o))return[];switch(e.type){case"rectangle":case"image":case"text":case"iframe":case"embeddable":case"frame":case"selection":case"magicframe":return qae(e,t,n,i,r);case"diamond":return Qae(e,t,n,i,r);case"ellipse":return Jae(e,t,n,i);case"line":case"freedraw":case"arrow":return Zae(e,n,r)}},Ez=(e,t,n,i,r,s=!1)=>{for(const o of e){const a=C9(o[0],o[1],o[2],o[3]),l=[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1]),Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])];if(!Gu(a,l))continue;const c=NB(o,t);if(c.length>0){for(const d of c)n.push(Q(d,i,r));if(s)return n}}return n},vz=(e,t,n,i,r,s=!1)=>{for(const o of e){const a=hm(o,t);if(a&&(n.push(Q(a,i,r)),s))return n}return n},Zae=(e,t,n=!1)=>{const[i,r]=u6(e),s=[];for(const o of i){const a=hm(o,t);if(a&&(s.push(a),n))return s}for(const o of r){const a=C9(o[0],o[1],o[2],o[3]),l=[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1]),Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])];if(!Gu(a,l))continue;const c=NB(o,t);if(c.length>0&&(s.push(...c),n))return s}return s},qae=(e,t,n,i=0,r=!1)=>{const s=oi(e,t),o=Q(n[0],s,-e.angle),a=Q(n[1],s,-e.angle),l=Me(o,a),[c,d]=i9(e,i),u=[];return vz(c,l,u,s,e.angle,r),r&&u.length>0||Ez(d,l,u,s,e.angle,r),u},Qae=(e,t,n,i=0,r=!1)=>{const s=oi(e,t),o=Q(n[0],s,-e.angle),a=Q(n[1],s,-e.angle),l=Me(o,a),[c,d]=r9(e,i),u=[];return vz(c,l,u,s,e.angle,r),r&&u.length>0||Ez(d,l,u,s,e.angle,r),u},Jae=(e,t,n,i=0)=>{const r=oi(e,t),s=Q(n[0],r,-e.angle),o=Q(n[1],r,-e.angle);return Nse(OB(r,e.width/2+i,e.height/2+i),Me(s,o)).map(a=>Q(a,r,e.angle))},XA=(e,t,n,i=1)=>Mp(t,n,e)<=i,d9=(e,t,n)=>{if((xe(t)||qi(t))&&!Jo(t.points))return!1;const[i,r,s,o]=si(t,n);if(!fm(S(i,r),e,S(s,o)))return!1;const a=S((i+s)/2,(r+o)/2),l=Ei(In(es(he(e,a,.1)),Math.max(t.width,t.height)*2),a),c=Me(e,l);return Xo(t,n,c).filter((u,f,h)=>h.findIndex(m=>Os(m,u))===f).length%2===1},Vn=[1,0],cr=[0,1],vs=[-1,0],to=[0,-1],Xh=e=>{const[t,n]=e,i=Math.abs(t),r=Math.abs(n);return t>r?Vn:t<=-r?vs:n>i?cr:to},Br=(e,t)=>Xh(he(e,t)),Oa=(e,t)=>Fo(Br(e,t)),Gn=(e,t)=>e[0]===t[0]&&e[1]===t[1],Fo=e=>Gn(e,Vn)||Gn(e,vs),ele=(e,t,n)=>{const i=Sg(t),r=.95,s=Ei(In(he(Q(S(e.x+e.width/2,e.y),i,e.angle),i),r),i),o=Ei(In(he(Q(S(e.x+e.width,e.y+e.height/2),i,e.angle),i),r),i),a=Ei(In(he(Q(S(e.x+e.width/2,e.y+e.height),i,e.angle),i),r),i),l=Ei(In(he(Q(S(e.x,e.y+e.height/2),i,e.angle),i),r),i);if(bt(he(n,s),he(s,o))<=0&&bt(he(n,s),he(s,l))>0)return Br(s,i);if(bt(he(n,o),he(o,a))<=0&&bt(he(n,o),he(o,s))>0)return Br(o,i);if(bt(he(n,a),he(a,l))<=0&&bt(he(n,a),he(a,o))>0)return Br(a,i);if(bt(he(n,l),he(l,s))<=0&&bt(he(n,l),he(l,a))>0)return Br(l,i);if(bt(he(n,i),he(s,i))<=0&&bt(he(n,i),he(o,i))>0){const d=e.width>e.height?s:o;return Br(d,i)}else if(bt(he(n,i),he(o,i))<=0&&bt(he(n,i),he(a,i))>0){const d=e.width>e.height?a:o;return Br(d,i)}else if(bt(he(n,i),he(a,i))<=0&&bt(he(n,i),he(l,i))>0){const d=e.width>e.height?a:l;return Br(d,i)}const c=e.width>e.height?s:l;return Br(c,i)},u9=(e,t,n)=>{const r=Sg(t);if(e.type==="diamond")return ele(e,t,n);const s=z1(S(t[0],t[1]),r,2),o=z1(S(t[2],t[1]),r,2),a=z1(S(t[0],t[3]),r,2),l=z1(S(t[2],t[3]),r,2);return D8([s,o,r],n)?to:D8([o,l,r],n)?Vn:D8([l,a,r],n)?cr:vs},wz=e=>[e[0]===0?0:e[0]>0?-1:1,e[1]===0?0:e[1]>0?-1:1],f9=1,Mn=40,tle=(e,t)=>{const n=e.fixedSegments?e.fixedSegments.slice():null;if(n){const i=[];e.points.map(o=>S(e.x+o[0],e.y+o[1])).forEach((o,a,l)=>{if(a<2)return i.push(o);const c=Br(o,l[a-1]),d=Br(l[a-1],l[a-2]);if(Gn(c,d)){const u=(n==null?void 0:n.findIndex(h=>h.index===a-1))??-1,f=(n==null?void 0:n.findIndex(h=>h.index===a))??-1;f!==-1&&(n[f].start=S(l[a-2][0]-e.x,l[a-2][1]-e.y)),u!==-1&&n.splice(u,1),i.splice(-1,1),n.forEach(h=>{h.index>a-1&&(h.index-=1)})}return i.push(o)});const r=[];i.forEach((o,a,l)=>{if(a<3)return r.push(o);if(ct(l[a-2],l[a-1])<f9){const c=(n==null?void 0:n.findIndex(f=>f.index===a-2))??-1,d=(n==null?void 0:n.findIndex(f=>f.index===a-1))??-1;d!==-1&&n.splice(d,1),c!==-1&&n.splice(c,1),r.splice(-2,2),n.forEach(f=>{f.index>a-2&&(f.index-=2)});const u=Oa(o,l[a-1]);return r.push(S(u?o[0]:l[a-2][0],u?l[a-2][1]:o[1]))}r.push(o)});const s=n.filter(o=>o.index!==1&&o.index!==r.length-1);return s.length===0?Ja(m9(p9(g9(e,h9(e,t,r.map(o=>S(o[0]-e.x,o[1]-e.y))))??[])),s,null,null):Ja(r,s,e.startIsSpecial,e.endIsSpecial)}return{x:e.x,y:e.y,points:e.points,fixedSegments:e.fixedSegments,startIsSpecial:e.startIsSpecial,endIsSpecial:e.endIsSpecial}},nle=(e,t,n)=>{var k,x;const i=t.map(D=>D.index),s=(((k=e.fixedSegments)==null?void 0:k.map(D=>D.index))??[]).findIndex(D=>!i.includes(D));if(s===-1||!((x=e.fixedSegments)!=null&&x[s]))return{points:e.points};const o=e.fixedSegments[s].index,a=e.fixedSegments[s-1],l=e.fixedSegments[s+1],c=e.x+(a?a.end[0]:0),d=e.y+(a?a.end[1]:0),u=a?null:e.startBinding,f=l?null:e.endBinding,{startHeading:h,endHeading:m,startGlobalPoint:p,endGlobalPoint:U,hoveredStartElement:b,hoveredEndElement:y,...w}=h9({x:c,y:d,startBinding:u,endBinding:f,startArrowhead:null,endArrowhead:null,points:e.points},n,[S(0,0),S(e.x+((l==null?void 0:l.start[0])??e.points[e.points.length-1][0])-c,e.y+((l==null?void 0:l.start[1])??e.points[e.points.length-1][1])-d)],{isDragging:!1}),{points:v}=Ja(m9(p9(g9(e,{startHeading:h,endHeading:m,startGlobalPoint:p,endGlobalPoint:U,hoveredEndElement:y,...w})??[])),t,null,null);if(!v||v.length<2)throw new Error("Property 'points' is required in the update returned by normalizeArrowElementUpdate()");const I=[];if(a)for(let D=0;D<a.index;D++)I.push(S(e.x+e.points[D][0],e.y+e.points[D][1]));if(v.forEach(D=>{I.push(S(e.x+(a?a.end[0]:0)+D[0],e.y+(a?a.end[1]:0)+D[1]))}),l)for(let D=l.index;D<e.points.length;D++)I.push(S(e.x+e.points[D][0],e.y+e.points[D][1]));const C=((l==null?void 0:l.index)??e.points.length)-((a==null?void 0:a.index)??0)-1,_=t.map(D=>D.index>o?{...D,index:D.index-C+(v.length-1)}:D),T=I.flatMap((D,O)=>{const L=I[O-1],Y=I[O+1];if(L&&Y){const $=Br(D,L),H=Br(Y,D);if(Gn($,H))return _.forEach(z=>{z.index>O&&(z.index-=1)}),[];if(Gn($,wz(H)))return _.forEach(z=>{z.index>O&&(z.index+=1)}),[D,D]}return[D]});return Ja(T,_,!1,!1)},ile=(e,t,n,i,r,s)=>{var I,C;const o=t.map((_,T)=>e.fixedSegments==null||e.fixedSegments[T]===void 0||e.fixedSegments[T].index!==_.index||(_.start[0]!==e.fixedSegments[T].start[0]&&_.end[0]!==e.fixedSegments[T].end[0])!=(_.start[1]!==e.fixedSegments[T].start[1]&&_.end[1]!==e.fixedSegments[T].end[1])?T:null).filter(_=>_!==null).shift();if(o==null)return{points:e.points};const a=((I=e.fixedSegments)==null?void 0:I.findIndex(_=>_.index===1))??-1,l=((C=e.fixedSegments)==null?void 0:C.findIndex(_=>_.index===e.points.length-1))??-1,c=ct(t[o].start,t[o].end),d=c<Mn+5;if(a===-1&&t[o].index===1&&r){const _=Fo(n),k=(_?Gn(n,Vn):Gn(n,cr))?d?c/2:Mn:d?-c/2:-40;t[o].start=S(t[o].start[0]+(_?k:0),t[o].start[1]+(_?0:k))}if(l===-1&&t[o].index===e.points.length-1&&s){const _=Fo(i),k=(_?Gn(i,Vn):Gn(i,cr))?d?c/2:Mn:d?-c/2:-40;t[o].end=S(t[o].end[0]+(_?k:0),t[o].end[1]+(_?0:k))}const u=t.map(_=>({..._,start:S(e.x+_.start[0],e.y+_.start[1]),end:S(e.x+_.end[0],e.y+_.end[1])})),f=e.points.map((_,T)=>S(e.x+_[0],e.y+_[1])),h=u[o].index-1,m=u[o].index,p=u[o].start,U=u[o].end,b=f[h-1]&&!Os(f[h],f[h-1])?Oa(f[h-1],f[h]):void 0,y=f[m+1]&&!Os(f[m],f[m+1])?Oa(f[m+1],f[m]):void 0;if(b!==void 0){const _=b?1:0;f[h-1][_]=p[_]}if(f[h]=p,f[m]=U,y!==void 0){const _=y?1:0;f[m+1][_]=U[_]}const w=u.findIndex(_=>_.index===h);if(w!==-1){const _=Oa(u[w].end,u[w].start)?1:0;u[w].start[_]=p[_],u[w].end=p}const v=u.findIndex(_=>_.index===m+1);if(v!==-1){const _=Oa(u[v].end,u[v].start)?1:0;u[v].end[_]=U[_],u[v].start=U}if(a===-1&&h===0){const _=r?Fo(n):Oa(f[1],f[0]);f.unshift(S(_?p[0]:e.x+e.points[0][0],_?e.y+e.points[0][1]:p[1])),r&&f.unshift(S(e.x+e.points[0][0],e.y+e.points[0][1]));for(const T of u)T.index+=r?2:1}if(l===-1&&m===e.points.length-1){const _=Fo(i);f.push(S(_?U[0]:e.x+e.points[e.points.length-1][0],_?e.y+e.points[e.points.length-1][1]:U[1])),s&&f.push(S(e.x+e.points[e.points.length-1][0],e.y+e.points[e.points.length-1][1]))}return Ja(f,u.map(_=>({..._,start:S(_.start[0]-e.x,_.start[1]-e.y),end:S(_.end[0]-e.x,_.end[1]-e.y)})),!1,!1)},rle=(e,t,n,i,r,s,o,a,l)=>{let c=e.startIsSpecial??null,d=e.endIsSpecial??null;const u=t.map((U,b)=>b===0||b===t.length-1?S(e.x+U[0],e.y+U[1]):S(e.x+e.points[b][0],e.y+e.points[b][1])),f=n.map(U=>({...U,start:S(e.x+(U.start[0]-t[0][0]),e.y+(U.start[1]-t[0][1])),end:S(e.x+(U.end[0]-t[0][0]),e.y+(U.end[1]-t[0][1]))})),h=[],m=2+(c?1:0),p=2+(d?1:0);for(;h.length+m<u.length-p;)h.push(u[h.length+m]);{const U=u.at(c?2:1),b=u.at(c?3:2);if(!U||!b)throw new Error(`Second and third points must exist when handling endpoint drag (${c})`);const y=Fo(i),w=Fo(Xh(he(U,b)));if(a&&y===w){const v=y?Gn(i,Vn):Gn(i,cr);if(h.unshift(S(w?s[0]+(v?Mn:-40):b[0],w?b[1]:s[1]+(v?Mn:-40))),h.unshift(S(y?s[0]+(v?Mn:-40):s[0],y?s[1]:s[1]+(v?Mn:-40))),!c){c=!0;for(const I of f)I.index>1&&(I.index+=1)}}else if(h.unshift(S(w?s[0]:U[0],w?U[1]:s[1])),c){c=!1;for(const v of f)v.index>1&&(v.index-=1)}h.unshift(s)}{const U=u.at(u.length-(d?3:2)),b=u.at(u.length-(d?4:3));if(!U||!b)throw new Error(`Second and third to last points must exist when handling endpoint drag (${d})`);const y=Fo(r),w=Oa(b,U);if(l&&y===w){const v=y?Gn(r,Vn):Gn(r,cr);h.push(S(w?o[0]+(v?Mn:-40):b[0],w?b[1]:o[1]+(v?Mn:-40))),h.push(S(y?o[0]+(v?Mn:-40):o[0],y?o[1]:o[1]+(v?Mn:-40))),d||(d=!0)}else h.push(S(w?o[0]:U[0],w?U[1]:o[1])),d&&(d=!1)}return h.push(o),Ja(h,f.map(({index:U})=>({index:U,start:h[U-1],end:h[U]})).map(U=>({...U,start:S(U.start[0]-s[0],U.start[1]-s[1]),end:S(U.end[0]-s[0],U.end[1]-s[1])})),c,d)},GU=1e6,_g=(e,t,n,i)=>{var I;if(e.points.length<2)return{points:n.points??e.points};const r=n.fixedSegments??e.fixedSegments??[],s=n.points?n.points&&n.points.length===2?e.points.map((C,_)=>_===0?n.points[0]:_===e.points.length-1?n.points[1]:C):n.points.slice():e.points.slice(),{startBinding:o,endBinding:a,...l}=n,c=typeof o<"u"?o:e.startBinding,d=typeof a<"u"?a:e.endBinding,u=c&&g6(c.elementId,t),f=d&&g6(d.elementId,t),h=Tz(s);if(c&&!u&&h||d&&!f&&h||t.size===0&&h||Object.keys(l).length===0&&((u==null?void 0:u.id)!==(c==null?void 0:c.elementId)||(f==null?void 0:f.id)!==(d==null?void 0:d.elementId)))return Ja(s.map(C=>S(e.x+C[0],e.y+C[1])),e.fixedSegments,e.startIsSpecial,e.endIsSpecial);const{startHeading:m,endHeading:p,startGlobalPoint:U,endGlobalPoint:b,hoveredStartElement:y,hoveredEndElement:w,...v}=h9({x:e.x,y:e.y,startBinding:c,endBinding:d,startArrowhead:e.startArrowhead,endArrowhead:e.endArrowhead,points:e.points},t,s,i);return t.size===0&&h?Ja(s.map(C=>S(e.x+C[0],e.y+C[1])),e.fixedSegments,e.startIsSpecial,e.endIsSpecial):!n.points&&!n.fixedSegments&&!n.startBinding&&!n.endBinding?tle(e,t):n.startBinding===e.startBinding&&n.endBinding===e.endBinding&&(n.points??[]).every((C,_)=>Os(C,e.points[_]??S(1/0,1/0)))&&h?{}:r.length===0?Ja(m9(p9(g9(e,{startHeading:m,endHeading:p,startGlobalPoint:U,endGlobalPoint:b,hoveredEndElement:w,...v})??[])),r,null,null):(((I=e.fixedSegments)==null?void 0:I.length)??0)>r.length?nle(e,r,t):n.points?n.points&&n.fixedSegments?n:rle(e,s,r,m,p,U,b,y,w):ile(e,r,m,p,y,w)},h9=(e,t,n,i)=>{var I,C;const r=t6(n[0],pn(e.x,e.y)),s=t6(n[n.length-1],pn(e.x,e.y));let o=null,a=null;if(i!=null&&i.isDragging){const _=Array.from(t.values());o=KA(r,t,_,i==null?void 0:i.zoom)||null,a=KA(s,t,_,i==null?void 0:i.zoom)||null}else o=e.startBinding&&g6(e.startBinding.elementId,t)||null,a=e.endBinding&&g6(e.endBinding.elementId,t)||null;const l=YA({...e,type:"arrow",elbowed:!0,points:n},"start",(I=e.startBinding)==null?void 0:I.fixedPoint,r,o,t,i==null?void 0:i.isDragging),c=YA({...e,type:"arrow",elbowed:!0,points:n},"end",(C=e.endBinding)==null?void 0:C.fixedPoint,s,a,t,i==null?void 0:i.isDragging),d=WA(l,c,o,r,t),u=WA(c,l,a,s,t),f=[l[0]-2,l[1]-2,l[0]+2,l[1]+2],h=[c[0]-2,c[1]-2,c[0]+2,c[1]+2],m=o?Sa(o,t,Ol(d,e.startArrowhead?Rt*6:Rt*2,1)):f,p=a?Sa(a,t,Ol(u,e.endArrowhead?Rt*6:Rt*2,1)):h,U=ym(l,a?Sa(a,t,Ol(u,Mn,Mn)):h)||ym(c,o?Sa(o,t,Ol(d,Mn,Mn)):f),b=_z(U?[f,h]:[m,p]),y=ale(U?f:m,U?h:p,b,U?Ol(d,!o&&!a?0:Mn,0):Ol(d,!o&&!a?0:Mn-(e.startArrowhead?Rt*6:Rt*2),Mn),U?Ol(u,!o&&!a?0:Mn,0):Ol(u,!o&&!a?0:Mn-(e.endArrowhead?Rt*6:Rt*2),Mn),U,o&&Sa(o,t),a&&Sa(a,t)),w=jA(y[0],d,l),v=jA(y[1],u,c);return{dynamicAABBs:y,startDonglePosition:w,startGlobalPoint:l,startHeading:d,endDonglePosition:v,endGlobalPoint:c,endHeading:u,commonBounds:b,hoveredStartElement:o,hoveredEndElement:a,boundsOverlap:U,startElementBounds:m,endElementBounds:p}},g9=(e,t)=>{const{dynamicAABBs:n,startDonglePosition:i,startGlobalPoint:r,startHeading:s,endDonglePosition:o,endGlobalPoint:a,endHeading:l,commonBounds:c,hoveredEndElement:d}=t,u=lle(n,i||r,s,o||a,l,c),f=i&&XU(i,u),h=o&&XU(o,u),m=XU(a,u);m&&d&&(m.closed=!0);const p=XU(r,u);p&&e.startBinding&&(p.closed=!0);const U=f&&h&&(ym(f.pos,n[1])||ym(h.pos,n[0])),b=sle(f||p,h||m,u,s||Vn,l||Vn,U?[]:n);if(b){const y=b.map(w=>[w.pos[0],w.pos[1]]);return f&&y.unshift(r),h&&y.push(a),y}return null},Ol=(e,t,n)=>{switch(e){case to:return[t,n,n,n];case Vn:return[n,t,n,n];case cr:return[n,n,t,n]}return[n,n,n,t]},sle=(e,t,n,i,r,s)=>{const o=H8(e.pos,t.pos),a=new dre(l=>l.f);for(a.push(e);a.size()>0;){const l=a.pop();if(!l||l.closed)continue;if(l===t)return ole(e,l);l.closed=!0;const c=dle(l.addr,n);for(let d=0;d<4;d++){const u=c[d];if(!u||u.closed)continue;const f=z1(u.pos,l.pos,.5);if(loe(...s.map(v=>ym(f,v))))continue;const h=ule(d),m=l.parent?Xh(he(l.pos,l.parent.pos)):i,p=wz(m);if(Gn(p,h)||ZA(e.addr,u.addr)&&Gn(h,i)||ZA(t.addr,u.addr)&&Gn(h,r))continue;const b=m!==h,y=l.g+H8(u.pos,l.pos)+(b?Math.pow(o,3):0),w=u.visited;if(!w||y<u.g){const v=cle(u,t,h,r);u.visited=!0,u.parent=l,u.h=H8(t.pos,u.pos)+v*Math.pow(o,2),u.g=y,u.f=u.g+u.h,w?a.rescoreElement(u):a.push(u)}}}return null},ole=(e,t)=>{let n=t;const i=[];for(;n.parent;)i.unshift(n),n=n.parent;return i.unshift(e),i},H8=(e,t)=>Math.abs(e[0]-t[0])+Math.abs(e[1]-t[1]),ale=(e,t,n,i,r,s,o,a)=>{const l=o??e,c=a??t,[d,u,f,h]=i??[0,0,0,0],[m,p,U,b]=r??[0,0,0,0],y=[e[0]>t[2]?e[1]>t[3]||e[3]<t[1]?Math.min((l[0]+c[2])/2,e[0]-h):(l[0]+c[2])/2:e[0]>t[0]?e[0]-h:n[0]-h,e[1]>t[3]?e[0]>t[2]||e[2]<t[0]?Math.min((l[1]+c[3])/2,e[1]-d):(l[1]+c[3])/2:e[1]>t[1]?e[1]-d:n[1]-d,e[2]<t[0]?e[1]>t[3]||e[3]<t[1]?Math.max((l[2]+c[0])/2,e[2]+u):(l[2]+c[0])/2:e[2]<t[2]?e[2]+u:n[2]+u,e[3]<t[1]?e[0]>t[2]||e[2]<t[0]?Math.max((l[3]+c[1])/2,e[3]+f):(l[3]+c[1])/2:e[3]<t[3]?e[3]+f:n[3]+f],w=[t[0]>e[2]?t[1]>e[3]||t[3]<e[1]?Math.min((c[0]+l[2])/2,t[0]-b):(c[0]+l[2])/2:t[0]>e[0]?t[0]-b:n[0]-b,t[1]>e[3]?t[0]>e[2]||t[2]<e[0]?Math.min((c[1]+l[3])/2,t[1]-m):(c[1]+l[3])/2:t[1]>e[1]?t[1]-m:n[1]-m,t[2]<e[0]?t[1]>e[3]||t[3]<e[1]?Math.max((c[2]+l[0])/2,t[2]+p):(c[2]+l[0])/2:t[2]<e[2]?t[2]+p:n[2]+p,t[3]<e[1]?t[0]>e[2]||t[2]<e[0]?Math.max((c[3]+l[1])/2,t[3]+U):(c[3]+l[1])/2:t[3]<e[3]?t[3]+U:n[3]+U],v=_z([y,w]);if(!s&&y[2]-y[0]+w[2]-w[0]>v[2]-v[0]+1e-11&&y[3]-y[1]+w[3]-w[1]>v[3]-v[1]+1e-11){const[I,C]=[(w[0]+w[2])/2,(w[1]+w[3])/2];if(t[0]>e[2]&&e[1]>t[3]){const _=y[2]+(w[0]-y[2])/2,T=w[3]+(y[1]-w[3])/2;return bt(pn(e[2]-I,e[1]-C),pn(e[0]-I,e[3]-C))>0?[[y[0],y[1],_,y[3]],[_,w[1],w[2],w[3]]]:[[y[0],T,y[2],y[3]],[w[0],w[1],w[2],T]]}else if(e[2]<t[0]&&e[3]<t[1]){const _=y[2]+(w[0]-y[2])/2,T=y[3]+(w[1]-y[3])/2;return bt(pn(e[0]-I,e[1]-C),pn(e[2]-I,e[3]-C))>0?[[y[0],y[1],y[2],T],[w[0],T,w[2],w[3]]]:[[y[0],y[1],_,y[3]],[_,w[1],w[2],w[3]]]}else if(e[0]>t[2]&&e[3]<t[1]){const _=w[2]+(y[0]-w[2])/2,T=y[3]+(w[1]-y[3])/2;return bt(pn(e[2]-I,e[1]-C),pn(e[0]-I,e[3]-C))>0?[[_,y[1],y[2],y[3]],[w[0],w[1],_,w[3]]]:[[y[0],y[1],y[2],T],[w[0],T,w[2],w[3]]]}else if(e[0]>t[2]&&e[1]>t[3]){const _=w[2]+(y[0]-w[2])/2,T=w[3]+(y[1]-w[3])/2;return bt(pn(e[0]-I,e[1]-C),pn(e[2]-I,e[3]-C))>0?[[_,y[1],y[2],y[3]],[w[0],w[1],_,w[3]]]:[[y[0],T,y[2],y[3]],[w[0],w[1],w[2],T]]}}return[y,w]},lle=(e,t,n,i,r,s)=>{const o=new Set,a=new Set;n===vs||n===Vn?a.add(t[1]):o.add(t[0]),r===vs||r===Vn?a.add(i[1]):o.add(i[0]),e.forEach(d=>{o.add(d[0]),o.add(d[2]),a.add(d[1]),a.add(d[3])}),o.add(s[0]),o.add(s[2]),a.add(s[1]),a.add(s[3]);const l=Array.from(a).sort((d,u)=>d-u),c=Array.from(o).sort((d,u)=>d-u);return{row:l.length,col:c.length,data:l.flatMap((d,u)=>c.map((f,h)=>({f:0,g:0,h:0,closed:!1,visited:!1,parent:null,addr:[h,u],pos:[f,d]})))}},jA=(e,t,n)=>{switch(t){case to:return S(n[0],e[1]);case Vn:return S(e[2],n[1]);case cr:return S(n[0],e[3])}return S(e[0],n[1])},cle=(e,t,n,i)=>{if(i===Vn)switch(n){case Vn:return e.pos[0]>=t.pos[0]?4:e.pos[1]===t.pos[1]?0:2;case to:return e.pos[1]>t.pos[1]&&e.pos[0]<t.pos[0]?1:3;case cr:return e.pos[1]<t.pos[1]&&e.pos[0]<t.pos[0]?1:3;case vs:return e.pos[1]===t.pos[1]?4:2}else if(i===vs)switch(n){case Vn:return e.pos[1]===t.pos[1]?4:2;case to:return e.pos[1]>t.pos[1]&&e.pos[0]>t.pos[0]?1:3;case cr:return e.pos[1]<t.pos[1]&&e.pos[0]>t.pos[0]?1:3;case vs:return e.pos[0]<=t.pos[0]?4:e.pos[1]===t.pos[1]?0:2}else if(i===to)switch(n){case Vn:return e.pos[1]>t.pos[1]&&e.pos[0]<t.pos[0]?1:3;case to:return e.pos[1]>=t.pos[1]?4:e.pos[0]===t.pos[0]?0:2;case cr:return e.pos[0]===t.pos[0]?4:2;case vs:return e.pos[1]>t.pos[1]&&e.pos[0]>t.pos[0]?1:3}else if(i===cr)switch(n){case Vn:return e.pos[1]<t.pos[1]&&e.pos[0]<t.pos[0]?1:3;case to:return e.pos[0]===t.pos[0]?4:2;case cr:return e.pos[1]<=t.pos[1]?4:e.pos[0]===t.pos[0]?0:2;case vs:return e.pos[1]<t.pos[1]&&e.pos[0]>t.pos[0]?1:3}return 0},dle=([e,t],n)=>[H1([e,t-1],n),H1([e+1,t],n),H1([e,t+1],n),H1([e-1,t],n)],H1=([e,t],n)=>e<0||e>=n.col||t<0||t>=n.row?null:n.data[t*n.col+e]??null,XU=(e,t)=>{for(let n=0;n<t.col;n++)for(let i=0;i<t.row;i++){const r=H1([n,i],t);if(r&&e[0]===r.pos[0]&&e[1]===r.pos[1])return r}return null},_z=e=>[Math.min(...e.map(t=>t[0])),Math.min(...e.map(t=>t[1])),Math.max(...e.map(t=>t[2])),Math.max(...e.map(t=>t[3]))],g6=(e,t)=>{const n=t.get(e);return n&&ss(n)?n:null},Ja=(e,t,n,i)=>{const r=e[0][0],s=e[0][1];let o=e.map(a=>t6(a,In(he(e[0]),-1)));return(r<-1e6||r>GU||s<-1e6||s>GU||r+o[o.length-1][0]<-1e6||s+o[o.length-1][0]>GU||r+o[o.length-1][1]<-1e6||s+o[o.length-1][1]>GU)&&console.error("Elbow arrow normalization is outside reasonable bounds (> 1e6)",{x:r,y:s,points:o,...zh(o)}),o=o.map(([a,l])=>S(Ze(a,-1e6,1e6),Ze(l,-1e6,1e6))),{points:o,x:Ze(r,-1e6,1e6),y:Ze(s,-1e6,1e6),fixedSegments:((t==null?void 0:t.length)??0)>0?t:null,...zh(o),startIsSpecial:n,endIsSpecial:i}},m9=e=>{if(e.length>1){let t=Math.abs(e[0][1]-e[1][1])<Math.abs(e[0][0]-e[1][0]);return e.filter((n,i)=>{if(i===0||i===e.length-1)return!0;const r=e[i+1],s=Math.abs(n[1]-r[1])<Math.abs(n[0]-r[0]);return t===s?(t=s,!1):(t=s,!0)})}return e},p9=e=>e.length>=4?e.filter((t,n)=>{if(n===0||n===e.length-1)return!0;const i=e[n-1];return ct(i,t)>f9}):e,ule=e=>{switch(e){case 0:return to;case 1:return Vn;case 2:return cr}return vs},YA=(e,t,n,i,r,s,o)=>o?r&&s?Az(e,r,t,s):i:r?mm(n||[0,0],r,s??ve([r])):i,WA=(e,t,n,i,r)=>Ile(e,t,n,n&&Sa(n,r,Array(4).fill(Mp(n,r,e))),i,r),KA=(e,t,n,i)=>el(qa(e),n,t,i,!0,!0),ZA=(e,t)=>e[0]===t[0]&&e[1]===t[1],Tz=(e,t=f9)=>e.slice(1).map((n,i)=>Math.abs(n[0]-e[i][0])<t||Math.abs(n[1]-e[i][1])<t).every(Boolean),_i=(e,t,n,i)=>{let r=!1;const{points:s,fixedSegments:o,startBinding:a,endBinding:l,fileId:c}=n;me(e)&&(Object.keys(n).length===0||typeof s<"u"||typeof o<"u"||typeof a<"u"||typeof l<"u")?n={...n,angle:0,..._g({...e,x:n.x||e.x,y:n.y||e.y},t,n,i)}:typeof s<"u"&&(n={...zh(s),...n});for(const d in n){const u=n[d];if(typeof u<"u"){if(e[d]===u&&(typeof u!="object"||u===null||d==="groupIds"||d==="scale"))continue;if(d==="scale"){const f=e[d],h=u;if(f[0]===h[0]&&f[1]===h[1])continue}else if(d==="points"){const f=e[d],h=u;if(f.length===h.length){let m=!1,p=f.length;for(;--p;){const U=f[p],b=h[p];if(U[0]!==b[0]||U[1]!==b[1]){m=!0;break}}if(!m)continue}}e[d]=u,r=!0}}return r&&((typeof n.height<"u"||typeof n.width<"u"||typeof c<"u"||typeof s<"u")&&qt.delete(e),e.version=n.version??e.version+1,e.versionNonce=n.versionNonce??Ps(),e.updated=wg()),e},Ie=(e,t,n=!1)=>{let i=!1;for(const r in t){const s=t[r];if(typeof s<"u"){if(e[r]===s&&(typeof s!="object"||s===null))continue;i=!0}}return!i&&!n?e:{...e,...t,version:t.version??e.version+1,versionNonce:t.versionNonce??Ps(),updated:wg()}},Pa=(e,t)=>(e.version=(t??e.version)+1,e.versionNonce=Ps(),e.updated=wg(),e),fle=e=>!e[V.CTRL_OR_CMD],tu=e=>e.isBindingEnabled,Rt=5,hle=10,gle=(e,t)=>{const n=[];return t.forEach(i=>{const r=e.getNonDeletedElement(i);r!=null&&n.push(r)}),n},m6=(e,t,n,i)=>{i.getNonDeletedElementsMap();const r=new Set,s=new Set;qA(e,t,n,"start",r,s,i),qA(e,n,t,"end",r,s,i);const o=Array.from(s).filter(a=>!r.has(a));gle(i,o).forEach(a=>{var l;i.mutateElement(a,{boundElements:(l=a.boundElements)==null?void 0:l.filter(c=>c.type!=="arrow"||c.id!==e.id)})})},qA=(e,t,n,i,r,s,o,a)=>{if(t!=="keep"){if(t===null){const l=yle(e,i,o);l!=null&&s.add(l);return}Cz(e)?(n==null||(n==="keep"?!Sz(e,t,i):i==="start"||n.id!==t.id))&&(na(e,t,i,o),r.add(t.id)):(na(e,t,i,o),r.add(t.id))}},Iz=(e,t,n)=>["start","end"].map(i=>{var o,a;const r=Mz(e,i,t),s=i==="start"?(o=e.startBinding)==null?void 0:o.elementId:(a=e.endBinding)==null?void 0:a.elementId;if(s){const l=t.get(s);if(ss(l)&&H2(l,r,t,n))return l}return null}),mle=(e,t,n,i,r,s)=>{const a=e.points.length-1,l=n.findIndex(f=>f===0)>-1,c=n.findIndex(f=>f===a)>-1,d=l?t?b6(e,"start",i,r,s):null:"keep",u=c?t?b6(e,"end",i,r,s):null:"keep";return[d,u]},ple=(e,t,n,i,r)=>{if(me(e))return["keep","keep"];const[s,o]=Iz(e,t,r),a=s&&i?b6(e,"start",t,n,r):null,l=o&&i?b6(e,"end",t,n,r):null;return[a,l]},p6=(e,t,n,i,r)=>{e.forEach(s=>{const[o,a]=n!=null&&n.length?mle(s,t,n??[],i.getNonDeletedElementsMap(),i.getNonDeletedElements(),r):ple(s,i.getNonDeletedElementsMap(),i.getNonDeletedElements(),t,r);m6(s,o,a,i)})},V8=(e,t,n)=>e.length>50?[]:e.filter(xe).flatMap(i=>Iz(i,t,n)).filter(i=>i!==null).filter(i=>e.filter(r=>r.id===(i==null?void 0:i.id)).length===0),N4=(e,t,n,i,r)=>Array.from(t.reduce((s,o)=>{const a=el(o,n.getNonDeletedElements(),n.getNonDeletedElementsMap(),i,me(e),me(e));return a!=null&&!xz(e,r==null?void 0:r.id,a)&&s.add(a),s},new Set)),Ule=(e,t,n,i)=>{const r=i.getNonDeletedElements(),s=i.getNonDeletedElementsMap();t.startBoundElement!=null&&na(e,t.startBoundElement,"start",i);const o=el(n,r,s,t.zoom,me(e),me(e));o!==null&&(Sz(e,o,"end")||na(e,o,"end",i))},ble=(e,t)=>({...e,gap:Math.min(e.gap,Tg(t,t.width,t.height))}),na=(e,t,n,i)=>{if(!Ce(e))return;let r={elementId:t.id,...ble(wle(e,t,n,i.getNonDeletedElementsMap()),t)};me(e)&&(r={...r,...U6(e,t,n,i.getNonDeletedElementsMap())}),i.mutateElement(e,{[n==="start"?"startBinding":"endBinding"]:r}),ve(t.boundElements||[]).has(e.id)||i.mutateElement(t,{boundElements:(t.boundElements||[]).concat({id:e.id,type:"arrow"})})},Sz=(e,t,n)=>{const i=e[n==="start"?"endBinding":"startBinding"];return xz(e,i==null?void 0:i.elementId,t)},xz=(e,t,n)=>t===n.id&&Cz(e),Cz=e=>e.points.length<3&&!me(e),yle=(e,t,n)=>{const i=t==="start"?"startBinding":"endBinding",r=e[i];return r==null?null:(n.mutateElement(e,{[i]:null}),r.elementId)},el=(e,t,n,i,r,s)=>{if(s){let a=!1;const l=vle(t,d=>ss(d,!1)&&H2(d,e,n,i,(r||!N2(d))&&!we(d))).filter(d=>a?!1:(N2(d)||(a=!0),!0));if(!l||l.length===0)return null;if(l.length===1)return l[0];const c=l.filter(d=>H2(d,e,n,i,!1));return c.length===1?c[0]:l.sort((d,u)=>u.width**2+u.height**2-(d.width**2+d.height**2)).pop()}return Ele(t,a=>ss(a,!1)&&H2(a,e,n,i,(r||!N2(a))&&!we(a)))},Ele=(e,t)=>{let n=null;for(let i=e.length-1;i>=0;--i){const r=e[i];if(!r.isDeleted&&t(r)){n=r;break}}return n},vle=(e,t)=>{const n=[];for(let i=e.length-1;i>=0;--i){const r=e[i];r.isDeleted||t(r)&&n.push(r)}return n},wle=(e,t,n,i)=>{const r=n==="start"?-1:1,s=r===-1?0:e.points.length-1,o=s-r,a=pe.getPointAtIndexGlobalCoordinates(e,s,i),l=pe.getPointAtIndexGlobalCoordinates(e,o,i);return{focus:kle(t,i,l,a),gap:Math.max(1,Mp(t,i,a))}},fr=(e,t,n)=>{if(!ss(e))return;const{newSize:i,simultaneouslyUpdated:r}=n??{},s=Tle(r);let o=t.getNonDeletedElementsMap();n!=null&&n.changedElements&&(o=new Map(o),n.changedElements.forEach(a=>{o.set(a.id,a)})),y6(o,e,a=>{var p,U;if(!xe(a)||a.isDeleted||!_le(a,e))return;const l=a.startBinding?o.get(a.startBinding.elementId):null,c=a.endBinding?o.get(a.endBinding.elementId):null;let d=null,u=null;l&&c&&(d=si(l,o),u=si(c,o));const f={startBinding:QA(e,a.startBinding,i),endBinding:QA(e,a.endBinding,i)};if(s.has(a.id)){t.mutateElement(a,f);return}const h=E6(o,a,(b,y)=>{var w,v;if(b&&ss(b)&&(y==="startBinding"||y==="endBinding")&&(e.id===((w=a[y])==null?void 0:w.elementId)||e.id===((v=a[y==="startBinding"?"endBinding":"startBinding"])==null?void 0:v.elementId)&&!Gu(d,u))){const I=Ale(a,y,f[y],b,o);if(I)return[y==="startBinding"?0:a.points.length-1,{point:I}]}return null}).filter(b=>b!==null);pe.movePoints(a,t,new Map(h),{...e.id===((p=a.startBinding)==null?void 0:p.elementId)?{startBinding:f.startBinding}:{},...e.id===((U=a.endBinding)==null?void 0:U.elementId)?{endBinding:f.endBinding}:{}});const m=Le(a,o);m&&!m.isDeleted&&Cp(a,t,!1)})},gm=(e,t,n)=>{xe(e)?p6([e],!0,[],t,n==null?void 0:n.zoom):fr(e,t,{...n,changedElements:new Map([[e.id,e]])})},_le=(e,t)=>{var n,i;return((n=e.startBinding)==null?void 0:n.elementId)===t.id||((i=e.endBinding)==null?void 0:i.elementId)===t.id},Tle=e=>new Set((e||[]).map(t=>t.id)),Ile=(e,t,n,i,r,s,o)=>{const a=Xh(he(t,e));return!n||!i?a:Sle(r,n,s,o)?u9(n,i,e):Xh(he(e,oi(n,s)))},Sle=(e,t,n,i)=>{const r=Mp(t,n,e),s=Tg(t,t.width,t.height,i);return r>s?null:r},Az=(e,t,n,i)=>{const r=Sa(t,i),s=e.points[n==="start"?0:e.points.length-1],o=S(e.x+s[0],e.y+s[1]),a=wae(t)?xle(t,i,o):o,l=me(e),c=Sg(r),d=n==="start"?1:e.points.length-2,u=Q(S(e.x+e.points[d][0],e.y+e.points[d][1]),c,e.angle??0);let f=null;if(l){const h=Fo(u9(t,r,o)),m=Cle(t,i,a),p=S(h?c[0]:m[0],h?m[1]:c[1]),U=Me(p,Ei(In(es(he(m,p)),Math.max(t.width,t.height)*2),p));if(f=Xo(t,i,U,Rt).sort(La)[0],!f){const b=S(h?m[0]:c[0],h?c[1]:m[1]),y=Me(b,Ei(In(es(he(m,b)),Math.max(t.width,t.height)*2),b));f=Xo(t,i,y,Rt).sort(La)[0]}}else f=Xo(t,i,Me(u,Ei(In(es(he(a,u)),ct(a,u)+Math.max(t.width,t.height)*2),u)),Rt).sort((h,m)=>La(h,u)-La(m,u))[0];return!f||La(a,f)<yp?a:l?f:a},xle=(e,t,n)=>{const i=oi(e,t),r=Q(n,i,-e.angle);return r[0]<e.x&&r[1]<e.y?r[1]-e.y>-5?Q(S(e.x-Rt,e.y),i,e.angle):Q(S(e.x,e.y-Rt),i,e.angle):r[0]<e.x&&r[1]>e.y+e.height?r[0]-e.x>-5?Q(S(e.x,e.y+e.height+Rt),i,e.angle):Q(S(e.x-Rt,e.y+e.height),i,e.angle):r[0]>e.x+e.width&&r[1]>e.y+e.height?r[0]-e.x<e.width+Rt?Q(S(e.x+e.width,e.y+e.height+Rt),i,e.angle):Q(S(e.x+e.width+Rt,e.y+e.height),i,e.angle):r[0]>e.x+e.width&&r[1]<e.y?r[0]-e.x<e.width+Rt?Q(S(e.x+e.width,e.y-Rt),i,e.angle):Q(S(e.x+e.width+Rt,e.y),i,e.angle):n},Cle=(e,t,n,i=.05)=>{const{x:r,y:s,width:o,height:a,angle:l}=e,c=oi(e,t,-.1,-.1),d=Q(n,c,-l),u=Ze(i*a,5,80),f=Ze(i*o,5,80);if(d[0]<=r+o/2&&d[1]>c[1]-u&&d[1]<c[1]+u)return Q(S(r-Rt,c[1]),c,l);if(d[1]<=s+a/2&&d[0]>c[0]-f&&d[0]<c[0]+f)return Q(S(c[0],s-Rt),c,l);if(d[0]>=r+o/2&&d[1]>c[1]-u&&d[1]<c[1]+u)return Q(S(r+o+Rt,c[1]),c,l);if(d[1]>=s+a/2&&d[0]>c[0]-f&&d[0]<c[0]+f)return Q(S(c[0],s+a+Rt),c,l);if(e.type==="diamond"){const h=Rt,m=S(r+o/4-h,s+a/4-h),p=S(r+3*o/4+h,s+a/4-h),U=S(r+o/4-h,s+3*a/4+h),b=S(r+3*o/4+h,s+3*a/4+h);if(ct(m,d)<Math.max(f,u))return Q(m,c,l);if(ct(p,d)<Math.max(f,u))return Q(p,c,l);if(ct(U,d)<Math.max(f,u))return Q(U,c,l);if(ct(b,d)<Math.max(f,u))return Q(b,c,l)}return n},Ale=(e,t,n,i,r)=>{if(n==null||n.elementId!==i.id&&e.points.length>2)return null;const s=t==="startBinding"?-1:1,o=s===-1?0:e.points.length-1;if(me(e)&&Vh(n)){const u=ly(n.fixedPoint)??U6(e,i,t==="startBinding"?"start":"end",r).fixedPoint,f=oi(i,r),h=S(i.x+u[0]*i.width,i.y+u[1]*i.height),m=Q(h,f,i.angle);return pe.pointFromAbsoluteCoords(e,m,r)}const a=o-s,l=pe.getPointAtIndexGlobalCoordinates(e,a,r),c=Rle(i,r,n.focus,l);let d;if(n.gap===0)d=c;else{const u=pe.getPointAtIndexGlobalCoordinates(e,o,r),f=oi(i,r),h=ct(l,u)+ct(l,f)+Math.max(i.width,i.height)*2,m=[...Xo(i,r,Me(l,Ei(In(es(he(c,l)),h),l)),n.gap).sort((p,U)=>La(p,l)-La(U,l)),Ei(In(es(he(c,l)),ct(l,u)),l)];m.length>1?d=m[0]:m.length===1?d=c:d=u}return pe.pointFromAbsoluteCoords(e,d,r)},U6=(e,t,n,i)=>{const r=[t.x,t.y,t.x+t.width,t.y+t.height],s=Az(e,t,n,i),o=S(r[0]+(r[2]-r[0])/2,r[1]+(r[3]-r[1])/2),a=Q(s,o,-t.angle);return{fixedPoint:ly([(a[0]-t.x)/t.width,(a[1]-t.y)/t.height])}},QA=(e,t,n)=>{if(t==null||n==null)return t;const{width:i,height:r}=n,{width:s,height:o}=e,a=Math.max(1,Math.min(Tg(e,i,r),t.gap*(i<r?i/s:r/o)));return{...t,gap:a}},b6=(e,t,n,i,r)=>el(Mz(e,t,n),i,n,r,me(e),me(e)),Mz=(e,t,n)=>{const i=t==="start"?0:-1;return qa(pe.getPointAtIndexGlobalCoordinates(e,i,n))},Mle=(e,t,n)=>{for(const i of e){if("boundElements"in i&&i.boundElements&&Object.assign(i,{boundElements:i.boundElements.reduce((r,s)=>{const o=t.get(s.id);return o&&r.push({...s,id:o}),r},[])}),"containerId"in i&&i.containerId&&Object.assign(i,{containerId:t.get(i.containerId)??null}),"endBinding"in i&&i.endBinding){const r=t.get(i.endBinding.elementId);Object.assign(i,{endBinding:r?{...i.endBinding,elementId:r}:null})}if("startBinding"in i&&i.startBinding){const r=t.get(i.startBinding.elementId);Object.assign(i,{startBinding:r?{...i.startBinding,elementId:r}:null})}me(i)&&Object.assign(i,_g(i,n,{points:[i.points[0],i.points[i.points.length-1]]}))}},kz=(e,t)=>{const n=ve(e);for(const i of t)Yf.unbindAffected(n,i,(r,s)=>_i(r,n,s)),Wf.unbindAffected(n,i,(r,s)=>_i(r,n,s))},T0=(e,t,n=[])=>{if(!e)return null;const i=e.filter(r=>!t.has(r.id));return i.push(...n.map(r=>({id:r.id,type:r.type}))),i},H2=(e,{x:t,y:n},i,r,s)=>{const o=S(t,n),a=Tg(e,e.width,e.height,r),l=(s||!N2(e))&&!we(e),c=[t-a,n-a,t+a,n+a],d=si(e,i);if(!Gu(c,d))return!1;const u=Xo(e,i,Me(oi(e,i),o)),f=Mp(e,i,o);return l?u.length===0||f<=a:u.length>0&&f<=a},Tg=(e,t,n,i)=>{const r=i!=null&&i.value&&i.value<1?i.value:1,o=(e.type==="diamond"?1/Math.sqrt(2):1)*Math.min(t,n);return Math.max(16,Math.min(.25*o,32),hle/r+Rt)},kle=(e,t,n,i)=>{const r=oi(e,t);if(Os(n,i))return 0;const s=Q(n,r,-e.angle),o=Q(i,r,-e.angle),a=Math.sign(bt(he(o,n),he(o,r)))*-1,l=Me(o,Ei(In(es(he(o,s)),Math.max(e.width*2,e.height*2)),o)),c=e.type==="diamond"?[Me(S(e.x+e.width/2,e.y),S(e.x+e.width/2,e.y+e.height)),Me(S(e.x,e.y+e.height/2),S(e.x+e.width,e.y+e.height/2))]:[Me(S(e.x,e.y),S(e.x+e.width,e.y+e.height)),Me(S(e.x+e.width,e.y),S(e.x,e.y+e.height))],d=e.type==="diamond"?[Me(S(e.x+e.width/2,e.y-e.height),S(e.x+e.width/2,e.y+e.height*2)),Me(S(e.x-e.width,e.y+e.height/2),S(e.x+e.width*2,e.y+e.height/2))]:[Me(S(e.x-e.width,e.y-e.height),S(e.x+e.width*2,e.y+e.height*2)),Me(S(e.x+e.width*2,e.y-e.height),S(e.x-e.width,e.y+e.height*2))];return[hm(l,d[0]),hm(l,d[1])].filter(h=>h!==null).sort((h,m)=>La(h,i)-La(m,i)).map((h,m)=>a*ct(r,h)/(e.type==="diamond"?ct(c[m][0],c[m][1])/2:Math.sqrt(e.width**2+e.height**2)/2)).sort((h,m)=>Math.abs(h)-Math.abs(m))[0]??0},Rle=(e,t,n,i)=>{const r=oi(e,t);if(n===0)return r;const s=(e.type==="diamond"?[S(e.x,e.y+e.height/2),S(e.x+e.width/2,e.y),S(e.x+e.width,e.y+e.height/2),S(e.x+e.width/2,e.y+e.height)]:[S(e.x,e.y),S(e.x+e.width,e.y),S(e.x+e.width,e.y+e.height),S(e.x,e.y+e.height)]).map(l=>Ei(In(he(l,r),Math.abs(n)),r)).map(l=>Q(l,r,e.angle)),o=[bt(he(i,s[0]),he(s[1],s[0]))>0&&(n>0?bt(he(i,s[1]),he(s[2],s[1]))<0:bt(he(i,s[3]),he(s[0],s[3]))<0),bt(he(i,s[1]),he(s[2],s[1]))>0&&(n>0?bt(he(i,s[2]),he(s[3],s[2]))<0:bt(he(i,s[0]),he(s[1],s[0]))<0),bt(he(i,s[2]),he(s[3],s[2]))>0&&(n>0?bt(he(i,s[3]),he(s[0],s[3]))<0:bt(he(i,s[1]),he(s[2],s[1]))<0),bt(he(i,s[3]),he(s[0],s[3]))>0&&(n>0?bt(he(i,s[0]),he(s[1],s[0]))<0:bt(he(i,s[2]),he(s[3],s[2]))<0)];return o[0]?n>0?s[1]:s[0]:o[1]?n>0?s[2]:s[1]:o[2]?n>0?s[3]:s[2]:n>0?s[0]:s[3]},Dle=new Set(["boundElements","frameId","containerId","startBinding","endBinding"]),y6=(e,t,n)=>{var i;ss(t)&&(((i=t.boundElements)==null?void 0:i.slice())??[]).forEach(({id:s})=>{n(e.get(s),"boundElements",s)})},E6=(e,t,n)=>{const i=[];if(t.frameId){const r=t.frameId;i.push(n(e.get(r),"frameId",r))}if(Dt(t)){const r=t.containerId;i.push(n(e.get(r),"containerId",r))}if(Ce(t)){if(t.startBinding){const r=t.startBinding.elementId;i.push(n(e.get(r),"startBinding",r))}if(t.endBinding){const r=t.endBinding.elementId;i.push(n(e.get(r),"endBinding",r))}}return i};class Yf{static unbindAffected(t,n,i){n&&E6(t,n,r=>{!r||r.isDeleted||y6(t,r,(s,o,a)=>{a===n.id&&i(r,{boundElements:T0(r.boundElements,new Set([a]))})})})}}F(Yf,"rebindAffected",(t,n,i)=>{!n||n.isDeleted||E6(t,n,(r,s)=>{var o,a;if(!r||r.isDeleted){i(n,{[s]:null});return}s!=="frameId"&&((o=r.boundElements)!=null&&o.find(l=>l.id===n.id)||(Ce(n)&&i(r,{boundElements:T0(r.boundElements,new Set,new Array(n))}),ge(n)&&((a=r.boundElements)!=null&&a.find(l=>l.type==="text")?i(n,{[s]:null}):i(r,{boundElements:T0(r.boundElements,new Set,new Array(n))}))))})});class Wf{static unbindAffected(t,n,i){n&&y6(t,n,r=>{!r||r.isDeleted||E6(t,r,(s,o,a)=>{a===n.id&&i(r,{[o]:null})})})}}F(Wf,"rebindAffected",(t,n,i)=>{!n||n.isDeleted||y6(t,n,(r,s,o)=>{var a,l;if(!r||r.isDeleted){i(n,{boundElements:T0(n.boundElements,new Set([o]))});return}ge(r)&&(((l=(((a=n.boundElements)==null?void 0:a.slice())??[]).reverse().find(d=>d.type==="text"))==null?void 0:l.id)===r.id?r.containerId!==n.id&&i(r,{containerId:n.id}):(r.containerId!==null&&i(r,{containerId:null}),i(n,{boundElements:T0(n.boundElements,new Set([r.id]))})))})});const mm=(e,t,n)=>{const[i,r]=ly(e);return Q(S(t.x+t.width*i,t.y+t.height*r),oi(t,n),t.angle)},Lle=(e,t)=>{const n=e.startBinding&&t.get(e.startBinding.elementId),i=e.endBinding&&t.get(e.endBinding.elementId),r=n&&e.startBinding?mm(e.startBinding.fixedPoint,n,t):S(e.x+e.points[0][0],e.y+e.points[0][1]),s=i&&e.endBinding?mm(e.endBinding.fixedPoint,i,t):S(e.x+e.points[e.points.length-1][0],e.y+e.points[e.points.length-1][1]);return[r,s]},Nle=(e,t)=>{const[n,i]=Lle(e,t);return[pe.pointFromAbsoluteCoords(e,n,t),pe.pointFromAbsoluteCoords(e,i,t)]},ly=e=>e&&(Math.abs(e[0]-.5)<1e-4||Math.abs(e[1]-.5)<1e-4)?e.map(t=>Math.abs(t-.5)<1e-4?.5001:t):e,$8=({points:e})=>{const t=e[0][0],n=e[0][1];return{points:e.map(i=>S(i[0]-t,i[1]-n)),offsetX:t,offsetY:n}},Se=class Se{constructor(t,n,i=!1){F(this,"elementId");F(this,"selectedPointsIndices");F(this,"pointerDownState");F(this,"isDragging");F(this,"lastUncommittedPoint");F(this,"pointerOffset");F(this,"startBindingElement");F(this,"endBindingElement");F(this,"hoverPointIndex");F(this,"segmentMidPointHoveredCoords");F(this,"elbowed");F(this,"customLineAngle");F(this,"isEditing");this.elementId=t.id,Os(t.points[0],S(0,0))||(console.error("Linear element is not normalized",Error().stack),_i(t,n,Se.getNormalizeElementPointsAndCoords(t))),this.selectedPointsIndices=null,this.lastUncommittedPoint=null,this.isDragging=!1,this.pointerOffset={x:0,y:0},this.startBindingElement="keep",this.endBindingElement="keep",this.pointerDownState={prevSelectedPointsIndices:null,lastClickedPoint:-1,lastClickedIsEndPoint:!1,origin:null,segmentMidpoint:{value:null,index:null,added:!1}},this.hoverPointIndex=-1,this.segmentMidPointHoveredCoords=null,this.elbowed=me(t)&&t.elbowed,this.customLineAngle=null,this.isEditing=i}static getElement(t,n){const i=n.get(t);return i||null}static handleBoxSelection(t,n,i,r){var p;if(!((p=n.selectedLinearElement)!=null&&p.isEditing)||!n.selectionElement)return!1;const{selectedLinearElement:s}=n,{selectedPointsIndices:o,elementId:a}=s,l=Se.getElement(a,r);if(!l)return!1;const[c,d,u,f]=$e(n.selectionElement,r),m=Se.getPointsGlobalCoordinates(l,r).reduce((U,b,y)=>((b[0]>=c&&b[0]<=u&&b[1]>=d&&b[1]<=f||t.shiftKey&&(o!=null&&o.includes(y)))&&U.push(y),U),[]).filter(U=>!(me(l)&&U!==0&&U!==l.points.length-1));i({selectedLinearElement:{...s,selectedPointsIndices:m.length?m:null}})}static handlePointDragging(t,n,i,r,s){var h,m;if(!s)return null;const{elementId:o}=s,a=n.scene.getNonDeletedElementsMap(),l=Se.getElement(o,a);let c=s.customLineAngle;if(!l||me(l)&&!s.pointerDownState.lastClickedIsEndPoint&&s.pointerDownState.lastClickedPoint!==0)return null;const d=me(l)?[(h=s.selectedPointsIndices)!=null&&h.includes(0)?0:void 0,(m=s.selectedPointsIndices)!=null&&m.find(p=>p>0)?l.points.length-1:void 0].filter(p=>p!==void 0):s.selectedPointsIndices,u=me(l)?s.pointerDownState.lastClickedPoint>0?l.points.length-1:0:s.pointerDownState.lastClickedPoint,f=l.points[u];if(d&&f){if(E0(t)&&d.length===1&&l.points.length>1){const y=d[0],w=l.points[y===0?1:y-1];c=s.customLineAngle??Math.atan2(l.points[y][1]-w[1],l.points[y][0]-w[0]);const[v,I]=Se._getShiftLockedDelta(l,a,w,S(i,r),t[V.CTRL_OR_CMD]?null:n.getEffectiveGridSize(),c);Se.movePoints(l,n.scene,new Map([[y,{point:S(v+w[0],I+w[1]),isDragging:y===u}]]))}else{const y=Se.createPointAt(l,a,i-s.pointerOffset.x,r-s.pointerOffset.y,t[V.CTRL_OR_CMD]?null:n.getEffectiveGridSize()),w=y[0]-f[0],v=y[1]-f[1];Se.movePoints(l,n.scene,new Map(d.map(I=>{const C=I===u?Se.createPointAt(l,a,i-s.pointerOffset.x,r-s.pointerOffset.y,t[V.CTRL_OR_CMD]?null:n.getEffectiveGridSize()):S(l.points[I][0]+w,l.points[I][1]+v);return[I,{point:C,isDragging:I===u}]})))}Le(l,a)&&Cp(l,n.scene,!1);let U=[];if(Ga(l,!1)){const y=d[0]===0,w=d[d.length-1]===l.points.length-1,v=[];!y!=!w?v.push({x:i,y:r}):(y&&v.push(qa(Se.getPointGlobalCoordinates(l,l.points[0],a))),w&&v.push(qa(Se.getPointGlobalCoordinates(l,l.points[d[d.length-1]],a)))),v.length&&(U=N4(l,v,n.scene,n.state.zoom))}const b={...s,selectedPointsIndices:d,segmentMidPointHoveredCoords:u!==0&&u!==l.points.length-1?this.getPointGlobalCoordinates(l,f,a):null,hoverPointIndex:u===0||u===l.points.length-1?u:-1,isDragging:!0,customLineAngle:c};return{...n.state,selectedLinearElement:b,suggestedBindings:U}}return null}static handlePointerUp(t,n,i,r){var m;const s=r.getNonDeletedElementsMap(),o=r.getNonDeletedElements(),a=Nt(t,i),{elementId:l,selectedPointsIndices:c,isDragging:d,pointerDownState:u}=n,f=Se.getElement(l,s);if(!f)return n;const h={};if(d&&c){for(const p of c)if(p===0||p===f.points.length-1){Jo(f.points,i.zoom.value)&&(nn(f)&&r.mutateElement(f,{...x9(f,!0)},{informMutation:!1,isDragging:!1}),Se.movePoints(f,r,new Map([[p,{point:p===0?f.points[f.points.length-1]:f.points[0]}]])));const U=tu(i)?el(((c==null?void 0:c.length)??0)>1?qa(Se.getPointAtIndexGlobalCoordinates(f,p,s)):a,o,s,i.zoom,me(f),me(f)):null;h[p===0?"startBindingElement":"endBindingElement"]=U}}return{...n,...h,segmentMidPointHoveredCoords:null,hoverPointIndex:-1,selectedPointsIndices:d||t.shiftKey?!d&&t.shiftKey&&((m=u.prevSelectedPointsIndices)!=null&&m.includes(u.lastClickedPoint))?c&&c.filter(p=>p!==u.lastClickedPoint):c:c!=null&&c.includes(u.lastClickedPoint)?[u.lastClickedPoint]:c,isDragging:!1,pointerOffset:{x:0,y:0},customLineAngle:null}}static isSegmentTooShort(t,n,i,r,s){if(me(t))return r>=0&&r<t.points.length?ct(n,i)*s.value<Se.POINT_HANDLE_SIZE/2:!1;let o=ct(n,i);if(t.points.length>2&&t.roundness){const[a,l]=u6(t);gn(a.length===0&&l.length>0,"Only linears built out of curves are supported"),gn(a.length+l.length>=r,"Invalid segment index while calculating mid point"),o=Y_(l[r])}return o*s.value<Se.POINT_HANDLE_SIZE*4}static getSegmentMidPoint(t,n){if(me(t)){gn(t.points.length>=n,"Invalid segment index while calculating elbow arrow mid point");const s=n6(t.points[n-1],t.points[n]);return S(t.x+s[0],t.y+s[1])}const[i,r]=u6(t);if(gn(i.length===0&&r.length>0||i.length>0&&r.length===0,"Only linears built out of either segments or curves are supported"),gn(i.length+r.length>=n,"Invalid segment index while calculating mid point"),i.length){const s=i[n-1];return n6(s[0],s[1])}if(r.length){const s=r[n-1];return Dse(s,.5)}gn(!1,"Invalid segment type while calculating mid point")}static getSegmentMidPointIndex(t,n,i,r){const s=Se.getElement(t.elementId,r);if(!s)return-1;const o=Se.getEditorMidPoints(s,r,n);let a=0;for(;a<o.length;){if(Se.arePointsEqual(i,o[a]))return a+1;a++}return-1}static handlePointerDown(t,n,i,r,s,o){var T,k;const a=n.state,l=o.getNonDeletedElementsMap(),c=o.getNonDeletedElements(),d={didAddPoint:!1,hitElement:null,linearElementEditor:null};if(!s)return d;const{elementId:u}=s,f=Se.getElement(u,l);if(!f)return d;const h=Se.getSegmentMidpointHitCoords(s,r,a,l);let m=null;if(h)m=Se.getSegmentMidPointIndex(s,a,h,l);else if(t.altKey&&((T=a.selectedLinearElement)!=null&&T.isEditing))return s.lastUncommittedPoint==null&&(o.mutateElement(f,{points:[...f.points,Se.createPointAt(f,l,r.x,r.y,t[V.CTRL_OR_CMD]?null:n.getEffectiveGridSize())]}),d.didAddPoint=!0),i.scheduleCapture(),d.linearElementEditor={...s,pointerDownState:{prevSelectedPointsIndices:s.selectedPointsIndices,lastClickedPoint:-1,lastClickedIsEndPoint:!1,origin:{x:r.x,y:r.y},segmentMidpoint:{value:h,index:m,added:!1}},selectedPointsIndices:[f.points.length-1],lastUncommittedPoint:null,endBindingElement:el(r,c,l,n.state.zoom,s.elbowed)},d.didAddPoint=!0,d;const p=Se.getPointIndexUnderCursor(f,l,a.zoom,r.x,r.y);if(p>=0||h)d.hitElement=f;else{const{startBindingElement:x,endBindingElement:D}=s;tu(a)&&Ga(f)&&m6(f,x,D,o)}const[U,b,y,w]=$e(f,l),v=(U+y)/2,I=(b+w)/2,C=p>-1&&Q(S(f.x+f.points[p][0],f.y+f.points[p][1]),S(v,I),f.angle),_=p>-1||t.shiftKey?t.shiftKey||(k=s.selectedPointsIndices)!=null&&k.includes(p)?Ole([...s.selectedPointsIndices||[],p]):[p]:null;return d.linearElementEditor={...s,pointerDownState:{prevSelectedPointsIndices:s.selectedPointsIndices,lastClickedPoint:p,lastClickedIsEndPoint:p===f.points.length-1,origin:{x:r.x,y:r.y},segmentMidpoint:{value:h,index:m,added:!1}},selectedPointsIndices:_,pointerOffset:C?{x:r.x-C[0],y:r.y-C[1]}:{x:0,y:0}},d}static arePointsEqual(t,n){return!t&&!n?!0:!t||!n?!1:Os(t,n)}static handlePointerMove(t,n,i,r){var h,m;const s=r.state;if(!((h=s.selectedLinearElement)!=null&&h.isEditing))return null;const{elementId:o,lastUncommittedPoint:a}=s.selectedLinearElement,l=r.scene.getNonDeletedElementsMap(),c=Se.getElement(o,l);if(!c)return s.selectedLinearElement;const{points:d}=c,u=d[d.length-1];if(!t.altKey)return u===a&&Se.deletePoints(c,r,[d.length-1]),(m=s.selectedLinearElement)!=null&&m.lastUncommittedPoint?{...s.selectedLinearElement,lastUncommittedPoint:null}:s.selectedLinearElement;let f;if(E0(t)&&d.length>=2){const p=d[d.length-2],[U,b]=Se._getShiftLockedDelta(c,l,p,S(n,i),t[V.CTRL_OR_CMD]?null:r.getEffectiveGridSize());f=S(U+p[0],b+p[1])}else f=Se.createPointAt(c,l,n-s.selectedLinearElement.pointerOffset.x,i-s.selectedLinearElement.pointerOffset.y,t[V.CTRL_OR_CMD]||me(c)?null:r.getEffectiveGridSize());return u===a?Se.movePoints(c,r.scene,new Map([[c.points.length-1,{point:f}]])):Se.addPoints(c,r.scene,[f]),{...s.selectedLinearElement,lastUncommittedPoint:c.points[c.points.length-1]}}static getPointGlobalCoordinates(t,n,i){const[r,s,o,a]=$e(t,i),l=(r+o)/2,c=(s+a)/2,{x:d,y:u}=t;return Q(S(d+n[0],u+n[1]),S(l,c),t.angle)}static getPointsGlobalCoordinates(t,n){const[i,r,s,o]=$e(t,n),a=(i+s)/2,l=(r+o)/2;return t.points.map(c=>{const{x:d,y:u}=t;return Q(S(d+c[0],u+c[1]),S(a,l),t.angle)})}static getPointAtIndexGlobalCoordinates(t,n,i){const r=n<0?t.points.length+n:n,[s,o,a,l]=$e(t,i),c=(s+a)/2,d=(o+l)/2,u=t.points[r],{x:f,y:h}=t;return Q(u?S(f+u[0],h+u[1]):S(f,h),S(c,d),t.angle)}static pointFromAbsoluteCoords(t,n,i){if(me(t))return S(n[0]-t.x,n[1]-t.y);const[r,s,o,a]=$e(t,i),l=(r+o)/2,c=(s+a)/2,[d,u]=Q(S(n[0],n[1]),S(l,c),-t.angle);return S(d-t.x,u-t.y)}static getPointIndexUnderCursor(t,n,i,r,s){const o=Se.getPointsGlobalCoordinates(t,n);let a=o.length;for(;--a>-1;){const l=o[a];if(ct(S(r,s),S(l[0],l[1]))*i.value<Se.POINT_HANDLE_SIZE+1)return a}return-1}static createPointAt(t,n,i,r,s){const o=Pn(i,r,s),[a,l,c,d]=$e(t,n),u=(a+c)/2,f=(l+d)/2,[h,m]=Q(S(o[0],o[1]),S(u,f),-t.angle);return S(h-t.x,m-t.y)}static getNormalizeElementPointsAndCoords(t){const{points:n,offsetX:i,offsetY:r}=$8(t);return{points:n,x:t.x+i,y:t.y+r}}static duplicateSelectedPoints(t,n){var f;gn((f=t.selectedLinearElement)==null?void 0:f.isEditing,"Not currently editing a linear element");const i=n.getNonDeletedElementsMap(),{selectedPointsIndices:r,elementId:s}=t.selectedLinearElement,o=Se.getElement(s,i);gn(o,"The linear element does not exist in the provided Scene"),gn(r!=null,"There are no selected points to duplicate");const{points:a}=o,l=[];let c=!1,d=-1;const u=a.reduce((h,m,p)=>{if(++d,h.push(m),r.includes(p)){const b=a[p+1];b||(c=!0),h.push(b?S((m[0]+b[0])/2,(m[1]+b[1])/2):S(m[0],m[1])),l.push(d+1),++d}return h},[]);if(n.mutateElement(o,{points:u}),c){const h=o.points[o.points.length-1];Se.movePoints(o,n,new Map([[o.points.length-1,{point:S(h[0]+30,h[1]+30)}]]))}return{...t,selectedLinearElement:{...t.selectedLinearElement,selectedPointsIndices:l}}}static deletePoints(t,n,i){var d,u;const r=((d=n.state.selectedLinearElement)==null?void 0:d.isEditing)&&((u=n.state.selectedLinearElement)==null?void 0:u.lastUncommittedPoint)===t.points[t.points.length-1],s=t.points.filter((f,h)=>!i.includes(h));nn(t)&&t.polygon&&(r||i.includes(0)||i.includes(t.points.length-1))&&(s[0]=S(s[s.length-1][0],s[s.length-1][1]));const{points:a,offsetX:l,offsetY:c}=$8({points:s});Se._updatePoints(t,n.scene,a,l,c)}static addPoints(t,n,i){const r=[...t.points,...i];nn(t)&&t.polygon&&(r[0]=S(r[r.length-1][0],r[r.length-1][1]));const{points:s,offsetX:o,offsetY:a}=$8({points:r});Se._updatePoints(t,n,s,o,a)}static movePoints(t,n,i,r){var d,u,f;const{points:s}=t;if(nn(t)&&t.polygon){const h=i.get(0),m=i.get(s.length-1);h?i.set(s.length-1,{point:S(h.point[0],h.point[1]),isDragging:h.isDragging}):m&&i.set(0,{point:S(m.point[0],m.point[1]),isDragging:m.isDragging})}const o=((d=i.get(0))==null?void 0:d.point)??S(0,0),[a,l]=o,c=me(t)?[((u=i.get(0))==null?void 0:u.point)??s[0],((f=i.get(s.length-1))==null?void 0:f.point)??s[s.length-1]]:s.map((h,m)=>{var U;const p=((U=i.get(m))==null?void 0:U.point)??h;return S(p[0]-a,p[1]-l)});Se._updatePoints(t,n,c,a,l,r,{isDragging:Array.from(i.values()).some(h=>h.isDragging)})}static shouldAddMidpoint(t,n,i,r){var c;const s=Se.getElement(t.elementId,r);if(s&&me(s)||!s)return!1;const{segmentMidpoint:o}=t.pointerDownState;if(o.added||o.value===null||o.index===null||t.pointerDownState.origin===null)return!1;const a=t.pointerDownState.origin,l=ct(S(a.x,a.y),S(n.x,n.y));return!(!((c=i.selectedLinearElement)!=null&&c.isEditing)&&l<hB/i.zoom.value)}static addMidpoint(t,n,i,r,s){const o=s.getNonDeletedElementsMap(),a=Se.getElement(t.elementId,o);if(!a)return;const{segmentMidpoint:l}=t.pointerDownState,c={pointerDownState:t.pointerDownState,selectedPointsIndices:t.selectedPointsIndices},d=Se.createPointAt(a,o,n.x,n.y,r&&!me(a)?i.getEffectiveGridSize():null),u=[...a.points.slice(0,l.index),d,...a.points.slice(l.index)];return s.mutateElement(a,{points:u}),c.pointerDownState={...t.pointerDownState,segmentMidpoint:{...t.pointerDownState.segmentMidpoint,added:!0},lastClickedPoint:l.index},c.selectedPointsIndices=[l.index],c}static _updatePoints(t,n,i,r,s,o,a){if(me(t)){const l={};(o==null?void 0:o.startBinding)!==void 0&&(l.startBinding=o.startBinding!==null&&Vh(o.startBinding)?o.startBinding:null),(o==null?void 0:o.endBinding)!==void 0&&(l.endBinding=o.endBinding!==null&&Vh(o.endBinding)?o.endBinding:null),l.points=Array.from(i),n.mutateElement(t,l,{informMutation:!0,isDragging:(a==null?void 0:a.isDragging)??!1})}else{const l=hM(t,i),c=hM(t,t.points),d=(l[0]+l[2])/2,u=(l[1]+l[3])/2,f=(c[0]+c[2])/2,h=(c[1]+c[3])/2,m=f-d,p=h-u,U=Q(S(r,s),S(m,p),t.angle);n.mutateElement(t,{...o,points:i,x:t.x+U[0],y:t.y+U[1]})}}static _getShiftLockedDelta(t,n,i,r,s,o){const a=Se.getPointGlobalCoordinates(t,i,n);if(me(t))return[r[0]-a[0],r[1]-a[1]];const[l,c]=Pn(r[0],r[1],s),{width:d,height:u}=z4(a[0],a[1],l,c,o);return Q(S(d,u),S(0,0),-t.angle)}static moveFixedSegment(t,n,i,r,s){const o=s.getNonDeletedElementsMap(),a=Se.getElement(t.elementId,o);if(!a||!me(a))return t;if(n&&n>0&&n<a.points.length){const l=Fo(Xh(he(a.points[n],a.points[n-1]))),c=(a.fixedSegments??[]).reduce((h,m)=>(h[m.index]=m,h),{});c[n]={index:n,start:S(l?a.points[n-1][0]:i-a.x,l?r-a.y:a.points[n-1][1]),end:S(l?a.points[n][0]:i-a.x,l?r-a.y:a.points[n][1])};const d=Object.values(c).sort((h,m)=>h.index-m.index),u=d.map(h=>h.index).reduce((h,m)=>m<n?h+1:h,0);s.mutateElement(a,{fixedSegments:d});const f=S(a.x+(a.fixedSegments[u].start[0]+a.fixedSegments[u].end[0])/2,a.y+(a.fixedSegments[u].start[1]+a.fixedSegments[u].end[1])/2);return{...t,segmentMidPointHoveredCoords:f,pointerDownState:{...t.pointerDownState,segmentMidpoint:{added:!1,index:a.fixedSegments[u].index,value:f}}}}return t}static deleteFixedSegment(t,n,i){var r;n.mutateElement(t,{fixedSegments:(r=t.fixedSegments)==null?void 0:r.filter(s=>s.index!==i)})}};F(Se,"POINT_HANDLE_SIZE",10),F(Se,"getEditorMidPoints",(t,n,i)=>{var l;const r=Le(t,n);if(!me(t)&&!((l=i.selectedLinearElement)!=null&&l.isEditing)&&t.points.length>2&&!r)return[];const s=Se.getPointsGlobalCoordinates(t,n);let o=0;const a=[];for(;o<s.length-1;){if(Se.isSegmentTooShort(t,t.points[o],t.points[o+1],o,i.zoom)){a.push(null),o++;continue}const c=Se.getSegmentMidPoint(t,o+1);a.push(c),o++}return a}),F(Se,"getSegmentMidpointHitCoords",(t,n,i,r)=>{var h;const{elementId:s}=t,o=Se.getElement(s,r);if(!o)return null;const a=Se.getPointIndexUnderCursor(o,r,i.zoom,n.x,n.y);if(!me(o)&&a>=0||Se.getPointsGlobalCoordinates(o,r).length>=3&&!((h=i.selectedLinearElement)!=null&&h.isEditing)&&!me(o))return null;const c=(Se.POINT_HANDLE_SIZE+1)/i.zoom.value,d=t.segmentMidPointHoveredCoords;if(d&&ct(S(d[0],d[1]),S(n.x,n.y))<=c)return d;let u=0;const f=Se.getEditorMidPoints(o,r,i);for(;u<f.length;){if(f[u]!==null&&ct(f[u],S(n.x,n.y))<=c)return f[u];u++}return null}),F(Se,"getBoundTextElementPosition",(t,n,i)=>{Se.getPointsGlobalCoordinates(t,i).length<2&&_i(n,i,{isDeleted:!0});let s=0,o=0;if(t.points.length%2===1){const a=Math.floor(t.points.length/2),l=Se.getPointGlobalCoordinates(t,t.points[a],i);s=l[0]-n.width/2,o=l[1]-n.height/2}else{const a=t.points.length/2-1,l=Se.getSegmentMidPoint(t,a+1);s=l[0]-n.width/2,o=l[1]-n.height/2}return{x:s,y:o}}),F(Se,"getMinMaxXYWithBoundText",(t,n,i,r)=>{let[s,o,a,l]=i;const c=(s+a)/2,d=(o+l)/2,{x:u,y:f}=Se.getBoundTextElementPosition(t,r,n),h=u+r.width,m=f+r.height,p=S(c,d),U=Q(S(s,o),p,t.angle),b=Q(S(a,o),p,t.angle),y=Q(S(u,f),p,-t.angle),w=Q(S(h,f),p,-t.angle),v=Q(S(u,m),p,-t.angle),I=Q(S(h,m),p,-t.angle);return U[0]<b[0]&&U[1]>=b[1]?(s=Math.min(s,v[0]),a=Math.max(a,Math.max(w[0],I[0])),o=Math.min(o,y[1]),l=Math.max(l,I[1])):U[0]>=b[0]&&U[1]>b[1]?(s=Math.min(s,I[0]),a=Math.max(a,Math.max(y[0],w[0])),o=Math.min(o,v[1]),l=Math.max(l,w[1])):U[0]>=b[0]?(s=Math.min(s,w[0]),a=Math.max(a,v[0]),o=Math.min(o,I[1]),l=Math.max(l,y[1])):U[1]<=b[1]&&(s=Math.min(s,Math.min(w[0],y[0])),a=Math.max(a,I[0]),o=Math.min(o,w[1]),l=Math.max(l,v[1])),[s,o,a,l,c,d]}),F(Se,"getElementAbsoluteCoords",(t,n,i=!1)=>{let r,s,o,a,l;if(t.points.length<2||!qt.get(t)){const{minX:f,minY:h,maxX:m,maxY:p}=t.points.reduce((U,[b,y])=>(U.minY=Math.min(U.minY,y),U.minX=Math.min(U.minX,b),U.maxX=Math.max(U.maxX,b),U.maxY=Math.max(U.maxY,y),U),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});s=f+t.x,o=h+t.y,a=m+t.x,l=p+t.y}else{const f=qt.generateElementShape(t,null),h=Vu(f[0]),[m,p,U,b]=gy(h);s=m+t.x,o=p+t.y,a=U+t.x,l=b+t.y}const c=(s+a)/2,d=(o+l)/2;if(r=[s,o,a,l,c,d],!i)return r;const u=Le(t,n);return u&&(r=Se.getMinMaxXYWithBoundText(t,n,[s,o,a,l],u)),r});let pe=Se;const Ole=e=>{let t=[...new Set(e.filter(n=>n!==null&&n!==-1))];return t=t.sort((n,i)=>n-i),t.length?t:null};function JA(e){return[Math.min(e[0][0],e[1][0]),Math.min(e[0][1],e[1][1]),Math.max(e[0][0],e[1][0]),Math.max(e[0][1],e[1][1])]}function Ple(e,t){return e[0]<=t[2]&&e[2]>=t[0]&&e[1]<=t[3]&&e[3]>=t[1]}const Fle=1e-6;function eM(e,t){const n=he(e[1],e[0]),i=he(t,e[0]),r=bt(n,i);return Math.abs(r)<Fle}function G8(e,t){const n=he(e[1],e[0]),i=he(t,e[0]);return bt(n,i)<0}function tM(e,t){return eM(e,t[0])||eM(e,t[1])||(G8(e,t[0])?!G8(e,t[1]):G8(e,t[1]))}function Ble(e,t){return Ple(JA(e),JA(t))&&tM(e,t)&&tM(t,e)}const zle=e=>e.type==="diamond"?[S(e.width/2,0),S(e.width,e.height/2),S(e.width/2,e.height),S(0,e.height/2)]:[S(0,0),S(0+e.width,0),S(0+e.width,e.height),S(0,e.height)],Hle=e=>xe(e)||qi(e)?e.points:zle(e),nM=e=>{const t=e.reduce((n,[i,r])=>(n.minY=Math.min(n.minY,r),n.minX=Math.min(n.minX,i),n.maxX=Math.max(n.maxX,i),n.maxY=Math.max(n.maxY,r),n),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0,cx:0,cy:0});return t.cx=(t.maxX+t.minX)/2,t.cy=(t.maxY+t.minY)/2,t},Vle=e=>{const t=Hle(e),{cx:n,cy:i}=nM(t),r=S(n,i),s=t.map(d=>Q(d,r,e.angle)),{minX:o,minY:a,maxX:l,maxY:c}=nM(s);return[o+e.x,a+e.y,l+e.x,c+e.y]},$le=(e,t)=>{const n=Vle(e);return(BU(n[0],Vi(t[0],t[2]))||BU(t[0],Vi(n[0],n[2])))&&(BU(n[1],Vi(t[1],t[3]))||BU(t[1],Vi(n[1],n[3])))},Gle=({elements:e,bounds:t,type:n,errorMargin:i=0})=>{var o;lz(t)&&(t=si(t,ve(e)));const r=[t[0]-i,t[1]-i,t[2]+i,t[3]+i],s=new Set;for(const a of e){if(s.has(a.id))continue;if($le(a,r)){if(s.add(a.id),a.boundElements)for(const c of a.boundElements)s.add(c.id);ge(a)&&a.containerId&&s.add(a.containerId),Ce(a)&&(a.startBinding&&s.add(a.startBinding.elementId),a.endBinding&&s.add((o=a.endBinding)==null?void 0:o.elementId))}}return e.filter(a=>s.has(a.id))},Rz=(e,t,n)=>{const i=n.reduce((r,s)=>(s.groupIds.includes(e)&&(r[s.id]=!0),r),{});return Object.keys(i).length<2?t.selectedGroupIds[e]||t.editingGroupId===e?{selectedElementIds:t.selectedElementIds,selectedGroupIds:{...t.selectedGroupIds,[e]:!1},editingGroupId:null}:t:{editingGroupId:t.editingGroupId,selectedGroupIds:{...t.selectedGroupIds,[e]:!0},selectedElementIds:{...t.selectedElementIds,...i}}},Si=function(){let e=null,t=null,n=null;const i=(s,o,a,l)=>{if(n!==void 0&&o===t&&s===e&&a.editingGroupId===(n==null?void 0:n.editingGroupId))return n;const c={};for(const f of s){let h=f.groupIds;if(a.editingGroupId){const m=h.indexOf(a.editingGroupId);m>-1&&(h=h.slice(0,m))}if(h.length>0){const m=h[h.length-1];c[m]=!0}}const d={},u=o.reduce((f,h)=>{if(h.isDeleted)return f;const m=h.groupIds.find(p=>c[p]);return m&&(f[h.id]=!0,Array.isArray(d[m])?d[m].push(h.id):d[m]=[h.id]),f},{});for(const f of Object.keys(d))d[f].length<2&&c[f]&&(c[f]=!1);return t=o,e=s,n={editingGroupId:a.editingGroupId,selectedGroupIds:c,selectedElementIds:xt({...a.selectedElementIds,...u},l)},n},r=(s,o,a,l)=>{const c=l?l.scene.getSelectedElements({selectedElementIds:s.selectedElementIds,elements:o}):Xe(o,s);return c.length?i(c,o,s,a):{selectedGroupIds:{},editingGroupId:null,selectedElementIds:xt(s.selectedElementIds,a)}};return r.clearCache=()=>{t=null,e=null,n=null},r}(),U9=(e,t)=>Dz(e,t)!=null,Dz=(e,t)=>t.groupIds.filter(n=>n!==e.editingGroupId).find(n=>e.selectedGroupIds[n]),_c=e=>Object.entries(e.selectedGroupIds).filter(([t,n])=>n).map(([t,n])=>t),kp=(e,t)=>{let n={...t,selectedGroupIds:{}};for(const i of e){let r=i.groupIds;if(t.editingGroupId){const s=r.indexOf(t.editingGroupId);s>-1&&(r=r.slice(0,s))}if(r.length>0){const s=r[r.length-1];n={...n,...Rz(s,n,e)}}}return n.selectedGroupIds},Xle=(e,t)=>({...e,editingGroupId:t.groupIds.length?t.groupIds[0]:null,selectedGroupIds:{},selectedElementIds:{[t.id]:!0}}),pm=(e,t)=>e.groupIds.includes(t),At=(e,t)=>{const n=[];for(const i of e.values())pm(i,t)&&n.push(i);return n},Lz=(e,t)=>e.groupIds.find(n=>t[n]),jle=(e,t,n)=>{const i=[...e],r=n?i.indexOf(n):-1,s=r>-1?r:i.length;return i.splice(s,0,t),i},Yle=(e,t)=>e.filter(n=>!t[n]),Nz=(e,t)=>{const n=new Map;return e.forEach(i=>{const r=i.groupIds.length===0?i.id:i.groupIds[i.groupIds.length-1],s=n.get(r)||[],o=Le(i,t);o&&s.push(o),n.set(r,[...s,i])}),Array.from(n.values())},Wle=e=>{const t=new Set;for(const[,n]of e)if(!n.isDeleted)for(const i of n.groupIds??[])t.add(i);return t},b9=e=>{const t=e.flatMap(r=>r.groupIds),n=new Map;let i=0;for(const r of t)n.set(r,(n.get(r)??0)+1),n.get(r)>i&&(i=n.get(r));return i===e.length},jh=e=>e.groupIds.length>0,Kle=(e,t,n)=>{const i=[...e],r=t?e.indexOf(t):-1,s=r>-1?r:e.length;for(let o=0;o<s;o++)i[o]=n(i[o]);return i},cy=(e,t,n)=>{const i=_c(n),r=e.filter(u=>!Dt(u)),s=new Map,o=new Map,a=u=>{const f=o.get(u.id)||[],h=Le(u,t);h&&f.push(h),o.set(u.id,[...f,u])},l=(u,f)=>{const h=s.get(f)||[],m=Le(u,t);m&&h.push(m),s.set(f,[...h,u])},c=(u,f)=>{const h=u.groupIds.indexOf(f,0);return u.groupIds.slice(0,h).length>0?l(u,u.groupIds[h-1]):a(u)},d=e.every(u=>U9(n,u));return r.forEach(u=>{const f=Lz(u,n.selectedGroupIds);f?i.length===1&&d?c(u,f):l(u,f):a(u)}),Array.from(s.values()).concat(Array.from(o.values()))},y9=e=>{const t=new Set;return e.forEach(n=>{we(n)&&t.add(n.id)}),e.filter(n=>!(n.frameId&&t.has(n.frameId)))},E9=(e,t,n,i=!0)=>{const[r,s,o,a]=$e(t,n);let l=e.filter(c=>{let[d,u,f,h]=si(c,n);const m=Cr(c,n);if(m){const[p,U,b,y]=si(m,n);d=Math.max(p,d),u=Math.max(U,u),f=Math.min(b,f),h=Math.min(y,h)}return c.locked===!1&&c.type!=="selection"&&!Dt(c)&&r<=d&&s<=u&&o>=f&&a>=h});return l=i?y9(l):l,l=l.filter(c=>{const d=Cr(c,n);return d?Vc(c,d,n):!0}),l},Oz=(e,t,n,i)=>{const r=new Set(t.map(s=>s.id));return e.filter(s=>{const o=A6(s,n.width,n.height,n,i);return!r.has(s.id)&&o})},Wn=function(){let e=null,t=null,n=null;const i=(r,s)=>(n!=null&&r===e&&s.selectedElementIds===t||(n=r.some(o=>s.selectedElementIds[o.id]),e=r,t=s.selectedElementIds),n);return i.clearCache=()=>{e=null,t=null,n=null},i}(),Xe=(e,t,n)=>{const i=new Set,r=[];for(const s of e.values()){if(t.selectedElementIds[s.id]){r.push(s),i.add(s.id);continue}if(n!=null&&n.includeBoundTextElement&&Dt(s)&&t.selectedElementIds[s==null?void 0:s.containerId]){r.push(s),i.add(s.id);continue}}if(n!=null&&n.includeElementsInFrames){const s=[];return r.forEach(o=>{we(o)&&ns(e,o.id).forEach(a=>!i.has(a.id)&&s.push(a)),s.push(o)}),s}return r},dy=(e,t)=>t.editingTextElement?[t.editingTextElement]:t.newElement?[t.newElement]:Xe(e,t,{includeBoundTextElement:!0}),xt=(e,t)=>Ki(t.selectedElementIds,e)?t.selectedElementIds:e,Zle=(e,t)=>{var i;const n=e.filter(xe);if(n.length===1){const r=n[0],s=((i=r.boundElements)==null?void 0:i.map(a=>a.id))??[];if(e.every(a=>a.id===r.id||s.includes(a.id)))return new pe(r,ve(t))}return null},Pz=(e,t,n)=>({selectedLinearElement:Zle(e,t),...Si({editingGroupId:n.editingGroupId,selectedElementIds:y9(e).reduce((i,r)=>(Dt(r)||(i[r.id]=!0),i),{})},t,n,null)}),qle=(e,t,n)=>{const i=ve(e);for(const r of t)if(r.frameId){const s=n.get(r.id),o=n.get(r.frameId),a=s&&i.get(s);a&&_i(a,i,{frameId:o??null})}};function v9(e,t,n){const i=x6(t,n),r=x6(e,n);return i.some(o=>r.some(a=>Ble(o,a)))}const Fz=(e,t,n)=>fy(E9(e,t,n,!1)).filter(i=>!we(i)&&!i.frameId||i.frameId===t.id),w9=(e,t,n)=>E9([t],e,n).some(i=>i.id===t.id),Rp=(e,t,n)=>{const[i,r,s,o]=$e(t,n),[a,l,c,d]=ht(e);return i<=a&&r<=l&&s>=c&&o>=d},Vc=(e,t,n)=>Rp([e],t,n)||v9(e,t,n)||w9(e,t,n),iM=(e,t,n)=>{const[i,r,s,o]=$e(t,n);return fm(S(i,r),S(e.x,e.y),S(s,o))},Qle=e=>{const t=new Map;for(const n of e){const i=we(n)?n.id:n.frameId;i&&!t.has(i)&&t.set(i,ns(e,i))}return t},ns=(e,t)=>{const n=[];for(const i of e.values())i.frameId===t&&n.push(i);return n},_9=e=>e.filter(t=>we(t)),T9=e=>{const t=ve(_9(e));return e.filter(n=>t.has(n.id)||!n.frameId||!t.has(n.frameId))},jo=(e,t,n,i)=>{const r=ns(e,t.id),s=new Set(r),o=new Set([...Fz(e,t,i),...r.filter(f=>w9(f,t,i))]),a=r.filter(f=>!o.has(f)),l=new Set(Array.from(o).flatMap(f=>f.groupIds));for(const f of a)if(!v9(f,t,i))f.groupIds.length===0&&s.delete(f);else if(f.groupIds.length>0)for(const h of f.groupIds)l.add(h);for(const f of a)if(f.groupIds.length>0){let h=!0;for(const m of f.groupIds)l.has(m)&&(h=!1);h&&s.delete(f)}const c=Array.from(o).filter(f=>f.groupIds.length===0);for(const f of c)s.add(f);const d=Array.from(o).filter(f=>f.groupIds.length>0),u=kp(d,n);for(const[f,h]of Object.entries(u))if(h){const m=At(e,f);if(Rp(m,t,i))for(const p of m)s.add(p)}return[...s].filter(f=>!(ge(f)&&f.containerId))},Jle=(e,t,n)=>ece(fy(e,Fz(e,t,n)),t,n),ece=(e,t,n)=>{const i=[],r=new Map;for(const s of e){let o=!1;if(s.groupIds.length>0){if(s.groupIds.some(a=>r.get(a)))o=!0;else{const a=new Set(s.groupIds.flatMap(l=>At(n,l)));o=!Rp(Array.from(a),t,n)}s.groupIds.forEach(a=>{r.set(a,o)})}o||i.push(s)}return i},Cr=(e,t)=>e.frameId&&t.get(e.frameId)||null,tce=(e,t)=>{const n=new Set,i=ve(e);e=fy(e);for(const o of e)we(o)&&o.id!==t.id&&n.add(o.id);const r=new Set,s=[];for(const o of e)if(!(we(o)||o.frameId&&n.has(o.frameId)))if(o.groupIds.length){const a=o.groupIds.at(-1);if(!r.has(a)){r.add(a);const l=At(e,a);if(l.some(c=>Vc(c,t,i)))for(const c of l)s.push(c)}}else Vc(o,t,i)&&s.push(o);return s},I0=(e,t,n,i)=>{const r=ve(e),s=new Map;for(const c of e.values())c.frameId===n.id&&s.set(c.id,!0);const o=new Set(t.map(c=>c.id)),a=[],l=new Set;for(const c of t)we(c)&&c.id!==n.id&&l.add(c.id);for(const c of fy(e,t)){if(we(c)||c.frameId&&l.has(c.frameId)||c.frameId&&i.selectedElementIds[c.id]&&i.selectedElementIds[c.frameId])continue;s.has(c.id)||a.push(c);const d=Le(c,r);d&&!o.has(d.id)&&!s.has(d.id)&&a.push(d)}for(const c of a)_i(c,r,{frameId:n.id});return e},uy=(e,t)=>{const n=new Map,i=new Map;for(const r of e)if(r.frameId){n.set(r.id,r);const s=i.get(r.frameId)||[];s.push(r);const o=Le(r,t);o&&(n.set(o.id,o),s.push(o)),i.set(r.frameId,s)}for(const[,r]of n)_i(r,t,{frameId:null})},Bz=(e,t)=>{const n=ns(e,t.id);return uy(n,ve(e)),e},Ig=(e,t,n,i)=>I0(Bz(e,n),t,n,i.state).slice(),Yh=(e,t,n)=>{const i=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,elements:e}),r=new Set(i);if(t.editingGroupId)for(const a of i)a.groupIds.length===0?r.add(a):a.groupIds.flatMap(l=>At(e,l)).forEach(l=>r.add(l));const s=new Set,o=ve(e);return r.forEach(a=>{a.frameId&&!we(a)&&!w6(a,o,t)&&s.add(a)}),s.size>0&&uy(s,o),e},fy=(e,t)=>{const n=new Set,i=t||e;for(const o of i.values()){const a=o.groupIds[o.groupIds.length-1];a&&n.add(a)}const r=new Set;for(const o of n)At(e,o).some(a=>we(a))&&r.add(o);const s=[];for(const o of i.values())r.has(o.groupIds[o.groupIds.length-1])||s.push(o);return s},v6=(e,t,n)=>{const i=ge(e)&&Yn(e,t)||e;return i.frameId&&n.selectedElementIds[i.id]&&n.selectedElementIds[i.frameId]?Cr(i,t):n.selectedElementIds[i.id]&&n.selectedElementsAreBeingDragged?n.frameToHighlight:Cr(i,t)},w6=(e,t,n,i)=>{var l;const r=(i==null?void 0:i.targetFrame)??v6(e,t,n);if(!r)return!1;const s=ge(e)&&Yn(e,t)||e,o=c=>{i!=null&&i.checkedGroups&&s.groupIds.forEach(d=>{var u;(u=i.checkedGroups)==null||u.set(d,c)})};if(!n.selectedElementIds[s.id]||!n.selectedElementsAreBeingDragged||n.selectedElementIds[s.id]&&n.selectedElementIds[r.id])return!0;if(s.groupIds.length===0)return Vc(s,r,t);for(const c of s.groupIds)if((l=i==null?void 0:i.checkedGroups)!=null&&l.has(c))return i.checkedGroups.get(c);const a=new Set(s.groupIds.filter(c=>i!=null&&i.checkedGroups?!i.checkedGroups.has(c):!0).flatMap(c=>At(t,c)));if(n.editingGroupId&&n.selectedElementsAreBeingDragged){const c=new Set(Xe(t,n));if(n.frameToHighlight!==null)return!0;c.forEach(u=>{a.delete(u)})}for(const c of a)if(we(c))return o(!1),!1;for(const c of a)if(Vc(c,r,t))return o(!0),!0;return!1},O4=(e,t,n,i,r)=>{if(!n.frameRendering||!n.frameRendering.clip)return!1;const s=v9(e,t,i)||w9(e,t,i);if(s){for(const o of e.groupIds)r==null||r.set(o,!0);return!0}if(!s&&e.groupIds.length>0&&!Rp([e],t,i)){let o=!1;if(n.selectedElementsAreBeingDragged)o=w6(e,i,n,{targetFrame:t,checkedGroups:r});else{o=e.frameId===t.id;for(const a of e.groupIds)r==null||r.set(a,o)}for(const a of e.groupIds)r==null||r.set(a,o);return o}return!1},nce="Frame",ice="AI Frame",I9=e=>az(e)?nce:ice,zz=e=>e.name===null?I9(e):e.name,S9=(e,t)=>Gle({elements:e,bounds:t,type:"overlap"}).filter(n=>!n.frameId||n.frameId===t.id),Hz=e=>{const t=ve(e);return e.length>1&&e.some(n=>n.frameId&&t.has(n.frameId))},Vz="invert(100%) hue-rotate(180deg) saturate(1.25)",$z=(e,t)=>Dn(e)&&!t.imageCache.has(e.fileId),Gz=(e,t,n)=>{var i;return n.theme===ke.DARK&&Dn(e)&&!$z(e,t)&&((i=t.imageCache.get(e.fileId))==null?void 0:i.mimeType)!==Te.svg},hy=e=>{switch(e.type){case"freedraw":return e.strokeWidth*12;case"text":return e.fontSize/2;case"arrow":return e.endArrowhead||e.endArrowhead?40:20;default:return 20}},Xz=(e,t,n,i,r=1)=>{let s=((t==null?void 0:t.opacity)??100)*e.opacity/1e4*r;return(n.has(e.id)||i&&i.some(o=>o.id===e.id)||t&&n.has(t.id))&&(s*=ese/100),s},rce=(e,t,n)=>{const s=hy(e),[o,a,l,c]=$e(e,t),d=xe(e)||qi(e)?Gi(o,l):e.width,u=xe(e)||qi(e)?Gi(a,c):e.height;let f=d*window.devicePixelRatio+s*2,h=u*window.devicePixelRatio+s*2,m=n.value;return(f*m>32767||h*m>32767)&&(m=Math.min(32767/f,32767/h)),f*h*m*m>16777216&&(m=Math.sqrt(16777216/(f*h))),f=Math.floor(f*m),h=Math.floor(h*m),{width:f,height:h,scale:m}},jz=(e,t,n,i,r)=>{var b,y;const s=document.createElement("canvas"),o=s.getContext("2d"),a=hy(e),{width:l,height:c,scale:d}=rce(e,t,n);if(!l||!c)return null;s.width=l,s.height=c;let u=-100,f=0;if(xe(e)||qi(e)){const[w,v]=$e(e,t);u=e.x>w?Gi(e.x,w)*window.devicePixelRatio*d:0,f=e.y>v?Gi(e.y,v)*window.devicePixelRatio*d:0,o.translate(u,f)}o.save(),o.translate(a*d,a*d),o.scale(window.devicePixelRatio*d,window.devicePixelRatio*d);const h=od.canvas(s);Gz(e,i,r)&&(o.filter=Vz),V2(e,h,o,i),o.restore();const m=Le(e,t),p=document.createElement("canvas"),U=p.getContext("2d");if(Ce(e)&&m){const[w,v,I,C]=$e(e,t),_=Math.max(Gi(w,I),Gi(v,C));p.width=_*window.devicePixelRatio*d+a*d*10,p.height=_*window.devicePixelRatio*d+a*d*10,U.translate(p.width/2,p.height/2),U.rotate(e.angle),U.drawImage(s,-s.width/2,-s.height/2,s.width,s.height);const[,,,,T,k]=$e(m,t);U.rotate(-e.angle);const x=(p.width-s.width)/2,D=(p.height-s.height)/2,O=p.width/2-(T-w)*window.devicePixelRatio*d-x-a*d,L=p.height/2-(k-v)*window.devicePixelRatio*d-D-a*d;U.translate(-O,-L),U.clearRect(-(m.width/2+$n)*window.devicePixelRatio*d,-(m.height/2+$n)*window.devicePixelRatio*d,(m.width+$n*2)*window.devicePixelRatio*d,(m.height+$n*2)*window.devicePixelRatio*d)}return{element:e,canvas:s,theme:r.theme,scale:d,zoomValue:n.value,canvasOffsetX:u,canvasOffsetY:f,boundTextElementVersion:((b=Le(e,t))==null?void 0:b.version)||null,containingFrameOpacity:((y=Cr(e,t))==null?void 0:y.opacity)||100,boundTextCanvas:p,angle:e.angle,imageCrop:yt(e)?e.crop:null}},Yz=typeof document<"u"?document.createElement("img"):{src:""};Yz.src=`data:${Te.svg},${encodeURIComponent('<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="image" class="svg-inline--fa fa-image fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="#888" d="M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48zM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56zM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48z"></path></svg>')}`;const Wz=typeof document<"u"?document.createElement("img"):{src:""};Wz.src=`data:${Te.svg},${encodeURIComponent('<svg viewBox="0 0 668 668" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2"><path d="M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48ZM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56ZM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48Z" style="fill:#888;fill-rule:nonzero" transform="matrix(.81709 0 0 .81709 124.825 145.825)"/><path d="M256 8C119.034 8 8 119.033 8 256c0 136.967 111.034 248 248 248s248-111.034 248-248S392.967 8 256 8Zm130.108 117.892c65.448 65.448 70 165.481 20.677 235.637L150.47 105.216c70.204-49.356 170.226-44.735 235.638 20.676ZM125.892 386.108c-65.448-65.448-70-165.481-20.677-235.637L361.53 406.784c-70.203 49.356-170.226 44.736-235.638-20.676Z" style="fill:#888;fill-rule:nonzero" transform="matrix(.30366 0 0 .30366 506.822 60.065)"/></svg>')}`;const sce=(e,t)=>{t.fillStyle="#E7E7E7",t.fillRect(0,0,e.width,e.height);const n=Math.min(e.width,e.height),i=Math.min(n,Math.min(n*.4,100));t.drawImage(e.status==="error"?Wz:Yz,e.width/2-i/2,e.height/2-i/2,i,i)},V2=(e,t,n,i,r)=>{var s;switch(e.type){case"rectangle":case"iframe":case"embeddable":case"diamond":case"ellipse":{n.lineJoin="round",n.lineCap="round",t.draw(qt.get(e));break}case"arrow":case"line":{n.lineJoin="round",n.lineCap="round",qt.get(e).forEach(o=>{t.draw(o)});break}case"freedraw":{n.save(),n.fillStyle=e.strokeColor;const o=lce(e),a=qt.get(e);a&&t.draw(a),n.fillStyle=e.strokeColor,n.fill(o),n.restore();break}case"image":{const o=Dn(e)?(s=i.imageCache.get(e.fileId))==null?void 0:s.image:void 0;if(o!=null&&!(o instanceof Promise)){e.roundness&&n.roundRect&&(n.beginPath(),n.roundRect(0,0,e.width,e.height,ur(Math.min(e.width,e.height),e)),n.clip());const{x:a,y:l,width:c,height:d}=e.crop?e.crop:{x:0,y:0,width:o.naturalWidth,height:o.naturalHeight};n.drawImage(o,a,l,c,d,0,0,e.width,e.height)}else sce(e,n);break}default:if(ge(e)){const o=VB(e.text),a=o&&!n.canvas.isConnected;a&&document.body.appendChild(n.canvas),n.canvas.setAttribute("dir",o?"rtl":"ltr"),n.save(),n.font=mt(e),n.fillStyle=e.strokeColor,n.textAlign=e.textAlign;const l=e.text.replace(/\r\n?/g,`
`).split(`
`),c=e.textAlign==="center"?e.width/2:e.textAlign==="right"?e.width:0,d=Sp(e.fontSize,e.lineHeight),u=IB(e.fontFamily,e.fontSize,d);for(let f=0;f<l.length;f++)n.fillText(l[f],c,f*d+u);n.restore(),a&&n.canvas.remove()}else throw new Error(`Unimplemented type ${e.type}`)}},P4=new WeakMap,rM=(e,t,n,i)=>{var u;const r=n?i.zoom:{value:1},s=P4.get(e),o=s&&s.zoomValue!==r.value&&!(i!=null&&i.shouldCacheIgnoreZoom),a=Le(e,t),l=(a==null?void 0:a.version)||null,c=yt(e)?e.crop:null,d=((u=Cr(e,t))==null?void 0:u.opacity)||100;if(!s||o||s.theme!==i.theme||s.boundTextElementVersion!==l||s.imageCrop!==c||s.containingFrameOpacity!==d||Ce(e)&&a&&e.angle!==s.angle){const f=jz(e,t,r,n,i);return f?(P4.set(e,f),f):null}return s},X8=(e,t,n,i,r)=>{const s=e.element,o=hy(s),a=e.scale,[l,c,d,u]=$e(s,r),f=((l+d)/2+i.scrollX)*window.devicePixelRatio,h=((c+u)/2+i.scrollY)*window.devicePixelRatio;t.save(),t.scale(1/window.devicePixelRatio,1/window.devicePixelRatio);const m=Le(s,r);if(Ce(s)&&m){const p=(e.boundTextCanvas.width-e.canvas.width)/2,U=(e.boundTextCanvas.height-e.canvas.height)/2;t.translate(f,h),t.drawImage(e.boundTextCanvas,-(d-l)/2*window.devicePixelRatio-p/a-o,-(u-c)/2*window.devicePixelRatio-U/a-o,e.boundTextCanvas.width/a,e.boundTextCanvas.height/a)}else t.translate(f,h),t.rotate(s.angle),"scale"in e.element&&!$z(s,n)&&t.scale(e.element.scale[0],e.element.scale[1]),t.translate(-f,-h),t.drawImage(e.canvas,(l+i.scrollX)*window.devicePixelRatio-o*e.scale/e.scale,(c+i.scrollY)*window.devicePixelRatio-o*e.scale/e.scale,e.canvas.width/e.scale,e.canvas.height/e.scale);t.restore()},oce=(e,t,n,i)=>{t.save(),t.translate(e.x+n.scrollX,e.y+n.scrollY),t.fillStyle="rgba(0, 0, 200, 0.04)";const r=.5/n.zoom.value;t.fillRect(r,r,e.width,e.height),t.lineWidth=1/n.zoom.value,t.strokeStyle=i,t.strokeRect(r,r,e.width,e.height),t.restore()},Sd=(e,t,n,i,r,s,o)=>{var l;const a=((l=o.openDialog)==null?void 0:l.name)==="elementLinkSelector"&&!o.selectedElementIds[e.id]&&!o.hoveredElementIds[e.id];switch(r.globalAlpha=Xz(e,Cr(e,t),s.elementsPendingErasure,s.pendingFlowchartNodes,a?TB:1),e.type){case"magicframe":case"frame":{o.frameRendering.enabled&&o.frameRendering.outline&&(r.save(),r.translate(e.x+o.scrollX,e.y+o.scrollY),r.fillStyle="rgba(0, 0, 200, 0.04)",r.lineWidth=zt.strokeWidth/o.zoom.value,r.strokeStyle=zt.strokeColor,z2(e)&&(r.strokeStyle=o.theme===ke.LIGHT?"#7affd7":"#1d8264"),r.roundRect?(r.beginPath(),r.roundRect(0,0,e.width,e.height,zt.radius/o.zoom.value),r.stroke(),r.closePath()):r.strokeRect(0,0,e.width,e.height),r.restore());break}case"freedraw":{if(qt.generateElementShape(e,null),s.isExporting){const[c,d,u,f]=$e(e,t),h=(c+u)/2+o.scrollX,m=(d+f)/2+o.scrollY,p=(u-c)/2-(e.x-c),U=(f-d)/2-(e.y-d);r.save(),r.translate(h,m),r.rotate(e.angle),r.translate(-p,-U),V2(e,i,r,s),r.restore()}else{const c=rM(e,n,s,o);if(!c)return;X8(c,r,s,o,n)}break}case"rectangle":case"diamond":case"ellipse":case"line":case"arrow":case"image":case"text":case"iframe":case"embeddable":{if(qt.generateElementShape(e,s),s.isExporting){const[c,d,u,f]=$e(e,t),h=(c+u)/2+o.scrollX,m=(d+f)/2+o.scrollY;let p=(u-c)/2-(e.x-c),U=(f-d)/2-(e.y-d);if(ge(e)){const y=Yn(e,t);if(Ce(y)){const w=pe.getBoundTextElementPosition(y,e,t);p=(u-c)/2-(w.x-c),U=(f-d)/2-(w.y-d)}}r.save(),r.translate(h,m),Gz(e,s,o)&&(r.filter="none");const b=Le(e,t);if(Ce(e)&&b){const y=document.createElement("canvas"),w=y.getContext("2d"),v=Math.max(Gi(c,u),Gi(d,f)),I=hy(e);y.width=v*o.exportScale+I*10*o.exportScale,y.height=v*o.exportScale+I*10*o.exportScale,w.translate(y.width/2,y.height/2),w.scale(o.exportScale,o.exportScale),p=e.width/2-(e.x-c),U=e.height/2-(e.y-d),w.rotate(e.angle);const C=od.canvas(y);w.translate(-p,-U),V2(e,C,w,s),w.translate(p,U),w.rotate(-e.angle);const[,,,,_,T]=$e(b,t),k=(c+u)/2-_,x=(d+f)/2-T;w.translate(-k,-x),w.clearRect(-b.width/2,-b.height/2,b.width,b.height),r.scale(1/o.exportScale,1/o.exportScale),r.drawImage(y,-y.width/2,-y.height/2,y.width,y.height)}else r.rotate(e.angle),e.type==="image"&&r.scale(e.scale[0],e.scale[1]),r.translate(-p,-U),V2(e,i,r,s);r.restore()}else{const c=rM(e,n,s,o);if(!c)return;const d=r.imageSmoothingEnabled;if(!(o!=null&&o.shouldCacheIgnoreZoom)&&(!e.angle||Tse(e.angle))&&(r.imageSmoothingEnabled=!1),e.id===o.croppingElementId&&yt(c.element)&&c.element.crop!==null){r.save(),r.globalAlpha=.1;const u=jz(mae(c.element,t),n,o.zoom,s,o);u&&X8(u,r,s,o,n),r.restore()}X8(c,r,s,o,n),r.imageSmoothingEnabled=d}break}default:throw new Error(`Unimplemented type ${e.type}`)}r.globalAlpha=1},Kz=new WeakMap([]);function ace(e){const t=Zz(e),n=new Path2D(t);return Kz.set(e,n),n}function lce(e){return Kz.get(e)}function Zz(e){return uce(qz(e))}function cce(e,t,n){const i=si({...e,angle:0},n),r=S((i[0]+i[2])/2,(i[1]+i[3])/2);return gn(t.length>=2,"Freepath outline must have at least 2 points"),t.slice(2).reduce((s,o)=>(s.push(Me(s[s.length-1][1],Q(S(o[0]+e.x,o[1]+e.y),r,e.angle))),s),[Me(Q(S(t[0][0]+e.x,t[0][1]+e.y),r,e.angle),Q(S(t[1][0]+e.x,t[1][1]+e.y),r,e.angle))])}function qz(e){const t=e.simulatePressure?e.points:e.points.length?e.points.map(([i,r],s)=>[i,r,e.pressures[s]]):[[0,0,.5]],n={simulatePressure:e.simulatePressure,size:e.strokeWidth*4.25,thinning:.6,smoothing:.5,streamline:.5,easing:i=>Math.sin(i*Math.PI/2),last:!!e.lastCommittedPoint};return fae(t,n)}function sM(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}const dce=/(\s?[A-Z]?,?-?[0-9]*\.[0-9]{0,2})(([0-9]|e|-)*)/g;function uce(e){if(!e.length)return"";const t=e.length-1;return e.reduce((n,i,r,s)=>(r===t?n.push(i,sM(i,s[0]),"L",s[0],"Z"):n.push(i,sM(i,s[r+1])),n),["M",e[0],"Q"]).join(" ").replace(dce,"$1")}const $c=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="ellipse"||e==="diamond"||e==="line"||e==="freedraw",F4=e=>e==="rectangle"||e==="ellipse"||e==="diamond"||e==="freedraw"||e==="arrow"||e==="line"||e==="text",_6=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="ellipse"||e==="diamond"||e==="freedraw"||e==="arrow"||e==="line",T6=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="ellipse"||e==="diamond"||e==="arrow"||e==="line",Um=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="line"||e==="diamond"||e==="image",I6=e=>e==="arrow",S6=e=>e==="arrow",Hi=class Hi{};F(Hi,"rg",new Hh),F(Hi,"cache",new WeakMap),F(Hi,"get",t=>Hi.cache.get(t)),F(Hi,"set",(t,n)=>Hi.cache.set(t,n)),F(Hi,"delete",t=>Hi.cache.delete(t)),F(Hi,"destroy",()=>{Hi.cache=new WeakMap}),F(Hi,"generateElementShape",(t,n)=>{const i=n!=null&&n.isExporting?void 0:Hi.get(t);if(i!==void 0)return i;P4.delete(t);const r=mce(t,Hi.rg,n||{isExporting:!1,canvasBackgroundColor:Ye.white,embedsValidationStatus:null});return Hi.cache.set(t,r),r});let qt=Hi;const fce=e=>[8,8+e],Qz=e=>[1.5,6+e];function hce(e){const t=e.roughness,n=Math.max(e.width,e.height),i=Math.min(e.width,e.height);return i>=20&&n>=50||i>=15&&e.roundness&&Um(e.type)||xe(e)&&n>=50?t:Math.min(t/(n<10?3:2),2.5)}const zr=(e,t=!1)=>{const n={seed:e.seed,strokeLineDash:e.strokeStyle==="dashed"?fce(e.strokeWidth):e.strokeStyle==="dotted"?Qz(e.strokeWidth):void 0,disableMultiStroke:e.strokeStyle!=="solid",strokeWidth:e.strokeStyle!=="solid"?e.strokeWidth+.5:e.strokeWidth,fillWeight:e.strokeWidth/2,hachureGap:e.strokeWidth*4,roughness:hce(e),stroke:e.strokeColor,preserveVertices:t||e.roughness<vB.cartoonist};switch(e.type){case"rectangle":case"iframe":case"embeddable":case"diamond":case"ellipse":return n.fillStyle=e.fillStyle,n.fill=Ir(e.backgroundColor)?void 0:e.backgroundColor,e.type==="ellipse"&&(n.curveFitting=1),n;case"line":case"freedraw":return Jo(e.points)&&(n.fillStyle=e.fillStyle,n.fill=e.backgroundColor==="transparent"?void 0:e.backgroundColor),n;case"arrow":return n;default:throw new Error(`Unimplemented type ${e.type}`)}},oM=(e,t,n)=>Es(e)&&(t||or(e)&&(n==null?void 0:n.get(e.id))!==!0)&&Ir(e.backgroundColor)&&Ir(e.strokeColor)?{...e,roughness:0,backgroundColor:"#d3d3d3",fillStyle:"solid"}:Zl(e)?{...e,strokeColor:Ir(e.strokeColor)?"#000000":e.strokeColor,backgroundColor:Ir(e.backgroundColor)?"#f4f4f6":e.backgroundColor}:e,aM=(e,t,n,i,r,s,o)=>{const a=fM(e,t,n,i);if(a===null)return[];const l=(c,d)=>{if(c===null)return[];const[,,u,f,h,m]=c;return[r.line(u,f,h,m,d)]};switch(i){case"dot":case"circle":case"circle_outline":{const[c,d,u]=a;return delete s.strokeLineDash,[r.circle(c,d,u,{...s,fill:i==="circle_outline"?o:e.strokeColor,fillStyle:"solid",stroke:e.strokeColor,roughness:Math.min(.5,s.roughness||0)})]}case"triangle":case"triangle_outline":{const[c,d,u,f,h,m]=a;return delete s.strokeLineDash,[r.polygon([[c,d],[u,f],[h,m],[c,d]],{...s,fill:i==="triangle_outline"?o:e.strokeColor,fillStyle:"solid",roughness:Math.min(1,s.roughness||0)})]}case"diamond":case"diamond_outline":{const[c,d,u,f,h,m,p,U]=a;return delete s.strokeLineDash,[r.polygon([[c,d],[u,f],[h,m],[p,U],[c,d]],{...s,fill:i==="diamond_outline"?o:e.strokeColor,fillStyle:"solid",roughness:Math.min(1,s.roughness||0)})]}case"crowfoot_one":return l(a,s);case"bar":case"arrow":case"crowfoot_many":case"crowfoot_one_or_many":default:{const[c,d,u,f,h,m]=a;if(e.strokeStyle==="dotted"){const p=Qz(e.strokeWidth-1);s.strokeLineDash=[p[0],p[1]-1]}else delete s.strokeLineDash;return s.roughness=Math.min(1,s.roughness||0),[r.line(u,f,c,d,s),r.line(h,m,c,d,s),...i==="crowfoot_one_or_many"?l(fM(e,t,n,"crowfoot_one"),s):[]]}}},gce=e=>{const t=new Hh,n={seed:e.seed,disableMultiStroke:!0,disableMultiStrokeFill:!0,roughness:0,preserveVertices:!0},i=Sg(e.points.reduce((r,s)=>[Math.min(e.x+s[0],r[0]),Math.min(e.y+s[1],r[1]),Math.max(e.x+s[0],r[2]),Math.max(e.y+s[1],r[3])],[1/0,1/0,-1/0,-1/0]));switch(e.type){case"line":case"arrow":{const r=e.points.length?e.points:[S(0,0)];return me(e)?t.path(Jz(r,16),n).sets[0].ops:e.roundness?t.curve(r,n).sets[0].ops.slice(0,e.points.length).map((s,o)=>{if(o===0){const a=Q(S(e.x+s.data[0],e.y+s.data[1]),i,e.angle);return{op:"move",data:S(a[0]-e.x,a[1]-e.y)}}return{op:"bcurveTo",data:[Q(S(e.x+s.data[0],e.y+s.data[1]),i,e.angle),Q(S(e.x+s.data[2],e.y+s.data[3]),i,e.angle),Q(S(e.x+s.data[4],e.y+s.data[5]),i,e.angle)].map(a=>S(a[0]-e.x,a[1]-e.y)).flat()}}):r.map((s,o)=>{const a=Q(S(e.x+s[0],e.y+s[1]),i,e.angle);return{op:o===0?"move":"lineTo",data:S(a[0]-e.x,a[1]-e.y)}})}case"freedraw":{if(e.points.length<2)return[];const r=e9(e.points,.75);return t.curve(r,n).sets[0].ops.slice(0,e.points.length).map((s,o)=>{if(o===0){const a=Q(S(e.x+s.data[0],e.y+s.data[1]),i,e.angle);return{op:"move",data:S(a[0]-e.x,a[1]-e.y)}}return{op:"bcurveTo",data:[Q(S(e.x+s.data[0],e.y+s.data[1]),i,e.angle),Q(S(e.x+s.data[2],e.y+s.data[3]),i,e.angle),Q(S(e.x+s.data[4],e.y+s.data[5]),i,e.angle)].map(a=>S(a[0]-e.x,a[1]-e.y)).flat()}})}}},mce=(e,t,{isExporting:n,canvasBackgroundColor:i,embedsValidationStatus:r})=>{switch(e.type){case"rectangle":case"iframe":case"embeddable":{let s;if(e.roundness){const o=e.width,a=e.height,l=ur(Math.min(o,a),e);s=t.path(`M ${l} 0 L ${o-l} 0 Q ${o} 0, ${o} ${l} L ${o} ${a-l} Q ${o} ${a}, ${o-l} ${a} L ${l} ${a} Q 0 ${a}, 0 ${a-l} L 0 ${l} Q 0 0, ${l} 0`,zr(oM(e,n,r),!0))}else s=t.rectangle(0,0,e.width,e.height,zr(oM(e,n,r),!1));return s}case"diamond":{let s;const[o,a,l,c,d,u,f,h]=C6(e);if(e.roundness){const m=ur(Math.abs(o-f),e),p=ur(Math.abs(c-a),e);s=t.path(`M ${o+m} ${a+p} L ${l-m} ${c-p}
            C ${l} ${c}, ${l} ${c}, ${l-m} ${c+p}
            L ${d+m} ${u-p}
            C ${d} ${u}, ${d} ${u}, ${d-m} ${u-p}
            L ${f+m} ${h+p}
            C ${f} ${h}, ${f} ${h}, ${f+m} ${h-p}
            L ${o-m} ${a+p}
            C ${o} ${a}, ${o} ${a}, ${o+m} ${a+p}`,zr(e,!0))}else s=t.polygon([[o,a],[l,c],[d,u],[f,h]],zr(e));return s}case"ellipse":return t.ellipse(e.width/2,e.height/2,e.width,e.height,zr(e));case"line":case"arrow":{let s;const o=zr(e),a=e.points.length?e.points:[S(0,0)];if(me(e)?a.every(l=>Math.abs(l[0])<=1e6&&Math.abs(l[1])<=1e6)?s=[t.path(Jz(a,16),zr(e,!0))]:(console.error("Elbow arrow with extreme point positions detected. Arrow not rendered.",e.id,JSON.stringify(a)),s=[]):e.roundness?s=[t.curve(a,o)]:o.fill?s=[t.polygon(a,o)]:s=[t.linearPath(a,o)],e.type==="arrow"){const{startArrowhead:l=null,endArrowhead:c="arrow"}=e;if(l!==null){const d=aM(e,s,"start",l,t,o,i);s.push(...d)}if(c!==null){const d=aM(e,s,"end",c,t,o,i);s.push(...d)}}return s}case"freedraw":{let s;if(ace(e),Jo(e.points)){const o=e9(e.points,.75);s=t.curve(o,{...zr(e),stroke:"none"})}else s=null;return s}case"frame":case"magicframe":case"text":case"image":return null;default:return qo(e,`generateElementShape(): Unimplemented type ${e==null?void 0:e.type}`),null}},Jz=(e,t)=>{const n=[];for(let r=1;r<e.length-1;r+=1){const s=e[r-1],o=e[r+1],a=e[r],l=Oa(a,s),c=Oa(o,a),d=Math.min(t,ct(e[r],o)/2,ct(e[r],s)/2);l?s[0]<a[0]?n.push([e[r][0]-d,e[r][1]]):n.push([e[r][0]+d,e[r][1]]):s[1]<a[1]?n.push([e[r][0],e[r][1]-d]):n.push([e[r][0],e[r][1]+d]),n.push(e[r]),c?o[0]<a[0]?n.push([e[r][0]-d,e[r][1]]):n.push([e[r][0]+d,e[r][1]]):o[1]<a[1]?n.push([e[r][0],e[r][1]-d]):n.push([e[r][0],e[r][1]+d])}const i=[`M ${e[0][0]} ${e[0][1]}`];for(let r=0;r<n.length;r+=3)i.push(`L ${n[r][0]} ${n[r][1]}`),i.push(`Q ${n[r+1][0]} ${n[r+1][1]}, ${n[r+2][0]} ${n[r+2][1]}`);return i.push(`L ${e[e.length-1][0]} ${e[e.length-1][1]}`),i.join(" ")},pce=(e,t)=>{var n;switch(e.type){case"rectangle":case"diamond":case"frame":case"magicframe":case"embeddable":case"image":case"iframe":case"text":case"selection":return qoe(e);case"arrow":case"line":{const i=((n=qt.get(e))==null?void 0:n[0])??qt.generateElementShape(e,null)[0],[,,,,r,s]=$e(e,t);return h6(e)?nae(e,i,S(e.x,e.y),e.angle,S(r,s)):Joe(i,S(e.x,e.y),e.angle,S(r,s))}case"ellipse":return Qoe(e);case"freedraw":{const[,,,,i,r]=$e(e,t);return tae(e,S(i,r),h6(e))}}},x9=(e,t)=>{const n=[...e.points];if(t){if(!uz(e.points))return null;const r=n[0],s=n[n.length-1];Math.hypot(r[0]-s[0],r[1]-s[1])>nse||n.length<4?n.push(S(r[0],r[1])):n[n.length-1]=S(r[0],r[1])}return{polygon:t,points:n}},Mo=class Mo{static getBounds(t,n,i=!1){const r=i&&t.angle!==0?Mo.nonRotatedBoundsCache.get(t):Mo.boundsCache.get(t);if(r!=null&&r.version&&r.version===t.version&&!Dt(t))return r.bounds;if(i&&t.angle!==0){const o=Mo.calculateBounds({...t,angle:0},n);return Mo.nonRotatedBoundsCache.set(t,{version:t.version,bounds:o}),o}const s=Mo.calculateBounds(t,n);return Mo.boundsCache.set(t,{version:t.version,bounds:s}),s}static calculateBounds(t,n){let i;const[r,s,o,a,l,c]=$e(t,n);if(qi(t)){const[d,u,f,h]=A9(t.points.map(([m,p])=>Q(S(m,p),S(l-t.x,c-t.y),t.angle)));return[d+t.x,u+t.y,f+t.x,h+t.y]}else if(xe(t))i=_ce(t,l,c,n);else if(t.type==="diamond"){const[d,u]=Q(S(l,s),S(l,c),t.angle),[f,h]=Q(S(l,a),S(l,c),t.angle),[m,p]=Q(S(r,c),S(l,c),t.angle),[U,b]=Q(S(o,c),S(l,c),t.angle),y=Math.min(d,f,m,U),w=Math.min(u,h,p,b),v=Math.max(d,f,m,U),I=Math.max(u,h,p,b);i=[y,w,v,I]}else if(t.type==="ellipse"){const d=(o-r)/2,u=(a-s)/2,f=Math.cos(t.angle),h=Math.sin(t.angle),m=Math.hypot(d*f,u*h),p=Math.hypot(u*f,d*h);i=[l-m,c-p,l+m,c+p]}else{const[d,u]=Q(S(r,s),S(l,c),t.angle),[f,h]=Q(S(r,a),S(l,c),t.angle),[m,p]=Q(S(o,a),S(l,c),t.angle),[U,b]=Q(S(o,s),S(l,c),t.angle),y=Math.min(d,f,m,U),w=Math.min(u,h,p,b),v=Math.max(d,f,m,U),I=Math.max(u,h,p,b);i=[y,w,v,I]}return i}};F(Mo,"boundsCache",new WeakMap),F(Mo,"nonRotatedBoundsCache",new WeakMap);let B4=Mo;const $e=(e,t,n=!1)=>{if(qi(e))return yce(e);if(xe(e))return pe.getElementAbsoluteCoords(e,t,n);if(ge(e)){const i=t?Yn(e,t):null;if(Ce(i)){const{x:r,y:s}=pe.getBoundTextElementPosition(i,e,t);return[r,s,r+e.width,s+e.height,r+e.width/2,s+e.height/2]}}return[e.x,e.y,e.x+e.width,e.y+e.height,e.x+e.width/2,e.y+e.height/2]},x6=(e,t)=>{const n=pce(e,t),[i,r,s,o,a,l]=$e(e,t),c=S(a,l);if(n.type==="polycurve"){const b=n.data.map(w=>Ip(w,10)),y=[];if(nn(e)&&!e.polygon||Ce(e))for(const w of b){let v=0;for(;v<w.length-1;)y.push(Me(S(w[v][0],w[v][1]),S(w[v+1][0],w[v+1][1]))),v++}else{const w=b.flat();let v=0;for(;v<w.length-1;)y.push(Me(S(w[v][0],w[v][1]),S(w[v+1][0],w[v+1][1]))),v++}return y}else{if(n.type==="polyline")return n.data;if(Uce(e)){const[U,b]=i9(e),y=b.map(v=>cM(v,c,e.angle)).flat();return[...lM(U,c,e.angle),...y]}else if(e.type==="diamond"){const[U,b]=r9(e),y=b.map(v=>cM(v,c,e.angle)).flat();return[...lM(U,c,e.angle),...y]}else if(n.type==="polygon"){if(ge(e)){const y=Yn(e,t);if(y&&xe(y))return[Me(S(i,r),S(s,r)),Me(S(s,r),S(s,o)),Me(S(s,o),S(i,o)),Me(S(i,o),S(i,r))]}const U=n.data,b=[];for(let y=0;y<U.length-1;y++)b.push(Me(U[y],U[y+1]));return b}else if(n.type==="ellipse")return bce(e)}const[d,u,f,h,,,m,p]=[[i,r],[s,r],[i,o],[s,o],[a,r],[a,o],[i,l],[s,l]].map(U=>Q(U,c,e.angle));return[Me(d,u),Me(f,h),Me(d,f),Me(u,h),Me(d,p),Me(f,p),Me(u,m),Me(h,m)]},Uce=e=>e!=null&&(e.type==="rectangle"||e.type==="image"||e.type==="iframe"||e.type==="embeddable"||e.type==="frame"||e.type==="magicframe"||e.type==="text"&&!e.containerId),lM=(e,t,n)=>e.map(i=>Me(Q(i[0],t,n),Q(i[1],t,n))),cM=(e,t,n)=>{const i=Ip(e,10);let r=0;const s=[];for(;r<i.length-1;)s.push(Me(Q(S(i[r][0],i[r][1]),t,n),Q(S(i[r+1][0],i[r+1][1]),t,n))),r++;return s},bce=e=>{const t=S(e.x+e.width/2,e.y+e.height/2),n=e.width/2,i=e.height/2,r=[],s=[],o=90,a=Math.PI*2/o;for(let l=0;l<o;l++){const c=l*a,d=t[0]+n*Math.cos(c),u=t[1]+i*Math.sin(c);s.push(Q(S(d,u),t,e.angle))}for(let l=0;l<s.length-1;l++)r.push(Me(s[l],s[l+1]));return r.push(Me(s[s.length-1],s[0])),r},C6=e=>{const t=Math.floor(e.width/2)+1,n=0,i=e.width,r=Math.floor(e.height/2)+1,s=t,o=e.height;return[t,n,i,r,s,o,0,r]},dM=(e,t,n,i,r)=>{const s=1-e;return Math.pow(s,3)*t+3*Math.pow(s,2)*e*n+3*s*Math.pow(e,2)*i+Math.pow(e,3)*r},uM=(e,t,n,i)=>{const r=t-e,s=n-t,o=i-n,a=3*r-6*s+3*o,l=6*s-6*r,c=3*r,d=l*l-4*a*c;if(!(d>=0))return!1;let f=null,h=null,m=1/0,p=1/0;return a===0?m=p=-c/l:(m=(-l+Math.sqrt(d))/(2*a),p=(-l-Math.sqrt(d))/(2*a)),m>=0&&m<=1&&(f=dM(m,e,t,n,i)),p>=0&&p<=1&&(h=dM(p,e,t,n,i)),[f,h]},C9=(e,t,n,i)=>{const r=uM(e[0],t[0],n[0],i[0]),s=uM(e[1],t[1],n[1],i[1]);let o=Math.min(e[0],i[0]),a=Math.max(e[0],i[0]);if(r){const d=r.filter(u=>u!==null);o=Math.min(o,...d),a=Math.max(a,...d)}let l=Math.min(e[1],i[1]),c=Math.max(e[1],i[1]);if(s){const d=s.filter(u=>u!==null);l=Math.min(l,...d),c=Math.max(c,...d)}return[o,l,a,c]},gy=(e,t)=>{let n=S(0,0);const{minX:i,minY:r,maxX:s,maxY:o}=e.reduce((a,{op:l,data:c})=>{if(l==="move"){const d=ny(c);gn(d!=null,"Op data is not a point"),n=d}else if(l==="bcurveTo"){const d=S(c[0],c[1]),u=S(c[2],c[3]),f=S(c[4],c[5]),h=t?t(d):d,m=t?t(u):u,p=t?t(f):f,U=t?t(n):n;n=f;const[b,y,w,v]=C9(U,h,m,p);a.minX=Math.min(a.minX,b),a.minY=Math.min(a.minY,y),a.maxX=Math.max(a.maxX,w),a.maxY=Math.max(a.maxY,v)}return a},{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});return[i,r,s,o]},A9=e=>{let t=1/0,n=1/0,i=-1/0,r=-1/0;for(const[s,o]of e)t=Math.min(t,s),n=Math.min(n,o),i=Math.max(i,s),r=Math.max(r,o);return[t,n,i,r]},yce=e=>{const[t,n,i,r]=A9(e.points),s=t+e.x,o=n+e.y,a=i+e.x,l=r+e.y;return[s,o,a,l,(s+a)/2,(o+l)/2]},Ece=e=>{switch(e){case"arrow":return 25;case"diamond":case"diamond_outline":return 12;case"crowfoot_many":case"crowfoot_one":case"crowfoot_one_or_many":return 20;default:return 15}},vce=e=>{switch(e){case"bar":return 90;case"arrow":return 20;default:return 25}},fM=(e,t,n,i)=>{if(t.length<1)return null;const r=Vu(t[0]);if(r.length<1)return null;const s=n==="start"?1:r.length-1,o=r[s].data;gn(o.length===6,"Op data length is not 6");const a=S(o[4],o[5]),l=S(o[2],o[3]),c=S(o[0],o[1]),d=r[s-1];let u=S(0,0);if(d.op==="move"){const $=ny(d.data);gn($!=null,"Op data is not a point"),u=$}else d.op==="bcurveTo"&&(u=S(d.data[4],d.data[5]));const f=($,H)=>Math.pow(1-$,3)*a[H]+3*$*Math.pow(1-$,2)*l[H]+3*Math.pow($,2)*(1-$)*c[H]+u[H]*Math.pow($,3),[h,m]=n==="start"?u:a,[p,U]=[f(.3,0),f(.3,1)],b=Math.hypot(h-p,m-U),y=(h-p)/b,w=(m-U)/b,v=Ece(i);let I=0;{const[$,H]=n==="end"?e.points[e.points.length-1]:e.points[0],[z,G]=e.points.length>1?n==="end"?e.points[e.points.length-2]:e.points[1]:[0,0];I=Math.hypot($-z,H-G)}const _=Math.min(v,I*(i==="diamond"||i==="diamond_outline"?.25:.5)),T=h-y*_,k=m-w*_;if(i==="dot"||i==="circle"||i==="circle_outline"){const $=Math.hypot(k-m,T-h)+e.strokeWidth-2;return[h,m,$]}const x=vce(i);if(i==="crowfoot_many"||i==="crowfoot_one_or_many"){const[$,H]=Q(S(h,m),S(T,k),Jd(-x)),[z,G]=Q(S(h,m),S(T,k),Jd(x));return[T,k,$,H,z,G]}const[D,O]=Q(S(T,k),S(h,m),-x*Math.PI/180),[L,Y]=Q(S(T,k),S(h,m),Jd(x));if(i==="diamond"||i==="diamond_outline"){let $,H;if(n==="start"){const[z,G]=e.points.length>1?e.points[1]:[0,0];[$,H]=Q(S(h+_*2,m),S(h,m),Math.atan2(G-m,z-h))}else{const[z,G]=e.points.length>1?e.points[e.points.length-2]:[0,0];[$,H]=Q(S(h-_*2,m),S(h,m),Math.atan2(m-G,h-z))}return[h,m,D,O,$,H,L,Y]}return[h,m,D,O,L,Y]},wce=e=>{const t=od.generator(),n=zr(e),i=e.roundness?"curve":n.fill?"polygon":"linearPath";return t[i](e.points,n)},_ce=(e,t,n,i)=>{var u;const r=Le(e,i);if(e.points.length<2){const[f,h]=e.points[0],[m,p]=Q(S(e.x+f,e.y+h),S(t,n),e.angle);let U=[m,p,m,p];if(r){const b=pe.getMinMaxXYWithBoundText(e,i,[m,p,m,p],r);U=[b[0],b[1],b[2],b[3]]}return U}const o=((u=qt.get(e))==null?void 0:u[0])??wce(e),a=Vu(o),c=gy(a,([f,h])=>Q(S(e.x+f,e.y+h),S(t,n),e.angle));let d=[c[0],c[1],c[2],c[3]];if(r){const f=pe.getMinMaxXYWithBoundText(e,i,d,r);d=[f[0],f[1],f[2],f[3]]}return d},si=(e,t,n=!1)=>B4.getBounds(e,t,n),ht=(e,t)=>{if(!KB(e))return[0,0,0,0];let n=1/0,i=-1/0,r=1/0,s=-1/0;const o=t||ve(e);return e.forEach(a=>{const[l,c,d,u]=si(a,o);n=Math.min(n,l),r=Math.min(r,c),i=Math.max(i,d),s=Math.max(s,u)}),[n,r,i,s]},M9=(e,t)=>{const[n,i,r,s]=ht(e);return[n+t.x,i+t.y,r+t.x,s+t.y]},bm=(e,t,n,i)=>{if(!(xe(e)||qi(e)))return[e.x,e.y,e.x+t,e.y+n];const r=a6(0,t,a6(1,n,e.points,i),i);let s;if(qi(e))s=A9(r);else{const d=od.generator(),u=e.roundness?d.curve(r,zr(e)):d.linearPath(r,zr(e)),f=Vu(u);s=gy(f)}const[o,a,l,c]=s;return[o+e.x,a+e.y,l+e.x,c+e.y]},hM=(e,t)=>{const n=od.generator(),i=e.roundness==null?n.linearPath(t,zr(e)):n.curve(t,zr(e)),r=Vu(i),[s,o,a,l]=gy(r);return[s+e.x,o+e.y,a+e.x,l+e.y]},Tce=(e,t)=>{if(!e.length)return[0,0,0,0];let n=1/0,i=e[0];const r=ve(e);return e.forEach(s=>{const[o,a,l,c]=si(s,r),d=ct(S((o+l)/2,(a+c)/2),S(t.x,t.y));d<n&&(n=d,i=s)}),si(i,r)},Ms=e=>{const[t,n,i,r]=ht(e);return{minX:t,minY:n,maxX:i,maxY:r,width:i-t,height:r-n,midX:(t+i)/2,midY:(n+r)/2}},eH=({scrollX:e,scrollY:t,width:n,height:i,zoom:r})=>[-e,-t,-e+n/r.value,-t+i/r.value],Sg=e=>S(e[0]+(e[2]-e[0])/2,e[1]+(e[3]-e[1])/2),Sa=(e,t,n)=>{const i={minX:e.x,minY:e.y,maxX:e.x+e.width,maxY:e.y+e.height,midX:e.x+e.width/2,midY:e.y+e.height/2},r=oi(e,t),[s,o]=Q(S(i.minX,i.minY),r,e.angle),[a,l]=Q(S(i.maxX,i.minY),r,e.angle),[c,d]=Q(S(i.maxX,i.maxY),r,e.angle),[u,f]=Q(S(i.minX,i.maxY),r,e.angle),h=[Math.min(s,a,c,u),Math.min(o,l,d,f),Math.max(s,a,c,u),Math.max(o,l,d,f)];if(n){const[m,p,U,b]=n;return[h[0]-b,h[1]-m,h[2]+p,h[3]+U]}return h},ym=(e,t)=>e[0]>t[0]&&e[0]<t[2]&&e[1]>t[1]&&e[1]<t[3],Gu=(e,t)=>{if(e==null||t==null)return!1;const[n,i,r,s]=e,[o,a,l,c]=t;return n<l&&r>o&&i<c&&s>a},oi=(e,t,n=0,i=0)=>{const[r,s]=Sg(si(e,t));return S(r+n,s+i)},Ice=.1,tl=e=>xe(e)||qi(e)?e.points.length<2||e.points.length===2&&Ce(e)&&Os(e.points[0],e.points[e.points.length-1],Ice):e.width===0&&e.height===0,A6=(e,t,n,i,r)=>{const[s,o,a,l]=si(e,r),c=Nt({clientX:i.offsetLeft,clientY:i.offsetTop},i),d=Nt({clientX:i.offsetLeft+t,clientY:i.offsetTop+n},i);return c.x<=a&&c.y<=l&&d.x>=s&&d.y>=o},$2=(e,t,n,i,r,s)=>{const[o,a,l,c]=ht(e,r),d=Nt({clientX:i.offsetLeft+((s==null?void 0:s.left)||0),clientY:i.offsetTop+((s==null?void 0:s.top)||0)},i),u=Nt({clientX:i.offsetLeft+t-((s==null?void 0:s.right)||0),clientY:i.offsetTop+n-((s==null?void 0:s.bottom)||0)},i);return o>=d.x&&a>=d.y&&l<=u.x&&c<=u.y},gM=(e,t,n)=>{const i=Math.abs(t),r=Math.abs(n);if(e==="line"||e==="arrow"||e==="freedraw"){const s=Math.round(Math.atan(r/i)/Hr)*Hr;s===0?n=0:s===Math.PI/2?t=0:n=i*Math.tan(s)*Math.sign(n)||n}else e!=="selection"&&(n=i*Math.sign(n));return{width:t,height:n}},z4=(e,t,n,i,r)=>{let s=n-e,o=i-t;const a=Math.atan2(o,s);let l=Math.round(a/Hr)*Hr;if(r){const c=Math.floor(r/Hr)*Hr;Ise(a,c,c+Hr)&&(Sse(a,r)<Hr/6?l=r:oo(a)>oo(r)?l=c+Hr:l=c)}if(l===0)o=0;else if(l===Math.PI/2)s=0;else{const c=Math.tan(l),d=-1,u=t-c*e,f=-1/c,h=-1,m=i-f*n,p=(d*m-h*u)/(c*h-f*d),U=(u*f-m*c)/(c*h-f*d);s=p-e,o=U-t}return{width:s,height:o}},tH=e=>{const t={width:e.width,height:e.height,x:e.x,y:e.y};if(e.width<0){const n=Math.abs(e.width);t.width=n,t.x=e.x-n}if(e.height<0){const n=Math.abs(e.height);t.height=n,t.y=e.y-n}return t},Sce=(e,t,n,i)=>{const r=cy(e,n.getNonDeletedElementsMap(),i),s=Ms(e);return r.flatMap(o=>{const a=xce(o,s,t);return o.map(l=>{const c=n.mutateElement(l,{x:l.x+a.x,y:l.y+a.y});return fr(l,n,{simultaneouslyUpdated:o}),c})})},xce=(e,t,{axis:n,position:i})=>{const r=Ms(e),[s,o]=n==="x"?["minX","maxX"]:["minY","maxY"],a={x:0,y:0};return i==="start"?{...a,[n]:t[s]-r[s]}:i==="end"?{...a,[n]:t[o]-r[o]}:{...a,[n]:(t[s]+t[o])/2-(r[s]+r[o])/2}},Cce=e=>{const t=e.slice(),n=new Set,i=s=>{var c,d,u;const o=(d=(c=s[0])==null?void 0:c.groupIds)==null?void 0:d.join(""),a=[s[0]],l=[];for(const f of s.slice(1))((u=f.groupIds)==null?void 0:u.join(""))===o?a.push(f):l.push(f);return l.length?[...a,...i(l)]:a},r=new Map;return t.forEach((s,o)=>{var a;if(!r.has(s.id))if((a=s.groupIds)!=null&&a.length){const l=s.groupIds[s.groupIds.length-1],c=t.slice(o).filter(d=>{var f;const u=(f=d==null?void 0:d.groupIds)==null?void 0:f.some(h=>h===l);return u&&r.set(d.id,!0),u});for(const d of i(c))n.add(d)}else n.add(s)}),n.size!==e.length?(console.error("normalizeGroupElementOrder: lost some elements... bailing!"),e):[...n]},Ace=e=>{const t=eoe(e),n=e.slice(),i=new Set;return n.forEach((r,s)=>{var o,a;if(r)if((o=r.boundElements)!=null&&o.length)i.add(r),n[s]=null,r.boundElements.forEach(l=>{const c=t.get(l.id);c&&l.type==="text"&&(i.add(c[0]),n[c[1]]=null)});else if(r.type==="text"&&r.containerId){const l=t.get(r.containerId);(a=l==null?void 0:l[0].boundElements)!=null&&a.find(c=>c.id===r.id)||(i.add(r),n[s]=null)}else i.add(r),n[s]=null}),i.size!==e.length?(console.error("normalizeBoundElementsOrder: lost some elements... bailing!"),e):[...i]},Mce=e=>Ace(Cce(e)),kce=(e,t,n,i)=>{const r=Gc(n);return r.id=gr(),r.updated=wg(),i&&(r.seed=Ps(),Pa(r)),r.groupIds=Kle(r.groupIds,e,s=>(t.has(s)||t.set(s,gr()),t.get(s))),r},S0=e=>{let{elements:t}=e;const n="appState"in e?e.appState:{editingGroupId:null,selectedGroupIds:{}},i=new Map,r=new Map,s=[],o=[],a=new Map,l=new Map,c=new Map,d=ve(t),u=e.type==="in-place"?e.idsOfElementsToDuplicate:new Map(t.map(U=>[U.id,U]));if(e.type==="in-place")for(const U of Object.keys(e.appState.selectedGroupIds))t.filter(b=>{var y;return(y=b.groupIds)==null?void 0:y.includes(U)}).forEach(b=>u.set(b.id,b));t=Mce(t);const f=t.slice(),h=U=>{const y=L8(U).reduce((w,v)=>{if(i.has(v.id))return w;i.set(v.id,!0);const I=kce(n.editingGroupId,r,v,e.randomizeSeed);return i.set(I.id,!0),c.set(I.id,I),a.set(v.id,I.id),l.set(I.id,v),o.push(v),s.push(I),w.push(I),w},[]);return Array.isArray(U)?y:y[0]||null},m=(U,b)=>{if(b){if(U>f.length-1){f.push(...L8(b));return}f.splice(U+1,0,...L8(b))}},p=new Set(t.filter(U=>u.has(U.id)&&we(U)).map(U=>U.id));for(const U of t){if(i.has(U.id)||!u.has(U.id))continue;const b=Dz(n,U);if(b){const y=At(t,b).flatMap(v=>we(v)?[...ns(t,v.id),v]:[v]),w=Md(f,v=>{var I;return(I=v.groupIds)==null?void 0:I.includes(b)});m(w,h(y));continue}if(!(U.frameId&&p.has(U.frameId))){if(we(U)){const y=U.id,w=ns(t,y),v=Md(f,I=>I.frameId===y||I.id===y);m(v,h([...w,U]));continue}if(Li(U)){const y=Le(U,d),w=Md(f,v=>v.id===U.id||"containerId"in v&&v.containerId===U.id);y?m(w,h([U,y])):m(w,h(U));continue}if(Dt(U)){const y=Yn(U,d),w=Md(f,v=>v.id===U.id||v.id===(y==null?void 0:y.id));y?m(w,h([y,U])):m(w,h(U));continue}m(Md(f,y=>y.id===U.id),h(U))}}if(Mle(s,a,c),qle(f,o,a),e.overrides)for(const U of s){const b=l.get(U.id);b&&Object.assign(U,e.overrides({duplicateElement:U,origElement:b,origIdToDuplicateId:a}))}return{duplicatedElements:s,duplicateElementsMap:c,elementsWithDuplicates:f,origIdToDuplicateId:a}},H4=(e,t=0)=>{if(e==null||typeof e!="object")return e;if(Object.prototype.toString.call(e)==="[object Object]"){const i=typeof e.constructor=="function"?Object.create(Object.getPrototypeOf(e)):{};for(const r in e)if(e.hasOwnProperty(r)){if(t===0&&(r==="shape"||r==="canvas"))continue;i[r]=H4(e[r],t+1)}return i}if(Array.isArray(e)){let i=e.length;const r=new Array(i);for(;i--;)r[i]=H4(e[i],t+1);return r}return e},Gc=e=>H4(e),Z={IMMEDIATELY:"IMMEDIATELY",NEVER:"NEVER",EVENTUALLY:"EVENTUALLY"};class Rce{constructor(t){F(this,"onDurableIncrementEmitter",new Ws);F(this,"onStoreIncrementEmitter",new Ws);F(this,"scheduledMacroActions",new Set);F(this,"scheduledMicroActions",[]);F(this,"_snapshot",Bo.empty());this.app=t}get snapshot(){return this._snapshot}set snapshot(t){this._snapshot=t}scheduleAction(t){this.scheduledMacroActions.add(t),this.satisfiesScheduledActionsInvariant()}scheduleCapture(){this.scheduleAction(Z.IMMEDIATELY)}scheduleMicroAction(t){const{action:n}=t;let i;if("change"in t)i=t.change;else{const s=Bo.create(this.app.scene.getElementsMapIncludingDeleted(),this.app.state),o=s.maybeClone(n,t.elements?Fce(t.elements):void 0,t.appState);i=uh.create(s,o)}const r="delta"in t?t.delta:void 0;this.scheduledMicroActions.push(()=>this.processAction({action:n,change:i,delta:r}))}commit(t,n){this.flushMicroActions();try{const i=this.getScheduledMacroAction();this.processAction({action:i,elements:t,appState:n})}finally{this.satisfiesScheduledActionsInvariant(),this.scheduledMacroActions=new Set}}clear(){this.snapshot=Bo.empty(),this.scheduledMacroActions=new Set}emitDurableIncrement(t,n=void 0,i=void 0){const r=this.snapshot;let s,o;if(n?s=n:s=uh.create(r,t),i?o=i:o=yu.calculate(r,t),!o.isEmpty()){const a=new Dce(s,o);this.onDurableIncrementEmitter.trigger(a),this.onStoreIncrementEmitter.trigger(a)}}emitEphemeralIncrement(t,n=void 0){let i;if(n)i=n;else{const s=this.snapshot;i=uh.create(s,t)}const r=new Lce(i);this.onStoreIncrementEmitter.trigger(r)}applyChangeToSnapshot(t){const n=this.snapshot,i=this.snapshot.applyChange(t);return n===i?null:i}maybeCloneSnapshot(t,n,i){if(!n&&!i)return null;const r=this.snapshot,s=this.snapshot.maybeClone(t,n,i);return r===s?null:s}flushMicroActions(){for(const t of this.scheduledMicroActions)try{t()}catch(n){console.error("Failed to execute scheduled micro action",n)}this.scheduledMicroActions=[]}processAction(t){const{action:n}=t;if(n===Z.EVENTUALLY&&!this.onStoreIncrementEmitter.subscribers.length)return;let i;if("change"in t?i=this.applyChangeToSnapshot(t.change):i=this.maybeCloneSnapshot(n,t.elements,t.appState),!i)return;const r="change"in t?t.change:void 0,s="delta"in t?t.delta:void 0;try{switch(n){case Z.IMMEDIATELY:this.emitDurableIncrement(i,r,s);break;case Z.NEVER:case Z.EVENTUALLY:this.emitEphemeralIncrement(i,r);break;default:qo(n,"Unknown store action")}}finally{switch(n){case Z.IMMEDIATELY:case Z.NEVER:this.snapshot=i;break}}}getScheduledMacroAction(){let t;return this.scheduledMacroActions.has(Z.IMMEDIATELY)?t=Z.IMMEDIATELY:this.scheduledMacroActions.has(Z.NEVER)?t=Z.NEVER:t=Z.EVENTUALLY,t}satisfiesScheduledActionsInvariant(){if(!(this.scheduledMacroActions.size>=0&&this.scheduledMacroActions.size<=Object.keys(Z).length)){const t=`There can be at most three store actions scheduled at the same time, but there are "${this.scheduledMacroActions.size}".`;console.error(t,this.scheduledMacroActions.values())}}}class uh{constructor(t,n){this.elements=t,this.appState=n}static create(t,n){const i=n.getChangedElements(t),r=n.getChangedAppState(t);return new uh(i,r)}}class nH{constructor(t,n){this.type=t,this.change=n}static isDurable(t){return t.type==="durable"}static isEphemeral(t){return t.type==="ephemeral"}}class Dce extends nH{constructor(t,n){super("durable",t),this.change=t,this.delta=n}}class Lce extends nH{constructor(t){super("ephemeral",t),this.change=t}}class yu{constructor(t,n,i){this.id=t,this.elements=n,this.appState=i}static create(t,n,i={id:gr()}){return new this(i.id,t,n)}static calculate(t,n){const i=n.metadata.didElementsChange?kd.calculate(t.elements,n.elements):kd.empty(),r=n.metadata.didAppStateChange?An.calculate(t.appState,n.appState):An.empty();return this.create(i,r)}static restore(t){const{id:n,elements:i,appState:r}=t;return new this(n,kd.restore(i),An.restore(r))}static load({id:t,elements:{added:n,removed:i,updated:r},appState:{delta:s}}){const o=kd.create(n,i,r),a=An.create(s);return new this(t,o,a)}static squash(...t){const n=yu.empty();for(const i of t)n.elements.squash(i.elements),n.appState.squash(i.appState);return n}static inverse(t){return this.create(t.elements.inverse(),t.appState.inverse())}static applyTo(t,n,i,r){const[s,o]=t.elements.applyTo(n,Bo.empty().elements,r),[a,l]=t.appState.applyTo(i,s);return[s,a,o||l]}static applyLatestChanges(t,n,i,r){return this.create(t.elements.applyLatestChanges(n,i,r),t.appState,{id:t.id})}static empty(){return yu.create(kd.empty(),An.empty())}isEmpty(){return this.elements.isEmpty()&&this.appState.isEmpty()}}class Bo{constructor(t,n,i={didElementsChange:!1,didAppStateChange:!1,isEmpty:!1}){F(this,"_lastChangedElementsHash",0);F(this,"_lastChangedAppStateHash",0);this.elements=t,this.appState=n,this.metadata=i}static create(t,n,i={didElementsChange:!1,didAppStateChange:!1}){return new Bo(t,mM(n)?n:fh(n),i)}static empty(){return new Bo(new Map,Nce(),{didElementsChange:!1,didAppStateChange:!1,isEmpty:!0})}getChangedElements(t){const n={};for(const i of Kl(t.elements))this.elements.get(i.id)||(n[i.id]=Ie(i,{isDeleted:!0}));for(const i of Kl(this.elements))t.elements.get(i.id)!==i&&(n[i.id]=i);return n}getChangedAppState(t){return Ne.getRightDifferences(t.appState,this.appState).reduce((n,i)=>Object.assign(n,{[i]:this.appState[i]}),{})}isEmpty(){return this.metadata.isEmpty}applyChange(t){const n=new Map(this.elements);for(const[r,s]of Object.entries(t.elements))n.set(r,s);const i=fh({...this.appState,...t.appState});return Bo.create(n,i,{didElementsChange:Object.keys(t.elements).length>0,didAppStateChange:Object.keys(t.appState).length>0})}maybeClone(t,n,i){const r={shouldCompareHashes:!1};t===Z.EVENTUALLY&&(r.shouldCompareHashes=!0);const s=this.maybeCreateElementsSnapshot(n,r),o=this.maybeCreateAppStateSnapshot(i,r);let a=!1,l=!1;return this.elements!==s&&(a=!0),this.appState!==o&&(l=!0),!a&&!l?this:new Bo(s,o,{didElementsChange:a,didAppStateChange:l})}maybeCreateAppStateSnapshot(t,n={shouldCompareHashes:!1}){if(!t)return this.appState;const i=mM(t)?t:fh(t);return this.detectChangedAppState(i,n)?i:this.appState}maybeCreateElementsSnapshot(t,n={shouldCompareHashes:!1}){if(!t)return this.elements;const i=this.detectChangedElements(t,n);return i!=null&&i.size?this.createElementsSnapshot(i):this.elements}detectChangedAppState(t,n={shouldCompareHashes:!1}){if(this.appState===t)return;const i=Ne.isRightDifferent(this.appState,t);if(!i)return;const r=B9(JSON.stringify(t));if(!(n.shouldCompareHashes&&this._lastChangedAppStateHash===r))return this._lastChangedAppStateHash=r,i}detectChangedElements(t,n={shouldCompareHashes:!1}){if(this.elements===t)return;const i=new Map;for(const s of Kl(this.elements))t.get(s.id)||i.set(s.id,Ie(s,{isDeleted:!0}));for(const s of Kl(t)){const o=this.elements.get(s.id);if(!o||o.version<s.version){if(yt(s)&&!Dn(s))continue;i.set(s.id,s)}}if(!i.size)return;const r=AH(i);if(!(n.shouldCompareHashes&&this._lastChangedElementsHash===r))return this._lastChangedElementsHash=r,i}createElementsSnapshot(t){const n=new Map;for(const i of Kl(this.elements))n.set(i.id,i);for(const i of Kl(t))n.set(i.id,Gc(i));return n}}const iH="__observedAppState",Nce=()=>({name:null,editingGroupId:null,viewBackgroundColor:Ye.white,selectedElementIds:{},selectedGroupIds:{},selectedLinearElement:null,croppingElementId:null,activeLockedId:null,lockedMultiSelections:{}}),fh=e=>{const t={name:e.name,editingGroupId:e.editingGroupId,viewBackgroundColor:e.viewBackgroundColor,selectedElementIds:e.selectedElementIds,selectedGroupIds:e.selectedGroupIds,croppingElementId:e.croppingElementId,activeLockedId:e.activeLockedId,lockedMultiSelections:e.lockedMultiSelections,selectedLinearElement:e.selectedLinearElement?{elementId:e.selectedLinearElement.elementId,isEditing:!!e.selectedLinearElement.isEditing}:null};return Reflect.defineProperty(t,iH,{value:!0,enumerable:!1}),t},mM=e=>!!Reflect.get(e,iH),rH="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function Kf(e,t,n){const i=n[0];if(t!=null&&e>=t)throw new Error(e+" >= "+t);if(e.slice(-1)===i||t&&t.slice(-1)===i)throw new Error("trailing zero");if(t){let o=0;for(;(e[o]||i)===t[o];)o++;if(o>0)return t.slice(0,o)+Kf(e.slice(o),t.slice(o),n)}const r=e?n.indexOf(e[0]):0,s=t!=null?n.indexOf(t[0]):n.length;if(s-r>1){const o=Math.round(.5*(r+s));return n[o]}else return t&&t.length>1?t.slice(0,1):n[r]+Kf(e.slice(1),null,n)}function sH(e){if(e.length!==oH(e[0]))throw new Error("invalid integer part of order key: "+e)}function oH(e){if(e>="a"&&e<="z")return e.charCodeAt(0)-97+2;if(e>="A"&&e<="Z")return 90-e.charCodeAt(0)+2;throw new Error("invalid order key head: "+e)}function V1(e){const t=oH(e[0]);if(t>e.length)throw new Error("invalid order key: "+e);return e.slice(0,t)}function pM(e,t){if(e==="A"+t[0].repeat(26))throw new Error("invalid order key: "+e);const n=V1(e);if(e.slice(n.length).slice(-1)===t[0])throw new Error("invalid order key: "+e)}function UM(e,t){sH(e);const[n,...i]=e.split("");let r=!0;for(let s=i.length-1;r&&s>=0;s--){const o=t.indexOf(i[s])+1;o===t.length?i[s]=t[0]:(i[s]=t[o],r=!1)}if(r){if(n==="Z")return"a"+t[0];if(n==="z")return null;const s=String.fromCharCode(n.charCodeAt(0)+1);return s>"a"?i.push(t[0]):i.pop(),s+i.join("")}else return n+i.join("")}function Oce(e,t){sH(e);const[n,...i]=e.split("");let r=!0;for(let s=i.length-1;r&&s>=0;s--){const o=t.indexOf(i[s])-1;o===-1?i[s]=t.slice(-1):(i[s]=t[o],r=!1)}if(r){if(n==="a")return"Z"+t.slice(-1);if(n==="A")return null;const s=String.fromCharCode(n.charCodeAt(0)-1);return s<"Z"?i.push(t.slice(-1)):i.pop(),s+i.join("")}else return n+i.join("")}function lf(e,t,n=rH){if(e!=null&&pM(e,n),t!=null&&pM(t,n),e!=null&&t!=null&&e>=t)throw new Error(e+" >= "+t);if(e==null){if(t==null)return"a"+n[0];const l=V1(t),c=t.slice(l.length);if(l==="A"+n[0].repeat(26))return l+Kf("",c,n);if(l<t)return l;const d=Oce(l,n);if(d==null)throw new Error("cannot decrement any more");return d}if(t==null){const l=V1(e),c=e.slice(l.length),d=UM(l,n);return d??l+Kf(c,null,n)}const i=V1(e),r=e.slice(i.length),s=V1(t),o=t.slice(s.length);if(i===s)return i+Kf(r,o,n);const a=UM(i,n);if(a==null)throw new Error("cannot increment any more");return a<t?a:i+Kf(r,null,n)}function V4(e,t,n,i=rH){if(n===0)return[];if(n===1)return[lf(e,t,i)];if(t==null){let o=lf(e,t,i);const a=[o];for(let l=0;l<n-1;l++)o=lf(o,t,i),a.push(o);return a}if(e==null){let o=lf(e,t,i);const a=[o];for(let l=0;l<n-1;l++)o=lf(e,o,i),a.push(o);return a.reverse(),a}const r=Math.floor(n/2),s=lf(e,t,i);return[...V4(e,s,r,i),s,...V4(s,t,n-r-1,i)]}class Pce extends Error{constructor(){super(...arguments);F(this,"code","ELEMENT_HAS_INVALID_INDEX")}}const k9=(e,{shouldThrow:t=!1,includeBoundTextValidation:n=!1,ignoreLogs:i,reconciliationContext:r})=>{const s=[],o=l=>`${l==null?void 0:l.index}:${l==null?void 0:l.id}:${l==null?void 0:l.type}:${l==null?void 0:l.isDeleted}:${l==null?void 0:l.version}:${l==null?void 0:l.versionNonce}`,a=e.map(l=>l.index);for(const[l,c]of a.entries()){const d=a[l-1],u=a[l+1];if($4(c,d,u)||s.push(`Fractional indices invariant has been compromised: "${o(e[l-1])}", "${o(e[l])}", "${o(e[l+1])}"`),n&&Li(e[l])){const f=e[l],h=Le(f,ve(e));h&&h.index<=f.index&&s.push(`Fractional indices invariant for bound elements has been compromised: "${o(h)}", "${o(f)}"`)}}if(s.length){const l=new Pce,c=[];if(r&&(c.push("Additional reconciliation context:"),c.push(r.localElements.map(d=>o(d))),c.push(r.remoteElements.map(d=>o(d)))),i||console.error(s.join(`

`),l.stack,e.map(d=>o(d)),...c),t)throw l}},R9=e=>e.sort((t,n)=>bM(t)&&bM(n)?t.index<n.index?-1:t.index>n.index?1:t.id<n.id?-1:1:1),uo=(e,t)=>{try{const n=ve(e),i=Bce(e,t),r=D9(e,i),s=e.map(o=>{const a=r.get(o);return a?{...o,index:a.index}:o});k9(s,{includeBoundTextValidation:!1,shouldThrow:!0,ignoreLogs:!0});for(const[o,{index:a}]of r)_i(o,n,{index:a})}catch{cd(e)}return e},cd=e=>{const t=ve(e),n=aH(e),i=D9(e,n);for(const[r,{index:s}]of i)_i(r,t,{index:s});return e},Fce=e=>{const t=ve(e),n=aH(e),i=D9(e,n);for(const[r,{index:s}]of i)t.set(r.id,Ie(r,{index:s}));return t},Bce=(e,t)=>{const n=[];let i=0;for(;i<e.length;)if(t.has(e[i].id)){const r=[i-1,i];for(;++i<e.length&&t.has(e[i].id);)r.push(i);r.push(i),n.push(r)}else i++;return n},aH=e=>{const t=[];let n,i,r=-1,s=0;const o=c=>{var f;const d=e[r]?e[r].index:void 0,u=(f=e[c-1])==null?void 0:f.index;return!d&&u||d&&u&&u>d?[u,c-1]:[d,r]},a=c=>{var f;const d=e[s]?e[s].index:void 0;if(d&&c<s)return[d,s];let u=s;for(;++u<e.length;){const h=(f=e[u])==null?void 0:f.index;if(!d&&h||d&&h&&h>d)return[h,u]}return[void 0,u]};let l=0;for(;l<e.length;){const c=e[l].index;if([n,r]=o(l),[i,s]=a(l),$4(c,n,i))l++;else{const d=[r,l];for(;++l<e.length;){const u=e[l].index,[f,h]=o(l),[m,p]=a(l);if($4(u,f,m))break;[n,r]=[f,h],[i,s]=[m,p],d.push(l)}d.push(s),t.push(d)}}return t},$4=(e,t,n)=>e?t&&n?t<e&&e<n:!t&&n?e<n:t&&!n?t<e:!!e:!1,D9=(e,t)=>{var i,r;const n=new Map;for(const s of t){const o=s.shift(),a=s.pop(),l=V4((i=e[o])==null?void 0:i.index,(r=e[a])==null?void 0:r.index,s.length);for(let c=0;c<s.length;c++){const d=e[s[c]];n.set(d,{index:l[c]})}}return n},bM=e=>!!e.index;var lH="Expected a function",yM=NaN,zce="[object Symbol]",Hce=/^\s+|\s+$/g,Vce=/^[-+]0x[0-9a-f]+$/i,$ce=/^0b[01]+$/i,Gce=/^0o[0-7]+$/i,Xce=parseInt,jce=typeof Fa=="object"&&Fa&&Fa.Object===Object&&Fa,Yce=typeof self=="object"&&self&&self.Object===Object&&self,Wce=jce||Yce||Function("return this")(),Kce=Object.prototype,Zce=Kce.toString,qce=Math.max,Qce=Math.min,j8=function(){return Wce.Date.now()};function Jce(e,t,n){var i,r,s,o,a,l,c=0,d=!1,u=!1,f=!0;if(typeof e!="function")throw new TypeError(lH);t=EM(t)||0,M6(n)&&(d=!!n.leading,u="maxWait"in n,s=u?qce(EM(n.maxWait)||0,t):s,f="trailing"in n?!!n.trailing:f);function h(C){var _=i,T=r;return i=r=void 0,c=C,o=e.apply(T,_),o}function m(C){return c=C,a=setTimeout(b,t),d?h(C):o}function p(C){var _=C-l,T=C-c,k=t-_;return u?Qce(k,s-T):k}function U(C){var _=C-l,T=C-c;return l===void 0||_>=t||_<0||u&&T>=s}function b(){var C=j8();if(U(C))return y(C);a=setTimeout(b,p(C))}function y(C){return a=void 0,f&&i?h(C):(i=r=void 0,o)}function w(){a!==void 0&&clearTimeout(a),c=0,i=l=r=a=void 0}function v(){return a===void 0?o:y(j8())}function I(){var C=j8(),_=U(C);if(i=arguments,r=this,l=C,_){if(a===void 0)return m(l);if(u)return a=setTimeout(b,t),h(l)}return a===void 0&&(a=setTimeout(b,t)),o}return I.cancel=w,I.flush=v,I}function ede(e,t,n){var i=!0,r=!0;if(typeof e!="function")throw new TypeError(lH);return M6(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),Jce(e,t,{leading:i,maxWait:t,trailing:r})}function M6(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function tde(e){return!!e&&typeof e=="object"}function nde(e){return typeof e=="symbol"||tde(e)&&Zce.call(e)==zce}function EM(e){if(typeof e=="number")return e;if(nde(e))return yM;if(M6(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=M6(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(Hce,"");var n=$ce.test(e);return n||Gce.test(e)?Xce(e.slice(2),n?2:8):Vce.test(e)?yM:+e}var ide=ede;const zo=wl(ide),vM=e=>{const t=new Map,n=[];for(const i of e)i.isDeleted||(n.push(i),t.set(i.id,i));return{elementsMap:t,elements:n}},rde=zo(e=>{window!=null&&window.DEBUG_FRACTIONAL_INDICES&&k9(e,{shouldThrow:ioe(),includeBoundTextValidation:!0})},1e3*60,{leading:!0,trailing:!1}),sde=e=>{const t=["includeBoundTextElement","includeElementsInFrames"];let n="";for(const i of t)n+=`${i}:${e[i]?"1":"0"}`;return n};class k6{constructor(t=null,n){F(this,"callbacks",new Set);F(this,"nonDeletedElements",[]);F(this,"nonDeletedElementsMap",Qo(new Map));F(this,"elements",[]);F(this,"nonDeletedFramesLikes",[]);F(this,"frames",[]);F(this,"elementsMap",Qo(new Map));F(this,"selectedElementsCache",{selectedElementIds:null,elements:null,cache:new Map});F(this,"sceneNonce");F(this,"insertElement",t=>{const n=t.frameId?this.getElementIndex(t.frameId):this.elements.length;this.insertElementAtIndex(t,n)});F(this,"insertElements",t=>{var i;if(!t.length)return;const n=(i=t[0])!=null&&i.frameId?this.getElementIndex(t[0].frameId):this.elements.length;this.insertElementsAtIndex(t,n)});F(this,"getContainerElement",t=>t&&t.containerId&&this.getElement(t.containerId)||null);F(this,"getElementsFromId",t=>{const n=this.getNonDeletedElementsMap(),i=n.get(t);return i?[i]:At(n,t)});t&&this.replaceAllElements(t,n)}getSceneNonce(){return this.sceneNonce}getNonDeletedElementsMap(){return this.nonDeletedElementsMap}getElementsIncludingDeleted(){return this.elements}getElementsMapIncludingDeleted(){return this.elementsMap}getNonDeletedElements(){return this.nonDeletedElements}getFramesIncludingDeleted(){return this.frames}getSelectedElements(t){const n=sde(t),i=(t==null?void 0:t.elements)||this.nonDeletedElements;if(this.selectedElementsCache.elements===i&&this.selectedElementsCache.selectedElementIds===t.selectedElementIds){const s=this.selectedElementsCache.cache.get(n);if(s)return s}else(t==null?void 0:t.elements)==null&&this.selectedElementsCache.cache.clear();const r=Xe(i,{selectedElementIds:t.selectedElementIds},t);return(t==null?void 0:t.elements)==null&&(this.selectedElementsCache.selectedElementIds=t.selectedElementIds,this.selectedElementsCache.elements=this.nonDeletedElements,this.selectedElementsCache.cache.set(n,r)),r}getNonDeletedFramesLikes(){return this.nonDeletedFramesLikes}getElement(t){return this.elementsMap.get(t)||null}getNonDeletedElement(t){const n=this.getElement(t);return n&&Q4(n)?n:null}mapElements(t){let n=!1;const i=this.elements.map(r=>{const s=t(r);return s!==r&&(n=!0),s});return n&&this.replaceAllElements(i),n}replaceAllElements(t,n){const i=noe(t),r=[];n!=null&&n.skipValidation||rde(i),this.elements=cd(i),this.elementsMap.clear(),this.elements.forEach(o=>{we(o)&&r.push(o),this.elementsMap.set(o.id,o)});const s=vM(this.elements);this.nonDeletedElements=s.elements,this.nonDeletedElementsMap=s.elementsMap,this.frames=r,this.nonDeletedFramesLikes=vM(this.frames).elements,this.triggerUpdate()}triggerUpdate(){this.sceneNonce=Ps();for(const t of Array.from(this.callbacks))t()}onUpdate(t){if(this.callbacks.has(t))throw new Error;return this.callbacks.add(t),()=>{if(!this.callbacks.has(t))throw new Error;this.callbacks.delete(t)}}destroy(){this.elements=[],this.nonDeletedElements=[],this.nonDeletedFramesLikes=[],this.frames=[],this.elementsMap.clear(),this.selectedElementsCache.selectedElementIds=null,this.selectedElementsCache.elements=null,this.selectedElementsCache.cache.clear(),this.callbacks.clear()}insertElementAtIndex(t,n){if(!Number.isFinite(n)||n<0)throw new Error("insertElementAtIndex can only be called with index >= 0");const i=[...this.elements.slice(0,n),t,...this.elements.slice(n)];uo(i,ve([t])),this.replaceAllElements(i)}insertElementsAtIndex(t,n){if(!t.length)return;if(!Number.isFinite(n)||n<0)throw new Error("insertElementAtIndex can only be called with index >= 0");const i=[...this.elements.slice(0,n),...t,...this.elements.slice(n)];uo(i,ve(t)),this.replaceAllElements(i)}getElementIndex(t){return this.elements.findIndex(n=>n.id===t)}mutateElement(t,n,i={informMutation:!0,isDragging:!1}){const r=this.getNonDeletedElementsMap(),{version:s}=t,{version:o}=_i(t,r,n,i);return this.elementsMap.has(t.id)&&s!==o&&i.informMutation&&this.triggerUpdate(),t}}class Ne{constructor(t,n){this.deleted=t,this.inserted=n}static create(t,n,i,r){const s=i&&r!=="inserted"?i(t,"deleted"):t,o=i&&r!=="deleted"?i(n,"inserted"):n;return new Ne(s,o)}static calculate(t,n,i,r){if(t===n)return Ne.empty();const s={},o={};for(const c of this.getDifferences(t,n))s[c]=t[c],o[c]=n[c];const[a,l]=r?r(s,o):[s,o];return Ne.create(a,l,i)}static empty(){return new Ne({},{})}static isEmpty(t){return!Object.keys(t.deleted).length&&!Object.keys(t.inserted).length}static merge(t,n,i=Ne.empty()){return Ne.create({...t.deleted,...n.deleted,...i.deleted},{...t.inserted,...n.inserted,...i.inserted})}static mergeObjects(t,n,i={}){const r={...t};for(const s of Object.keys(i))delete r[s];return{...r,...n}}static mergeArrays(t,n,i,r){return Object.values(Ne.mergeObjects(ya(t??[],r),ya(n??[],r),ya(i??[],r)))}static diffObjects(t,n,i,r){if(!t[i]&&!n[i])return;const s=t[i]!==null&&typeof t[i]=="object",o=n[i]!==null&&typeof n[i]=="object";if(s||o){const a=t[i]??{},l=n[i]??{},c=Ne.getLeftDifferences(a,l).reduce((u,f)=>(u[f]=r(a[f]),u),{}),d=Ne.getRightDifferences(a,l).reduce((u,f)=>(u[f]=r(l[f]),u),{});Object.keys(c).length||Object.keys(d).length?(Reflect.set(t,i,c),Reflect.set(n,i,d)):(Reflect.deleteProperty(t,i),Reflect.deleteProperty(n,i))}else t[i]===n[i]&&(Reflect.deleteProperty(t,i),Reflect.deleteProperty(n,i))}static diffArrays(t,n,i,r){if(!(!t[i]&&!n[i])&&(Array.isArray(t[i])||Array.isArray(n[i]))){const s=Array.isArray(t[i])?t[i]:[],o=Array.isArray(n[i])?n[i]:[],a=ya(Ne.getLeftDifferences(ya(s,r),ya(o,r)),c=>c),l=ya(Ne.getRightDifferences(ya(s,r),ya(o,r)),c=>c);if(Object.keys(a).length||Object.keys(l).length){const c=s.filter(u=>a[r?r(u):String(u)]),d=o.filter(u=>l[r?r(u):String(u)]);Reflect.set(t,i,c),Reflect.set(n,i,d)}else Reflect.deleteProperty(t,i),Reflect.deleteProperty(n,i)}}static isLeftDifferent(t,n,i=!1){return!!this.distinctKeysIterator("left",t,n,i).next().value}static isRightDifferent(t,n,i=!1){return!!this.distinctKeysIterator("right",t,n,i).next().value}static isInnerDifferent(t,n,i=!1){return!!!!this.distinctKeysIterator("inner",t,n,i).next().value}static isDifferent(t,n,i=!1){return!!!!this.distinctKeysIterator("full",t,n,i).next().value}static getLeftDifferences(t,n,i=!1){return Array.from(this.distinctKeysIterator("left",t,n,i)).sort()}static getRightDifferences(t,n,i=!1){return Array.from(this.distinctKeysIterator("right",t,n,i)).sort()}static getInnerDifferences(t,n,i=!1){return Array.from(this.distinctKeysIterator("inner",t,n,i)).sort()}static getDifferences(t,n,i=!1){return Array.from(this.distinctKeysIterator("full",t,n,i)).sort()}static*distinctKeysIterator(t,n,i,r=!1){if(n===i)return;let s=[];t==="left"?s=Object.keys(n):t==="right"?s=Object.keys(i):t==="inner"?s=Object.keys(n).filter(o=>o in i):t==="full"?s=Array.from(new Set([...Object.keys(n),...Object.keys(i)])):qo(t,`Unknown distinctKeysIterator's join param "${t}"`,!0);for(const o of s){const a=n[o],l=i[o];if(a!==l){if(!r&&typeof a=="object"&&typeof l=="object"&&a!==null&&l!==null&&Ki(a,l))continue;yield o}}}}class An{constructor(t){this.delta=t}static create(t){return new An(t)}static calculate(t,n){const i=Ne.calculate(t,n,An.orderAppStateKeys,An.postProcess);return new An(i)}static restore(t){const{delta:n}=t;return new An(n)}static empty(){return new An(Ne.create({},{}))}inverse(){const t=Ne.create(this.delta.inserted,this.delta.deleted);return new An(t)}squash(t){if(t.isEmpty())return this;const n=Ne.mergeObjects(this.delta.deleted.selectedElementIds??{},t.delta.deleted.selectedElementIds??{}),i=Ne.mergeObjects(this.delta.inserted.selectedElementIds??{},t.delta.inserted.selectedElementIds??{}),r=Ne.mergeObjects(this.delta.deleted.selectedGroupIds??{},t.delta.deleted.selectedGroupIds??{}),s=Ne.mergeObjects(this.delta.inserted.selectedGroupIds??{},t.delta.inserted.selectedGroupIds??{}),o=Ne.mergeObjects(this.delta.deleted.lockedMultiSelections??{},t.delta.deleted.lockedMultiSelections??{}),a=Ne.mergeObjects(this.delta.inserted.lockedMultiSelections??{},t.delta.inserted.lockedMultiSelections??{}),l={},c={};return(Object.keys(n).length||Object.keys(i).length)&&(c.selectedElementIds=n,l.selectedElementIds=i),(Object.keys(r).length||Object.keys(s).length)&&(c.selectedGroupIds=r,l.selectedGroupIds=s),(Object.keys(o).length||Object.keys(a).length)&&(c.lockedMultiSelections=o,l.lockedMultiSelections=a),this.delta=Ne.merge(this.delta,t.delta,Ne.create(c,l)),this}applyTo(t,n){try{const{selectedElementIds:i={},selectedGroupIds:r={},lockedMultiSelections:s={}}=this.delta.deleted,{selectedElementIds:o={},selectedGroupIds:a={},lockedMultiSelections:l={},selectedLinearElement:c,...d}=this.delta.inserted,u=Ne.mergeObjects(t.selectedElementIds,o,i),f=Ne.mergeObjects(t.selectedGroupIds,a,r),h=Ne.mergeObjects(t.lockedMultiSelections,l,s),m=c&&n.has(c.elementId)?new pe(n.get(c.elementId),n,c.isEditing):null,p={...t,...d,selectedElementIds:u,selectedGroupIds:f,lockedMultiSelections:h,selectedLinearElement:typeof c<"u"?m:t.selectedLinearElement},U=this.filterInvisibleChanges(t,p,n);return[p,U]}catch(i){return console.error("Couldn't apply appstate change",i),[t,!1]}}isEmpty(){return Ne.isEmpty(this.delta)}filterInvisibleChanges(t,n,i){const r=fh(t),s=fh(n),o=Ne.isRightDifferent(An.stripElementsProps(r),An.stripElementsProps(s)),a=Ne.isRightDifferent(An.stripStandaloneProps(r),An.stripStandaloneProps(s));if(!o&&!a)return!1;const l={value:o};if(a){const c=Ne.getRightDifferences(An.stripStandaloneProps(r),An.stripStandaloneProps(s));let d=new Set;(c.includes("editingGroupId")||c.includes("selectedGroupIds"))&&(d=Wle(i));for(const u of c)switch(u){case"selectedElementIds":n[u]=An.filterSelectedElements(n[u],i,l);break;case"selectedGroupIds":n[u]=An.filterSelectedGroups(n[u],d,l);break;case"croppingElementId":{const y=n[u];if(!y)l.value=!0;else{const w=i.get(y);w&&!w.isDeleted?l.value=!0:n[u]=null}break}case"editingGroupId":const f=n[u];f?d.has(f)?l.value=!0:n[u]=null:l.value=!0;break;case"selectedLinearElement":const h=n[u];if(!h)l.value=!0;else{const y=i.get(h.elementId);y&&!y.isDeleted?l.value=!0:n[u]=null}break;case"lockedMultiSelections":const m=t[u]||{},p=n[u]||{};Ki(m,p)||(l.value=!0);break;case"activeLockedId":const U=t[u]||null,b=n[u]||null;U!==b&&(l.value=!0);break;default:qo(u,`Unknown ObservedElementsAppState's key "${u}"`,!0)}}return l.value}static filterSelectedElements(t,n,i){const r=Object.keys(t);if(!r.length)return i.value=!0,t;const s={...t};for(const o of r){const a=n.get(o);a&&!a.isDeleted?i.value=!0:delete s[o]}return s}static filterSelectedGroups(t,n,i){if(!Object.keys(t).length)return i.value=!0,t;const s={...t};for(const o of Object.keys(s))n.has(o)?i.value=!0:delete s[o];return s}static stripElementsProps(t){const{editingGroupId:n,selectedGroupIds:i,selectedElementIds:r,selectedLinearElement:s,croppingElementId:o,lockedMultiSelections:a,activeLockedId:l,...c}=t;return c}static stripStandaloneProps(t){const{name:n,viewBackgroundColor:i,...r}=t;return r}static postProcess(t,n){try{Ne.diffObjects(t,n,"selectedElementIds",i=>!0),Ne.diffObjects(t,n,"selectedGroupIds",i=>i??!1),Ne.diffObjects(t,n,"lockedMultiSelections",i=>i??{})}catch{console.error("Couldn't postprocess appstate change deltas.")}finally{return[t,n]}}static orderAppStateKeys(t){const n={};for(const i of Object.keys(t).sort())n[i]=t[i];return n}}const Ut=class Ut{constructor(t,n,i){this.added=t,this.removed=n,this.updated=i}static create(t,n,i,r={shouldRedistribute:!1}){let s;if(r.shouldRedistribute){const o={},a={},l={},c=[...Object.entries(t),...Object.entries(n),...Object.entries(i)];for(const[d,u]of c)this.satisfiesAddition(u)?o[d]=u:this.satisfiesRemoval(u)?a[d]=u:l[d]=u;s=new Ut(o,a,l)}else s=new Ut(t,n,i);return s}static restore(t){const{added:n,removed:i,updated:r}=t;return Ut.create(n,i,r)}static validate(t,n,i){for(const[r,s]of Object.entries(t[n]))if(!this.satisfiesCommmonInvariants(s)||!this.satisfiesUniqueInvariants(t,r)||!i(s))throw console.error(`Broken invariant for "${n}" delta, element "${r}", delta:`,s),new Error(`ElementsDelta invariant broken for element "${r}".`)}static calculate(t,n){if(t===n)return Ut.empty();const i={},r={},s={};for(const o of t.values())if(!n.get(o.id)){const l={...o},c={isDeleted:!0,version:o.version+1,versionNonce:Ps()},d=Ne.create(l,c,Ut.stripIrrelevantProps);o.isDeleted?s[o.id]=d:r[o.id]=d}for(const o of n.values()){const a=t.get(o.id);if(!a){const l={isDeleted:!0,version:o.version-1,versionNonce:Ps()},c={...o},d=Ne.create(l,c,Ut.stripIrrelevantProps);o.isDeleted?s[o.id]=d:i[o.id]=d;continue}if(a.versionNonce!==o.versionNonce){const l=Ne.calculate(a,o,Ut.stripIrrelevantProps,Ut.postProcess);if(typeof a.isDeleted=="boolean"&&typeof o.isDeleted=="boolean"&&a.isDeleted!==o.isDeleted){a.isDeleted&&!o.isDeleted?i[o.id]=l:r[o.id]=l;continue}s[o.id]=l}}return Ut.create(i,r,s)}static empty(){return Ut.create({},{},{})}inverse(){const t=s=>{const o={};for(const[a,{inserted:l,deleted:c}]of Object.entries(s))o[a]=Ne.create({...l},{...c});return o},n=t(this.added),i=t(this.removed),r=t(this.updated);return Ut.create(i,n,r)}isEmpty(){return Object.keys(this.added).length===0&&Object.keys(this.removed).length===0&&Object.keys(this.updated).length===0}applyLatestChanges(t,n,i){const r=(c,d)=>(u,f)=>{let h;switch(f){case"deleted":h=c;break;case"inserted":h=d;break}if(!h)return console.error("Element not found when trying to apply latest changes"),u;const m={};for(const p of Object.keys(u))switch(p){case"boundElements":m[p]=u[p];break;default:m[p]=h[p]}return m},s=c=>{const d={};for(const[u,f]of Object.entries(c)){const h=t.get(u),m=n.get(u);let p=null;h||m?p=Ne.create(f.deleted,f.inserted,r(h,m),i):p=f,Ne.isInnerDifferent(p.deleted,p.inserted)&&(d[u]=p)}return d},o=s(this.added),a=s(this.removed),l=s(this.updated);return Ut.create(o,a,l,{shouldRedistribute:!0})}applyTo(t,n=Bo.empty().elements,i){let r=new Map(t),s;const o={containsVisibleDifference:!1,containsZindexDifference:!1,applyDirection:void 0};try{const a=Ut.createApplier(t,r,n,o,i),l=a(this.added),c=a(this.removed),d=a(this.updated),u=this.resolveConflicts(t,r,o.applyDirection);s=new Map([...l,...c,...d,...u])}catch(a){return console.error("Couldn't apply elements delta",a),[t,!0]}try{r=Ut.reorderElements(r,s,o),Ut.redrawElements(r,s)}catch(a){console.error("Couldn't mutate elements after applying elements change",a)}finally{return[r,o.containsVisibleDifference]}}squash(t){if(t.isEmpty())return this;const{added:n,removed:i,updated:r}=t,s=(o,a)=>{const l=Ne.mergeArrays(o.deleted.boundElements??[],a.deleted.boundElements??[],void 0,d=>d.id)??[],c=Ne.mergeArrays(o.inserted.boundElements??[],a.inserted.boundElements??[],void 0,d=>d.id)??[];if(!(!l.length&&!c.length))return Ne.create({boundElements:l},{boundElements:c})};for(const[o,a]of Object.entries(n)){const l=this.added[o]??this.removed[o]??this.updated[o];if(!l)this.added[o]=a;else{const c=s(l,a);delete this.removed[o],delete this.updated[o],this.added[o]=Ne.merge(l,a,c)}}for(const[o,a]of Object.entries(i)){const l=this.added[o]??this.removed[o]??this.updated[o];if(!l)this.removed[o]=a;else{const c=s(l,a);delete this.added[o],delete this.updated[o],this.removed[o]=Ne.merge(l,a,c)}}for(const[o,a]of Object.entries(r)){const l=this.added[o]??this.removed[o]??this.updated[o];if(!l)this.updated[o]=a;else{const c=s(l,a),d=Ne.merge(l,a,c);l===this.added[o]?this.added[o]=d:l===this.removed[o]?this.removed[o]=d:this.updated[o]=d}}return this}static applyDelta(t,n,i,r){var o,a,l;const s={};for(const c of Object.keys(n.inserted)){if(c==="boundElements"||(o=r==null?void 0:r.excludedProperties)!=null&&o.has(c))continue;const d=n.inserted[c];Reflect.set(s,c,d)}if((a=n.deleted.boundElements)!=null&&a.length||(l=n.inserted.boundElements)!=null&&l.length){const c=Ne.mergeArrays(t.boundElements,n.inserted.boundElements,n.deleted.boundElements,d=>d.id);Object.assign(s,{boundElements:c})}if(!i.containsVisibleDifference){const{index:c,...d}=s,u=Ut.checkForVisibleDifference(t,d);i.containsVisibleDifference=u}return i.containsZindexDifference||(i.containsZindexDifference=n.deleted.index!==n.inserted.index),Ie(t,s,!0)}static checkForVisibleDifference(t,n){return t.isDeleted&&n.isDeleted!==!1?!1:t.isDeleted&&n.isDeleted===!1||t.isDeleted===!1&&n.isDeleted?!0:Ne.isRightDifferent(t,n)}resolveConflicts(t,n,i="forward"){const r=new Map,s=(a,l)=>{const c=n.get(a.id);if(!c)return;const d=t.get(a.id),u=i==="forward"?c.version+1:c.version-1,f=l;let h;d===c?h=Ie(c,{...f,version:u},!0):h=_i(c,n,{...f,version:(d==null?void 0:d.version)!==c.version?c.version:u}),r.set(h.id,h),n.set(h.id,h)};for(const a of Object.keys(this.removed))Ut.unbindAffected(t,n,a,s);for(const a of Object.keys(this.added))Ut.rebindAffected(t,n,a,s);for(const[a]of Array.from(Object.entries(this.updated)).filter(([l,c])=>Object.keys({...c.deleted,...c.inserted}).find(d=>Dle.has(d)))){const l=n.get(a);!l||l.isDeleted||Ut.rebindAffected(t,n,a,s)}const o=new Map(Array.from(t).filter(([a])=>r.has(a)));return this.squash(Ut.calculate(o,r)),r}static unbindAffected(t,n,i,r){const s=()=>t.get(i),o=()=>n.get(i);Yf.unbindAffected(n,s(),r),Yf.unbindAffected(n,o(),r),Wf.unbindAffected(n,s(),r),Wf.unbindAffected(n,o(),r)}static rebindAffected(t,n,i,r){const s=()=>t.get(i),o=()=>n.get(i);Yf.unbindAffected(n,s(),r),Yf.rebindAffected(n,o(),r),Wf.unbindAffected(n,s(),(a,l)=>{ge(a)&&r(a,l)}),Wf.rebindAffected(n,o(),r)}static redrawElements(t,n){try{const i=new k6(t,{skipValidation:!0});Ut.redrawTextBoundingBoxes(i,n),Ut.redrawBoundArrows(i,n)}catch(i){console.error("Couldn't redraw elements",i)}finally{return t}}static redrawTextBoundingBoxes(t,n){const i=t.getNonDeletedElementsMap(),r=new Map;for(const s of n.values()){if(Dt(s)){const{containerId:o}=s,a=o?i.get(o):void 0;a&&r.set(a.id,{container:a,boundText:s})}if(Li(s)){const o=ea(s),a=o?i.get(o):void 0;a&&r.set(s.id,{container:s,boundText:a})}}for(const{container:s,boundText:o}of r.values())s.isDeleted||o.isDeleted||Qi(o,s,t)}static redrawBoundArrows(t,n){for(const i of n.values())!i.isDeleted&&ss(i)&&fr(i,t,{changedElements:n})}static reorderElements(t,n,i){if(!i.containsZindexDifference)return t;const r=Array.from(t.values()),s=R9([...r]),o=Ne.getRightDifferences(r,s,!0).reduce((a,l)=>{const c=r[Number(l)];return c&&n.has(c.id)&&a.set(c.id,c),a},new Map);return!i.containsVisibleDifference&&o.size&&(i.containsVisibleDifference=!0),ve(uo(s,o))}static postProcess(t,n){try{Ne.diffArrays(t,n,"boundElements",s=>s.id);const i=t.points??[],r=n.points??[];Ne.isDifferent(i,r)||(Reflect.deleteProperty(t,"points"),Reflect.deleteProperty(n,"points"))}catch{console.error("Couldn't postprocess elements delta.")}finally{return[t,n]}}static stripIrrelevantProps(t){const{id:n,updated:i,...r}=t;return r}};F(Ut,"satisfiesAddition",({deleted:t,inserted:n})=>t.isDeleted===!0&&!n.isDeleted),F(Ut,"satisfiesRemoval",({deleted:t,inserted:n})=>!t.isDeleted&&n.isDeleted===!0),F(Ut,"satisfiesUpdate",({deleted:t,inserted:n})=>!!t.isDeleted==!!n.isDeleted),F(Ut,"satisfiesCommmonInvariants",({deleted:t,inserted:n})=>!!(Number.isInteger(t.version)&&Number.isInteger(n.version)&&t.version>=0&&n.version>=0&&t.version!==n.version)),F(Ut,"satisfiesUniqueInvariants",(t,n)=>{const{added:i,removed:r,updated:s}=t;return[i[n],r[n],s[n]].filter(Boolean).length===1}),F(Ut,"createApplier",(t,n,i,r,s)=>o=>{const a=Ut.createGetter(n,i,r);return Object.entries(o).reduce((l,[c,d])=>{const u=a(c,d.inserted);if(u){const f=Ut.applyDelta(u,d,r,s);if(n.set(f.id,f),l.set(f.id,f),!r.applyDirection){const h=t.get(c);h&&(r.applyDirection=h.version>f.version?"backward":"forward")}}return l},new Map)}),F(Ut,"createGetter",(t,n,i)=>(r,s)=>{let o=t.get(r);return o||(o=n.get(r),o?(i.containsZindexDifference=!0,(!s.isDeleted||s.isDeleted&&!o.isDeleted)&&(i.containsVisibleDifference=!0)):o=Ie({id:r,version:1},{...s})),o});let kd=Ut;const ode=(e,t,n,i)=>{const[r,s,o,a]=n.axis==="x"?["minX","midX","maxX","width"]:["minY","midY","maxY","height"],l=Ms(e),c=cy(e,t,i).map(h=>[h,Ms(h)]).sort((h,m)=>h[1][s]-m[1][s]);let d=0;for(const h of c)d+=h[1][a];const u=(l[a]-d)/(c.length-1);if(u<0){const h=c.findIndex(b=>b[1][r]===l[r]),m=c.findIndex(b=>b[1][o]===l[o]),p=(c[m][1][s]-c[h][1][s])/(c.length-1);let U=c[h][1][s];return c.flatMap(([b,y],w)=>{const v={x:0,y:0};return w!==h&&w!==m&&(U+=p,v[n.axis]=U-y[s]),b.map(I=>Ie(I,{x:I.x+v.x,y:I.y+v.y}))})}let f=l[r];return c.flatMap(([h,m])=>{const p={x:0,y:0};return p[n.axis]=f-m[r],f+=u,f+=m[a],h.map(U=>Ie(U,{x:U.x+p.x,y:U.y+p.y}))})},ade=(e,t,n,i,r,s)=>{if(t.length===1&&me(t[0])&&(t[0].startBinding||t[0].endBinding))return;const o=t.filter(u=>{if(me(u)&&u.startBinding&&u.endBinding){const f=t.find(m=>{var p;return m.id===((p=u.startBinding)==null?void 0:p.elementId)}),h=t.find(m=>{var p;return m.id===((p=u.endBinding)==null?void 0:p.elementId)});return f&&h}return!0}),a=new Set(o),l=o.filter(u=>we(u)).map(u=>u.id);if(l.length>0)for(const u of i.getNonDeletedElements())u.frameId!==null&&l.includes(u.frameId)&&a.add(u);const c=[];for(const u of a){const f=e.originalElements.get(u.id);if(!f)return;c.push(f)}const d=lde(ht(c),n,r,s);a.forEach(u=>{if(wM(e,u,i,d),!Ce(u)){const f=Le(u,i.getNonDeletedElementsMap());f&&wM(e,f,i,d),fr(u,i,{simultaneouslyUpdated:Array.from(a)})}})},lde=(e,t,n,i)=>{const[r,s]=e;let o=r+t.x+n.x,a=s+t.y+n.y;if(n.x===0||n.y===0){const[l,c]=Pn(r+t.x,s+t.y,i);n.x===0&&(o=l),n.y===0&&(a=c)}return{x:o-r,y:a-s}},wM=(e,t,n,i)=>{const r=e.originalElements.get(t.id)??t,s=r.x+i.x,o=r.y+i.y;n.mutateElement(t,{x:s,y:o})},cde=(e,t,n)=>{const[i,r]=ht(e);return[t-i,n-r]},_M=({newElement:e,elementType:t,originX:n,originY:i,x:r,y:s,width:o,height:a,shouldMaintainAspectRatio:l,shouldResizeFromCenter:c,zoom:d,scene:u,widthAspectRatio:f=null,originOffset:h=null,informMutation:m=!0})=>{l&&e.type!=="selection"&&(f?a=o/f:(Math.abs(s-i)>Math.abs(r-n)?{width:o,height:a}=gM(t,a,r<n?-o:o):{width:o,height:a}=gM(t,o,s<i?-a:a),a<0&&(a=-a)));let p=r<n?n-o:n,U=s<i?i-a:i;c&&(o+=o,a+=a,p=n-o/2,U=i-a/2);let b=null;if(ge(e)){a=e.height;const y=o9(mt({fontSize:e.fontSize,fontFamily:e.fontFamily}),e.lineHeight);o=Math.max(o,y),Math.abs(r-n)>Dre/d&&(b={autoResize:!1}),U=i,c&&(p=n-o/2)}if(o!==0&&a!==0){let y=null;yt(e)&&(y={initialWidth:o,initialHeight:a}),u.mutateElement(e,{x:p+((h==null?void 0:h.x)??0),y:U+((h==null?void 0:h.y)??0),width:o,height:a,...b,...y},{informMutation:m,isDragging:!1})}},cH=(e,t)=>{const n=window.location.href;try{const i=new URL(n);return i.searchParams.set(Jb,e),ts(i.toString())}catch(i){console.error(i)}return ts(n)},dH=(e,t)=>{if(e.length>0&&R6(e)){if(e.length===1)return{id:e[0].id,type:"element"};if(e.length>1){const n=Object.keys(t.selectedGroupIds)[0];return n?{id:n,type:"group"}:{id:e[0].groupIds[0],type:"group"}}}return null},R6=e=>!!(e.length===1||e.length>1&&b9(e)),hh=e=>{try{const t=new URL(e);return t.searchParams.has(Jb)&&t.host===window.location.host}catch{return!1}},dde=e=>{try{const{searchParams:t}=new URL(e);if(t.has(Jb))return t.get(Jb)}catch{}return null},fo=(e,{x:t,y:n,strokeColor:i=mn.strokeColor,backgroundColor:r=mn.backgroundColor,fillStyle:s=mn.fillStyle,strokeWidth:o=mn.strokeWidth,strokeStyle:a=mn.strokeStyle,roughness:l=mn.roughness,opacity:c=mn.opacity,width:d=0,height:u=0,angle:f=0,groupIds:h=[],frameId:m=null,index:p=null,roundness:U=null,boundElements:b=null,link:y=null,locked:w=mn.locked,...v})=>((t<-1e6||t>1e6||n<-1e6||n>1e6||d<-1e6||d>1e6||u<-1e6||u>1e6)&&console.error("New element size or position is too large",{x:t,y:n,width:d,height:u,points:v.points}),{id:v.id||gr(),type:e,x:t,y:n,width:d,height:u,angle:f,strokeColor:i,backgroundColor:r,fillStyle:s,strokeWidth:o,strokeStyle:a,roughness:l,opacity:c,groupIds:h,frameId:m,index:p,roundness:U,seed:v.seed??Ps(),version:v.version||1,versionNonce:v.versionNonce??0,isDeleted:!1,boundElements:b,updated:wg(),link:y,locked:w,customData:v.customData}),ia=e=>fo(e.type,e),TM=e=>fo("embeddable",e),ude=e=>({...fo("iframe",e)}),L9=e=>Ie({...fo("frame",e),type:"frame",name:(e==null?void 0:e.name)||null},{}),G4=e=>Ie({...fo("magicframe",e),type:"magicframe",name:(e==null?void 0:e.name)||null},{}),uH=(e,t)=>({x:e.textAlign==="center"?t.width/2:e.textAlign==="right"?t.width:0,y:e.verticalAlign==="middle"?t.height/2:0}),os=e=>{const t=e.fontFamily||sd,n=e.fontSize||Il,i=e.lineHeight||zc(t),r=Gh(e.text),s=jn(r,mt({fontFamily:t,fontSize:n}),i),o=e.textAlign||Up,a=e.verticalAlign||Kb,l=uH({textAlign:o,verticalAlign:a},s),c={...fo("text",e),text:r,fontSize:n,fontFamily:t,textAlign:o,verticalAlign:a,x:e.x-l.x,y:e.y-l.y,width:s.width,height:s.height,containerId:e.containerId||null,originalText:e.originalText??r,autoResize:e.autoResize??!0,lineHeight:i};return Ie(c,{})},fde=(e,t,n)=>{let{width:i,height:r}=jn(n,mt(e),e.lineHeight);e.autoResize||(i=e.width);const{textAlign:s,verticalAlign:o}=e;let a,l;if(s==="center"&&o===Yr.MIDDLE&&!e.containerId&&e.autoResize){const c=jn(e.text,mt(e),e.lineHeight),d=uH(e,{width:i-c.width,height:r-c.height});a=e.x-d.x,l=e.y-d.y}else{const[c,d,u,f]=$e(e,t),[h,m,p,U]=bm(e,i,r,!1),b=(c-h)/2,y=(d-m)/2,w=(u-p)/2,v=(f-U)/2;[a,l]=hde({s:!0,e:s==="center"||s==="left",w:s==="center"||s==="right"},e.x,e.y,e.angle,b,y,w,v)}return{width:i,height:r,x:Number.isFinite(a)?a:e.x,y:Number.isFinite(l)?l:e.y}},hde=(e,t,n,i,r,s,o,a)=>{const l=Math.cos(i),c=Math.sin(i);return e.e&&e.w?t+=r+o:e.e?(t+=r*(1+l),n+=r*c,t+=o*(1-l),n+=o*-c):e.w&&(t+=r*(1-l),n+=r*-c,t+=o*(1+l),n+=o*c),e.n&&e.s?n+=s+a:e.n?(t+=s*c,n+=s*(1-l),t+=a*-c,n+=a*(1+l)):(t+=s*-c,n+=s*(1+l),t+=a*c,n+=a*(1-l)),[t,n]},fH=(e,t,n,i=e.text)=>{if(e.isDeleted)return;(t||!e.autoResize)&&(i=ad(i,mt(e),t?ta(t,e):e.width));const r=fde(e,n,i);return{text:i,...r}},gde=e=>({...fo(e.type,e),points:e.points||[],pressures:e.pressures||[],simulatePressure:e.simulatePressure,lastCommittedPoint:null}),Tc=e=>{const t={...fo(e.type,e),points:e.points||[],lastCommittedPoint:null,startBinding:null,endBinding:null,startArrowhead:null,endArrowhead:null};return nn(t)?{...t,polygon:e.polygon??!1}:t},gh=e=>e.elbowed?{...fo(e.type,e),points:e.points||[],lastCommittedPoint:null,startBinding:null,endBinding:null,startArrowhead:e.startArrowhead||null,endArrowhead:e.endArrowhead||null,elbowed:!0,fixedSegments:e.fixedSegments||[],startIsSpecial:!1,endIsSpecial:!1}:{...fo(e.type,e),points:e.points||[],lastCommittedPoint:null,startBinding:null,endBinding:null,startArrowhead:e.startArrowhead||null,endArrowhead:e.endArrowhead||null,elbowed:!1},hH=e=>({...fo("image",e),strokeColor:"transparent",status:e.status??"pending",fileId:e.fileId??null,scale:e.scale??[1,1],crop:e.crop??null}),Eo=new Map,mde=/^(?:http(?:s)?:\/\/)?(?:www\.)?youtu(?:be\.com|\.be)\/(embed\/|watch\?v=|shorts\/|playlist\?list=|embed\/videoseries\?list=)?([a-zA-Z0-9_-]+)/,pde=/^(?:http(?:s)?:\/\/)?(?:(?:w){3}\.)?(?:player\.)?vimeo\.com\/(?:video\/)?([^?\s]+)(?:\?.*)?$/,Ude=/^https:\/\/(?:www\.)?figma\.com/,IM=/^https:\/\/gist\.github\.com\/([\w_-]+)\/([\w_-]+)/,bde=/^<script[\s\S]*?\ssrc=["'](https:\/\/gist\.github\.com\/.*?)\.js["']/i,yde=/^(?:https?:\/\/)?forms\.microsoft\.com\//,SM=/(?:https?:\/\/)?(?:(?:w){3}\.)?(?:twitter|x)\.com\/[^/]+\/status\/(\d+)/,Ede=/^<blockquote[\s\S]*?\shref=["'](https?:\/\/(?:twitter|x)\.com\/[^"']*)/i,vde=/^https:\/\/(?:www\.)?val\.town\/(v|embed)\/[a-zA-Z_$][0-9a-zA-Z_$]+\.[a-zA-Z_$][0-9a-zA-Z_$]+/,wde=/^<(?:iframe|blockquote)[\s\S]*?\s(?:src|href)=["']([^"']*)["'][\s\S]*?>$/i,xM=/giphy.com\/(?:clips|embed|gifs)\/[a-zA-Z0-9]*?-?([a-zA-Z0-9]+)(?:[^a-zA-Z0-9]|$)/,CM=/^(?:http(?:s)?:\/\/)?(?:www\.)?reddit\.com\/r\/([a-zA-Z0-9_]+)\/comments\/([a-zA-Z0-9_]+)\/([a-zA-Z0-9_]+)\/?(?:\?[^#\s]*)?(?:#[^\s]*)?$/,_de=/^<blockquote[\s\S]*?\shref=["'](https?:\/\/(?:www\.)?reddit\.com\/[^"']*)/i,Tde=e=>{let t;try{const o=new URL(e.startsWith("http")?e:`https://${e}`);t=o.searchParams.get("t")||o.searchParams.get("start")}catch{const a=e.match(/[?&#](?:t|start)=([^&#\s]+)/);t=a==null?void 0:a[1]}if(!t)return 0;if(/^\d+$/.test(t))return parseInt(t,10);const n=t.match(/^(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?$/);if(!n)return 0;const[,i="0",r="0",s="0"]=n;return parseInt(i)*3600+parseInt(r)*60+parseInt(s)},X4=new Set(["youtube.com","youtu.be","vimeo.com","player.vimeo.com","figma.com","link.excalidraw.com","gist.github.com","twitter.com","x.com","*.simplepdf.eu","stackblitz.com","val.town","giphy.com","reddit.com","forms.microsoft.com"]),AM=new Set(["youtube.com","youtu.be","vimeo.com","player.vimeo.com","figma.com","twitter.com","x.com","*.simplepdf.eu","stackblitz.com","reddit.com","forms.microsoft.com"]),x0=e=>`<html><body>${e}</body></html>`,Zf=e=>{if(!e)return null;if(Eo.has(e))return Eo.get(e);const t=e,n=AM.has(j4(e,AM)||"");let i="generic",r={w:560,h:840};const s=e.match(mde);if(s!=null&&s[2]){const c=Tde(t),d=c>0?`&start=${c}`:"",u=e.includes("shorts");switch(i="video",s[1]){case"embed/":case"watch?v=":case"shorts/":e=`https://www.youtube.com/embed/${s[2]}?enablejsapi=1${d}`;break;case"playlist?list=":case"embed/videoseries?list=":e=`https://www.youtube.com/embed/videoseries?list=${s[2]}&enablejsapi=1${d}`;break;default:e=`https://www.youtube.com/embed/${s[2]}?enablejsapi=1${d}`;break}return r=u?{w:315,h:560}:{w:560,h:315},Eo.set(t,{link:e,intrinsicSize:r,type:i,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:r,type:i,sandbox:{allowSameOrigin:n}}}const o=e.match(pde);if(o!=null&&o[1]){const c=o==null?void 0:o[1],d=/^\d+$/.test(c)?void 0:new URIError("Invalid embed link format");return i="video",e=`https://player.vimeo.com/video/${c}?api=1`,r={w:560,h:315},Eo.set(t,{link:e,intrinsicSize:r,type:i,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:r,type:i,error:d,sandbox:{allowSameOrigin:n}}}if(e.match(Ude))return i="generic",e=`https://www.figma.com/embed?embed_host=share&url=${encodeURIComponent(e)}`,r={w:550,h:550},Eo.set(t,{link:e,intrinsicSize:r,type:i,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:r,type:i,sandbox:{allowSameOrigin:n}};const l=e.match(vde);if(l)return e=l[1]==="embed"?l[0]:l[0].replace("/v","/embed"),Eo.set(t,{link:e,intrinsicSize:r,type:i,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:r,type:i,sandbox:{allowSameOrigin:n}};if(yde.test(e)&&!e.includes("embed=true")&&(e+=e.includes("?")?"&embed=true":"?embed=true"),SM.test(e)){const c=e.match(SM)[1],d=P2(`https://twitter.com/x/status/${c}`),u={type:"document",srcdoc:f=>x0(`<blockquote class="twitter-tweet" data-dnt="true" data-theme="${f}"><a href="${d}"></a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"><\/script>`),intrinsicSize:{w:480,h:480},sandbox:{allowSameOrigin:n}};return Eo.set(t,u),u}if(CM.test(e)){const[,c,d,u]=e.match(CM),f=P2(`https://reddit.com/r/${c}/comments/${d}/${u}`),h={type:"document",srcdoc:m=>x0(`<blockquote class="reddit-embed-bq" data-embed-theme="${m}"><a href="${f}"></a><br></blockquote><script async="" src="https://embed.reddit.com/widgets.js" charset="UTF-8"><\/script>`),intrinsicSize:{w:480,h:480},sandbox:{allowSameOrigin:n}};return Eo.set(t,h),h}if(IM.test(e)){const[,c,d]=e.match(IM),u=P2(`https://gist.github.com/${c}/${d}`),f={type:"document",srcdoc:()=>x0(`
          <script src="${u}.js"><\/script>
          <style type="text/css">
            * { margin: 0px; }
            table, .gist { height: 100%; }
            .gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }
          </style>
        `),intrinsicSize:{w:550,h:720},sandbox:{allowSameOrigin:n}};return Eo.set(e,f),f}return Eo.set(e,{link:e,intrinsicSize:r,type:i,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:r,type:i,sandbox:{allowSameOrigin:n}}},gH=e=>{let t;Zl(e)?t="IFrame element":t=!e.link||(e==null?void 0:e.link)===""?"Empty Web-Embed":e.link;const n=Math.max(Math.min(e.width/2,e.width/t.length),e.width/30),i=nt.Helvetica,r=mt({fontSize:n,fontFamily:i});return os({x:e.x+e.width/2,y:e.y+e.height/2,strokeColor:e.strokeColor!=="transparent"?e.strokeColor:"black",backgroundColor:"transparent",fontFamily:i,fontSize:n,text:ad(t,r,e.width-20),textAlign:"center",verticalAlign:Yr.MIDDLE,angle:e.angle??0})},j4=(e,t)=>{try{const{hostname:n}=new URL(e),i=n.replace(/^www\./,"");if(t instanceof Set){if(X4.has(i))return i;const s=i.replace(/^([^.]+)/,"*");return X4.has(s)?s:null}const r=t.replace(/^www\./,"");if(i===r)return r}catch{}return null},Ide=e=>{const t=e.match(Ede);if(t&&t.length===2)return t[1];const n=e.match(_de);if(n&&n.length===2)return n[1];const i=e.match(bde);if(i&&i.length===2)return i[1];if(xM.test(e))return`https://giphy.com/embed/${xM.exec(e)[1]}`;const r=e.match(wde);return r&&r.length===2?r[1]:e},G2=(e,t)=>{if(!e)return!1;if(t!=null)if(typeof t=="function"){const n=t(e);if(typeof n=="boolean")return n}else{if(typeof t=="boolean")return t;if(t instanceof RegExp)return t.test(e);if(Array.isArray(t)){for(const n of t)if(n instanceof RegExp){if(e.match(n))return!0}else if(j4(e,n))return!0;return!1}}return!!j4(e,X4)},mh=100,Pd=100,MM=e=>{switch(e){case V.ARROW_UP:return"up";case V.ARROW_DOWN:return"down";case V.ARROW_RIGHT:return"right";case V.ARROW_LEFT:return"left";default:return"right"}},mH=(e,t,n,i)=>{const r=[...n.values()].reduce((s,o)=>{var l;let a;if(me(o)&&(a=o[e==="predecessors"?"startBinding":"endBinding"])&&((l=o[e==="predecessors"?"endBinding":"startBinding"])==null?void 0:l.elementId)===t.id){const c=n.get(a.elementId);if(!c)return s;gn(ss(c),"not an ExcalidrawBindableElement");const d=e==="predecessors"?o.points[o.points.length-1]:[0,0],u=u9(t,Sa(t,n),[d[0]+o.x,d[1]+o.y]);s.push({relative:c,heading:u})}return s},[]);switch(i){case"up":return r.filter(s=>Gn(s.heading,to)).map(s=>s.relative);case"down":return r.filter(s=>Gn(s.heading,cr)).map(s=>s.relative);case"right":return r.filter(s=>Gn(s.heading,Vn)).map(s=>s.relative);case"left":return r.filter(s=>Gn(s.heading,vs)).map(s=>s.relative)}},Y4=(e,t,n)=>mH("successors",e,t,n),W4=(e,t,n)=>mH("predecessors",e,t,n),Sde=(e,t,n)=>{const i=Pd+e.width;if(n==="up"||n==="down"){const a=mh+e.height,l=e.x,c=e.x+e.width;if(t.every(d=>d.x+d.width<l||d.x>c))return{x:0,y:a*(n==="up"?-1:1)}}else if(n==="right"||n==="left"){const a=e.y,l=e.y+e.height;if(t.every(c=>c.y+c.height<a||c.y>l))return{x:(Pd+e.width)*(n==="left"?-1:1),y:0}}if(n==="up"||n==="down"){const a=mh+e.height,l=(t.length===0,a),c=t.length===0?0:(t.length+1)%2===0?(t.length+1)/2*i:t.length/2*i*-1;return n==="up"?{x:c,y:l*-1}:{x:c,y:l}}const r=mh+e.height,s=(t.length===0,Pd+e.width),o=t.length===0?0:(t.length+1)%2===0?(t.length+1)/2*r:t.length/2*r*-1;return n==="left"?{x:s*-1,y:o}:{x:s,y:o}},xde=(e,t,n,i)=>{const r=i.getNonDeletedElementsMap(),s=Y4(e,r,n),o=W4(e,r,n),a=Sde(e,[...s,...o],n),l=ia({type:e.type,x:e.x+a.x,y:e.y+a.y,width:e.width,height:e.height,roundness:e.roundness,roughness:e.roughness,backgroundColor:e.backgroundColor,strokeColor:e.strokeColor,strokeWidth:e.strokeWidth,opacity:e.opacity,fillStyle:e.fillStyle,strokeStyle:e.strokeStyle});gn(oy(l),"not an ExcalidrawFlowchartNodeElement");const c=pH(e,l,n,t,i);return{nextNode:l,bindingArrow:c}},Cde=(e,t,n,i,r)=>{const s=[];for(let o=0;o<r;o++){let a,l;if(n==="left"||n==="right"){const u=mh*(r-1)+r*e.height,f=e.y+e.height/2-u/2;let h=Pd+e.width;n==="left"&&(h*=-1),a=e.x+h;const m=(mh+e.height)*o;l=f+m}else{const u=Pd*(r-1)+r*e.width,f=e.x+e.width/2-u/2;let h=mh+e.height;n==="up"&&(h*=-1),l=e.y+h;const m=(Pd+e.width)*o;a=f+m}const c=ia({type:e.type,x:a,y:l,width:e.width,height:e.height,roundness:e.roundness,roughness:e.roughness,backgroundColor:e.backgroundColor,strokeColor:e.strokeColor,strokeWidth:e.strokeWidth,opacity:e.opacity,fillStyle:e.fillStyle,strokeStyle:e.strokeStyle});gn(oy(c),"not an ExcalidrawFlowchartNodeElement");const d=pH(e,c,n,t,i);s.push(c),s.push(d)}return s},pH=(e,t,n,i,r)=>{let s,o;switch(n){case"up":{s=e.x+e.width/2,o=e.y-6;break}case"down":{s=e.x+e.width/2,o=e.y+e.height+6;break}case"right":{s=e.x+e.width+6,o=e.y+e.height/2;break}case"left":{s=e.x-6,o=e.y+e.height/2;break}}let l,c;switch(n){case"up":{l=t.x+t.width/2-s,c=t.y+t.height-o+6;break}case"down":{l=t.x+t.width/2-s,c=t.y-o-6;break}case"right":{l=t.x-s-6,c=t.y-o+t.height/2;break}case"left":{l=t.x+t.width-s+6,c=t.y-o+t.height/2;break}}const d=gh({type:"arrow",x:s,y:o,startArrowhead:null,endArrowhead:i.currentItemEndArrowhead,strokeColor:e.strokeColor,strokeStyle:e.strokeStyle,strokeWidth:e.strokeWidth,opacity:e.opacity,roughness:e.roughness,points:[S(0,0),S(l,c)],elbowed:!0}),u=r.getNonDeletedElementsMap();na(d,e,"start",r),na(d,t,"end",r);const f=new Map;f.set(e.id,e),f.set(t.id,t),f.set(d.id,d),pe.movePoints(d,r,new Map([[1,{point:d.points[1]}]]));const h=_g(d,Qo(new Map([...u.entries(),[e.id,e],[t.id,t],[d.id,d]])),{points:d.points});return{...d,...h}};class Ade{constructor(){F(this,"isExploring",!1);F(this,"sameLevelNodes",[]);F(this,"sameLevelIndex",0);F(this,"direction",null);F(this,"visitedNodes",new Set)}clear(){this.isExploring=!1,this.sameLevelNodes=[],this.sameLevelIndex=0,this.direction=null,this.visitedNodes.clear()}exploreByDirection(t,n,i){if(!ss(t))return null;if(i!==this.direction&&this.clear(),this.visitedNodes.has(t.id)||this.visitedNodes.add(t.id),this.isExploring&&i===this.direction&&this.sameLevelNodes.length>1)return this.sameLevelIndex=(this.sameLevelIndex+1)%this.sameLevelNodes.length,this.sameLevelNodes[this.sameLevelIndex].id;const r=[...Y4(t,n,i),...W4(t,n,i)];if(r.length>0)return this.sameLevelIndex=0,this.isExploring=!0,this.sameLevelNodes=r,this.direction=i,this.visitedNodes.add(r[0].id),r[0].id;if(i===this.direction||!this.isExploring){this.isExploring||this.visitedNodes.add(t.id);const o=["up","right","down","left"].filter(a=>a!==i).map(a=>[...Y4(t,n,a),...W4(t,n,a)]).flat().filter(a=>!this.visitedNodes.has(a.id));for(const a of o)if(!this.visitedNodes.has(a.id))return this.visitedNodes.add(a.id),this.isExploring=!0,this.direction=i,a.id}return null}}class Mde{constructor(){F(this,"isCreatingChart",!1);F(this,"numberOfNodes",0);F(this,"direction","right");F(this,"pendingNodes",null)}createNodes(t,n,i,r){const s=r.getNonDeletedElementsMap();if(i!==this.direction){const{nextNode:o,bindingArrow:a}=xde(t,n,i,r);this.numberOfNodes=1,this.isCreatingChart=!0,this.direction=i,this.pendingNodes=[o,a]}else{this.numberOfNodes+=1;const o=Cde(t,n,i,r,this.numberOfNodes);this.isCreatingChart=!0,this.direction=i,this.pendingNodes=o}if(t.frameId){const o=s.get(t.frameId);gn(o&&az(o),"not an ExcalidrawFrameElement"),o&&this.pendingNodes.every(a=>Rp([a],o,s)||Vc(a,o,s))&&(this.pendingNodes=this.pendingNodes.map(a=>_i(a,s,{frameId:t.frameId})))}}clear(){this.isCreatingChart=!1,this.pendingNodes=null,this.direction=null,this.numberOfNodes=0}}const kde=(e,t)=>{var n,i;for(const[,r]of t)if(r.type==="arrow"&&(((n=r.startBinding)==null?void 0:n.elementId)===e.id||((i=r.endBinding)==null?void 0:i.elementId)===e.id))return!0;return!1},Rde=e=>new Promise((t,n)=>{const i=new Image;i.onload=()=>{t(i)},i.onerror=r=>{n(r)},i.src=e}),UH=async({fileIds:e,files:t,imageCache:n})=>{const i=new Map,r=new Map;return await Promise.all(e.reduce((s,o)=>{const a=t[o];return a&&!i.has(o)?(i.set(o,!0),s.concat((async()=>{try{if(a.mimeType===Te.binary)throw new Error("Only images can be added to ImageCache");const l=Rde(a.dataURL),c={image:l,mimeType:a.mimeType};n.set(o,c);const d=await l;n.set(o,{...c,image:d})}catch{r.set(o,!0)}})())):s},[])),{imageCache:n,updatedFiles:i,erroredFiles:r}},bH=e=>e.filter(t=>Dn(t)),Dde=e=>(e==null?void 0:e.nodeName.toLowerCase())==="svg",kM=e=>{const t=new DOMParser().parseFromString(e,Te.svg),n=t.querySelector("svg");if(t.querySelector("parsererror")||!Dde(n))throw new Error("Invalid SVG");{n.hasAttribute("xmlns")||n.setAttribute("xmlns",st);let r=n.getAttribute("width"),s=n.getAttribute("height");(r!=null&&r.includes("%")||r==="auto")&&(r=null),(s!=null&&s.includes("%")||s==="auto")&&(s=null);const o=n.getAttribute("viewBox");if(!r||!s){if(r=r||"50",s=s||"50",o){const a=o.match(/\d+ +\d+ +(\d+(?:\.\d+)?) +(\d+(?:\.\d+)?)/);a&&([,r,s]=a)}n.setAttribute("width",r),n.setAttribute("height",s)}return o||n.setAttribute("viewBox",`0 0 ${r} ${s}`),n.outerHTML}},RM=(e,t,n,i=50)=>{if(!e||e.length===0)return[];const r=[],s=Array.isArray(e[0])?e:e.map(h=>[h]),o=s.length,a=Math.max(1,Math.ceil(Math.sqrt(o))),l=[];for(let h=0;h<o;h+=a)l.push(s.slice(h,h+a));let c=0;const d=l.map(h=>{let m=0,p=0;const U=h.map(b=>{const[y,w,v,I]=ht(b);return{elements:b,bounds:[y,w,v,I],width:v-y,height:I-w}});return U.forEach((b,y)=>{m+=b.width,y<U.length-1&&(m+=i),b.height>p&&(p=b.height)}),c+=p,{unitBounds:U,width:m,maxHeight:p}}),u=c+Math.max(0,l.length-1)*i;let f=n-u/2;return d.forEach(h=>{const{unitBounds:m,width:p,maxHeight:U}=h;let b=t-p/2;m.forEach(y=>{const[w,v]=y.bounds,I=b-w,C=f-v;y.elements.forEach(_=>{r.push(Ie(_,{x:_.x+I,y:_.y+C}))}),b+=y.width+i}),f+=U+i}),r},Lde=(e,t,n,i,r,s,o,a,l,c,d)=>{const u=i.getNonDeletedElementsMap();if(n.length===1){const[f]=n;if(t==="rotation")me(f)||(Nde(f,i,a,l,r),fr(f,i));else if(t){const h=n[0].id,m=u.get(h),p=e.get(h);if(m&&p){const{nextWidth:U,nextHeight:b}=Hde(m,p,t,a,l,{shouldMaintainAspectRatio:o,shouldResizeFromCenter:s});Em(U,b,m,p,e,i,t,{shouldMaintainAspectRatio:o,shouldResizeFromCenter:s})}}return ge(f)&&fr(f,i),!0}else if(n.length>1){if(t==="rotation")return Pde(e,n,i,a,l,r,c,d),!0;if(t){const{nextWidth:f,nextHeight:h,flipByX:m,flipByY:p,originalBoundingBox:U}=Vde(n,e,u,t,a,l,{shouldMaintainAspectRatio:o,shouldResizeFromCenter:s});return yH(n,u,t,i,e,{shouldResizeFromCenter:s,shouldMaintainAspectRatio:o,flipByX:m,flipByY:p,nextWidth:f,nextHeight:h,originalBoundingBox:U}),!0}}return!1},Nde=(e,t,n,i,r)=>{const[s,o,a,l]=$e(e,t.getNonDeletedElementsMap()),c=(s+a)/2,d=(o+l)/2;let u;we(e)?u=0:(u=5*Math.PI/2+Math.atan2(i-d,n-c),r&&(u=u+Hr/2,u=u-u%Hr),u=oo(u));const f=ea(e);if(t.mutateElement(e,{angle:u}),f){const h=t.getElement(f);if(h&&!Ce(e)){const{x:m,y:p}=ld(e,h,t.getNonDeletedElementsMap());t.mutateElement(h,{angle:u,x:m,y:p})}}},N9=(e,t,n,i)=>xe(e)||qi(e)?{points:a6(0,t,a6(1,n,e.points,i),i)}:{},O9=(e,t,n)=>{let i=e.width;if(Dt(e)){const o=Yn(e,t);o&&(i=ta(o,e))}const s=e.fontSize*(n/i);return s<O_?null:{size:s}},Ode=(e,t,n,i,r,s,o)=>{const a=n.getNonDeletedElementsMap(),l=t.width*(o/t.height),c=O9(t,a,l);if(c!==null){if(i.includes("n")||i.includes("s")){const d=S(e.x,e.y),u=K4(d,e.width,e.height,l,o,e.angle,i,!1,r);n.mutateElement(t,{fontSize:c.size,width:l,height:o,x:u.x,y:u.y});return}if(i==="e"||i==="w"){const d=o9(mt({fontSize:t.fontSize,fontFamily:t.fontFamily}),t.lineHeight),u=Math.max(d,s),f=ad(t.originalText,mt(t),Math.abs(u)),h=jn(f,mt(t),t.lineHeight),m=h.height,p=S(e.x,e.y),U=K4(p,e.width,e.height,u,m,t.angle,i,!1,r),b={width:Math.abs(u),height:Math.abs(h.height),x:U.x,y:U.y,text:f,autoResize:!1};n.mutateElement(t,b)}}},Pde=(e,t,n,i,r,s,o,a)=>{var d;const l=n.getNonDeletedElementsMap();let c=5*Math.PI/2+Math.atan2(r-a,i-o);s&&(c+=Hr/2,c-=c%Hr);for(const u of t)if(!we(u)){const[f,h,m,p]=$e(u,l),U=(f+m)/2,b=(h+p)/2,y=((d=e.get(u.id))==null?void 0:d.angle)??u.angle,[w,v]=Q(S(U,b),S(o,a),c+y-u.angle),I=me(u)?{points:Nle(u,l)}:{x:u.x+(w-U),y:u.y+(v-b),angle:oo(c+y)};n.mutateElement(u,I),fr(u,n,{simultaneouslyUpdated:t});const C=Le(u,l);if(C&&!Ce(u)){const{x:_,y:T}=ld(u,C,l);n.mutateElement(C,{x:_,y:T,angle:oo(c+y)})}}n.triggerUpdate()},Fde=(e,t,n,i,r)=>{const[s,o,a,l]=t.length===1?$e(t[0],n):ht(t),c=(s+a)/2,d=(o+l)/2,u=t.length===1?t[0].angle:0;switch([i,r]=Q(S(i,r),S(c,d),-u),e){case"n":return Q(S(i-(s+a)/2,r-o),S(0,0),u);case"s":return Q(S(i-(s+a)/2,r-l),S(0,0),u);case"w":return Q(S(i-s,r-(o+l)/2),S(0,0),u);case"e":return Q(S(i-a,r-(o+l)/2),S(0,0),u);case"nw":return Q(S(i-s,r-o),S(0,0),u);case"ne":return Q(S(i-a,r-o),S(0,0),u);case"sw":return Q(S(i-s,r-l),S(0,0),u);case"se":return Q(S(i-a,r-l),S(0,0),u);default:return[0,0]}},Bde=(e,t)=>{const[,[n,i]]=t.points;return e==="nw"&&(n<0||i<0)||e==="ne"&&n>=0||e==="sw"&&n<=0||e==="se"&&(n>0||i>0)?"end":"origin"},zde=(e,t,n)=>{if(n)return"center";if(t)switch(e){case"n":return"south-side";case"e":return"west-side";case"s":return"north-side";case"w":return"east-side";case"ne":return"bottom-left";case"nw":return"bottom-right";case"se":return"top-left";case"sw":return"top-right"}return["e","se","s"].includes(e)?"top-left":["n","nw","w"].includes(e)?"bottom-right":e==="ne"?"bottom-left":"top-right"},K4=(e,t,n,i,r,s,o,a,l)=>{const c=zde(o,a,l),[d,u]=e;switch(c){case"top-left":return{x:d+(t-i)/2+(i-t)/2*Math.cos(s)+(n-r)/2*Math.sin(s),y:u+(n-r)/2+(i-t)/2*Math.sin(s)+(r-n)/2*Math.cos(s)};case"top-right":return{x:d+(t-i)/2*(Math.cos(s)+1)+(n-r)/2*Math.sin(s),y:u+(n-r)/2+(t-i)/2*Math.sin(s)+(r-n)/2*Math.cos(s)};case"bottom-left":return{x:d+(t-i)/2*(1-Math.cos(s))+(r-n)/2*Math.sin(s),y:u+(n-r)/2*(Math.cos(s)+1)+(i-t)/2*Math.sin(s)};case"bottom-right":return{x:d+(t-i)/2*(Math.cos(s)+1)+(r-n)/2*Math.sin(s),y:u+(n-r)/2*(Math.cos(s)+1)+(t-i)/2*Math.sin(s)};case"center":return{x:d-(i-t)/2,y:u-(r-n)/2};case"east-side":return{x:d+(t-i)/2*(Math.cos(s)+1),y:u+(t-i)/2*Math.sin(s)+(n-r)/2};case"west-side":return{x:d+(t-i)/2*(1-Math.cos(s)),y:u+(i-t)/2*Math.sin(s)+(n-r)/2};case"north-side":return{x:d+(t-i)/2+(n-r)/2*Math.sin(s),y:u+(r-n)/2*(Math.cos(s)-1)};case"south-side":return{x:d+(t-i)/2+(r-n)/2*Math.sin(s),y:u+(n-r)/2*(Math.cos(s)+1)}}},Em=(e,t,n,i,r,s,o,{shouldInformMutation:a=!0,shouldMaintainAspectRatio:l=!1,shouldResizeFromCenter:c=!1}={})=>{if(ge(n)&&ge(i))return Ode(i,n,s,o,c,e,t);let d={};const u=s.getNonDeletedElementsMap(),f=Le(n,u);if(f){const U=r.get(f.id);if(U&&(d={fontSize:U.fontSize}),l){const b={...n,width:e},y=O9(f,u,ta(b,f));if(y===null)return;d={fontSize:y.size}}else{const b=gz(mt(f),f.lineHeight),y=mz(f.fontSize,f.lineHeight);e=Math.max(e,b),t=Math.max(t,y)}}const h=N9(i,e,t,!0);let m=S(i.x,i.y);if(xe(i)){const[U,b]=si(i,r);m=S(U,b)}const p=K4(m,i.width,i.height,e,t,i.angle,o,l,c);if(xe(i)&&h.points){const U=i.x-m[0],b=i.y-m[1];p.x+=U,p.y+=b;const y=h.points[0][0],w=h.points[0][1];p.x+=y,p.y+=w,h.points=h.points.map(v=>S(v[0]-y,v[1]-w))}if(e<0&&(p.x=p.x+e),t<0&&(p.y=p.y+t),"scale"in n&&"scale"in i&&s.mutateElement(n,{scale:[(Math.sign(e)||i.scale[0])*i.scale[0],(Math.sign(t)||i.scale[1])*i.scale[1]]}),Ce(n)&&f&&l){const U=e/n.width*f.fontSize;if(U<O_)return;d.fontSize=U}if(e!==0&&t!==0&&Number.isFinite(p.x)&&Number.isFinite(p.y)){const U={...p,width:Math.abs(e),height:Math.abs(t),...h};s.mutateElement(n,U,{informMutation:a,isDragging:!1}),f&&d!=null&&s.mutateElement(f,{fontSize:d.fontSize}),Cp(n,s,o,l),fr(n,s,{newSize:{width:e,height:t}})}},Hde=(e,t,n,i,r,{shouldMaintainAspectRatio:s=!1,shouldResizeFromCenter:o=!1}={})=>{const[a,l,c,d]=bm(t,t.width,t.height,!0),u=S(a,l),f=S(c,d),h=n6(u,f),m=Q(S(i,r),h,-t.angle),[p,U,b,y]=bm(e,e.width,e.height,!0),w=b-p,v=y-U,I=f[0]-u[0],C=f[1]-u[1];let _=I/w,T=C/v;n.includes("e")&&(_=(m[0]-u[0])/w),n.includes("s")&&(T=(m[1]-u[1])/v),n.includes("w")&&(_=(f[0]-m[0])/w),n.includes("n")&&(T=(f[1]-m[1])/v);let k=e.width*_,x=e.height*T;if(o&&(k=2*k-t.width,x=2*x-t.height),s){const D=Math.abs(k)/t.width,O=Math.abs(x)/t.height;if(n.length===1&&(x*=D,k*=O),n.length===2){const L=Math.max(D,O);k=t.width*L*Math.sign(k),x=t.height*L*Math.sign(x)}}return{nextWidth:k,nextHeight:x}},Vde=(e,t,n,i,r,s,{shouldMaintainAspectRatio:o=!1,shouldResizeFromCenter:a=!1}={})=>{const l=e.map(L=>t.get(L.id)),c=l.reduce((L,Y)=>{if(!xe(Y))return L;const $=ea(Y);if(!$)return L;const H=t.get($)??null;return Dt(H)?[...L,{...H,...pe.getBoundTextElementPosition(Y,H,n)}]:L},[]),d=Ms(l.map(L=>L).concat(c)),{minX:u,minY:f,maxX:h,maxY:m,midX:p,midY:U}=d,b=h-u,y=m-f,w={ne:[u,m],se:[u,f],sw:[h,f],nw:[h,m],e:[u,f+y/2],w:[h,f+y/2],n:[u+b/2,m],s:[u+b/2,f]},[v,I]=a?[p,U]:w[i],C=a?2:1,_=Math.max(Math.abs(r-v)/b||0,Math.abs(s-I)/y||0)*C;let T=i.includes("e")||i.includes("w")?Math.abs(r-v)*C:b,k=i.includes("n")||i.includes("s")?Math.abs(s-I)*C:y;o&&(T=b*_*Math.sign(r-v),k=y*_*Math.sign(s-I));const x={ne:[r<v,s>I],se:[r<v,s<I],sw:[r>v,s<I],nw:[r>v,s>I],e:[r<v,!1],w:[r>v,!1],n:[!1,s>I],s:[!1,s<I]},[D,O]=x[i].map(L=>L);return{originalBoundingBox:d,nextWidth:T,nextHeight:k,flipByX:D,flipByY:O}},yH=(e,t,n,i,r,{shouldMaintainAspectRatio:s=!1,shouldResizeFromCenter:o=!1,flipByX:a=!1,flipByY:l=!1,nextHeight:c,nextWidth:d,originalBoundingBox:u}={})=>{if(d===void 0&&c===void 0&&a===void 0&&l===void 0||c===0||d===0)return;r||(r=t);const f=e.reduce((C,_)=>{const T=r.get(_.id);return T&&C.push({orig:T,latest:_}),C},[]);let h;if(u)h=u;else{const C=f.reduce((_,{orig:T})=>{if(!xe(T))return _;const k=ea(T);if(!k)return _;const x=r.get(k)??null;return Dt(x)?[..._,{...x,...pe.getBoundTextElementPosition(T,x,t)}]:_},[]);h=Ms(f.map(({orig:_})=>_).concat(C))}const{minX:m,minY:p,maxX:U,maxY:b,midX:y,midY:w}=h,v=U-m,I=b-p;if(d===void 0&&c===void 0&&(d=v,c=I),s&&(d===void 0?d=c*(v/I):c===void 0?c=d*(I/v):Math.abs(d/c-v/I)>.001&&(d=c*(v/I))),d&&c){let C=n.includes("e")||n.includes("w")?Math.abs(d)/v:1,_=n.includes("n")||n.includes("s")?Math.abs(c)/I:1,T;n.length===1?T=n.includes("e")||n.includes("w")?C:_:T=Math.max(Math.abs(d)/v||0,Math.abs(c)/I||0);const k={ne:[m,b],se:[m,p],sw:[U,p],nw:[U,b],e:[m,p+I/2],w:[U,p+I/2],n:[m+v/2,b],s:[m+v/2,p]},[x,D]=o?[y,w]:k[n],O=s||f.some(z=>z.latest.angle!==0||ge(z.latest)||jh(z.latest));O&&(C=T,_=T);const[L,Y]=[a?-1:1,l?-1:1],$=[];for(const{orig:z,latest:G}of f){if(ge(z)&&Dt(z))continue;const j=z.width*C,X=z.height*_,K=oo(z.angle*L*Y),ne=xe(z)||qi(z),se=z.x-x,oe=z.y-D,Ee=a&&!ne?j:0,Re=l&&!ne?X:0,De=x+L*(se*C+Ee),vt=D+Y*(oe*_+Re),Vt=N9(z,j*L,X*Y,!1),Be={x:De,y:vt,width:j,height:X,angle:K,...Vt};if(me(z)&&(z.startBinding&&(Be.startBinding={...z.startBinding,fixedPoint:[a?-z.startBinding.fixedPoint[0]+1:z.startBinding.fixedPoint[0],l?-z.startBinding.fixedPoint[1]+1:z.startBinding.fixedPoint[1]]}),z.endBinding&&(Be.endBinding={...z.endBinding,fixedPoint:[a?-z.endBinding.fixedPoint[0]+1:z.endBinding.fixedPoint[0],l?-z.endBinding.fixedPoint[1]+1:z.endBinding.fixedPoint[1]]}),z.fixedSegments&&Vt.points&&(Be.fixedSegments=z.fixedSegments.map($t=>({...$t,start:Vt.points[$t.index-1],end:Vt.points[$t.index]})))),yt(z)&&(Be.scale=[z.scale[0]*L,z.scale[1]*Y]),ge(z)){const $t=O9(z,t,j);if(!$t)return;Be.fontSize=$t.size}const Qe=r.get(ea(z)??"");if(Qe)if(O){const $t=Qe.fontSize*T;if($t<O_)return;Be.boundTextFontSize=$t}else Be.boundTextFontSize=Qe.fontSize;$.push({element:G,update:Be})}const H=$.map(({element:z})=>z);for(const{element:z,update:{boundTextFontSize:G,...j}}of $){const{width:X,height:K,angle:ne}=j;i.mutateElement(z,j),fr(z,i,{simultaneouslyUpdated:H,newSize:{width:X,height:K}});const se=Le(z,t);se&&G&&(i.mutateElement(se,{fontSize:G,angle:xe(z)?void 0:ne}),Cp(z,i,n,!0))}i.triggerUpdate()}},DM={mouse:8,pen:16,touch:28},$de=16,EH={e:!0,s:!0,n:!0,w:!0},LM={e:!0,s:!0,n:!0,w:!0,nw:!0,se:!0},Y8={e:!0,s:!0,n:!0,w:!0},Ea=(e,t,n,i,r,s,o)=>{const[a,l]=Q(S(e+n/2,t+i/2),S(r,s),o);return[a-n/2,l-i/2,n,i]},P9=e=>!(e.formFactor==="phone"&&e.userAgent.isMobileDevice),C0=e=>P9(e)?EH:{},F9=([e,t,n,i,r,s],o,a,l,c={},d=4,u=pu)=>{const f=DM[l],h=f/a.value,m=f/a.value,p=f/a.value,U=f/a.value,b=n-e,y=i-t,w=d/a.value,v=(f-u*2)/(2*a.value),I={nw:c.nw?void 0:Ea(e-w-p+v,t-w-U+v,h,m,r,s,o),ne:c.ne?void 0:Ea(n+w-v,t-w-U+v,h,m,r,s,o),sw:c.sw?void 0:Ea(e-w-p+v,i+w-v,h,m,r,s,o),se:c.se?void 0:Ea(n+w-v,i+w-v,h,m,r,s,o),rotation:c.rotation?void 0:Ea(e+b/2-h/2,t-w-U+v-$de/a.value,h,m,r,s,o)},C=5*DM.mouse/a.value;return Math.abs(b)>C&&(c.n||(I.n=Ea(e+b/2-h/2,t-w-U+v,h,m,r,s,o)),c.s||(I.s=Ea(e+b/2-h/2,i+w-v,h,m,r,s,o))),Math.abs(y)>C&&(c.w||(I.w=Ea(e-w-p+v,t+y/2-m/2,h,m,r,s,o)),c.e||(I.e=Ea(n+w-v,t+y/2-m/2,h,m,r,s,o))),I},vH=(e,t,n,i="mouse",r=EH)=>{if(e.locked||me(e))return{};if(e.type==="freedraw"||xe(e)){if(e.points.length===2){const[,o]=e.points;o[0]===0||o[1]===0?r=Y8:o[0]>0&&o[1]<0?r=LM:o[0]>0&&o[1]>0?r=Y8:o[0]<0&&o[1]>0?r=LM:o[0]<0&&o[1]<0&&(r=Y8)}}else we(e)&&(r={...r,rotation:!0});const s=xe(e)?pu+8:yt(e)?0:pu;return F9($e(e,n,!0),e.angle,t,i,r,s,yt(e)?0:void 0)},wH=(e,t,n)=>{var r;if((r=t.selectedLinearElement)!=null&&r.isEditing)return!1;if(e.length>1)return!0;const i=e[0];return me(i)?!1:xe(i)?i.points.length>2&&!n.userAgent.isMobileDevice:!0},Z4=(e,t,n)=>t>=e[0]&&t<=e[0]+e[2]&&n>=e[1]&&n<=e[1]+e[3],Gde=(e,t,n,i,r,s,o,a)=>{if(!n.selectedElementIds[e.id])return!1;const{rotation:l,...c}=vH(e,s,t,o,C0(a));if(l&&Z4(l,i,r))return"rotation";const d=Object.keys(c).filter(u=>{const f=c[u];return f?Z4(f,i,r):!1});if(d.length>0)return d[0];if(P9(a)){const[u,f,h,m,p,U]=$e(e,t);if(!(xe(e)&&e.points.length<=2)){const b=yt(e)?0:Zb/s.value,y=Zb/s.value,w=_H(S(u-b,f-b),S(h+b,m+b),S(p,U),e.angle);for(const[v,I]of Object.entries(w))if(i6(S(i,r),I,y))return v}}return!1},NM=(e,t,n,i,r,s,o,a)=>e.reduce((l,c)=>{if(l)return l;const d=Gde(c,o,t,n,i,r,s,a);return d?{element:c,transformHandleType:d}:null},null),OM=([e,t,n,i],r,s,o,a,l)=>{const c=F9([e,t,n,i,(e+n)/2,(t+i)/2],0,o,a,C0(l)),d=Object.keys(c).find(u=>{const f=c[u];return f&&Z4(f,r,s)});if(d)return d;if(P9(l)){const u=(e+n)/2,f=(t+i)/2,h=Zb/o.value,m=_H(S(e-h,t-h),S(n+h,i+h),S(u,f),0);for(const[p,U]of Object.entries(m))if(i6(S(r,s),U,h))return p}return!1},W8=["ns","nesw","ew","nwse"],Xde=(e,t)=>{const n=W8.indexOf(e);if(n>=0){const i=Math.round(t/(Math.PI/4));e=W8[(n+i)%W8.length]}return e},PM=e=>{const{element:t,transformHandleType:n}=e,i=t&&Math.sign(t.height)*Math.sign(t.width)===-1;let r=null;switch(n){case"n":case"s":r="ns";break;case"w":case"e":r="ew";break;case"nw":case"se":i?r="nesw":r="nwse";break;case"ne":case"sw":i?r="nwse":r="nesw";break;case"rotation":return"grab"}return r&&t&&(r=Xde(r,t.angle)),r?`${r}-resize`:""},_H=([e,t],[n,i],r,s)=>{const o=Q(S(e,t),r,s),a=Q(S(n,t),r,s),l=Q(S(e,i),r,s),c=Q(S(n,i),r,s);return{n:[o,a],e:[a,c],s:[c,l],w:[l,o]}},jde=(e,t)=>{var n;return!!(!e.viewModeEnabled&&((n=e.openDialog)==null?void 0:n.name)!=="elementLinkSelector"&&(e.activeTool.type!=="custom"&&(e.editingTextElement||e.activeTool.type!=="selection"&&e.activeTool.type!=="lasso"&&e.activeTool.type!=="eraser"&&e.activeTool.type!=="hand"&&e.activeTool.type!=="laser")||Xe(t,e).length))},q4=(e,t)=>e.frameId===t||e.id===t,TH=(e,t,n)=>{let i=[],r=[],s=null,o=-1;const a=ve(n||Xe(e,t,{includeBoundTextElement:!0,includeElementsInFrames:!0}));for(;++o<e.length;){const l=e[o];a.get(l.id)?(r.length&&(i=i.concat(r),r=[]),i.push(o),s=o+1):l.isDeleted&&s===o?(s=o+1,r.push(o)):r=[]}return i},Yde=e=>{let t=0;return e.reduce((n,i,r)=>(r>0&&e[r-1]!==i-1&&(t=++t),(n[t]||(n[t]=[])).push(i),n),[])},FM=(e,t,n,i)=>{var r,s;if("containerId"in e&&e.containerId){const o=i.getElement(e.containerId);if(o)return n==="left"?Math.min(t.indexOf(o),t.indexOf(e)):Math.max(t.indexOf(o),t.indexOf(e))}else{const o=(s=(r=e.boundElements)==null?void 0:r.find(a=>a.type!=="arrow"))==null?void 0:s.id;if(o){const a=i.getElement(o);if(a)return n==="left"?Math.min(t.indexOf(a),t.indexOf(e)):Math.max(t.indexOf(a),t.indexOf(e))}}},Wde=(e,t)=>{let n=-1,i=-1;return e.forEach((r,s)=>{q4(r,t)&&(n===-1&&(n=s),i=s)}),n===-1?[]:e.slice(n,i+1)},Kde=(e,t,n,i,r,s)=>{const o=t[n],a=f=>f.isDeleted?!1:r?f.frameId===r:e.editingGroupId?f.groupIds.includes(e.editingGroupId):!0,l=i==="left"?Md(t,f=>a(f),Math.max(0,n-1)):GB(t,f=>a(f),n+1),c=t[l];if(!c)return-1;if(e.editingGroupId){if((o==null?void 0:o.groupIds.join(""))===(c==null?void 0:c.groupIds.join("")))return FM(c,t,i,s)??l;if(!(c!=null&&c.groupIds.includes(e.editingGroupId)))return-1}if(!r&&(c.frameId||we(c))){const f=Wde(t,c.frameId||c.id);return i==="left"?t.indexOf(f[0]):t.indexOf(f[f.length-1])}if(!c.groupIds.length)return FM(c,t,i,s)??l;const d=e.editingGroupId?c.groupIds[c.groupIds.indexOf(e.editingGroupId)-1]:c.groupIds[c.groupIds.length-1],u=At(t,d);return u.length?i==="left"?t.indexOf(u[0]):t.indexOf(u[u.length-1]):l},IH=(e,t)=>t.reduce((n,i)=>{const r=e[i];return n.set(r.id,r),n},new Map),SH=(e,t,n,i)=>{const r=TH(e,t),s=IH(e,r);let o=Yde(r);n==="right"&&(o=o.reverse());const a=new Set(r.filter(l=>we(e[l])).map(l=>e[l].id));return o.forEach((l,c)=>{var w;const d=l[0],u=l[l.length-1],f=n==="left"?d:u,h=l.some(v=>{const I=e[v];return I.frameId&&a.has(I.frameId)})?null:(w=e[f])==null?void 0:w.frameId,m=Kde(t,e,f,n,h,i);if(m===-1||f===m)return;const p=n==="left"?e.slice(0,m):e.slice(0,d),U=e.slice(d,u+1),b=n==="left"?e.slice(m,d):e.slice(u+1,m+1),y=n==="left"?e.slice(u+1):e.slice(m+1);e=n==="left"?[...p,...U,...b,...y]:[...p,...b,...U,...y]}),uo(e,s),e},xH=(e,t,n,i,r)=>{const s=TH(e,t,r),o=IH(e,s),a=[];let l,c;if(n==="left"){if(i)l=GB(e,m=>q4(m,i));else if(t.editingGroupId){const m=At(e,t.editingGroupId);if(!m.length)return e;l=e.indexOf(m[0])}else l=0;c=s[s.length-1]}else{if(i)c=Md(e,m=>q4(m,i));else if(t.editingGroupId){const m=At(e,t.editingGroupId);if(!m.length)return e;c=e.indexOf(m[m.length-1])}else c=e.length-1;l=s[0]}l===-1&&(l=0);for(let m=l;m<c+1;m++)s.includes(m)||a.push(e[m]);const d=Array.from(o.values()),u=e.slice(0,l),f=e.slice(c+1),h=n==="left"?[...u,...d,...a,...f]:[...u,...a,...d,...f];return uo(h,o),h};function CH(e,t,n,i){const r=ve(Xe(e,t,{includeBoundTextElement:!0,includeElementsInFrames:!0})),s={regularElements:[],frameChildren:new Map},o=new Set;for(const c of e)r.has(c.id)&&we(c)&&o.add(c.id);for(const c of e)if(r.has(c.id))if(we(c)||c.frameId&&o.has(c.frameId))s.regularElements.push(c);else if(!c.frameId)s.regularElements.push(c);else{const d=s.frameChildren.get(c.frameId)||[];d.push(c),s.frameChildren.set(c.frameId,d)}let a=e;const l=Array.from(s.frameChildren.entries());for(const[c,d]of l)a=i(e,t,n,c,d);return i(a,t,n,null,s.regularElements)}const Zde=(e,t,n)=>SH(e,t,"left",n),qde=(e,t,n)=>SH(e,t,"right",n),Qde=(e,t)=>CH(e,t,"left",xH),Jde=(e,t)=>CH(e,t,"right",xH),ic=e=>e.reduce((t,n)=>t+n.version,0),AH=e=>{let t=5381;for(const n of Kl(e))t=(t<<5)+t+n.versionNonce;return t>>>0},B9=e=>{let t=5381;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);t=(t<<5)+t+i}return t>>>0},eue=e=>e.filter(t=>!t.isDeleted&&!tl(t)),Yt=e=>e.filter(t=>!t.isDeleted),Q4=e=>!e.isDeleted,z9=e=>Yt(e).map(t=>s9(t.type)?{...t,lastCommittedPoint:null}:t),tue=e=>z9(e),MH=e=>z9(e),kH=e=>z9(e);function RH(e){var t,n,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=RH(e[t]))&&(i&&(i+=" "),i+=n);else for(t in e)e[t]&&(i&&(i+=" "),i+=t);return i}function le(){for(var e=0,t,n,i="";e<arguments.length;)(t=arguments[e++])&&(n=RH(t))&&(i&&(i+=" "),i+=n);return i}let DH=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,n)=>(n&=63,n<36?t+=n.toString(36):n<62?t+=(n-26).toString(36).toUpperCase():n>62?t+="-":t+="_",t),"");const nue=(e,t)=>{const n=e[t];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((i,r)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(r.bind(null,new Error("Unknown variable dynamic import: "+t)))})};var fl={};let iue=0;function Wt(e,t){const n=`atom${++iue}`,i={toString(){return(fl?"production":void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof e=="function"?i.read=e:(i.init=e,i.read=rue,i.write=sue),i}function rue(e){return e(this)}function sue(e,t,n){return t(this,typeof n=="function"?n(e(this)):n)}const BM=(e,t)=>e.unstable_is?e.unstable_is(t):t===e,J4=e=>"init"in e,K8=e=>!!e.write,D6=new WeakMap,ev=e=>{var t;return tv(e)&&!((t=D6.get(e))!=null&&t[1])},oue=(e,t)=>{const n=D6.get(e);if(n)n[1]=!0,n[0].forEach(i=>i(t));else if((fl?"production":void 0)!=="production")throw new Error("[Bug] cancelable promise not found")},aue=e=>{if(D6.has(e))return;const t=[new Set,!1];D6.set(e,t);const n=()=>{t[1]=!0};e.then(n,n),e.onCancel=i=>{t[0].add(i)}},tv=e=>typeof(e==null?void 0:e.then)=="function",zM=e=>"v"in e||"e"in e,jU=e=>{if("e"in e)throw e.e;if((fl?"production":void 0)!=="production"&&!("v"in e))throw new Error("[Bug] atom state is not initialized");return e.v},LH=(e,t,n)=>{n.p.has(e)||(n.p.add(e),t.then(()=>{n.p.delete(e)},()=>{n.p.delete(e)}))},HM=(e,t,n,i,r)=>{var s;if((fl?"production":void 0)!=="production"&&i===t)throw new Error("[Bug] atom cannot depend on itself");n.d.set(i,r.n),ev(n.v)&&LH(t,n.v,r),(s=r.m)==null||s.t.add(t),e&&lue(e,i,t)},p1=()=>({D:new Map,H:new Set,M:new Set,L:new Set}),A0=(e,t,n)=>{e[t].add(n)},VM=(e,t,n)=>{e.D.has(t)||(e.D.set(t,new Set),A0(e,"M",()=>{var i;(i=n.m)==null||i.l.forEach(r=>A0(e,"M",r))}))},lue=(e,t,n)=>{const i=e.D.get(t);i&&i.add(n)},cue=(e,t)=>e.D.get(t),yd=e=>{let t,n=!1;const i=r=>{try{r()}catch(s){n||(t=s,n=!0)}};for(;e.H.size||e.M.size||e.L.size;)e.D.clear(),e.H.forEach(i),e.H.clear(),e.M.forEach(i),e.M.clear(),e.L.forEach(i),e.L.clear();if(n)throw t},NH=(...[e,t,n,i])=>{const r=(b,y,w)=>{const v="v"in y,I=y.v,C=ev(y.v)?y.v:null;if(tv(w)){aue(w);for(const _ of y.d.keys())LH(b,w,e(_));y.v=w}else y.v=w;delete y.e,delete y.x,(!v||!Object.is(I,y.v))&&(++y.n,C&&oue(C,w))},s=(b,y)=>{var w;const v=e(y);if(zM(v)&&(v.m&&!v.x||Array.from(v.d).every(([x,D])=>s(b,x).n===D)))return v;v.d.clear();let I=!0;const C=x=>{if(BM(y,x)){const O=e(x);if(!zM(O))if(J4(x))r(x,O,x.init);else throw new Error("no atom init");return jU(O)}const D=s(b,x);try{return jU(D)}finally{if(I)HM(b,y,v,x,D);else{const O=p1();HM(O,y,v,x,D),u(O,y,v),yd(O)}}};let _,T;const k={get signal(){return _||(_=new AbortController),_.signal},get setSelf(){return(fl?"production":void 0)!=="production"&&!K8(y)&&console.warn("setSelf function cannot be used with read-only atom"),!T&&K8(y)&&(T=(...x)=>{if((fl?"production":void 0)!=="production"&&I&&console.warn("setSelf function cannot be called in sync"),!I)return d(y,...x)}),T}};try{const x=t(y,C,k);if(r(y,v,x),tv(x)){(w=x.onCancel)==null||w.call(x,()=>_==null?void 0:_.abort());const D=()=>{if(v.m){const O=p1();u(O,y,v),yd(O)}};x.then(D,D)}return v}catch(x){return delete v.v,v.e=x,delete v.x,++v.n,v}finally{I=!1}},o=b=>jU(s(void 0,b)),a=(b,y,w)=>{var v,I;const C=new Map;for(const _ of((v=w.m)==null?void 0:v.t)||[]){const T=e(_);T.m&&C.set(_,T)}for(const _ of w.p)C.set(_,e(_));return(I=cue(b,y))==null||I.forEach(_=>{C.set(_,e(_))}),C},l=(b,y,w)=>{const v=[],I=new Set,C=new Set,_=[[y,w]];for(;_.length>0;){const[T,k]=_[_.length-1];if(C.has(T)){_.pop();continue}if(I.has(T)){v.push([T,k,k.n]),C.add(T),k.x=!0,_.pop();continue}I.add(T);for(const[x,D]of a(b,T,k))T!==x&&!I.has(x)&&_.push([x,D])}A0(b,"H",()=>{const T=new Set([y]);for(let k=v.length-1;k>=0;--k){const[x,D,O]=v[k];let L=!1;for(const Y of D.d.keys())if(Y!==x&&T.has(Y)){L=!0;break}L&&(s(b,x),u(b,x,D),O!==D.n&&(VM(b,x,D),T.add(x))),delete D.x}})},c=(b,y,...w)=>{let v=!0;const I=_=>jU(s(b,_)),C=(_,...T)=>{const k=e(_);try{if(BM(y,_)){if(!J4(_))throw new Error("atom not writable");const x=k.n,D=T[0];r(_,k,D),u(b,_,k),x!==k.n&&(VM(b,_,k),l(b,_,k));return}else return c(b,_,...T)}finally{v||yd(b)}};try{return n(y,I,C,...w)}finally{v=!1}},d=(b,...y)=>{const w=p1();try{return c(w,b,...y)}finally{yd(w)}},u=(b,y,w)=>{if(w.m&&!ev(w.v)){for(const v of w.d.keys())w.m.d.has(v)||(f(b,v,e(v)).t.add(y),w.m.d.add(v));for(const v of w.m.d||[])if(!w.d.has(v)){w.m.d.delete(v);const I=h(b,v,e(v));I==null||I.t.delete(y)}}},f=(b,y,w)=>{if(!w.m){s(b,y);for(const v of w.d.keys())f(b,v,e(v)).t.add(y);if(w.m={l:new Set,d:new Set(w.d.keys()),t:new Set},K8(y)){const v=w.m;let I;const C=(_,T)=>{let k=!0;I=(...x)=>{try{return c(_,y,...x)}finally{k||yd(_)}};try{return T()}finally{k=!1}};A0(b,"L",()=>{const _=C(b,()=>i(y,(...T)=>I(...T)));_&&(v.u=T=>C(T,_))})}}return w.m},h=(b,y,w)=>{if(w.m&&!w.m.l.size&&!Array.from(w.m.t).some(v=>{var I;return(I=e(v).m)==null?void 0:I.d.has(y)})){const v=w.m.u;v&&A0(b,"L",()=>v(b)),delete w.m;for(const I of w.d.keys()){const C=h(b,I,e(I));C==null||C.t.delete(y)}return}return w.m};return{get:o,set:d,sub:(b,y)=>{const w=p1(),v=e(b),C=f(w,b,v).l;return C.add(y),yd(w),()=>{C.delete(y);const _=p1();h(_,b,v),yd(_)}},unstable_derive:b=>NH(...b(e,t,n,i))}},due=e=>{const t=new WeakMap,n=new Set;let i,r=0;const s=e.unstable_derive((l,c,d,u)=>(i=l,[f=>{let h=t.get(f);if(!h){const m=l(f);h=new Proxy(m,{set(p,U,b){return U==="m"&&n.add(f),Reflect.set(p,U,b)},deleteProperty(p,U){return U==="m"&&n.delete(f),Reflect.deleteProperty(p,U)}}),t.set(f,h)}return h},c,(f,h,m,...p)=>r?m(f,...p):d(f,h,m,...p),u])),o=s.set;return Object.assign(s,{dev4_get_internal_weak_map:()=>({get:l=>{const c=i(l);if(c.n!==0)return c}}),dev4_get_mounted_atoms:()=>n,dev4_restore_atoms:l=>{o({read:()=>null,write:(d,u)=>{++r;try{for(const[f,h]of l)J4(f)&&u(f,h)}finally{--r}}})}})},Dp=()=>{const e=new WeakMap,n=NH(i=>{if((fl?"production":void 0)!=="production"&&!i)throw new Error("Atom is undefined or null");let r=e.get(i);return r||(r={d:new Map,p:new Set,n:0},e.set(i,r)),r},(i,...r)=>i.read(...r),(i,...r)=>i.write(...r),(i,...r)=>{var s;return(s=i.onMount)==null?void 0:s.call(i,...r)});return(fl?"production":void 0)!=="production"?due(n):n};let U1;const uue=()=>(U1||(U1=Dp(),(fl?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=U1),globalThis.__JOTAI_DEFAULT_STORE__!==U1&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),U1);var OH={};const PH=R.createContext(void 0),my=e=>{const t=R.useContext(PH);return(e==null?void 0:e.store)||t||uue()},fue=({children:e,store:t})=>{const n=R.useRef(void 0);return!t&&!n.current&&(n.current=Dp()),R.createElement(PH.Provider,{value:t||n.current},e)},nv=e=>typeof(e==null?void 0:e.then)=="function",FH=e=>{e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t})},hue=de.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(FH(e),e)}),Z8=new WeakMap,$M=e=>{let t=Z8.get(e);return t||(t=new Promise((n,i)=>{let r=e;const s=l=>c=>{r===l&&n(c)},o=l=>c=>{r===l&&i(c)},a=l=>{"onCancel"in l&&typeof l.onCancel=="function"&&l.onCancel(c=>{if((OH?"production":void 0)!=="production"&&c===l)throw new Error("[Bug] p is not updated even after cancelation");nv(c)?(Z8.set(c,t),r=c,c.then(s(c),o(c)),a(c)):n(c)})};e.then(s(e),o(e)),a(e)}),Z8.set(e,t)),t};function ph(e,t){const n=my(t),[[i,r,s],o]=R.useReducer(c=>{const d=n.get(e);return Object.is(c[0],d)&&c[1]===n&&c[2]===e?c:[d,n,e]},void 0,()=>[n.get(e),n,e]);let a=i;(r!==n||s!==e)&&(o(),a=n.get(e));const l=t==null?void 0:t.delay;if(R.useEffect(()=>{const c=n.sub(e,()=>{if(typeof l=="number"){const d=n.get(e);nv(d)&&FH($M(d)),setTimeout(o,l);return}o()});return o(),c},[n,e,l]),R.useDebugValue(a),nv(a)){const c=$M(a);return hue(c)}return a}function H9(e,t){const n=my(t);return R.useCallback((...r)=>{if((OH?"production":void 0)!=="production"&&!("write"in e))throw new Error("not writable atom");return n.set(e,...r)},[n,e])}function Wh(e,t){return[ph(e,t),H9(e,t)]}const GM=new WeakMap;function gue(e,t){const n=my(t),i=mue(n);for(const[r,s]of e)(!i.has(r)||t!=null&&t.dangerouslyForceHydrate)&&(i.add(r),n.set(r,s))}const mue=e=>{let t=GM.get(e);return t||(t=new WeakSet,GM.set(e,t)),t};function qf(){return qf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},qf.apply(this,arguments)}function BH(){const e=R.createContext(null);function t({store:o,initialValues:a=[],children:l}){const c=R.useRef(o);return c.current||(c.current=Dp()),gue(a,{store:c.current}),g(e.Provider,{value:c.current,children:l})}const n=o=>{const a=R.useContext(e);if(!a)throw new Error("Missing Provider from createIsolation");return my(qf({store:a},o))};return{Provider:t,useStore:n,useAtom:(o,a)=>{const l=n();return Wh(o,qf({store:l},a))},useAtomValue:(o,a)=>{const l=n();return ph(o,qf({store:l},a))},useSetAtom:(o,a)=>{const l=n();return H9(o,qf({store:l},a))}}}const{read:AAe,write:MAe}=Wt(null);R.createContext({scope:void 0,baseStore:void 0});const zH=BH(),{useAtom:un,useSetAtom:py,useAtomValue:HH,useStore:kAe}=zH,pue=zH.Provider,Gr=Dp(),VH={paste:"Paste",pasteAsPlaintext:"Paste as plaintext",pasteCharts:"Paste charts",selectAll:"Select all",multiSelect:"Add element to selection",moveCanvas:"Move canvas",cut:"Cut",copy:"Copy",copyAsPng:"Copy to clipboard as PNG",copyAsSvg:"Copy to clipboard as SVG",copyText:"Copy to clipboard as text",copySource:"Copy source to clipboard",convertToCode:"Convert to code",bringForward:"Bring forward",sendToBack:"Send to back",bringToFront:"Bring to front",sendBackward:"Send backward",delete:"Delete",copyStyles:"Copy styles",pasteStyles:"Paste styles",stroke:"Stroke",changeStroke:"Change stroke color",background:"Background",changeBackground:"Change background color",fill:"Fill",strokeWidth:"Stroke width",strokeStyle:"Stroke style",strokeStyle_solid:"Solid",strokeStyle_dashed:"Dashed",strokeStyle_dotted:"Dotted",sloppiness:"Sloppiness",opacity:"Opacity",textAlign:"Text align",edges:"Edges",sharp:"Sharp",round:"Round",arrowheads:"Arrowheads",arrowhead_none:"None",arrowhead_arrow:"Arrow",arrowhead_bar:"Bar",arrowhead_circle:"Circle",arrowhead_circle_outline:"Circle (outline)",arrowhead_triangle:"Triangle",arrowhead_triangle_outline:"Triangle (outline)",arrowhead_diamond:"Diamond",arrowhead_diamond_outline:"Diamond (outline)",arrowhead_crowfoot_many:"Crow's foot (many)",arrowhead_crowfoot_one:"Crow's foot (one)",arrowhead_crowfoot_one_or_many:"Crow's foot (one or many)",more_options:"More options",arrowtypes:"Arrow type",arrowtype_sharp:"Sharp arrow",arrowtype_round:"Curved arrow",arrowtype_elbowed:"Elbow arrow",fontSize:"Font size",fontFamily:"Font family",addWatermark:'Add "Made with Excalidraw"',handDrawn:"Hand-drawn",normal:"Normal",code:"Code",small:"Small",medium:"Medium",large:"Large",veryLarge:"Very large",solid:"Solid",hachure:"Hachure",zigzag:"Zigzag",crossHatch:"Cross-hatch",thin:"Thin",bold:"Bold",left:"Left",center:"Center",right:"Right",extraBold:"Extra bold",architect:"Architect",artist:"Artist",cartoonist:"Cartoonist",fileTitle:"File name",colorPicker:"Color picker",canvasColors:"Used on canvas",canvasBackground:"Canvas background",drawingCanvas:"Drawing canvas",clearCanvas:"Clear canvas",layers:"Layers",actions:"Actions",language:"Language",liveCollaboration:"Live collaboration...",duplicateSelection:"Duplicate",untitled:"Untitled",name:"Name",yourName:"Your name",madeWithExcalidraw:"Made with Excalidraw",group:"Group selection",ungroup:"Ungroup selection",collaborators:"Collaborators",toggleGrid:"Toggle grid",addToLibrary:"Add to library",removeFromLibrary:"Remove from library",libraryLoadingMessage:"Loading library",libraries:"Browse libraries",loadingScene:"Loading scene",loadScene:"Load scene from file",align:"Align",alignTop:"Align top",alignBottom:"Align bottom",alignLeft:"Align left",alignRight:"Align right",centerVertically:"Center vertically",centerHorizontally:"Center horizontally",distributeHorizontally:"Distribute horizontally",distributeVertically:"Distribute vertically",flipHorizontal:"Flip horizontal",flipVertical:"Flip vertical",viewMode:"View mode",share:"Share",showStroke:"Show stroke color picker",showBackground:"Show background color picker",showFonts:"Show font picker",toggleTheme:"Toggle light/dark theme",theme:"Theme",personalLib:"Personal Library",excalidrawLib:"Excalidraw Library",decreaseFontSize:"Decrease font size",increaseFontSize:"Increase font size",unbindText:"Unbind text",bindText:"Bind text to the container",createContainerFromText:"Wrap text in a container",link:{edit:"Edit link",editEmbed:"Edit embeddable link",create:"Add link",label:"Link",labelEmbed:"Link & embed",empty:"No link is set",hint:"Type or paste your link here",goToElement:"Go to target element"},lineEditor:{edit:"Edit line",editArrow:"Edit arrow"},polygon:{breakPolygon:"Break polygon",convertToPolygon:"Convert to polygon"},elementLock:{lock:"Lock",unlock:"Unlock",lockAll:"Lock all",unlockAll:"Unlock all"},statusPublished:"Published",sidebarLock:"Keep sidebar open",selectAllElementsInFrame:"Select all elements in frame",removeAllElementsFromFrame:"Remove all elements from frame",eyeDropper:"Pick color from canvas",textToDiagram:"Text to diagram",prompt:"Prompt",followUs:"Follow us",discordChat:"Discord chat",zoomToFitViewport:"Zoom to fit in viewport",zoomToFitSelection:"Zoom to fit selection",zoomToFit:"Zoom to fit all elements",installPWA:"Install Excalidraw locally (PWA)",autoResize:"Enable text auto-resizing",imageCropping:"Image cropping",unCroppedDimension:"Uncropped dimension",copyElementLink:"Copy link to object",linkToElement:"Link to object",wrapSelectionInFrame:"Wrap selection in frame",tab:"Tab",shapeSwitch:"Switch shape"},$H={title:"Link to object",desc:"Click on a shape on canvas or paste a link.",notFound:"Linked object wasn't found on canvas."},GH={noItems:"No items added yet...",hint_emptyLibrary:"Select an item on canvas to add it here, or install a library from the public repository, below.",hint_emptyPrivateLibrary:"Select an item on canvas to add it here.",search:{inputPlaceholder:"Search library",heading:"Library matches",noResults:"No matching items found...",clearSearch:"Clear search"}},XH={title:"Find on canvas",noMatch:"No matches found...",singleResult:"result",multipleResults:"results",placeholder:"Find text on canvas...",frames:"Frames",texts:"Texts"},jH={clearReset:"Reset the canvas",exportJSON:"Export to file",exportImage:"Export image...",export:"Save to...",copyToClipboard:"Copy to clipboard",copyLink:"Copy link",save:"Save to current file",saveAs:"Save as",load:"Open",getShareableLink:"Get shareable link",close:"Close",selectLanguage:"Select language",scrollBackToContent:"Scroll back to content",zoomIn:"Zoom in",zoomOut:"Zoom out",resetZoom:"Reset zoom",menu:"Menu",done:"Done",edit:"Edit",undo:"Undo",redo:"Redo",resetLibrary:"Reset library",createNewRoom:"Create new room",fullScreen:"Full screen",darkMode:"Dark mode",lightMode:"Light mode",systemMode:"System mode",zenMode:"Zen mode",objectsSnapMode:"Snap to objects",exitZenMode:"Exit zen mode",cancel:"Cancel",saveLibNames:"Save name(s) and exit",clear:"Clear",remove:"Remove",embed:"Toggle embedding",publishLibrary:"Rename or publish",submit:"Submit",confirm:"Confirm",embeddableInteractionButton:"Click to interact"},YH={clearReset:"This will clear the whole canvas. Are you sure?",couldNotCreateShareableLink:"Couldn't create shareable link.",couldNotCreateShareableLinkTooBig:"Couldn't create shareable link: the scene is too big",couldNotLoadInvalidFile:"Couldn't load invalid file",importBackendFailed:"Importing from backend failed.",cannotExportEmptyCanvas:"Cannot export empty canvas.",couldNotCopyToClipboard:"Couldn't copy to clipboard.",decryptFailed:"Couldn't decrypt data.",uploadedSecurly:"The upload has been secured with end-to-end encryption, which means that Excalidraw server and third parties can't read the content.",loadSceneOverridePrompt:"Loading external drawing will replace your existing content. Do you wish to continue?",collabStopOverridePrompt:`Stopping the session will overwrite your previous, locally stored drawing. Are you sure?

(If you want to keep your local drawing, simply close the browser tab instead.)`,errorAddingToLibrary:"Couldn't add item to the library",errorRemovingFromLibrary:"Couldn't remove item from the library",confirmAddLibrary:"This will add {{numShapes}} shape(s) to your library. Are you sure?",imageDoesNotContainScene:"This image does not seem to contain any scene data. Have you enabled scene embedding during export?",cannotRestoreFromImage:"Scene couldn't be restored from this image file",invalidSceneUrl:"Couldn't import scene from the supplied URL. It's either malformed, or doesn't contain valid Excalidraw JSON data.",resetLibrary:"This will clear your library. Are you sure?",removeItemsFromsLibrary:"Delete {{count}} item(s) from library?",invalidEncryptionKey:"Encryption key must be of 22 characters. Live collaboration is disabled.",collabOfflineWarning:`No internet connection available.
Your changes will not be saved!`,localStorageQuotaExceeded:"Browser storage quota exceeded. Changes will not be saved."},WH={unsupportedFileType:"Unsupported file type.",imageInsertError:"Couldn't insert image. Try again later...",fileTooBig:"File is too big. Maximum allowed size is {{maxSize}}.",svgImageInsertError:"Couldn't insert SVG image. The SVG markup looks invalid.",failedToFetchImage:"Failed to fetch image.",cannotResolveCollabServer:"Couldn't connect to the collab server. Please reload the page and try again.",importLibraryError:"Couldn't load library",saveLibraryError:"Couldn't save library to storage. Please save your library to a file locally to make sure you don't lose changes.",collabSaveFailed:"Couldn't save to the backend database. If problems persist, you should save your file locally to ensure you don't lose your work.",collabSaveFailed_sizeExceeded:"Couldn't save to the backend database, the canvas seems to be too big. You should save the file locally to ensure you don't lose your work.",imageToolNotSupported:"Images are disabled.",brave_measure_text_error:{line1:"Looks like you are using Brave browser with the <bold>Aggressively Block Fingerprinting</bold> setting enabled.",line2:"This could result in breaking the <bold>Text Elements</bold> in your drawings.",line3:"We strongly recommend disabling this setting. You can follow <link>these steps</link> on how to do so.",line4:"If disabling this setting doesn't fix the display of text elements, please open an <issueLink>issue</issueLink> on our GitHub, or write us on <discordLink>Discord</discordLink>"},libraryElementTypeError:{embeddable:"Embeddable elements cannot be added to the library.",iframe:"IFrame elements cannot be added to the library.",image:"Support for adding images to the library coming soon!"},asyncPasteFailedOnRead:"Couldn't paste (couldn't read from system clipboard).",asyncPasteFailedOnParse:"Couldn't paste.",copyToSystemClipboardFailed:"Couldn't copy to clipboard."},KH={selection:"Selection",lasso:"Lasso selection",image:"Insert image",rectangle:"Rectangle",diamond:"Diamond",ellipse:"Ellipse",arrow:"Arrow",line:"Line",freedraw:"Draw",text:"Text",library:"Library",lock:"Keep selected tool active after drawing",penMode:"Pen mode - prevent touch",link:"Add / Update link for a selected shape",eraser:"Eraser",frame:"Frame tool",magicframe:"Wireframe to code",embeddable:"Web Embed",laser:"Laser pointer",hand:"Hand (panning tool)",extraTools:"More tools",mermaidToExcalidraw:"Mermaid to Excalidraw",convertElementType:"Toggle shape type"},ZH={rectangle:"Rectangle",diamond:"Diamond",ellipse:"Ellipse",arrow:"Arrow",line:"Line",freedraw:"Freedraw",text:"Text",image:"Image",group:"Group",frame:"Frame",magicframe:"Wireframe to code",embeddable:"Web Embed",selection:"Selection",iframe:"IFrame"},qH={canvasActions:"Canvas actions",selectedShapeActions:"Selected shape actions",shapes:"Shapes"},QH={dismissSearch:"{{shortcut}} to dismiss search",canvasPanning:"To move canvas, hold {{shortcut_1}} or {{shortcut_2}} while dragging, or use the hand tool",linearElement:"Click to start multiple points, drag for single line",arrowTool:"Click to start multiple points, drag for single line. Press {{shortcut}} again to change arrow type.",freeDraw:"Click and drag, release when you're finished",text:"Tip: you can also add text by double-clicking anywhere with the selection tool",embeddable:"Click-drag to create a website embed",text_selected:"Double-click or press {{shortcut}} to edit text",text_editing:"Press {{shortcut_1}} or {{shortcut_2}} to finish editing",linearElementMulti:"Click on last point or press {{shortcut_1}} or {{shortcut_2}} to finish",lockAngle:"You can constrain angle by holding {{shortcut}}",resize:`You can constrain proportions by holding {{shortcut_1}} while resizing,
hold {{shortcut_2}} to resize from the center`,resizeImage:`You can resize freely by holding {{shortcut_1}},
hold {{shortcut_2}} to resize from the center`,rotate:"You can constrain angles by holding {{shortcut}} while rotating",lineEditor_info:"Hold {{shortcut_1}} and Double-click or press {{shortcut_2}} to edit points",lineEditor_line_info:"Double-click or press {{shortcut}} to edit points",lineEditor_pointSelected:`Press {{shortcut_1}} to remove point(s),
{{shortcut_2}} to duplicate, or drag to move`,lineEditor_nothingSelected:`Select a point to edit (hold {{shortcut_1}} to select multiple),
or hold {{shortcut_2}} and click to add new points`,publishLibrary:"Publish your own library",bindTextToElement:"{{shortcut}} to add text",createFlowchart:"{{shortcut}} to create a flowchart",deepBoxSelect:"Hold {{shortcut}} to deep select, and to prevent dragging",eraserRevert:"Hold {{shortcut}} to revert the elements marked for deletion",firefox_clipboard_write:'This feature can likely be enabled by setting the "dom.events.asyncClipboard.clipboardItem" flag to "true". To change the browser flags in Firefox, visit the "about:config" page.',disableSnapping:"Hold {{shortcut}} to disable snapping",enterCropEditor:"Double click the image or press {{shortcut}} to crop the image",leaveCropEditor:"Click outside the image or press {{shortcut_1}} or {{shortcut_2}} to finish cropping"},JH={cannotShowPreview:"Cannot show preview",canvasTooBig:"The canvas may be too big.",canvasTooBigTip:"Tip: try moving the farthest elements a bit closer together."},eV={headingMain:"Encountered an error. Try <button>reloading the page</button>.",clearCanvasMessage:"If reloading doesn't work, try <button>clearing the canvas</button>.",clearCanvasCaveat:" This will result in loss of work ",trackedToSentry:"The error with identifier {{eventId}} was tracked on our system.",openIssueMessage:"We were very cautious not to include your scene information on the error. If your scene is not private, please consider following up on our <button>bug tracker</button>. Please include information below by copying and pasting into the GitHub issue.",sceneContent:"Scene content:"},tV={or:"Or"},nV={desc_intro:"Invite people to collaborate on your drawing.",desc_privacy:"Don't worry, the session is end-to-end encrypted, and fully private. Not even our server can see what you draw.",button_startSession:"Start session",button_stopSession:"Stop session",desc_inProgressIntro:"Live-collaboration session is now in progress.",desc_shareLink:"Share this link with anyone you want to collaborate with:",desc_exitSession:"Stopping the session will disconnect you from the room, but you'll be able to continue working with the scene, locally. Note that this won't affect other people, and they'll still be able to collaborate on their version.",shareTitle:"Join a live collaboration session on Excalidraw"},iV={title:"Error"},rV={disk_title:"Save to disk",disk_details:"Export the scene data to a file from which you can import later.",disk_button:"Save to file",link_title:"Shareable link",link_details:"Export as a read-only link.",link_button:"Export to Link",excalidrawplus_description:"Save the scene to your Excalidraw+ workspace.",excalidrawplus_button:"Export",excalidrawplus_exportError:"Couldn't export to Excalidraw+ at this moment..."},sV={blog:"Read our blog",click:"click",deepSelect:"Deep select",deepBoxSelect:"Deep select within box, and prevent dragging",createFlowchart:"Create a flowchart from a generic element",navigateFlowchart:"Navigate a flowchart",curvedArrow:"Curved arrow",curvedLine:"Curved line",documentation:"Documentation",doubleClick:"double-click",drag:"drag",editor:"Editor",editLineArrowPoints:"Edit line/arrow points",editText:"Edit text / add label",github:"Found an issue? Submit",howto:"Follow our guides",or:"or",preventBinding:"Prevent arrow binding",tools:"Tools",shortcuts:"Keyboard shortcuts",textFinish:"Finish editing (text editor)",textNewLine:"Add new line (text editor)",title:"Help",view:"View",zoomToFit:"Zoom to fit all elements",zoomToSelection:"Zoom to selection",toggleElementLock:"Lock/unlock selection",movePageUpDown:"Move page up/down",movePageLeftRight:"Move page left/right",cropStart:"Crop image",cropFinish:"Finish image cropping"},oV={title:"Clear canvas"},aV={title:"Publish library",itemName:"Item name",authorName:"Author name",githubUsername:"GitHub username",twitterUsername:"Twitter username",libraryName:"Library name",libraryDesc:"Library description",website:"Website",placeholder:{authorName:"Your name or username",libraryName:"Name of your library",libraryDesc:"Description of your library to help people understand its usage",githubHandle:"GitHub handle (optional), so you can edit the library once submitted for review",twitterHandle:"Twitter username (optional), so we know who to credit when promoting over Twitter",website:"Link to your personal website or elsewhere (optional)"},errors:{required:"Required",website:"Enter a valid URL"},noteDescription:"Submit your library to be included in the <link>public library repository</link> for other people to use in their drawings.",noteGuidelines:"The library needs to be manually approved first. Please read the <link>guidelines</link> before submitting. You will need a GitHub account to communicate and make changes if requested, but it is not strictly required.",noteLicense:"By submitting, you agree the library will be published under the <link>MIT License</link>, which in short means anyone can use them without restrictions.",noteItems:"Each library item must have its own name so it's filterable. The following library items will be included:",atleastOneLibItem:"Please select at least one library item to get started",republishWarning:"Note: some of the selected items are marked as already published/submitted. You should only resubmit items when updating an existing library or submission."},lV={title:"Library submitted",content:"Thank you {{authorName}}. Your library has been submitted for review. You can track the status <link>here</link>"},cV={resetLibrary:"Reset library",removeItemsFromLib:"Remove selected items from library"},dV={header:"Export image",label:{withBackground:"Background",onlySelected:"Only selected",darkMode:"Dark mode",embedScene:"Embed scene",scale:"Scale",padding:"Padding"},tooltip:{embedScene:`Scene data will be saved into the exported PNG/SVG file so that the scene can be restored from it.
Will increase exported file size.`},title:{exportToPng:"Export to PNG",exportToSvg:"Export to SVG",copyPngToClipboard:"Copy PNG to clipboard"},button:{exportToPng:"PNG",exportToSvg:"SVG",copyPngToClipboard:"Copy to clipboard"}},uV={tooltip:"Your drawings are end-to-end encrypted so Excalidraw's servers will never see them.",link:"Blog post on end-to-end encryption in Excalidraw"},fV={angle:"Angle",shapes:"Shapes",height:"Height",scene:"Scene",selected:"Selected",storage:"Storage",fullTitle:"Canvas & Shape properties",title:"Properties",generalStats:"General",elementProperties:"Shape properties",total:"Total",version:"Version",versionCopy:"Click to copy",versionNotAvailable:"Version not available",width:"Width"},hV={addedToLibrary:"Added to library",copyStyles:"Copied styles.",copyToClipboard:"Copied to clipboard.",copyToClipboardAsPng:`Copied {{exportSelection}} to clipboard as PNG
({{exportColorScheme}})`,copyToClipboardAsSvg:`Copied {{exportSelection}} to clipboard as SVG
({{exportColorScheme}})`,fileSaved:"File saved.",fileSavedToFilename:"Saved to {filename}",canvas:"canvas",selection:"selection",pasteAsSingleElement:`Use {{shortcut}} to paste as a single element,
or paste into an existing text editor`,unableToEmbed:"Embedding this url is currently not allowed. Raise an issue on GitHub to request the url whitelisted",unrecognizedLinkFormat:"The link you embedded does not match the expected format. Please try to paste the 'embed' string provided by the source site",elementLinkCopied:"Link copied to clipboard"},gV={transparent:"Transparent",black:"Black",white:"White",red:"Red",pink:"Pink",grape:"Grape",violet:"Violet",gray:"Gray",blue:"Blue",cyan:"Cyan",teal:"Teal",green:"Green",yellow:"Yellow",orange:"Orange",bronze:"Bronze"},mV={app:{center_heading:"All your data is saved locally in your browser.",center_heading_plus:"Did you want to go to the Excalidraw+ instead?",menuHint:"Export, preferences, languages, ..."},defaults:{menuHint:"Export, preferences, and more...",center_heading:"Diagrams. Made. Simple.",toolbarHint:"Pick a tool & Start drawing!",helpHint:"Shortcuts & help"}},pV={color:"Color",mostUsedCustomColors:"Most used custom colors",colors:"Colors",shades:"Shades",hexCode:"Hex code",noShades:"No shades available for this color"},UV={action:{exportToImage:{title:"Export as image",button:"Export as image",description:"Export the scene data as an image from which you can import later."},saveToDisk:{title:"Save to disk",button:"Save to disk",description:"Export the scene data to a file from which you can import later."},excalidrawPlus:{title:"Excalidraw+",button:"Export to Excalidraw+",description:"Save the scene to your Excalidraw+ workspace."}},modal:{loadFromFile:{title:"Load from file",button:"Load from file",description:"Loading from a file will <bold>replace your existing content</bold>.<br></br>You can back up your drawing first using one of the options below."},shareableLink:{title:"Load from link",button:"Replace my content",description:"Loading external drawing will <bold>replace your existing content</bold>.<br></br>You can back up your drawing first by using one of the options below."}}},bV={title:"Mermaid to Excalidraw",button:"Insert",description:"Currently only <flowchartLink>Flowchart</flowchartLink>,<sequenceLink> Sequence, </sequenceLink> and <classLink>Class </classLink>Diagrams are supported. The other types will be rendered as image in Excalidraw.",syntax:"Mermaid Syntax",preview:"Preview"},yV={placeholder:"Quick search"},EV={badge:{old:"old"},sceneFonts:"In this scene",availableFonts:"Available fonts",empty:"No fonts found"},vV={empty:"No users found",hint:{text:"Click on user to follow",followStatus:"You're currently following this user",inCall:"User is in a voice call",micMuted:"User's microphone is muted",isSpeaking:"User is speaking"}},wV={title:"Command palette",shortcuts:{select:"Select",confirm:"Confirm",close:"Close"},recents:"Recently used",search:{placeholder:"Search menus, commands, and discover hidden gems",noMatch:"No matching commands..."},itemNotAvailable:"Command is not available...",shortcutHint:"For Command palette, use {{shortcut}}"},_V={ctrl:"Ctrl",option:"Option",cmd:"Cmd",alt:"Alt",escape:"Esc",enter:"Enter",shift:"Shift",spacebar:"Space",delete:"Delete",mmb:"Scroll wheel"},V9={labels:VH,elementLink:$H,library:GH,search:XH,buttons:jH,alerts:YH,errors:WH,toolBar:KH,element:ZH,headings:qH,hints:QH,canvasError:JH,errorSplash:eV,shareDialog:tV,roomDialog:nV,errorDialog:iV,exportDialog:rV,helpDialog:sV,clearCanvasDialog:oV,publishDialog:aV,publishSuccessDialog:lV,confirmDialog:cV,imageExportDialog:dV,encrypted:uV,stats:fV,toast:hV,colors:gV,welcomeScreen:mV,colorPicker:pV,overwriteConfirm:UV,mermaid:bV,quickSearch:yV,fontList:EV,userList:vV,commandPalette:wV,keys:_V},Uue=Object.freeze(Object.defineProperty({__proto__:null,alerts:YH,buttons:jH,canvasError:JH,clearCanvasDialog:oV,colorPicker:pV,colors:gV,commandPalette:wV,confirmDialog:cV,default:V9,element:ZH,elementLink:$H,encrypted:uV,errorDialog:iV,errorSplash:eV,errors:WH,exportDialog:rV,fontList:EV,headings:qH,helpDialog:sV,hints:QH,imageExportDialog:dV,keys:_V,labels:VH,library:GH,mermaid:bV,overwriteConfirm:UV,publishDialog:aV,publishSuccessDialog:lV,quickSearch:yV,roomDialog:nV,search:XH,shareDialog:tV,stats:fV,toast:hV,toolBar:KH,userList:vV,welcomeScreen:mV},Symbol.toStringTag,{value:"Module"})),TV=100,IV=23,SV={"ar-SA":91,"az-AZ":27,"bg-BG":70,"bn-BD":42,"bn-IN":42,"ca-ES":91,"cs-CZ":82,"da-DK":31,"de-CH":91,"de-DE":91,"el-GR":86,en:TV,"es-ES":91,"eu-ES":78,"fa-IR":91,"fi-FI":67,"fr-FR":99,"gl-ES":67,"he-IL":91,"hi-IN":91,"hu-HU":53,"id-ID":90,"it-IT":91,"ja-JP":82,kaa:IV,"kab-KAB":60,"kk-KZ":14,"km-KH":60,"ko-KR":81,"ku-TR":64,"lt-LT":37,"lv-LV":57,"mr-IN":91,"my-MM":27,"nb-NO":91,"nl-NL":59,"nn-NO":48,"oc-FR":75,"pa-IN":58,"pl-PL":100,"pt-BR":90,"pt-PT":91,"ro-RO":100,"ru-RU":91,"si-LK":75,"sk-SK":91,"sl-SI":91,"sv-SE":91,"ta-IN":86,"th-TH":63,"tr-TR":94,"uk-UA":90,"uz-UZ":0,"vi-VN":75,"zh-CN":100,"zh-HK":17,"zh-TW":91},bue=Object.freeze(Object.defineProperty({__proto__:null,default:SV,en:TV,kaa:IV},Symbol.toStringTag,{value:"Module"})),yue=85,Xu={code:"en",label:"English"},Uy=[Xu,...[{code:"ar-SA",label:"",rtl:!0},{code:"bg-BG",label:""},{code:"ca-ES",label:"Catal"},{code:"cs-CZ",label:"esky"},{code:"de-DE",label:"Deutsch"},{code:"el-GR",label:""},{code:"es-ES",label:"Espaol"},{code:"eu-ES",label:"Euskara"},{code:"fa-IR",label:"",rtl:!0},{code:"fi-FI",label:"Suomi"},{code:"fr-FR",label:"Franais"},{code:"gl-ES",label:"Galego"},{code:"he-IL",label:"",rtl:!0},{code:"hi-IN",label:""},{code:"hu-HU",label:"Magyar"},{code:"id-ID",label:"Bahasa Indonesia"},{code:"it-IT",label:"Italiano"},{code:"ja-JP",label:""},{code:"kab-KAB",label:"Taqbaylit"},{code:"kk-KZ",label:" "},{code:"ko-KR",label:""},{code:"ku-TR",label:"Kurd"},{code:"lt-LT",label:"Lietuvi"},{code:"lv-LV",label:"Latvieu"},{code:"my-MM",label:"Burmese"},{code:"nb-NO",label:"Norsk bokml"},{code:"nl-NL",label:"Nederlands"},{code:"nn-NO",label:"Norsk nynorsk"},{code:"oc-FR",label:"Occitan"},{code:"pa-IN",label:""},{code:"pl-PL",label:"Polski"},{code:"pt-BR",label:"Portugus Brasileiro"},{code:"pt-PT",label:"Portugus"},{code:"ro-RO",label:"Romn"},{code:"ru-RU",label:""},{code:"sk-SK",label:"Slovenina"},{code:"sv-SE",label:"Svenska"},{code:"sl-SI",label:"Slovenina"},{code:"tr-TR",label:"Trke"},{code:"uk-UA",label:""},{code:"zh-CN",label:""},{code:"zh-TW",label:""},{code:"vi-VN",label:"Ting Vit"},{code:"mr-IN",label:""}].filter(e=>SV[e.code]>=yue).sort((e,t)=>e.label>t.label?1:-1)],xV="__test__";let Qf=Xu,X2={};const CV=async e=>{if(Qf=e,document.documentElement.dir=Qf.rtl?"rtl":"ltr",document.documentElement.lang=Qf.code,e.code.startsWith(xV))X2={};else try{X2=await nue(Object.assign({"./locales/ar-SA.json":()=>ye(()=>import("./locales/ar-SA.json-Bs6R135r.js"),__vite__mapDeps([])),"./locales/az-AZ.json":()=>ye(()=>import("./locales/az-AZ.json-BYSpKLDC.js"),__vite__mapDeps([])),"./locales/bg-BG.json":()=>ye(()=>import("./locales/bg-BG.json-CXXy5net.js"),__vite__mapDeps([])),"./locales/bn-BD.json":()=>ye(()=>import("./locales/bn-BD.json-oWHQ_B04.js"),__vite__mapDeps([])),"./locales/bn-IN.json":()=>ye(()=>import("./locales/bn-IN.json-CKE9Q-wh.js"),__vite__mapDeps([])),"./locales/ca-ES.json":()=>ye(()=>import("./locales/ca-ES.json-9we--f2Z.js"),__vite__mapDeps([])),"./locales/cs-CZ.json":()=>ye(()=>import("./locales/cs-CZ.json-C7LNS4Fx.js"),__vite__mapDeps([])),"./locales/da-DK.json":()=>ye(()=>import("./locales/da-DK.json-BQL7-425.js"),__vite__mapDeps([])),"./locales/de-CH.json":()=>ye(()=>import("./locales/de-CH.json-Dnl6nIBW.js"),__vite__mapDeps([])),"./locales/de-DE.json":()=>ye(()=>import("./locales/de-DE.json-Dnl6nIBW.js"),__vite__mapDeps([])),"./locales/el-GR.json":()=>ye(()=>import("./locales/el-GR.json-Ckfl66pD.js"),__vite__mapDeps([])),"./locales/en.json":()=>ye(()=>Promise.resolve().then(()=>Uue),void 0),"./locales/es-ES.json":()=>ye(()=>import("./locales/es-ES.json-CUcsdQDl.js"),__vite__mapDeps([])),"./locales/eu-ES.json":()=>ye(()=>import("./locales/eu-ES.json-CSNkgXhr.js"),__vite__mapDeps([])),"./locales/fa-IR.json":()=>ye(()=>import("./locales/fa-IR.json-FFpaP7Q2.js"),__vite__mapDeps([])),"./locales/fi-FI.json":()=>ye(()=>import("./locales/fi-FI.json-B4yqNlKo.js"),__vite__mapDeps([])),"./locales/fr-FR.json":()=>ye(()=>import("./locales/fr-FR.json-DfQ4eYl8.js"),__vite__mapDeps([])),"./locales/gl-ES.json":()=>ye(()=>import("./locales/gl-ES.json-DFMZpFiO.js"),__vite__mapDeps([])),"./locales/he-IL.json":()=>ye(()=>import("./locales/he-IL.json-CFt8az2F.js"),__vite__mapDeps([])),"./locales/hi-IN.json":()=>ye(()=>import("./locales/hi-IN.json-BtmIz8fq.js"),__vite__mapDeps([])),"./locales/hu-HU.json":()=>ye(()=>import("./locales/hu-HU.json-Bb-nig7n.js"),__vite__mapDeps([])),"./locales/id-ID.json":()=>ye(()=>import("./locales/id-ID.json-DyVtaCAr.js"),__vite__mapDeps([])),"./locales/it-IT.json":()=>ye(()=>import("./locales/it-IT.json-C0H77bAN.js"),__vite__mapDeps([])),"./locales/ja-JP.json":()=>ye(()=>import("./locales/ja-JP.json-DQmC5_NN.js"),__vite__mapDeps([])),"./locales/kaa.json":()=>ye(()=>import("./locales/kaa.json-CVs6He4h.js"),__vite__mapDeps([])),"./locales/kab-KAB.json":()=>ye(()=>import("./locales/kab-KAB.json-C1JM5BKr.js"),__vite__mapDeps([])),"./locales/kk-KZ.json":()=>ye(()=>import("./locales/kk-KZ.json-Dvqamimz.js"),__vite__mapDeps([])),"./locales/km-KH.json":()=>ye(()=>import("./locales/km-KH.json-DbT3p73L.js"),__vite__mapDeps([])),"./locales/ko-KR.json":()=>ye(()=>import("./locales/ko-KR.json-DREmLTQS.js"),__vite__mapDeps([])),"./locales/ku-TR.json":()=>ye(()=>import("./locales/ku-TR.json-DrQA-YfD.js"),__vite__mapDeps([])),"./locales/lt-LT.json":()=>ye(()=>import("./locales/lt-LT.json-DGRPFWD1.js"),__vite__mapDeps([])),"./locales/lv-LV.json":()=>ye(()=>import("./locales/lv-LV.json-CASIfe6V.js"),__vite__mapDeps([])),"./locales/mr-IN.json":()=>ye(()=>import("./locales/mr-IN.json-hSf8Ju5N.js"),__vite__mapDeps([])),"./locales/my-MM.json":()=>ye(()=>import("./locales/my-MM.json-6v_t93UK.js"),__vite__mapDeps([])),"./locales/nb-NO.json":()=>ye(()=>import("./locales/nb-NO.json-Dqd12NPv.js"),__vite__mapDeps([])),"./locales/nl-NL.json":()=>ye(()=>import("./locales/nl-NL.json-CKcuiTwv.js"),__vite__mapDeps([])),"./locales/nn-NO.json":()=>ye(()=>import("./locales/nn-NO.json-Dr77ZhXZ.js"),__vite__mapDeps([])),"./locales/oc-FR.json":()=>ye(()=>import("./locales/oc-FR.json-38R0RC-s.js"),__vite__mapDeps([])),"./locales/pa-IN.json":()=>ye(()=>import("./locales/pa-IN.json-BpVd2R6L.js"),__vite__mapDeps([])),"./locales/percentages.json":()=>ye(()=>Promise.resolve().then(()=>bue),void 0),"./locales/pl-PL.json":()=>ye(()=>import("./locales/pl-PL.json-SCtPkDvk.js"),__vite__mapDeps([])),"./locales/pt-BR.json":()=>ye(()=>import("./locales/pt-BR.json-4ytUdxoG.js"),__vite__mapDeps([])),"./locales/pt-PT.json":()=>ye(()=>import("./locales/pt-PT.json-BkfB8CUn.js"),__vite__mapDeps([])),"./locales/ro-RO.json":()=>ye(()=>import("./locales/ro-RO.json-GYlv0K-e.js"),__vite__mapDeps([])),"./locales/ru-RU.json":()=>ye(()=>import("./locales/ru-RU.json-D2N8VkFv.js"),__vite__mapDeps([])),"./locales/si-LK.json":()=>ye(()=>import("./locales/si-LK.json-LOvgQPv-.js"),__vite__mapDeps([])),"./locales/sk-SK.json":()=>ye(()=>import("./locales/sk-SK.json-7_zsSOcw.js"),__vite__mapDeps([])),"./locales/sl-SI.json":()=>ye(()=>import("./locales/sl-SI.json-Bb5hfJhH.js"),__vite__mapDeps([])),"./locales/sv-SE.json":()=>ye(()=>import("./locales/sv-SE.json-fmW0iDNi.js"),__vite__mapDeps([])),"./locales/ta-IN.json":()=>ye(()=>import("./locales/ta-IN.json-Bzd7wSNN.js"),__vite__mapDeps([])),"./locales/th-TH.json":()=>ye(()=>import("./locales/th-TH.json-pMNO3aZd.js"),__vite__mapDeps([])),"./locales/tr-TR.json":()=>ye(()=>import("./locales/tr-TR.json-D4RLn_Mi.js"),__vite__mapDeps([])),"./locales/uk-UA.json":()=>ye(()=>import("./locales/uk-UA.json-xSuXt7gp.js"),__vite__mapDeps([])),"./locales/uz-UZ.json":()=>ye(()=>import("./locales/uz-UZ.json-LZHw8Q0p.js"),__vite__mapDeps([])),"./locales/vi-VN.json":()=>ye(()=>import("./locales/vi-VN.json-C6kgtI1G.js"),__vite__mapDeps([])),"./locales/zh-CN.json":()=>ye(()=>import("./locales/zh-CN.json-DJzJ6ZIt.js"),__vite__mapDeps([])),"./locales/zh-HK.json":()=>ye(()=>import("./locales/zh-HK.json-BWMcw_hi.js"),__vite__mapDeps([])),"./locales/zh-TW.json":()=>ye(()=>import("./locales/zh-TW.json-DhrABcfR.js"),__vite__mapDeps([]))}),`./locales/${Qf.code}.json`)}catch(t){console.error(`Failed to load language ${e.code}:`,t.message),X2=V9}Gr.set(AV,e.code)},vm=()=>Qf,XM=(e,t)=>{for(let n=0;n<t.length;++n){const i=t[n];if(e[i]===void 0)return;e=e[i]}if(typeof e=="string")return e},M=(e,t,n)=>{if(Qf.code.startsWith(xV))return`[[${t?`${e}(${JSON.stringify(t).slice(1,-1)})`:e}]]`;const i=e.split(".");let r=XM(X2,i)||XM(V9,i)||n;if(r===void 0){const s=`Can't find translation for ${e}`;return console.warn(s),""}if(t)for(const s in t)r=r.replace(`{{${s}}}`,String(t[s]));return r},AV=Wt(Xu.code),fn=()=>{const e=HH(AV);return{t:M,langCode:e}},Eue=(e,t)=>{const[n,i,r,s]=t,{x:o,y:a}=Wr({sceneX:n,sceneY:i},e),{x:l,y:c}=Wr({sceneX:r,sceneY:s},e);return l-o>e.width||c-a>e.height},MV=({scenePoint:e,viewportDimensions:t,zoom:n,offsets:i})=>{let r=(t.width-((i==null?void 0:i.right)??0))/2/n.value-e.x;r+=((i==null?void 0:i.left)??0)/2/n.value;let s=(t.height-((i==null?void 0:i.bottom)??0))/2/n.value-e.y;return s+=((i==null?void 0:i.top)??0)/2/n.value,{scrollX:r,scrollY:s}},wm=(e,t)=>{if(e=eue(e),!e.length)return{scrollX:0,scrollY:0};let[n,i,r,s]=ht(e);Eue(t,[n,i,r,s])&&([n,i,r,s]=Tce(e,Nt({clientX:t.scrollX,clientY:t.scrollY},t)));const o=(n+r)/2,a=(i+s)/2;return MV({scenePoint:{x:o,y:a},viewportDimensions:{width:t.width,height:t.height},zoom:t.zoom})},Xa=e=>Ze(Za(e,6),F_,B_),vue=e=>Ze(Math.round(e),1,100),kV=e=>Ze(Math.round(e),1,100),no=e=>"var(--icon-fill-color)",RV=e=>e===ke.LIGHT?yi.white:"#1e1e1e",W=(e,t=512)=>{const{width:n=512,height:i=n,mirror:r,style:s,...o}=typeof t=="number"?{width:t}:t;return g("svg",{"aria-hidden":"true",focusable:"false",role:"img",viewBox:`0 0 ${n} ${i}`,className:le({"rtl-mirror":r}),style:s,...o,children:typeof e=="string"?g("path",{fill:"currentColor",d:e}):e})},ce={width:24,height:24,fill:"none",strokeWidth:2,stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"},He={width:20,height:20,fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"};W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("rect",{x:3,y:8,width:18,height:4,rx:1}),g("line",{x1:12,y1:8,x2:12,y2:21}),g("path",{d:"M19 12v7a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-7"}),g("path",{d:"M7.5 8a2.5 2.5 0 0 1 0 -5a4.8 8 0 0 1 4.5 5a4.8 8 0 0 1 4.5 -5a2.5 2.5 0 0 1 0 5"})]}),ce);const DV=W(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0"}),g("path",{d:"M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0"}),g("line",{x1:"3",y1:"6",x2:"3",y2:"19"}),g("line",{x1:"12",y1:"6",x2:"12",y2:"19"}),g("line",{x1:"21",y1:"6",x2:"21",y2:"19"})]}),ce),wue=W(N("svg",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),g("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),ce),_ue=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"12",cy:"12",r:"1"}),g("circle",{cx:"12",cy:"19",r:"1"}),g("circle",{cx:"12",cy:"5",r:"1"})]}),ce),Tue=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"}),g("path",{d:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"}),g("path",{d:"M19 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"})]}),ce),Iue=W(N("svg",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M9 4v6l-2 4v2h10v-2l-2 -4v-6"}),g("line",{x1:"12",y1:"16",x2:"12",y2:"21"}),g("line",{x1:"8",y1:"4",x2:"16",y2:"4"})]}),ce),jM=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M19 8m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M5 11m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M15 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M6.5 9.5l3.5 -3"}),g("path",{d:"M14 5.5l3 1.5"}),g("path",{d:"M18.5 10l-2.5 7"}),g("path",{d:"M13.5 17.5l-7 -5"})]}),ce),by=W(N("g",{children:[g("path",{d:"M13.542 8.542H6.458a2.5 2.5 0 0 0-2.5 2.5v3.75a2.5 2.5 0 0 0 2.5 2.5h7.084a2.5 2.5 0 0 0 2.5-2.5v-3.75a2.5 2.5 0 0 0-2.5-2.5Z",stroke:"currentColor",strokeWidth:"1.25"}),g("path",{d:"M10 13.958a1.042 1.042 0 1 0 0-2.083 1.042 1.042 0 0 0 0 2.083Z",stroke:"currentColor",strokeWidth:"1.25"}),g("mask",{id:"UnlockedIcon",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:6,y:1,width:9,height:9,children:g("path",{stroke:"none",d:"M6.399 9.561V5.175c0-.93.401-1.823 1.116-2.48a3.981 3.981 0 0 1 2.693-1.028c1.01 0 1.98.37 2.694 1.027.715.658 1.116 1.55 1.116 2.481",fill:"#fff"})}),g("g",{mask:"url(#UnlockedIcon)",children:g("path",{stroke:"none",d:"M5.149 9.561v1.25h2.5v-1.25h-2.5Zm5.06-7.894V.417v1.25Zm2.559 3.508v1.25h2.5v-1.25h-2.5ZM7.648 8.51V5.175h-2.5V8.51h2.5Zm0-3.334c0-.564.243-1.128.713-1.561L6.668 1.775c-.959.883-1.52 2.104-1.52 3.4h2.5Zm.713-1.561a2.732 2.732 0 0 1 1.847-.697v-2.5c-1.31 0-2.585.478-3.54 1.358L8.36 3.614Zm1.847-.697c.71 0 1.374.26 1.847.697l1.694-1.839a5.231 5.231 0 0 0-3.54-1.358v2.5Zm1.847.697c.47.433.713.997.713 1.561h2.5c0-1.296-.56-2.517-1.52-3.4l-1.693 1.839Z",fill:"currentColor"})})]}),He),$9=W(N("g",{strokeWidth:"1.25",children:[g("path",{d:"M13.542 8.542H6.458a2.5 2.5 0 0 0-2.5 2.5v3.75a2.5 2.5 0 0 0 2.5 2.5h7.084a2.5 2.5 0 0 0 2.5-2.5v-3.75a2.5 2.5 0 0 0-2.5-2.5Z"}),g("path",{d:"M10 13.958a1.042 1.042 0 1 0 0-2.083 1.042 1.042 0 0 0 0 2.083Z"}),g("path",{d:"M6.667 8.333V5.417C6.667 3.806 8.159 2.5 10 2.5c1.841 0 3.333 1.306 3.333 2.917v2.916"})]}),He),Sue=W(g("g",{fill:"currentColor",children:g("path",{d:"M12 2a5 5 0 0 1 5 5v3a3 3 0 0 1 3 3v6a3 3 0 0 1 -3 3h-10a3 3 0 0 1 -3 -3v-6a3 3 0 0 1 3 -3v-3a5 5 0 0 1 5 -5m0 12a2 2 0 0 0 -1.995 1.85l-.005 .15a2 2 0 1 0 2 -2m0 -10a3 3 0 0 0 -3 3v3h6v-3a3 3 0 0 0 -3 -3"})}),{width:24,height:24}),xue=W(N(fe,{children:[g("path",{d:"M38.5 83.5c-14-2-17.833-10.473-21-22.5C14.333 48.984 12 22 12 12.5",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"}),g("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m12.005 10.478 7.905 14.423L6 25.75l6.005-15.273Z",fill:"currentColor"}),g("path",{d:"M12.005 10.478c1.92 3.495 3.838 7 7.905 14.423m-7.905-14.423c3.11 5.683 6.23 11.368 7.905 14.423m0 0c-3.68.226-7.35.455-13.91.85m13.91-.85c-5.279.33-10.566.647-13.91.85m0 0c1.936-4.931 3.882-9.86 6.005-15.273M6 25.75c2.069-5.257 4.135-10.505 6.005-15.272",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"})]}),{width:41,height:94,fill:"none"}),Cue=W(N(fe,{children:[g("path",{d:"M18.026 1.232c-5.268 13.125-5.548 33.555 3.285 42.311 8.823 8.75 33.31 12.304 42.422 13.523",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"}),g("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m72.181 59.247-13.058-10-2.948 13.62 16.006-3.62Z",fill:"currentColor"}),g("path",{d:"M72.181 59.247c-3.163-2.429-6.337-4.856-13.058-10m13.058 10c-5.145-3.936-10.292-7.882-13.058-10m0 0c-.78 3.603-1.563 7.196-2.948 13.62m2.948-13.62c-1.126 5.168-2.24 10.346-2.948 13.62m0 0c5.168-1.166 10.334-2.343 16.006-3.62m-16.006 3.62c5.51-1.248 11.01-2.495 16.006-3.62",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"})]}),{width:85,height:71,fill:"none"}),Aue=W(N(fe,{children:[g("path",{d:"M1 77c14-2 31.833-11.973 35-24 3.167-12.016-6-35-9.5-43.5",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"}),g("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m24.165 1.093-2.132 16.309 13.27-4.258-11.138-12.05Z",fill:"currentColor"}),g("path",{d:"M24.165 1.093c-.522 3.953-1.037 7.916-2.132 16.309m2.131-16.309c-.835 6.424-1.68 12.854-2.13 16.308m0 0c3.51-1.125 7.013-2.243 13.27-4.257m-13.27 4.257c5.038-1.608 10.08-3.232 13.27-4.257m0 0c-3.595-3.892-7.197-7.777-11.14-12.05m11.14 12.05c-3.837-4.148-7.667-8.287-11.14-12.05",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"})]}),{width:38,height:78,fill:"none"}),iv=W(g("g",{fill:"currentColor",children:g("path",{d:"M39.9 32.889a.326.326 0 0 0-.279-.056c-2.094-3.083-4.774-6-7.343-8.833l-.419-.472a.212.212 0 0 0-.056-.139.586.586 0 0 0-.167-.111l-.084-.083-.056-.056c-.084-.167-.28-.278-.475-.167-.782.39-1.507.973-2.206 1.528-.92.722-1.842 1.445-2.708 2.25a8.405 8.405 0 0 0-.977 1.028c-.14.194-.028.361.14.444-.615.611-1.23 1.223-1.843 1.861a.315.315 0 0 0-.084.223c0 .083.056.166.111.194l1.09.833v.028c1.535 1.528 4.244 3.611 7.12 5.861.418.334.865.667 1.284 1 .195.223.39.473.558.695.084.11.28.139.391.055.056.056.14.111.196.167a.398.398 0 0 0 .167.056.255.255 0 0 0 .224-.111.394.394 0 0 0 .055-.167c.029 0 .028.028.056.028a.318.318 0 0 0 .224-.084l5.082-5.528a.309.309 0 0 0 0-.444Zm-14.63-1.917a.485.485 0 0 0 .111.14c.586.5 1.2 1 1.843 1.555l-2.569-1.945-.251-.166c-.056-.028-.112-.084-.168-.111l-.195-.167.056-.056.055-.055.112-.111c.866-.861 2.346-2.306 3.1-3.028-.81.805-2.43 3.167-2.095 3.944Zm8.767 6.89-2.122-1.612a44.713 44.713 0 0 0-2.625-2.5c1.145.861 2.122 1.611 2.262 1.75 1.117.972 1.06.806 1.815 1.445l.921.666a1.06 1.06 0 0 1-.251.25Zm.558.416-.056-.028c.084-.055.168-.111.252-.194l-.196.222ZM1.089 5.75c.055.361.14.722.195 1.056.335 1.833.67 3.5 1.284 4.75l.252.944c.084.361.223.806.363.917 1.424 1.25 3.602 3.11 5.947 4.889a.295.295 0 0 0 .363 0s0 .027.028.027a.254.254 0 0 0 .196.084.318.318 0 0 0 .223-.084c2.988-3.305 5.221-6.027 6.813-8.305.112-.111.14-.278.14-.417.111-.111.195-.25.307-.333.111-.111.111-.306 0-.39l-.028-.027c0-.055-.028-.139-.084-.167-.698-.666-1.2-1.138-1.731-1.638-.922-.862-1.871-1.75-3.881-3.75l-.028-.028c-.028-.028-.056-.056-.112-.056-.558-.194-1.703-.389-3.127-.639C6.087 2.223 3.21 1.723.614.944c0 0-.168 0-.196.028l-.083.084c-.028.027-.056.055-.224.11h.056-.056c.028.167.028.278.084.473 0 .055.112.5.112.555l.782 3.556Zm15.496 3.278-.335-.334c.084.112.196.195.335.334Zm-3.546 4.666-.056.056c0-.028.028-.056.056-.056Zm-2.038-10c.168.167.866.834 1.033.973-.726-.334-2.54-1.167-3.379-1.445.838.167 1.983.334 2.346.472ZM1.424 2.306c.419.722.754 3.222 1.089 5.666-.196-.778-.335-1.555-.503-2.278-.251-1.277-.503-2.416-.838-3.416.056 0 .14 0 .252.028Zm-.168-.584c-.112 0-.223-.028-.307-.028 0-.027 0-.055-.028-.055.14 0 .223.028.335.083Zm-1.089.222c0-.027 0-.027 0 0ZM39.453 1.333c.028-.11-.558-.61-.363-.639.42-.027.42-.666 0-.666-.558.028-1.144.166-1.675.25-.977.194-1.982.389-2.96.61-2.205.473-4.383.973-6.561 1.557-.67.194-1.424.333-2.066.666-.224.111-.196.333-.084.472-.056.028-.084.028-.14.056-.195.028-.363.056-.558.083-.168.028-.252.167-.224.334 0 .027.028.083.028.11-1.173 1.556-2.485 3.195-3.909 4.945-1.396 1.611-2.876 3.306-4.356 5.056-4.719 5.5-10.052 11.75-15.943 17.25a.268.268 0 0 0 0 .389c.028.027.056.055.084.055-.084.084-.168.14-.252.222-.056.056-.084.111-.084.167a.605.605 0 0 0-.111.139c-.112.111-.112.305.028.389.111.11.307.11.39-.028.029-.028.029-.056.056-.056a.44.44 0 0 1 .615 0c.335.362.67.723.977 1.028l-.698-.583c-.112-.111-.307-.083-.39.028-.113.11-.085.305.027.389l7.427 6.194c.056.056.112.056.196.056s.14-.028.195-.084l.168-.166c.028.027.083.027.111.027.084 0 .14-.027.196-.083 10.052-10.055 18.15-17.639 27.42-24.417.083-.055.111-.166.111-.25.112 0 .196-.083.251-.194 1.704-5.194 2.039-9.806 2.15-12.083v-.028c0-.028.028-.056.028-.083.028-.056.028-.084.028-.084a1.626 1.626 0 0 0-.111-1.028ZM21.472 9.5c.446-.5.893-1.028 1.34-1.5-2.876 3.778-7.65 9.583-14.408 16.5 4.607-5.083 9.242-10.333 13.068-15ZM5.193 35.778h.084-.084Zm3.462 3.194c-.027-.028-.027-.028 0-.028v.028Zm4.16-3.583c.224-.25.448-.472.699-.722 0 0 0 .027.028.027-.252.223-.475.445-.726.695Zm1.146-1.111c.14-.14.279-.334.446-.5l.028-.028c1.648-1.694 3.351-3.389 5.082-5.111l.028-.028c.419-.333.921-.694 1.368-1.028a379.003 379.003 0 0 0-6.952 6.695ZM24.794 6.472c-.921 1.195-1.954 2.778-2.82 4.028-2.736 3.944-11.532 13.583-11.727 13.75a1976.983 1976.983 0 0 1-8.042 7.639l-.167.167c-.14-.167-.14-.417.028-.556C14.49 19.861 22.03 10.167 25.074 5.917c-.084.194-.14.36-.28.555Zm4.83 5.695c-1.116-.64-1.646-1.64-1.34-2.611l.084-.334c.028-.083.084-.194.14-.277.307-.5.754-.917 1.257-1.167.027 0 .055 0 .083-.028-.028-.056-.028-.139-.028-.222.028-.167.14-.278.335-.278.335 0 1.369.306 1.76.639.111.083.223.194.335.305.14.167.363.445.474.667.056.028.112.306.196.445.056.222.111.472.084.694-.028.028 0 .194-.028.194a2.668 2.668 0 0 1-.363 1.028c-.028.028-.028.056-.056.084l-.028.027c-.14.223-.335.417-.53.556-.643.444-1.369.583-2.095.389 0 0-.195-.084-.28-.111Zm8.154-.834a39.098 39.098 0 0 1-.893 3.167c0 .028-.028.083 0 .111-.056 0-.084.028-.14.056-2.206 1.61-4.356 3.305-6.506 5.028 1.843-1.64 3.686-3.306 5.613-4.945.558-.5.949-1.139 1.06-1.861l.28-1.667v-.055c.14-.334.67-.195.586.166Z",fill:"currentColor"})}),{width:40,height:40,fill:"none"}),yy=W(N("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 6l4.153 11.793a0.365 .365 0 0 0 .331 .207a0.366 .366 0 0 0 .332 -.207l2.184 -4.793l4.787 -1.994a0.355 .355 0 0 0 .213 -.323a0.355 .355 0 0 0 -.213 -.323l-11.787 -4.36z"}),g("path",{d:"M13.5 13.5l4.5 4.5"})]}),{fill:"none",width:22,height:22,strokeWidth:1.25}),M0=W(N("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,children:[g("path",{d:"M4.028 13.252c-.657 -.972 -1.028 -2.078 -1.028 -3.252c0 -3.866 4.03 -7 9 -7s9 3.134 9 7s-4.03 7 -9 7c-1.913 0 -3.686 -.464 -5.144 -1.255"}),g("path",{d:"M5 15m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M5 17c0 1.42 .316 2.805 1 4"})]}),{fill:"none",width:22,height:22,strokeWidth:1.25}),G9=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})]}),ce),X9=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10.5 20.4l-6.9 -6.9c-.781 -.781 -.781 -2.219 0 -3l6.9 -6.9c.781 -.781 2.219 -.781 3 0l6.9 6.9c.781 .781 .781 2.219 0 3l-6.9 6.9c-.781 .781 -2.219 .781 -3 0z"})]}),ce),j9=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"12",cy:"12",r:"9"})]}),ce),LV=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),g("line",{x1:"15",y1:"16",x2:"19",y2:"12"}),g("line",{x1:"15",y1:"8",x2:"19",y2:"12"})]}),ce),Y9=W(g("path",{d:"M4.167 10h11.666",strokeWidth:"1.5"}),He),Mue=W(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M20 17v-12c0 -1.121 -.879 -2 -2 -2s-2 .879 -2 2v12l2 2l2 -2z"}),g("path",{d:"M16 7h4"}),g("path",{d:"M18 19h-13a2 2 0 1 1 0 -4h4a2 2 0 1 0 0 -4h-3"})]}),ce),Lp=W(N("g",{strokeWidth:"1.25",children:[g("path",{clipRule:"evenodd",d:"m7.643 15.69 7.774-7.773a2.357 2.357 0 1 0-3.334-3.334L4.31 12.357a3.333 3.333 0 0 0-.977 2.357v1.953h1.953c.884 0 1.732-.352 2.357-.977Z"}),g("path",{d:"m11.25 5.417 3.333 3.333"})]}),He),Uh=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"20",x2:"7",y2:"20"}),g("line",{x1:"14",y1:"20",x2:"21",y2:"20"}),g("line",{x1:"6.9",y1:"15",x2:"13.8",y2:"15"}),g("line",{x1:"10.2",y1:"6.3",x2:"16",y2:"20"}),g("polyline",{points:"5 20 11 4 13 4 20 20"})]}),ce),kue=W(N("g",{stroke:"currentColor",strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 7v-2h13v2"}),g("path",{d:"M10 5v14"}),g("path",{d:"M12 19h-4"}),g("path",{d:"M15 13v-1h6v1"}),g("path",{d:"M18 12v7"}),g("path",{d:"M17 19h2"})]}),ce),j2=W(N("g",{strokeWidth:"1.25",children:[g("path",{d:"M12.5 6.667h.01"}),g("path",{d:"M4.91 2.625h10.18a2.284 2.284 0 0 1 2.285 2.284v10.182a2.284 2.284 0 0 1-2.284 2.284H4.909a2.284 2.284 0 0 1-2.284-2.284V4.909a2.284 2.284 0 0 1 2.284-2.284Z"}),g("path",{d:"m3.333 12.5 3.334-3.333c.773-.745 1.726-.745 2.5 0l4.166 4.166"}),g("path",{d:"m11.667 11.667.833-.834c.774-.744 1.726-.744 2.5 0l1.667 1.667"})]}),He),NV=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M19 20h-10.5l-4.21 -4.3a1 1 0 0 1 0 -1.41l10 -10a1 1 0 0 1 1.41 0l5 5a1 1 0 0 1 0 1.41l-9.2 9.3"}),g("path",{d:"M18 13.3l-6.3 -6.3"})]}),ce),YM=W(g("path",{strokeWidth:"1.25",d:"M10 4.167v11.666M4.167 10h11.666"}),He),WM=W(g("path",{d:"M5 10h10",strokeWidth:"1.25"}),He),Rue=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M21 21l-6 -6"}),g("path",{d:"M3.268 12.043a7.017 7.017 0 0 0 6.634 4.957a7.012 7.012 0 0 0 7.043 -6.131a7 7 0 0 0 -5.314 -7.672a7.021 7.021 0 0 0 -8.241 4.403"}),g("path",{d:"M3 4v4h4"})]}),ce),Xc=W(g("path",{strokeWidth:"1.25",d:"M3.333 5.833h13.334M8.333 9.167v5M11.667 9.167v5M4.167 5.833l.833 10c0 .92.746 1.667 1.667 1.667h6.666c.92 0 1.667-.746 1.667-1.667l.833-10M7.5 5.833v-2.5c0-.46.373-.833.833-.833h3.334c.46 0 .833.373.833.833v2.5"}),He),L6=W(N("g",{strokeWidth:"1.5",children:[g("polyline",{points:"12 16 18 10 12 4"}),g("polyline",{points:"8 4 2 10 8 16"})]}),He),rv=W(N("g",{strokeWidth:"1.25",children:[g("path",{d:"M14.375 6.458H8.958a2.5 2.5 0 0 0-2.5 2.5v5.417a2.5 2.5 0 0 0 2.5 2.5h5.417a2.5 2.5 0 0 0 2.5-2.5V8.958a2.5 2.5 0 0 0-2.5-2.5Z"}),g("path",{clipRule:"evenodd",d:"M11.667 3.125c.517 0 .986.21 1.325.55.34.338.55.807.55 1.325v1.458H8.333c-.485 0-.927.185-1.26.487-.343.312-.57.75-.609 1.24l-.005 5.357H5a1.87 1.87 0 0 1-1.326-.55 1.87 1.87 0 0 1-.549-1.325V5c0-.518.21-.987.55-1.326.338-.34.807-.549 1.325-.549h6.667Z"})]}),He),sv=W(g("path",{clipRule:"evenodd",d:"M10 2.5h.328a6.25 6.25 0 0 0 6.6 10.372A7.5 7.5 0 1 1 10 2.493V2.5Z",stroke:"currentColor"}),He),ov=W(g("g",{stroke:"currentColor",strokeLinejoin:"round",children:g("path",{d:"M10 12.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM10 4.167V2.5M14.167 5.833l1.166-1.166M15.833 10H17.5M14.167 14.167l1.166 1.166M10 15.833V17.5M5.833 14.167l-1.166 1.166M5 10H3.333M5.833 5.833 4.667 4.667"})}),{...He,strokeWidth:1.5}),Due=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"6",x2:"20",y2:"6"}),g("line",{x1:"4",y1:"12",x2:"20",y2:"12"}),g("line",{x1:"4",y1:"18",x2:"20",y2:"18"})]}),ce),Ey=W(g("path",{strokeWidth:"1.25",d:"M3.333 14.167v1.666c0 .92.747 1.667 1.667 1.667h10c.92 0 1.667-.746 1.667-1.667v-1.666M5.833 9.167 10 13.333l4.167-4.166M10 3.333v10"}),He),W9=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"12",cy:"12",r:"9"}),g("line",{x1:"12",y1:"17",x2:"12",y2:"17.01"}),g("path",{d:"M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4"})]}),ce),Lue=W(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"12",cy:"12",r:"9"}),g("line",{x1:"12",y1:"17",x2:"12",y2:"17.01"}),g("path",{d:"M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4"})]}),ce),KM=W(g("path",{strokeWidth:"1.25",d:"M9.167 5.833H5.833c-1.254 0-2.5 1.282-2.5 2.5v5.834c0 1.283 1.252 2.5 2.5 2.5h5.834c1.251 0 2.5-1.25 2.5-2.5v-3.334M8.333 11.667l8.334-8.334M12.5 3.333h4.167V7.5"}),He),K9=W(g("path",{d:"M7.5 15.833c-3.583 1.167-3.583-2.083-5-2.5m10 4.167v-2.917c0-.833.083-1.166-.417-1.666 2.334-.25 4.584-1.167 4.584-5a3.833 3.833 0 0 0-1.084-2.667 3.5 3.5 0 0 0-.083-2.667s-.917-.25-2.917 1.084a10.25 10.25 0 0 0-5.166 0C5.417 2.333 4.5 2.583 4.5 2.583a3.5 3.5 0 0 0-.083 2.667 3.833 3.833 0 0 0-1.084 2.667c0 3.833 2.25 4.75 4.584 5-.5.5-.5 1-.417 1.666V17.5",strokeWidth:"1.25"}),He),OV=W(N("g",{strokeWidth:"1.25",children:[g("path",{d:"M7.5 10.833a.833.833 0 1 0 0-1.666.833.833 0 0 0 0 1.666ZM12.5 10.833a.833.833 0 1 0 0-1.666.833.833 0 0 0 0 1.666ZM6.25 6.25c2.917-.833 4.583-.833 7.5 0M5.833 13.75c2.917.833 5.417.833 8.334 0"}),g("path",{d:"M12.917 14.167c0 .833 1.25 2.5 1.666 2.5 1.25 0 2.361-1.39 2.917-2.5.556-1.39.417-4.861-1.25-9.584-1.214-.846-2.5-1.116-3.75-1.25l-.833 2.084M7.083 14.167c0 .833-1.13 2.5-1.526 2.5-1.191 0-2.249-1.39-2.778-2.5-.529-1.39-.397-4.861 1.19-9.584 1.157-.846 2.318-1.116 3.531-1.25l.833 2.084"})]}),He),PV=W(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 4l11.733 16h4.267l-11.733 -16z"}),g("path",{d:"M4 20l6.768 -6.768m2.46 -2.46l6.772 -6.772"})]}),ce),Nue=W(g("polyline",{fill:"none",stroke:"currentColor",points:"20 6 9 17 4 12"}),{width:24,height:24}),N6=W(N("g",{strokeWidth:"1.25",children:[g("path",{d:"M8.333 11.667a2.917 2.917 0 0 0 4.167 0l3.333-3.334a2.946 2.946 0 1 0-4.166-4.166l-.417.416"}),g("path",{d:"M11.667 8.333a2.917 2.917 0 0 0-4.167 0l-3.333 3.334a2.946 2.946 0 0 0 4.166 4.166l.417-.416"})]}),He),Oue=W("M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z",{width:448,height:512}),Pue=W("M252 54L203 8a28 27 0 00-20-8H28C12 0 0 12 0 27v195c0 15 12 26 28 26h204c15 0 28-11 28-26V73a28 27 0 00-8-19zM130 213c-21 0-37-16-37-36 0-19 16-35 37-35 20 0 37 16 37 35 0 20-17 36-37 36zm56-169v56c0 4-4 6-7 6H44c-4 0-7-2-7-6V42c0-4 3-7 7-7h133l4 2 3 2a7 7 0 012 5z M296 201l87 95-188 205-78 9c-10 1-19-8-18-20l9-84zm141-14l-41-44a31 31 0 00-46 0l-38 41 87 95 38-42c13-14 13-36 0-50z",{width:448,height:512}),Z9=W(g("path",{d:"m9.257 6.351.183.183H15.819c.34 0 .727.182 1.051.506.323.323.505.708.505 1.05v5.819c0 .316-.183.7-.52 1.035-.337.338-.723.522-1.037.522H4.182c-.352 0-.74-.181-1.058-.5-.318-.318-.499-.705-.499-1.057V5.182c0-.351.181-.736.5-1.054.32-.321.71-.503 1.057-.503H6.53l2.726 2.726Z",strokeWidth:"1.25"}),He);W("M384 112v352c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h80c0-35.29 28.71-64 64-64s64 28.71 64 64h80c26.51 0 48 21.49 48 48zM192 40c-13.255 0-24 10.745-24 24s10.745 24 24 24 24-10.745 24-24-10.745-24-24-24m96 114v-20a6 6 0 0 0-6-6H102a6 6 0 0 0-6 6v20a6 6 0 0 0 6 6h180a6 6 0 0 0 6-6z",{width:384,height:512});W("M204.3 5C104.9 24.4 24.8 104.3 5.2 203.4c-37 187 131.7 326.4 258.8 306.7 41.2-6.4 61.4-54.6 42.5-91.7-23.1-45.4 9.9-98.4 60.9-98.4h79.7c35.8 0 64.8-29.6 64.9-65.3C511.5 97.1 368.1-26.9 204.3 5zM96 320c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm32-128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128-64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z");const q8=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 16l1.465 1.638a2 2 0 1 1 -3.015 .099l1.55 -1.737z"}),g("path",{d:"M13.737 9.737c2.299 -2.3 3.23 -5.095 2.081 -6.245c-1.15 -1.15 -3.945 -.217 -6.244 2.082c-2.3 2.299 -3.231 5.095 -2.082 6.244c1.15 1.15 3.946 .218 6.245 -2.081z"}),g("path",{d:"M7.492 11.818c.362 .362 .768 .676 1.208 .934l6.895 4.047c1.078 .557 2.255 -.075 3.692 -1.512c1.437 -1.437 2.07 -2.614 1.512 -3.692c-.372 -.718 -1.72 -3.017 -4.047 -6.895a6.015 6.015 0 0 0 -.934 -1.208"})]}),ce),Fue=W(g("g",{strokeWidth:1.5,children:g("path",{d:"M6 18l12 -12"})}),ce),FV=W(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15 8h.01"}),g("path",{d:"M12 20h-5a3 3 0 0 1 -3 -3v-10a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v5"}),g("path",{d:"M4 15l4 -4c.928 -.893 2.072 -.893 3 0l4 4"}),g("path",{d:"M14 14l1 -1c.617 -.593 1.328 -.793 2.009 -.598"}),g("path",{d:"M19 16v6"}),g("path",{d:"M22 19l-3 3l-3 -3"})]}),ce),Bue=W("M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z",{width:512,height:512});W("M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",{width:448,height:512});W("M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",{width:448,height:512});const zue=W("M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z");W("M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z");const ZM=W(g("path",{d:"M7.5 10.833 4.167 7.5 7.5 4.167M4.167 7.5h9.166a3.333 3.333 0 0 1 0 6.667H12.5",strokeWidth:"1.25"}),He),qM=W(g("path",{d:"M12.5 10.833 15.833 7.5 12.5 4.167M15.833 7.5H6.667a3.333 3.333 0 1 0 0 6.667H7.5",strokeWidth:"1.25"}),He),Hue=W("M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zM262.655 90c-54.497 0-89.255 22.957-116.549 63.758-3.536 5.286-2.353 12.415 2.715 16.258l34.699 26.31c5.205 3.947 12.621 3.008 16.665-2.122 17.864-22.658 30.113-35.797 57.303-35.797 20.429 0 45.698 13.148 45.698 32.958 0 14.976-12.363 22.667-32.534 33.976C247.128 238.528 216 254.941 216 296v4c0 6.627 5.373 12 12 12h56c6.627 0 12-5.373 12-12v-1.333c0-28.462 83.186-29.647 83.186-106.667 0-58.002-60.165-102-116.531-102zM256 338c-25.365 0-46 20.635-46 46 0 25.364 20.635 46 46 46s46-20.636 46-46c0-25.365-20.635-46-46-46z",{mirror:!0}),q9=W(g("path",{d:"M5 12.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM15 7.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM15 17.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM7.25 8.917l5.5-2.834M7.25 11.083l5.5 2.834",strokeWidth:"1.5"}),He),Vue=W("M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"),$ue=W("M16 5l-1.42 1.42-1.59-1.59V16h-1.98V4.83L9.42 6.42 8 5l4-4 4 4zm4 5v11c0 1.1-.9 2-2 2H6c-1.11 0-2-.9-2-2V10c0-1.11.89-2 2-2h3v2H6v11h12V10h-3V8h3c1.1 0 2 .89 2 2z",{width:24,height:24}),Gue=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 9h-1a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-8a2 2 0 0 0 -2 -2h-1"}),g("path",{d:"M12 14v-11"}),g("path",{d:"M9 6l3 -3l3 3"})]}),ce),Xue=W(N(fe,{children:[g("path",{fill:"currentColor",d:"M40 5.6v6.1l-4.1.7c-8.9 1.4-16.5 6.9-20.6 15C13 32 10.9 43 12.4 43c.4 0 2.4-1.3 4.4-3 5-3.9 12.1-7 18.2-7.7l5-.6v12.8l11.2-11.3L62.5 22 51.2 10.8 40-.5v6.1zm10.2 22.6L44 34.5v-6.8l-6.9.6c-3.9.3-9.8 1.7-13.2 3.1-3.5 1.4-6.5 2.4-6.7 2.2-.9-1 3-7.5 6.4-10.8C28 18.6 34.4 16 40.1 16c3.7 0 3.9-.1 3.9-3.2V9.5l6.2 6.3 6.3 6.2-6.3 6.2z"}),g("path",{stroke:"currentColor",fill:"currentColor",d:"M0 36v20h48v-6.2c0-6 0-6.1-2-4.3-1.1 1-2 2.9-2 4.2V52H4V34c0-17.3-.1-18-2-18s-2 .7-2 20z"})]}),{width:64,height:64});W(g("path",{stroke:"currentColor",strokeWidth:"40",fill:"currentColor",d:"M148 560a318 318 0 0 0 522 110 316 316 0 0 0 0-450 316 316 0 0 0-450 0c-11 11-21 22-30 34v4h47c25 0 46 21 46 46s-21 45-46 45H90c-13 0-25-6-33-14-9-9-14-20-14-33V156c0-25 20-45 45-45s45 20 45 45v32l1 1a401 401 0 0 1 623 509l212 212a42 42 0 0 1-59 59L698 757A401 401 0 0 1 65 570a42 42 0 0 1 83-10z"}),{width:1024});const BV=N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 10l0 10"}),g("path",{d:"M12 10l4 4"}),g("path",{d:"M12 10l-4 4"}),g("path",{d:"M4 4l16 0"})]}),zV=N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 5l0 14"}),g("path",{d:"M16 9l-4 -4"}),g("path",{d:"M8 9l4 -4"})]}),QM=W(zV,ce),JM=W(zV,{...ce,style:{transform:"rotate(180deg)"}}),ek=W(BV,ce),tk=W(BV,{...ce,style:{transform:"rotate(180deg)"}}),nk=W(N(fe,{children:[N("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M3.333 3.333h13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M13.542 6.458h-.417c-.92 0-1.667.747-1.667 1.667v7.083c0 .92.746 1.667 1.667 1.667h.417c.92 0 1.666-.746 1.666-1.667V8.125c0-.92-.746-1.667-1.666-1.667ZM6.875 6.458h-.417c-.92 0-1.666.747-1.666 1.667v3.75c0 .92.746 1.667 1.666 1.667h.417c.92 0 1.667-.746 1.667-1.667v-3.75c0-.92-.747-1.667-1.667-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),He),ik=W(N(fe,{children:[N("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M3.333 16.667h13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M6.875 3.125h-.417c-.92 0-1.666.746-1.666 1.667v7.083c0 .92.746 1.667 1.666 1.667h.417c.92 0 1.667-.746 1.667-1.667V4.792c0-.92-.747-1.667-1.667-1.667ZM13.542 5.817h-.417c-.92 0-1.667.747-1.667 1.667v4.391c0 .92.746 1.667 1.667 1.667h.417c.92 0 1.666-.746 1.666-1.667V7.484c0-.92-.746-1.667-1.666-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),He),rk=W(N(fe,{children:[N("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M3.333 3.333v13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M15.208 4.792H8.125c-.92 0-1.667.746-1.667 1.666v.417c0 .92.747 1.667 1.667 1.667h7.083c.92 0 1.667-.747 1.667-1.667v-.417c0-.92-.746-1.666-1.667-1.666ZM12.516 11.458H8.125c-.92 0-1.667.746-1.667 1.667v.417c0 .92.747 1.666 1.667 1.666h4.391c.92 0 1.667-.746 1.667-1.666v-.417c0-.92-.746-1.667-1.667-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),He),sk=W(N(fe,{children:[N("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M16.667 3.333v13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M11.875 4.792H4.792c-.92 0-1.667.746-1.667 1.666v.417c0 .92.746 1.667 1.667 1.667h7.083c.92 0 1.667-.747 1.667-1.667v-.417c0-.92-.746-1.666-1.667-1.666ZM11.683 11.458H7.292c-.92 0-1.667.746-1.667 1.667v.417c0 .92.746 1.666 1.667 1.666h4.39c.921 0 1.667-.746 1.667-1.666v-.417c0-.92-.746-1.667-1.666-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),He),jue=W(N(fe,{children:[N("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M16.667 3.333v13.334M3.333 3.333v13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M14.375 10.208v-.416c0-.92-.746-1.667-1.667-1.667H7.292c-.92 0-1.667.746-1.667 1.667v.416c0 .92.746 1.667 1.667 1.667h5.416c.92 0 1.667-.746 1.667-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),He),Yue=W(N(fe,{children:[N("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M3.333 3.333h13.334M3.333 16.667h13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M10.208 5.625h-.416c-.92 0-1.667.746-1.667 1.667v5.416c0 .92.746 1.667 1.667 1.667h.416c.92 0 1.667-.746 1.667-1.667V7.292c0-.92-.746-1.667-1.667-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),He),ok=W(N("g",{stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M1.667 10h2.916",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M8.333 10h3.334",strokeLinejoin:"round"}),g("path",{d:"M15.417 10h2.916",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M6.875 4.792h-.417c-.92 0-1.666.746-1.666 1.666v7.084c0 .92.746 1.666 1.666 1.666h.417c.92 0 1.667-.746 1.667-1.666V6.458c0-.92-.747-1.666-1.667-1.666ZM13.542 6.458h-.417c-.92 0-1.667.747-1.667 1.667v3.75c0 .92.746 1.667 1.667 1.667h.417c.92 0 1.666-.746 1.666-1.667v-3.75c0-.92-.746-1.667-1.666-1.667Z"})]}),He),ak=W(N("g",{stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M10 18.333v-2.916",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M10 11.667V8.333",strokeLinejoin:"round"}),g("path",{d:"M10 4.583V1.667",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M4.792 13.125v.417c0 .92.746 1.666 1.666 1.666h7.084c.92 0 1.666-.746 1.666-1.666v-.417c0-.92-.746-1.667-1.666-1.667H6.458c-.92 0-1.666.746-1.666 1.667ZM6.458 6.458v.417c0 .92.747 1.667 1.667 1.667h3.75c.92 0 1.667-.747 1.667-1.667v-.417c0-.92-.746-1.666-1.667-1.666h-3.75c-.92 0-1.667.746-1.667 1.666Z"})]}),He),Q9=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"9",cy:"7",r:"4"}),g("path",{d:"M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"}),g("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"}),g("path",{d:"M21 21v-2a4 4 0 0 0 -3 -3.85"})]}),ce);W("M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm115.7 272l-176 101c-15.8 8.8-35.7-2.5-35.7-21V152c0-18.4 19.8-29.8 35.7-21l176 107c16.4 9.2 16.4 32.9 0 42z");W("M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm96 328c0 8.8-7.2 16-16 16H176c-8.8 0-16-7.2-16-16V176c0-8.8 7.2-16 16-16h160c8.8 0 16 7.2 16 16v160z");const ju=W(N(fe,{children:[g("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:g("path",{d:"M15 5 5 15M5 5l10 10"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),He);W("M464 0c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48H176c-26.51 0-48-21.49-48-48V48c0-26.51 21.49-48 48-48h288M176 416c-44.112 0-80-35.888-80-80V128H48c-26.51 0-48 21.49-48 48v288c0 26.51 21.49 48 48 48h288c26.51 0 48-21.49 48-48v-48H176z",{mirror:!0});const Wue=W("M11.553 22.894a.998.998 0 00.894 0s3.037-1.516 5.465-4.097C19.616 16.987 21 14.663 21 12V5a1 1 0 00-.649-.936l-8-3a.998.998 0 00-.702 0l-8 3A1 1 0 003 5v7c0 2.663 1.384 4.987 3.088 6.797 2.428 2.581 5.465 4.097 5.465 4.097zm-1.303-8.481l6.644-6.644a.856.856 0 111.212 1.212l-7.25 7.25a.856.856 0 01-1.212 0l-3.75-3.75a.856.856 0 111.212-1.212l3.144 3.144z",{width:24});W("M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM332.1 128H256V51.9l76.1 76.1zM48 464V48h160v104c0 13.3 10.7 24 24 24h104v288H48zm32-48h224V288l-23.5-23.5c-4.7-4.7-12.3-4.7-17 0L176 352l-39.5-39.5c-4.7-4.7-12.3-4.7-17 0L80 352v64zm48-240c-26.5 0-48 21.5-48 48s21.5 48 48 48 48-21.5 48-48-21.5-48-48-48z",{width:384,height:512});const lk=de.memo(({theme:e})=>W(N(fe,{children:[g("path",{d:"M25 26H111V111H25",fill:no()}),g("path",{d:"M25 111C25 80.2068 25 49.4135 25 26M25 26C48.6174 26 72.2348 26 111 26H25ZM25 26C53.3671 26 81.7343 26 111 26H25ZM111 26C111 52.303 111 78.606 111 111V26ZM111 26C111 51.2947 111 76.5893 111 111V26ZM111 111C87.0792 111 63.1585 111 25 111H111ZM111 111C87.4646 111 63.9293 111 25 111H111ZM25 111C25 81.1514 25 51.3028 25 26V111Z",stroke:no(),strokeWidth:"2"}),g("path",{d:"M100 100H160V160H100",fill:no()}),g("path",{d:"M100 160C100 144.106 100 128.211 100 100M100 100C117.706 100 135.412 100 160 100H100ZM100 100C114.214 100 128.428 100 160 100H100ZM160 100C160 120.184 160 140.369 160 160V100ZM160 100C160 113.219 160 126.437 160 160V100ZM160 160C145.534 160 131.068 160 100 160H160ZM160 160C143.467 160 126.934 160 100 160H160ZM100 160C100 143.661 100 127.321 100 100V160Z",stroke:no(),strokeWidth:"2"}),N("g",{fill:RV(e),stroke:no(),strokeWidth:"6",children:[g("rect",{x:"2.5",y:"2.5",width:"30",height:"30"}),g("rect",{x:"2.5",y:"149.5",width:"30",height:"30"}),g("rect",{x:"147.5",y:"149.5",width:"30",height:"30"}),g("rect",{x:"147.5",y:"2.5",width:"30",height:"30"})]})]}),{width:182,height:182,mirror:!0})),ck=de.memo(({theme:e})=>W(N(fe,{children:[g("path",{d:"M25 26H111V111H25",fill:no()}),g("path",{d:"M25 111C25 80.2068 25 49.4135 25 26M25 26C48.6174 26 72.2348 26 111 26H25ZM25 26C53.3671 26 81.7343 26 111 26H25ZM111 26C111 52.303 111 78.606 111 111V26ZM111 26C111 51.2947 111 76.5893 111 111V26ZM111 111C87.0792 111 63.1585 111 25 111H111ZM111 111C87.4646 111 63.9293 111 25 111H111ZM25 111C25 81.1514 25 51.3028 25 26V111Z",stroke:no(),strokeWidth:"2"}),g("path",{d:"M100 100H160V160H100",fill:no()}),g("path",{d:"M100 160C100 144.106 100 128.211 100 100M100 100C117.706 100 135.412 100 160 100H100ZM100 100C114.214 100 128.428 100 160 100H100ZM160 100C160 120.184 160 140.369 160 160V100ZM160 100C160 113.219 160 126.437 160 160V100ZM160 160C145.534 160 131.068 160 100 160H160ZM160 160C143.467 160 126.934 160 100 160H160ZM100 160C100 143.661 100 127.321 100 100V160Z",stroke:no(),strokeWidth:"2"}),N("g",{fill:RV(e),stroke:no(),strokeWidth:"6",children:[g("rect",{x:"2.5",y:"2.5",width:"30",height:"30"}),g("rect",{x:"78.5",y:"149.5",width:"30",height:"30"}),g("rect",{x:"147.5",y:"149.5",width:"30",height:"30"}),g("rect",{x:"147.5",y:"78.5",width:"30",height:"30"}),g("rect",{x:"105.5",y:"2.5",width:"30",height:"30"}),g("rect",{x:"2.5",y:"102.5",width:"30",height:"30"})]})]}),{width:182,height:182,mirror:!0})),Kue=W(g("g",{strokeWidth:1.25,children:g("path",{d:"M5.879 2.625h8.242a3.27 3.27 0 0 1 3.254 3.254v8.242a3.27 3.27 0 0 1-3.254 3.254H5.88a3.27 3.27 0 0 1-3.254-3.254V5.88A3.27 3.27 0 0 1 5.88 2.626l-.001-.001ZM4.518 16.118l7.608-12.83m.198 13.934 5.051-9.897M2.778 9.675l9.348-6.387m-7.608 12.83 12.857-8.793"})}),He),Zue=W(N(fe,{children:[g("path",{d:"M5.879 2.625h8.242a3.254 3.254 0 0 1 3.254 3.254v8.242a3.254 3.254 0 0 1-3.254 3.254H5.88a3.254 3.254 0 0 1-3.254-3.254V5.88a3.254 3.254 0 0 1 3.254-3.254Z",stroke:"currentColor",strokeWidth:"1.25"}),g("mask",{id:"FillHachureIcon",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:2,y:2,width:16,height:16,children:g("path",{d:"M5.879 2.625h8.242a3.254 3.254 0 0 1 3.254 3.254v8.242a3.254 3.254 0 0 1-3.254 3.254H5.88a3.254 3.254 0 0 1-3.254-3.254V5.88a3.254 3.254 0 0 1 3.254-3.254Z",fill:"currentColor",stroke:"currentColor",strokeWidth:"1.25"})}),g("g",{mask:"url(#FillHachureIcon)",children:g("path",{d:"M2.258 15.156 15.156 2.258M7.324 20.222 20.222 7.325m-20.444 5.35L12.675-.222m-8.157 18.34L17.416 5.22",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})})]}),He),que=W(N(fe,{children:[N("g",{clipPath:"url(#a)",children:[g("path",{d:"M5.879 2.625h8.242a3.254 3.254 0 0 1 3.254 3.254v8.242a3.254 3.254 0 0 1-3.254 3.254H5.88a3.254 3.254 0 0 1-3.254-3.254V5.88a3.254 3.254 0 0 1 3.254-3.254Z",stroke:"currentColor",strokeWidth:"1.25"}),g("mask",{id:"FillCrossHatchIcon",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:-1,y:-1,width:22,height:22,children:g("path",{d:"M2.426 15.044 15.044 2.426M7.383 20 20 7.383M0 12.617 12.617 0m-7.98 17.941L17.256 5.324m-2.211 12.25L2.426 4.956M20 12.617 7.383 0m5.234 20L0 7.383m17.941 7.98L5.324 2.745",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),g("g",{mask:"url(#FillCrossHatchIcon)",children:g("path",{d:"M14.121 2H5.88A3.879 3.879 0 0 0 2 5.879v8.242A3.879 3.879 0 0 0 5.879 18h8.242A3.879 3.879 0 0 0 18 14.121V5.88A3.879 3.879 0 0 0 14.121 2Z",fill:"currentColor"})})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),He),Que=W(N(fe,{children:[g("g",{clipPath:"url(#a)",children:g("path",{d:"M4.91 2.625h10.18a2.284 2.284 0 0 1 2.285 2.284v10.182a2.284 2.284 0 0 1-2.284 2.284H4.909a2.284 2.284 0 0 1-2.284-2.284V4.909a2.284 2.284 0 0 1 2.284-2.284Z",stroke:"currentColor",strokeWidth:"1.25"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),{...He,fill:"currentColor"}),HV=W(g(fe,{children:g("path",{d:"M4.167 10h11.666",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),He),Jue=W(g("path",{d:"M5 10h10",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),He),efe=W(g("path",{d:"M5 10h10",stroke:"currentColor",strokeWidth:"3.75",strokeLinecap:"round",strokeLinejoin:"round"}),He);de.memo(({theme:e})=>W(g("path",{d:"M6 10H34",stroke:no(),strokeWidth:2,fill:"none",strokeLinecap:"round"}),{width:40,height:20}));const tfe=W(N("g",{strokeWidth:"2",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 12h2"}),g("path",{d:"M17 12h2"}),g("path",{d:"M11 12h2"})]}),ce),nfe=W(N("g",{strokeWidth:"2",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 12v.01"}),g("path",{d:"M8 12v.01"}),g("path",{d:"M12 12v.01"}),g("path",{d:"M16 12v.01"}),g("path",{d:"M20 12v.01"})]}),ce),ife=W(g("path",{d:"M2.5 12.038c1.655-.885 5.9-3.292 8.568-4.354 2.668-1.063.101 2.821 1.32 3.104 1.218.283 5.112-1.814 5.112-1.814",strokeWidth:"1.25"}),He),rfe=W(g("path",{d:"M2.5 12.563c1.655-.886 5.9-3.293 8.568-4.355 2.668-1.062.101 2.822 1.32 3.105 1.218.283 5.112-1.814 5.112-1.814m-13.469 2.23c2.963-1.586 6.13-5.62 7.468-4.998 1.338.623-1.153 4.11-.132 5.595 1.02 1.487 6.133-1.43 6.133-1.43",strokeWidth:"1.25"}),He),sfe=W(g("path",{d:"M2.5 11.936c1.737-.879 8.627-5.346 10.42-5.268 1.795.078-.418 5.138.345 5.736.763.598 3.53-1.789 4.235-2.147M2.929 9.788c1.164-.519 5.47-3.28 6.987-3.114 1.519.165 1 3.827 2.121 4.109 1.122.281 3.839-2.016 4.606-2.42",strokeWidth:"1.25"}),He),ofe=W(N("svg",{strokeWidth:"1.5",children:[g("path",{d:"M3.33334 9.99998V6.66665C3.33334 6.04326 3.33403 4.9332 3.33539 3.33646C4.95233 3.33436 6.06276 3.33331 6.66668 3.33331H10"}),g("path",{d:"M13.3333 3.33331V3.34331"}),g("path",{d:"M16.6667 3.33331V3.34331"}),g("path",{d:"M16.6667 6.66669V6.67669"}),g("path",{d:"M16.6667 10V10.01"}),g("path",{d:"M3.33334 13.3333V13.3433"}),g("path",{d:"M16.6667 13.3333V13.3433"}),g("path",{d:"M3.33334 16.6667V16.6767"}),g("path",{d:"M6.66666 16.6667V16.6767"}),g("path",{d:"M10 16.6667V16.6767"}),g("path",{d:"M13.3333 16.6667V16.6767"}),g("path",{d:"M16.6667 16.6667V16.6767"})]}),He),afe=W(N("g",{strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 12v-4a4 4 0 0 1 4 -4h4"}),g("line",{x1:"16",y1:"4",x2:"16",y2:"4.01"}),g("line",{x1:"20",y1:"4",x2:"20",y2:"4.01"}),g("line",{x1:"20",y1:"8",x2:"20",y2:"8.01"}),g("line",{x1:"20",y1:"12",x2:"20",y2:"12.01"}),g("line",{x1:"4",y1:"16",x2:"4",y2:"16.01"}),g("line",{x1:"20",y1:"16",x2:"20",y2:"16.01"}),g("line",{x1:"4",y1:"20",x2:"4",y2:"20.01"}),g("line",{x1:"8",y1:"20",x2:"8",y2:"20.01"}),g("line",{x1:"12",y1:"20",x2:"12",y2:"20.01"}),g("line",{x1:"16",y1:"20",x2:"16",y2:"20.01"}),g("line",{x1:"20",y1:"20",x2:"20",y2:"20.01"})]}),ce),lfe=W(N("g",{stroke:"currentColor",opacity:.3,strokeWidth:2,children:[g("path",{d:"M12 12l9 0"}),g("path",{d:"M3 9l6 6"}),g("path",{d:"M3 15l6 -6"})]}),ce),av=de.memo(({flip:e=!1})=>W(N("g",{transform:e?"translate(40, 0) scale(-1, 1)":"",stroke:"currentColor",strokeWidth:2,fill:"none",children:[g("path",{d:"M34 10H6M34 10L27 5M34 10L27 15"}),g("path",{d:"M27.5 5L34.5 10L27.5 15"})]}),{width:40,height:20})),cfe=de.memo(({flip:e=!1})=>W(N("g",{stroke:"currentColor",fill:"currentColor",transform:e?"translate(40, 0) scale(-1, 1)":"",children:[g("path",{d:"M32 10L6 10",strokeWidth:2}),g("circle",{r:"4",transform:"matrix(-1 0 0 1 30 10)"})]}),{width:40,height:20})),dfe=de.memo(({flip:e=!1})=>W(N("g",{stroke:"currentColor",fill:"none",transform:e?"translate(40, 0) scale(-1, 1)":"",strokeWidth:2,children:[g("path",{d:"M26 10L6 10"}),g("circle",{r:"4",transform:"matrix(-1 0 0 1 30 10)"})]}),{width:40,height:20})),ufe=de.memo(({flip:e=!1})=>W(g("g",{transform:e?"translate(40, 0) scale(-1, 1)":"",children:g("path",{d:"M34 10H5.99996M34 10L34 5M34 10L34 15",stroke:"currentColor",strokeWidth:2,fill:"none"})}),{width:40,height:20})),ffe=de.memo(({flip:e=!1})=>W(N("g",{stroke:"currentColor",fill:"currentColor",transform:e?"translate(40, 0) scale(-1, 1)":"",children:[g("path",{d:"M32 10L6 10",strokeWidth:2}),g("path",{d:"M27.5 5.5L34.5 10L27.5 14.5L27.5 5.5"})]}),{width:40,height:20})),hfe=de.memo(({flip:e=!1})=>W(N("g",{stroke:"currentColor",fill:"none",transform:e?"translate(40, 0) scale(-1, 1)":"",strokeWidth:2,strokeLinejoin:"round",children:[g("path",{d:"M6,9.5H27"}),g("path",{d:"M27,5L34,10L27,14Z",fill:"none"})]}),{width:40,height:20})),gfe=de.memo(({flip:e=!1})=>W(N("g",{stroke:"currentColor",fill:"currentColor",transform:e?"translate(40, 0) scale(-1, 1)":"",strokeLinejoin:"round",strokeWidth:2,children:[g("path",{d:"M6,9.5H20"}),g("path",{d:"M27,5L34,10L27,14L20,9.5Z"})]}),{width:40,height:20})),mfe=de.memo(({flip:e=!1})=>W(N("g",{stroke:"currentColor",fill:"none",transform:e?"translate(40, 0) scale(-1, 1)":"",strokeLinejoin:"round",strokeWidth:2,children:[g("path",{d:"M6,9.5H20"}),g("path",{d:"M27,5L34,10L27,14L20,9.5Z"})]}),{width:40,height:20})),pfe=de.memo(({flip:e=!1})=>W(g("g",{stroke:"currentColor",fill:"none",transform:e?"":"translate(40, 0) scale(-1, 1)",strokeLinejoin:"round",strokeWidth:2,children:g("path",{d:"M34,10 H6 M15,10 L7,5 M15,10 L7,15"})}),{width:40,height:20})),Ufe=de.memo(({flip:e=!1})=>W(g("g",{stroke:"currentColor",fill:"none",transform:e?"":"translate(40, 0) scale(-1, 1)",strokeLinejoin:"round",strokeWidth:2,children:g("path",{d:"M34,10 H6 M15,10 L15,15 L15,5"})}),{width:40,height:20})),bfe=de.memo(({flip:e=!1})=>W(g("g",{stroke:"currentColor",fill:"none",transform:e?"":"translate(40, 0) scale(-1, 1)",strokeLinejoin:"round",strokeWidth:2,children:g("path",{d:"M34,10 H6 M15,10 L15,16 L15,4 M15,10 L7,5 M15,10 L7,15"})}),{width:40,height:20})),yfe=W(N(fe,{children:[g("g",{clipPath:"url(#a)",children:g("path",{d:"M14.167 6.667a3.333 3.333 0 0 0-3.334-3.334H9.167a3.333 3.333 0 0 0 0 6.667h1.666a3.333 3.333 0 0 1 0 6.667H9.167a3.333 3.333 0 0 1-3.334-3.334",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),He),Efe=W(N(fe,{children:[g("g",{clipPath:"url(#a)",children:g("path",{d:"M5 16.667V3.333L10 15l5-11.667v13.334",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),He),vfe=W(N(fe,{children:[g("g",{clipPath:"url(#a)",children:g("path",{d:"M5.833 3.333v13.334h8.334",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),He),wfe=W(g(fe,{children:g("path",{d:"m1.667 3.333 6.666 13.334M8.333 3.333 1.667 16.667M11.667 3.333v13.334h6.666",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),He),vy=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 7v-2h13v2"}),g("path",{d:"M10 5v14"}),g("path",{d:"M12 19h-4"}),g("path",{d:"M15 13v-1h6v1"}),g("path",{d:"M18 12v7"}),g("path",{d:"M17 19h2"})]}),ce),_fe=W(g(fe,{children:N("g",{stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M7 12h10"}),g("path",{d:"M7 5v14"}),g("path",{d:"M17 5v14"}),g("path",{d:"M15 19h4"}),g("path",{d:"M15 5h4"}),g("path",{d:"M5 19h4"}),g("path",{d:"M5 5h4"})]})}),ce),lv=W(g(fe,{children:g("g",{stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:g("path",{d:"M5.833 16.667v-10a3.333 3.333 0 0 1 3.334-3.334h1.666a3.333 3.333 0 0 1 3.334 3.334v10M5.833 10.833h8.334"})})}),He),VV=W(N(fe,{children:[g("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:g("path",{d:"M5.833 6.667 2.5 10l3.333 3.333M14.167 6.667 17.5 10l-3.333 3.333M11.667 3.333 8.333 16.667"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),He),Tfe=W(N("g",{stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"8",x2:"20",y2:"8"}),g("line",{x1:"4",y1:"12",x2:"12",y2:"12"}),g("line",{x1:"4",y1:"16",x2:"16",y2:"16"})]}),ce),Ife=W(N("g",{stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"8",x2:"20",y2:"8"}),g("line",{x1:"8",y1:"12",x2:"16",y2:"12"}),g("line",{x1:"6",y1:"16",x2:"18",y2:"16"})]}),ce),Sfe=W(N("g",{stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"8",x2:"20",y2:"8"}),g("line",{x1:"10",y1:"12",x2:"20",y2:"12"}),g("line",{x1:"8",y1:"16",x2:"20",y2:"16"})]}),ce),xfe=de.memo(({theme:e})=>W(N("g",{strokeWidth:"1.5",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"4",x2:"20",y2:"4"}),g("rect",{x:"9",y:"8",width:"6",height:"12",rx:"2"})]}),ce)),Cfe=de.memo(({theme:e})=>W(N("g",{strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"20",x2:"20",y2:"20"}),g("rect",{x:"9",y:"4",width:"6",height:"12",rx:"2"})]}),ce)),Afe=de.memo(({theme:e})=>W(N("g",{strokeWidth:"1.5",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"12",x2:"9",y2:"12"}),g("line",{x1:"15",y1:"12",x2:"20",y2:"12"}),g("rect",{x:"9",y:"6",width:"6",height:"12",rx:"2"})]}),ce)),$V=W(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M21 19h-18l9 -15"}),g("path",{d:"M20.615 15.171h.015"}),g("path",{d:"M19.515 11.771h.015"}),g("path",{d:"M17.715 8.671h.015"}),g("path",{d:"M15.415 5.971h.015"})]}),ce),Mfe=W(g("path",{d:"M537.6 226.6c4.1-10.7 6.4-22.4 6.4-34.6 0-53-43-96-96-96-19.7 0-38.1 6-53.3 16.2C367 64.2 315.3 32 256 32c-88.4 0-160 71.6-160 160 0 2.7.1 5.4.2 8.1C40.2 219.8 0 273.2 0 336c0 79.5 64.5 144 144 144h368c70.7 0 128-57.3 128-128 0-61.9-44-113.6-102.4-125.4zM393.4 288H328v112c0 8.8-7.2 16-16 16h-48c-8.8 0-16-7.2-16-16V288h-65.4c-14.3 0-21.4-17.2-11.3-27.3l105.4-105.4c6.2-6.2 16.4-6.2 22.6 0l105.4 105.4c10.1 10.1 2.9 27.3-11.3 27.3z",fill:"currentColor"}),{width:640,height:512});W(g("path",{d:"M480 416C497.7 416 512 430.3 512 448C512 465.7 497.7 480 480 480H150.6C133.7 480 117.4 473.3 105.4 461.3L25.37 381.3C.3786 356.3 .3786 315.7 25.37 290.7L258.7 57.37C283.7 32.38 324.3 32.38 349.3 57.37L486.6 194.7C511.6 219.7 511.6 260.3 486.6 285.3L355.9 416H480zM265.4 416L332.7 348.7L195.3 211.3L70.63 336L150.6 416L265.4 416z"}));const GV=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 13v-7.5a1.5 1.5 0 0 1 3 0v6.5"}),g("path",{d:"M11 5.5v-2a1.5 1.5 0 1 1 3 0v8.5"}),g("path",{d:"M14 5.5a1.5 1.5 0 0 1 3 0v6.5"}),g("path",{d:"M17 7.5a1.5 1.5 0 0 1 3 0v8.5a6 6 0 0 1 -6 6h-2h.208a6 6 0 0 1 -5.012 -2.7a69.74 69.74 0 0 1 -.196 -.3c-.312 -.479 -1.407 -2.388 -3.286 -5.728a1.5 1.5 0 0 1 .536 -2.022a1.867 1.867 0 0 1 2.28 .28l1.47 1.47"})]}),ce),dk=W(N(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2"}),g("path",{d:"M7 11l5 5l5 -5"}),g("path",{d:"M12 4l0 12"})]}),ce),Np=W(N(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"}),g("path",{d:"M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"})]}),ce),kfe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M7 17m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"}),g("path",{d:"M17 17m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"}),g("path",{d:"M9.15 14.85l8.85 -10.85"}),g("path",{d:"M6 4l8.85 10.85"})]}),ce),Rfe=W(N(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"}),g("path",{d:"M12 17l0 .01"}),g("path",{d:"M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4"})]}),ce),Dfe=W(N(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M7 4v16l13 -8z"})]}),ce),Lfe=W(N(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M17 4h-10a3 3 0 0 0 -3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3 -3v-10a3 3 0 0 0 -3 -3z",strokeWidth:"0",fill:"currentColor"})]}),ce),Nfe=W(N(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 12l5 5l10 -10"})]}),ce),Ofe=W(N(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10.24 3.957l-8.422 14.06a1.989 1.989 0 0 0 1.7 2.983h16.845a1.989 1.989 0 0 0 1.7 -2.983l-8.423 -14.06a1.989 1.989 0 0 0 -3.4 0z"}),g("path",{d:"M12 9v4"}),g("path",{d:"M12 17h.01"})]}),ce),Pfe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M11 7l6 6"}),g("path",{d:"M4 16l11.7 -11.7a1 1 0 0 1 1.4 0l2.6 2.6a1 1 0 0 1 0 1.4l-11.7 11.7h-4v-4z"})]}),ce),cv=W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 3l-4 7h8z"}),g("path",{d:"M17 17m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"}),g("path",{d:"M4 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z"})]}),ce),nu=W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 7l16 0"}),g("path",{d:"M4 17l16 0"}),g("path",{d:"M7 4l0 16"}),g("path",{d:"M17 4l0 16"})]}),ce),J9=W(g("path",{fill:"currentColor",d:"M407.48,111.18C335.587,108.103 269.573,152.338 245.08,220C220.587,152.338 154.573,108.103 82.68,111.18C80.285,168.229 107.577,222.632 154.74,254.82C178.908,271.419 193.35,298.951 193.27,328.27L193.27,379.13L296.9,379.13L296.9,328.27C296.816,298.953 311.255,271.42 335.42,254.82C382.596,222.644 409.892,168.233 407.48,111.18Z"})),Y2=W(N("g",{strokeWidth:"1.25",children:[g("path",{d:"M4.16602 10H15.8327"}),g("path",{d:"M12.5 13.3333L15.8333 10"}),g("path",{d:"M12.5 6.66666L15.8333 9.99999"})]}),He),_m=W(N("g",{fill:"none",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",transform:"rotate(90 10 10)",children:[g("path",{clipRule:"evenodd",d:"m9.644 13.69 7.774-7.773a2.357 2.357 0 0 0-3.334-3.334l-7.773 7.774L8 12l1.643 1.69Z"}),g("path",{d:"m13.25 3.417 3.333 3.333M10 10l2-2M5 15l3-3M2.156 17.894l1-1M5.453 19.029l-.144-1.407M2.377 11.887l.866 1.118M8.354 17.273l-1.194-.758M.953 14.652l1.408.13"})]}),20),O6=W(N("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z"}),g("path",{d:"M6 21l15 -15l-3 -3l-15 15l3 3"}),g("path",{d:"M15 6l3 3"}),g("path",{d:"M9 3a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"}),g("path",{d:"M19 13a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"})]}),ce);W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z"}),g("path",{d:"M6 21l15 -15l-3 -3l-15 15l3 3"}),g("path",{d:"M15 6l3 3"}),g("path",{d:"M9 3a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"}),g("path",{d:"M19 13a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"})]}),ce);W(N("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M11.217 19.384a3.501 3.501 0 0 0 6.783 -1.217v-5.167l-6 -3.35"}),g("path",{d:"M5.214 15.014a3.501 3.501 0 0 0 4.446 5.266l4.34 -2.534v-6.946"}),g("path",{d:"M6 7.63c-1.391 -.236 -2.787 .395 -3.534 1.689a3.474 3.474 0 0 0 1.271 4.745l4.263 2.514l6 -3.348"}),g("path",{d:"M12.783 4.616a3.501 3.501 0 0 0 -6.783 1.217v5.067l6 3.45"}),g("path",{d:"M18.786 8.986a3.501 3.501 0 0 0 -4.446 -5.266l-4.34 2.534v6.946"}),g("path",{d:"M18 16.302c1.391 .236 2.787 -.395 3.534 -1.689a3.474 3.474 0 0 0 -1.271 -4.745l-4.308 -2.514l-5.955 3.42"})]}),ce);const Ffe=W(N("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 8v-2a2 2 0 0 1 2 -2h2"}),g("path",{d:"M4 16v2a2 2 0 0 0 2 2h2"}),g("path",{d:"M16 4h2a2 2 0 0 1 2 2v2"}),g("path",{d:"M16 20h2a2 2 0 0 0 2 -2v-2"})]}),ce),eT=W(N("g",{stroke:"currentColor",fill:"none",strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"}),g("path",{d:"M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6"})]}),ce),Bfe=W(N("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10.585 10.587a2 2 0 0 0 2.829 2.828"}),g("path",{d:"M16.681 16.673a8.717 8.717 0 0 1 -4.681 1.327c-3.6 0 -6.6 -2 -9 -6c1.272 -2.12 2.712 -3.678 4.32 -4.674m2.86 -1.146a9.055 9.055 0 0 1 1.82 -.18c3.6 0 6.6 2 9 6c-.666 1.11 -1.379 2.067 -2.138 2.87"}),g("path",{d:"M3 3l18 18"})]}),ce),zfe=W(N("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15.5 13a3.5 3.5 0 0 0 -3.5 3.5v1a3.5 3.5 0 0 0 7 0v-1.8"}),g("path",{d:"M8.5 13a3.5 3.5 0 0 1 3.5 3.5v1a3.5 3.5 0 0 1 -7 0v-1.8"}),g("path",{d:"M17.5 16a3.5 3.5 0 0 0 0 -7h-.5"}),g("path",{d:"M19 9.3v-2.8a3.5 3.5 0 0 0 -7 0"}),g("path",{d:"M6.5 16a3.5 3.5 0 0 1 0 -7h.5"}),g("path",{d:"M5 9.3v-2.8a3.5 3.5 0 0 1 7 0v10"})]}),ce),Hfe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15.5 13a3.5 3.5 0 0 0 -3.5 3.5v1a3.5 3.5 0 0 0 7 0v-1.8"}),g("path",{d:"M8.5 13a3.5 3.5 0 0 1 3.5 3.5v1a3.5 3.5 0 0 1 -7 0v-1.8"}),g("path",{d:"M17.5 16a3.5 3.5 0 0 0 0 -7h-.5"}),g("path",{d:"M19 9.3v-2.8a3.5 3.5 0 0 0 -7 0"}),g("path",{d:"M6.5 16a3.5 3.5 0 0 1 0 -7h.5"}),g("path",{d:"M5 9.3v-2.8a3.5 3.5 0 0 1 7 0v10"})]}),ce),Eu=W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0"}),g("path",{d:"M21 21l-6 -6"})]}),ce),Vfe=W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M20.984 12.53a9 9 0 1 0 -7.552 8.355"}),g("path",{d:"M12 7v5l3 3"}),g("path",{d:"M19 16l-2 3h4l-2 3"})]}),ce),$fe=W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M9 2m0 3a3 3 0 0 1 3 -3h0a3 3 0 0 1 3 3v5a3 3 0 0 1 -3 3h0a3 3 0 0 1 -3 -3z"}),g("path",{d:"M5 10a7 7 0 0 0 14 0"}),g("path",{d:"M8 21l8 0"}),g("path",{d:"M12 17l0 4"})]}),ce),Gfe=W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 3l18 18"}),g("path",{d:"M9 5a3 3 0 0 1 6 0v5a3 3 0 0 1 -.13 .874m-2 2a3 3 0 0 1 -3.87 -2.872v-1"}),g("path",{d:"M5 10a7 7 0 0 0 10.846 5.85m2 -2a6.967 6.967 0 0 0 1.152 -3.85"}),g("path",{d:"M8 21l8 0"}),g("path",{d:"M12 17l0 4"})]}),ce),dv=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M13 3l0 7l6 0l-8 11l0 -7l-6 0l8 -11"})]}),ce),Xfe=W(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 8m0 1a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1v6a1 1 0 0 1 -1 1h-6a1 1 0 0 1 -1 -1z"}),g("path",{d:"M12 20v.01"}),g("path",{d:"M16 20v.01"}),g("path",{d:"M8 20v.01"}),g("path",{d:"M4 20v.01"}),g("path",{d:"M4 16v.01"}),g("path",{d:"M4 12v.01"}),g("path",{d:"M4 8v.01"}),g("path",{d:"M4 4v.01"}),g("path",{d:"M8 4v.01"}),g("path",{d:"M12 4v.01"}),g("path",{d:"M16 4v.01"}),g("path",{d:"M20 4v.01"}),g("path",{d:"M20 8v.01"}),g("path",{d:"M20 12v.01"}),g("path",{d:"M20 16v.01"}),g("path",{d:"M20 20v.01"})]}),ce),jfe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 3v18"}),g("path",{d:"M19 21v-18"}),g("path",{d:"M5 7h14"}),g("path",{d:"M5 15h14"}),g("path",{d:"M8 13v4"}),g("path",{d:"M11 13v4"}),g("path",{d:"M16 13v4"}),g("path",{d:"M14 5v4"}),g("path",{d:"M11 5v4"}),g("path",{d:"M8 5v4"}),g("path",{d:"M3 21h18"})]}),ce),Yfe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 12l18 0"}),g("path",{d:"M7 16l10 0l-10 5l0 -5"}),g("path",{d:"M7 8l10 0l-10 -5l0 5"})]}),ce),Wfe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 3l0 18"}),g("path",{d:"M16 7l0 10l5 0l-5 -10"}),g("path",{d:"M8 7l0 10l-5 0l5 -10"})]}),ce),XV=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z"}),g("path",{d:"M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2"}),g("path",{d:"M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z"})]}),ce),tT=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15 15m-5 0a5 5 0 1 0 10 0a5 5 0 1 0 -10 0"}),g("path",{d:"M22 22l-3 -3"}),g("path",{d:"M6 18h-1a2 2 0 0 1 -2 -2v-1"}),g("path",{d:"M3 11v-1"}),g("path",{d:"M3 6v-1a2 2 0 0 1 2 -2h1"}),g("path",{d:"M10 3h1"}),g("path",{d:"M15 3h1a2 2 0 0 1 2 2v1"})]}),ce),Kfe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M14 3v4a1 1 0 0 0 1 1h4"}),g("path",{d:"M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"}),g("path",{d:"M4 20.25c0 .414 .336 .75 .75 .75h1.25a1 1 0 0 0 1 -1v-1a1 1 0 0 0 -1 -1h-1a1 1 0 0 1 -1 -1v-1a1 1 0 0 1 1 -1h1.25a.75 .75 0 0 1 .75 .75"}),g("path",{d:"M10 15l2 6l2 -6"}),g("path",{d:"M20 15h-1a2 2 0 0 0 -2 2v2a2 2 0 0 0 2 2h1v-3"})]}),ce),Zfe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M14 3v4a1 1 0 0 0 1 1h4"}),g("path",{d:"M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"}),g("path",{d:"M20 15h-1a2 2 0 0 0 -2 2v2a2 2 0 0 0 2 2h1v-3"}),g("path",{d:"M5 18h1.5a1.5 1.5 0 0 0 0 -3h-1.5v6"}),g("path",{d:"M11 21v-6l3 6v-6"})]}),ce),qfe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 13v-8a2 2 0 0 1 2 -2h1a2 2 0 0 1 2 2v8a2 2 0 0 0 6 0v-8a2 2 0 0 1 2 -2h1a2 2 0 0 1 2 2v8a8 8 0 0 1 -16 0"}),g("path",{d:"M4 8l5 0"}),g("path",{d:"M15 8l4 0"})]}),ce),Qfe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 14c.83 .642 2.077 1.017 3.5 1c1.423 .017 2.67 -.358 3.5 -1c.83 -.642 2.077 -1.017 3.5 -1c1.423 -.017 2.67 .358 3.5 1"}),g("path",{d:"M8 3a2.4 2.4 0 0 0 -1 2a2.4 2.4 0 0 0 1 2"}),g("path",{d:"M12 3a2.4 2.4 0 0 0 -1 2a2.4 2.4 0 0 0 1 2"}),g("path",{d:"M3 10h14v5a6 6 0 0 1 -6 6h-2a6 6 0 0 1 -6 -6v-5z"}),g("path",{d:"M16.746 16.726a3 3 0 1 0 .252 -5.555"})]}),ce),Jfe=W(N("g",{stroke:"currentColor",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 5a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1h-16a1 1 0 0 1-1-1v-10zM7 20h10M9 16v4M15 16v4"})]}),{...ce,strokeWidth:1.5}),jV=W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2"}),g("path",{d:"M21 12h-13l3 -3"}),g("path",{d:"M11 15l-3 -3"})]}),ce),YV=W(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M2 8a4 4 0 0 1 4 -4h12a4 4 0 0 1 4 4v8a4 4 0 0 1 -4 4h-12a4 4 0 0 1 -4 -4v-8z"}),g("path",{d:"M10 9l5 3l-5 3z"})]}),ce),ehe=W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 6h18"}),g("path",{d:"M3 12h18"}),g("path",{d:"M3 18h18"}),g("path",{d:"M6 3v18"}),g("path",{d:"M12 3v18"}),g("path",{d:"M18 3v18"})]}),ce),the=W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M17 3m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z"}),g("path",{d:"M3 17m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z"}),g("path",{d:"M17 5c-6.627 0 -12 5.373 -12 12"})]}),ce),nT=W(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 18l12 -12"}),g("path",{d:"M18 10v-4h-4"})]}),ce),iT=W(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4,19L10,19C11.097,19 12,18.097 12,17L12,9C12,7.903 12.903,7 14,7L21,7"}),g("path",{d:"M18 4l3 3l-3 3"})]}),ce),rT=W(N("g",{children:[g("path",{d:"M16,12L20,9L16,6"}),g("path",{d:"M6 20c0 -6.075 4.925 -11 11 -11h3"})]}),ce),WV=W(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 9l6 6l6 -6"})]}),ce),nhe=W(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 15l6 -6l6 6"})]}),ce),ihe=W(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 15l6 -6l6 6"})]}),ce),uk=W(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 5v10a1 1 0 0 0 1 1h10"}),g("path",{d:"M5 8h10a1 1 0 0 1 1 1v10"})]}),ce),KV=W(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M19 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M5 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M19 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M5 7l0 10"}),g("path",{d:"M7 5l10 0"}),g("path",{d:"M7 19l10 0"}),g("path",{d:"M19 7l0 10"})]}),ce);W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 11v8a1 1 0 0 0 1 1h8m-9 -14v-1a1 1 0 0 1 1 -1h1m5 0h2m5 0h1a1 1 0 0 1 1 1v1m0 5v2m0 5v1a1 1 0 0 1 -1 1h-1"}),g("path",{d:"M4 12h7a1 1 0 0 1 1 1v7"})]}),ce);const rhe=W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M14 6m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M4 6l8 0"}),g("path",{d:"M16 6l4 0"}),g("path",{d:"M8 12m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M4 12l2 0"}),g("path",{d:"M10 12l10 0"}),g("path",{d:"M17 18m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M4 18l11 0"}),g("path",{d:"M19 18l1 0"})]}),ce),she=W(N("g",{strokeWidth:1,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 10l4 -4 L6 14l8 -8 L6 18l12 -12 L10 18l8 -8 L14 18l4 -4"})]}),ce),ohe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4"}),g("path",{d:"M13.5 6.5l4 4"})]}),ce);W(N("g",{strokeWidth:1,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M11 7l-5 5l5 5"}),g("path",{d:"M17 7l-5 5l5 5"})]}),ce);const ahe=W(N("g",{strokeWidth:"1.75",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z"}),g("path",{d:"M15 4l0 16"})]}),ce),lhe=W(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 20l1.3 -3.9c-2.324 -3.437 -1.426 -7.872 2.1 -10.374c3.526 -2.501 8.59 -2.296 11.845 .48c3.255 2.777 3.695 7.266 1.029 10.501c-2.666 3.235 -7.615 4.215 -11.574 2.293l-4.7 1"})]}),ce),che=W(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 4l18 0"}),g("path",{d:"M4 4v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-10"}),g("path",{d:"M12 16l0 4"}),g("path",{d:"M9 20l6 0"}),g("path",{d:"M8 12l3 -3l2 2l3 -3"})]}),ce);class dhe extends Error{constructor(t="Couldn't export canvas.",n="CANVAS_ERROR"){super(),this.name=n,this.message=t}}class Kh extends DOMException{constructor(t="Request Aborted"){super(t,"AbortError")}}class Fd extends Error{constructor(n="Image Scene Data Error",i="IMAGE_SCENE_DATA_ERROR"){super(n);F(this,"code");this.name="EncodingError",this.code=i}}class ZV extends Error{constructor(n="Worker URL is not defined!",i="WORKER_URL_NOT_DEFINED"){super(n);F(this,"code");this.name="WorkerUrlNotDefinedError",this.code=i}}class qV extends Error{constructor(n="Worker has to be in a separate chunk!",i="WORKER_IN_THE_MAIN_CHUNK"){super(n);F(this,"code");this.name="WorkerInTheMainChunkError",this.code=i}}class io extends Error{constructor(t){super(t),this.name="ExcalidrawError"}}const hl=({size:e="1em",circleWidth:t=8,synchronized:n=!1,className:i=""})=>{const s=-(de.useRef(Date.now()).current%1600);return g("div",{className:`Spinner ${i}`,children:g("svg",{viewBox:"0 0 100 100",style:{width:e,height:e,"--spinner-delay":n?`${s}ms`:0},children:g("circle",{cx:"50",cy:"50",r:50-t/2,strokeWidth:t,fill:"none",strokeMiterlimit:"10"})})})},je=de.forwardRef(({size:e="medium",visible:t=!0,className:n="",...i},r)=>{const{id:s}=Dr(),o=de.useRef(null);de.useImperativeHandle(r,()=>o.current);const a=`ToolIcon_size_${e}`,[l,c]=R.useState(!1),d=R.useRef(!0),u=async h=>{var p;const m="onClick"in i&&((p=i.onClick)==null?void 0:p.call(i,h));if(_p(m))try{c(!0),await m}catch(U){if(U instanceof Kh)console.warn(U);else throw U}finally{d.current&&c(!1)}};R.useEffect(()=>(d.current=!0,()=>{d.current=!1}),[]);const f=R.useRef(null);if(i.type==="button"||i.type==="icon"||i.type==="submit"){const h=i.type==="icon"?"button":i.type;return N("button",{className:le("ToolIcon_type_button",a,n,t&&!i.hidden?"ToolIcon_type_button--show":"ToolIcon_type_button--hide",{ToolIcon:!i.hidden,"ToolIcon--selected":i.selected,"ToolIcon--plain":i.type==="icon"}),style:i.style,"data-testid":i["data-testid"],hidden:i.hidden,title:i.title,"aria-label":i["aria-label"],type:h,onClick:u,ref:o,disabled:l||i.isLoading||!!i.disabled,children:[(i.icon||i.label)&&N("div",{className:"ToolIcon__icon","aria-hidden":"true","aria-disabled":!!i.disabled,children:[i.icon||i.label,i.keyBindingLabel&&g("span",{className:"ToolIcon__keybinding",children:i.keyBindingLabel}),i.isLoading&&g(hl,{})]}),i.showAriaLabel&&N("div",{className:"ToolIcon__label",children:[i["aria-label"]," ",l&&g(hl,{})]}),i.children]})}return N("label",{className:le("ToolIcon",n),title:i.title,onPointerDown:h=>{var m;f.current=h.pointerType||null,(m=i.onPointerDown)==null||m.call(i,{pointerType:h.pointerType||null})},onPointerUp:()=>{requestAnimationFrame(()=>{f.current=null})},children:[g("input",{className:`ToolIcon_type_radio ${a}`,type:"radio",name:i.name,"aria-label":i["aria-label"],"aria-keyshortcuts":i["aria-keyshortcuts"],"data-testid":i["data-testid"],id:`${s}-${i.id}`,onChange:()=>{var h;(h=i.onChange)==null||h.call(i,{pointerType:f.current})},checked:i.checked,ref:o}),N("div",{className:"ToolIcon__icon",children:[i.icon,i.keyBindingLabel&&g("span",{className:"ToolIcon__keybinding",children:i.keyBindingLabel})]})]})});je.displayName="ToolButton";let uv=[];const ue=e=>(uv=uv.concat(e),e),uhe=(e,t,n)=>{const i=new Set(Xe(e.filter(d=>we(d)),t).map(d=>d.id)),r={},s=n.scene.getNonDeletedElementsMap(),o=new Set;for(const d of i){const u=ns(e,d);for(const f of u)if(!o.has(f.id)){if(Dt(f)){const h=Yn(f,s);h&&(r[h.id]=!0)}else r[f.id]=!0;o.add(f.id)}}let a=!0;const l=e.map(d=>{if(t.selectedElementIds[d.id]){const u=Dt(d)?Yn(d,s):null;return d.frameId&&i.has(d.frameId)?(a=!1,r[d.id]=!0,d):u!=null&&u.frameId&&i.has(u==null?void 0:u.frameId)?d:(d.boundElements&&d.boundElements.forEach(f=>{var m,p;const h=n.scene.getNonDeletedElementsMap().get(f.id);h&&me(h)&&n.scene.mutateElement(h,{startBinding:d.id===((m=h.startBinding)==null?void 0:m.elementId)?null:h.startBinding,endBinding:d.id===((p=h.endBinding)==null?void 0:p.elementId)?null:h.endBinding})}),Ie(d,{isDeleted:!0}))}return d.frameId&&i.has(d.frameId)?(a=!1,Dt(d)||(r[d.id]=!0),Ie(d,{frameId:null})):Dt(d)&&t.selectedElementIds[d.containerId]?Ie(d,{isDeleted:!0}):d});let c=t.editingGroupId;if(a&&t.editingGroupId){const d=At(l,t.editingGroupId).filter(u=>!u.isDeleted);if(d.length>1)d[0]&&(r[d[0].id]=!0);else{c=null,d[0]&&(r[d[0].id]=!0);const u=d[0];if(u){const f=u.groupIds.findIndex(m=>m===t.editingGroupId),h=u.groupIds[f+1];if(h){const m=At(l,h).filter(p=>!p.isDeleted);m.length>1&&(c=h,m.forEach(p=>{r[p.id]=!0}))}}}}return{elements:l,appState:{...t,...Si({selectedElementIds:r,editingGroupId:c},l,t,null)}}},fk=(e,t)=>{if(e.editingGroupId){const n=At(Yt(t),e.editingGroupId);if(n.length)return{...e,selectedElementIds:{[n[0].id]:!0}}}return e},QV=ue({name:"deleteSelectedElements",label:"labels.delete",icon:Xc,trackEvent:{category:"element",action:"delete"},perform:(e,t,n,i)=>{var o;if((o=t.selectedLinearElement)!=null&&o.isEditing){const{elementId:a,selectedPointsIndices:l,startBindingElement:c,endBindingElement:d}=t.selectedLinearElement,u=i.scene.getNonDeletedElementsMap(),f=pe.getElement(a,u);if(!f||l==null)return!1;if(l.length>=f.points.length){const m=e.map(U=>U.id===f.id?Ie(U,{isDeleted:!0}):U),p=fk(t,m);return{elements:m,appState:{...p,selectedLinearElement:null},captureUpdate:Z.IMMEDIATELY}}const h={startBindingElement:l!=null&&l.includes(0)?null:c,endBindingElement:l!=null&&l.includes(f.points.length-1)?null:d};return pe.deletePoints(f,i,l),{elements:e,appState:{...t,selectedLinearElement:{...t.selectedLinearElement,...h,selectedPointsIndices:(l==null?void 0:l[0])>0?[l[0]-1]:[0]}},captureUpdate:Z.IMMEDIATELY}}let{elements:r,appState:s}=uhe(e,t,i);return kz(r,r.filter(a=>a.isDeleted)),s=fk(s,r),{elements:r,appState:{...s,activeTool:tn(t,{type:i.state.preferredSelectionTool.type}),multiElement:null,activeEmbeddable:null,selectedLinearElement:null},captureUpdate:Wn(Yt(e),t)?Z.IMMEDIATELY:Z.EVENTUALLY}},keyTest:(e,t,n)=>(e.key===V.BACKSPACE||e.key===V.DELETE)&&!e[V.CTRL_OR_CMD],PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>{const r=fa()==="mobile";return g(je,{type:"button",icon:Xc,title:M("labels.delete"),"aria-label":M("labels.delete"),onClick:()=>n(null),disabled:!Wn(Yt(e),t),style:{...r&&t.openPopup!=="compactOtherProperties"?bp:{}}})}}),J=e=>e.replace(/\b(Opt(?:ion)?|Alt)\b/i,M(co?"keys.option":"keys.alt")).replace(/\bShift\b/i,M("keys.shift")).replace(/\b(Enter|Return)\b/i,M("keys.enter")).replace(/\b(Ctrl|Cmd|Command|CtrlOrCmd)\b/gi,M(co?"keys.cmd":"keys.ctrl")).replace(/\b(Esc(?:ape)?)\b/i,M("keys.escape")).replace(/\b(Space(?:bar)?)\b/i,M("keys.spacebar")).replace(/\b(Del(?:ete)?)\b/i,M("keys.delete")),fhe=ue({name:"sendBackward",label:"labels.sendBackward",keywords:["move down","zindex","layer"],icon:JM,trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:Zde(e,t,i.scene),appState:t,captureUpdate:Z.IMMEDIATELY}),keyPriority:40,keyTest:e=>e[V.CTRL_OR_CMD]&&!e.shiftKey&&e.code===it.BRACKET_LEFT,PanelComponent:({updateData:e,appState:t})=>g("button",{type:"button",className:"zIndexButton",onClick:()=>e(null),title:`${M("labels.sendBackward")}  ${J("CtrlOrCmd+[")}`,children:JM})}),hhe=ue({name:"bringForward",label:"labels.bringForward",keywords:["move up","zindex","layer"],icon:QM,trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:qde(e,t,i.scene),appState:t,captureUpdate:Z.IMMEDIATELY}),keyPriority:40,keyTest:e=>e[V.CTRL_OR_CMD]&&!e.shiftKey&&e.code===it.BRACKET_RIGHT,PanelComponent:({updateData:e,appState:t})=>g("button",{type:"button",className:"zIndexButton",onClick:()=>e(null),title:`${M("labels.bringForward")}  ${J("CtrlOrCmd+]")}`,children:QM})}),ghe=ue({name:"sendToBack",label:"labels.sendToBack",keywords:["move down","zindex","layer"],icon:tk,trackEvent:{category:"element"},perform:(e,t)=>({elements:Qde(e,t),appState:t,captureUpdate:Z.IMMEDIATELY}),keyTest:e=>co?e[V.CTRL_OR_CMD]&&e.altKey&&e.code===it.BRACKET_LEFT:e[V.CTRL_OR_CMD]&&e.shiftKey&&e.code===it.BRACKET_LEFT,PanelComponent:({updateData:e,appState:t})=>g("button",{type:"button",className:"zIndexButton",onClick:()=>e(null),title:`${M("labels.sendToBack")}  ${J(co?"CtrlOrCmd+Alt+[":"CtrlOrCmd+Shift+[")}`,children:tk})}),mhe=ue({name:"bringToFront",label:"labels.bringToFront",keywords:["move up","zindex","layer"],icon:ek,trackEvent:{category:"element"},perform:(e,t)=>({elements:Jde(e,t),appState:t,captureUpdate:Z.IMMEDIATELY}),keyTest:e=>co?e[V.CTRL_OR_CMD]&&e.altKey&&e.code===it.BRACKET_RIGHT:e[V.CTRL_OR_CMD]&&e.shiftKey&&e.code===it.BRACKET_RIGHT,PanelComponent:({updateData:e,appState:t})=>g("button",{type:"button",className:"zIndexButton",onClick:n=>e(null),title:`${M("labels.bringToFront")}  ${J(co?"CtrlOrCmd+Alt+]":"CtrlOrCmd+Shift+]")}`,children:ek})}),phe=ue({name:"selectAll",label:"labels.selectAll",icon:Xfe,trackEvent:{category:"canvas"},viewMode:!1,perform:(e,t,n,i)=>{var s;if((s=t.selectedLinearElement)!=null&&s.isEditing)return!1;const r=e.filter(o=>!o.isDeleted&&!(ge(o)&&o.containerId)&&!o.locked).reduce((o,a)=>(o[a.id]=!0,o),{});return{appState:{...t,...Si({editingGroupId:null,selectedElementIds:r},Yt(e),t,i),selectedLinearElement:Object.keys(r).length===1&&xe(e[0])?new pe(e[0],ve(e)):null},captureUpdate:Z.IMMEDIATELY}},keyTest:e=>e[V.CTRL_OR_CMD]&&e.key===V.A}),Uhe=ue({name:"duplicateSelection",label:"labels.duplicateSelection",icon:rv,trackEvent:{category:"element"},perform:(e,t,n,i)=>{var o;if(t.selectedElementsAreBeingDragged)return!1;if((o=t.selectedLinearElement)!=null&&o.isEditing)try{const a=pe.duplicateSelectedPoints(t,i.scene);return{elements:e,appState:a,captureUpdate:Z.IMMEDIATELY}}catch{return!1}let{duplicatedElements:r,elementsWithDuplicates:s}=S0({type:"in-place",elements:e,idsOfElementsToDuplicate:ve(Xe(e,t,{includeBoundTextElement:!0,includeElementsInFrames:!0})),appState:t,randomizeSeed:!0,overrides:({origElement:a,origIdToDuplicateId:l})=>{const c=a.frameId&&l.get(a.frameId);return{x:a.x+qb/2,y:a.y+qb/2,frameId:c??a.frameId}}});if(i.props.onDuplicate&&s){const a=i.props.onDuplicate(s,e);a&&(s=a)}return{elements:uo(s,ve(r)),appState:{...t,...Pz(r,Yt(s),t)},captureUpdate:Z.IMMEDIATELY}},keyTest:e=>e[V.CTRL_OR_CMD]&&e.key===V.D,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>{const r=fa()==="mobile";return g(je,{type:"button",icon:rv,title:`${M("labels.duplicateSelection")}  ${J("CtrlOrCmd+D")}`,"aria-label":M("labels.duplicateSelection"),onClick:()=>n(null),disabled:!Wn(Yt(e),t),style:{...r&&t.openPopup!=="compactOtherProperties"?bp:{}}})}});var bhe={VITE_APP_BACKEND_V2_GET_URL:"https://json.excalidraw.com/api/v2/",VITE_APP_BACKEND_V2_POST_URL:"https://json.excalidraw.com/api/v2/post/",VITE_APP_LIBRARY_URL:"https://libraries.excalidraw.com",VITE_APP_LIBRARY_BACKEND:"https://us-central1-excalidraw-room-persistence.cloudfunctions.net/libraries",VITE_APP_PLUS_LP:"https://plus.excalidraw.com",VITE_APP_PLUS_APP:"https://app.excalidraw.com",VITE_APP_AI_BACKEND:"https://oss-ai.excalidraw.com",VITE_APP_WS_SERVER_URL:"https://oss-collab.excalidraw.com",VITE_APP_FIREBASE_CONFIG:'{"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}',VITE_APP_ENABLE_TRACKING:"true",VITE_APP_PLUS_EXPORT_PUBLIC_KEY:`MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApQ0jM9Qz8TdFLzcuAZZX
/WvuKSOJxiw6AR/ZcE3eFQWM/mbFdhQgyK8eHGkKQifKzH1xUZjCxyXcxW6ZO02t
kPOPxhz+nxUrIoWCD/V4NGmUA1lxwHuO21HN1gzKrN3xHg5EGjyouR9vibT9VDGF
gq6+4Ic/kJX+AD2MM7Yre2+FsOdysrmuW2Fu3ahuC1uQE7pOe1j0k7auNP0y1q53
PrB8Ts2LUpepWC1l7zIXFm4ViDULuyWXTEpUcHSsEH8vpd1tckjypxCwkipfZsXx
iPszy0o0Dx2iArPfWMXlFAI9mvyFCyFC3+nSvfyAUb2C4uZgCwAuyFh/ydPF4DEE
PQIDAQAB`,VITE_APP_DEBUG_ENABLE_TEXT_CONTAINER_BOUNDING_BOX:"false",VITE_APP_COLLAPSE_OVERLAY:"false",VITE_APP_ENABLE_ESLINT:"false",VITE_APP_GIT_SHA:"",BASE_URL:"/excalidraw/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const yhe=new Set(["command_palette","export"]),et=(e,t,n,i)=>{try{if(typeof window>"u"||bhe.VITE_WORKER_ID||!yhe.has(e))return;K_(),window.sa_event&&window.sa_event(t,{category:e,label:n,value:i})}catch(r){console.error("error during analytics",r)}},sT=R.forwardRef((e,t)=>{const{title:n,className:i,testId:r,active:s,standalone:o,icon:a,onClick:l}=e;return g("button",{type:"button",ref:t,title:n,"data-testid":r,className:le(i,{standalone:o,active:s}),onClick:l,style:e.style,children:a},n)}),da=e=>g(fe,{children:e.options.map(t=>e.type==="button"?g(sT,{icon:t.icon,title:t.text,testId:t.testId,active:t.active??e.value===t.value,onClick:n=>e.onClick(t.value,n)},t.text):N("label",{className:le({active:e.value===t.value}),title:t.text,children:[g("input",{type:"radio",name:e.group,onChange:()=>e.onChange(t.value),checked:e.value===t.value,"data-testid":t.testId}),t.icon]},t.text))});function Di(e,t,{checkForDefaultPrevented:n=!0}={}){return function(r){if(e==null||e(r),n===!1||!r.defaultPrevented)return t==null?void 0:t(r)}}function hk(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function JV(...e){return t=>{let n=!1;const i=e.map(r=>{const s=hk(r,t);return!n&&typeof s=="function"&&(n=!0),s});if(n)return()=>{for(let r=0;r<i.length;r++){const s=i[r];typeof s=="function"?s():hk(e[r],null)}}}}function ho(...e){return R.useCallback(JV(...e),e)}function Op(e,t=[]){let n=[];function i(s,o){const a=R.createContext(o),l=n.length;n=[...n,o];const c=u=>{var b;const{scope:f,children:h,...m}=u,p=((b=f==null?void 0:f[e])==null?void 0:b[l])||a,U=R.useMemo(()=>m,Object.values(m));return g(p.Provider,{value:U,children:h})};c.displayName=s+"Provider";function d(u,f){var p;const h=((p=f==null?void 0:f[e])==null?void 0:p[l])||a,m=R.useContext(h);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${u}\` must be used within \`${s}\``)}return[c,d]}const r=()=>{const s=n.map(o=>R.createContext(o));return function(a){const l=(a==null?void 0:a[e])||s;return R.useMemo(()=>({[`__scope${e}`]:{...a,[e]:l}}),[a,l])}};return r.scopeName=e,[i,Ehe(r,...t)]}function Ehe(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const i=e.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(s){const o=i.reduce((a,{useScope:l,scopeName:c})=>{const u=l(s)[`__scope${c}`];return{...a,...u}},{});return R.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}var Tm=R.forwardRef((e,t)=>{const{children:n,...i}=e,r=R.Children.toArray(n),s=r.find(whe);if(s){const o=s.props.children,a=r.map(l=>l===s?R.Children.count(o)>1?R.Children.only(null):R.isValidElement(o)?o.props.children:null:l);return g(fv,{...i,ref:t,children:R.isValidElement(o)?R.cloneElement(o,void 0,a):null})}return g(fv,{...i,ref:t,children:n})});Tm.displayName="Slot";var fv=R.forwardRef((e,t)=>{const{children:n,...i}=e;if(R.isValidElement(n)){const r=The(n),s=_he(i,n.props);return n.type!==R.Fragment&&(s.ref=t?JV(t,r):r),R.cloneElement(n,s)}return R.Children.count(n)>1?R.Children.only(null):null});fv.displayName="SlotClone";var vhe=({children:e})=>g(fe,{children:e});function whe(e){return R.isValidElement(e)&&e.type===vhe}function _he(e,t){const n={...t};for(const i in t){const r=e[i],s=t[i];/^on[A-Z]/.test(i)?r&&s?n[i]=(...a)=>{s(...a),r(...a)}:r&&(n[i]=r):i==="style"?n[i]={...r,...s}:i==="className"&&(n[i]=[r,s].filter(Boolean).join(" "))}return{...e,...n}}function The(e){var i,r;let t=(i=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(r=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Ihe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],br=Ihe.reduce((e,t)=>{const n=R.forwardRef((i,r)=>{const{asChild:s,...o}=i,a=s?Tm:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),g(a,{...o,ref:r})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function She(e,t){e&&mi.flushSync(()=>e.dispatchEvent(t))}function gl(e){const t=R.useRef(e);return R.useEffect(()=>{t.current=e}),R.useMemo(()=>(...n)=>{var i;return(i=t.current)==null?void 0:i.call(t,...n)},[])}function xhe(e,t=globalThis==null?void 0:globalThis.document){const n=gl(e);R.useEffect(()=>{const i=r=>{r.key==="Escape"&&n(r)};return t.addEventListener("keydown",i,{capture:!0}),()=>t.removeEventListener("keydown",i,{capture:!0})},[n,t])}var Che="DismissableLayer",hv="dismissableLayer.update",Ahe="dismissableLayer.pointerDownOutside",Mhe="dismissableLayer.focusOutside",gk,e$=R.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),t$=R.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:i,onPointerDownOutside:r,onFocusOutside:s,onInteractOutside:o,onDismiss:a,...l}=e,c=R.useContext(e$),[d,u]=R.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=R.useState({}),m=ho(t,_=>u(_)),p=Array.from(c.layers),[U]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),b=p.indexOf(U),y=d?p.indexOf(d):-1,w=c.layersWithOutsidePointerEventsDisabled.size>0,v=y>=b,I=Dhe(_=>{const T=_.target,k=[...c.branches].some(x=>x.contains(T));!v||k||(r==null||r(_),o==null||o(_),_.defaultPrevented||a==null||a())},f),C=Lhe(_=>{const T=_.target;[...c.branches].some(x=>x.contains(T))||(s==null||s(_),o==null||o(_),_.defaultPrevented||a==null||a())},f);return xhe(_=>{y===c.layers.size-1&&(i==null||i(_),!_.defaultPrevented&&a&&(_.preventDefault(),a()))},f),R.useEffect(()=>{if(d)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(gk=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(d)),c.layers.add(d),mk(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=gk)}},[d,f,n,c]),R.useEffect(()=>()=>{d&&(c.layers.delete(d),c.layersWithOutsidePointerEventsDisabled.delete(d),mk())},[d,c]),R.useEffect(()=>{const _=()=>h({});return document.addEventListener(hv,_),()=>document.removeEventListener(hv,_)},[]),g(br.div,{...l,ref:m,style:{pointerEvents:w?v?"auto":"none":void 0,...e.style},onFocusCapture:Di(e.onFocusCapture,C.onFocusCapture),onBlurCapture:Di(e.onBlurCapture,C.onBlurCapture),onPointerDownCapture:Di(e.onPointerDownCapture,I.onPointerDownCapture)})});t$.displayName=Che;var khe="DismissableLayerBranch",Rhe=R.forwardRef((e,t)=>{const n=R.useContext(e$),i=R.useRef(null),r=ho(t,i);return R.useEffect(()=>{const s=i.current;if(s)return n.branches.add(s),()=>{n.branches.delete(s)}},[n.branches]),g(br.div,{...e,ref:r})});Rhe.displayName=khe;function Dhe(e,t=globalThis==null?void 0:globalThis.document){const n=gl(e),i=R.useRef(!1),r=R.useRef(()=>{});return R.useEffect(()=>{const s=a=>{if(a.target&&!i.current){let l=function(){n$(Ahe,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(t.removeEventListener("click",r.current),r.current=l,t.addEventListener("click",r.current,{once:!0})):l()}else t.removeEventListener("click",r.current);i.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",s),t.removeEventListener("click",r.current)}},[t,n]),{onPointerDownCapture:()=>i.current=!0}}function Lhe(e,t=globalThis==null?void 0:globalThis.document){const n=gl(e),i=R.useRef(!1);return R.useEffect(()=>{const r=s=>{s.target&&!i.current&&n$(Mhe,n,{originalEvent:s},{discrete:!1})};return t.addEventListener("focusin",r),()=>t.removeEventListener("focusin",r)},[t,n]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function mk(){const e=new CustomEvent(hv);document.dispatchEvent(e)}function n$(e,t,n,{discrete:i}){const r=n.originalEvent.target,s=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&r.addEventListener(e,t,{once:!0}),i?She(r,s):r.dispatchEvent(s)}var Q8=0;function Nhe(){R.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??pk()),document.body.insertAdjacentElement("beforeend",e[1]??pk()),Q8++,()=>{Q8===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Q8--}},[])}function pk(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var J8="focusScope.autoFocusOnMount",e3="focusScope.autoFocusOnUnmount",Uk={bubbles:!1,cancelable:!0},Ohe="FocusScope",i$=R.forwardRef((e,t)=>{const{loop:n=!1,trapped:i=!1,onMountAutoFocus:r,onUnmountAutoFocus:s,...o}=e,[a,l]=R.useState(null),c=gl(r),d=gl(s),u=R.useRef(null),f=ho(t,p=>l(p)),h=R.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;R.useEffect(()=>{if(i){let p=function(w){if(h.paused||!a)return;const v=w.target;a.contains(v)?u.current=v:$l(u.current,{select:!0})},U=function(w){if(h.paused||!a)return;const v=w.relatedTarget;v!==null&&(a.contains(v)||$l(u.current,{select:!0}))},b=function(w){if(document.activeElement===document.body)for(const I of w)I.removedNodes.length>0&&$l(a)};document.addEventListener("focusin",p),document.addEventListener("focusout",U);const y=new MutationObserver(b);return a&&y.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",p),document.removeEventListener("focusout",U),y.disconnect()}}},[i,a,h.paused]),R.useEffect(()=>{if(a){yk.add(h);const p=document.activeElement;if(!a.contains(p)){const b=new CustomEvent(J8,Uk);a.addEventListener(J8,c),a.dispatchEvent(b),b.defaultPrevented||(Phe(Vhe(r$(a)),{select:!0}),document.activeElement===p&&$l(a))}return()=>{a.removeEventListener(J8,c),setTimeout(()=>{const b=new CustomEvent(e3,Uk);a.addEventListener(e3,d),a.dispatchEvent(b),b.defaultPrevented||$l(p??document.body,{select:!0}),a.removeEventListener(e3,d),yk.remove(h)},0)}}},[a,c,d,h]);const m=R.useCallback(p=>{if(!n&&!i||h.paused)return;const U=p.key==="Tab"&&!p.altKey&&!p.ctrlKey&&!p.metaKey,b=document.activeElement;if(U&&b){const y=p.currentTarget,[w,v]=Fhe(y);w&&v?!p.shiftKey&&b===v?(p.preventDefault(),n&&$l(w,{select:!0})):p.shiftKey&&b===w&&(p.preventDefault(),n&&$l(v,{select:!0})):b===y&&p.preventDefault()}},[n,i,h.paused]);return g(br.div,{tabIndex:-1,...o,ref:f,onKeyDown:m})});i$.displayName=Ohe;function Phe(e,{select:t=!1}={}){const n=document.activeElement;for(const i of e)if($l(i,{select:t}),document.activeElement!==n)return}function Fhe(e){const t=r$(e),n=bk(t,e),i=bk(t.reverse(),e);return[n,i]}function r$(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const r=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||r?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function bk(e,t){for(const n of e)if(!Bhe(n,{upTo:t}))return n}function Bhe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function zhe(e){return e instanceof HTMLInputElement&&"select"in e}function $l(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&zhe(e)&&t&&e.select()}}var yk=Hhe();function Hhe(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=Ek(e,t),e.unshift(t)},remove(t){var n;e=Ek(e,t),(n=e[0])==null||n.resume()}}}function Ek(e,t){const n=[...e],i=n.indexOf(t);return i!==-1&&n.splice(i,1),n}function Vhe(e){return e.filter(t=>t.tagName!=="A")}var vu=globalThis!=null&&globalThis.document?R.useLayoutEffect:()=>{},$he=oq.useId||(()=>{}),Ghe=0;function oT(e){const[t,n]=R.useState($he());return vu(()=>{n(i=>i??String(Ghe++))},[e]),e||(t?`radix-${t}`:"")}const Xhe=["top","right","bottom","left"],jc=Math.min,Vr=Math.max,P6=Math.round,YU=Math.floor,Yo=e=>({x:e,y:e}),jhe={left:"right",right:"left",bottom:"top",top:"bottom"},Yhe={start:"end",end:"start"};function gv(e,t,n){return Vr(e,jc(t,n))}function ml(e,t){return typeof e=="function"?e(t):e}function pl(e){return e.split("-")[0]}function xg(e){return e.split("-")[1]}function aT(e){return e==="x"?"y":"x"}function lT(e){return e==="y"?"height":"width"}function Yc(e){return["top","bottom"].includes(pl(e))?"y":"x"}function cT(e){return aT(Yc(e))}function Whe(e,t,n){n===void 0&&(n=!1);const i=xg(e),r=cT(e),s=lT(r);let o=r==="x"?i===(n?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(o=F6(o)),[o,F6(o)]}function Khe(e){const t=F6(e);return[mv(e),t,mv(t)]}function mv(e){return e.replace(/start|end/g,t=>Yhe[t])}function Zhe(e,t,n){const i=["left","right"],r=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(e){case"top":case"bottom":return n?t?r:i:t?i:r;case"left":case"right":return t?s:o;default:return[]}}function qhe(e,t,n,i){const r=xg(e);let s=Zhe(pl(e),n==="start",i);return r&&(s=s.map(o=>o+"-"+r),t&&(s=s.concat(s.map(mv)))),s}function F6(e){return e.replace(/left|right|bottom|top/g,t=>jhe[t])}function Qhe(e){return{top:0,right:0,bottom:0,left:0,...e}}function s$(e){return typeof e!="number"?Qhe(e):{top:e,right:e,bottom:e,left:e}}function B6(e){const{x:t,y:n,width:i,height:r}=e;return{width:i,height:r,top:n,left:t,right:t+i,bottom:n+r,x:t,y:n}}function vk(e,t,n){let{reference:i,floating:r}=e;const s=Yc(t),o=cT(t),a=lT(o),l=pl(t),c=s==="y",d=i.x+i.width/2-r.width/2,u=i.y+i.height/2-r.height/2,f=i[a]/2-r[a]/2;let h;switch(l){case"top":h={x:d,y:i.y-r.height};break;case"bottom":h={x:d,y:i.y+i.height};break;case"right":h={x:i.x+i.width,y:u};break;case"left":h={x:i.x-r.width,y:u};break;default:h={x:i.x,y:i.y}}switch(xg(t)){case"start":h[o]-=f*(n&&c?-1:1);break;case"end":h[o]+=f*(n&&c?-1:1);break}return h}const Jhe=async(e,t,n)=>{const{placement:i="bottom",strategy:r="absolute",middleware:s=[],platform:o}=n,a=s.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(t));let c=await o.getElementRects({reference:e,floating:t,strategy:r}),{x:d,y:u}=vk(c,i,l),f=i,h={},m=0;for(let p=0;p<a.length;p++){const{name:U,fn:b}=a[p],{x:y,y:w,data:v,reset:I}=await b({x:d,y:u,initialPlacement:i,placement:f,strategy:r,middlewareData:h,rects:c,platform:o,elements:{reference:e,floating:t}});d=y??d,u=w??u,h={...h,[U]:{...h[U],...v}},I&&m<=50&&(m++,typeof I=="object"&&(I.placement&&(f=I.placement),I.rects&&(c=I.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:r}):I.rects),{x:d,y:u}=vk(c,f,l)),p=-1)}return{x:d,y:u,placement:f,strategy:r,middlewareData:h}};async function Im(e,t){var n;t===void 0&&(t={});const{x:i,y:r,platform:s,rects:o,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:u="floating",altBoundary:f=!1,padding:h=0}=ml(t,e),m=s$(h),U=a[f?u==="floating"?"reference":"floating":u],b=B6(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(U)))==null||n?U:U.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:d,strategy:l})),y=u==="floating"?{x:i,y:r,width:o.floating.width,height:o.floating.height}:o.reference,w=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),v=await(s.isElement==null?void 0:s.isElement(w))?await(s.getScale==null?void 0:s.getScale(w))||{x:1,y:1}:{x:1,y:1},I=B6(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:y,offsetParent:w,strategy:l}):y);return{top:(b.top-I.top+m.top)/v.y,bottom:(I.bottom-b.bottom+m.bottom)/v.y,left:(b.left-I.left+m.left)/v.x,right:(I.right-b.right+m.right)/v.x}}const ege=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:i,placement:r,rects:s,platform:o,elements:a,middlewareData:l}=t,{element:c,padding:d=0}=ml(e,t)||{};if(c==null)return{};const u=s$(d),f={x:n,y:i},h=cT(r),m=lT(h),p=await o.getDimensions(c),U=h==="y",b=U?"top":"left",y=U?"bottom":"right",w=U?"clientHeight":"clientWidth",v=s.reference[m]+s.reference[h]-f[h]-s.floating[m],I=f[h]-s.reference[h],C=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let _=C?C[w]:0;(!_||!await(o.isElement==null?void 0:o.isElement(C)))&&(_=a.floating[w]||s.floating[m]);const T=v/2-I/2,k=_/2-p[m]/2-1,x=jc(u[b],k),D=jc(u[y],k),O=x,L=_-p[m]-D,Y=_/2-p[m]/2+T,$=gv(O,Y,L),H=!l.arrow&&xg(r)!=null&&Y!==$&&s.reference[m]/2-(Y<O?x:D)-p[m]/2<0,z=H?Y<O?Y-O:Y-L:0;return{[h]:f[h]+z,data:{[h]:$,centerOffset:Y-$-z,...H&&{alignmentOffset:z}},reset:H}}}),tge=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,i;const{placement:r,middlewareData:s,rects:o,initialPlacement:a,platform:l,elements:c}=t,{mainAxis:d=!0,crossAxis:u=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:p=!0,...U}=ml(e,t);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const b=pl(r),y=Yc(a),w=pl(a)===a,v=await(l.isRTL==null?void 0:l.isRTL(c.floating)),I=f||(w||!p?[F6(a)]:Khe(a)),C=m!=="none";!f&&C&&I.push(...qhe(a,p,m,v));const _=[a,...I],T=await Im(t,U),k=[];let x=((i=s.flip)==null?void 0:i.overflows)||[];if(d&&k.push(T[b]),u){const Y=Whe(r,o,v);k.push(T[Y[0]],T[Y[1]])}if(x=[...x,{placement:r,overflows:k}],!k.every(Y=>Y<=0)){var D,O;const Y=(((D=s.flip)==null?void 0:D.index)||0)+1,$=_[Y];if($)return{data:{index:Y,overflows:x},reset:{placement:$}};let H=(O=x.filter(z=>z.overflows[0]<=0).sort((z,G)=>z.overflows[1]-G.overflows[1])[0])==null?void 0:O.placement;if(!H)switch(h){case"bestFit":{var L;const z=(L=x.filter(G=>{if(C){const j=Yc(G.placement);return j===y||j==="y"}return!0}).map(G=>[G.placement,G.overflows.filter(j=>j>0).reduce((j,X)=>j+X,0)]).sort((G,j)=>G[1]-j[1])[0])==null?void 0:L[0];z&&(H=z);break}case"initialPlacement":H=a;break}if(r!==H)return{reset:{placement:H}}}return{}}}};function wk(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function _k(e){return Xhe.some(t=>e[t]>=0)}const nge=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:i="referenceHidden",...r}=ml(e,t);switch(i){case"referenceHidden":{const s=await Im(t,{...r,elementContext:"reference"}),o=wk(s,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:_k(o)}}}case"escaped":{const s=await Im(t,{...r,altBoundary:!0}),o=wk(s,n.floating);return{data:{escapedOffsets:o,escaped:_k(o)}}}default:return{}}}}};async function ige(e,t){const{placement:n,platform:i,elements:r}=e,s=await(i.isRTL==null?void 0:i.isRTL(r.floating)),o=pl(n),a=xg(n),l=Yc(n)==="y",c=["left","top"].includes(o)?-1:1,d=s&&l?-1:1,u=ml(t,e);let{mainAxis:f,crossAxis:h,alignmentAxis:m}=typeof u=="number"?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return a&&typeof m=="number"&&(h=a==="end"?m*-1:m),l?{x:h*d,y:f*c}:{x:f*c,y:h*d}}const rge=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,i;const{x:r,y:s,placement:o,middlewareData:a}=t,l=await ige(t,e);return o===((n=a.offset)==null?void 0:n.placement)&&(i=a.arrow)!=null&&i.alignmentOffset?{}:{x:r+l.x,y:s+l.y,data:{...l,placement:o}}}}},sge=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:i,placement:r}=t,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:U=>{let{x:b,y}=U;return{x:b,y}}},...l}=ml(e,t),c={x:n,y:i},d=await Im(t,l),u=Yc(pl(r)),f=aT(u);let h=c[f],m=c[u];if(s){const U=f==="y"?"top":"left",b=f==="y"?"bottom":"right",y=h+d[U],w=h-d[b];h=gv(y,h,w)}if(o){const U=u==="y"?"top":"left",b=u==="y"?"bottom":"right",y=m+d[U],w=m-d[b];m=gv(y,m,w)}const p=a.fn({...t,[f]:h,[u]:m});return{...p,data:{x:p.x-n,y:p.y-i,enabled:{[f]:s,[u]:o}}}}}},oge=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:i,placement:r,rects:s,middlewareData:o}=t,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=ml(e,t),d={x:n,y:i},u=Yc(r),f=aT(u);let h=d[f],m=d[u];const p=ml(a,t),U=typeof p=="number"?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(l){const w=f==="y"?"height":"width",v=s.reference[f]-s.floating[w]+U.mainAxis,I=s.reference[f]+s.reference[w]-U.mainAxis;h<v?h=v:h>I&&(h=I)}if(c){var b,y;const w=f==="y"?"width":"height",v=["top","left"].includes(pl(r)),I=s.reference[u]-s.floating[w]+(v&&((b=o.offset)==null?void 0:b[u])||0)+(v?0:U.crossAxis),C=s.reference[u]+s.reference[w]+(v?0:((y=o.offset)==null?void 0:y[u])||0)-(v?U.crossAxis:0);m<I?m=I:m>C&&(m=C)}return{[f]:h,[u]:m}}}},age=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,i;const{placement:r,rects:s,platform:o,elements:a}=t,{apply:l=()=>{},...c}=ml(e,t),d=await Im(t,c),u=pl(r),f=xg(r),h=Yc(r)==="y",{width:m,height:p}=s.floating;let U,b;u==="top"||u==="bottom"?(U=u,b=f===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(b=u,U=f==="end"?"top":"bottom");const y=p-d.top-d.bottom,w=m-d.left-d.right,v=jc(p-d[U],y),I=jc(m-d[b],w),C=!t.middlewareData.shift;let _=v,T=I;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(T=w),(i=t.middlewareData.shift)!=null&&i.enabled.y&&(_=y),C&&!f){const x=Vr(d.left,0),D=Vr(d.right,0),O=Vr(d.top,0),L=Vr(d.bottom,0);h?T=m-2*(x!==0||D!==0?x+D:Vr(d.left,d.right)):_=p-2*(O!==0||L!==0?O+L:Vr(d.top,d.bottom))}await l({...t,availableWidth:T,availableHeight:_});const k=await o.getDimensions(a.floating);return m!==k.width||p!==k.height?{reset:{rects:!0}}:{}}}};function wy(){return typeof window<"u"}function Cg(e){return o$(e)?(e.nodeName||"").toLowerCase():"#document"}function is(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function ua(e){var t;return(t=(o$(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function o$(e){return wy()?e instanceof Node||e instanceof is(e).Node:!1}function go(e){return wy()?e instanceof Element||e instanceof is(e).Element:!1}function ra(e){return wy()?e instanceof HTMLElement||e instanceof is(e).HTMLElement:!1}function Tk(e){return!wy()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof is(e).ShadowRoot}function Pp(e){const{overflow:t,overflowX:n,overflowY:i,display:r}=mo(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+n)&&!["inline","contents"].includes(r)}function lge(e){return["table","td","th"].includes(Cg(e))}function _y(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function dT(e){const t=uT(),n=go(e)?mo(e):e;return["transform","translate","scale","rotate","perspective"].some(i=>n[i]?n[i]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(i=>(n.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(n.contain||"").includes(i))}function cge(e){let t=Wc(e);for(;ra(t)&&!Zh(t);){if(dT(t))return t;if(_y(t))return null;t=Wc(t)}return null}function uT(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Zh(e){return["html","body","#document"].includes(Cg(e))}function mo(e){return is(e).getComputedStyle(e)}function Ty(e){return go(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Wc(e){if(Cg(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Tk(e)&&e.host||ua(e);return Tk(t)?t.host:t}function a$(e){const t=Wc(e);return Zh(t)?e.ownerDocument?e.ownerDocument.body:e.body:ra(t)&&Pp(t)?t:a$(t)}function Sm(e,t,n){var i;t===void 0&&(t=[]),n===void 0&&(n=!0);const r=a$(e),s=r===((i=e.ownerDocument)==null?void 0:i.body),o=is(r);if(s){const a=pv(o);return t.concat(o,o.visualViewport||[],Pp(r)?r:[],a&&n?Sm(a):[])}return t.concat(r,Sm(r,[],n))}function pv(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function l$(e){const t=mo(e);let n=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const r=ra(e),s=r?e.offsetWidth:n,o=r?e.offsetHeight:i,a=P6(n)!==s||P6(i)!==o;return a&&(n=s,i=o),{width:n,height:i,$:a}}function fT(e){return go(e)?e:e.contextElement}function bh(e){const t=fT(e);if(!ra(t))return Yo(1);const n=t.getBoundingClientRect(),{width:i,height:r,$:s}=l$(t);let o=(s?P6(n.width):n.width)/i,a=(s?P6(n.height):n.height)/r;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const dge=Yo(0);function c$(e){const t=is(e);return!uT()||!t.visualViewport?dge:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function uge(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==is(e)?!1:t}function wu(e,t,n,i){t===void 0&&(t=!1),n===void 0&&(n=!1);const r=e.getBoundingClientRect(),s=fT(e);let o=Yo(1);t&&(i?go(i)&&(o=bh(i)):o=bh(e));const a=uge(s,n,i)?c$(s):Yo(0);let l=(r.left+a.x)/o.x,c=(r.top+a.y)/o.y,d=r.width/o.x,u=r.height/o.y;if(s){const f=is(s),h=i&&go(i)?is(i):i;let m=f,p=pv(m);for(;p&&i&&h!==m;){const U=bh(p),b=p.getBoundingClientRect(),y=mo(p),w=b.left+(p.clientLeft+parseFloat(y.paddingLeft))*U.x,v=b.top+(p.clientTop+parseFloat(y.paddingTop))*U.y;l*=U.x,c*=U.y,d*=U.x,u*=U.y,l+=w,c+=v,m=is(p),p=pv(m)}}return B6({width:d,height:u,x:l,y:c})}function hT(e,t){const n=Ty(e).scrollLeft;return t?t.left+n:wu(ua(e)).left+n}function d$(e,t,n){n===void 0&&(n=!1);const i=e.getBoundingClientRect(),r=i.left+t.scrollLeft-(n?0:hT(e,i)),s=i.top+t.scrollTop;return{x:r,y:s}}function fge(e){let{elements:t,rect:n,offsetParent:i,strategy:r}=e;const s=r==="fixed",o=ua(i),a=t?_y(t.floating):!1;if(i===o||a&&s)return n;let l={scrollLeft:0,scrollTop:0},c=Yo(1);const d=Yo(0),u=ra(i);if((u||!u&&!s)&&((Cg(i)!=="body"||Pp(o))&&(l=Ty(i)),ra(i))){const h=wu(i);c=bh(i),d.x=h.x+i.clientLeft,d.y=h.y+i.clientTop}const f=o&&!u&&!s?d$(o,l,!0):Yo(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+d.x+f.x,y:n.y*c.y-l.scrollTop*c.y+d.y+f.y}}function hge(e){return Array.from(e.getClientRects())}function gge(e){const t=ua(e),n=Ty(e),i=e.ownerDocument.body,r=Vr(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),s=Vr(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let o=-n.scrollLeft+hT(e);const a=-n.scrollTop;return mo(i).direction==="rtl"&&(o+=Vr(t.clientWidth,i.clientWidth)-r),{width:r,height:s,x:o,y:a}}function mge(e,t){const n=is(e),i=ua(e),r=n.visualViewport;let s=i.clientWidth,o=i.clientHeight,a=0,l=0;if(r){s=r.width,o=r.height;const c=uT();(!c||c&&t==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}return{width:s,height:o,x:a,y:l}}function pge(e,t){const n=wu(e,!0,t==="fixed"),i=n.top+e.clientTop,r=n.left+e.clientLeft,s=ra(e)?bh(e):Yo(1),o=e.clientWidth*s.x,a=e.clientHeight*s.y,l=r*s.x,c=i*s.y;return{width:o,height:a,x:l,y:c}}function Ik(e,t,n){let i;if(t==="viewport")i=mge(e,n);else if(t==="document")i=gge(ua(e));else if(go(t))i=pge(t,n);else{const r=c$(e);i={x:t.x-r.x,y:t.y-r.y,width:t.width,height:t.height}}return B6(i)}function u$(e,t){const n=Wc(e);return n===t||!go(n)||Zh(n)?!1:mo(n).position==="fixed"||u$(n,t)}function Uge(e,t){const n=t.get(e);if(n)return n;let i=Sm(e,[],!1).filter(a=>go(a)&&Cg(a)!=="body"),r=null;const s=mo(e).position==="fixed";let o=s?Wc(e):e;for(;go(o)&&!Zh(o);){const a=mo(o),l=dT(o);!l&&a.position==="fixed"&&(r=null),(s?!l&&!r:!l&&a.position==="static"&&!!r&&["absolute","fixed"].includes(r.position)||Pp(o)&&!l&&u$(e,o))?i=i.filter(d=>d!==o):r=a,o=Wc(o)}return t.set(e,i),i}function bge(e){let{element:t,boundary:n,rootBoundary:i,strategy:r}=e;const o=[...n==="clippingAncestors"?_y(t)?[]:Uge(t,this._c):[].concat(n),i],a=o[0],l=o.reduce((c,d)=>{const u=Ik(t,d,r);return c.top=Vr(u.top,c.top),c.right=jc(u.right,c.right),c.bottom=jc(u.bottom,c.bottom),c.left=Vr(u.left,c.left),c},Ik(t,a,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function yge(e){const{width:t,height:n}=l$(e);return{width:t,height:n}}function Ege(e,t,n){const i=ra(t),r=ua(t),s=n==="fixed",o=wu(e,!0,s,t);let a={scrollLeft:0,scrollTop:0};const l=Yo(0);if(i||!i&&!s)if((Cg(t)!=="body"||Pp(r))&&(a=Ty(t)),i){const f=wu(t,!0,s,t);l.x=f.x+t.clientLeft,l.y=f.y+t.clientTop}else r&&(l.x=hT(r));const c=r&&!i&&!s?d$(r,a):Yo(0),d=o.left+a.scrollLeft-l.x-c.x,u=o.top+a.scrollTop-l.y-c.y;return{x:d,y:u,width:o.width,height:o.height}}function t3(e){return mo(e).position==="static"}function Sk(e,t){if(!ra(e)||mo(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return ua(e)===n&&(n=n.ownerDocument.body),n}function f$(e,t){const n=is(e);if(_y(e))return n;if(!ra(e)){let r=Wc(e);for(;r&&!Zh(r);){if(go(r)&&!t3(r))return r;r=Wc(r)}return n}let i=Sk(e,t);for(;i&&lge(i)&&t3(i);)i=Sk(i,t);return i&&Zh(i)&&t3(i)&&!dT(i)?n:i||cge(e)||n}const vge=async function(e){const t=this.getOffsetParent||f$,n=this.getDimensions,i=await n(e.floating);return{reference:Ege(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function wge(e){return mo(e).direction==="rtl"}const _ge={convertOffsetParentRelativeRectToViewportRelativeRect:fge,getDocumentElement:ua,getClippingRect:bge,getOffsetParent:f$,getElementRects:vge,getClientRects:hge,getDimensions:yge,getScale:bh,isElement:go,isRTL:wge};function h$(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Tge(e,t){let n=null,i;const r=ua(e);function s(){var a;clearTimeout(i),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const c=e.getBoundingClientRect(),{left:d,top:u,width:f,height:h}=c;if(a||t(),!f||!h)return;const m=YU(u),p=YU(r.clientWidth-(d+f)),U=YU(r.clientHeight-(u+h)),b=YU(d),w={rootMargin:-m+"px "+-p+"px "+-U+"px "+-b+"px",threshold:Vr(0,jc(1,l))||1};let v=!0;function I(C){const _=C[0].intersectionRatio;if(_!==l){if(!v)return o();_?o(!1,_):i=setTimeout(()=>{o(!1,1e-7)},1e3)}_===1&&!h$(c,e.getBoundingClientRect())&&o(),v=!1}try{n=new IntersectionObserver(I,{...w,root:r.ownerDocument})}catch{n=new IntersectionObserver(I,w)}n.observe(e)}return o(!0),s}function Ige(e,t,n,i){i===void 0&&(i={});const{ancestorScroll:r=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=i,c=fT(e),d=r||s?[...c?Sm(c):[],...Sm(t)]:[];d.forEach(b=>{r&&b.addEventListener("scroll",n,{passive:!0}),s&&b.addEventListener("resize",n)});const u=c&&a?Tge(c,n):null;let f=-1,h=null;o&&(h=new ResizeObserver(b=>{let[y]=b;y&&y.target===c&&h&&(h.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var w;(w=h)==null||w.observe(t)})),n()}),c&&!l&&h.observe(c),h.observe(t));let m,p=l?wu(e):null;l&&U();function U(){const b=wu(e);p&&!h$(p,b)&&n(),p=b,m=requestAnimationFrame(U)}return n(),()=>{var b;d.forEach(y=>{r&&y.removeEventListener("scroll",n),s&&y.removeEventListener("resize",n)}),u==null||u(),(b=h)==null||b.disconnect(),h=null,l&&cancelAnimationFrame(m)}}const Sge=rge,xge=sge,Cge=tge,Age=age,Mge=nge,xk=ege,kge=oge,Rge=(e,t,n)=>{const i=new Map,r={platform:_ge,...n},s={...r.platform,_c:i};return Jhe(e,t,{...r,platform:s})};var W2=typeof document<"u"?R.useLayoutEffect:R.useEffect;function z6(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,i,r;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(i=n;i--!==0;)if(!z6(e[i],t[i]))return!1;return!0}if(r=Object.keys(e),n=r.length,n!==Object.keys(t).length)return!1;for(i=n;i--!==0;)if(!{}.hasOwnProperty.call(t,r[i]))return!1;for(i=n;i--!==0;){const s=r[i];if(!(s==="_owner"&&e.$$typeof)&&!z6(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function g$(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Ck(e,t){const n=g$(e);return Math.round(t*n)/n}function n3(e){const t=R.useRef(e);return W2(()=>{t.current=e}),t}function Dge(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:i=[],platform:r,elements:{reference:s,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=e,[d,u]=R.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,h]=R.useState(i);z6(f,i)||h(i);const[m,p]=R.useState(null),[U,b]=R.useState(null),y=R.useCallback(G=>{G!==C.current&&(C.current=G,p(G))},[]),w=R.useCallback(G=>{G!==_.current&&(_.current=G,b(G))},[]),v=s||m,I=o||U,C=R.useRef(null),_=R.useRef(null),T=R.useRef(d),k=l!=null,x=n3(l),D=n3(r),O=n3(c),L=R.useCallback(()=>{if(!C.current||!_.current)return;const G={placement:t,strategy:n,middleware:f};D.current&&(G.platform=D.current),Rge(C.current,_.current,G).then(j=>{const X={...j,isPositioned:O.current!==!1};Y.current&&!z6(T.current,X)&&(T.current=X,mi.flushSync(()=>{u(X)}))})},[f,t,n,D,O]);W2(()=>{c===!1&&T.current.isPositioned&&(T.current.isPositioned=!1,u(G=>({...G,isPositioned:!1})))},[c]);const Y=R.useRef(!1);W2(()=>(Y.current=!0,()=>{Y.current=!1}),[]),W2(()=>{if(v&&(C.current=v),I&&(_.current=I),v&&I){if(x.current)return x.current(v,I,L);L()}},[v,I,L,x,k]);const $=R.useMemo(()=>({reference:C,floating:_,setReference:y,setFloating:w}),[y,w]),H=R.useMemo(()=>({reference:v,floating:I}),[v,I]),z=R.useMemo(()=>{const G={position:n,left:0,top:0};if(!H.floating)return G;const j=Ck(H.floating,d.x),X=Ck(H.floating,d.y);return a?{...G,transform:"translate("+j+"px, "+X+"px)",...g$(H.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:j,top:X}},[n,a,H.floating,d.x,d.y]);return R.useMemo(()=>({...d,update:L,refs:$,elements:H,floatingStyles:z}),[d,L,$,H,z])}const Lge=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:i,padding:r}=typeof e=="function"?e(n):e;return i&&t(i)?i.current!=null?xk({element:i.current,padding:r}).fn(n):{}:i?xk({element:i,padding:r}).fn(n):{}}}},Nge=(e,t)=>({...Sge(e),options:[e,t]}),Oge=(e,t)=>({...xge(e),options:[e,t]}),Pge=(e,t)=>({...kge(e),options:[e,t]}),Fge=(e,t)=>({...Cge(e),options:[e,t]}),Bge=(e,t)=>({...Age(e),options:[e,t]}),zge=(e,t)=>({...Mge(e),options:[e,t]}),Hge=(e,t)=>({...Lge(e),options:[e,t]});var Vge="Arrow",m$=R.forwardRef((e,t)=>{const{children:n,width:i=10,height:r=5,...s}=e;return g(br.svg,{...s,ref:t,width:i,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:g("polygon",{points:"0,0 30,0 15,10"})})});m$.displayName=Vge;var $ge=m$;function Gge(e){const[t,n]=R.useState(void 0);return vu(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const i=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const s=r[0];let o,a;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=e.offsetWidth,a=e.offsetHeight;n({width:o,height:a})});return i.observe(e,{box:"border-box"}),()=>i.unobserve(e)}else n(void 0)},[e]),t}var gT="Popper",[p$,U$]=Op(gT),[Xge,b$]=p$(gT),y$=e=>{const{__scopePopper:t,children:n}=e,[i,r]=R.useState(null);return g(Xge,{scope:t,anchor:i,onAnchorChange:r,children:n})};y$.displayName=gT;var E$="PopperAnchor",v$=R.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:i,...r}=e,s=b$(E$,n),o=R.useRef(null),a=ho(t,o);return R.useEffect(()=>{s.onAnchorChange((i==null?void 0:i.current)||o.current)}),i?null:g(br.div,{...r,ref:a})});v$.displayName=E$;var mT="PopperContent",[jge,Yge]=p$(mT),w$=R.forwardRef((e,t)=>{var De,vt,Vt,Be,Qe,$t;const{__scopePopper:n,side:i="bottom",sideOffset:r=0,align:s="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:d=0,sticky:u="partial",hideWhenDetached:f=!1,updatePositionStrategy:h="optimized",onPlaced:m,...p}=e,U=b$(mT,n),[b,y]=R.useState(null),w=ho(t,li=>y(li)),[v,I]=R.useState(null),C=Gge(v),_=(C==null?void 0:C.width)??0,T=(C==null?void 0:C.height)??0,k=i+(s!=="center"?"-"+s:""),x=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},D=Array.isArray(c)?c:[c],O=D.length>0,L={padding:x,boundary:D.filter(Kge),altBoundary:O},{refs:Y,floatingStyles:$,placement:H,isPositioned:z,middlewareData:G}=Dge({strategy:"fixed",placement:k,whileElementsMounted:(...li)=>Ige(...li,{animationFrame:h==="always"}),elements:{reference:U.anchor},middleware:[Nge({mainAxis:r+T,alignmentAxis:o}),l&&Oge({mainAxis:!0,crossAxis:!1,limiter:u==="partial"?Pge():void 0,...L}),l&&Fge({...L}),Bge({...L,apply:({elements:li,rects:Al,availableWidth:zg,availableHeight:qp})=>{const{width:EE,height:vE}=Al.reference,fd=li.floating.style;fd.setProperty("--radix-popper-available-width",`${zg}px`),fd.setProperty("--radix-popper-available-height",`${qp}px`),fd.setProperty("--radix-popper-anchor-width",`${EE}px`),fd.setProperty("--radix-popper-anchor-height",`${vE}px`)}}),v&&Hge({element:v,padding:a}),Zge({arrowWidth:_,arrowHeight:T}),f&&zge({strategy:"referenceHidden",...L})]}),[j,X]=I$(H),K=gl(m);vu(()=>{z&&(K==null||K())},[z,K]);const ne=(De=G.arrow)==null?void 0:De.x,se=(vt=G.arrow)==null?void 0:vt.y,oe=((Vt=G.arrow)==null?void 0:Vt.centerOffset)!==0,[Ee,Re]=R.useState();return vu(()=>{b&&Re(window.getComputedStyle(b).zIndex)},[b]),g("div",{ref:Y.setFloating,"data-radix-popper-content-wrapper":"",style:{...$,transform:z?$.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Ee,"--radix-popper-transform-origin":[(Be=G.transformOrigin)==null?void 0:Be.x,(Qe=G.transformOrigin)==null?void 0:Qe.y].join(" "),...(($t=G.hide)==null?void 0:$t.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:g(jge,{scope:n,placedSide:j,onArrowChange:I,arrowX:ne,arrowY:se,shouldHideArrow:oe,children:g(br.div,{"data-side":j,"data-align":X,...p,ref:w,style:{...p.style,animation:z?void 0:"none"}})})})});w$.displayName=mT;var _$="PopperArrow",Wge={top:"bottom",right:"left",bottom:"top",left:"right"},T$=R.forwardRef(function(t,n){const{__scopePopper:i,...r}=t,s=Yge(_$,i),o=Wge[s.placedSide];return g("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:g($ge,{...r,ref:n,style:{...r.style,display:"block"}})})});T$.displayName=_$;function Kge(e){return e!==null}var Zge=e=>({name:"transformOrigin",options:e,fn(t){var U,b,y;const{placement:n,rects:i,middlewareData:r}=t,o=((U=r.arrow)==null?void 0:U.centerOffset)!==0,a=o?0:e.arrowWidth,l=o?0:e.arrowHeight,[c,d]=I$(n),u={start:"0%",center:"50%",end:"100%"}[d],f=(((b=r.arrow)==null?void 0:b.x)??0)+a/2,h=(((y=r.arrow)==null?void 0:y.y)??0)+l/2;let m="",p="";return c==="bottom"?(m=o?u:`${f}px`,p=`${-l}px`):c==="top"?(m=o?u:`${f}px`,p=`${i.floating.height+l}px`):c==="right"?(m=`${-l}px`,p=o?u:`${h}px`):c==="left"&&(m=`${i.floating.width+l}px`,p=o?u:`${h}px`),{data:{x:m,y:p}}}});function I$(e){const[t,n="center"]=e.split("-");return[t,n]}var qge=y$,S$=v$,Qge=w$,Jge=T$,e1e="Portal",x$=R.forwardRef((e,t)=>{var a;const{container:n,...i}=e,[r,s]=R.useState(!1);vu(()=>s(!0),[]);const o=n||r&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?uq.createPortal(g(br.div,{...i,ref:t}),o):null});x$.displayName=e1e;function t1e(e,t){return R.useReducer((n,i)=>t[n][i]??n,e)}var Iy=e=>{const{present:t,children:n}=e,i=n1e(t),r=typeof n=="function"?n({present:i.isPresent}):R.Children.only(n),s=ho(i.ref,i1e(r));return typeof n=="function"||i.isPresent?R.cloneElement(r,{ref:s}):null};Iy.displayName="Presence";function n1e(e){const[t,n]=R.useState(),i=R.useRef({}),r=R.useRef(e),s=R.useRef("none"),o=e?"mounted":"unmounted",[a,l]=t1e(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return R.useEffect(()=>{const c=WU(i.current);s.current=a==="mounted"?c:"none"},[a]),vu(()=>{const c=i.current,d=r.current;if(d!==e){const f=s.current,h=WU(c);e?l("MOUNT"):h==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(d&&f!==h?"ANIMATION_OUT":"UNMOUNT"),r.current=e}},[e,l]),vu(()=>{if(t){let c;const d=t.ownerDocument.defaultView??window,u=h=>{const p=WU(i.current).includes(h.animationName);if(h.target===t&&p&&(l("ANIMATION_END"),!r.current)){const U=t.style.animationFillMode;t.style.animationFillMode="forwards",c=d.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=U)})}},f=h=>{h.target===t&&(s.current=WU(i.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",u),t.addEventListener("animationend",u),()=>{d.clearTimeout(c),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",u),t.removeEventListener("animationend",u)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:R.useCallback(c=>{c&&(i.current=getComputedStyle(c)),n(c)},[])}}function WU(e){return(e==null?void 0:e.animationName)||"none"}function i1e(e){var i,r;let t=(i=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(r=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function pT({prop:e,defaultProp:t,onChange:n=()=>{}}){const[i,r]=r1e({defaultProp:t,onChange:n}),s=e!==void 0,o=s?e:i,a=gl(n),l=R.useCallback(c=>{if(s){const u=typeof c=="function"?c(e):c;u!==e&&a(u)}else r(c)},[s,e,r,a]);return[o,l]}function r1e({defaultProp:e,onChange:t}){const n=R.useState(e),[i]=n,r=R.useRef(i),s=gl(t);return R.useEffect(()=>{r.current!==i&&(s(i),r.current=i)},[i,r,s]),n}var s1e=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},cf=new WeakMap,KU=new WeakMap,ZU={},i3=0,C$=function(e){return e&&(e.host||C$(e.parentNode))},o1e=function(e,t){return t.map(function(n){if(e.contains(n))return n;var i=C$(n);return i&&e.contains(i)?i:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},a1e=function(e,t,n,i){var r=o1e(t,Array.isArray(e)?e:[e]);ZU[n]||(ZU[n]=new WeakMap);var s=ZU[n],o=[],a=new Set,l=new Set(r),c=function(u){!u||a.has(u)||(a.add(u),c(u.parentNode))};r.forEach(c);var d=function(u){!u||l.has(u)||Array.prototype.forEach.call(u.children,function(f){if(a.has(f))d(f);else try{var h=f.getAttribute(i),m=h!==null&&h!=="false",p=(cf.get(f)||0)+1,U=(s.get(f)||0)+1;cf.set(f,p),s.set(f,U),o.push(f),p===1&&m&&KU.set(f,!0),U===1&&f.setAttribute(n,"true"),m||f.setAttribute(i,"true")}catch(b){console.error("aria-hidden: cannot operate on ",f,b)}})};return d(t),a.clear(),i3++,function(){o.forEach(function(u){var f=cf.get(u)-1,h=s.get(u)-1;cf.set(u,f),s.set(u,h),f||(KU.has(u)||u.removeAttribute(i),KU.delete(u)),h||u.removeAttribute(n)}),i3--,i3||(cf=new WeakMap,cf=new WeakMap,KU=new WeakMap,ZU={})}},l1e=function(e,t,n){n===void 0&&(n="data-aria-hidden");var i=Array.from(Array.isArray(e)?e:[e]),r=s1e(e);return r?(i.push.apply(i,Array.from(r.querySelectorAll("[aria-live]"))),a1e(i,r,n,"aria-hidden")):function(){return null}},No=function(){return No=Object.assign||function(t){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},No.apply(this,arguments)};function A$(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n}function c1e(e,t,n){if(n||arguments.length===2)for(var i=0,r=t.length,s;i<r;i++)(s||!(i in t))&&(s||(s=Array.prototype.slice.call(t,0,i)),s[i]=t[i]);return e.concat(s||Array.prototype.slice.call(t))}var K2="right-scroll-bar-position",Z2="width-before-scroll-bar",d1e="with-scroll-bars-hidden",u1e="--removed-body-scroll-bar-size";function r3(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function f1e(e,t){var n=R.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(i){var r=n.value;r!==i&&(n.value=i,n.callback(i,r))}}}})[0];return n.callback=t,n.facade}var h1e=typeof window<"u"?R.useLayoutEffect:R.useEffect,Ak=new WeakMap;function g1e(e,t){var n=f1e(null,function(i){return e.forEach(function(r){return r3(r,i)})});return h1e(function(){var i=Ak.get(n);if(i){var r=new Set(i),s=new Set(e),o=n.current;r.forEach(function(a){s.has(a)||r3(a,null)}),s.forEach(function(a){r.has(a)||r3(a,o)})}Ak.set(n,e)},[e]),n}function m1e(e){return e}function p1e(e,t){t===void 0&&(t=m1e);var n=[],i=!1,r={read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(s){var o=t(s,i);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(s){for(i=!0;n.length;){var o=n;n=[],o.forEach(s)}n={push:function(a){return s(a)},filter:function(){return n}}},assignMedium:function(s){i=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(s),o=n}var l=function(){var d=o;o=[],d.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(d){o.push(d),c()},filter:function(d){return o=o.filter(d),n}}}};return r}function U1e(e){e===void 0&&(e={});var t=p1e(null);return t.options=No({async:!0,ssr:!1},e),t}var M$=function(e){var t=e.sideCar,n=A$(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var i=t.read();if(!i)throw new Error("Sidecar medium not found");return R.createElement(i,No({},n))};M$.isSideCarExport=!0;function b1e(e,t){return e.useMedium(t),M$}var k$=U1e(),s3=function(){},Sy=R.forwardRef(function(e,t){var n=R.useRef(null),i=R.useState({onScrollCapture:s3,onWheelCapture:s3,onTouchMoveCapture:s3}),r=i[0],s=i[1],o=e.forwardProps,a=e.children,l=e.className,c=e.removeScrollBar,d=e.enabled,u=e.shards,f=e.sideCar,h=e.noIsolation,m=e.inert,p=e.allowPinchZoom,U=e.as,b=U===void 0?"div":U,y=e.gapMode,w=A$(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),v=f,I=g1e([n,t]),C=No(No({},w),r);return R.createElement(R.Fragment,null,d&&R.createElement(v,{sideCar:k$,removeScrollBar:c,shards:u,noIsolation:h,inert:m,setCallbacks:s,allowPinchZoom:!!p,lockRef:n,gapMode:y}),o?R.cloneElement(R.Children.only(a),No(No({},C),{ref:I})):R.createElement(b,No({},C,{className:l,ref:I}),a))});Sy.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Sy.classNames={fullWidth:Z2,zeroRight:K2};var y1e=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function E1e(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=y1e();return t&&e.setAttribute("nonce",t),e}function v1e(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function w1e(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var _1e=function(){var e=0,t=null;return{add:function(n){e==0&&(t=E1e())&&(v1e(t,n),w1e(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},T1e=function(){var e=_1e();return function(t,n){R.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},R$=function(){var e=T1e(),t=function(n){var i=n.styles,r=n.dynamic;return e(i,r),null};return t},I1e={left:0,top:0,right:0,gap:0},o3=function(e){return parseInt(e||"",10)||0},S1e=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],i=t[e==="padding"?"paddingTop":"marginTop"],r=t[e==="padding"?"paddingRight":"marginRight"];return[o3(n),o3(i),o3(r)]},x1e=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return I1e;var t=S1e(e),n=document.documentElement.clientWidth,i=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,i-n+t[2]-t[0])}},C1e=R$(),yh="data-scroll-locked",A1e=function(e,t,n,i){var r=e.left,s=e.top,o=e.right,a=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(d1e,` {
   overflow: hidden `).concat(i,`;
   padding-right: `).concat(a,"px ").concat(i,`;
  }
  body[`).concat(yh,`] {
    overflow: hidden `).concat(i,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(i,";"),n==="margin"&&`
    padding-left: `.concat(r,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(i,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(i,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(K2,` {
    right: `).concat(a,"px ").concat(i,`;
  }
  
  .`).concat(Z2,` {
    margin-right: `).concat(a,"px ").concat(i,`;
  }
  
  .`).concat(K2," .").concat(K2,` {
    right: 0 `).concat(i,`;
  }
  
  .`).concat(Z2," .").concat(Z2,` {
    margin-right: 0 `).concat(i,`;
  }
  
  body[`).concat(yh,`] {
    `).concat(u1e,": ").concat(a,`px;
  }
`)},Mk=function(){var e=parseInt(document.body.getAttribute(yh)||"0",10);return isFinite(e)?e:0},M1e=function(){R.useEffect(function(){return document.body.setAttribute(yh,(Mk()+1).toString()),function(){var e=Mk()-1;e<=0?document.body.removeAttribute(yh):document.body.setAttribute(yh,e.toString())}},[])},k1e=function(e){var t=e.noRelative,n=e.noImportant,i=e.gapMode,r=i===void 0?"margin":i;M1e();var s=R.useMemo(function(){return x1e(r)},[r]);return R.createElement(C1e,{styles:A1e(s,!t,r,n?"":"!important")})},Uv=!1;if(typeof window<"u")try{var qU=Object.defineProperty({},"passive",{get:function(){return Uv=!0,!0}});window.addEventListener("test",qU,qU),window.removeEventListener("test",qU,qU)}catch{Uv=!1}var df=Uv?{passive:!1}:!1,R1e=function(e){return e.tagName==="TEXTAREA"},D$=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!R1e(e)&&n[t]==="visible")},D1e=function(e){return D$(e,"overflowY")},L1e=function(e){return D$(e,"overflowX")},kk=function(e,t){var n=t.ownerDocument,i=t;do{typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&(i=i.host);var r=L$(e,i);if(r){var s=N$(e,i),o=s[1],a=s[2];if(o>a)return!0}i=i.parentNode}while(i&&i!==n.body);return!1},N1e=function(e){var t=e.scrollTop,n=e.scrollHeight,i=e.clientHeight;return[t,n,i]},O1e=function(e){var t=e.scrollLeft,n=e.scrollWidth,i=e.clientWidth;return[t,n,i]},L$=function(e,t){return e==="v"?D1e(t):L1e(t)},N$=function(e,t){return e==="v"?N1e(t):O1e(t)},P1e=function(e,t){return e==="h"&&t==="rtl"?-1:1},F1e=function(e,t,n,i,r){var s=P1e(e,window.getComputedStyle(t).direction),o=s*i,a=n.target,l=t.contains(a),c=!1,d=o>0,u=0,f=0;do{var h=N$(e,a),m=h[0],p=h[1],U=h[2],b=p-U-s*m;(m||b)&&L$(e,a)&&(u+=b,f+=m),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(t.contains(a)||t===a));return(d&&Math.abs(u)<1||!d&&Math.abs(f)<1)&&(c=!0),c},QU=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Rk=function(e){return[e.deltaX,e.deltaY]},Dk=function(e){return e&&"current"in e?e.current:e},B1e=function(e,t){return e[0]===t[0]&&e[1]===t[1]},z1e=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},H1e=0,uf=[];function V1e(e){var t=R.useRef([]),n=R.useRef([0,0]),i=R.useRef(),r=R.useState(H1e++)[0],s=R.useState(R$)[0],o=R.useRef(e);R.useEffect(function(){o.current=e},[e]),R.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(r));var p=c1e([e.lockRef.current],(e.shards||[]).map(Dk),!0).filter(Boolean);return p.forEach(function(U){return U.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),p.forEach(function(U){return U.classList.remove("allow-interactivity-".concat(r))})}}},[e.inert,e.lockRef.current,e.shards]);var a=R.useCallback(function(p,U){if("touches"in p&&p.touches.length===2||p.type==="wheel"&&p.ctrlKey)return!o.current.allowPinchZoom;var b=QU(p),y=n.current,w="deltaX"in p?p.deltaX:y[0]-b[0],v="deltaY"in p?p.deltaY:y[1]-b[1],I,C=p.target,_=Math.abs(w)>Math.abs(v)?"h":"v";if("touches"in p&&_==="h"&&C.type==="range")return!1;var T=kk(_,C);if(!T)return!0;if(T?I=_:(I=_==="v"?"h":"v",T=kk(_,C)),!T)return!1;if(!i.current&&"changedTouches"in p&&(w||v)&&(i.current=I),!I)return!0;var k=i.current||I;return F1e(k,U,p,k==="h"?w:v)},[]),l=R.useCallback(function(p){var U=p;if(!(!uf.length||uf[uf.length-1]!==s)){var b="deltaY"in U?Rk(U):QU(U),y=t.current.filter(function(I){return I.name===U.type&&(I.target===U.target||U.target===I.shadowParent)&&B1e(I.delta,b)})[0];if(y&&y.should){U.cancelable&&U.preventDefault();return}if(!y){var w=(o.current.shards||[]).map(Dk).filter(Boolean).filter(function(I){return I.contains(U.target)}),v=w.length>0?a(U,w[0]):!o.current.noIsolation;v&&U.cancelable&&U.preventDefault()}}},[]),c=R.useCallback(function(p,U,b,y){var w={name:p,delta:U,target:b,should:y,shadowParent:$1e(b)};t.current.push(w),setTimeout(function(){t.current=t.current.filter(function(v){return v!==w})},1)},[]),d=R.useCallback(function(p){n.current=QU(p),i.current=void 0},[]),u=R.useCallback(function(p){c(p.type,Rk(p),p.target,a(p,e.lockRef.current))},[]),f=R.useCallback(function(p){c(p.type,QU(p),p.target,a(p,e.lockRef.current))},[]);R.useEffect(function(){return uf.push(s),e.setCallbacks({onScrollCapture:u,onWheelCapture:u,onTouchMoveCapture:f}),document.addEventListener("wheel",l,df),document.addEventListener("touchmove",l,df),document.addEventListener("touchstart",d,df),function(){uf=uf.filter(function(p){return p!==s}),document.removeEventListener("wheel",l,df),document.removeEventListener("touchmove",l,df),document.removeEventListener("touchstart",d,df)}},[]);var h=e.removeScrollBar,m=e.inert;return R.createElement(R.Fragment,null,m?R.createElement(s,{styles:z1e(r)}):null,h?R.createElement(k1e,{gapMode:e.gapMode}):null)}function $1e(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const G1e=b1e(k$,V1e);var O$=R.forwardRef(function(e,t){return R.createElement(Sy,No({},e,{ref:t,sideCar:G1e}))});O$.classNames=Sy.classNames;var UT="Popover",[P$,RAe]=Op(UT,[U$]),Fp=U$(),[X1e,dd]=P$(UT),F$=e=>{const{__scopePopover:t,children:n,open:i,defaultOpen:r,onOpenChange:s,modal:o=!1}=e,a=Fp(t),l=R.useRef(null),[c,d]=R.useState(!1),[u=!1,f]=pT({prop:i,defaultProp:r,onChange:s});return g(qge,{...a,children:g(X1e,{scope:t,contentId:oT(),triggerRef:l,open:u,onOpenChange:f,onOpenToggle:R.useCallback(()=>f(h=>!h),[f]),hasCustomAnchor:c,onCustomAnchorAdd:R.useCallback(()=>d(!0),[]),onCustomAnchorRemove:R.useCallback(()=>d(!1),[]),modal:o,children:n})})};F$.displayName=UT;var B$="PopoverAnchor",j1e=R.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,r=dd(B$,n),s=Fp(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:a}=r;return R.useEffect(()=>(o(),()=>a()),[o,a]),g(S$,{...s,...i,ref:t})});j1e.displayName=B$;var z$="PopoverTrigger",H$=R.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,r=dd(z$,n),s=Fp(n),o=ho(t,r.triggerRef),a=g(br.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":Y$(r.open),...i,ref:o,onClick:Di(e.onClick,r.onOpenToggle)});return r.hasCustomAnchor?a:g(S$,{asChild:!0,...s,children:a})});H$.displayName=z$;var bT="PopoverPortal",[Y1e,W1e]=P$(bT,{forceMount:void 0}),V$=e=>{const{__scopePopover:t,forceMount:n,children:i,container:r}=e,s=dd(bT,t);return g(Y1e,{scope:t,forceMount:n,children:g(Iy,{present:n||s.open,children:g(x$,{asChild:!0,container:r,children:i})})})};V$.displayName=bT;var qh="PopoverContent",$$=R.forwardRef((e,t)=>{const n=W1e(qh,e.__scopePopover),{forceMount:i=n.forceMount,...r}=e,s=dd(qh,e.__scopePopover);return g(Iy,{present:i||s.open,children:s.modal?g(K1e,{...r,ref:t}):g(Z1e,{...r,ref:t})})});$$.displayName=qh;var K1e=R.forwardRef((e,t)=>{const n=dd(qh,e.__scopePopover),i=R.useRef(null),r=ho(t,i),s=R.useRef(!1);return R.useEffect(()=>{const o=i.current;if(o)return l1e(o)},[]),g(O$,{as:Tm,allowPinchZoom:!0,children:g(G$,{...e,ref:r,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Di(e.onCloseAutoFocus,o=>{var a;o.preventDefault(),s.current||(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:Di(e.onPointerDownOutside,o=>{const a=o.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;s.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Di(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),Z1e=R.forwardRef((e,t)=>{const n=dd(qh,e.__scopePopover),i=R.useRef(!1),r=R.useRef(!1);return g(G$,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var o,a;(o=e.onCloseAutoFocus)==null||o.call(e,s),s.defaultPrevented||(i.current||(a=n.triggerRef.current)==null||a.focus(),s.preventDefault()),i.current=!1,r.current=!1},onInteractOutside:s=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,s),s.defaultPrevented||(i.current=!0,s.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const o=s.target;((c=n.triggerRef.current)==null?void 0:c.contains(o))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&r.current&&s.preventDefault()}})}),G$=R.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:i,onOpenAutoFocus:r,onCloseAutoFocus:s,disableOutsidePointerEvents:o,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:d,...u}=e,f=dd(qh,n),h=Fp(n);return Nhe(),g(i$,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:r,onUnmountAutoFocus:s,children:g(t$,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:d,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>f.onOpenChange(!1),children:g(Qge,{"data-state":Y$(f.open),role:"dialog",id:f.contentId,...h,...u,ref:t,style:{...u.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),X$="PopoverClose",q1e=R.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,r=dd(X$,n);return g(br.button,{type:"button",...i,ref:t,onClick:Di(e.onClick,()=>r.onOpenChange(!1))})});q1e.displayName=X$;var Q1e="PopoverArrow",j$=R.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,r=Fp(n);return g(Jge,{...r,...i,ref:t})});j$.displayName=Q1e;function Y$(e){return e?"open":"closed"}var Sl=F$,xl=H$,J1e=V$,xy=$$,W$=j$;const K$=()=>g("div",{style:{width:1,height:"1rem",backgroundColor:"var(--default-border-color)",margin:"0 auto"}}),Z$=de.createContext(null),ai=()=>de.useContext(Z$),q$=e=>{const[t,n]=R.useState(null),i=Nn(),{theme:r}=ai(),{container:s}=Dr();return R.useLayoutEffect(()=>{var o;t&&(t.className="",t.classList.add("excalidraw",...((o=e==null?void 0:e.className)==null?void 0:o.split(/\s+/))||[]),t.classList.toggle("excalidraw--mobile",i.formFactor==="phone"),t.classList.toggle("theme--dark",r===ke.DARK))},[t,r,i.formFactor,e==null?void 0:e.className]),R.useLayoutEffect(()=>{const o=e!=null&&e.parentSelector?s==null?void 0:s.querySelector(e.parentSelector):document.body;if(!o)return;const a=document.createElement("div");return o.appendChild(a),n(a),()=>{o.removeChild(a)}},[s,e==null?void 0:e.parentSelector]),t};function yT(e,t,n){R.useEffect(()=>{function i(r){const s=r;if(!e.current)return;const o=n==null?void 0:n(s,e.current);if(o===!0)return;if(o===!1)return t(s);e.current.contains(s.target)||!document.documentElement.contains(s.target)||s.target.closest("[data-radix-portal]")||s.target===document.documentElement&&document.body.style.pointerEvents==="none"||s.target.closest("[data-prevent-outside-click]")||t(s)}return document.addEventListener(te.POINTER_DOWN,i),document.addEventListener(te.TOUCH_START,i),()=>{document.removeEventListener(te.POINTER_DOWN,i),document.removeEventListener(te.TOUCH_START,i)}},[e,t,n])}const Cy=e=>{const t=R.useRef(e);return Object.assign(t.current,e),t.current},Ay=Wt(null),e0e=({onCancel:e,onChange:t,onSelect:n,colorPickerType:i})=>{const r=q$({className:"excalidraw-eye-dropper-backdrop",parentSelector:".excalidraw-eye-dropper-container"}),s=ai(),o=sE(),a=bo(),l=Xe(o,s),c=Cy({app:a,onCancel:e,onChange:t,onSelect:n,selectedElements:l}),{container:d}=Dr();R.useEffect(()=>{const f=u.current;if(!f||!a.canvas||!r)return;let h=!1;const m=a.canvas.getContext("2d"),p=({clientX:C,clientY:_})=>{const T=m.getImageData((C-s.offsetLeft)*window.devicePixelRatio,(_-s.offsetTop)*window.devicePixelRatio,1,1).data;return Rre(T[0],T[1],T[2])},U=({clientX:C,clientY:_,altKey:T})=>{f.style.top=`${_+20}px`,f.style.left=`${C+20}px`;const k=p({clientX:C,clientY:_});h&&c.onChange(i,k,c.selectedElements,{altKey:T}),f.style.background=k},b=()=>{c.onCancel()},y=(C,_)=>{c.onSelect(C,_)},w=C=>{h=!0,C.stopImmediatePropagation()},v=C=>{h=!1,d==null||d.focus(),C.stopImmediatePropagation(),C.preventDefault(),y(p(C),C)},I=C=>{C.key===V.ESCAPE&&(C.preventDefault(),C.stopImmediatePropagation(),b())};return r.tabIndex=-1,r.focus(),U({clientX:c.app.lastViewportPosition.x,clientY:c.app.lastViewportPosition.y,altKey:!1}),r.addEventListener(te.KEYDOWN,I),r.addEventListener(te.POINTER_DOWN,w),r.addEventListener(te.POINTER_UP,v),window.addEventListener("pointermove",U,{passive:!0}),window.addEventListener(te.BLUR,b),()=>{h=!1,r.removeEventListener(te.KEYDOWN,I),r.removeEventListener(te.POINTER_DOWN,w),r.removeEventListener(te.POINTER_UP,v),window.removeEventListener("pointermove",U),window.removeEventListener(te.BLUR,b)}},[c,a.canvas,r,i,d,s.offsetLeft,s.offsetTop]);const u=R.useRef(null);return yT(u,()=>{e()},f=>!!f.target.closest(".excalidraw-eye-dropper-trigger, .excalidraw-eye-dropper-backdrop")),r?mi.createPortal(g("div",{ref:u,className:"excalidraw-eye-dropper-preview"}),r):null},Is=de.forwardRef(({children:e,padding:t,className:n,style:i},r)=>g("div",{className:le("Island",n),style:{"--padding":t,...i},ref:r,children:e})),Ag=de.forwardRef(({className:e,container:t,children:n,style:i,onClose:r,onKeyDown:s,onFocusOutside:o,onPointerLeave:a,onPointerDownOutside:l,preventAutoFocusOnTouch:c=!1},d)=>{const u=Nn(),f=u.formFactor==="phone"&&!u.isLandscape;return g(J1e,{container:t,children:N(xy,{ref:d,className:le("focus-visible-none",e),"data-prevent-outside-click":!0,side:f?"bottom":"right",align:f?"center":"start",alignOffset:-16,sideOffset:20,collisionBoundary:t??void 0,style:{zIndex:"var(--zIndex-ui-styles-popup)",marginLeft:u.formFactor==="phone"?"0.5rem":void 0},onPointerLeave:a,onKeyDown:s,onFocusOutside:o,onPointerDownOutside:l,onOpenAutoFocus:h=>{c&&u.isTouchScreen&&h.preventDefault()},onCloseAutoFocus:h=>{h.stopPropagation(),h.preventDefault(),t&&!Gse(document.activeElement)&&t.focus(),r()},children:[g(Is,{padding:3,style:i,children:n}),g(W$,{width:20,height:10,style:{fill:"var(--popup-bg-color)",filter:"drop-shadow(rgba(0, 0, 0, 0.05) 0px 3px 2px)"}})]})})}),My=()=>document.querySelector(".excalidraw-wysiwyg"),ET=()=>{const e=My();return e?{start:e.selectionStart,end:e.selectionEnd}:null},vT=e=>{setTimeout(()=>{const t=My();t&&(t.focus(),e&&(t.selectionStart=e.start,t.selectionEnd=e.end))},0)},ky=(e,t,n,i)=>{t&&i&&i();const r=t&&n?ET():null;e(),t&&n&&vT(r)},t0e=()=>{const[e,t]=R.useState(null),n=R.useCallback(()=>{const s=ET();t(s)},[]),i=R.useCallback(()=>{setTimeout(()=>{const s=My();s&&(s.focus(),e&&(s.selectionStart=e.start,s.selectionEnd=e.end,t(null)))},0)},[e]),r=R.useCallback(()=>{t(null)},[]);return{saveCaretPosition:n,restoreCaretPosition:i,clearSavedPosition:r,hasSavedPosition:!!e}},n0e=(e=100)=>{const t=My();if(t){const n=t.onblur;t.onblur=null,setTimeout(()=>{t.onblur=n},e)}},Ry=({palette:e,color:t})=>{if(!t)return null;for(const[n,i]of Object.entries(e))if(Array.isArray(i)){const r=i.indexOf(t);if(r>-1)return{colorName:n,shade:r}}else if(i===t)return{colorName:n,shade:null};return null},bv=[["q","w","e","r","t"],["a","s","d","f","g"],["z","x","c","v","b"]].flat(),Q$=({color:e,palette:t})=>!Object.values(t).flat().includes(e),i0e=(e,t,n)=>{const i={elementBackground:"backgroundColor",elementStroke:"strokeColor"},r=e.filter(o=>{if(o.isDeleted)return!1;const a=o[i[t]];return Q$({color:a,palette:n})}),s=new Map;return r.forEach(o=>{const a=o[i[t]];s.has(a)?s.set(a,s.get(a)+1):s.set(a,1)}),[...s.entries()].sort((o,a)=>a[1]-o[1]).map(o=>o[0]).slice(0,xre)},Mg=Wt(null),Lk=(e,t,n)=>(e*299+t*587+n*114)/1e3,H6=(e,t=160)=>{if(!e)return!0;if(e==="transparent")return!1;if(!e.startsWith("#")){const s=document.createElement("div");if(s.style.color=e,s.style.color){s.style.position="absolute",s.style.visibility="hidden",s.style.width="0",s.style.height="0",document.body.appendChild(s);const o=getComputedStyle(s).color;document.body.removeChild(s);const a=o.replace(/^(rgb|rgba)\(/,"").replace(/\)$/,"").replace(/\s/g,"").split(","),l=parseInt(a[0]),c=parseInt(a[1]),d=parseInt(a[2]);return Lk(l,c,d)<t}return!0}const n=parseInt(e.slice(1,3),16),i=parseInt(e.slice(3,5),16),r=parseInt(e.slice(5,7),16);return Lk(n,i,r)<t},r0e=({color:e,onChange:t,label:n,colorPickerType:i,placeholder:r})=>{const s=Nn(),[o,a]=R.useState(e),[l,c]=un(Mg);R.useEffect(()=>{a(e)},[e]);const d=R.useCallback(p=>{const U=p.toLowerCase(),b=f0e(U);b&&t(b),a(U)},[t]),u=R.useRef(null),f=R.useRef(null);R.useEffect(()=>{u.current&&u.current.focus()},[l]);const[h,m]=un(Ay);return R.useEffect(()=>()=>{m(null)},[m]),N("div",{className:"color-picker__input-label",children:[g("div",{className:"color-picker__input-hash",children:"#"}),g("input",{ref:l==="hex"?u:void 0,style:{border:0,padding:0},spellCheck:!1,className:"color-picker-input","aria-label":n,onChange:p=>{d(p.target.value)},value:(o||"").replace(/^#/,""),onBlur:()=>{a(e)},tabIndex:-1,onFocus:()=>c("hex"),onKeyDown:p=>{var U;p.key!==V.TAB&&(p.key===V.ESCAPE&&((U=f.current)==null||U.focus()),p.stopPropagation())},placeholder:r}),s.formFactor!=="phone"&&N(fe,{children:[g("div",{style:{width:"1px",height:"1.25rem",backgroundColor:"var(--default-border-color)"}}),g("div",{ref:f,className:le("excalidraw-eye-dropper-trigger",{selected:h}),onClick:()=>m(p=>p?null:{keepOpenOnAlt:!1,onSelect:U=>t(U),colorPickerType:i}),title:`${M("labels.eyeDropper")}  ${V.I.toLocaleUpperCase()} or ${J("Alt")} `,children:Pfe})]})]})},wT=({color:e,keyLabel:t,isShade:n=!1})=>N("div",{className:"color-picker__button__hotkey-label",style:{color:H6(e)?"#fff":"#000"},children:[n&&"",t]}),s0e=({colors:e,color:t,onChange:n,label:i})=>{const[r,s]=un(Mg),o=R.useRef(null);return R.useEffect(()=>{o.current&&o.current.focus()},[t,r]),g("div",{className:"color-picker-content--default",children:e.map((a,l)=>N("button",{ref:t===a?o:void 0,tabIndex:-1,type:"button",className:le("color-picker__button color-picker__button--large has-outline",{active:t===a,"is-transparent":a==="transparent"||!a}),onClick:()=>{n(a),s("custom")},title:a,"aria-label":i,style:{"--swatch-color":a},children:[g("div",{className:"color-picker__button-outline"}),g(wT,{color:a,keyLabel:l+1})]},l))})},o0e=({palette:e,color:t,onChange:n,activeShade:i,showHotKey:r=!0})=>{const s=Ry({color:t,palette:e}),[o,a]=un(Mg),l=R.useRef(null);return R.useEffect(()=>{l.current&&o==="baseColors"&&l.current.focus()},[s==null?void 0:s.colorName,o]),g("div",{className:"color-picker-content--default",children:Object.entries(e).map(([c,d],u)=>{const f=(Array.isArray(d)?d[i]:d)||"transparent",h=bv[u],m=M(`colors.${c.replace(/\d+/,"")}`,null,"");return N("button",{ref:(s==null?void 0:s.colorName)===c?l:void 0,tabIndex:-1,type:"button",className:le("color-picker__button color-picker__button--large has-outline",{active:(s==null?void 0:s.colorName)===c,"is-transparent":f==="transparent"||!1}),onClick:()=>{n(f),a("baseColors")},title:`${m}${f.startsWith("#")?` ${f}`:""}  ${h}`,"aria-label":`${m}  ${h}`,style:{"--swatch-color":f},"data-testid":`color-${c}`,children:[g("div",{className:"color-picker__button-outline"}),r&&g(wT,{color:f,keyLabel:h})]},c)})})},q2=({children:e})=>g("div",{className:"color-picker__heading",children:e}),a0e=({color:e,onChange:t,palette:n,showHotKey:i})=>{const r=Ry({color:e||"transparent",palette:n}),[s,o]=un(Mg),a=R.useRef(null);if(R.useEffect(()=>{a.current&&s==="shades"&&a.current.focus()},[r,s]),r){const{colorName:l,shade:c}=r,d=n[l];if(Array.isArray(d))return g("div",{className:"color-picker-content--default shades",children:d.map((u,f)=>N("button",{ref:f===c&&s==="shades"?a:void 0,tabIndex:-1,type:"button",className:le("color-picker__button color-picker__button--large has-outline",{active:f===c}),"aria-label":"Shade",title:`${l} - ${f+1}`,style:u?{"--swatch-color":u}:void 0,onClick:()=>{t(u),o("shades")},children:[g("div",{className:"color-picker__button-outline"}),i&&g(wT,{color:u,keyLabel:f+1,isShade:!0})]},f))})}return N("div",{className:"color-picker-content--default",style:{position:"relative"},tabIndex:-1,children:[g("button",{type:"button",tabIndex:-1,className:"color-picker__button color-picker__button--large color-picker__button--no-focus-visible"}),g("div",{tabIndex:-1,style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",fontSize:"0.75rem"},children:M("colorPicker.noShades")})]})},a3=(e,t,n)=>{const i=Math.ceil(n/wf);switch(t=t??-1,e){case"ArrowLeft":{const r=t-1;return r<0?n-1:r}case"ArrowRight":return(t+1)%n;case"ArrowDown":{const r=t+wf;return r>=n?t%wf:r}case"ArrowUp":{const r=t-wf,s=r<0?wf*i+r:r;return s>=n?void 0:s}}},l0e=({e,colorObj:t,onChange:n,palette:i,customColors:r,setActiveColorPickerSection:s,activeShade:o})=>{if((t==null?void 0:t.shade)!=null&&["Digit1","Digit2","Digit3","Digit4","Digit5"].includes(e.code)&&e.shiftKey){const a=Number(e.code.slice(-1))-1;return n(i[t.colorName][a]),s("shades"),!0}if(["1","2","3","4","5"].includes(e.key)&&r[Number(e.key)-1])return n(r[Number(e.key)-1]),s("custom"),!0;if(bv.includes(e.key)){const a=bv.indexOf(e.key),l=Object.keys(i)[a],c=i[l],d=Array.isArray(c)?c[o]:c;return n(d),s("baseColors"),!0}return!1},c0e=({event:e,activeColorPickerSection:t,palette:n,color:i,onChange:r,customColors:s,setActiveColorPickerSection:o,updateData:a,activeShade:l,onEyeDropperToggle:c,onEscape:d})=>{if(e[V.CTRL_OR_CMD])return!1;if(e.key===V.ESCAPE)return d(e),!0;if(e.key===V.ALT)return c(!0),!0;if(e.key===V.I)return c(),!0;const u=Ry({color:i,palette:n});if(e.key===V.TAB){const f={custom:!!s.length,baseColors:!0,shades:(u==null?void 0:u.shade)!=null,hex:!0},h=Object.entries(f).reduce((y,[w,v])=>(v&&y.push(w),y),[]),m=h.indexOf(t),p=e.shiftKey?-1:1,U=m+p>h.length-1?0:m+p<0?h.length-1:m+p,b=h[U];return b&&o(b),b==="custom"?r(s[0]):b==="baseColors"&&(Object.entries(n).find(([w,v])=>Array.isArray(v)?v.includes(i):v===i?w:null)||r(Ye.black)),e.preventDefault(),e.stopPropagation(),!0}if(l0e({e,colorObj:u,onChange:r,palette:n,customColors:s,setActiveColorPickerSection:o,activeShade:l}))return!0;if(t==="shades"&&u){const{shade:f}=u,h=a3(e.key,f,wf);if(h!==void 0)return r(n[u.colorName][h]),!0}if(t==="baseColors"&&u){const{colorName:f}=u,h=Object.keys(n),m=h.indexOf(f),p=a3(e.key,m,h.length);if(p!==void 0){const U=h[p],b=n[U];return r(Array.isArray(b)?b[l]:b),!0}}if(t==="custom"){const f=i!=null?s.indexOf(i):0,h=a3(e.key,f,s.length);if(h!==void 0){const m=s[h];return r(m),!0}}return!1},d0e=de.forwardRef(({color:e,onChange:t,type:n,elements:i,palette:r,updateData:s,children:o,showTitle:a,onEyeDropperToggle:l,onEscape:c,showHotKey:d=!0},u)=>{const f=a?n==="elementStroke"?M("labels.stroke"):n==="elementBackground"?M("labels.background"):null:null,[h]=de.useState(()=>n==="canvasBackground"?[]:i0e(i,n,r)),[m,p]=un(Mg),U=Ry({color:e,palette:r});R.useEffect(()=>{if(!m){const v=!!e&&Q$({color:e,palette:r}),I=v&&!h.includes(e);p(I?null:v?"custom":(U==null?void 0:U.shade)!=null?"shades":"baseColors")}},[m,e,r,p,U,h]);const[b,y]=R.useState((U==null?void 0:U.shade)??(n==="elementBackground"?F1:P1));R.useEffect(()=>{(U==null?void 0:U.shade)!=null&&y(U.shade);const v=I=>{I.key===V.ALT&&l(!1)};return document.addEventListener(te.KEYUP,v,{capture:!0}),()=>{document.removeEventListener(te.KEYUP,v,{capture:!0})}},[U,l]);const w=de.useRef(null);return R.useImperativeHandle(u,()=>w.current),R.useEffect(()=>{var v;(v=w==null?void 0:w.current)==null||v.focus()},[]),g("div",{role:"dialog","aria-modal":"true","aria-label":M("labels.colorPicker"),children:N("div",{ref:w,onKeyDown:v=>{c0e({event:v,activeColorPickerSection:m,palette:r,color:e,onChange:t,onEyeDropperToggle:l,customColors:h,setActiveColorPickerSection:p,updateData:s,activeShade:b,onEscape:c})&&(v.preventDefault(),v.stopPropagation())},className:"color-picker-content properties-content",tabIndex:-1,children:[f&&g("div",{className:"color-picker__title",children:f}),!!h.length&&N("div",{children:[g(q2,{children:M("colorPicker.mostUsedCustomColors")}),g(s0e,{colors:h,color:e,label:M("colorPicker.mostUsedCustomColors"),onChange:t})]}),N("div",{children:[g(q2,{children:M("colorPicker.colors")}),g(o0e,{color:e,palette:r,onChange:t,activeShade:b,showHotKey:d})]}),N("div",{children:[g(q2,{children:M("colorPicker.shades")}),g(a0e,{color:e,onChange:t,palette:r,showHotKey:d})]}),o]})})}),u0e=({onChange:e,type:t,activeColor:n,topPicks:i})=>{let r;return t==="elementStroke"&&(r=cB),t==="elementBackground"&&(r=dB),t==="canvasBackground"&&(r=uB),i&&(r=i),r?g("div",{className:"color-picker__top-picks",children:r.map(s=>g("button",{className:le("color-picker__button",{active:s===n,"is-transparent":s==="transparent"||!s,"has-outline":!H6(s,E4)}),style:{"--swatch-color":s},type:"button",title:s,onClick:()=>e(s),"data-testid":`color-top-pick-${s}`,children:g("div",{className:"color-picker__button-outline"})},s))}):(console.error("Invalid type for TopPicks"),null)},Nk=e=>{const t=new Option().style;return t.color=e,!!t.color},f0e=e=>Ir(e)?e:Nk(`#${e}`)?`#${e}`:Nk(e)?e:null,h0e=({type:e,color:t,onChange:n,label:i,elements:r,palette:s=Ye,updateData:o,getOpenPopup:a,appState:l})=>{const{container:c}=Dr(),d=fa(),u=d!=="full",f=d==="mobile",[,h]=un(Mg),[m,p]=un(Ay),U=N("div",{children:[g(q2,{children:M("colorPicker.hexCode")}),g(r0e,{color:t||"",label:i,onChange:w=>{n(w)},colorPickerType:e,placeholder:M("colorPicker.color")})]}),b=R.useRef(null),y=()=>{var w;(w=b.current)==null||w.focus()};return g(Ag,{container:c,style:{maxWidth:"13rem"},preventAutoFocusOnTouch:!!l.editingTextElement,onFocusOutside:w=>{Na(w.target)||y(),w.preventDefault()},onPointerDownOutside:w=>{m&&w.preventDefault()},onClose:()=>{a()===e&&o({openPopup:null}),h(null),l.editingTextElement&&setTimeout(()=>{const w=document.querySelector(".excalidraw-wysiwyg");w&&w.focus()},0)},children:s?g(d0e,{ref:b,palette:s,color:t,onChange:w=>{const v=l.editingTextElement?ET():null;n(w),l.editingTextElement&&v&&vT(v)},onEyeDropperToggle:w=>{p(v=>w?(v=v||{keepOpenOnAlt:!0,onSelect:n,colorPickerType:e},v.keepOpenOnAlt=!0,v):w===!1||v?null:{keepOpenOnAlt:!1,onSelect:n,colorPickerType:e})},onEscape:w=>{m?p(null):o({openPopup:null})},type:e,elements:r,updateData:o,showTitle:u,showHotKey:!f,children:U}):U})},g0e=({label:e,color:t,type:n,mode:i="background",onToggle:r,editingTextElement:s})=>{const o=fa(),a=o!=="full",l=o==="mobile",c=d=>{d.preventDefault(),d.stopPropagation(),s&&n0e(),r()};return N(xl,{type:"button",className:le("color-picker__button active-color properties-trigger",{"is-transparent":!t||t==="transparent","has-outline":!t||!H6(t,E4),"compact-sizing":a,"mobile-border":l}),"aria-label":e,style:t?{"--swatch-color":t}:void 0,title:M(n==="elementStroke"?"labels.showStroke":"labels.showBackground"),"data-openpopup":n,onClick:c,children:[g("div",{className:"color-picker__button-outline",children:!t&&Fue}),a&&t&&i==="stroke"&&g("div",{className:"color-picker__button-background",children:g("span",{style:{color:t&&H6(t,E4)?"#fff":"#111"},children:she})})]})},_T=({type:e,color:t,onChange:n,label:i,elements:r,palette:s=Ye,topPicks:o,updateData:a,appState:l})=>{const c=R.useRef(l.openPopup);R.useEffect(()=>{c.current=l.openPopup},[l.openPopup]);const u=fa()!=="full";return g("div",{children:N("div",{role:"dialog","aria-modal":"true",className:le("color-picker-container",{"color-picker-container--no-top-picks":u}),children:[!u&&g(u0e,{activeColor:t,onChange:n,type:e,topPicks:o}),!u&&g(K$,{}),N(Sl,{open:l.openPopup===e,onOpenChange:f=>{f&&a({openPopup:e})},children:[g(g0e,{color:t,label:i,type:e,mode:e==="elementStroke"?"stroke":"background",editingTextElement:!!l.editingTextElement,onToggle:()=>{l.openPopup===e?a({openPopup:null}):l.openPopup?a({openPopup:e}):a({openPopup:e})}}),l.openPopup===e&&g(h0e,{type:e,color:t,onChange:n,label:i,elements:r,palette:s,updateData:a,getOpenPopup:()=>c.current,appState:l})]})]})})},m0e="/excalidraw/fonts/CascadiaCode/CascadiaCode-Regular.woff2",p0e=[{uri:m0e}],U0e="/excalidraw/fonts/ComicShanns/ComicShanns-Regular-279a7b317d12eb88de06167bd672b4b4.woff2",b0e="/excalidraw/fonts/ComicShanns/ComicShanns-Regular-6e066e8de2ac57ea9283adb9c24d7f0c.woff2",y0e="/excalidraw/fonts/ComicShanns/ComicShanns-Regular-dc6a8806fa96795d7b3be5026f989a17.woff2",E0e="/excalidraw/fonts/ComicShanns/ComicShanns-Regular-fcb0fc02dcbee4c9846b3e2508668039.woff2",v0e=[{uri:U0e,descriptors:{unicodeRange:"U+20-7e,U+a1-a6,U+a8,U+ab-ac,U+af-b1,U+b4,U+b8,U+bb-bc,U+bf-cf,U+d1-d7,U+d9-de,U+e0-ef,U+f1-f7,U+f9-ff,U+131,U+152-153,U+2c6,U+2da,U+2dc,U+2013-2014,U+2018-201a,U+201c-201d,U+2020-2022,U+2026,U+2039-203a,U+2044,U+20ac,U+2191,U+2193,U+2212"}},{uri:E0e,descriptors:{unicodeRange:"U+100-10f,U+112-125,U+128-130,U+134-137,U+139-13c,U+141-148,U+14c-151,U+154-161,U+164-165,U+168-17f,U+1bf,U+1f7,U+218-21b,U+237,U+1e80-1e85,U+1ef2-1ef3,U+a75b"}},{uri:y0e,descriptors:{unicodeRange:"U+2c7,U+2d8-2d9,U+2db,U+2dd,U+315,U+2190,U+2192,U+2200,U+2203-2204,U+2264-2265,U+f6c3"}},{uri:b0e,descriptors:{unicodeRange:"U+3bb"}}],w0e=[{uri:V_}];class _0e{constructor(t){F(this,"instance");F(this,"debounceTerminate");this.instance=new Worker(t,{type:"module"})}}class TT{constructor(t,n){F(this,"idleWorkers",new Set);F(this,"workerUrl");F(this,"workerTTL");this.workerUrl=t,this.workerTTL=n.ttl||1e3}static create(t,n={}){if(!t)throw new ZV;if(!import.meta.url||t.toString()===import.meta.url)throw new qV;return new TT(t,n)}async postMessage(t,n){let i;const r=Array.from(this.idleWorkers).shift();return r?(this.idleWorkers.delete(r),i=r):i=await this.createWorker(),new Promise((s,o)=>{i.instance.onmessage=this.onMessageHandler(i,s),i.instance.onerror=this.onErrorHandler(i,o),i.instance.postMessage(t,n),i.debounceTerminate(()=>o(new Error(`Active worker did not respond for ${this.workerTTL}ms!`)))})}async clear(){for(const t of this.idleWorkers)t.debounceTerminate.cancel(),t.instance.terminate();this.idleWorkers.clear()}async createWorker(){const t=new _0e(this.workerUrl);return t.debounceTerminate=ll(n=>{t.instance.terminate(),this.idleWorkers.has(t)?(this.idleWorkers.delete(t),console.debug("Job finished! Idle worker has been released from the pool.")):n?n():console.error("Worker has been terminated!")},this.workerTTL),t}onMessageHandler(t,n){return i=>{t.debounceTerminate(),this.idleWorkers.add(t),n(i.data)}}onErrorHandler(t,n){return i=>{t.debounceTerminate(()=>n(i)),t.debounceTerminate.flush(),this.clear()}}}let Ok=typeof Worker<"u";const T0e=async(e,t)=>{const{Commands:n,subsetToBase64:i,toBase64:r}=await S0e();return Ok?Hc(async()=>{try{const s=await x0e(),o=e.slice(0),a=await s.postMessage({command:n.Subset,arrayBuffer:o,codePoints:t},{transfer:[o]});return r(a)}catch(s){return Ok=!1,roe()&&(s instanceof ZV||s instanceof qV)||console.error("Failed to use workers for subsetting, falling back to the main thread.",s),i(e,t)}}):i(e,t)};let l3=null,c3=null;const I0e=async()=>(l3||(l3=ye(()=>import("./subset-worker.chunk-CVR6pt27.js"),__vite__mapDeps([0,1]))),l3),S0e=async()=>(c3||(c3=ye(()=>import("./subset-shared.chunk-D3ioWSie.js"),__vite__mapDeps([]))),c3);let d3=null;const x0e=()=>(d3||(d3=Hc(async()=>{const{WorkerUrl:e}=await I0e();return TT.create(e)})),d3);var u3={};const Jf=class Jf{constructor(t,n,i){F(this,"urls");F(this,"fontFace");this.urls=Jf.createUrls(n);const r=this.urls.map(s=>`url(${s}) ${Jf.getFormat(s)}`).join(", ");this.fontFace=new FontFace(t,r,{display:"swap",style:"normal",weight:"400",...i})}toCSS(t){if(!this.getUnicodeRangeRegex().test(t))return;const n=Array.from(t).map(i=>i.codePointAt(0));return this.getContent(n).then(i=>`@font-face { font-family: ${this.fontFace.family}; src: url(${i}); }`)}async getContent(t){let n=0;const i=[];for(;n<this.urls.length;){const r=this.urls[n];try{const s=await this.fetchFont(r);return await T0e(s,t)}catch(s){i.push(`"${r.toString()}" returned error "${s}"`)}n++}return console.error(`Failed to fetch font family "${this.fontFace.family}"`,JSON.stringify(i,void 0,2)),this.urls.length?this.urls[this.urls.length-1].toString():""}fetchFont(t){return Hc(async()=>{const n=await fetch(t,{cache:"force-cache",headers:{Accept:"font/woff2"}});if(!n.ok){const r=t instanceof URL?t.toString():"dataurl";throw new Error(`Failed to fetch "${r}": ${n.statusText}`)}return await n.arrayBuffer()})}getUnicodeRangeRegex(){const t=this.fontFace.unicodeRange.split(/,\s*/).map(n=>{const[i,r]=n.replace("U+","").split("-");return r?`\\u{${i}}-\\u{${r}}`:`\\u{${i}}`}).join("");return new RegExp(`[${t}]`,"u")}static createUrls(t){if(t.startsWith("data"))return[t];if(t.startsWith(V_))return[];if(t.startsWith("http"))return[new URL(t)];const n=t.replace(/^\/+/,""),i=[];if(typeof window.EXCALIDRAW_ASSET_PATH=="string"){const r=this.normalizeBaseUrl(window.EXCALIDRAW_ASSET_PATH);i.push(new URL(n,r))}else Array.isArray(window.EXCALIDRAW_ASSET_PATH)&&window.EXCALIDRAW_ASSET_PATH.forEach(r=>{const s=this.normalizeBaseUrl(r);i.push(new URL(n,s))});return i.push(new URL(n,Jf.ASSETS_FALLBACK_URL)),i}static getFormat(t){if(!(t instanceof URL))return"";try{const n=new URL(t).pathname.split(".");return n.length===1?"":`format('${n.pop()}')`}catch{return""}}static normalizeBaseUrl(t){var i;let n=t;return/^\.?\//.test(n)&&(n=new URL(n.replace(/^\.?\/+/,""),(i=window==null?void 0:window.location)==null?void 0:i.origin).toString()),n=`${n.replace(/\/+$/,"")}/`,n}};F(Jf,"ASSETS_FALLBACK_URL",`https://esm.sh/${u3.PKG_NAME?`${u3.PKG_NAME}@${u3.PKG_VERSION}`:"@excalidraw/excalidraw"}/dist/prod/`);let yv=Jf;const C0e="/excalidraw/fonts/Excalifont/Excalifont-Regular-349fac6ca4700ffec595a7150a0d1e1d.woff2",A0e="/excalidraw/fonts/Excalifont/Excalifont-Regular-3f2c5db56cc93c5a6873b1361d730c16.woff2",M0e="/excalidraw/fonts/Excalifont/Excalifont-Regular-41b173a47b57366892116a575a43e2b6.woff2",k0e="/excalidraw/fonts/Excalifont/Excalifont-Regular-623ccf21b21ef6b3a0d87738f77eb071.woff2",R0e="/excalidraw/fonts/Excalifont/Excalifont-Regular-a88b72a24fb54c9f94e3b5fdaa7481c9.woff2",D0e="/excalidraw/fonts/Excalifont/Excalifont-Regular-b9dcf9d2e50a1eaf42fc664b50a3fd0d.woff2",L0e="/excalidraw/fonts/Excalifont/Excalifont-Regular-be310b9bcd4f1a43f571c46df7809174.woff2",N0e=[{uri:R0e,descriptors:{unicodeRange:"U+20-7e,U+a0-a3,U+a5-a6,U+a8-ab,U+ad-b1,U+b4,U+b6-b8,U+ba-ff,U+131,U+152-153,U+2bc,U+2c6,U+2da,U+2dc,U+304,U+308,U+2013-2014,U+2018-201a,U+201c-201e,U+2020,U+2022,U+2024-2026,U+2030,U+2039-203a,U+20ac,U+2122,U+2212"}},{uri:L0e,descriptors:{unicodeRange:"U+100-130,U+132-137,U+139-149,U+14c-151,U+154-17e,U+192,U+1fc-1ff,U+218-21b,U+237,U+1e80-1e85,U+1ef2-1ef3,U+2113"}},{uri:D0e,descriptors:{unicodeRange:"U+400-45f,U+490-491,U+2116"}},{uri:M0e,descriptors:{unicodeRange:"U+37e,U+384-38a,U+38c,U+38e-393,U+395-3a1,U+3a3-3a8,U+3aa-3cf,U+3d7"}},{uri:A0e,descriptors:{unicodeRange:"U+2c7,U+2d8-2d9,U+2db,U+2dd,U+302,U+306-307,U+30a-30c,U+326-328,U+212e,U+2211,U+fb01-fb02"}},{uri:C0e,descriptors:{unicodeRange:"U+462-463,U+472-475,U+4d8-4d9,U+4e2-4e3,U+4e6-4e9,U+4ee-4ef"}},{uri:k0e,descriptors:{unicodeRange:"U+300-301,U+303"}}],O0e=[{uri:V_}],P0e="/excalidraw/fonts/LiberationSans/LiberationSans-Regular.woff2",F0e=[{uri:P0e}],B0e="/excalidraw/fonts/Lilita/Lilita-Regular-i7dPIFZ9Zz-WBtRtedDbYE98RXi4EwSsbg.woff2",z0e="/excalidraw/fonts/Lilita/Lilita-Regular-i7dPIFZ9Zz-WBtRtedDbYEF8RXi4EwQ.woff2",H0e=[{uri:B0e,descriptors:{unicodeRange:Ad.LATIN_EXT}},{uri:z0e,descriptors:{unicodeRange:Ad.LATIN}}],V0e="/excalidraw/fonts/Nunito/Nunito-Regular-XRXI3I6Li01BKofiOc5wtlZ2di8HDIkhdTA3j6zbXWjgevT5.woff2",$0e="/excalidraw/fonts/Nunito/Nunito-Regular-XRXI3I6Li01BKofiOc5wtlZ2di8HDIkhdTQ3j6zbXWjgeg.woff2",G0e="/excalidraw/fonts/Nunito/Nunito-Regular-XRXI3I6Li01BKofiOc5wtlZ2di8HDIkhdTk3j6zbXWjgevT5.woff2",X0e="/excalidraw/fonts/Nunito/Nunito-Regular-XRXI3I6Li01BKofiOc5wtlZ2di8HDIkhdTo3j6zbXWjgevT5.woff2",j0e="/excalidraw/fonts/Nunito/Nunito-Regular-XRXI3I6Li01BKofiOc5wtlZ2di8HDIkhdTs3j6zbXWjgevT5.woff2",Y0e=[{uri:G0e,descriptors:{unicodeRange:Ad.CYRILIC_EXT,weight:"500"}},{uri:V0e,descriptors:{unicodeRange:Ad.CYRILIC,weight:"500"}},{uri:j0e,descriptors:{unicodeRange:Ad.VIETNAMESE,weight:"500"}},{uri:X0e,descriptors:{unicodeRange:Ad.LATIN_EXT,weight:"500"}},{uri:$0e,descriptors:{unicodeRange:Ad.LATIN,weight:"500"}}],W0e="/excalidraw/fonts/Virgil/Virgil-Regular.woff2",K0e=[{uri:W0e}],Z0e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-019d66dcad46dc156b162d267f981c20.woff2",q0e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-04b718e5623574919c8b0dea5f301444.woff2",Q0e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-069e77aac84590e2e991d0a0176d34f2.woff2",J0e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-06c77b8c66e51ed6c63ccb502dd8b8af.woff2",eme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-08e0dc436ad0ad61ba5558db0674d762.woff2",tme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-093b9ef39a46ceae95a1df18a0a3a326.woff2",nme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-095c169f3314805276f603a362766abd.woff2",ime="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-09850c4077f3fffe707905872e0e2460.woff2",rme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-41521fade99856108931b4768b1b2648.woff2",sme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-544fc28abe2c5c30e62383fd4dac255f.woff2",ome="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-60a3089806700d379f11827ee9843b6b.woff2",ame="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-7eb9fffd1aa890d07d0f88cc82e6cfe4.woff2",lme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-6fe5c5973cc06f74b2387a631ea36b88.woff2",cme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-a4c34be6d42152e64b0df90bc4607f64.woff2",dme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-b96d9226ce77ec94ceca043d712182e6.woff2",ume="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-6ae5b42180ad70b971c91e7eefb8eba2.woff2",fme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-c69f61a4ab18d0488c8d1fc12e7028e8.woff2",hme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-cb17fc3db95f6d139afc9d31a8e93293.woff2",gme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-e3fcf5180fd466c8915c4e8069491054.woff2",mme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-c1f94158256bb1f3bf665b053d895af9.woff2",pme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-7197d6fda6cba7c3874c53d6381ca239.woff2",Ume="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-70c2eb8d64e71a42a834eb857ea9df51.woff2",bme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-a004ddfcb26e67bd6e678c8ed19e25ce.woff2",yme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-7e4bde7e9c7f84cd34d8a845e384c746.woff2",Eme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-23686f7f29da6e8008c36dd3a80c83d6.woff2",vme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-69c09cc5fa3e55c74fc4821f76909cc3.woff2",wme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-25b7f38e18f035f96cb5e547bd2bd08c.woff2",_me="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-ba3de316d63c7e339987b16f41a0b879.woff2",Tme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-12b52b58eb3df36804b9a654ec9ee194.woff2",Ime="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-b1220a3c61f85cc0408deedb4c5f57a2.woff2",Sme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-4535823663ad81405188a528d8f2b1a2.woff2",xme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-3eaa538115d76932653c21d8dc28f207.woff2",Cme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-7e929f262f30c8ee78bf398150b1a7cd.woff2",Ame="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-73e309718fd16cea44b4d54a33581811.woff2",Mme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-9eb5a99df4e76ac3363453ac9ca288b1.woff2",kme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-3e63ed8162808a9e425ed80a8bc79114.woff2",Rme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-c8b71798409ccc126ee264a00aadcf21.woff2",Dme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-11c345711937f0ba4b8f7b6b919c8440.woff2",Lme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-e480d9c614742d05f0e78f274f1e69e6.woff2",Nme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-95429962233afd82db1c27df1500a28c.woff2",Ome="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-2cf96d082d35ea3d8106851223ad0d16.woff2",Pme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-2d43040e86ff03ba677f6f9c04cd0805.woff2",Fme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-2a26d20a23b00898ce82f09d2ee47c3f.woff2",Bme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-a365e82ed54697a52f27adcea1315fe8.woff2",zme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-e4bca6cfa53e499cae0a6be4894a90e9.woff2",Hme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-e51ef413167c6e14e0c0fdcc585f2fc9.woff2",Vme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-e5f453bb04da18eed01675eeebd88bf8.woff2",$me="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-e656f091b9dc4709722c9f4b84d3c797.woff2",Gme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-f0f13b5c60e0af5553bd359f5513be1b.woff2",Xme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-f5d079153c99a25b9be5b8583c4cc8a7.woff2",jme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-10a7ae9a371830a80c3d844acf1c02d7.woff2",Yme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-60a41c7e1c68f22424e6d22df544bc82.woff2",Wme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-7ab2bed91166a9dca83a5ebfbe2a7f38.woff2",Kme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-670ba603758d94268e8606f240a42e12.woff2",Zme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-15dc6d811c9cd078f9086a740d5a1038.woff2",qme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-8c2f33cee3993174f7e87c28e4bf42ee.woff2",Qme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-761d05e3cd968cf574166867998ef06a.woff2",Jme="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-642b26e2e5f5fb780b51b593dbc8c851.woff2",epe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-5572b3513ba8df57a3d5d7303ee6b11b.woff2",tpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-3c9de2ae0ea4bc91a510942dfa4be8d2.woff2",npe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-671a2c20b1eb9e4ef8a192833940e319.woff2",ipe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-4dc6d5f188d5c96d44815cd1e81aa885.woff2",rpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-ce4884f96f11589608b76b726a755803.woff2",spe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-8f476c4c99813d57cbe6eca4727388ad.woff2",ope="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-5935a5775af3d5c6307ac667bd9ae74e.woff2",ape="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-79f007c1c6d07557120982951ea67998.woff2",lpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-bafff7a14c27403dcc6cf1432e8ea836.woff2",cpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-543fa46ace099a7099dad69123399400.woff2",dpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-4ddc14ed3eb0c3e46364317dfc0144a3.woff2",upe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-0fa55a080fcd0f9dc2e0b0058b793df8.woff2",fpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-66493ba5a8367f2928812f446f47b56a.woff2",hpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-57862b464a55b18c7bf234ce22907d73.woff2",gpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-8d3bcabb847b56243b16afe62adaaf21.woff2",mpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-2b77e8ebfb2367ab2662396a60e7d320.woff2",ppe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-0b5d723fdc4e249c140f0909e87d03b4.woff2",Upe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-cdbce89e82cc1ab53a2decbf5819278f.woff2",bpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-739bc1a567439c7cffcd1614644593d2.woff2",ype="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-72252d73220fa3cd856677888cee1635.woff2",Epe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-cf6ff4e0f491ca0cf3038187a997b9b4.woff2",vpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-9cfb2a77a4e45025105ad29a1748b90d.woff2",wpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-450da755d5bcb70906e1295e559b9602.woff2",_pe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-0986d134c05864f5025962eef9f994a0.woff2",Tpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-1ee544f0f1dac422545c505baa788992.woff2",Ipe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-4806e761d750087c2d734fc64596eaff.woff2",Spe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-33432927cd87d40cfe393c7482bf221f.woff2",xpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-be549ab72f0719d606a5c01e2c0219b6.woff2",Cpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-b5c1596551c256e0e9cf02028595b092.woff2",Ape="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-cf2cc71752631e579e35b0e423bf2638.woff2",Mpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-6f3256af8454371776bc46670d33cc65.woff2",kpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-23f228f3999c01983860012330e4be08.woff2",Rpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-21430ee05a1248901da8d0de08744d47.woff2",Dpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-5330a2119a716e4e7224ed108b085dac.woff2",Lpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-cd145ce4a0ea18469358df53c207bc1b.woff2",Npe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-36925dfe329a45086cbb7fc5c20d45ac.woff2",Ope="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-4bfaa8ffa64c5ee560aa2daba7c9cbd3.woff2",Ppe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-112c051027b2d766c19a519f6ee1f4f7.woff2",Fpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-5b0ed6971aaab9c8ad563230bd5471a7.woff2",Bpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-98f2ad84457de7f3740d9920b8fa8667.woff2",zpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-733171b4ffcd17ea1fe1c0ba627173bf.woff2",Hpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-684d65f1793cac449dde5d59cb3c47fb.woff2",Vpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-cbaaefaaf326668277aa24dfa93c4d28.woff2",$pe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-58fd02350d0bc52cf1ca3bb32ce9766e.woff2",Gpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-7ccce86603f80a099ddb0cb21d4ae3e3.woff2",Xpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-3717077e38f98d89eae729b6c14e56dc.woff2",jpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-dbea1af6dcd9860be40c3d18254338f5.woff2",Ype="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-4a0fdb40036e87b40aa08dd30584cb85.woff2",Wpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-0f626226ba1272e832aea87bafd9720e.woff2",Kpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-938d90c10ff8c20386af7f242c05d6b0.woff2",Zpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-b6d128682ee29e471486354d486a1b90.woff2",qpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-9d81066dd2b337c938df6e90380a00dc.woff2",Qpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-20e7bf72fa05de9adf7dbcc7bf51dde6.woff2",Jpe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-4095eb84ef3874e2600247bee0b04026.woff2",eUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-4ee10ae43505e2e0bc62656ced49c0fa.woff2",tUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-7494dc504ae00ee9cd0505f990f88c5d.woff2",nUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-8de5b863cb50dfefdd07cb11c774d579.woff2",iUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-3e1f8f654357353bf0e04ba5c34b5f7f.woff2",rUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-2e33e8dc771ef5e1d9127d60a6b73679.woff2",sUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-173945821411c09f70c95f98d590e697.woff2",oUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-b358f7a51ece39a3247942b1feabdb29.woff2",aUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-23ad2d71b280f00b1363b95b7bea94eb.woff2",lUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-5882ffa04f32584d26109137e2da4352.woff2",cUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-a203b91dad570bf05a58c3c3ddb529bf.woff2",dUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-bd77e3c7f9e0b072d96af37f73d1aa32.woff2",uUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-5a45d991244d4c7140217e1e5f5ca4f4.woff2",fUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-f56414bf9bced67990def8660e306759.woff2",hUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-583d166e56ba0de4b77eabb47ef67839.woff2",gUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-7f855356ab893b0d2b9c1c83b8116f0e.woff2",mUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-b57aaedfd8ebdf3931f25119dc6a5eb2.woff2",pUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-b6fd38ca30869792244804b04bc058da.woff2",UUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-452225341522a7942f0f6aab1a5c91a3.woff2",bUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-866fa7613df6b3fd272bcfd4530c0bb9.woff2",yUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-52a84a22fd1369bffeaf21da2d6158dc.woff2",EUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-829615148e6357d826b9242eb7fbbd1e.woff2",vUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-c99eda15fc26a2941579560f76c3a5cf.woff2",wUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-395c35dd584b56b0789f58a0559beaf1.woff2",_Ue="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-203b0e569e3b14aac86a003dc3fa523e.woff2",TUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-51a0e808bbc8361236ac521a119758a3.woff2",IUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-6e092f71c1e634059ada0e52abadce67.woff2",SUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-0f7fb1e0d5015bb1371343153ecf7ce3.woff2",xUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-d0cf73942fea1c74edbdf0b3011f4656.woff2",CUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-968cffdc8ee679da094e77ebf50f58ef.woff2",AUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-7a07ddc0f0c0f5f4a9bad6ee3dda66b5.woff2",MUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-ec181b795ac1fb5a50d700b6e996d745.woff2",kUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-cfb211578629b7e8153b37240de6a9d5.woff2",RUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-59e9ff77b0efaf684bc09274fb6908c9.woff2",DUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-2adbc89c11e65905393d3dfc468b9d5b.woff2",LUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-70e811fd7994e61f408c923de6ddd078.woff2",NUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-c4a687ac4f0c2766eefc9f77ed99cddf.woff2",OUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-51502f1206be09c565f1547c406e9558.woff2",PUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-1fdc0c67ed57263a80fd108c1f6ccf24.woff2",FUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-e11567fd2accf9957cd0d3c2be937d87.woff2",BUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-20cc1bbf50e7efb442756cb605672c1f.woff2",zUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-5d2898fbc097a7e24c6f38d80587621e.woff2",HUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-ac9ceb44437becc3e9c4dbfebab7fc2d.woff2",VUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-c16ed9740b85badf16e86ea782a3062f.woff2",$Ue="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-aa0d470430e6391eca720c7cfa44446f.woff2",GUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-f2b54d4e7be0eaefe1c2c56836fa5368.woff2",XUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-99a16ef6a64934d5781933dbd9c46b2e.woff2",jUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-c40533fdf4cc57177b12803598af7e59.woff2",YUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-91ddb2969bf2d31ba02ad82998d1314c.woff2",WUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-774d4f764a1299da5d28ec2f2ffe0d69.woff2",KUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-7718fe60986d8b42b1be9c5ace5ccf25.woff2",ZUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-aa5c9ca6cf4fba00433b7aa3fa10671a.woff2",qUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-4f50e5136e136527280bc902c5817561.woff2",QUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-a0ca5df4258213d7fc9fce80f65ce760.woff2",JUe="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-d2666cbed13462c5dc36fa2f15c202ca.woff2",e2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-1e6fd68f1f3902ce48ce8c69df385622.woff2",t2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-87599f94b6cc129d505b375798d0d751.woff2",n2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-13ae07ed2e272d26d59bc0691cd7117a.woff2",i2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-353f33792a8f60dc69323ddf635a269e.woff2",r2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-0facdf1ea213ba40261022f5d5ed4493.woff2",s2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-f6032fc06eb20480f096199713f70885.woff2",o2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-f8ee5d36068a42b51d0e4a1116cfcec1.woff2",a2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-79d494361ae093b69e74ee9dbe65bfd4.woff2",l2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-74e2263a91439c25b91d5132ce9f4d62.woff2",c2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-ee8bae97908d5147b423f77ad0d3c1bb.woff2",d2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-56467a5c8840c4d23a60b2f935114848.woff2",u2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-145aa02cdd91946e67dc934e1acffe75.woff2",f2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-54acdfc2166ad7fcbd074f75fd4a56ba.woff2",h2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-29cec36cd205b211da97acabaa62f055.woff2",g2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-3756e81d3e149cf6099163ee79944fec.woff2",m2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-8e9f97f01034820170065b2921b4fb5e.woff2",p2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-13d2887ec8ee73c43acdabc52a05af7b.woff2",U2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-72536a3d71b694a0d53dd90ddceae41e.woff2",b2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-603aefd23e350ba7eb124273e3c9bcf1.woff2",y2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-9544732d2e62d1a429674f8ee41b5d3a.woff2",E2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-d3716376641d615e2995605b29bca7b6.woff2",v2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-5a1ce3117cfe90c48e8fb4a9a00f694d.woff2",w2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-b7d203b051eff504ff59ddca7576b6a9.woff2",_2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-4a38cc3e9cf104e69ba246d37f8cf135.woff2",T2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-982b630266d87db93d2539affb1275c6.woff2",I2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-9592bfc861f07bcb8d75c196b370e548.woff2",S2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-a7accba310e821da5505f71c03b76bdb.woff2",x2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-dac48066b5883d8b4551fc584f0c2a3e.woff2",C2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-a1f916d6039285c4ffb900cd654e418f.woff2",A2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-95bfd249da4902577b4b7d76ebdd0b44.woff2",M2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-93fc8f28a33234bcadf1527cafabd502.woff2",k2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-903bb6865f3452e2fda42e3a25547bc5.woff2",R2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-4aca6a43e59aceee2166b0c7e4e85ef1.woff2",D2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-24476a126f129212beb33f66853ea151.woff2",L2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-1b611157cd46bb184d4fa4dae2d6a2b8.woff2",N2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-56a32a7689abd0326e57c10c6c069bb4.woff2",O2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-3cc70dbb64df5b21f1326cc24dee2195.woff2",P2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-e2ead7ea7da0437f085f42ffc05f8d13.woff2",F2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-97f7f48ce90c9429bf32ae51469db74d.woff2",B2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-24a21c1e4449222e8d1898d69ff3a404.woff2",z2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-726303e0774b4e678bff8c2deb6ca603.woff2",H2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-5a7fac4b8b23a6e4e5ba0c9bf1756c91.woff2",V2e="/excalidraw/fonts/Xiaolai/Xiaolai-Regular-2b7441d46298788ac94e610ffcc709b6.woff2",$2e=[{uri:ime,descriptors:{unicodeRange:"U+f9b8-fa6d,U+fe32,U+fe45-fe4f,U+ff02-ff0b,U+ff0d-ff1e,U+ff20-ff2a"}},{uri:ame,descriptors:{unicodeRange:"U+20dd-20de,U+25ef,U+ff2b-ffbe,U+ffc2-ffc7,U+ffca-ffcf,U+ffd2-ffd7,U+ffda-ffdc,U+ffe0-ffe6,U+ffe8-ffee"}},{uri:ome,descriptors:{unicodeRange:"U+d7eb-d7fb,U+f900-f9b7"}},{uri:lme,descriptors:{unicodeRange:"U+d6f2-d7a3,U+d7b0-d7c6,U+d7cb-d7ea"}},{uri:dme,descriptors:{unicodeRange:"U+d609-d6f1"}},{uri:ume,descriptors:{unicodeRange:"U+d520-d608"}},{uri:cme,descriptors:{unicodeRange:"U+d437-d51f"}},{uri:fme,descriptors:{unicodeRange:"U+d34e-d436"}},{uri:gme,descriptors:{unicodeRange:"U+d265-d34d"}},{uri:mme,descriptors:{unicodeRange:"U+d17c-d264"}},{uri:sme,descriptors:{unicodeRange:"U+d093-d17b"}},{uri:pme,descriptors:{unicodeRange:"U+cfaa-d092"}},{uri:Ume,descriptors:{unicodeRange:"U+cec1-cfa9"}},{uri:Q0e,descriptors:{unicodeRange:"U+cdd8-cec0"}},{uri:rme,descriptors:{unicodeRange:"U+ccf1-cdd7"}},{uri:bme,descriptors:{unicodeRange:"U+cc08-ccf0"}},{uri:q0e,descriptors:{unicodeRange:"U+cb43-cc07"}},{uri:yme,descriptors:{unicodeRange:"U+ca83-cb42"}},{uri:Eme,descriptors:{unicodeRange:"U+c9a1-ca82"}},{uri:vme,descriptors:{unicodeRange:"U+c8b8-c9a0"}},{uri:wme,descriptors:{unicodeRange:"U+c7cf-c8b7"}},{uri:_me,descriptors:{unicodeRange:"U+c6e6-c7ce"}},{uri:Tme,descriptors:{unicodeRange:"U+c5fd-c6e5"}},{uri:Ime,descriptors:{unicodeRange:"U+c514-c5fc"}},{uri:Sme,descriptors:{unicodeRange:"U+c42b-c513"}},{uri:xme,descriptors:{unicodeRange:"U+c341-c34e,U+c350-c42a"}},{uri:Cme,descriptors:{unicodeRange:"U+c258-c340"}},{uri:Ame,descriptors:{unicodeRange:"U+c16f-c257"}},{uri:Mme,descriptors:{unicodeRange:"U+c086-c16e"}},{uri:kme,descriptors:{unicodeRange:"U+bf9d-c085"}},{uri:hme,descriptors:{unicodeRange:"U+beb4-bf9c"}},{uri:Rme,descriptors:{unicodeRange:"U+bdcb-beb3"}},{uri:Dme,descriptors:{unicodeRange:"U+bce2-bdca"}},{uri:Lme,descriptors:{unicodeRange:"U+bbf9-bce1"}},{uri:Nme,descriptors:{unicodeRange:"U+bb10-bbf8"}},{uri:Ome,descriptors:{unicodeRange:"U+ba27-bb0f"}},{uri:Pme,descriptors:{unicodeRange:"U+b93e-ba26"}},{uri:Fme,descriptors:{unicodeRange:"U+b855-b93d"}},{uri:Bme,descriptors:{unicodeRange:"U+b76c-b854"}},{uri:Xme,descriptors:{unicodeRange:"U+b683-b76b"}},{uri:jme,descriptors:{unicodeRange:"U+b59a-b682"}},{uri:zme,descriptors:{unicodeRange:"U+b4b1-b599"}},{uri:Yme,descriptors:{unicodeRange:"U+11fb-11ff,U+b3cd-b4b0"}},{uri:Wme,descriptors:{unicodeRange:"U+11e6-11fa,U+b2f9-b3cc"}},{uri:Kme,descriptors:{unicodeRange:"U+11d1-11e5,U+b225-b2f8"}},{uri:$me,descriptors:{unicodeRange:"U+11bc-11d0,U+b151-b224"}},{uri:Zme,descriptors:{unicodeRange:"U+11a7-11bb,U+b07d-b150"}},{uri:Gme,descriptors:{unicodeRange:"U+1191-11a6,U+afaa-b07c"}},{uri:qme,descriptors:{unicodeRange:"U+117c-1190,U+aed6-afa9"}},{uri:Qme,descriptors:{unicodeRange:"U+1167-117b,U+ae02-aed5"}},{uri:Jme,descriptors:{unicodeRange:"U+1152-115e,U+1160-1166,U+ad2d-ae01"}},{uri:epe,descriptors:{unicodeRange:"U+113d-1151,U+ac59-ad2c"}},{uri:tpe,descriptors:{unicodeRange:"U+1100-113c,U+9f95-9f98,U+9f9c-9f9e,U+9fa1-9fce,U+9fd0,U+a960-a97c,U+ac00-ac58"}},{uri:npe,descriptors:{unicodeRange:"U+9771-9772,U+9775,U+9777-977b,U+977d-9784,U+9786-978a,U+978c,U+978e-9790,U+9793,U+9795-9797,U+9799-979f,U+97a1-97a2,U+97a4-97aa,U+97ac,U+97ae,U+97b0-97b1,U+97b3,U+97b5-97e5,U+97e8,U+97ee-97f2,U+97f4,U+97f7-982d"}},{uri:ipe,descriptors:{unicodeRange:"U+9491,U+9496,U+9498,U+94c7,U+94cf,U+94d3-94d4,U+94da,U+94e6,U+94fb,U+951c,U+9520,U+9527,U+9533,U+953d,U+9543,U+9548,U+954b,U+9555,U+955a,U+9560,U+956e,U+9574-9575,U+9577-957e,U+9580-95e7,U+95ec,U+95ff,U+9607,U+9613,U+9618,U+961b,U+961e,U+9620,U+9623-9629,U+962b-962d,U+962f-9630,U+9637-963a,U+963e,U+9641,U+9643,U+964a,U+964e-964f,U+9651-9653,U+9656-965a,U+965c-965e,U+9660,U+9663,U+9665-9666,U+966b,U+966d-9671,U+9673,U+9678-9684,U+9687,U+9689-968a,U+968c,U+968e,U+9691-9693"}},{uri:rpe,descriptors:{unicodeRange:"U+923c-9273,U+9275-928d,U+928f-92ad,U+92af-92c7,U+92c9-92ee"}},{uri:spe,descriptors:{unicodeRange:"U+9159,U+915b-915c,U+915f-9160,U+9166-9168,U+916b,U+916d,U+9173,U+917a-917c,U+9180-9184,U+9186,U+9188,U+918a,U+918e-918f,U+9193-9199,U+919c-91a1,U+91a4-91a9,U+91ab-91ac,U+91b0-91b3,U+91b6-91b9,U+91bb-91c6,U+91c8,U+91cb,U+91d0,U+91d2-91db,U+91dd-923b"}},{uri:ope,descriptors:{unicodeRange:"U+902b-902c,U+9030-9034,U+9037,U+9039-903a,U+903d,U+903f-9040,U+9043,U+9045-9046,U+9048-904c,U+904e,U+9054-9056,U+9059-905a,U+905c-9061,U+9064,U+9066-9067,U+9069-906c,U+906f-9073,U+9076-907c,U+907e,U+9081,U+9084-9087,U+9089-908a,U+908c-9090,U+9092,U+9094,U+9096,U+9098,U+909a,U+909c,U+909e-90a0,U+90a4-90a5,U+90a7-90a9,U+90ab,U+90ad,U+90b2,U+90b7,U+90bc-90bd,U+90bf-90c0,U+90c2-90c3,U+90c6,U+90c8-90c9,U+90cb-90cd,U+90d2,U+90d4-90d6,U+90d8-90da,U+90de-90e0,U+90e3-90e5,U+90e9-90ea,U+90ec,U+90ee,U+90f0-90f3,U+90f5-90f7,U+90f9-90fc,U+90ff-9101,U+9103,U+9105-9118,U+911a-911d,U+911f-9121,U+9124-912e,U+9130,U+9132-9138,U+913a-9142,U+9144-9145,U+9147-9148,U+9151,U+9153-9156,U+9158"}},{uri:ape,descriptors:{unicodeRange:"U+8f03-8f65,U+8f6a,U+8f80,U+8f8c,U+8f92,U+8f9d,U+8fa0-8fa2,U+8fa4-8fa7,U+8faa,U+8fac-8faf,U+8fb2-8fb5,U+8fb7-8fb8,U+8fba-8fbc,U+8fbf-8fc0,U+8fc3,U+8fc6,U+8fc9-8fcd,U+8fcf,U+8fd2,U+8fd6-8fd7,U+8fda,U+8fe0-8fe1,U+8fe3,U+8fe7,U+8fec,U+8fef,U+8ff1-8ff2,U+8ff4-8ff6,U+8ffa-8ffc,U+8ffe-8fff,U+9007-9008,U+900c,U+900e,U+9013,U+9015,U+9018-9019,U+901c,U+9023-9025,U+9027-902a"}},{uri:lpe,descriptors:{unicodeRange:"U+8d03-8d1c,U+8d20,U+8d51-8d52,U+8d57,U+8d5f,U+8d65,U+8d68-8d6a,U+8d6c,U+8d6e-8d6f,U+8d71-8d72,U+8d78-8d80,U+8d82-8d83,U+8d86-8d89,U+8d8c-8d90,U+8d92-8d93,U+8d95-8d9e,U+8da0-8da2,U+8da4-8db0,U+8db2,U+8db6-8db7,U+8db9,U+8dbb,U+8dbd,U+8dc0-8dc2,U+8dc5,U+8dc7-8dca,U+8dcd,U+8dd0,U+8dd2-8dd5,U+8dd8-8dd9,U+8ddc,U+8de0-8de2,U+8de5-8de7,U+8de9,U+8ded-8dee,U+8df0-8df2,U+8df4,U+8df6,U+8dfc,U+8dfe-8e04,U+8e06-8e08,U+8e0b,U+8e0d-8e0e,U+8e10-8e13,U+8e15-8e1c,U+8e20-8e21,U+8e24-8e28,U+8e2b,U+8e2d,U+8e30,U+8e32-8e34,U+8e36-8e38,U+8e3b-8e3c,U+8e3e-8e3f,U+8e43,U+8e45-8e46"}},{uri:cpe,descriptors:{unicodeRange:"U+8bea,U+8c09,U+8c1e,U+8c38-8c40,U+8c42-8c45,U+8c48,U+8c4a-8c4b,U+8c4d-8c54,U+8c56-8c59,U+8c5b-8c60,U+8c63-8c69,U+8c6c-8c72,U+8c74-8c77,U+8c7b-8c81,U+8c83-8c84,U+8c86-8c88,U+8c8b,U+8c8d-8c93,U+8c95-8c97,U+8c99-8d02"}},{uri:dpe,descriptors:{unicodeRange:"U+8a64-8a78,U+8a7a-8a88,U+8a8b-8a92,U+8a94-8b06,U+8b08-8b1b"}},{uri:upe,descriptors:{unicodeRange:"U+8987-89c0,U+89c3,U+89cd,U+89d3-89d5,U+89d7-89d9,U+89db,U+89dd,U+89df-89e2,U+89e4,U+89e7-89ea,U+89ec-89ee,U+89f0-89f2,U+89f4-89ff,U+8a01-8a06,U+8a08-8a3d,U+8a3f-8a47,U+8a49-8a63"}},{uri:fpe,descriptors:{unicodeRange:"U+87e3-87e4,U+87e6-87e9,U+87eb-87ed,U+87ef-87f8,U+87fa-87fd,U+87ff-8802,U+8804-8809,U+880b-8812,U+8814,U+8817-881a,U+881c-8820,U+8823-8831,U+8833-8838,U+883a-883b,U+883d-883f,U+8841-8843,U+8846-884b,U+884e-8853,U+8855-8856,U+8858,U+885a-8860,U+8866-8867,U+886a,U+886d,U+886f,U+8871,U+8873-8876,U+8878-887c,U+8880,U+8883,U+8886-8887,U+8889-888a,U+888c,U+888e-8891,U+8893-8895,U+8897-889b,U+889d-88a1,U+88a3,U+88a5-88aa,U+88ac,U+88ae-88b0,U+88b2-88b6,U+88b8-88bb"}},{uri:hpe,descriptors:{unicodeRange:"U+86e7-86e8,U+86ea-86ec,U+86ef,U+86f5-86f7,U+86fa-86fd,U+86ff,U+8701,U+8704-8706,U+870b-870c,U+870e-8711,U+8714,U+8716,U+8719,U+871b,U+871d,U+871f-8720,U+8724,U+8726-8728,U+872a-872d,U+872f-8730,U+8732-8733,U+8735-8736,U+8738-873a,U+873c-873d,U+8740-8746,U+874a-874b,U+874d,U+874f-8752,U+8754-8756,U+8758,U+875a-875f,U+8761-8762,U+8766-876d,U+876f,U+8771-8773,U+8775,U+8777-877a,U+877f-8781,U+8784,U+8786-8787,U+8789-878a,U+878c,U+878e-8792,U+8794-8796,U+8798-879e,U+87a0-87a7,U+87a9-87aa,U+87ae,U+87b0-87b2,U+87b4,U+87b6-87b9,U+87bb-87bc,U+87be-87bf,U+87c1-87c5,U+87c7-87c9,U+87cc-87d0,U+87d4-87da,U+87dc-87df,U+87e1-87e2"}},{uri:gpe,descriptors:{unicodeRange:"U+8604,U+8606-8610,U+8612-8615,U+8617-8626,U+8628,U+862a-8637,U+8639-863b,U+863d-864c,U+8652-8653,U+8655-8659,U+865b-865d,U+865f-8661,U+8663-866a,U+866d,U+866f-8670,U+8672-8678,U+8683-8689,U+868e-8692,U+8694,U+8696-869b,U+869e-86a2,U+86a5-86a6,U+86ab,U+86ad-86ae,U+86b2-86b3,U+86b7-86b9,U+86bb-86bf,U+86c1-86c3,U+86c5,U+86c8,U+86cc-86cd,U+86d2-86d3,U+86d5-86d7,U+86da,U+86dc-86dd,U+86e0-86e3,U+86e5-86e6"}},{uri:mpe,descriptors:{unicodeRange:"U+8456,U+8458,U+845d-8460,U+8462,U+8464-8468,U+846a,U+846e-8470,U+8472,U+8474,U+8477,U+8479,U+847b-8481,U+8483-8486,U+848a,U+848d,U+848f-8496,U+8498,U+849a-849b,U+849d-84a0,U+84a2-84ae,U+84b0-84b1,U+84b3,U+84b5-84b7,U+84bb-84bc,U+84be,U+84c0,U+84c2-84c3,U+84c5-84c8,U+84cb-84cc,U+84ce-84cf,U+84d2,U+84d4-84d5,U+84d7-84dc,U+84de,U+84e1-84e2,U+84e4,U+84e7-84eb,U+84ed-84ef,U+84f1-84fb,U+84fd-84fe,U+8500-850b,U+850d-8510,U+8512,U+8514-8516,U+8518-8519,U+851b-851e,U+8520,U+8522-852a,U+852d-8536,U+853e-8542,U+8544-8547,U+854b-854f"}},{uri:ppe,descriptors:{unicodeRange:"U+82c2-82c3,U+82c5-82c6,U+82c9,U+82d0,U+82d6,U+82d9-82da,U+82dd,U+82e2,U+82e7-82ea,U+82ec-82ee,U+82f0,U+82f2-82f3,U+82f5-82f6,U+82f8,U+82fa,U+82fc-8300,U+830a-830b,U+830d,U+8310,U+8312-8313,U+8316,U+8318-8319,U+831d-8326,U+8329-832a,U+832e,U+8330,U+8332,U+8337,U+833b,U+833d-833f,U+8341-8342,U+8344-8345,U+8348,U+834a-834e,U+8353,U+8355-8359,U+835d,U+8362,U+8370-8376,U+8379-837a,U+837e-8384,U+8387-8388,U+838a-838d,U+838f-8391,U+8394-8397,U+8399-839a,U+839d,U+839f,U+83a1-83a7,U+83ac-83af,U+83b5,U+83bb,U+83be-83bf,U+83c2-83c4,U+83c6,U+83c8-83c9,U+83cb,U+83cd-83ce,U+83d0-83d3,U+83d5,U+83d7,U+83d9-83db,U+83de,U+83e2-83e4,U+83e6-83e8,U+83eb-83ef,U+83f3-83f7,U+83fa-83fc,U+83fe-8400,U+8402,U+8405,U+8407-840a,U+8410,U+8412-8417,U+8419-841b,U+841e-8423,U+8429-8430,U+8432-8437,U+8439-843b,U+843e-8445,U+8447-8450,U+8452-8455"}},{uri:Upe,descriptors:{unicodeRange:"U+81a4-81a5,U+81a7,U+81a9,U+81ab-81b2,U+81b4-81b9,U+81bc-81bf,U+81c4-81c5,U+81c7-81c9,U+81cb,U+81cd-81e2,U+81e4-81e6,U+81e8-81e9,U+81eb,U+81ee-81f2,U+81f5-81fa,U+81fd,U+81ff,U+8203,U+8207-820b,U+820e-820f,U+8211,U+8213,U+8215-821a,U+821d,U+8220,U+8224-8227,U+8229,U+822e,U+8232,U+823a,U+823c-823d,U+823f-8243,U+8245-8246,U+8248,U+824a,U+824c-824e,U+8250-8257,U+8259,U+825b-825e,U+8260-8267,U+8269-826d,U+8271,U+8275-8278,U+827b-827c,U+8280-8281,U+8283,U+8285-8287,U+8289,U+828c,U+8290,U+8293-8296,U+829a-829b,U+829e,U+82a0,U+82a2-82a3,U+82a7,U+82b2,U+82b5-82b6,U+82ba-82bc,U+82bf-82c0"}},{uri:bpe,descriptors:{unicodeRange:"U+8059,U+805b-8068,U+806b-8070,U+8072-807e,U+8081-8082,U+8085,U+8088,U+808a,U+808d-8092,U+8094-8095,U+8097,U+8099,U+809e,U+80a3,U+80a6-80a8,U+80ac,U+80b0,U+80b3,U+80b5-80b6,U+80b8-80b9,U+80bb,U+80c5,U+80c7-80cb,U+80cf-80d5,U+80d8,U+80df-80e0,U+80e2-80e3,U+80e6,U+80ee,U+80f5,U+80f7,U+80f9,U+80fb,U+80fe-8101,U+8103-8105,U+8107-8108,U+810b-810c,U+8115,U+8117,U+8119,U+811b-811d,U+811f-812b,U+812d-812e,U+8130,U+8133-8135,U+8137,U+8139-813d,U+813f-8145,U+8147,U+8149,U+814d-814f,U+8152,U+8156-8158,U+815b-815f,U+8161-8164,U+8166,U+8168,U+816a-816c,U+816f,U+8172-8173,U+8175-8178,U+8181,U+8183-8187,U+8189,U+818b-818e,U+8190,U+8192-8197,U+8199-819a,U+819e-81a2"}},{uri:ype,descriptors:{unicodeRange:"U+7f3c-7f41,U+7f43,U+7f46-7f4f,U+7f52-7f53,U+7f56,U+7f59,U+7f5b-7f5e,U+7f60,U+7f63-7f67,U+7f6b-7f6d,U+7f6f-7f70,U+7f73,U+7f75-7f78,U+7f7a-7f7d,U+7f7f-7f80,U+7f82-7f89,U+7f8b,U+7f8d,U+7f8f-7f93,U+7f95-7f99,U+7f9b-7f9c,U+7fa0,U+7fa2-7fa3,U+7fa5-7fa6,U+7fa8-7fae,U+7fb1,U+7fb3-7fb7,U+7fba-7fbb,U+7fbe,U+7fc0,U+7fc2-7fc4,U+7fc6-7fc9,U+7fcb,U+7fcd,U+7fcf-7fd3,U+7fd6-7fd7,U+7fd9-7fde,U+7fe2-7fe4,U+7fe7-7fe8,U+7fea-7fed,U+7fef,U+7ff2,U+7ff4-7ffa,U+7ffd-7fff,U+8002,U+8007-800a,U+800e-800f,U+8011,U+8013,U+801a-801b,U+801d-801f,U+8021,U+8023-8024,U+802b-8030,U+8032,U+8034,U+8039-803a,U+803c,U+803e,U+8040-8041,U+8044-8045,U+8047-8049,U+804e-8051,U+8053,U+8055-8057"}},{uri:eme,descriptors:{unicodeRange:"U+7cd8,U+7cda-7cdb,U+7cdd-7cde,U+7ce1-7ce7,U+7ce9-7cee,U+7cf0-7cf7,U+7cf9-7cfa,U+7cfc-7d09,U+7d0b-7d1f,U+7d21,U+7d23-7d26,U+7d28-7d2a,U+7d2c-7d2e,U+7d30-7d6d,U+7d6f-7d76,U+7d78-7d94"}},{uri:Epe,descriptors:{unicodeRange:"U+7afe,U+7b00-7b02,U+7b05,U+7b07,U+7b09,U+7b0c-7b0e,U+7b10,U+7b12-7b13,U+7b16-7b18,U+7b1a,U+7b1c-7b1d,U+7b1f,U+7b21-7b23,U+7b27,U+7b29,U+7b2d,U+7b2f-7b30,U+7b32,U+7b34-7b37,U+7b39,U+7b3b,U+7b3d,U+7b3f-7b44,U+7b46,U+7b48,U+7b4a,U+7b4d-7b4e,U+7b53,U+7b55,U+7b57,U+7b59,U+7b5c,U+7b5e-7b5f,U+7b61,U+7b63-7b6d,U+7b6f-7b70,U+7b73-7b74,U+7b76,U+7b78,U+7b7a,U+7b7c-7b7d,U+7b7f,U+7b81-7b84,U+7b86-7b8c,U+7b8e-7b8f,U+7b91-7b93,U+7b96,U+7b98-7b9b,U+7b9e-7ba0,U+7ba3-7ba5,U+7bae-7bb0,U+7bb2-7bb3,U+7bb5-7bb7,U+7bb9-7bc0,U+7bc2-7bc5,U+7bc8-7bcb,U+7bcd-7bd0,U+7bd2,U+7bd4-7bd8,U+7bdb-7bdc,U+7bde-7be0,U+7be2-7be4,U+7be7-7be9,U+7beb-7bed,U+7bef-7bf0,U+7bf2-7bf6,U+7bf8-7bfb,U+7bfd,U+7bff-7c06,U+7c08-7c0a,U+7c0d-7c0e,U+7c10-7c13"}},{uri:vpe,descriptors:{unicodeRange:"U+7a10-7a13,U+7a15-7a16,U+7a18-7a19,U+7a1b-7a1d,U+7a1f,U+7a21-7a22,U+7a24-7a32,U+7a34-7a36,U+7a38,U+7a3a,U+7a3e,U+7a40-7a45,U+7a47-7a50,U+7a52-7a56,U+7a58-7a6f,U+7a71-7a73,U+7a75,U+7a7b-7a7e,U+7a82,U+7a85,U+7a87,U+7a89-7a8c,U+7a8e-7a90,U+7a93-7a94,U+7a99-7a9b,U+7a9e,U+7aa1-7aa4,U+7aa7,U+7aa9-7aab,U+7aae-7ab2,U+7ab4-7abe,U+7ac0-7aca,U+7acc-7ad5,U+7ad7-7ad8,U+7ada-7add,U+7ae1-7ae2,U+7ae4,U+7ae7-7aec,U+7aee,U+7af0-7af8,U+7afb-7afc"}},{uri:wpe,descriptors:{unicodeRange:"U+790d-7912,U+7914-791d,U+791f-7923,U+7925-7933,U+7935-7939,U+793d,U+793f,U+7942-7945,U+7947,U+794a-7952,U+7954-7955,U+7958-7959,U+7961,U+7963-7964,U+7966,U+7969-796c,U+796e,U+7970-7976,U+7979,U+797b-797f,U+7982-7983,U+7986-7989,U+798b-798e,U+7990-7999,U+799b-79a6,U+79a8-79b2,U+79b4-79b8,U+79bc,U+79bf,U+79c2,U+79c4-79c5,U+79c7-79c8,U+79ca,U+79cc,U+79ce-79d0,U+79d3-79d4,U+79d6-79d7,U+79d9-79de,U+79e0-79e2,U+79e5,U+79e8,U+79ea,U+79ec,U+79ee,U+79f1-79f7,U+79f9-79fa,U+79fc,U+79fe-79ff,U+7a01,U+7a04-7a05,U+7a07-7a0a,U+7a0c,U+7a0f"}},{uri:_pe,descriptors:{unicodeRange:"U+77d8-77da,U+77dd-77e1,U+77e4,U+77e6,U+77e8,U+77ea,U+77ef-77f2,U+77f4-77f5,U+77f7,U+77f9-77fc,U+7803-7808,U+780a-780b,U+780e-7810,U+7813,U+7815,U+7819,U+781b,U+781e,U+7820-7822,U+7824,U+7828,U+782a-782b,U+782e-782f,U+7831-7833,U+7835-7836,U+783d,U+783f,U+7841-7844,U+7846,U+7848-784b,U+784d,U+784f,U+7851,U+7853-7854,U+7858-785c,U+785e-7869,U+786f-7876,U+7878-787b,U+787d-7886,U+7888,U+788a-788b,U+788f-7890,U+7892,U+7894-7896,U+7899,U+789d-789e,U+78a0,U+78a2,U+78a4,U+78a6,U+78a8-78af,U+78b5-78b8,U+78ba-78bd,U+78bf-78c0,U+78c2-78c4,U+78c6-78c8,U+78cc-78cf,U+78d1-78d3,U+78d6-78d8,U+78da-78e7,U+78e9-78eb,U+78ed-78f1,U+78f3,U+78f5-78f6,U+78f8-78f9,U+78fb-7900,U+7902-7904,U+7906-790c"}},{uri:Tpe,descriptors:{unicodeRange:"U+76af-76b0,U+76b3,U+76b5-76be,U+76c0-76c1,U+76c3-76c4,U+76c7,U+76c9,U+76cb-76cc,U+76d3,U+76d5,U+76d9-76da,U+76dc-76de,U+76e0-76e4,U+76e6-76ed,U+76f0,U+76f3,U+76f5-76f7,U+76fa-76fb,U+76fd,U+76ff-7703,U+7705-7706,U+770a,U+770c,U+770e-7718,U+771b-771e,U+7721,U+7723-7725,U+7727,U+772a-772c,U+772e,U+7730-7734,U+7739,U+773b,U+773d-773f,U+7742,U+7744-7746,U+7748-774f,U+7752-7759,U+775c-7760,U+7764,U+7767,U+7769-776a,U+776d-7778,U+777a-777c,U+7781-7783,U+7786-778b,U+778f-7790,U+7793-779e,U+77a1,U+77a3-77a4,U+77a6,U+77a8,U+77ab,U+77ad-77af,U+77b1-77b2,U+77b4,U+77b6-77ba,U+77bc,U+77be,U+77c0-77cc,U+77ce-77d6"}},{uri:Ipe,descriptors:{unicodeRange:"U+7589-758a,U+758c-758e,U+7590,U+7593,U+7595,U+7598,U+759b-759c,U+759e,U+75a2,U+75a6-75aa,U+75ad,U+75b6-75b7,U+75ba-75bb,U+75bf-75c1,U+75c6,U+75cb-75cc,U+75ce-75d1,U+75d3,U+75d7,U+75d9-75da,U+75dc-75dd,U+75df-75e1,U+75e5,U+75e9,U+75ec-75ef,U+75f2-75f3,U+75f5-75f8,U+75fa-75fb,U+75fd-75fe,U+7602,U+7604,U+7606-7609,U+760b,U+760d-760f,U+7611-7614,U+7616,U+761a,U+761c-761e,U+7621,U+7623,U+7627-7628,U+762c,U+762e-762f,U+7631-7632,U+7636-7637,U+7639-763b,U+763d,U+7641-7642,U+7644-764b,U+764e-7653,U+7655,U+7657-765b,U+765d,U+765f-7662,U+7664-766a,U+766c-766e,U+7670-7677,U+7679-767a,U+767c,U+767f-7681,U+7683,U+7685,U+7689-768a,U+768c-768d,U+768f-7690,U+7692,U+7694-7695,U+7697-7698,U+769a-76a3,U+76a5-76ad"}},{uri:Spe,descriptors:{unicodeRange:"U+7492-749b,U+749d,U+749f-74a6,U+74aa-74b9,U+74bb-74d1,U+74d3-74db,U+74dd,U+74df,U+74e1,U+74e5,U+74e7-74ed,U+74f0-74f3,U+74f5,U+74f8-74fe,U+7500-7503,U+7505-750c,U+750e,U+7510,U+7512,U+7514-7517,U+751b,U+751d-751e,U+7520-7524,U+7526-7527,U+752a,U+752e,U+7534,U+7536,U+7539,U+753c-753d,U+753f,U+7541-7544,U+7546-7547,U+7549-754a,U+754d,U+7550-7553,U+7555-7558,U+755d-7564,U+7567-7569,U+756b-7571,U+7573,U+7575-7577,U+757a-757e,U+7580-7582,U+7584-7585,U+7587-7588"}},{uri:xpe,descriptors:{unicodeRange:"U+7372-737d,U+737f-7383,U+7385-7386,U+7388,U+738a,U+738c-738d,U+738f-7390,U+7392-7395,U+7397-739a,U+739c-739e,U+73a0-73a1,U+73a3-73a8,U+73aa,U+73ac-73ad,U+73b1,U+73b4-73b6,U+73b8-73b9,U+73bc-73bf,U+73c1,U+73c3-73c7,U+73cb-73cc,U+73ce,U+73d2-73d8,U+73da-73dd,U+73df,U+73e1-73e4,U+73e6,U+73e8,U+73ea-73ec,U+73ee-73f1,U+73f3-7402,U+7404,U+7407-7408,U+740b-740e,U+7411-7419,U+741c-7421,U+7423-7424,U+7427,U+7429,U+742b,U+742d,U+742f,U+7431-7432,U+7437-743b,U+743d-7440,U+7442-7454,U+7456,U+7458,U+745d,U+7460-746c,U+746e-746f,U+7471-7475,U+7478-747d,U+747f,U+7482,U+7484-7486,U+7488-748a,U+748c-748d,U+748f,U+7491"}},{uri:Z0e,descriptors:{unicodeRange:"U+7054-705d,U+705f-706a,U+706e,U+7071-7074,U+7077,U+7079-707b,U+707d,U+7081-7084,U+7086-7088,U+708b-708d,U+708f-7091,U+7093,U+7097-7098,U+709a-709b,U+709e-70aa,U+70b0,U+70b2,U+70b4-70b6,U+70ba,U+70be-70bf,U+70c4-70c7,U+70c9,U+70cb-70d7,U+70da,U+70dc-70de,U+70e0-70e3,U+70e5,U+70ea,U+70ee,U+70f0-70f6,U+70f8,U+70fa-70fc,U+70fe-7108,U+710b-710f,U+7111-7112,U+7114,U+7117,U+711b-7125,U+7127-712e,U+7132-7135,U+7137-7144,U+7146-7149,U+714b,U+714d,U+714f-715b,U+715d,U+715f-7163,U+7165,U+7169-716d,U+716f-7171,U+7174-7177"}},{uri:Cpe,descriptors:{unicodeRange:"U+722e-722f,U+7232-7234,U+723a,U+723c,U+723e,U+7240-7246,U+7249-724b,U+724e-7251,U+7253-7255,U+7257-7258,U+725a,U+725c,U+725e,U+7260,U+7263-7265,U+7268,U+726a-726d,U+7270-7271,U+7273-7274,U+7276-7278,U+727b-727d,U+7282-7283,U+7285-7289,U+728c,U+728e,U+7290-7291,U+7293-729e,U+72a0-72ab,U+72ae,U+72b1-72b3,U+72b5,U+72ba-72c0,U+72c5-72c7,U+72c9-72cc,U+72cf,U+72d1,U+72d3-72d6,U+72d8,U+72da-72dd,U+72df,U+72e2-72e7,U+72ea-72eb,U+72f5-72f6,U+72f9,U+72fd-7300,U+7302,U+7304-7309,U+730b-730d,U+730f-7312,U+7314,U+7318-731a,U+731f-7320,U+7323-7324,U+7326-7328,U+732d,U+732f-7330,U+7332-7333,U+7335-7336,U+733a-733d,U+7340-734c,U+734e-734f,U+7351,U+7353-7356,U+7358-735f,U+7361-736b,U+736e,U+7370-7371"}},{uri:Vme,descriptors:{unicodeRange:"U+6ec5-6ec6,U+6ec8-6eca,U+6ecc-6ece,U+6ed0,U+6ed2,U+6ed6,U+6ed8-6ed9,U+6edb-6edd,U+6ee3,U+6ee7,U+6eea-6ef3,U+6ef5-6ef8,U+6efa-6f01,U+6f03-6f05,U+6f07-6f08,U+6f0a-6f0e,U+6f10-6f12,U+6f16-6f1f,U+6f21-6f23,U+6f25-6f28,U+6f2c,U+6f2e,U+6f30,U+6f32,U+6f34-6f35,U+6f37-6f3d,U+6f3f-6f45,U+6f48-6f4a,U+6f4c,U+6f4e-6f57,U+6f59-6f5b,U+6f5d,U+6f5f-6f61,U+6f63-6f65,U+6f67-6f6c,U+6f6f-6f71,U+6f73,U+6f75-6f77,U+6f79,U+6f7b,U+6f7d-6f83,U+6f85-6f87,U+6f8a-6f8b,U+6f8f-6f9b,U+6f9d-6fa0,U+6fa2-6fa6,U+6fa8-6fb1"}},{uri:Ape,descriptors:{unicodeRange:"U+6d73,U+6d75-6d76,U+6d79-6d7b,U+6d7d-6d81,U+6d83-6d84,U+6d86-6d87,U+6d8a-6d8b,U+6d8d,U+6d8f-6d90,U+6d92,U+6d96-6d9a,U+6d9c,U+6da2,U+6da5,U+6dac-6dad,U+6db0-6db1,U+6db3-6db4,U+6db6-6db7,U+6db9-6dbe,U+6dc1-6dc3,U+6dc8-6dca,U+6dcd-6dd0,U+6dd2-6dd5,U+6dd7,U+6dda-6ddc,U+6ddf,U+6de2-6de3,U+6de5,U+6de7-6dea,U+6ded,U+6def-6df0,U+6df2,U+6df4-6df6,U+6df8,U+6dfa,U+6dfd-6e04,U+6e06-6e09,U+6e0b,U+6e0f,U+6e12-6e13,U+6e15,U+6e18-6e19,U+6e1b-6e1c,U+6e1e-6e1f,U+6e22,U+6e26-6e28,U+6e2a,U+6e2c,U+6e2e,U+6e30-6e31,U+6e33,U+6e35-6e37,U+6e39,U+6e3b-6e42,U+6e45-6e4c,U+6e4f-6e52,U+6e55,U+6e57,U+6e59-6e5a,U+6e5c-6e5e,U+6e60-6e6a,U+6e6c-6e6d,U+6e6f-6e7d,U+6e80-6e82,U+6e84,U+6e87-6e88,U+6e8a-6e8e,U+6e91-6e97,U+6e99-6e9b,U+6e9d-6e9e,U+6ea0-6ea1,U+6ea3-6ea4,U+6ea6,U+6ea8-6ea9,U+6eab-6eae,U+6eb0,U+6eb3,U+6eb5,U+6eb8-6eb9,U+6ebc,U+6ebe-6ec0,U+6ec3-6ec4"}},{uri:Mpe,descriptors:{unicodeRange:"U+6bbb-6bbe,U+6bc0,U+6bc3-6bc4,U+6bc6-6bca,U+6bcc,U+6bce,U+6bd0-6bd1,U+6bd8,U+6bda,U+6bdc-6be0,U+6be2-6be9,U+6bec-6bee,U+6bf0-6bf2,U+6bf4,U+6bf6-6bf8,U+6bfa-6bfc,U+6bfe-6c04,U+6c08-6c0c,U+6c0e,U+6c12,U+6c17,U+6c1c-6c1e,U+6c20,U+6c23,U+6c25,U+6c2b-6c2d,U+6c31,U+6c33,U+6c36-6c37,U+6c39-6c3c,U+6c3e-6c3f,U+6c43-6c45,U+6c48,U+6c4b-6c4f,U+6c51-6c53,U+6c56,U+6c58-6c5a,U+6c62-6c63,U+6c65-6c67,U+6c6b-6c6f,U+6c71,U+6c73,U+6c75,U+6c77-6c78,U+6c7a-6c7c,U+6c7f-6c80,U+6c84,U+6c87,U+6c8a-6c8b,U+6c8d-6c8e,U+6c91-6c92,U+6c95-6c98,U+6c9a,U+6c9c-6c9e,U+6ca0,U+6ca2,U+6ca8,U+6cac,U+6caf-6cb0,U+6cb4-6cb7,U+6cba,U+6cc0-6cc3,U+6cc6-6cc8,U+6ccb,U+6ccd-6ccf,U+6cd1-6cd2,U+6cd8-6cda,U+6cdc-6cdd,U+6cdf,U+6ce4,U+6ce6-6ce7,U+6ce9,U+6cec-6ced,U+6cf2,U+6cf4,U+6cf9,U+6cff-6d00,U+6d02-6d03,U+6d05-6d06,U+6d08-6d0a,U+6d0d,U+6d0f-6d11,U+6d13-6d16,U+6d18,U+6d1c-6d1d,U+6d1f-6d24,U+6d26,U+6d28-6d29,U+6d2c-6d2d,U+6d2f-6d30,U+6d34,U+6d36-6d38,U+6d3a,U+6d3f-6d40,U+6d42,U+6d44,U+6d49,U+6d4c,U+6d50,U+6d55-6d58,U+6d5b,U+6d5d,U+6d5f,U+6d61-6d62,U+6d64-6d65,U+6d67-6d68,U+6d6b-6d6d,U+6d70-6d72"}},{uri:kpe,descriptors:{unicodeRange:"U+6967-696a,U+696c-696d,U+696f-6970,U+6972-6976,U+697a-697b,U+697d-697f,U+6981,U+6983,U+6985,U+698a-698c,U+698e-6993,U+6996-6997,U+6999-699a,U+699d-69a6,U+69a9-69aa,U+69ac,U+69ae-69b0,U+69b2-69b3,U+69b5-69b6,U+69b8-69ba,U+69bc-69c0,U+69c2-69c9,U+69cb,U+69cd,U+69cf,U+69d1-69d3,U+69d5-69da,U+69dc-69de,U+69e1-69ec,U+69ee-69f1,U+69f3-69fc,U+69fe,U+6a00-6a09,U+6a0b-6a16,U+6a19-6a1e,U+6a20,U+6a22-6a27,U+6a29,U+6a2b-6a2e,U+6a30,U+6a32-6a34,U+6a36-6a3c,U+6a3f-6a43,U+6a45-6a46,U+6a48-6a4a"}},{uri:Rpe,descriptors:{unicodeRange:"U+6830-6831,U+6834-6836,U+683a-683b,U+683f,U+6847,U+684b,U+684d,U+684f,U+6852,U+6856-685f,U+686a,U+686c-6873,U+6875,U+6878-6880,U+6882,U+6884,U+6887-688e,U+6890-6892,U+6894-6896,U+6898-68a1,U+68a3-68a5,U+68a9-68ac,U+68ae,U+68b1-68b2,U+68b4,U+68b6-68bf,U+68c1,U+68c3-68c8,U+68ca,U+68cc,U+68ce-68d1,U+68d3-68d4,U+68d6-68d7,U+68d9,U+68db-68df,U+68e1-68e2,U+68e4-68ed,U+68ef,U+68f2-68f4,U+68f6-68f8,U+68fb,U+68fd-6900,U+6902-6904,U+6906-690a,U+690c,U+690f,U+6911,U+6913-691e,U+6921-6923,U+6925-692c,U+692e-692f,U+6931-6933,U+6935-6938,U+693a-693c,U+693e,U+6940-6941,U+6943-6953,U+6955-6956,U+6958-6959,U+695b-695c,U+695f,U+6961-6962,U+6964-6965"}},{uri:Dpe,descriptors:{unicodeRange:"U+66b8,U+66ba-66bd,U+66bf-66d8,U+66da,U+66de-66e5,U+66e7-66e8,U+66ea-66ef,U+66f1,U+66f5-66f6,U+66f8,U+66fa-66fb,U+66fd,U+6701-6707,U+670c,U+670e-670f,U+6711-6713,U+6716,U+6718-671a,U+671c,U+671e,U+6720-6725,U+6727,U+6729,U+672e,U+6730,U+6732-6733,U+6736-6739,U+673b-673c,U+673e-673f,U+6741,U+6744-6745,U+6747,U+674a-674b,U+674d,U+6752,U+6754-6755,U+6757-675b,U+675d,U+6762-6764,U+6766-6767,U+676b-676c,U+676e,U+6771,U+6774,U+6776,U+6778-677b,U+677d,U+6780,U+6782-6783,U+6785-6786,U+6788,U+678a,U+678c-678f,U+6791-6794,U+6796,U+6799,U+679b,U+679f-67a1,U+67a4,U+67a6,U+67a9,U+67ac,U+67ae,U+67b1-67b2,U+67b4,U+67b9-67c0,U+67c2,U+67c5-67ce,U+67d5-67d7,U+67db,U+67df,U+67e1,U+67e3-67e4,U+67e6-67e8,U+67ea-67eb,U+67ed-67ee,U+67f2,U+67f5-67fc,U+67fe,U+6801-6804,U+6806,U+680d,U+6810,U+6812,U+6814-6815,U+6818-681c,U+681e-6820,U+6822-6828,U+682b-682f"}},{uri:Lpe,descriptors:{unicodeRange:"U+6569-656a,U+656d-656f,U+6571,U+6573,U+6575-6576,U+6578-6586,U+6588-658a,U+658d-658f,U+6592,U+6594-6596,U+6598,U+659a,U+659d-659e,U+65a0,U+65a2-65a3,U+65a6,U+65a8,U+65aa,U+65ac,U+65ae,U+65b1-65b8,U+65ba-65bb,U+65be-65c0,U+65c2,U+65c7-65ca,U+65cd,U+65d0-65d1,U+65d3-65d5,U+65d8-65df,U+65e1,U+65e3-65e4,U+65ea-65eb,U+65f2-65f5,U+65f8-65f9,U+65fb-65ff,U+6601,U+6604-6605,U+6607-6609,U+660b,U+660d,U+6610-6612,U+6616-6618,U+661a-661c,U+661e,U+6621-6624,U+6626,U+6629-662c,U+662e,U+6630,U+6632-6633,U+6637-663b,U+663d,U+663f-6640,U+6642,U+6644-664a,U+664d-664e,U+6650-6651,U+6658-6659,U+665b-665e,U+6660,U+6662-6663,U+6665,U+6667,U+6669-666d,U+6671-6673,U+6675,U+6678-6679,U+667b-667d,U+667f-6681,U+6683,U+6685-6686,U+6688-668b,U+668d-6690,U+6692-6695,U+6698-669c,U+669e-66a6,U+66a9-66ad,U+66af-66b3,U+66b5-66b7"}},{uri:Npe,descriptors:{unicodeRange:"U+5f30,U+5f32-5f38,U+5f3b,U+5f3d-5f3f,U+5f41-5f4f,U+5f51,U+5f54,U+5f59-5f5c,U+5f5e-5f60,U+5f63,U+5f65,U+5f67-5f68,U+5f6b,U+5f6e-5f6f,U+5f72,U+5f74-5f76,U+5f78,U+5f7a,U+5f7d-5f7f,U+5f83,U+5f86,U+5f8d-5f8f,U+5f91,U+5f93-5f94,U+5f96,U+5f9a-5f9b,U+5f9d-5fa0,U+5fa2-5fa7,U+5fa9,U+5fab-5fac,U+5faf-5fb4,U+5fb6,U+5fb8-5fbb,U+5fbe-5fc2,U+5fc7-5fc8,U+5fca-5fcb,U+5fce,U+5fd3-5fd5,U+5fda-5fdc,U+5fde-5fdf,U+5fe2-5fe3,U+5fe5-5fe6,U+5fe8-5fe9,U+5fec,U+5fef-5ff0,U+5ff2-5ff4,U+5ff6-5ff7,U+5ff9-5ffa,U+5ffc,U+6007-6009,U+600b-600c,U+6010-6011,U+6013,U+6017-6018,U+601a,U+601e-601f,U+6022-6024,U+602c-602e,U+6030-6034,U+6036-603a,U+603d-603e,U+6040,U+6044-604a,U+604c,U+604e-604f,U+6051,U+6053-6054,U+6056-6058,U+605b-605c,U+605e-6061,U+6065-6066,U+606e,U+6071-6072,U+6074-6075,U+6077,U+607e,U+6080-6082,U+6085-6088,U+608a-608b,U+608e-6091,U+6093,U+6095,U+6097-6099,U+609c,U+609e,U+60a1-60a2,U+60a4-60a5,U+60a7,U+60a9-60aa,U+60ae,U+60b0,U+60b3,U+60b5-60b7,U+60b9-60ba,U+60bd-60c4,U+60c7-60c9,U+60cc"}},{uri:Ope,descriptors:{unicodeRange:"U+635a-635d,U+6360,U+6364-6366,U+6368,U+636a-636c,U+636f-6370,U+6372-6375,U+6378-6379,U+637c-637f,U+6381,U+6383-6386,U+638b,U+638d,U+6391,U+6393-6395,U+6397,U+6399-639f,U+63a1,U+63a4,U+63a6,U+63ab,U+63af,U+63b1-63b2,U+63b5-63b6,U+63b9,U+63bb,U+63bd,U+63bf-63c3,U+63c5,U+63c7-63c8,U+63ca-63cc,U+63d1,U+63d3-63d5,U+63d7-63dd,U+63df,U+63e2,U+63e4-63e8,U+63eb-63ec,U+63ee-63f1,U+63f3,U+63f5,U+63f7,U+63f9-63fc,U+63fe,U+6403-6404,U+6406-640a,U+640d-640e,U+6411-6412,U+6415-641a,U+641d,U+641f,U+6422-6425,U+6427-6429,U+642b,U+642e-6433,U+6435-6439,U+643b-643c,U+643e,U+6440,U+6442-6443,U+6449,U+644b-6451,U+6453,U+6455-6457,U+6459-645d,U+645f-6466,U+6468,U+646a-646c,U+646e-6477,U+647b-6481,U+6483,U+6486,U+6488-648f"}},{uri:Ppe,descriptors:{unicodeRange:"U+61c5-61c7,U+61c9,U+61cc-61d0,U+61d3,U+61d5-61e5,U+61e7-61f4,U+61f6-61fe,U+6200-6205,U+6207,U+6209,U+6213-6214,U+6219,U+621c-621e,U+6220,U+6223,U+6226-6229,U+622b,U+622d,U+622f-6232,U+6235-6236,U+6238-623c,U+6242,U+6244-6246,U+624a,U+624f-6250,U+6255-6257,U+6259-625a,U+625c-6262,U+6264-6265,U+6268,U+6271-6272,U+6274-6275,U+6277-6278,U+627a-627b,U+627d,U+6281-6283,U+6285-6288,U+628b-6290,U+6294,U+6299,U+629c-629e,U+62a3,U+62a6-62a7,U+62a9-62aa,U+62ad-62b0,U+62b2-62b4,U+62b6-62b8,U+62ba,U+62be,U+62c0-62c1,U+62c3,U+62cb,U+62cf,U+62d1,U+62d5,U+62dd-62de,U+62e0-62e1,U+62e4,U+62ea-62eb,U+62f0,U+62f2,U+62f5,U+62f8-62fb,U+6300,U+6303-6306,U+630a-630d,U+630f-6310,U+6312-6315,U+6317-6319,U+631c,U+6326-6327,U+6329,U+632c-632e,U+6330-6331,U+6333-6338,U+633b-633c,U+633e-6341,U+6344,U+6347-6348,U+634a,U+6351-6354,U+6356-6359"}},{uri:Fpe,descriptors:{unicodeRange:"U+5dd0-5dda,U+5ddc,U+5ddf-5de0,U+5de3-5de4,U+5dea,U+5dec-5ded,U+5df0,U+5df5-5df6,U+5df8-5dfc,U+5dff-5e00,U+5e04,U+5e07,U+5e09-5e0b,U+5e0d-5e0e,U+5e12-5e13,U+5e17,U+5e1e-5e25,U+5e28-5e2c,U+5e2f-5e30,U+5e32-5e36,U+5e39-5e3a,U+5e3e-5e41,U+5e43,U+5e46-5e4b,U+5e4d-5e53,U+5e56-5e5a,U+5e5c-5e5d,U+5e5f-5e60,U+5e63-5e71,U+5e75,U+5e77,U+5e79,U+5e7e,U+5e81-5e83,U+5e85,U+5e88-5e89,U+5e8c-5e8e,U+5e92,U+5e98,U+5e9b,U+5e9d,U+5ea1-5ea4,U+5ea8-5eac,U+5eae-5eb2,U+5eb4,U+5eba-5ebd,U+5ebf-5ec8,U+5ecb-5ed0,U+5ed4-5ed5,U+5ed7-5eda,U+5edc-5ee7,U+5ee9,U+5eeb-5ef3,U+5ef5,U+5ef8-5ef9,U+5efb-5efd,U+5f05-5f07,U+5f09,U+5f0c-5f0e,U+5f10,U+5f12,U+5f14,U+5f16,U+5f19-5f1a,U+5f1c-5f1e,U+5f21-5f24,U+5f28,U+5f2b-5f2c,U+5f2e"}},{uri:Bpe,descriptors:{unicodeRange:"U+60cd-60d0,U+60d2-60d4,U+60d6-60d7,U+60d9,U+60db,U+60de,U+60e1-60e5,U+60ea,U+60f1-60f2,U+60f5,U+60f7-60f8,U+60fb-60ff,U+6102-6105,U+6107,U+610a-610c,U+6110-6114,U+6116-6119,U+611b-611e,U+6121-6122,U+6125,U+6128-612a,U+612c-613e,U+6140-6147,U+6149,U+614b,U+614d,U+614f-6150,U+6152-6154,U+6156-615c,U+615e-6161,U+6163-6166,U+6169-616f,U+6171-6174,U+6176,U+6178-618a,U+618c-618d,U+618f-6193,U+6195-619c,U+619e-61a6,U+61aa-61ab,U+61ad-61b6,U+61b8-61bd,U+61bf-61c1,U+61c3-61c4"}},{uri:zpe,descriptors:{unicodeRange:"U+5cf4-5cfa,U+5cfc-5d01,U+5d04-5d05,U+5d08-5d0d,U+5d0f-5d13,U+5d15,U+5d17-5d1a,U+5d1c-5d1d,U+5d1f-5d23,U+5d25,U+5d28,U+5d2a-5d2c,U+5d2f-5d33,U+5d35-5d3c,U+5d3f-5d46,U+5d48-5d49,U+5d4d-5d57,U+5d59-5d5a,U+5d5c,U+5d5e-5d68,U+5d6a,U+5d6d-5d6e,U+5d70-5d73,U+5d75-5d81,U+5d83-5d98,U+5d9a-5d9c,U+5d9e-5db6,U+5db8-5dc4,U+5dc6-5dcc,U+5dce-5dcf"}},{uri:Hpe,descriptors:{unicodeRange:"U+5b52,U+5b56,U+5b5e,U+5b60-5b61,U+5b67-5b68,U+5b6b,U+5b6d-5b6f,U+5b72,U+5b74,U+5b76-5b79,U+5b7b-5b7c,U+5b7e-5b7f,U+5b82,U+5b86,U+5b8a,U+5b8d-5b8e,U+5b90-5b92,U+5b94,U+5b96,U+5b9f,U+5ba7-5ba9,U+5bac-5baf,U+5bb1-5bb2,U+5bb7,U+5bba-5bbc,U+5bc0-5bc1,U+5bc3,U+5bc8-5bcb,U+5bcd-5bcf,U+5bd1,U+5bd4-5bdc,U+5be0,U+5be2-5be3,U+5be6-5be7,U+5be9-5bed,U+5bef,U+5bf1-5bf7,U+5bfd-5bfe,U+5c00,U+5c02-5c03,U+5c05,U+5c07-5c08,U+5c0b-5c0e,U+5c10,U+5c12-5c13,U+5c17,U+5c19,U+5c1b,U+5c1e-5c21,U+5c23,U+5c26,U+5c28-5c2b,U+5c2d-5c30,U+5c32-5c33,U+5c35-5c37,U+5c43-5c44,U+5c46-5c47,U+5c4c-5c4d,U+5c52-5c54,U+5c56-5c58,U+5c5a-5c5d,U+5c5f,U+5c62,U+5c64,U+5c67-5c6d,U+5c70,U+5c72-5c78,U+5c7b-5c7e,U+5c80,U+5c83-5c87,U+5c89-5c8b,U+5c8e-5c8f,U+5c92-5c93,U+5c95,U+5c9d-5ca1,U+5ca4-5ca8,U+5caa,U+5cae-5cb0,U+5cb2,U+5cb4,U+5cb6,U+5cb9-5cbc,U+5cbe,U+5cc0,U+5cc2-5cc3,U+5cc5-5cca,U+5ccc-5cd1,U+5cd3-5cd8,U+5cda-5ce0,U+5ce2-5ce3,U+5ce7,U+5ce9,U+5ceb-5cec,U+5cee-5cef,U+5cf1-5cf3"}},{uri:Vpe,descriptors:{unicodeRange:"U+593b,U+593d-5940,U+5943,U+5945-5946,U+594a,U+594c-594d,U+5950,U+5952-5953,U+5959,U+595b-595f,U+5961,U+5963-5964,U+5966-5972,U+5975,U+5977,U+597a-597c,U+597e-5980,U+5985,U+5989,U+598b-598c,U+598e-5991,U+5994-5995,U+5998,U+599a-599d,U+599f-59a2,U+59a6-59a7,U+59ac-59ad,U+59b0-59b1,U+59b3-59b8,U+59ba,U+59bc-59bd,U+59bf-59c5,U+59c7-59c9,U+59cc-59cf,U+59d5-59d6,U+59d9,U+59db,U+59de-59e2,U+59e4,U+59e6-59e7,U+59e9-59eb,U+59ed-59f8,U+59fa,U+59fc-59fe,U+5a00,U+5a02,U+5a0a-5a0b,U+5a0d-5a10,U+5a12,U+5a14-5a17,U+5a19-5a1b,U+5a1d-5a1e,U+5a21-5a22,U+5a24,U+5a26-5a28,U+5a2a-5a30,U+5a33,U+5a35,U+5a37-5a3b,U+5a3d-5a3f,U+5a41-5a45,U+5a47-5a48,U+5a4b-5a54,U+5a56-5a59,U+5a5b-5a61,U+5a63-5a66,U+5a68-5a69,U+5a6b-5a73,U+5a78-5a79,U+5a7b-5a7e,U+5a80-5a90"}},{uri:$pe,descriptors:{unicodeRange:"U+5a91,U+5a93-5a99,U+5a9c-5aa9,U+5aab-5ab1,U+5ab4,U+5ab6-5ab7,U+5ab9-5abd,U+5abf-5ac0,U+5ac3-5ac8,U+5aca-5acb,U+5acd-5ad1,U+5ad3,U+5ad5,U+5ad7,U+5ad9-5adb,U+5add-5adf,U+5ae2,U+5ae4-5ae5,U+5ae7-5ae8,U+5aea,U+5aec-5af0,U+5af2-5b08,U+5b0a-5b15,U+5b18-5b31,U+5b33,U+5b35-5b36,U+5b38-5b3f,U+5b41-5b4f"}},{uri:Gpe,descriptors:{unicodeRange:"U+5843,U+5845-584b,U+584e-5850,U+5852-5853,U+5855-5857,U+5859-585d,U+585f-5864,U+5866-586a,U+586d-587d,U+587f,U+5882,U+5884,U+5886-5888,U+588a-5891,U+5894-5898,U+589b-589d,U+58a0-58a7,U+58aa-58bb,U+58bd-58c0,U+58c2-58c4,U+58c6-58d0,U+58d2-58d4,U+58d6-58e3,U+58e5-58ea,U+58ed,U+58ef,U+58f1-58f2,U+58f4-58f5,U+58f7-58f8,U+58fa-5901,U+5903,U+5905-5906,U+5908-590c,U+590e,U+5910-5913,U+5917-5918,U+591b,U+591d-591e,U+5920-5923,U+5926,U+5928,U+592c,U+5930,U+5932-5933,U+5935-5936"}},{uri:Xpe,descriptors:{unicodeRange:"U+56d0-56d3,U+56d5-56d6,U+56d8-56d9,U+56dc,U+56e3,U+56e5-56ea,U+56ec,U+56ee-56ef,U+56f2-56f3,U+56f6-56f8,U+56fb-56fc,U+5700-5702,U+5705,U+5707,U+570b-571b,U+571d-571e,U+5720-5722,U+5724-5727,U+572b,U+5731-5732,U+5734-5738,U+573c-573d,U+573f,U+5741,U+5743-5746,U+5748-5749,U+574b,U+5752-5756,U+5758-5759,U+5762-5763,U+5765,U+5767,U+576c,U+576e,U+5770-5772,U+5774-5775,U+5778-577a,U+577d-5781,U+5787-578a,U+578d-5791,U+5794-579a,U+579c-579f,U+57a5,U+57a8,U+57aa,U+57ac,U+57af-57b1,U+57b3,U+57b5-57b7,U+57b9-57c1,U+57c4-57ca,U+57cc-57cd,U+57d0-57d1,U+57d3,U+57d6-57d7,U+57db-57dc,U+57de,U+57e1-57e3,U+57e5-57ec,U+57ee,U+57f0-57f3,U+57f5-57f7,U+57fb-57fc,U+57fe-57ff,U+5801,U+5803-5805,U+5808-580a,U+580c,U+580e-5810,U+5812-5814,U+5816-5818,U+581a-581d,U+581f,U+5822-5823,U+5825-5829,U+582b-582f,U+5831-5834,U+5836-5842"}},{uri:jpe,descriptors:{unicodeRange:"U+55f9-55fc,U+55ff,U+5602-5607,U+560a-560b,U+560d,U+5610-5617,U+5619-561a,U+561c-561d,U+5620-5622,U+5625-5626,U+5628-562b,U+562e-5630,U+5633,U+5635,U+5637-5638,U+563a,U+563c-563e,U+5640-564b,U+564f-5653,U+5655-5656,U+565a-565b,U+565d-5661,U+5663,U+5665-5667,U+566d-5670,U+5672-5675,U+5677-567a,U+567d-5684,U+5687-568d,U+5690-5692,U+5694-56a2,U+56a4-56ae,U+56b0-56b6,U+56b8-56bb,U+56bd-56c9,U+56cb-56cf"}},{uri:Ype,descriptors:{unicodeRange:"U+5286-5287,U+5289-528f,U+5291-5292,U+5294-529a,U+529c,U+52a4-52a7,U+52ae-52b0,U+52b4-52bd,U+52c0-52c2,U+52c4-52c6,U+52c8,U+52ca,U+52cc-52cf,U+52d1,U+52d3-52d5,U+52d7,U+52d9-52de,U+52e0-52e3,U+52e5-52ef,U+52f1-52f8,U+52fb-52fd,U+5301-5304,U+5307,U+5309-530c,U+530e,U+5311-5314,U+5318,U+531b-531c,U+531e-531f,U+5322,U+5324-5325,U+5327-5329,U+532b-532d,U+532f-5338,U+533c-533d,U+5340,U+5342,U+5344,U+5346,U+534b-534d,U+5350,U+5354,U+5358-5359,U+535b,U+535d,U+5365,U+5368,U+536a,U+536c-536d,U+5372,U+5376,U+5379,U+537b-537e,U+5380-5381,U+5383,U+5387-5388,U+538a,U+538e-5394,U+5396-5397,U+5399,U+539b-539c,U+539e,U+53a0-53a1,U+53a4,U+53a7,U+53aa-53ad,U+53af-53b5,U+53b7-53ba,U+53bc-53be,U+53c0,U+53c3-53c7,U+53ce-53d0,U+53d2-53d3,U+53d5,U+53da,U+53dc-53de,U+53e1-53e2,U+53e7,U+53f4,U+53fa,U+53fe-5400,U+5402,U+5405,U+5407,U+540b,U+5414,U+5418-541a,U+541c,U+5422,U+5424-5425,U+542a,U+5430,U+5433,U+5436-5437,U+543a"}},{uri:Wpe,descriptors:{unicodeRange:"U+5101-5105,U+5108-510a,U+510c-5111,U+5113-5120,U+5122-513e,U+5142,U+5147,U+514a,U+514c,U+514e-5150,U+5152-5153,U+5157-5159,U+515b,U+515d-5161,U+5163-5164,U+5166-5167,U+5169-516a,U+516f,U+5172,U+517a,U+517e-517f,U+5183-5184,U+5186-5187,U+518a-518b,U+518e-5191,U+5193-5194,U+5198,U+519a,U+519d-519f,U+51a1,U+51a3,U+51a6-51aa,U+51ad-51ae,U+51b4,U+51b8-51ba,U+51be-51bf,U+51c1-51c3,U+51c5,U+51c8,U+51ca,U+51cd-51ce,U+51d0,U+51d2-51da,U+51dc,U+51de-51df,U+51e2-51e3,U+51e5-51ea,U+51ec,U+51ee,U+51f1-51f2,U+51f4,U+51f7,U+51fe,U+5204-5205,U+5209,U+520b-520c,U+520f-5210,U+5213-5215,U+521c,U+521e-521f,U+5221-5223,U+5225-5227,U+522a,U+522c,U+522f,U+5231-5232,U+5234-5235,U+523c,U+523e,U+5244-5249,U+524b,U+524e-524f,U+5252-5253,U+5255,U+5257-525b,U+525d,U+525f-5260,U+5262-5264,U+5266,U+5268,U+526b-526e,U+5270-5271,U+5273-527c,U+527e,U+5280,U+5283-5285"}},{uri:Kpe,descriptors:{unicodeRange:"U+543d,U+543f,U+5441-5442,U+5444-5445,U+5447,U+5449,U+544c-544f,U+5451,U+545a,U+545d-5461,U+5463,U+5465,U+5467,U+5469-5470,U+5474,U+5479-547a,U+547e-547f,U+5481,U+5483,U+5485,U+5487-548a,U+548d,U+5491,U+5493,U+5497-5498,U+549c,U+549e-54a2,U+54a5,U+54ae,U+54b0,U+54b2,U+54b5-54b7,U+54b9-54ba,U+54bc,U+54be,U+54c3,U+54c5,U+54ca-54cb,U+54d6,U+54d8,U+54db,U+54e0-54e4,U+54eb-54ec,U+54ef-54f1,U+54f4-54f9,U+54fb,U+54fe,U+5500,U+5502-5505,U+5508,U+550a-550e,U+5512-5513,U+5515-551a,U+551c-551f,U+5521,U+5525-5526,U+5528-5529,U+552b,U+552d,U+5532,U+5534-5536,U+5538-553b,U+553d,U+5540,U+5542,U+5545,U+5547-5548,U+554b-554f,U+5551-5554,U+5557-555b,U+555d-5560,U+5562-5563,U+5568-5569,U+556b,U+556f-5574,U+5579-557a,U+557d,U+557f,U+5585-5586,U+558c-558e,U+5590,U+5592-5593,U+5595-5597,U+559a-559b,U+559e,U+55a0-55a6,U+55a8-55b0,U+55b2,U+55b4,U+55b6,U+55b8,U+55ba,U+55bc,U+55bf-55c3,U+55c6-55c8,U+55ca-55cb,U+55ce-55d0,U+55d5,U+55d7-55db,U+55de,U+55e0,U+55e2,U+55e7,U+55e9,U+55ed-55ee,U+55f0-55f1,U+55f4,U+55f6,U+55f8"}},{uri:Zpe,descriptors:{unicodeRange:"U+4fe0,U+4fe2,U+4fe4-4fe5,U+4fe7,U+4feb-4fec,U+4ff0,U+4ff2,U+4ff4-4ff7,U+4ff9,U+4ffb-4ffd,U+4fff-500b,U+500e,U+5010-5011,U+5013,U+5015-5017,U+501b,U+501d-501e,U+5020,U+5022-5024,U+5027,U+502b,U+502f-5039,U+503b,U+503d,U+503f-5042,U+5044-5046,U+5049-504b,U+504d,U+5050-5054,U+5056-5059,U+505b,U+505d-5064,U+5066-506b,U+506d-5075,U+5078-507a,U+507c-507d,U+5081-5084,U+5086-5087,U+5089-508c,U+508e-50a2,U+50a4,U+50a6,U+50aa-50ab,U+50ad-50b1,U+50b3-50b9,U+50bc-50ce,U+50d0-50d5,U+50d7-50d9,U+50db-50e5,U+50e8-50eb,U+50ef-50f2,U+50f4,U+50f6-50fa,U+50fc-5100"}},{uri:Hme,descriptors:{unicodeRange:"U+49d5-4a77"}},{uri:qpe,descriptors:{unicodeRange:"U+4dac-4dad,U+4daf-4db5,U+4e02,U+4e04-4e06,U+4e0f,U+4e12,U+4e17,U+4e1f-4e21,U+4e23,U+4e26,U+4e29,U+4e2e-4e2f,U+4e31,U+4e33,U+4e35,U+4e37,U+4e3c,U+4e40-4e42,U+4e44,U+4e46,U+4e4a,U+4e51,U+4e55,U+4e57,U+4e5a-4e5b,U+4e62-4e65,U+4e67-4e68,U+4e6a-4e6f,U+4e72,U+4e74-4e7d,U+4e7f-4e85,U+4e87,U+4e8a,U+4e90,U+4e96-4e97,U+4e99,U+4e9c-4e9e,U+4ea3,U+4eaa,U+4eaf-4eb1,U+4eb4,U+4eb6-4eb9,U+4ebc-4ebe,U+4ec8,U+4ecc,U+4ecf-4ed0,U+4ed2,U+4eda-4edc,U+4ee0,U+4ee2,U+4ee6-4ee7,U+4ee9,U+4eed-4eef,U+4ef1,U+4ef4,U+4ef8-4efa,U+4efc,U+4efe,U+4f00,U+4f02-4f08,U+4f0b-4f0c,U+4f12-4f16,U+4f1c-4f1d,U+4f21,U+4f23,U+4f28-4f29,U+4f2c-4f2e,U+4f31,U+4f33,U+4f35,U+4f37,U+4f39,U+4f3b,U+4f3e-4f42,U+4f44-4f45,U+4f47-4f4c,U+4f52,U+4f54,U+4f56,U+4f61-4f62,U+4f66,U+4f68,U+4f6a-4f6b,U+4f6d-4f6e,U+4f71-4f72,U+4f75,U+4f77-4f7a,U+4f7d,U+4f80-4f82,U+4f85-4f87,U+4f8a,U+4f8c,U+4f8e,U+4f90,U+4f92-4f93,U+4f95-4f96,U+4f98-4f9a,U+4f9c,U+4f9e-4f9f,U+4fa1-4fa2,U+4fa4,U+4fab,U+4fad,U+4fb0-4fb4,U+4fb6-4fbe,U+4fc0-4fc2,U+4fc6-4fc9,U+4fcb-4fcd,U+4fd2-4fd6,U+4fd9,U+4fdb"}},{uri:Qpe,descriptors:{unicodeRange:"U+4933-49d4"}},{uri:Jpe,descriptors:{unicodeRange:"U+487a-4932"}},{uri:eUe,descriptors:{unicodeRange:"U+47d2-4879,U+2ce7c,U+2ce88,U+2ce93"}},{uri:tUe,descriptors:{unicodeRange:"U+4756-47d1,U+2ca02,U+2ca0e,U+2ca7d,U+2caa9,U+2cb29,U+2cb2e,U+2cb31,U+2cb38-2cb39,U+2cb3f,U+2cb41,U+2cb4e,U+2cb5a,U+2cb64,U+2cb69,U+2cb6c,U+2cb6f,U+2cb76,U+2cb78,U+2cb7c,U+2cbb1,U+2cbbf-2cbc0,U+2cbce,U+2cc5f,U+2ccf5-2ccf6,U+2ccfd,U+2ccff,U+2cd02-2cd03,U+2cd0a,U+2cd8b,U+2cd8d,U+2cd8f-2cd90,U+2cd9f-2cda0,U+2cda8,U+2cdad-2cdae,U+2cdd5,U+2ce18,U+2ce1a,U+2ce23,U+2ce26,U+2ce2a"}},{uri:nUe,descriptors:{unicodeRange:"U+46c3-4755,U+2c488,U+2c494,U+2c497,U+2c542,U+2c613,U+2c618,U+2c621,U+2c629,U+2c62b-2c62d,U+2c62f,U+2c642,U+2c64a-2c64b,U+2c72c,U+2c72f,U+2c79f,U+2c7c1,U+2c7fd,U+2c8d9,U+2c8de,U+2c8e1,U+2c8f3,U+2c907,U+2c90a,U+2c91d"}},{uri:iUe,descriptors:{unicodeRange:"U+4629-46c2,U+2bdf7,U+2be29,U+2c029-2c02a,U+2c0a9,U+2c0ca,U+2c1d5,U+2c1d9,U+2c1f9,U+2c27c,U+2c288,U+2c2a4,U+2c317,U+2c35b,U+2c361,U+2c364"}},{uri:rUe,descriptors:{unicodeRange:"U+458e-4628,U+2b7a9,U+2b7c5,U+2b7e6,U+2b7f9,U+2b806,U+2b80a,U+2b81c,U+2b8b8,U+2bac7,U+2bb5f,U+2bb62,U+2bb7c,U+2bb83,U+2bc1b,U+2bd77,U+2bd87"}},{uri:sUe,descriptors:{unicodeRange:"U+4449-4511,U+2afa2,U+2b127-2b128,U+2b137-2b138,U+2b1ed"}},{uri:oUe,descriptors:{unicodeRange:"U+439b-4448,U+2a437,U+2a5f1,U+2a602,U+2a61a,U+2a6b2,U+2a7dd,U+2a8fb,U+2a917,U+2aa30,U+2aa36,U+2aa58"}},{uri:aUe,descriptors:{unicodeRange:"U+4275-430d,U+298c6,U+29a72,U+29d98,U+29ddb,U+29e15,U+29e3d,U+29e49"}},{uri:lUe,descriptors:{unicodeRange:"U+4132-41de,U+28bef,U+28c47,U+28c4f,U+28c51,U+28c54,U+28d10,U+28d71,U+28dfb,U+28e1f,U+28e36,U+28e89,U+28e99,U+28eeb,U+28f32,U+28ff8,U+292a0"}},{uri:cUe,descriptors:{unicodeRange:"U+41df-4274,U+292b1,U+29490,U+295cf,U+2967f,U+296f0,U+29719,U+29750"}},{uri:dUe,descriptors:{unicodeRange:"U+408e-4131,U+285c8-285c9,U+28678,U+28695,U+286d7,U+286fa,U+287e0,U+28946,U+28949,U+2896b,U+28987-28988,U+289ba-289bb,U+28a1e,U+28a29,U+28a43,U+28a71,U+28a99,U+28acd,U+28add,U+28ae4,U+28b49,U+28bc1"}},{uri:uUe,descriptors:{unicodeRange:"U+3e83-3f2f,U+27139,U+273da-273db,U+273fe,U+27410,U+27449,U+27614-27615,U+27631,U+27684,U+27693,U+2770e,U+27723,U+27752"}},{uri:fUe,descriptors:{unicodeRange:"U+3f30-3fdb,U+27985,U+27a84,U+27bb3,U+27bbe,U+27bc7,U+27cb8,U+27da0,U+27e10"}},{uri:hUe,descriptors:{unicodeRange:"U+3fdc-408d,U+27fb7,U+27ff9,U+2808a,U+280bb,U+2815d,U+28277,U+28282,U+282e2,U+282f3,U+283cd,U+28408,U+2840c,U+28455,U+28468,U+2856b"}},{uri:gUe,descriptors:{unicodeRange:"U+3dd2-3e82,U+26a58,U+26a8c,U+26ab7,U+26aff,U+26b5c,U+26c21,U+26c29,U+26c73,U+26cdd,U+26e40,U+26e65,U+26f94,U+26ff6-26ff8,U+270f4,U+2710d"}},{uri:mUe,descriptors:{unicodeRange:"U+3d34-3dd1,U+2648d,U+26676,U+2667e,U+266b0,U+2671d,U+2677c,U+267cc,U+268dd,U+268ea,U+26951,U+2696f,U+269dd,U+269fa,U+26a1e"}},{uri:pUe,descriptors:{unicodeRange:"U+3c76-3d33,U+25d0a,U+25da1,U+25e2e,U+25e56,U+25e62,U+25e65,U+25ec2,U+25ed7-25ed8,U+25ee8,U+25f23,U+25f5c,U+25fd4,U+25fe0,U+25ffb,U+2600c,U+26017,U+26060,U+260ed,U+26221,U+26270,U+26286,U+2634c,U+26402"}},{uri:UUe,descriptors:{unicodeRange:"U+3bda-3c75,U+25771,U+257a9,U+257b4,U+259c4,U+259d4,U+25ae3-25ae4,U+25af1,U+25bb2,U+25c14,U+25c4b,U+25c64"}},{uri:bUe,descriptors:{unicodeRange:"U+3b25-3bd9,U+2504a,U+25055,U+25122,U+2512b,U+251a9,U+251cd,U+251e5,U+2521e,U+2524c,U+2542e,U+2548e,U+254d9,U+2550e,U+25532,U+25562,U+255a7-255a8"}},{uri:yUe,descriptors:{unicodeRange:"U+3a6b-3b24,U+24896,U+249db,U+24a4d,U+24a7d,U+24ac9,U+24b56,U+24b6f,U+24c16,U+24d14,U+24dea,U+24e0e,U+24e37,U+24e6a,U+24e8b,U+24eaa"}},{uri:EUe,descriptors:{unicodeRange:"U+39a9-3a6a,U+24096,U+24103,U+241ac,U+241c6,U+241fe,U+243bc,U+243f8,U+244d3,U+24629,U+246a5,U+247f1"}},{uri:vUe,descriptors:{unicodeRange:"U+38e3-39a8,U+23a98,U+23c7f,U+23c97-23c98,U+23cfe,U+23d00,U+23d0e,U+23d40,U+23dd3,U+23df9-23dfa,U+23e23,U+23f7e"}},{uri:wUe,descriptors:{unicodeRange:"U+3760-382a,U+22ab8,U+22b43,U+22b46,U+22b4f-22b50,U+22ba6,U+22bca,U+22c1d,U+22c24,U+22c55,U+22d4c,U+22de1"}},{uri:_Ue,descriptors:{unicodeRange:"U+382b-38e2,U+231b6,U+231c3-231c4,U+231f5,U+23350,U+23372,U+233d0,U+233d2-233d3,U+233d5,U+233da,U+233df,U+233e4,U+2344a-2344b,U+23451,U+23465,U+234e4,U+2355a,U+23594,U+235c4,U+235cb,U+23638-2363a,U+23647,U+2370c,U+2371c,U+2373f,U+23763-23764,U+237e7,U+237ff,U+23824,U+2383d"}},{uri:TUe,descriptors:{unicodeRange:"U+3698-375f,U+22218,U+2231e,U+223ad,U+224dc,U+226f3,U+2285b,U+228ab,U+2298f"}},{uri:IUe,descriptors:{unicodeRange:"U+35e6-3697,U+21c56,U+21cde,U+21d2d,U+21d45,U+21d62,U+21d78,U+21d92,U+21d9c,U+21da1,U+21db7,U+21de0,U+21e33-21e34,U+21f1e,U+21f76,U+21ffa,U+2217b"}},{uri:SUe,descriptors:{unicodeRange:"U+3444-350e,U+20ad3,U+20b1d,U+20b9f,U+20c41,U+20cbf,U+20cd0,U+20d45,U+20de1,U+20e64,U+20e6d,U+20e95,U+20e9d,U+20ea2,U+20f5f,U+210c1,U+21201,U+2123d,U+21255,U+21274,U+2127b"}},{uri:xUe,descriptors:{unicodeRange:"U+350f-35e5,U+212d7,U+212e4,U+212fd,U+2131b,U+21336,U+21344,U+2139a,U+213c4,U+21413,U+2146d-2146e,U+215d7,U+21647,U+216b4,U+21706,U+21742,U+218bd,U+219c3"}},{uri:CUe,descriptors:{unicodeRange:"U+336d-3443,U+2032b,U+20371,U+20381,U+203f9,U+2044a,U+20509,U+20547,U+205d6,U+20628,U+20676,U+2074f,U+20779,U+20807,U+2083a,U+20895,U+208b9,U+2097c,U+2099d"}},{uri:AUe,descriptors:{unicodeRange:"U+328b-336c,U+2000b,U+20089,U+200a2,U+200a4,U+20164,U+201a2,U+20213"}},{uri:MUe,descriptors:{unicodeRange:"U+3192-31ba,U+31c0-31e3,U+31f0-321e,U+3220-328a,U+1f250-1f251"}},{uri:kUe,descriptors:{unicodeRange:"U+2f74-2fd5,U+3000,U+3003-3007,U+3012-3013,U+3018-301c,U+3020-3029,U+302f-303f,U+3041-3096,U+3099-30a1"}},{uri:RUe,descriptors:{unicodeRange:"U+30a2-30ff,U+3105-312f,U+3131-318e,U+3190-3191"}},{uri:DUe,descriptors:{unicodeRange:"U+4e36,U+4ea0,U+4f74,U+4f91,U+4f94,U+4fc5,U+507e,U+50ed,U+5182,U+51f5,U+525e,U+5282,U+52f9,U+5326,U+537a,U+53a3,U+5423,U+5459,U+54b4,U+54d9,U+55c9,U+57f4,U+580b,U+5902,U+5925,U+5a08,U+5ab5,U+5b84,U+5be4,U+5c22,U+5cb5,U+5cbd,U+5d3e,U+5e31,U+5e5e,U+5e80,U+5ee8,U+5f82,U+5fc9,U+5fed,U+600a,U+605d,U+609b,U+609d,U+60dd,U+6243,U+6322,U+63ce,U+640c,U+643f,U+6445,U+64d7,U+6534,U+6549,U+656b,U+6603,U+674c,U+680a,U+6864,U+69d4,U+6a65,U+6c2a,U+6c46,U+6c5c,U+6d0e,U+6d48,U+6e2b,U+6eb2,U+6eb7,U+6f89,U+706c,U+70b1,U+7113,U+71d4,U+727f,U+72f3,U+7303,U+7321,U+736c,U+736f,U+74a9,U+74de,U+750d,U+7513,U+7592,U+75c4,U+7605,U+760a,U+761b,U+7625,U+762d,U+7643,U+7707,U+7747,U+77b5,U+7839,U+784e,U+78a5,U+7924,U+793b,U+798a,U+7a03,U+7a06,U+7a78,U+7a80,U+7aad,U+7ba8,U+7be5,U+7cc8,U+7ec1,U+7f0b,U+7f0f,U+7f12,U+7f68,U+7f9d,U+8025,U+809c,U+80ad,U+80b7,U+80e8,U+811e,U+8204,U+8223,U+822d,U+823b,U+824b,U+825a,U+827d,U+827f,U+828f,U+82c8,U+8307,U+831b,U+8347,U+837d,U+839b,U+83a9,U+83f9,U+84b9,U+8579,U+864d,U+867f,U+86b0,U+86d1,U+86d8,U+86f2,U+8764,U+8770,U+8788,U+8797,U+87ac-87ad,U+87b5,U+881b,U+8844,U+88bc,U+88fc,U+8930,U+89cf,U+89d6,U+8ba0,U+8bd4,U+8c02,U+8c2b,U+8c85,U+8e23,U+8f81-8f82,U+8fd5,U+90b6,U+90db,U+914e,U+9164,U+91ad,U+943e,U+94b7-94b8,U+94eb,U+950d,U+9514,U+9516,U+9518,U+9529,U+9538,U+953f,U+954e,U+955f,U+95fc,U+9667,U+96b3,U+9792,U+97b2,U+98a1,U+9969,U+9987,U+9998,U+9a80,U+9a92,U+9a96,U+9adf,U+9cb4,U+9cbd,U+9cd0,U+9cd4,U+9e31,U+9e3a,U+9e71,U+9ee5,U+9eea,U+9ef9,U+9fa0"}},{uri:LUe,descriptors:{unicodeRange:"U+4e0c,U+4e28,U+4e3f,U+4ec2,U+502e,U+50ba,U+5155,U+5181,U+522d,U+5281,U+5290,U+5369,U+53b6,U+54d5,U+54dc,U+54ff,U+552a,U+553c,U+5588,U+55b5,U+5686,U+570a,U+5776,U+5786,U+57a4,U+5820,U+5865,U+58bc,U+5b32,U+5b65,U+5c1c,U+5c66,U+5c6e,U+5c8d,U+5ddb,U+5f2a,U+5f50,U+5f61,U+6067,U+614a,U+615d,U+619d,U+61d4,U+620b,U+6224-6225,U+6343,U+63ad,U+63f2,U+640b,U+6420,U+6434,U+6496,U+64d0,U+6509,U+652e,U+67a8,U+6833,U+6844,U+684a,U+6920,U+6957,U+6971,U+6a8e,U+6a91,U+6aa0,U+6b43,U+6bea,U+6bf5,U+6c15,U+6cd0,U+6ee0,U+6f24,U+6f2d,U+70c0,U+721d,U+728b,U+72c3,U+72e8,U+730a,U+7338-7339,U+734d,U+746d,U+752f,U+754e,U+770d,U+7735,U+778d,U+77a2,U+77e7,U+7857,U+786d,U+78c9,U+78f2,U+791e,U+7953,U+7b58,U+7b9d,U+7bda,U+7cd7,U+7f32-7f33,U+8022,U+8028-8029,U+8035,U+804d,U+8080,U+80c2,U+80e9,U+80ec,U+80f2,U+810e,U+8221,U+8274,U+82b0,U+82e0,U+83b0,U+8487-8488,U+848e,U+84cd,U+84d0,U+8539,U+857a,U+85a8,U+85b7,U+867c,U+871e,U+8723,U+877e,U+878b,U+8793,U+8803,U+88d2,U+8966,U+89cc,U+89eb,U+8b26,U+8c8a,U+8c98,U+8d33,U+8d47,U+8d55,U+8dbc,U+8e40,U+8e94,U+8f77,U+8f79,U+9058,U+91a2,U+91b5,U+928e,U+9494,U+94b6,U+94de,U+94f4,U+94f9,U+950a,U+950e,U+951e,U+952b,U+953c,U+953e,U+9544,U+9561,U+9564,U+9569,U+95f6,U+9603,U+960d,U+963d,U+9674,U+9794,U+97ab,U+98a5,U+9a9f,U+9ab1,U+9ad1,U+9b0f,U+9b2f,U+9c92,U+9c95,U+9cba,U+9cbc,U+9cc6,U+9ccb,U+9cd8,U+9e32,U+9e38,U+9e5b,U+9e7e,U+9eb4,U+9efb-9efc,U+9f3d"}},{uri:NUe,descriptors:{unicodeRange:"U+2e3b,U+2e80-2e99,U+2e9b-2ef3,U+2f00-2f73,U+ffffd"}},{uri:OUe,descriptors:{unicodeRange:"U+4e69,U+4f1b,U+4f67,U+4f7e,U+4fdc,U+50e6,U+5196,U+5202,U+5233,U+523f,U+52a2,U+536e,U+5476,U+54ad,U+54cf,U+5537,U+561e,U+56dd,U+56df,U+5709,U+572c,U+57cf,U+57f8,U+580d,U+5881,U+589a,U+5941,U+59b2,U+5c25,U+5d24,U+5d74,U+5e42,U+5e8b,U+5eb3,U+5ed2,U+5fad,U+6003,U+603c,U+6083,U+6100,U+6126,U+6206,U+62ca,U+638e,U+63b4,U+6426,U+646d,U+6535,U+65c4,U+66db,U+6715,U+6769,U+6798,U+67c3,U+6861,U+698d,U+69ca,U+69ed,U+69f2,U+69ff,U+6a18,U+6b39,U+6bb3,U+6c0d,U+6cb2,U+6cd6,U+6cf7,U+6cfa,U+6d33,U+6e16,U+6e53-6e54,U+6ebb,U+6fb6,U+709d,U+72ad,U+72f7,U+72fb,U+7313,U+739f,U+74ba,U+754b,U+755b,U+758b,U+75ac,U+75d6,U+7617,U+7635,U+7640,U+76a4,U+76b2,U+775a,U+77bd,U+781f,U+79b3,U+7b2b,U+7b31,U+7b3e,U+7b6e,U+7b9c,U+7c0b,U+7c9e,U+7cc1,U+7ce8,U+7ea5,U+7f21,U+7f27,U+7f74,U+7fb0,U+8031,U+8071,U+80ea,U+8114,U+8160,U+81a6,U+81c1,U+829f,U+82a4,U+82fb,U+831a,U+8333,U+836c,U+83b6,U+83f8,U+8411,U+841c,U+8489,U+848c,U+85a4,U+8627,U+8629,U+866e,U+86b5,U+872e,U+8731,U+877b,U+877d,U+87ea,U+8813,U+8816,U+8864,U+88ce,U+88e5,U+897b,U+89cb,U+89f3,U+8bfc,U+8c35,U+8d46,U+8d4d,U+8dba,U+8e3a,U+8f75,U+8f7e,U+8fd3,U+9161,U+9179,U+917e,U+91a3,U+94ac,U+94d7,U+94e5,U+952a,U+952c,U+9545,U+9565,U+9568,U+956a,U+961d,U+96e0,U+972a,U+9730,U+989f,U+98e7,U+990d,U+9967,U+9993,U+9aa3,U+9ac0,U+9ae1,U+9aeb,U+9af9,U+9c86,U+9c8b,U+9ca0-9ca1,U+9ca3,U+9ce2,U+9e48,U+9e6a,U+9e87,U+9ee2,U+9ee9,U+9f17,U+9f19,U+9f2c,U+9f80"}},{uri:PUe,descriptors:{unicodeRange:"U+4ef3,U+50d6,U+50ec,U+51ab,U+51b1,U+52d6,U+54a9,U+54da,U+55be,U+55cd,U+564d,U+572f,U+574c,U+576b,U+57d8,U+57fd,U+5844,U+59d2,U+5ae0,U+5b16,U+5b37,U+5b5b,U+5b80,U+5d1e,U+5d6b,U+5efe,U+5f11,U+5f56,U+5f58,U+5f73,U+5f8c,U+5fc4,U+5fe4,U+602b,U+6106,U+610d,U+63de,U+63f8,U+641b,U+64e4,U+6634,U+676a,U+67b5,U+681d,U+6883,U+69b1,U+69e0,U+6b37,U+6b9b,U+6d7c,U+6ed7,U+6f36,U+6f72,U+6f8c,U+7035,U+7039,U+7173,U+7178,U+7228,U+728f,U+72b4,U+72ef,U+72f4,U+7331,U+7481,U+74e0,U+7540,U+75c3,U+75e6,U+763c,U+764d,U+76cd,U+7704,U+7743,U+7780,U+7847,U+786a,U+78b9,U+7962,U+7a02,U+7aac,U+7ab3,U+7b0a,U+7b4c,U+7b7b,U+7bfc,U+7c0f,U+7c16,U+7c40,U+7ca2,U+7cc7,U+7cf8,U+7d77,U+7e3b,U+7ea1,U+7ea9,U+7ef2,U+7f02,U+7f07,U+7f0c,U+7f23,U+7f2f,U+7fbc,U+8016,U+8020,U+812c,U+8136,U+8182,U+822f,U+8233,U+825f,U+8268,U+8284,U+8288,U+8291,U+8308,U+8311,U+835b,U+836d,U+83dd,U+8406,U+840f,U+845c,U+84b4,U+84e3,U+850c,U+855e,U+863c,U+86ba,U+86c4,U+86de,U+86f1,U+873e,U+87bd,U+87db,U+880a,U+883c,U+887f,U+88f0,U+890a,U+892b,U+895e,U+89ef,U+8a48,U+8bdc,U+8c18,U+8c33,U+8c94,U+8db1,U+8dcf,U+8dd6,U+8de3,U+8e6f,U+8e90,U+8f7a,U+8fb6,U+902d,U+90be,U+91af,U+936a,U+948b,U+94d8,U+9513,U+953a,U+956c,U+963c,U+9654,U+966c,U+9688,U+97b4,U+996b,U+9a75,U+9a7a,U+9aba,U+9aed,U+9b08,U+9b43,U+9c8e,U+9c94,U+9c9a,U+9e2b,U+9e36,U+9e4b,U+9e4e,U+9e55,U+9e63,U+9e68-9e69,U+9ebd,U+9ec9,U+9f0d,U+9f37,U+9f51"}},{uri:FUe,descriptors:{unicodeRange:"U+50a7,U+5240,U+5261,U+52ac,U+531a,U+5363,U+5432,U+5452,U+5456,U+5472,U+5478,U+553f,U+5575,U+5581,U+55cc,U+55fe,U+5601,U+572e,U+57d2,U+57ef,U+581e,U+5924,U+5981,U+5997,U+59a3,U+5aaa,U+5ab8,U+5b34,U+5d5d,U+5def,U+5e11,U+5e91,U+5ed1,U+5ef4,U+5f40,U+600d,U+6019,U+601b,U+605a,U+6092,U+60ab,U+6217,U+623d,U+6369,U+65d2,U+6661,U+670a,U+6753,U+67a7,U+6855,U+68f9,U+6939,U+696e,U+6980,U+6a7c,U+6aab,U+6b82,U+6bf3,U+6bf9,U+6c05,U+6c19-6c1a,U+6ca9,U+6cf6,U+6d1a,U+6dab,U+6f74,U+7085,U+7198,U+71b5,U+7256,U+725d,U+727e,U+72fa,U+7322,U+738e,U+73e5,U+750f,U+755a,U+7594,U+75b3,U+760c,U+7615,U+7630,U+763f,U+77ec,U+7817,U+78a1,U+78d9,U+7905,U+7b2a,U+7b2e,U+7b62,U+7b85,U+7bcc,U+7bea,U+7c26,U+7c74,U+7c9c-7c9d,U+7e47,U+7e9b,U+7e9f,U+7ee0,U+7ee8,U+7ef1,U+7f01,U+7f11,U+7f17,U+7f36,U+7f7e,U+7fee,U+802a,U+80cd,U+8112,U+8169,U+8234,U+8279,U+8298,U+82ca,U+82d8,U+82e1,U+83c0,U+83d4,U+83df,U+8401,U+8451,U+845a,U+8476,U+8478,U+84ba,U+84bd,U+84e0,U+851f,U+8548,U+8556,U+8585,U+868d,U+86e9,U+86f4,U+86f8,U+8765,U+8785,U+87ab,U+87ee,U+8832,U+8872,U+88b7,U+88e2-88e3,U+89da,U+8bce,U+8bd3,U+8bd6,U+8bf9,U+8c16,U+8c73,U+8d5c,U+8dde,U+8f6d,U+8f94,U+8fe8,U+9011,U+915e,U+9185,U+918c,U+94ab,U+94d1,U+94f3,U+9515,U+951d,U+9558,U+9567,U+96ce,U+96e9,U+9785,U+9878,U+987c,U+9883,U+98d1,U+9954,U+9963,U+9a93,U+9ac1,U+9acc,U+9b1f,U+9b49,U+9b4d,U+9b51,U+9ca7,U+9cae,U+9cce,U+9cd3,U+9e37,U+9e39,U+9e41,U+9e46,U+9f22,U+9f2f,U+9f39,U+9f85"}},{uri:BUe,descriptors:{unicodeRange:"U+4e5c,U+4edf,U+4f25,U+4f32,U+4f5e,U+4f76,U+4faa,U+4fe6,U+5028,U+5048,U+5250,U+535f,U+538d,U+53c1,U+5412,U+5443,U+54d4,U+54dd,U+5541,U+5550,U+5577,U+55dd,U+55f3,U+560f,U+562c,U+5657-5658,U+5664,U+56af,U+575c,U+577c,U+57b2,U+57da,U+5800,U+5a62,U+5aeb,U+5c3b,U+5ca3,U+5d26,U+5d9d,U+5f01,U+5fb5,U+5fdd,U+5ff8,U+6029,U+6041,U+6079,U+60b1,U+6222,U+629f,U+6332,U+63bc,U+63e0,U+6485,U+65ab,U+65c3,U+65c6,U+668c,U+669d,U+66be,U+67fd,U+6800,U+68fc,U+690b,U+6924,U+6978,U+69a7,U+6a3e,U+6a50,U+6a5b,U+6a97,U+6b24,U+6b8d,U+6baa,U+6c10,U+6c54,U+6ceb,U+6d04,U+6d4d,U+6eb1,U+6ebd,U+7110,U+71b3,U+71f9,U+7230,U+728d,U+7292,U+72b8,U+72d2,U+7360,U+73a2,U+7511,U+75a0,U+75c8,U+779f,U+7826,U+7877,U+7a39,U+7aa8,U+7ae6,U+7b04,U+7b0f,U+7baa,U+7bac,U+7c1f,U+7ccd,U+7ecb,U+7ed4,U+7ed7,U+7efb,U+7f0d,U+7f5f,U+7faf,U+7fd5,U+7fe5,U+8027,U+80bc,U+80dd,U+80fc,U+8132,U+815a,U+8167,U+816d,U+81ca,U+8228,U+82a1,U+82a9,U+82ab,U+82cc,U+8351,U+8368,U+83b8,U+83d8,U+83ea,U+83f0,U+8497,U+84c1,U+858f,U+85ff,U+867b,U+86a8-86a9,U+870a,U+8722,U+876e,U+877c,U+87e5,U+8888,U+88df,U+8919,U+8bcc,U+8bdf,U+8be8,U+8bee,U+8c20,U+8c2f,U+8d36,U+8df8,U+8e05,U+8e2f,U+8f9a,U+9021,U+908b,U+90b4,U+90ba,U+90d0,U+90eb,U+90fe,U+91aa,U+933e,U+9486-9487,U+948d,U+9490,U+94ad,U+94bd,U+94d6,U+94d9,U+9507,U+9546,U+955e,U+956b,U+95e9,U+9604,U+960b,U+9612,U+9615,U+9617,U+96b9,U+989a-989b,U+989e,U+9a78,U+9a7d,U+9aa0,U+9aa2,U+9ac2,U+9b23,U+9b3b,U+9c82,U+9cca,U+9cd9,U+9e28,U+9e5a,U+9e5e,U+9e6c,U+9efe,U+9f0b"}},{uri:zUe,descriptors:{unicodeRange:"U+4e47,U+4e8d,U+4f65,U+4f89,U+50ee,U+520e,U+5416,U+5454,U+54bb,U+54c2,U+54d3,U+54de,U+5591,U+55e5,U+560c,U+566b,U+5769,U+578c,U+5793,U+57e4,U+5889,U+593c,U+59ab,U+5ad4,U+5ad8,U+5af1,U+5b53,U+5ba5,U+5c59,U+5c63,U+5d5b,U+5e0f,U+5e14,U+5edb,U+5fbc,U+6004,U+60ad,U+610e,U+61b7,U+624c,U+634c,U+647a,U+64ba,U+65f0,U+6600,U+66f7,U+67e2,U+67f0,U+680c,U+686b,U+6874,U+691f,U+6989,U+6a17,U+6b81,U+6b84,U+6c06-6c07,U+6c3d,U+6d07,U+6d27,U+6d2b,U+6d91,U+6e6b,U+6e8f,U+6fde,U+70bb,U+723b,U+726e,U+72b0,U+72ce,U+72f2,U+7301,U+731e,U+737e,U+7477,U+748e,U+74ff,U+7633,U+7654,U+771a,U+7726,U+7765,U+7768,U+781c,U+7829,U+78d4,U+7913,U+7957,U+79d5,U+79eb,U+7a70,U+7a86,U+7b25,U+7b38,U+7b47,U+7b72,U+7ba6-7ba7,U+7dae,U+7ee1,U+7efe,U+7f26,U+7f31,U+7f35,U+801c,U+8043,U+809f,U+80ab,U+80d7,U+8118,U+8188,U+81cc,U+823e,U+8244,U+824f,U+82b4,U+82c1,U+82e4,U+82f4,U+8306,U+833a,U+835c,U+839c,U+83b3,U+83bc,U+846d,U+867a,U+868b,U+8734,U+87ca,U+886e,U+887e,U+88a2,U+88c9,U+8921,U+8bb5,U+8bf3,U+8c04,U+8c17,U+8c1d,U+8c25,U+8c36,U+8c55,U+8c78,U+8d3d,U+8d40,U+8d59,U+8d67,U+8d91,U+8dbf,U+8deb-8dec,U+8dfd,U+8e14,U+8e41,U+8f8e,U+900b,U+9044,U+9062,U+90cf,U+9123,U+9146,U+9162,U+9172,U+918d,U+9190,U+92c8,U+93ca,U+948c,U+94aa,U+94b2,U+94c8,U+94ca,U+94d5,U+94df,U+94e9-94ea,U+94f7,U+94fc-94fd,U+951b,U+954f,U+9554,U+9559,U+9566,U+9571-9572,U+95f1,U+9608,U+960f,U+97af,U+988f,U+98d5,U+992e,U+9955,U+9ab0,U+9b32,U+9c90,U+9c9e,U+9ca5,U+9ca9,U+9cad,U+9cb1,U+9cc3,U+9e47,U+9ee7,U+9f87"}},{uri:HUe,descriptors:{unicodeRange:"U+4e93,U+4ec4,U+4ef5,U+4f27,U+4f7b,U+4fe3,U+5080,U+5121,U+51eb,U+5208,U+52f0,U+53f5,U+5453,U+5466,U+54a6,U+54bf,U+54d0,U+5533,U+5549,U+5556,U+556d,U+558f,U+55f2,U+55f5,U+5627,U+567b,U+56d4,U+571c,U+5739,U+57b4,U+5807,U+58c5,U+59a4,U+59af,U+59d8,U+5a09,U+5a0c,U+5a4a,U+5ad2,U+5b6c,U+5ca2,U+5cac,U+5d03,U+5d6c,U+5db7,U+5ebe,U+5f2d,U+5fea,U+6042,U+6120,U+6175,U+6221,U+623e,U+6339,U+638a,U+643d,U+64b8,U+64e2,U+66e9,U+67b3,U+67c1,U+67d2,U+6832,U+6877,U+68f0,U+6934,U+6966,U+6987,U+6998,U+69c1,U+69ce,U+6a3d,U+6a84,U+6aa9,U+6b87,U+6bd6,U+6c16,U+6c18,U+6cd4,U+6cee,U+6de0,U+6e0c,U+6ecf,U+6f4b,U+70b7,U+7168,U+72d9,U+7352,U+73b3,U+73d0,U+7441,U+74d2,U+75a5,U+75e7-75e8,U+7610,U+7619,U+765e,U+772d,U+7812,U+782c,U+784c,U+7850,U+7856,U+789b,U+78f4,U+7a51,U+7b15,U+7b1e,U+7b24,U+7b5a,U+7bb8,U+7bc1,U+7bd9,U+7ed0,U+7ee6,U+7efa,U+7f1b,U+7f1f,U+7f22,U+7f45,U+7f71,U+7fa7,U+7fbf,U+7ff3,U+8052,U+80b1,U+80db,U+80f4,U+81bb,U+81ec,U+8202,U+8210,U+8249,U+828a,U+828e,U+82e3,U+8315,U+8369,U+8378,U+83a8,U+83aa,U+83b4,U+83e1,U+84fc,U+8538,U+853b,U+859c,U+85ae,U+86b4,U+86c9,U+86cf,U+8725,U+879f,U+87b3,U+887d,U+88fe,U+8a8a,U+8ba7,U+8c07,U+8c14,U+8c30,U+8c47,U+8db5,U+8dd7,U+8e1f,U+8e69,U+8e70,U+8e85,U+8f78,U+8f87,U+8f8b,U+8f8f,U+90c4,U+9143,U+917d,U+948f,U+94cd,U+94d2,U+94ef,U+954a,U+9609-960a,U+96d2,U+9708,U+9765,U+97ea,U+9880,U+98a7,U+996c,U+9980,U+9991,U+9a88,U+9ab6,U+9afb,U+9b47,U+9c87,U+9c9b,U+9cb5,U+9cc7,U+9e2c,U+9e42,U+9e58,U+9ecd,U+9ecf,U+9f8a,U+9f8c"}},{uri:VUe,descriptors:{unicodeRange:"U+4ebb,U+4edd,U+4fa9,U+502c,U+50a5,U+51c7,U+51fc,U+523d,U+5241,U+530f,U+5464,U+549d,U+54a3,U+5514,U+5527,U+555c,U+556e,U+5576,U+55b1,U+55b9,U+55eb,U+5624,U+564c,U+5671,U+5685,U+568f,U+56d7,U+56e1,U+57a1,U+57d9,U+5942,U+5a67,U+5c50,U+5c7a,U+5c98,U+5d06,U+5d27,U+5d6f,U+5df3,U+5dfd,U+5e19,U+5ea0,U+5eb9,U+5eea,U+5ffe,U+600f,U+606b,U+6215,U+622c,U+6266,U+62bb,U+62bf,U+6308,U+6387,U+63b8,U+63c4,U+63c6,U+63f6,U+6441,U+6555,U+659b,U+6677,U+66a7,U+6775,U+678b,U+679e,U+6840,U+6849,U+6860,U+68c2,U+6910,U+6a28,U+6a2f,U+6a79,U+6b92-6b93,U+6bc2,U+6bfd,U+6c29,U+6c32,U+6c86,U+6cc5,U+6d0c,U+6d60,U+6da0,U+6ddd,U+6e86,U+6ed3,U+6edf,U+6fb9,U+6fd1,U+6fef,U+7023,U+7080,U+70ca,U+712f,U+7145,U+7284,U+732c,U+73c8,U+73d9,U+740a,U+7457,U+7596,U+759d,U+75a3,U+75d8,U+75e3-75e4,U+75ff,U+7622,U+7688,U+76b4,U+76e5,U+7818,U+7887,U+789a,U+78b2,U+7b08,U+7b33,U+7c2a,U+7ccc,U+7ea8,U+7ec0,U+7fe6,U+8012,U+8084,U+8093,U+80e4,U+80ef,U+8297,U+82a8,U+82be,U+8331,U+8366,U+83c5,U+83fd,U+8473,U+84a1,U+84ca,U+84d1,U+857b,U+85c1,U+85d3,U+8605,U+8662,U+86aa,U+86b1,U+86d4,U+86ed,U+86f3,U+8709,U+8748,U+874c,U+8763,U+89c7,U+89de,U+89e5,U+8a3e,U+8ba6,U+8c00,U+8c21,U+8c49,U+8c7a,U+8d30,U+8df9,U+8e51,U+8e59,U+8f6b,U+8f73,U+8ff3,U+9016,U+9026,U+902f,U+9099,U+909b,U+90c7,U+914a,U+91ae,U+91ba,U+9495,U+94a3,U+94af,U+94ba,U+94bf,U+94cc,U+94e1,U+94f0,U+9531,U+955d,U+95f3,U+9697,U+96bc,U+975b,U+977c,U+98a2,U+998a,U+9994-9995,U+9a9b,U+9ab7,U+9ac5,U+9c91,U+9ccf,U+9cd5,U+9e29,U+9edc,U+9edf,U+9f83,U+9f88-9f89"}},{uri:$Ue,descriptors:{unicodeRange:"U+4ee8,U+4f22,U+4f43,U+4f57,U+4f5d,U+4f6f,U+4ff8,U+502d,U+507b,U+5345,U+53df,U+53fb,U+544b,U+5482,U+54a7,U+54cc,U+550f,U+5544,U+5555,U+5594,U+55e8,U+55ec,U+55ef,U+564e,U+56f9,U+5704,U+576d,U+5785,U+57ad,U+5914,U+5958,U+599e,U+59aa,U+59be,U+5a06,U+5abe,U+5ae1,U+5b40,U+5bee,U+5cbf,U+5cc4,U+5ccb,U+5d47,U+603f,U+6078,U+607d,U+607f,U+608c,U+609a,U+60fa,U+61ff,U+621b,U+622e,U+626a,U+6371,U+63ae,U+63cd,U+63d6,U+6410,U+6414,U+6421,U+6448,U+64d8,U+6710,U+6748,U+6772,U+680e,U+6954,U+69ab,U+6c68,U+6c8f,U+6ca4,U+6d2e,U+6e4e,U+6e98,U+6fe0,U+7094,U+70e9,U+7116,U+7119,U+723f,U+73c9,U+74e4,U+753e,U+7548,U+75bd,U+75cd,U+7618,U+7634,U+76c5,U+76f1,U+7708,U+7719,U+777e,U+7791,U+77b3,U+7823,U+7827,U+7830,U+7889,U+7893,U+7949,U+795c,U+79e3,U+7a14,U+7a88,U+7a95,U+7aa0,U+7afd,U+7b90,U+7bd1,U+7bfe,U+7da6,U+7ec2,U+7eef,U+7f03-7f04,U+7f08,U+7f58,U+7f61,U+7f9f,U+8174,U+8200,U+828d,U+82c4,U+82d5,U+82dc,U+82f7,U+832d,U+835a,U+840b,U+8438,U+852b,U+869d,U+86ac,U+86d0,U+86f0,U+8782,U+87a8,U+87d1-87d2,U+87e0,U+8839,U+8913,U+891b,U+8934,U+8941,U+89ca,U+89ce,U+8a07,U+8ba3,U+8bc5,U+8bcb,U+8bdb,U+8c11,U+8c15,U+8c29,U+8c32,U+8dc4,U+8dce,U+8ddb,U+8dfa,U+8e09,U+8e1d,U+8e39,U+8e42,U+8e49,U+8e4b,U+8e8f,U+8f71-8f72,U+9004,U+9036,U+9097,U+90dc,U+90e2,U+90e6,U+90ef,U+9104,U+919a,U+91b4,U+938f,U+9497,U+950f,U+9557,U+9562-9563,U+9573,U+9606,U+9649,U+972d,U+973e,U+97a3,U+97eb,U+988c,U+9894,U+98a6,U+9974,U+9977,U+997d,U+9a90,U+9a9d,U+9aef,U+9ca2,U+9ccd,U+9cdf,U+9e20,U+9e4c,U+9e6b,U+9f3e"}},{uri:GUe,descriptors:{unicodeRange:"U+4ede,U+4ee1,U+4eeb,U+4fda,U+4ffe,U+5025,U+506c,U+50f3,U+5106,U+520d,U+525c,U+52ad,U+530d,U+5310,U+539d,U+53a9,U+53fc,U+5421,U+5477,U+54e7,U+551b,U+5530,U+557e,U+5599,U+55c4,U+55d1,U+55d4,U+55df,U+55e4,U+55ea,U+5623,U+562d,U+5654,U+56eb,U+56f5,U+57a7,U+57d5,U+57dd,U+584d,U+5880,U+58ec,U+59dd,U+5a32,U+5a55,U+5a75,U+5b51,U+5b71,U+5b73,U+5cd2,U+5ce4,U+5e5b,U+5e96,U+5fd2,U+607b,U+61d1,U+634b,U+636d,U+63b3,U+63ff,U+64c0,U+661d,U+6657,U+66dc,U+67a5,U+6841,U+6867,U+6901,U+699b,U+6a47,U+6b46,U+6c21,U+6c24,U+6c35,U+6c4a,U+6c94,U+6ca3,U+6d39,U+6d63,U+6d6f,U+6d94,U+705e,U+71e7,U+726f,U+72cd,U+72de,U+72f0,U+7325,U+7350,U+7391,U+741a,U+757f,U+7583,U+75b1,U+75b4,U+75b8,U+75c2,U+75f1,U+766f,U+7699,U+7751,U+789c,U+7a17,U+7be6,U+7cb2,U+7ea3,U+7eb0,U+7ebe,U+7eeb,U+7f25,U+7f2c,U+7fb8,U+8026,U+8037,U+8153,U+8171,U+8191,U+8214,U+821b,U+8222,U+826e,U+82eb,U+830c,U+8314,U+8334,U+83d6,U+8418,U+843c,U+84ff,U+8564,U+8572,U+8616,U+866c,U+8693,U+86a3,U+86a7,U+86af,U+86b6,U+86c6,U+86ca,U+8708,U+870d,U+8759,U+8760,U+87af,U+87c6,U+8869,U+88c6,U+89d0,U+8b07,U+8baa-8bab,U+8bc2,U+8be4,U+8bf0,U+8c2a,U+8c62,U+8c89,U+8d49,U+8d6d,U+8d84,U+8d94,U+8db8,U+8dc6,U+8e2e,U+8e3d,U+8e47,U+8e7f,U+9005,U+9051,U+907d,U+9082,U+9088,U+90b0,U+90d3,U+9150,U+949c,U+94a4,U+94b9,U+94cb,U+94e0,U+9509,U+9512,U+951f,U+9534,U+9552-9553,U+965f,U+96b0,U+9791,U+9889,U+9990,U+9a9c,U+9aa7,U+9c88,U+9cb2-9cb3,U+9cb6-9cb7,U+9cc5,U+9cdc,U+9e22,U+9e2a,U+9e57,U+9e67,U+9e73,U+9e82,U+9eb8,U+9ee0,U+9f9b"}},{uri:XUe,descriptors:{unicodeRange:"U+4eb5,U+4f09,U+4f5a,U+4f8f,U+4fce,U+4fdf,U+4fea,U+4ff3,U+500c,U+500f,U+504e,U+5088,U+52be,U+5420,U+5457,U+5499,U+549b,U+54c6,U+54d2,U+558b,U+559f,U+55bd,U+55d6,U+565c,U+567c,U+568e,U+5768,U+577b,U+57a9,U+57ed,U+59f9,U+5a11,U+5a40,U+5ae6,U+5b6a,U+5b93,U+5bb8,U+5c15,U+5c99,U+5c9c,U+5cc1,U+5d2e,U+5d4b,U+5d99,U+5e54,U+5e61,U+5fcf-5fd1,U+6002,U+6006,U+6014,U+60af,U+60c6,U+60da,U+60f4,U+621f,U+62c8,U+631b,U+631e,U+63e9,U+64b5,U+655d,U+6619,U+6635,U+6641,U+67ad,U+67b0,U+67b7,U+67e9,U+684e,U+688f,U+695d,U+696b,U+69b7,U+6a58,U+6c26,U+6d35,U+6d43,U+6d9e,U+6dd9,U+6dec,U+6e11,U+6e6e,U+6e9f,U+6ec2,U+6ee2,U+6ef9,U+6f09,U+6f66,U+6f8d,U+6fc2,U+6fc9,U+729f,U+72c8,U+73de,U+7430,U+7566,U+7579,U+75c9,U+75e2,U+75fc,U+762a,U+7638,U+7678,U+76c2,U+76f9,U+778c,U+77cd,U+77dc,U+7800,U+781d,U+782d,U+783b-783c,U+78a3,U+78ec,U+7980,U+7a23,U+7b95,U+7bdd,U+7c0c,U+7c41,U+7c91,U+7cb3,U+7cc5,U+7ecc,U+7f19,U+7fca,U+8006,U+8069,U+807f,U+80bd,U+80ed,U+814b,U+8198,U+82cb,U+82d2,U+834f,U+8360,U+847a,U+84d6,U+84e5,U+8537,U+85d0,U+8671,U+86a4,U+86ce,U+86f9,U+8703,U+8707,U+8737,U+873b,U+8815,U+8936,U+8bc3,U+8bcf,U+8bd2,U+8bd8,U+8be9,U+8c0c,U+8c0f,U+8c4c,U+8d45,U+8d5d,U+8d73,U+8e31,U+8e6d,U+8e76,U+8fe4,U+9041,U+90d7,U+9169,U+92ae,U+94a1,U+94c4,U+94c9,U+94db,U+94e7,U+9503,U+9506,U+9517,U+9528,U+9537,U+9542,U+9549,U+95fe,U+9616,U+961a,U+96c9,U+96f3,U+9701,U+970e,U+9739,U+9753,U+9798,U+98d2-98d3,U+98d9-98da,U+9968,U+996f,U+9984,U+9997,U+9acb,U+9b03,U+9c85,U+9ca8,U+9cab,U+9e49,U+9e51,U+9e66,U+9f10"}},{uri:jUe,descriptors:{unicodeRange:"U+4e15,U+4e1e,U+4e2b,U+4eb3,U+4ec9,U+4f0e,U+4f64,U+501c,U+50a9,U+510b,U+51a2,U+51bc,U+527d,U+52d0,U+53fd,U+5429,U+542e,U+5486,U+54af,U+5506,U+5511,U+5522,U+552c,U+556c,U+55b3,U+55d2,U+55e6,U+55fd,U+561f,U+5639,U+5659,U+5662,U+5693,U+572a,U+5892,U+598a,U+5992,U+59a9,U+5a20,U+5ae3,U+5b17,U+5b7d,U+5d34,U+5d3d,U+5d4a,U+5d82,U+5e1a-5e1b,U+5ea5,U+5f0b,U+5f77,U+5fd6,U+5fff,U+6026,U+6035,U+6063,U+60b4,U+60bb,U+60ee,U+612b,U+6194,U+61ca,U+61e6,U+61f5,U+620a,U+6248,U+62a1,U+62d7,U+6376,U+637b,U+652b,U+65bc,U+65cc,U+65ce,U+65d6,U+664c,U+665f,U+6666,U+6684,U+66b9,U+6773,U+6777,U+6787,U+67de,U+6845,U+693d,U+6994,U+6a35,U+6d54,U+6d5c,U+6d8e,U+6dd6,U+6eb4,U+6f2a,U+6f78,U+704f,U+70ec,U+7118,U+714a,U+7172,U+71b9,U+724d,U+728a,U+7337,U+733e,U+7396,U+73b7,U+73cf,U+7428,U+742c,U+742e,U+74ee,U+74f4,U+7525,U+753a,U+7572,U+75d4,U+765c,U+768e,U+7762,U+777d,U+77fd,U+7825,U+7837,U+78b4,U+795f,U+79ed,U+7a1e,U+7b06,U+7b20,U+7ba9,U+7bab,U+7c7c,U+7cbd,U+7cdc,U+7ec9,U+7ef6,U+7f30,U+7f42,U+7f44,U+7f54,U+7f94,U+8004,U+800b,U+8019,U+809b,U+80ae,U+80c4,U+80f1,U+8146,U+816e,U+817c,U+81c0,U+81fc,U+81fe,U+822b,U+830f,U+832f,U+8340,U+8365,U+8385,U+8392,U+83a0,U+8424,U+84af,U+869c,U+8713,U+8717-8718,U+87c0,U+87cb,U+87fe,U+8821,U+8902,U+89d1,U+8bb9,U+8c12,U+8d32,U+8d53,U+8df7,U+8e7c,U+8f7c,U+8f95,U+8fab,U+9052,U+905b,U+9095,U+909d,U+90c5,U+911e,U+9122,U+916a,U+919b,U+948e,U+9492,U+949a,U+94b5,U+94bc,U+94c6,U+94f1,U+9502,U+9511,U+9536,U+956f-9570,U+9602,U+9621,U+9631,U+998b,U+99a5,U+9a81,U+9a9e,U+9ebe,U+9f8b"}},{uri:YUe,descriptors:{unicodeRange:"U+4f2b,U+4f3d,U+4fac,U+5043,U+5055,U+5140,U+5156,U+51cb,U+5243,U+531d,U+536f,U+53a5,U+53ae,U+53f1,U+541d,U+5431,U+547b,U+5492,U+5494,U+54a4,U+54aa,U+54ce,U+54fd,U+5509,U+5520,U+553e,U+557b,U+55c5,U+55e1,U+55f7,U+5608,U+5636,U+563b,U+5773,U+57a0,U+5811,U+587e,U+58d5,U+59e3,U+5a29,U+5a6a,U+5a76,U+5a7a,U+5ac9,U+5b62,U+5b95,U+5c49,U+5c8c,U+5cab,U+5cb7,U+5d02,U+5d58,U+5e44,U+5e7a,U+5eff,U+5f29,U+5f89,U+5f9c,U+5fa8,U+6005,U+6043,U+60b8,U+60d8,U+60ec,U+60f0,U+6115,U+618e,U+630e,U+637a,U+6390,U+63ac,U+63b0,U+64de,U+6525,U+6538,U+65ee-65ef,U+6631,U+6636,U+6654,U+677c,U+67b8,U+67d8,U+683e,U+6886,U+68b5,U+692d,U+6963,U+6979,U+6988,U+6b59,U+6b9a,U+6c69,U+6c74,U+6cae,U+6ce0,U+6cef,U+6d95,U+6dc5,U+6dde,U+6de6,U+6dfc,U+6ea7,U+6f15,U+6f29,U+7096,U+70c3,U+7131,U+715c,U+7166,U+7266,U+7317,U+731d,U+7329,U+73e9,U+7425,U+7455,U+7490,U+74ef,U+7519,U+75b5,U+75b9,U+75de,U+7656,U+7663,U+7691,U+7729,U+77fe,U+783e,U+787c,U+795a,U+7a79,U+7abf,U+7b3a,U+7b4f,U+7b60,U+7b75,U+7b8d,U+7bb4,U+7bd3,U+7be1,U+7cbc,U+7edb,U+7f1c,U+7f8c,U+7fb2,U+7fb9,U+7fce,U+7ff1,U+810d,U+81c6,U+82a5,U+82aa,U+82de,U+8317,U+8343,U+835e,U+8364,U+836a,U+853a,U+8543,U+854a,U+8559,U+8568,U+85b0,U+85b9,U+864f,U+86e4,U+8715,U+8845,U+8884,U+88e8,U+88f1,U+8983,U+8be1,U+8c1f,U+8c27,U+8c5a,U+8c82,U+8d58,U+8dbe,U+8f98,U+9035,U+9074,U+90a1,U+9149,U+9157,U+93d6,U+949d,U+94c2,U+94e3-94e4,U+95eb,U+95f0,U+9611,U+9619,U+9642,U+968d,U+9706,U+970f,U+97ed,U+988a,U+9893,U+98e8,U+9a77,U+9a87,U+9aa1,U+9abc,U+9cdd,U+9e2f,U+9e33,U+9e44,U+9e5c,U+9e9d,U+9edd"}},{uri:WUe,descriptors:{unicodeRange:"U+4f58,U+4f6c,U+4f70,U+4fd0,U+5014,U+51bd,U+524c,U+5315,U+5323,U+535e,U+540f,U+542d,U+545b,U+548e,U+549a,U+54ab,U+54fc,U+5567,U+556a,U+5600,U+5618,U+563f,U+5669,U+56f1,U+56ff,U+573b,U+574d,U+579b,U+57b8,U+57c2,U+586c,U+58f9,U+595a,U+598d,U+5993,U+5996,U+59d7,U+5b7a,U+5ba6,U+5c4e,U+5c96,U+5ce5,U+5eb6,U+5f08,U+5f99,U+602f,U+6059,U+606c,U+607a,U+60ed,U+61a9,U+620c,U+6249,U+62a8,U+62c4,U+62ed,U+62fd,U+6342,U+6345,U+6396,U+63a3,U+6402,U+6413,U+642a,U+6487,U+64a9,U+64ac,U+64ae,U+64b7,U+659f,U+65a1,U+667e,U+66f3,U+67e0,U+69db,U+69df,U+6aac,U+6b86,U+6c50,U+6c5e,U+6c76,U+6c85,U+6c8c,U+6cde,U+6d19,U+6d52,U+6da7,U+6db8,U+6e1a,U+6e25,U+6e4d,U+6e5f,U+6ec1,U+6f31,U+6f7a,U+6fa7,U+6fe1,U+701b,U+70ab,U+70f7,U+717d,U+71a8,U+7252,U+72c4,U+72e1,U+7315,U+736d,U+73ae,U+73c0,U+73c2,U+740f,U+75a4,U+7600-7601,U+768b,U+76bf,U+76d4,U+7728,U+772f,U+776c,U+77a0,U+77b0,U+77f8,U+783a,U+78d0,U+78fa,U+7977,U+7a37,U+7a92,U+7afa,U+7b71,U+7b94,U+7cef,U+7f28,U+7fe1,U+808b,U+80e5,U+80eb,U+8110,U+8113,U+812f,U+814c,U+81c3,U+8235,U+82d4,U+8309,U+83c1,U+8431,U+8469,U+84bf,U+84d3,U+84df,U+84e6,U+8511,U+8638,U+86c0,U+86db,U+86fe,U+8757,U+8822,U+8882,U+8885,U+8892,U+88f3,U+892a,U+8ba5,U+8bd9,U+8be0,U+8be7,U+8bfd,U+8c1a,U+8d4a,U+8d4e,U+8d66,U+8dda,U+8e0c,U+8e52,U+8e74,U+8e87,U+8f76,U+8fc2,U+8fe6,U+900d,U+9068,U+90ac,U+90b3,U+90b8,U+90e7,U+9119,U+9131,U+915a,U+916e,U+94b4,U+94d0,U+94e2,U+94ec,U+94ff,U+9522,U+9535,U+9556,U+965b,U+96f9,U+9774,U+9981,U+998d,U+998f,U+9a6e,U+9a7f,U+9a8a,U+9b13,U+9c9f,U+9e3e,U+9e43,U+9e6d,U+9e8b,U+9e92,U+9edb,U+9eef"}},{uri:KUe,descriptors:{unicodeRange:"U+4e10,U+4e56,U+4e98,U+4ec3,U+4f3a,U+4f5f,U+4f88,U+4f97,U+4fa5,U+4fe8,U+504c,U+5197,U+52fa,U+5364,U+53e8,U+5406,U+543c,U+545c,U+5471,U+5480,U+5495,U+54b3,U+54df,U+54e6,U+54ee,U+557c,U+5583,U+55dc,U+55e3,U+566c,U+592f,U+5944,U+5983,U+59ca,U+59e5,U+5a13,U+5a7f,U+5b09,U+5bd0,U+5e4c,U+5eb5,U+5f1b,U+5f3c,U+608d,U+60cb,U+61a7,U+61ac,U+61cb,U+6233,U+62a0,U+62e7,U+62ee,U+62f4,U+62f7,U+634e,U+6382,U+63c9,U+63ea,U+6400,U+645e,U+6482,U+6556,U+6593,U+6615,U+664f,U+66e6,U+672d,U+675e,U+67da,U+6805,U+6808,U+6868,U+68a2,U+695e,U+69ad,U+6a80,U+6a90,U+6b83,U+6be1,U+6c30,U+6cad,U+6cb1,U+6cf1,U+6d31,U+6d93,U+6dae,U+6dbf,U+6dc6-6dc7,U+6e0d,U+6e32,U+6e3a,U+6e85,U+6eba,U+6f3e,U+6f5e,U+6f7c,U+6fee,U+71ee,U+722a,U+72b7,U+72e9,U+73ba,U+73d1,U+7409,U+7435-7436,U+7459-745a,U+747e,U+7487,U+74e2,U+7504,U+752c-752d,U+7599,U+759f,U+75a1,U+75ca,U+75f0,U+761f,U+7629,U+777f,U+7785,U+77a5,U+77bf,U+78d5,U+7934,U+7940,U+79a7,U+7b19,U+7c38,U+7c95,U+7cb1,U+7ce0,U+7eca,U+7ef7,U+7f2b,U+7f81,U+7fcc,U+8046,U+8148,U+8165,U+819b,U+81ba,U+828b,U+82ae,U+82b7,U+82d3,U+8301,U+830e,U+831c,U+8338,U+837c,U+8393,U+8398,U+83ba,U+83e0,U+83e9,U+853c,U+8654,U+86df,U+8712,U+873f,U+874e,U+8783,U+8859,U+88a4,U+8925,U+8bb7,U+8bff,U+8c19,U+8c1b,U+8c24,U+8c2c,U+8d61,U+8db4,U+8e6c,U+8f8a,U+8fe5,U+8ff8,U+901e,U+90f4,U+912f,U+9163,U+9170,U+91dc,U+949b,U+94a8,U+94b3,U+94c0,U+94e8,U+9525,U+9530,U+9539,U+954c-954d,U+9550,U+955b,U+962a,U+9685,U+96cc,U+9776,U+988d,U+9975,U+9985,U+9a6f,U+9aa5,U+9ab8,U+9c7f,U+9ca4,U+9cb8,U+9e25,U+9e35,U+9e4a"}},{uri:ZUe,descriptors:{unicodeRange:"U+4ea2,U+4ea5,U+4f36,U+4f84,U+4f8d,U+501a,U+5029,U+516e,U+51a5,U+51c4,U+51f8,U+5201,U+527f,U+5321,U+5352,U+5366,U+53e9,U+54c7,U+5632,U+5676,U+56b7,U+56bc,U+56da,U+56e4,U+5703,U+5729,U+5742,U+57a2-57a3,U+5815,U+58d1,U+5919,U+592d,U+5955,U+5a05,U+5a25,U+5a34,U+5b70,U+5b75,U+5bdd,U+5bf0,U+5c41,U+5c79,U+5c91,U+5c94,U+5ce6,U+5ced,U+5d69,U+5dc5,U+5e16,U+5e27,U+5f27,U+5f95,U+5ffb,U+6020,U+604d,U+6055,U+60e6,U+60eb,U+6123,U+618b,U+61a8,U+620d,U+62c7,U+62ce,U+62d9,U+631f,U+634d,U+6452,U+6479,U+64ce,U+64d2,U+655b,U+660a,U+6726,U+67c4,U+6809,U+6853,U+68e3,U+68f1,U+68fa,U+693f,U+6942,U+6995,U+69a8,U+69b4,U+6a71,U+6b89,U+6bcb,U+6bd3,U+6bd9,U+6c40,U+6cf8,U+6cfe,U+6d85,U+6da3,U+6daa,U+6e0e,U+6e43-6e44,U+6f88,U+7078,U+7099,U+70bd,U+70d9,U+70fd,U+7109,U+7184,U+7239,U+733f,U+73f2,U+748b,U+749c,U+749e,U+759a,U+75d2,U+75eb,U+7620,U+766b,U+7693,U+76cf,U+7738,U+773a,U+776b,U+778e,U+77aa,U+7852,U+78be,U+7948,U+795b,U+7960,U+796f,U+79ba,U+7a20,U+7a96,U+7aa5,U+7b03,U+7b28,U+7b50,U+7b77,U+7bc6,U+7bf1,U+7c27,U+7d0a,U+7ead,U+7ec5,U+7ee2,U+7ef0,U+7efd,U+7f0e,U+7f2e,U+7f79,U+7f9a,U+8098,U+80da,U+80e7,U+80f0,U+80f3,U+80fa,U+818a,U+81e7,U+8237-8238,U+8299,U+82b8,U+82ce,U+837b,U+83bd,U+83cf,U+8426,U+8475,U+85c9,U+85d5,U+85dc,U+85e9,U+871a,U+8747,U+8749,U+888d,U+8910,U+891a,U+8bb4,U+8be3,U+8bec,U+8bf2,U+8c06,U+8c0d,U+8d31,U+8d48,U+8de4,U+8e1e,U+8e4a,U+8e66,U+8f84,U+8f97,U+9083,U+90e1,U+9165,U+91c9,U+94b0,U+94f5,U+9504,U+9532,U+956d,U+95f5,U+95fa,U+9668,U+9698,U+96bd,U+9704,U+9773,U+9890,U+996a,U+997a,U+9a74,U+9a8b,U+9cc4,U+9ccc"}},{uri:qUe,descriptors:{unicodeRange:"U+4ea8,U+4f1e,U+4f51,U+4f63,U+4f7c,U+4f83,U+4fa0,U+4fd1,U+4ffa,U+5018,U+5026,U+508d,U+50bb,U+50f5,U+50fb,U+5162,U+5319,U+5320,U+538c,U+5413,U+541f,U+5475,U+54bd,U+54d1,U+5589,U+5598,U+575f,U+57ae,U+57e0,U+5937,U+5974,U+5978,U+59ae,U+5a1f,U+5a49,U+5ab3,U+5b99,U+5b9b,U+5ba0,U+5be1,U+5be5,U+5c09,U+5c27,U+5de2,U+5e9a,U+5f26,U+5f8a,U+5f98,U+6021,U+606d,U+60bc,U+60d5,U+60e7,U+611a,U+614c,U+6254,U+626f,U+6292,U+6296,U+62b9,U+62e2,U+631a,U+631d,U+6320,U+6346,U+63ba,U+6467,U+64bc,U+658b,U+663c,U+6643,U+6652,U+6656,U+6687,U+66d9,U+66dd,U+66f0,U+673d,U+67ab,U+6816-6817,U+68a7,U+68ad,U+68cd,U+68e0,U+6986,U+69fd,U+6b47,U+6bd7,U+6c1f,U+6c2e-6c2f,U+6cbe,U+6de4,U+6e1d,U+6e83,U+6e9c,U+6ed4-6ed5,U+6f4d,U+70f9,U+7130,U+716e,U+718f,U+71ac,U+71e5,U+72fc,U+731c,U+7334,U+73ca,U+7422,U+7426,U+745f,U+7470,U+75af,U+75f4,U+762b,U+763e,U+7696,U+7737,U+7741,U+77a7,U+77bb,U+77ee,U+785d,U+788c,U+78ca,U+7901,U+796d,U+7985,U+79fd,U+7a3c,U+7a57,U+7a74,U+7b5b,U+7caa,U+7cb9,U+7cd5,U+7eac,U+7eb6,U+7ed1,U+7ee5,U+7f20,U+7f2a,U+7f38,U+7f69,U+7fa1,U+8018,U+8038,U+803f,U+804b,U+80a2,U+80be,U+80d6,U+817a,U+81fb,U+820c,U+82ad,U+82af,U+82bd,U+8327,U+8354,U+835f,U+8367,U+836b,U+840c,U+841d,U+8471,U+849c,U+84b2,U+84c9,U+8517,U+851a,U+8549,U+8681,U+8721,U+8776,U+88d9,U+88f9,U+89c5,U+8c1c,U+8c34,U+8d81,U+8d9f,U+8e0a,U+8e72,U+8eb2,U+8fed,U+901b,U+902e,U+906e,U+9091,U+90aa,U+90af,U+915d,U+9171,U+946b,U+9489,U+9499,U+94a5,U+9508,U+9524,U+952d,U+9551,U+9576,U+95f7,U+9600,U+96b6,U+96c0,U+9756,U+97f6,U+98a0,U+98a4,U+997f,U+9a73,U+9a86,U+9ad3,U+9e3d,U+9ed4"}},{uri:tme,descriptors:{unicodeRange:"U+4e4d,U+4e5e,U+4ec7,U+4ed5,U+50da,U+50e7,U+515c,U+51a4,U+51ff,U+5203,U+5254,U+5300,U+533e,U+5375,U+53ee,U+5435,U+543b,U+5455,U+548b,U+548f,U+54d7,U+54fa,U+5578,U+5587,U+55a7,U+560e,U+5760,U+576f,U+5777,U+5830,U+58a9,U+5962,U+59e8,U+5a07,U+5a23,U+5a3c,U+5b5a,U+5bb5,U+5bc5,U+5bde,U+5c7f,U+5cb1,U+5ce8,U+5cea,U+5d29,U+5d4c,U+5e18,U+5f57,U+5f5d,U+5f87,U+5ff1,U+6016,U+601c,U+6064,U+6177,U+61d2,U+625b,U+62e3,U+62f1,U+634f,U+63a0,U+6401,U+6405,U+6495,U+64c2,U+6512,U+6577,U+6590,U+65a7,U+65a9,U+65f7,U+6627,U+6655,U+6714,U+6795,U+67d1,U+67ff,U+68b3,U+68d5,U+68d8,U+6930,U+6960,U+6977,U+69bb,U+69d0,U+6a31,U+6b7c,U+6bb4,U+6c22,U+6c72,U+6c79,U+6c7e,U+6c81,U+6c93,U+6ca5,U+6cbc,U+6ce3,U+6cfb,U+6d3c,U+6da9,U+6df3,U+6e2d,U+6eaf,U+6ec7,U+6f13,U+6f33,U+6f62,U+6fa1,U+7011,U+707c,U+708a,U+70c1,U+70d8,U+70eb,U+711a,U+7194,U+7281,U+7316,U+7357,U+7384,U+7405,U+742a,U+745b,U+7574,U+7578,U+75ea,U+7682,U+7792,U+77d7,U+77e9,U+77eb,U+77f6,U+780c,U+78c5,U+7941,U+79e4,U+7a1a,U+7a9c,U+7ad6,U+7b5d,U+7bf7,U+7c07,U+7c3f,U+7c9f,U+7ca5,U+7cdf,U+7e82,U+7eab,U+7ece,U+7eda,U+7f09,U+7f15,U+7f9e,U+7fdf,U+7fe9,U+803b,U+803d,U+80aa,U+80b4,U+813e,U+8155,U+817b,U+819d,U+821c,U+82b9,U+82df,U+82ef,U+8304,U+83b9,U+8446,U+853d,U+85af,U+85fb,U+8650,U+865e,U+86d9,U+86ee,U+8700,U+8862,U+889c,U+88d4,U+88f8,U+895f,U+8a79,U+8bb3,U+8bb6,U+8bc0,U+8beb,U+8bf5,U+8c23,U+8c79,U+8d1e,U+8dcb,U+8e29,U+8e44,U+8e81,U+8eac,U+8eaf,U+8f8d,U+9050,U+90f8,U+914b,U+948a,U+94be,U+94ee,U+950c,U+9540,U+962e,U+9647,U+9661,U+9699,U+96cf,U+9716,U+9761,U+97a0,U+97e7,U+9a7c,U+9a8f,U+9ae6,U+9cd6,U+9e26"}},{uri:QUe,descriptors:{unicodeRange:"U+4fa3,U+4fae,U+4fd8,U+4fef,U+50a3,U+5189,U+5195,U+51db,U+51f3,U+51f9,U+5220,U+5228,U+5288,U+52ff,U+532e,U+533f,U+5351,U+53db,U+53ed,U+5450,U+5484,U+5490,U+54c9,U+54e9,U+5501,U+5507,U+5543,U+55d3,U+56a3,U+575e,U+589f,U+5984,U+59ec,U+5a04,U+5a36,U+5a77,U+5a9a-5a9b,U+5ab2,U+5ac2,U+5ad6,U+5bc7,U+5c2c,U+5c34,U+5c51,U+5cd9,U+5d0e,U+5deb,U+5e3c,U+5e87,U+5ed3,U+5f13,U+5f64,U+5fe1,U+606a,U+6096,U+60df,U+60f6,U+60f9,U+6151,U+620e,U+6241,U+6252,U+6273,U+627c,U+6289,U+62c2,U+62cc,U+62ef,U+6361,U+6363,U+63b7,U+63e3,U+6518,U+66ae,U+6756,U+6789,U+6813,U+6829,U+6862,U+6866,U+6893,U+6897,U+690e,U+6984,U+69cc,U+6a1f,U+6a44,U+6a59,U+6ba1,U+6c13,U+6c90,U+6ca6,U+6cbd,U+6ccc,U+6cd3,U+6cd7,U+6d4a,U+6d4f,U+6d5a,U+6d9f,U+6da1,U+6dcc,U+6ea5,U+6ee4,U+6ee6,U+6f2f,U+6f8e,U+701a,U+7095,U+709c,U+70af,U+70db,U+70e8,U+714e,U+715e,U+71a0,U+71ce,U+7235,U+7280,U+72d0,U+72f8,U+73ab,U+7410,U+745c,U+7480,U+74a7-74a8,U+74e3,U+75ae,U+75f9,U+76b1,U+76ce,U+7736,U+77e2-77e3,U+781a,U+789f,U+797a,U+79be,U+79c3,U+79c6,U+79f8,U+7a8d,U+7a98,U+7aa6,U+7aff,U+7b1b,U+7cd9,U+7d6e,U+7ede,U+7eee,U+7f00,U+7f24,U+7f2d,U+7fd8,U+800d,U+8116,U+8151,U+81b3,U+8205,U+82c7,U+82db,U+832c,U+8335,U+8339,U+8386,U+846b,U+8587,U+8611,U+8682,U+868a,U+868c,U+8774,U+88d8,U+88f4,U+8912,U+8b6c,U+8bbd,U+8c0e,U+8c41,U+8d26,U+8d3b-8d3c,U+8d50,U+8dea,U+8e35,U+8f99,U+8fe2,U+8fe9,U+9017,U+914c,U+916f,U+9175-9176,U+918b,U+94a0,U+94ae,U+94ce,U+94f2,U+951a,U+952f,U+9541,U+9640,U+9672,U+968b,U+96cd,U+96ef,U+9713,U+97ec,U+9885,U+9992,U+9a6d,U+9a79,U+9a85,U+9cbb,U+9cd7,U+9cde,U+9e93,U+9f9f"}},{uri:JUe,descriptors:{unicodeRange:"U+4e11,U+4ed7,U+4fcf,U+4fe9,U+4fed,U+50ac,U+50b2,U+5112,U+5180,U+5188,U+51f6,U+522e,U+5265,U+52cb,U+52df,U+5349,U+5367,U+5378,U+537f,U+5395,U+5398,U+53d4,U+543e,U+5440,U+5446,U+54b8,U+5565-5566,U+5580,U+55bb,U+56ca,U+572d,U+573e,U+574e,U+5782-5784,U+58f3,U+5938-5939,U+5948,U+594e,U+5a1c,U+5a74,U+5ae9,U+5b55,U+5b5c,U+5bb0,U+5bd3,U+5bf8,U+5c3f,U+5d14,U+5d2d,U+5df7,U+5dfe,U+5e05-5e06,U+5e1c,U+5e62,U+5e7b,U+5e7d,U+5ed6,U+5f2f,U+5f66,U+5f6c,U+5fa1,U+604b,U+609f,U+60a6,U+60e8,U+6101,U+6124,U+6127,U+6148,U+61be,U+6247,U+62d8,U+62da,U+633d,U+635e,U+6367,U+6380,U+638f,U+63a9,U+63fd,U+641c,U+64e6,U+655e,U+6572,U+6591,U+65a5,U+6691,U+6735,U+67a2-67a3,U+67ef,U+680b,U+6876,U+6905,U+6a0a,U+6a61,U+6b79,U+6bb7,U+6bbf,U+6c41,U+6c55,U+6c83,U+6c9b,U+6ca7,U+6cfc,U+6d46,U+6d51,U+6d74,U+6d9d,U+6daf,U+6dc0,U+6deb,U+6e17,U+6e24,U+6e89,U+6ea2,U+6ef4,U+6f6d,U+707f,U+70b3,U+70e4,U+70ef,U+710a,U+722c,U+725f,U+7261,U+72ee,U+72f1,U+730e,U+732b,U+7433,U+7538,U+75bc,U+7624,U+7709,U+7750,U+7779,U+7802,U+7898,U+78a7,U+78b1,U+78cb,U+78f7,U+7984,U+7a83,U+7aed,U+7b3c,U+7b4b,U+7c92,U+7c98,U+7ca4,U+7eb9,U+7ee3,U+7ef3,U+7ef5,U+7f05,U+7f55,U+7f62,U+7fc1,U+7fd4,U+7fe0,U+8042,U+806a,U+80a0,U+80a4,U+80c3,U+8102,U+8106,U+814a,U+8154,U+8247,U+8258,U+82cd,U+8328,U+832b,U+8389,U+83ca,U+845b,U+846c,U+84b8,U+8574,U+859b,U+8680,U+8695,U+86c7,U+8702,U+886c,U+8896,U+88b1,U+88e4,U+8bc8,U+8c10,U+8c26,U+8c28,U+8c2d,U+8d4c,U+8d63,U+8f67,U+8f74,U+8fc4,U+9006,U+9063,U+90a2,U+90b1,U+90c1,U+9177,U+9189,U+9493,U+949e,U+94fe,U+9610,U+961c,U+96a7,U+96fe,U+978d,U+97f5,U+9888,U+997c,U+9a84,U+9b3c,U+9b44-9b45,U+9b54,U+9e64,U+9f0e,U+9f9a"}},{uri:e2e,descriptors:{unicodeRange:"U+4e19,U+4e38,U+4e53,U+4e7e,U+4e9f,U+4ec6,U+4f50,U+4fde,U+502a,U+5154,U+517d,U+51d1,U+51f0,U+5239,U+5256,U+52c9,U+52fe,U+5308,U+532a,U+535c,U+5384,U+53a2,U+53a8,U+53c9,U+53e0,U+5496,U+54ac,U+54c0,U+54c4,U+54e8,U+5561,U+5582,U+561b,U+5631,U+566a,U+5764,U+576a,U+5792,U+57ab,U+584c,U+5885,U+58f6,U+59a8,U+5acc,U+5bc2,U+5c38-5c39,U+5c60,U+5c6f,U+5c82,U+5c90,U+5d16,U+5dcd,U+5e37,U+5e90,U+5eb8,U+5f6a,U+5fcc,U+6012,U+6068,U+6073,U+607c,U+6094,U+6109,U+621a,U+626e,U+6284,U+62d0,U+62e6,U+62fe,U+6321,U+6328,U+632b,U+6349,U+6454,U+65ed,U+660f,U+6674,U+66a8,U+6749,U+674f,U+6760,U+67af,U+6850,U+6854,U+6869,U+68a8,U+68d2,U+68f5,U+6912,U+6b49,U+6b6a,U+6bef,U+6c28,U+6c5d,U+6c82,U+6cab,U+6cb8,U+6cc4,U+6cf5,U+6d47,U+6d78,U+6da4,U+6dc4,U+6dcb,U+6df9,U+6e0a,U+6e23,U+6e5b,U+6eb6,U+6f06,U+6f47,U+6f84,U+6f9c,U+6fd2,U+7076,U+70ac,U+7199,U+723d,U+72ac,U+72ed,U+7476,U+7529,U+752b,U+754f,U+7554,U+75d5,U+7626,U+76ef,U+7720,U+7766,U+7784,U+77ac,U+780d,U+7838,U+7845,U+786b,U+78b3,U+7978,U+79b9,U+79c9,U+79e7,U+7a3d,U+7a84,U+7a9f,U+7b0b,U+7b52,U+7c7d,U+7f1a,U+7fc5,U+7ff0,U+804a,U+8086-8087,U+808c,U+809a,U+80ba,U+810a,U+8180,U+818f,U+81c2,U+81ed,U+8231,U+8292,U+829c,U+82a6,U+82d1,U+8346,U+838e,U+839e,U+83c7,U+83f1,U+8403,U+840e,U+8513,U+857e,U+85e4,U+867e,U+871c,U+87ba,U+87f9,U+884d,U+8944,U+8a93,U+8c05,U+8d2c,U+8d2e,U+8d42-8d43,U+8dfb,U+8e22,U+8eba,U+8f69,U+8f9c,U+8fa3,U+8fa8,U+8fb1,U+900a,U+9038,U+903b,U+9042,U+904f,U+90b5,U+90dd,U+9102,U+9187,U+94a7,U+94c5,U+9523,U+95f8,U+95fd,U+960e,U+964b-964c,U+96c1,U+9709,U+971c,U+97ad,U+9882,U+9965,U+9976,U+9988,U+99a8,U+9a82,U+9a9a,U+9b41,U+9c8d,U+9e45,U+9e70,U+9e9f,U+9f3b,U+9f7f"}},{uri:t2e,descriptors:{unicodeRange:"U+4e08,U+4e18,U+4e1b,U+4e22,U+4e27,U+4e32,U+4e52,U+4e73,U+4ead,U+4ed4,U+4ed9,U+4ef0,U+4fa6,U+5076,U+5179,U+51bb,U+51c9,U+51ef,U+51fd,U+524a,U+526a,U+529d,U+52ab,U+5306,U+5339,U+53d9,U+540a,U+5410,U+541e,U+5439,U+54b1,U+54ed,U+5564,U+558a,U+55b7,U+5634,U+574a,U+5751,U+57a6,U+57cb,U+57d4,U+5824,U+582a,U+5835,U+5858,U+5893,U+58e4,U+5951,U+5986,U+59da,U+59fb,U+59ff,U+5a03,U+5a46,U+5ac1,U+5b5d,U+5bfa,U+5c18,U+5c3a,U+5c48,U+5c4f,U+5c61,U+5cb3,U+5d1b,U+5e15,U+5e3d,U+5e99,U+5e9e,U+5eca,U+5f0a,U+5f17-5f18,U+5f25,U+5f7c,U+5fcd,U+6028,U+60a0,U+60ac,U+60d1,U+614e,U+6155,U+6168,U+61c8,U+6208,U+6212,U+6251,U+629a-629b,U+62ab-62ac,U+62fc,U+6323,U+632a,U+63d2,U+643a,U+6491-6492,U+649e,U+64b0,U+64c5,U+659c,U+6614,U+662d,U+6664,U+6670,U+6676,U+6746,U+67cf,U+67d4,U+682a,U+6843,U+6846,U+68da,U+6b3a,U+6b67,U+6c27,U+6c5b,U+6c64,U+6c70,U+6caa,U+6cca,U+6ce1,U+6d12,U+6d45,U+6dd1,U+6dd8,U+6e34,U+6e7f,U+6ee5,U+6f02,U+7092,U+70c2,U+70e6,U+7115,U+7237,U+7272,U+727a,U+72c2,U+739b,U+73b2,U+743c,U+751c,U+758f,U+75b2,U+7686,U+76c6,U+76d2,U+76fc,U+775b,U+77a9,U+7816,U+788e,U+7897,U+78b0,U+79bd,U+7a0d,U+7a91,U+7a9d,U+7ae3,U+7bad,U+7cca,U+7d2b,U+7eb1,U+7f06,U+7f14,U+7f1d,U+7f50,U+7ffc,U+8036,U+80bf,U+80c1,U+80ce,U+80f8,U+8109,U+810f,U+8170,U+8179,U+819c,U+821f,U+8230,U+8236,U+8273,U+829d,U+82f9,U+8305,U+8350,U+83b2,U+83cc,U+8404,U+840d,U+8427,U+8482,U+8679,U+8854,U+886b,U+8bbc,U+8be6,U+8c31,U+8c6b,U+8d4b,U+8dcc,U+8e2a,U+8e48,U+8f90,U+8fb0,U+9022,U+903c,U+903e,U+9065,U+916c,U+917f,U+94a9,U+94c3,U+94dd,U+94ed,U+9510,U+953b,U+96c7,U+970d,U+9738,U+9877,U+987d,U+989c,U+98d8,U+9a70,U+9a91,U+9aa4,U+9b42,U+9b4f,U+9e2d,U+9e3f,U+9e7f,U+9f20"}},{uri:J0e,descriptors:{unicodeRange:"U+4e59,U+4ed3,U+4f0f,U+4f38,U+4f69,U+4fa7,U+4faf,U+4ff1,U+5077,U+5085,U+5144,U+5151,U+51af,U+51b6,U+51cc,U+523a,U+5251,U+5269,U+5272,U+52d8,U+5353,U+5389,U+53f9,U+5401,U+5415,U+541b,U+54f2,U+5524,U+554a,U+559d,U+5609,U+5740,U+575d,U+5806,U+5821,U+586b,U+5915,U+594f,U+5960,U+5999,U+59a5,U+59b9,U+59c6,U+59d1,U+59dc,U+5b5f,U+5b64,U+5b87,U+5bb4,U+5bbf,U+5c16,U+5c1d,U+5c3e,U+5c9a,U+5ca9,U+5cad,U+5cfb,U+5de1,U+5de7,U+5de9,U+5ef7,U+5f04,U+5f70,U+5f79,U+5fc6,U+602a,U+6050,U+6052,U+6070,U+6084,U+60b2,U+60dc,U+60e9,U+6167,U+6170,U+61c2,U+6270,U+6291,U+62b1,U+62bc,U+62dc,U+62df,U+62f3,U+6324,U+633a,U+6377,U+6398,U+63cf,U+640f,U+642c-642d,U+6458,U+6478,U+6500,U+654c,U+6566,U+658c,U+65c1,U+65cb,U+65e8,U+65ec,U+6696-6697,U+6734,U+679a,U+679d,U+67dc,U+67f3-67f4,U+680f,U+683d,U+684c,U+68af,U+699c,U+6bc1,U+6c0f,U+6c1b,U+6c57,U+6c6a,U+6d3d,U+6d6e,U+6d82,U+6db5,U+6dee,U+6e58,U+6eaa,U+6ecb,U+6ede,U+6ee9,U+6f0f,U+6f20,U+6f58,U+704c,U+7070,U+70b8,U+718a,U+7238,U+7262,U+7275,U+72b9,U+72d7,U+72e0,U+741b,U+7434,U+7483,U+74f6-74f7,U+75ab,U+764c,U+7761,U+7855,U+7891,U+78c1,U+79d2,U+7a00,U+7a3b,U+7c97,U+7ea4,U+7eb2,U+7ed2,U+7eea,U+7ef8,U+7f18,U+7fbd,U+8000,U+8010,U+8096,U+809d,U+80a9,U+817f,U+81e3,U+8206,U+8212,U+82ac,U+8302,U+8361,U+8377,U+83f2,U+8461,U+848b,U+84ec,U+8521,U+85aa,U+8870,U+8877,U+8881,U+888b,U+88ad,U+88c2,U+8986,U+8bd1,U+8bf1,U+8d24,U+8d2a,U+8d3e-8d3f,U+8d41,U+8d56,U+8d64,U+8d6b,U+8e0f,U+8f70,U+8f85,U+8f88,U+8fa9,U+9003,U+901d,U+90b9,U+90ce,U+94a6,U+94f8,U+9505,U+95ea,U+95ef,U+95f2,U+95f9,U+9601,U+9605,U+9634,U+966a,U+9677,U+9690,U+9694,U+96d5,U+971e,U+9896-9897,U+9972,U+9a71,U+9a76,U+9a7e,U+9e1f,U+9e23"}},{uri:n2e,descriptors:{unicodeRange:"U+4e01,U+4e43,U+4ea6,U+4ef2,U+4eff,U+4f26,U+4f2a,U+4f2f,U+4f5b,U+4fa8,U+4fca,U+4fd7,U+5021,U+504f,U+5141,U+51c0,U+51dd,U+51e4,U+51ed,U+5200,U+5237,U+5427,U+5448,U+54a8,U+5706,U+5708,U+5723,U+575b,U+57c3,U+5899,U+58a8,U+58c1,U+5976,U+5988,U+59bb,U+59d0,U+59d3,U+5a18,U+5a31,U+5a92,U+5b54,U+5b85,U+5baa-5bab,U+5bc4,U+5bd2,U+5be8,U+5bff,U+5c65,U+5d07,U+5e1d,U+5e78,U+5e7c,U+5f03,U+5f1f,U+5f39,U+5f6d,U+5f92,U+5faa,U+5fbd,U+5fe7,U+5ffd,U+60a8,U+60ef,U+6108,U+6162,U+622a,U+6234,U+626b,U+626d,U+62c6,U+62d2,U+62d4,U+62d6,U+62e8,U+6316,U+6355,U+63ed,U+6447,U+64a4,U+65f1,U+6606,U+6628,U+664b,U+6668,U+6682,U+66f9,U+66fc,U+66ff,U+6717,U+6740,U+676d,U+67aa,U+67ec,U+67f1,U+6842,U+6851,U+695a,U+6982,U+6a2a,U+6b20,U+6b23,U+6b32,U+6b96,U+6bc5,U+6beb,U+6c60,U+6c9f,U+6cea,U+6cf3,U+6d1e,U+6d53,U+6d66,U+6d69,U+6d8c,U+6d9b,U+6db2,U+6de1,U+6dfb,U+6e14,U+6ed1,U+6eda,U+6ee8,U+6f2b,U+706d,U+7089,U+708e,U+70ad-70ae,U+70e7,U+7126,U+714c,U+71c3,U+71d5,U+7206,U+7259,U+731b,U+73a9,U+73bb,U+74dc,U+7532,U+7545,U+755c,U+75c7,U+7687,U+76d7,U+76f2,U+788d,U+78e8,U+79e6,U+79e9,U+7a3f,U+7a46,U+7a97,U+7af9,U+7bee,U+7c4d,U+7c89,U+7cd6,U+7eb5,U+7ebd,U+7ed8,U+8017,U+8033,U+80c0,U+80de,U+80f6,U+8138,U+817e,U+81a8,U+820d,U+827e,U+82b3,U+82d7,U+83b1,U+84c4,U+84dd,U+8584,U+864e,U+865a,U+866b,U+86cb,U+88d5,U+89e6,U+8bca,U+8bde,U+8bfa,U+8c0a,U+8c37,U+8c46,U+8c6a,U+8c8c,U+8d1d,U+8d29,U+8d4f,U+8d54,U+8d5a,U+8d60,U+8d62,U+8f7f,U+8f96,U+8f9e-8f9f,U+8fc1,U+8fdf,U+8fea,U+8ff7,U+9012,U+906d,U+9075,U+90a6,U+90bb,U+90ca,U+9178,U+9192,U+91ca,U+94bb,U+94dc,U+94fa,U+9501,U+950b,U+9521,U+955c,U+963b,U+9655,U+9675-9676,U+9887,U+9891,U+9971,U+9a97,U+9ece,U+9ed8"}},{uri:i2e,descriptors:{unicodeRange:"U+4e1d,U+4e39,U+4e4c,U+4e4f,U+4e54,U+4e58,U+4e95,U+4ea1,U+4eab,U+4eae,U+4ec1,U+4f10,U+4f19,U+4f30,U+4f34,U+4fb5,U+503e,U+518c,U+5192,U+51a0,U+51ac,U+51b0,U+51e1,U+5211,U+5242,U+52a3,U+52b2,U+52c3,U+52c7,U+52d2,U+52e4,U+5377,U+539a,U+53a6,U+53e5,U+5417,U+5510,U+552f,U+5531,U+574f-5750,U+5761,U+5851,U+5854,U+58ee,U+593a,U+5949,U+5954,U+5a5a,U+5b8b,U+5bbd,U+5c04,U+5c0a,U+5c4b,U+5ce1,U+5cf0,U+5e10,U+5e8a,U+5e9f,U+5ec9,U+5f31,U+5f84,U+5fd8-5fd9,U+5fe0,U+6015,U+6062,U+6069,U+6076,U+6089,U+60a3,U+60ca,U+620f,U+624e,U+6263,U+6298,U+62a2,U+62bd,U+6311,U+6350,U+6389,U+638c,U+63f4,U+6446,U+644a,U+6469,U+64cd,U+654f,U+6562,U+656c,U+65d7,U+65e6,U+65fa,U+660c,U+6653,U+66b4,U+670b,U+672b,U+676f-6770,U+6881,U+6885,U+68a6,U+68cb,U+68ee,U+6b8a,U+6c88-6c89,U+6cc9,U+6ce5,U+6d01,U+6d17,U+6d1b,U+6d59,U+6d6a,U+6da8,U+6df7,U+6e10,U+6e20-6e21,U+6f5c,U+706f,U+70bc,U+719f,U+7267,U+732a,U+73cd,U+7518,U+756a,U+7586,U+7591,U+75db,U+76c8,U+76d0,U+76d6,U+76d8,U+76df,U+76fe,U+77db,U+7801,U+786c,U+795d,U+7965,U+79cb,U+7a77,U+7a7f,U+7aef,U+7b11,U+7bb1,U+7bc7,U+7ea0,U+7eaf,U+7ed5,U+7edc,U+7f13,U+7f29,U+7f34,U+7f8a,U+7ffb,U+8015,U+8058,U+805a,U+8083,U+80af,U+80c6,U+80cc,U+811a,U+8150,U+82e5,U+8336,U+8352,U+83ab,U+8428,U+8463,U+852c,U+8861,U+89c8,U+8bcd,U+8bd7,U+8bda,U+8be2,U+8bef,U+8bf8,U+8c0b,U+8c13,U+8d34,U+8d3a,U+8d74,U+8d76,U+8da3,U+8dd1,U+8ddd,U+8ddf,U+8df3,U+8f68,U+8f6f,U+8f7d,U+8f91,U+8f9b,U+8fbd,U+8fc8,U+8fd4,U+8feb,U+8ff9,U+900f,U+9057,U+907f-9080,U+90d1,U+90ed,U+91ce,U+9519,U+9526,U+95ed,U+9614,U+9635,U+9644,U+9686,U+96c5,U+96ea,U+9707,U+9732,U+9759,U+978b,U+9876,U+9881,U+9910,U+996e,U+9970,U+9c81,U+9e21,U+9ebb,U+9f84"}},{uri:r2e,descriptors:{unicodeRange:"U+4e3d,U+4e4e,U+4e71,U+4e8f,U+4ed8,U+4eea,U+4f0a,U+4f0d,U+4f11,U+4f1f,U+4f24,U+4f3c,U+4f73,U+4fc4,U+500d,U+5012,U+501f,U+503a,U+505c,U+507f,U+50a8,U+514d,U+5178,U+517c,U+51b2,U+51b7,U+520a,U+5238,U+523b,U+52b1,U+535a,U+5371,U+5385,U+53eb-53ec,U+53f3,U+53f6,U+5409,U+542b,U+542f,U+5434,U+5462,U+5473,U+547c,U+54c8,U+54ea,U+56fa,U+5733,U+5757,U+5766,U+5802,U+585e,U+590f,U+591c,U+591f,U+5947,U+594b,U+5987,U+5a01,U+5b59,U+5b63,U+5b88,U+5b97,U+5b9c,U+5bbe,U+5bfb,U+5c01,U+5c1a,U+5c24,U+5c3c,U+5c97,U+5c9b,U+5cb8,U+5de6,U+5e01,U+5e2e,U+5e45,U+5e55,U+5e84,U+5ef6,U+5f02,U+5f52,U+5f69,U+5f7b,U+5f90,U+5fae,U+6000,U+600e,U+6025,U+60e0,U+6276,U+6297,U+62b5,U+62cd,U+62d3,U+62e5,U+62e9,U+62ff,U+6302,U+632f,U+63e1,U+6444,U+64ad,U+653b,U+6551,U+6563,U+65a4,U+65e7,U+6620,U+667a,U+66f2,U+671d,U+6731,U+6742,U+675f,U+6768,U+677e-677f,U+6790,U+67b6,U+67d3,U+6863,U+68b0,U+68c9,U+690d,U+6b8b,U+6bcd,U+6bd2,U+6bd5,U+6c38,U+6c61,U+6cbf,U+6cdb,U+6cf0,U+6d2a,U+6d89,U+6da6,U+6f6e,U+6fb3,U+7075,U+707e,U+70df,U+7164,U+7236,U+725b,U+7389,U+73e0,U+745e,U+74e6,U+751a,U+7537,U+75be,U+76ae,U+76db,U+793c,U+7956,U+7981,U+79d8,U+79df,U+79fb,U+7adf,U+7ae5,U+7b14,U+7b26,U+7b54,U+7b79,U+7d2f,U+7eb8,U+7eba,U+7ec6,U+7ee9,U+7eff,U+7f5a,U+7f6a,U+7f72,U+8089,U+80a5,U+80e1,U+8111,U+8131,U+821e,U+822c,U+8270,U+8499,U+8651,U+867d,U+8840,U+8857,U+8863,U+88c1,U+89c9,U+89d2,U+8a89,U+8bed,U+8bfe,U+8c01,U+8c22,U+8d21,U+8d25,U+8d2f,U+8d5e,U+8d75,U+8d8b,U+8dc3,U+8de8,U+8df5,U+8f6e,U+8f86,U+8f89,U+8fc5,U+8ff0,U+8ffd,U+9014,U+904d,U+90ae,U+9274,U+949f,U+952e,U+969c,U+96c4,U+96e8,U+96f6-96f7,U+97e9,U+987f,U+996d,U+9a7b,U+9aa8,U+9c7c,U+9c9c,U+9e4f,U+9f13,U+9f50"}},{uri:o2e,descriptors:{unicodeRange:"U+4e13,U+4e16,U+4e1c,U+4e24,U+4e3e,U+4e49,U+4e61,U+4e66,U+4e89,U+4e8c,U+4e94,U+4e9b,U+4ea4,U+4eac,U+4ebf,U+4eca,U+4ef6-4ef7,U+4efb,U+4f18,U+4f20,U+4f46,U+4f7f,U+4fe1,U+503c,U+505a,U+5146,U+5148,U+515a,U+5171,U+5177,U+519b,U+51b3,U+51c6,U+51e0,U+5212,U+521b,U+522b,U+529e,U+52bf,U+534e-534f,U+5355,U+5357,U+5382,U+539f,U+53bb,U+53bf,U+53c2,U+53c8,U+53ca,U+53d6-53d8,U+53e3,U+53ea,U+53f0,U+540d,U+5411,U+56db,U+56de,U+56e0,U+56e2,U+578b,U+57ce,U+57fa,U+589e,U+5904,U+5934,U+5982,U+5b89,U+5b8c,U+5bfc,U+5c06,U+5c11,U+5c40,U+5c71,U+5e38,U+5e72,U+5e76,U+5e7f,U+5e94,U+5e9c,U+5f0f,U+5f15,U+5f20,U+5f3a,U+5f62,U+5f88,U+5fc5,U+5fd7,U+5feb,U+601d,U+6027,U+60c5,U+60f3,U+610f,U+6216,U+6218,U+624b,U+624d,U+6279,U+628a,U+6295,U+6301,U+6307,U+636e,U+63a5,U+63a8,U+652f,U+6536,U+653e,U+6548,U+6559,U+6570,U+65bd,U+65e0,U+6602,U+660e,U+6613,U+66f4,U+6700,U+670d,U+671f,U+672f,U+6743,U+674e,U+6751,U+6761,U+6784,U+6797,U+679c,U+67e5,U+6807,U+6837,U+683c,U+6b21,U+6b63-6b65,U+6bcf,U+6bd4,U+6c42,U+6c5f,U+6ca1,U+6cbb,U+6d3b,U+6d41,U+6d88,U+6df1,U+70b9,U+7136,U+7269,U+7279,U+7531,U+754c,U+767e,U+76ca,U+76f8,U+770b,U+7740,U+7814,U+79ef,U+7a0b,U+7a0e,U+7a76,U+7b80,U+7cbe,U+7cfb,U+7e41,U+7ea7,U+7ec4,U+7ec7,U+7ed3,U+7ed9,U+7edf,U+7f8e,U+8001,U+804c,U+8054,U+80b2,U+81f3,U+8425,U+8868,U+88ab,U+897f,U+89c1-89c2,U+89c4,U+89c6,U+89e3,U+8ba1,U+8ba4,U+8bae,U+8bb0,U+8bba,U+8bc1,U+8c03,U+8d28,U+8d39,U+8def,U+8f66,U+8f6c,U+8fd0-8fd1,U+9020,U+9053,U+90a3,U+90fd,U+91cc,U+9500,U+9547,U+95e8,U+95f4,U+961f,U+9645,U+9662,U+96be,U+96c6,U+9700,U+9769,U+97e6,U+9875,U+9879,U+9886,U+9898,U+98ce,U+9996,U+2b5af,U+2cc56,U+2e9f5,U+30edd-30ede"}},{uri:a2e,descriptors:{unicodeRange:"U+4e03,U+4e30,U+4e34,U+4e45,U+4e60,U+4e70,U+4e88,U+4e91-4e92,U+4ea9,U+4eb2,U+4ec0,U+4ecb,U+4ecd,U+4ee4,U+4fee,U+5019,U+5047,U+50cf,U+5145,U+516d,U+5170,U+5175,U+5199,U+51cf,U+51fb,U+521a,U+5224,U+5267,U+52aa,U+5347-5348,U+534a,U+5356,U+5361,U+536b,U+5370,U+538b,U+53e4,U+53e6,U+5403,U+5426,U+5428,U+542c,U+5438,U+5668,U+56ed,U+56f4,U+56fe,U+57df,U+592a,U+5957,U+5b69,U+5b81,U+5b8f,U+5b98,U+5b9d,U+5ba1,U+5ba4,U+5bb3,U+5bc6,U+5bdf,U+5c3d,U+5c5e,U+5c81,U+5ddd,U+5de8,U+5dee,U+5e0c,U+5e86,U+5e8f,U+5e93,U+5e95,U+5e97,U+5ea7,U+5ead,U+5eb7,U+5f55,U+5f81,U+5f85,U+5ff5,U+6001,U+613f,U+6258,U+6267,U+6269,U+626c,U+627e,U+62db,U+62ec,U+6325,U+635f,U+6362,U+6388,U+6392,U+63a2,U+63a7,U+63aa,U+641e,U+6545,U+6597,U+65e2,U+65e9,U+661f,U+665a,U+666e-666f,U+66fe,U+6728,U+67d0,U+6811,U+6838,U+6865,U+697c,U+6b22,U+6b27,U+6b4c,U+6b62,U+6b66,U+6b7b,U+6bdb,U+6c47,U+6c49,U+6c7d,U+6c99,U+6cfd,U+6d0b,U+6d25,U+6d32,U+6d3e,U+6d4b,U+6e29,U+6e56,U+6e7e,U+6f14,U+6fc0,U+706b,U+70c8,U+7247,U+72af,U+72b6,U+72ec,U+732e,U+73ed,U+7403,U+7533,U+753b,U+7559,U+7565,U+7597,U+767b,U+773c,U+7763,U+77ed,U+77ff,U+7968,U+798f,U+79bb,U+79c0-79c1,U+7ad9,U+7ae0,U+7b51,U+7b7e,U+7cae,U+7d22,U+7ea2,U+7eb3,U+7eb7,U+7ec3,U+7ec8,U+7ecd,U+7edd,U+7efc,U+7f16,U+7f3a,U+7f51,U+7f57,U+7f6e,U+80dc,U+822a,U+8239,U+826f,U+82cf,U+82e6,U+8349,U+8363,U+83dc,U+8457,U+85cf,U+878d,U+8865,U+8a00,U+8b66,U+8ba2,U+8ba8,U+8bad,U+8bb2,U+8bc9,U+8bd5,U+8bfb,U+8d2b,U+8d35,U+8d37,U+8f7b,U+8f93,U+8fce,U+8fdd,U+9000-9002,U+9010,U+9047,U+9093,U+9152,U+9488,U+94a2,U+9633,U+9636,U+963f,U+9646,U+9648,U+964d,U+9664,U+9669,U+9760,U+97f3,U+987a,U+987e,U+9884,U+98de,U+9986,U+9ed1"}},{uri:l2e,descriptors:{unicodeRange:"U+4e14,U+4e25,U+4e48,U+4e50,U+4e5d,U+4e9a,U+4ec5,U+4efd,U+4f17,U+4f4e-4f4f,U+4f55,U+4f59,U+4f60,U+4f8b,U+4f9b,U+4f9d,U+4fbf,U+4fc3,U+5065,U+513f,U+5149,U+514b,U+516b,U+5174,U+517b,U+518d,U+51b5,U+5207,U+5217-5219,U+521d,U+526f,U+529f,U+52a9,U+52b3,U+5305,U+533b,U+5343,U+5360,U+5373-5374,U+5386,U+53cb-53cd,U+53f2,U+53f7,U+544a,U+5468,U+547d,U+54cd,U+552e,U+5584,U+56f0,U+571f,U+5747,U+575a,U+57f9,U+5883,U+58eb,U+58f0,U+5907,U+590d,U+592e,U+5931,U+5956,U+5965,U+5973,U+5979,U+59cb,U+5b57-5b58,U+5b83,U+5ba2-5ba3,U+5bb9,U+5bcc,U+5c42,U+5c45,U+5c4a,U+5dde,U+5df1,U+5df4,U+5e03,U+5e08,U+5e26,U+5e2d,U+5f71,U+5f80,U+5f8b,U+5fb7,U+606f,U+611f,U+6237,U+623f,U+6253,U+627f,U+6293,U+62a4,U+62c5,U+62c9,U+6309,U+6574,U+6599,U+65ad,U+65af,U+65c5,U+65cf,U+6625,U+663e,U+671b,U+672a,U+6750,U+6781,U+6821,U+6839,U+6848,U+68c0,U+6a21,U+6b3e,U+6bb5,U+6c14,U+6cb3,U+6cb9,U+6ce8,U+6e05,U+6e2f,U+6e38,U+6e90,U+6ee1,U+70ed,U+7167,U+7231,U+7248,U+724c,U+7387,U+738b,U+73af,U+7530,U+75c5,U+767d,U+76d1,U+76f4,U+771f,U+77e5,U+77f3,U+7834,U+7840,U+786e,U+793a,U+795e,U+79f0,U+7a33,U+7a7a,U+7a81,U+7ade,U+7b56,U+7b97,U+7c73,U+7c7b,U+7d20,U+7d27,U+7ea6,U+7eaa,U+7ebf,U+7ee7,U+7eed,U+7ef4,U+7fa4,U+8003,U+80a1,U+81f4,U+8272,U+827a,U+8282,U+82b1,U+82f1,U+8303,U+836f,U+83b7,U+843d,U+88c5,U+8ba9,U+8baf,U+8bb8,U+8bbf,U+8bc4,U+8bc6,U+8bdd,U+8be5,U+8bf7,U+8c08,U+8c61,U+8d1f,U+8d22-8d23,U+8d27,U+8d2d,U+8d38,U+8d5b,U+8d70,U+8d85,U+8d8a,U+8db3,U+8eab,U+8f83,U+8fb9,U+8fdc,U+8fde,U+9009,U+901f,U+914d,U+91c7,U+94b1,U+94c1,U+94f6,U+95fb,U+9632,U+9650,U+968f,U+9752,U+975e,U+987b,U+989d,U+98df,U+9999,U+9a6c,U+9a8c,U+9ec4,U+9feb-9fec"}},{uri:c2e,descriptors:{unicodeRange:"U+98fb-990c,U+990e-990f,U+9911-992d,U+992f-9953,U+9956-9962,U+9964,U+9966,U+9973,U+9978-9979,U+997b,U+997e,U+9982-9983,U+9989,U+998c,U+998e,U+999a-99a4,U+99a6-99a7,U+99a9-99c8"}},{uri:d2e,descriptors:{unicodeRange:"U+8e4c-8e50,U+8e53-8e58,U+8e5a-8e65,U+8e67-8e68,U+8e6a-8e6b,U+8e6e,U+8e71,U+8e73,U+8e75,U+8e77-8e7b,U+8e7d-8e7e,U+8e80,U+8e82-8e84,U+8e86,U+8e88-8e8e,U+8e91-8e93,U+8e95-8e9b,U+8e9d,U+8e9f-8eaa,U+8ead-8eae,U+8eb0-8eb1,U+8eb3-8eb9,U+8ebb-8ecd,U+8ecf-8f02"}},{uri:u2e,descriptors:{unicodeRange:"U+2e3a,U+3001-3002,U+3008-3011,U+3014-3017,U+301d-301f,U+4dae,U+4e00,U+4e07,U+4e09-4e0b,U+4e0d-4e0e,U+4e1a,U+4e2a,U+4e2d,U+4e3a-4e3b,U+4e4b,U+4e5f,U+4e86,U+4e8b,U+4e8e,U+4ea7,U+4eba,U+4ece,U+4ed1,U+4ed6,U+4ee3,U+4ee5,U+4eec,U+4f01,U+4f1a,U+4f4d,U+4f53,U+4f5c,U+4fdd,U+5143,U+5165,U+5168,U+516c,U+5173,U+5176,U+5185,U+519c,U+51fa,U+5206,U+5229,U+5230,U+5236,U+524d,U+529b,U+52a0-52a1,U+52a8,U+5316-5317,U+533a,U+5341,U+5362,U+53d1,U+53ef,U+53f8,U+5404,U+5408,U+540c,U+540e,U+5458,U+548c,U+54c1,U+54e5,U+5546,U+559c,U+56fd,U+5728,U+5730,U+573a,U+5916,U+591a,U+5927,U+5929,U+592b,U+597d,U+59d4,U+5b50,U+5b66,U+5b9a,U+5b9e,U+5bb6,U+5bf9,U+5c0f,U+5c14,U+5c31,U+5c55,U+5de5,U+5df2,U+5e02,U+5e73-5e74,U+5ea6,U+5efa,U+5f00,U+5f53,U+5f97,U+5fc3,U+603b,U+6210-6211,U+6240,U+6280,U+62a5,U+63d0,U+6539,U+653f,U+6587,U+65b0,U+65b9,U+65e5,U+65f6,U+662f,U+6708-6709,U+672c,U+673a,U+675c,U+6765,U+6c11,U+6c34,U+6cd5,U+6ce2,U+6d4e,U+6d77,U+73b0,U+7406,U+751f,U+7528,U+7535,U+7684,U+76ee,U+793e,U+79cd,U+79d1,U+7acb,U+7b2c,U+7b49,U+7ba1,U+7ecf,U+8005,U+800c,U+80fd,U+81ea,U+884c,U+8981,U+8bbe,U+8bf4,U+8d44,U+8d77,U+8fbe,U+8fc7,U+8fd8-8fd9,U+8fdb,U+901a,U+90e8,U+91cd,U+91cf,U+91d1,U+9485,U+957f,U+95ee,U+9762,U+9ad8,U+9ea6,U+9f99,U+9fcf,U+9fd4,U+9fed,U+fe10-fe19,U+fe30-fe31,U+fe33-fe44,U+ff01,U+ff0c,U+ff1f,U+2b4e7,U+2b7f7,U+2b7fc,U+2cb2d,U+2cb3b,U+2cb4a,U+2cb5b,U+2cb73"}},{uri:f2e,descriptors:{unicodeRange:"U+6490,U+6493-6494,U+6497-6498,U+649a-649d,U+649f-64a3,U+64a5-64a8,U+64aa-64ab,U+64af,U+64b1-64b4,U+64b6,U+64b9,U+64bb,U+64bd-64bf,U+64c1,U+64c3-64c4,U+64c6-64cc,U+64cf,U+64d1,U+64d3-64d6,U+64d9-64dd,U+64df-64e1,U+64e3,U+64e5,U+64e7-64ff,U+6501-6508,U+650a-6511,U+6513-6517,U+6519-6524,U+6526-652a,U+652c-652d,U+6530-6533,U+6537,U+653a,U+653c-653d,U+6540-6544,U+6546-6547,U+654a-654b,U+654d-654e,U+6550,U+6552-6554,U+6557-6558,U+655a,U+655c,U+655f-6561,U+6564-6565,U+6567-6568"}},{uri:h2e,descriptors:{unicodeRange:"U+9695-9696,U+969a-969b,U+969d-96a6,U+96a8-96af,U+96b1-96b2,U+96b4-96b5,U+96b7-96b8,U+96ba-96bb,U+96bf,U+96c2-96c3,U+96c8,U+96ca-96cb,U+96d0-96d1,U+96d3-96d4,U+96d6-96df,U+96e1-96e7,U+96eb-96ee,U+96f0-96f2,U+96f4-96f5,U+96f8,U+96fa-96fd,U+96ff,U+9702-9703,U+9705,U+970a-970c,U+9710-9712,U+9714-9715,U+9717-971b,U+971d,U+971f-9729,U+972b-972c,U+972e-972f,U+9731,U+9733-9737,U+973a-973d,U+973f-9751,U+9754-9755,U+9757-9758,U+975a,U+975c-975d,U+975f,U+9763-9764,U+9766-9768,U+976a-9770"}},{uri:g2e,descriptors:{unicodeRange:"U+6af0-6b1f,U+6b25-6b26,U+6b28-6b31,U+6b33-6b36,U+6b38,U+6b3b-6b3d,U+6b3f-6b42,U+6b44-6b45,U+6b48,U+6b4a-6b4b,U+6b4d-6b58,U+6b5a-6b61,U+6b68-6b69,U+6b6b-6b78,U+6b7a,U+6b7d-6b80,U+6b85,U+6b88,U+6b8c,U+6b8e-6b91,U+6b94-6b95,U+6b97-6b99,U+6b9c-6ba0,U+6ba2-6ba9,U+6bab-6bb2,U+6bb6,U+6bb8-6bba"}},{uri:m2e,descriptors:{unicodeRange:"U+430e-439a,U+29e8a,U+29ec4,U+29edb,U+29ee9,U+29f7e,U+29f83,U+29f8c,U+29fce,U+2a01a,U+2a02f,U+2a082,U+2a0f9,U+2a190,U+2a38c"}},{uri:p2e,descriptors:{unicodeRange:"U+92ef-933d,U+933f-9369,U+936b-9388"}},{uri:U2e,descriptors:{unicodeRange:"U+4512-458d,U+2b300,U+2b363,U+2b36f,U+2b372,U+2b37d,U+2b404,U+2b410,U+2b413,U+2b461,U+2b4ef,U+2b4f6,U+2b4f9,U+2b50d-2b50e,U+2b536,U+2b5ae,U+2b5b3,U+2b5e7,U+2b5f4,U+2b61c-2b61d,U+2b626-2b628,U+2b62a,U+2b62c,U+2b695-2b696,U+2b6ad,U+2b6ed"}},{uri:b2e,descriptors:{unicodeRange:"U+88bd-88c0,U+88c3-88c4,U+88c7-88c8,U+88ca-88cd,U+88cf-88d1,U+88d3,U+88d6-88d7,U+88da-88de,U+88e0-88e1,U+88e6-88e7,U+88e9-88ef,U+88f2,U+88f5-88f7,U+88fa-88fb,U+88fd,U+88ff-8901,U+8903-8909,U+890b-890f,U+8911,U+8914-8918,U+891c-8920,U+8922-8924,U+8926-8929,U+892c-892f,U+8931-8933,U+8935,U+8937-8940,U+8942-8943,U+8945-895d,U+8960-8965,U+8967-897a,U+897c-897e,U+8980,U+8982,U+8984-8985"}},{uri:nme,descriptors:{unicodeRange:"U+4b0b-4ba0"}},{uri:y2e,descriptors:{unicodeRange:"U+7179,U+717b-717c,U+717e-7183,U+7185-7189,U+718b-718e,U+7190-7193,U+7195-7197,U+719a-719e,U+71a1-71a7,U+71a9-71ab,U+71ad-71b2,U+71b4,U+71b6-71b8,U+71ba-71c2,U+71c4-71cd,U+71cf-71d3,U+71d6-71df,U+71e1-71e4,U+71e6,U+71e8-71ed,U+71ef-71f8,U+71fa-7205,U+7207-721c,U+721e-7227,U+7229,U+722b,U+722d"}},{uri:E2e,descriptors:{unicodeRange:"U+982e-9874,U+988b,U+988e,U+9892,U+9895,U+9899,U+98a3,U+98a8-98cd,U+98cf-98d0,U+98d4,U+98d6-98d7,U+98db-98dd,U+98e0-98e6,U+98e9-98fa"}},{uri:v2e,descriptors:{unicodeRange:"U+7c14-7c15,U+7c17-7c1e,U+7c20-7c25,U+7c28-7c29,U+7c2b-7c37,U+7c39-7c3e,U+7c42-7c4c,U+7c4e-7c72,U+7c75-7c7a,U+7c7e-7c88,U+7c8a-7c90,U+7c93-7c94,U+7c96,U+7c99-7c9b,U+7ca0-7ca1,U+7ca3,U+7ca6-7ca9,U+7cab-7cad,U+7caf-7cb0,U+7cb4-7cb8,U+7cba-7cbb,U+7cbf-7cc0,U+7cc2-7cc4,U+7cc6,U+7cc9,U+7ccb,U+7cce-7cd4"}},{uri:w2e,descriptors:{unicodeRange:"U+7d95-7da5,U+7da7-7dad,U+7daf-7e2a"}},{uri:_2e,descriptors:{unicodeRange:"U+4a78-4b0a"}},{uri:T2e,descriptors:{unicodeRange:"U+9b30-9b31,U+9b33-9b3a,U+9b3d-9b40,U+9b46,U+9b4a-9b4c,U+9b4e,U+9b50,U+9b52-9b53,U+9b55-9bcf"}},{uri:I2e,descriptors:{unicodeRange:"U+6a4b-6a4f,U+6a51-6a57,U+6a5a,U+6a5c-6a60,U+6a62-6a64,U+6a66-6a70,U+6a72-6a78,U+6a7a-6a7b,U+6a7d-6a7f,U+6a81-6a83,U+6a85-6a8d,U+6a8f,U+6a92-6a96,U+6a98-6a9f,U+6aa1-6aa8,U+6aaa,U+6aad-6aef"}},{uri:S2e,descriptors:{unicodeRange:"U+99c9-9a53"}},{uri:x2e,descriptors:{unicodeRange:"U+8550-8555,U+8557-8558,U+855a-855d,U+855f-8563,U+8565-8567,U+8569-8571,U+8573,U+8575-8578,U+857c-857d,U+857f-8583,U+8586,U+8588-858e,U+8590-859a,U+859d-85a3,U+85a5-85a7,U+85a9,U+85ab-85ad,U+85b1-85b6,U+85b8,U+85ba-85c0,U+85c2-85c8,U+85ca-85ce,U+85d1-85d2,U+85d4,U+85d6-85db,U+85dd-85e3,U+85e5-85e8,U+85ea-85fa,U+85fc-85fe,U+8600-8603"}},{uri:C2e,descriptors:{unicodeRange:"U+6fb2,U+6fb4-6fb5,U+6fb7-6fb8,U+6fba-6fbf,U+6fc1,U+6fc3-6fc8,U+6fca-6fd0,U+6fd3-6fdd,U+6fdf,U+6fe2-6fed,U+6ff0-7010,U+7012-7019,U+701c-7022,U+7024-7034,U+7036-7038,U+703a-704b,U+704d-704e,U+7050-7053"}},{uri:A2e,descriptors:{unicodeRange:"U+4ba1-4c2c"}},{uri:M2e,descriptors:{unicodeRange:"U+9a54-9a6b,U+9a72,U+9a83,U+9a89,U+9a8d-9a8e,U+9a94-9a95,U+9a99,U+9aa6,U+9aa9-9aaf,U+9ab2-9ab5,U+9ab9,U+9abb,U+9abd-9abf,U+9ac3-9ac4,U+9ac6-9aca,U+9acd-9ad0,U+9ad2,U+9ad4-9ad7,U+9ad9-9ade,U+9ae0,U+9ae2-9ae5,U+9ae7-9aea,U+9aec,U+9aee,U+9af0-9af8,U+9afa,U+9afc-9b02,U+9b04-9b07,U+9b09-9b0e,U+9b10-9b12,U+9b14-9b1e,U+9b20-9b22,U+9b24-9b2e"}},{uri:k2e,descriptors:{unicodeRange:"U+9d1a-9da1"}},{uri:R2e,descriptors:{unicodeRange:"U+9e13-9e1e,U+9e24,U+9e27,U+9e2e,U+9e30,U+9e34,U+9e3b-9e3c,U+9e40,U+9e4d,U+9e50,U+9e52-9e54,U+9e56,U+9e59,U+9e5d,U+9e5f-9e62,U+9e65,U+9e6e-9e6f,U+9e72,U+9e74-9e7d,U+9e80-9e81,U+9e83-9e86,U+9e89-9e8a,U+9e8c-9e91,U+9e94-9e9c,U+9e9e,U+9ea0-9ea5,U+9ea7-9eb3,U+9eb5-9eb7,U+9eb9-9eba,U+9ebc,U+9ebf-9ec3,U+9ec5-9ec8,U+9eca-9ecc,U+9ed0,U+9ed2-9ed3,U+9ed5-9ed7,U+9ed9-9eda,U+9ede,U+9ee1,U+9ee3-9ee4,U+9ee6,U+9ee8,U+9eeb-9eee,U+9ef0-9ef8"}},{uri:D2e,descriptors:{unicodeRange:"U+8b1c-8b25,U+8b27-8b65,U+8b67-8b6b,U+8b6d-8b9f,U+8bac,U+8bb1,U+8bbb,U+8bc7,U+8bd0"}},{uri:L2e,descriptors:{unicodeRange:"U+4cad-4d2f"}},{uri:N2e,descriptors:{unicodeRange:"U+9c4b-9c7b,U+9c7d-9c7e,U+9c80,U+9c83-9c84,U+9c89-9c8a,U+9c8c,U+9c8f,U+9c93,U+9c96-9c99,U+9c9d,U+9caa,U+9cac,U+9caf,U+9cb9,U+9cbe-9cc2,U+9cc8-9cc9,U+9cd1-9cd2,U+9cda-9cdb,U+9ce0-9ce1,U+9ce3-9d19"}},{uri:O2e,descriptors:{unicodeRange:"U+9389-938e,U+9390-93c9,U+93cb-93d5,U+93d7-9410"}},{uri:s2e,descriptors:{unicodeRange:"U+20a0-20b5,U+20b9-20ba,U+20bc-20bd,U+4e2c,U+5107,U+5216,U+5293,U+54f3,U+5523,U+5819,U+5adc,U+5c88,U+5e3b,U+5fee,U+62f6,U+63be,U+6484,U+6499,U+67d9,U+67dd,U+6d5e,U+6f46,U+717a,U+71e0,U+72c1,U+73e7,U+75b0,U+7603,U+7722,U+7809,U+7811,U+7946,U+7967,U+799a,U+7b45,U+7ba2,U+8014,U+80d9,U+8159,U+817d,U+81a3,U+81aa,U+8201,U+833c,U+836e,U+83e5,U+8459,U+84f0,U+8729,U+8753,U+87d3,U+89dc,U+8bf6,U+8c2e,U+8e2c,U+8e9c,U+8e9e,U+8ece,U+8fee,U+9139,U+914f,U+9174,U+9191,U+960c,U+9622,U+9a98,U+9b48,U+9ca6,U+9cb0,U+9da2-9e12,U+9e88,U+9f44,U+9f86"}},{uri:P2e,descriptors:{unicodeRange:"U+9bd0-9c4a"}},{uri:F2e,descriptors:{unicodeRange:"U+4c2d-4cac"}},{uri:B2e,descriptors:{unicodeRange:"U+4d30-4dab"}},{uri:z2e,descriptors:{unicodeRange:"U+9411-943d,U+943f-946a,U+946c-9484"}},{uri:H2e,descriptors:{unicodeRange:"U+9efa,U+9efd,U+9eff-9f0a,U+9f0c,U+9f0f,U+9f11-9f12,U+9f14-9f16,U+9f18,U+9f1a-9f1f,U+9f21,U+9f23-9f2b,U+9f2d-9f2e,U+9f30-9f36,U+9f38,U+9f3a,U+9f3c,U+9f3f-9f43,U+9f45-9f4f,U+9f52-9f7e,U+9f81-9f82,U+9f8d-9f94"}},{uri:V2e,descriptors:{unicodeRange:"U+7e2b-7e3a,U+7e3c-7e40,U+7e42-7e46,U+7e48-7e81,U+7e83-7e9a,U+7e9c-7e9e,U+7eae,U+7eb4,U+7ebb-7ebc,U+7ed6,U+7ee4,U+7eec,U+7ef9,U+7f0a,U+7f10,U+7f1e,U+7f37,U+7f39,U+7f3b"}}],Je=class Je{constructor(t){F(this,"scene");F(this,"getSceneFamilies",()=>Je.getUniqueFamilies(this.scene.getNonDeletedElements()));F(this,"onLoaded",t=>{let n=!0;for(const s of t){const o=`${s.family}-${s.style}-${s.weight}-${s.unicodeRange}`;Je.loadedFontsCache.has(o)||(Je.loadedFontsCache.add(o),n=!1)}if(n)return;let i=!1;const r=this.scene.getNonDeletedElementsMap();for(const s of this.scene.getNonDeletedElements())if(ge(s)){i=!0,qt.delete(s),xp.clearCache(mt(s));const o=Yn(s,r);o&&qt.delete(o)}i&&this.scene.triggerUpdate()});F(this,"loadSceneFonts",async()=>{const t=this.getSceneFamilies(),n=Je.getCharsPerFamily(this.scene.getNonDeletedElements());return Je.loadFontFaces(t,n)});this.scene=t}static get registered(){return Je._registered?Je._initialized||(Je._registered=new Map([...Je.init().entries(),...Je._registered.entries()])):Je._registered=Je.init(),Je._registered}get registered(){return Je.registered}static async generateFontFaceDeclarations(t){const n=Je.getUniqueFamilies(t),i=Je.getCharsPerFamily(t),r=n.find(l=>UB(l).includes(Vf));if(r){const l=Je.getCharacters(i,r);if(kae(l)){const c=$f[Vf];i[c]=new Set(l),n.unshift($f[Vf])}}const s=Je.fontFacesStylesGenerator(n,i),o=3,a=await new CA(s,o).all();return Array.from(new Set(a))}static async loadFontFaces(t,n){for(const{fontFaces:o,metadata:a}of Je.registered.values())if(!a.local)for(const{fontFace:l}of o)window.document.fonts.has(l)||window.document.fonts.add(l);const i=Je.fontFacesLoader(t,n),r=10;return(await new CA(i,r).all()).flat().filter(Boolean)}static*fontFacesLoader(t,n){for(const[i,r]of t.entries()){const s=mt({fontFamily:r,fontSize:16}),o=Je.getCharacters(n,r);window.document.fonts.check(s,o)||(yield Hc(async()=>{var a;try{const l=await window.document.fonts.load(s,o);return[i,l]}catch(l){console.error(`Failed to load font "${s}" from urls "${(a=Je.registered.get(r))==null?void 0:a.fontFaces.map(c=>c.urls)}"`,l)}}))}}static*fontFacesStylesGenerator(t,n){for(const[i,r]of t.entries()){const{fontFaces:s,metadata:o}=Je.registered.get(r)??{};if(!Array.isArray(s)){console.error(`Couldn't find registered fonts for font-family "${r}"`,Je.registered);continue}if(!(o!=null&&o.local))for(const[a,l]of s.entries())yield Hc(async()=>{try{const c=Je.getCharacters(n,r),d=await l.toCSS(c);return d?[i*1e4+a,d]:void 0}catch(c){console.error(`Couldn't transform font-face to css for family "${l.fontFace.family}"`,c)}})}}static register(t,n,...i){const r=nt[t]??$f[t];return this.registered.get(r)||this.registered.set(r,{metadata:n,fontFaces:i.map(({uri:o,descriptors:a})=>new yv(t,o,a))}),this.registered}static init(){const t={registered:new Map},n=(i,...r)=>{const s=nt[i]??$f[i],o=Bh[s]??Bh[nt.Excalifont];Je.register.call(t,i,o,...r)};return n("Cascadia",...p0e),n("Comic Shanns",...v0e),n("Excalifont",...N0e),n("Helvetica",...O0e),n("Liberation Sans",...F0e),n("Lilita One",...H0e),n("Nunito",...Y0e),n("Virgil",...K0e),n(Vf,...$2e),n(cm,...w0e),Je._initialized=!0,t.registered}static getUniqueFamilies(t){return Array.from(t.reduce((n,i)=>(ge(i)&&n.add(i.fontFamily),n),new Set))}static getCharsPerFamily(t){const n={};for(const i of t)if(ge(i))for(const r of i.originalText)n[i.fontFamily]||(n[i.fontFamily]=new Set),n[i.fontFamily].add(r);return n}static getCharacters(t,n){return t[n]?Array.from(t[n]).join(""):""}static getAllFamilies(){return Array.from(Je.registered.keys())}};F(Je,"loadedFontsCache",new Set),F(Je,"_registered"),F(Je,"_initialized",!1),F(Je,"loadElementsFonts",async t=>{const n=Je.getUniqueFamilies(t),i=Je.getCharsPerFamily(t);return Je.loadFontFaces(n,i)});let nl=Je;const J$=de.forwardRef(({className:e,placeholder:t,onChange:n},i)=>N("div",{className:le("QuickSearch__wrapper",e),children:[Eu,g("input",{ref:i,className:"QuickSearch__input",type:"text",placeholder:t,onChange:r=>n(r.target.value.trim().toLowerCase())})]})),eG=({className:e,placeholder:t,children:n})=>{const i=!R.Children.count(n);return g("div",{className:le("ScrollableList__wrapper",e),role:"menu",children:i?g("div",{className:"empty",children:t}):n})},V6=({children:e,className:t="",style:n,title:i})=>N("div",{className:`dropdown-menu-group ${t}`,style:n,children:[i&&g("p",{className:"dropdown-menu-group-title",children:i}),e]});V6.displayName="DropdownMenuGroup";const tG=({children:e,...t})=>g("span",{...t,style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",...t.style},children:e}),nG=({textStyle:e,icon:t,shortcut:n,children:i})=>{const r=Nn();return N(fe,{children:[t&&g("div",{className:"dropdown-menu-item__icon",children:t}),g("div",{style:e,className:"dropdown-menu-item__text",children:g(tG,{children:i})}),n&&r.formFactor!=="phone"&&g("div",{className:"dropdown-menu-item__shortcut",children:n})]})},iG=de.createContext({}),rG=(e="",t=!1,n=!1)=>`dropdown-menu-item dropdown-menu-item-base ${e}
  ${t?"dropdown-menu-item--selected":""} ${n?"dropdown-menu-item--hovered":""}`.trim(),sG=(e,t)=>{const n=R.useContext(iG);return ry(e,i=>{var s;const r=new CustomEvent(te.MENU_ITEM_SELECT,{bubbles:!0,cancelable:!0});t==null||t(r),r.defaultPrevented||(s=n.onSelect)==null||s.call(n,r)})},Rr=({icon:e,value:t,order:n,children:i,shortcut:r,className:s,hovered:o,selected:a,textStyle:l,onSelect:c,onClick:d,...u})=>{const f=sG(d,c),h=R.useRef(null);return R.useEffect(()=>{var m,p;o&&(n===0?(m=h.current)==null||m.scrollIntoView({block:"end"}):(p=h.current)==null||p.scrollIntoView({block:"nearest"}))},[o,n]),g("button",{...u,ref:h,value:t,onClick:f,className:rG(s,a,o),title:u.title??u["aria-label"],children:g(nG,{textStyle:l,icon:e,shortcut:r,children:i})})};Rr.displayName="DropdownMenuItem";const $1={GREEN:"green",RED:"red",BLUE:"blue"},IT=({type:e=$1.BLUE,children:t})=>{const{theme:n}=Gp(),i={display:"inline-flex",marginLeft:"auto",padding:"2px 4px",borderRadius:6,fontSize:9,fontFamily:"Cascadia, monospace",border:n===ke.LIGHT?"1.5px solid white":"none"};switch(e){case $1.GREEN:Object.assign(i,{backgroundColor:"var(--background-color-badge)",color:"var(--color-badge)"});break;case $1.RED:Object.assign(i,{backgroundColor:"pink",color:"darkred"});break;case $1.BLUE:default:Object.assign(i,{background:"var(--color-promo)",color:"var(--color-surface-lowest)"})}return g("div",{className:"DropDownMenuItemBadge",style:i,children:t})};IT.displayName="DropdownMenuItemBadge";Rr.Badge=IT;const G2e=({event:e,inputRef:t,hoveredFont:n,filteredFonts:i,onClose:r,onSelect:s,onHover:o})=>{var a,l,c;if(!e[V.CTRL_OR_CMD]&&e.shiftKey&&e.key.toLowerCase()===V.F)return(a=t.current)==null||a.focus(),!0;if(e.key===V.ESCAPE)return r(),!0;if(e.key===V.ENTER)return n!=null&&n.value&&s(n.value),!0;if(e.key===V.ARROW_DOWN)return n!=null&&n.next?o(n.next.value):(l=i[0])!=null&&l.value&&o(i[0].value),!0;if(e.key===V.ARROW_UP)return n!=null&&n.prev?o(n.prev.value):(c=i[i.length-1])!=null&&c.value&&o(i[i.length-1].value),!0},X2e=e=>{switch(e){case nt.Excalifont:case nt.Virgil:return Lp;case nt.Nunito:case nt.Helvetica:return lv;case nt["Lilita One"]:return _fe;case nt["Comic Shanns"]:case nt.Cascadia:return VV;default:return lv}},j2e=de.memo(({selectedFontFamily:e,hoveredFontFamily:t,onSelect:n,onHover:i,onLeave:r,onOpen:s,onClose:o})=>{const{container:a}=Dr(),l=bo(),{fonts:c}=l,{showDeprecatedFonts:d}=$p(),u=fa(),[f,h]=R.useState(""),m=R.useRef(null),p=R.useMemo(()=>Array.from(nl.registered.entries()).filter(([D,{metadata:O}])=>!O.private&&!O.fallback).map(([D,{metadata:O,fontFaces:L}])=>{var $,H;const Y={value:D,icon:X2e(D),text:((H=($=L[0])==null?void 0:$.fontFace)==null?void 0:H.family)??"Unknown"};return O.deprecated&&Object.assign(Y,{deprecated:O.deprecated,badge:{type:$1.RED,placeholder:M("fontList.badge.old")}}),Y}).sort((D,O)=>D.text.toLowerCase()>O.text.toLowerCase()?1:-1),[]),U=R.useMemo(()=>new Set(c.getSceneFamilies()),[e]),b=R.useMemo(()=>p.filter(D=>U.has(D.value)),[p,U]),y=R.useMemo(()=>p.filter(D=>!U.has(D.value)&&(d||!D.deprecated)),[p,U,d]),w=R.useMemo(()=>toe([...b,...y].filter(D=>{var O;return(O=D.text)==null?void 0:O.toLowerCase().includes(f)})),[b,y,f]),v=R.useMemo(()=>{var O;let D;return t?D=w.find(L=>L.value===t):e&&(D=w.find(L=>L.value===e)),!D&&f&&((O=w[0])!=null&&O.value?i(w[0].value):r()),D},[t,e,f,w,i,r]),I=R.useCallback(D=>{let O=null;if(l.state.editingTextElement){const L=document.querySelector(".excalidraw-wysiwyg");L&&(O={start:L.selectionStart,end:L.selectionEnd})}n(D),l.state.editingTextElement&&O&&setTimeout(()=>{const L=document.querySelector(".excalidraw-wysiwyg");L&&O&&(L.focus(),L.selectionStart=O.start,L.selectionEnd=O.end)},0)},[n,l.state.editingTextElement]),C=R.useCallback(D=>{G2e({event:D,inputRef:m,hoveredFont:v,filteredFonts:w,onSelect:I,onHover:i,onClose:o})&&(D.preventDefault(),D.stopPropagation())},[v,w,I,i,o]);R.useEffect(()=>(s(),()=>{o()}),[]);const _=R.useMemo(()=>w.filter(D=>U.has(D.value)),[w,U]),T=R.useMemo(()=>w.filter(D=>!U.has(D.value)),[w,U]),k=(D,O)=>N(Rr,{icon:D.icon,value:D.value,order:O,textStyle:{fontFamily:Ep({fontFamily:D.value})},hovered:D.value===(v==null?void 0:v.value),selected:D.value===e,tabIndex:D.value===e?0:-1,onClick:L=>{I(Number(L.currentTarget.value))},onMouseMove:()=>{(v==null?void 0:v.value)!==D.value&&i(D.value)},children:[D.text,D.badge&&g(IT,{type:D.badge.type,children:D.badge.placeholder})]},D.value),x=[];return _.length&&x.push(g(V6,{title:M("fontList.sceneFonts"),children:_.map(k)},"group_1")),T.length&&x.push(g(V6,{title:M("fontList.availableFonts"),children:T.map((D,O)=>k(D,O+_.length))},"group_2")),N(Ag,{className:"properties-content",container:a,style:{width:"15rem"},onClose:()=>{o(),l.state.editingTextElement&&setTimeout(()=>{const D=document.querySelector(".excalidraw-wysiwyg");D&&D.focus()},0)},onPointerLeave:r,onKeyDown:C,preventAutoFocusOnTouch:!!l.state.editingTextElement,children:[u==="full"&&g(J$,{ref:m,placeholder:M("quickSearch.placeholder"),onChange:ll(h,20)}),g(eG,{className:"dropdown-menu fonts manual-hover",placeholder:M("fontList.empty"),children:x.length?x:null})]})},(e,t)=>e.selectedFontFamily===t.selectedFontFamily&&e.hoveredFontFamily===t.hoveredFontFamily),Y2e=({selectedFontFamily:e,isOpened:t=!1,compactMode:n=!1})=>{const i=xn(),r=n?{...bp,width:"2rem",height:"2rem"}:{};return g(xl,{asChild:!0,children:g("div",{"data-openpopup":"fontFamily",className:"properties-trigger",children:g(sT,{standalone:!0,icon:Uh,title:M("labels.showFonts"),className:"properties-trigger",testId:"font-family-show-fonts",active:t,onClick:()=>{i(s=>({openPopup:s.openPopup==="fontFamily"?null:s.openPopup}))},style:{border:"none",...r}})})})},oG=[{value:nt.Excalifont,icon:Lp,text:M("labels.handDrawn"),testId:"font-family-hand-drawn"},{value:nt.Nunito,icon:lv,text:M("labels.normal"),testId:"font-family-normal"},{value:nt["Comic Shanns"],icon:VV,text:M("labels.code"),testId:"font-family-code"}];new Set(oG.map(e=>e.value));const W2e=de.memo(({isOpened:e,selectedFontFamily:t,hoveredFontFamily:n,onSelect:i,onHover:r,onLeave:s,onPopupChange:o,compactMode:a=!1})=>{const l=R.useMemo(()=>oG,[]),c=R.useCallback(d=>{d&&i(d)},[i]);return N("div",{role:"dialog","aria-modal":"true",className:le("FontPicker__container",{"FontPicker__container--compact":a}),children:[!a&&g("div",{className:"buttonList",children:g(da,{type:"button",options:l,value:t,onClick:c})}),!a&&g(K$,{}),N(Sl,{open:e,onOpenChange:o,children:[g(Y2e,{selectedFontFamily:t,isOpened:e,compactMode:a}),e&&g(j2e,{selectedFontFamily:t,hoveredFontFamily:n,onSelect:c,onHover:r,onLeave:s,onOpen:()=>o(!0),onClose:()=>o(!1)})]})]})},(e,t)=>e.isOpened===t.isOpened&&e.selectedFontFamily===t.selectedFontFamily&&e.hoveredFontFamily===t.hoveredFontFamily),Dy=({className:e,icon:t,size:n="1em"})=>g("span",{className:e,style:{width:n,height:"100%",margin:"0 0.5ex 0 0.5ex",display:"inline-flex",lineHeight:0,verticalAlign:"middle",flex:"0 0 auto"},children:t}),Ev=({label:e,open:t,openTrigger:n,children:i,className:r,showCollapsedIcon:s=!0})=>N(fe,{children:[N("div",{style:{cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center"},className:r,onClick:n,children:[e,s&&g(Dy,{icon:t?nhe:WV})]}),t&&g("div",{style:{display:"flex",flexDirection:"column"},children:i})]}),K2e=Wt(!1);function Z2e({options:e,value:t,label:n,onChange:i,onClose:r,numberOfOptionsToAlwaysShow:s=e.length}){const o=Nn(),{container:a}=Dr(),l=p=>{const U=e.find(b=>b.keyBinding===p.key.toLowerCase());if(!(p.metaKey||p.altKey||p.ctrlKey)&&U)i(U.value),p.preventDefault();else if(p.key===V.TAB){const b=e.findIndex(w=>w.value===t),y=p.shiftKey?(e.length+b-1)%e.length:(b+1)%e.length;i(e[y].value)}else if(B1(p.key)){const b=vm().rtl,y=e.findIndex(w=>w.value===t);if(y!==-1){const w=e.length;let v=y;switch(p.key){case(b?V.ARROW_LEFT:V.ARROW_RIGHT):v=(y+1)%w;break;case(b?V.ARROW_RIGHT:V.ARROW_LEFT):v=(w+y-1)%w;break;case V.ARROW_DOWN:{v=(y+(s??1))%w;break}case V.ARROW_UP:{v=(w+y-(s??1))%w;break}}i(e[v].value)}p.preventDefault()}else(p.key===V.ESCAPE||p.key===V.ENTER)&&(p.preventDefault(),r());p.nativeEvent.stopImmediatePropagation(),p.stopPropagation()},[c,d]=un(K2e),u=de.useMemo(()=>e.slice(0,s),[e,s]),f=de.useMemo(()=>e.slice(s),[e,s]);R.useEffect(()=>{u.some(p=>p.value===t)||d(!0)},[t,u,d]);const h=p=>g("div",{className:"picker-content",children:p.map((U,b)=>N("button",{type:"button",className:le("picker-option",{active:t===U.value}),onClick:y=>{i(U.value)},title:`${U.text} ${U.keyBinding&&` ${U.keyBinding.toUpperCase()}`}`,"aria-label":U.text||"none","aria-keyshortcuts":U.keyBinding||void 0,ref:y=>{t===U.value&&setTimeout(()=>{y==null||y.focus()},0)},children:[U.icon,U.keyBinding&&g("span",{className:"picker-keybinding",children:U.keyBinding})]},U.text))}),m=o.formFactor==="phone";return g(xy,{side:m?"right":"bottom",align:"start",sideOffset:m?8:12,style:{zIndex:"var(--zIndex-ui-styles-popup)"},onKeyDown:l,collisionBoundary:a??void 0,children:N("div",{className:"picker",role:"dialog","aria-modal":"true","aria-label":n,children:[h(u),f.length>0&&g(Ev,{label:M("labels.more_options"),open:c,openTrigger:()=>{d(p=>!p)},className:"picker-collapsible",children:h(f)})]})})}function Pk({value:e,label:t,options:n,onChange:i,group:r="",numberOfOptionsToAlwaysShow:s}){var c;const[o,a]=de.useState(!1),l=de.useRef(null);return g("div",{children:N(Sl,{open:o,onOpenChange:d=>a(d),children:[g(xl,{name:r,type:"button","aria-label":t,onClick:()=>a(!o),ref:l,className:o?"active":"",children:(c=n.find(d=>d.value===e))==null?void 0:c.icon}),o&&g(Z2e,{options:n,value:e,label:t,onChange:i,onClose:()=>{a(!1)},numberOfOptionsToAlwaysShow:s})]})})}const q2e=({updateData:e,app:t,testId:n})=>{const i=de.useRef(null),r=de.useRef(null),s=t.scene.getSelectedElements(t.state);let o=!0;const a=s.at(0),c=s.reduce((d,u)=>(d!=null&&d!==u.opacity&&(o=!1),d==null||d>u.opacity?u.opacity:d),(a==null?void 0:a.opacity)??null)??t.state.currentItemOpacity;return R.useEffect(()=>{if(i.current&&r.current){const d=i.current,u=r.current,f=d.offsetWidth,h=15,m=c/100*(f-h)+h/2;u.style.left=`${m}px`,d.style.background=`linear-gradient(to right, var(--color-slider-track) 0%, var(--color-slider-track) ${c}%, var(--button-bg) ${c}%, var(--button-bg) 100%)`}},[c]),N("label",{className:"control-label",children:[M("labels.opacity"),N("div",{className:"range-wrapper",children:[g("input",{style:{"--color-slider-track":o?void 0:"var(--button-bg)"},ref:i,type:"range",min:"0",max:"100",step:"10",onChange:d=>{e(+d.target.value)},value:c,className:"range-input","data-testid":n}),g("div",{className:"value-bubble",ref:r,children:c!==0?c:null}),g("div",{className:"zero-label",children:"0"})]})]})},aG=.1,kg=e=>{const t=y0(e.editorInterface);return{stylesPanelMode:t,isCompact:t!=="full",isMobile:t==="mobile"}},mr=(e,t,n,i=!1)=>{const r=ve(Xe(e,t,{includeBoundTextElement:i}));return e.map(s=>{var o;return r.get(s.id)||s.id===((o=t.editingTextElement)==null?void 0:o.id)?n(s):s})},pr=function(e,t,n,i,r){const s=t.state.editingTextElement,o=Yt(e);let a=null;if(s&&(a=n(s)),!a)if(Wn(o,t.state)){const c=t.scene.getSelectedElements(t.state),d=i===!0?c:c.filter(u=>i(u));a=ZB(d,n)??(typeof r=="function"?r(!0):r)}else a=typeof r=="function"?r(!1):r;return a},Q2e=(e,t,n)=>Dt(t)||!t.autoResize?t:n.mutateElement(t,{x:e.textAlign==="left"?e.x:e.x+(e.width-t.width)/(e.textAlign==="center"?2:1),y:e.y+(e.height-t.height)/2}),ST=(e,t,n,i,r)=>{const s=new Set,o=mr(e,t,a=>{if(ge(a)){const l=i(a);s.add(l);let c=Ie(a,{fontSize:l});return Qi(c,n.scene.getContainerElement(a),n.scene),c=Q2e(a,c,n.scene),c}return a},!0);return Xe(e,t,{includeBoundTextElement:!0}).forEach(a=>{ge(a)&&fr(a,n.scene)}),{elements:o,appState:{...t,currentItemFontSize:s.size===1?[...s][0]:r??t.currentItemFontSize},captureUpdate:Z.IMMEDIATELY}};ue({name:"changeStrokeColor",label:"labels.stroke",trackEvent:!1,perform:(e,t,n)=>({...n.currentItemStrokeColor&&{elements:mr(e,t,i=>F4(i.type)?Ie(i,{strokeColor:n.currentItemStrokeColor}):i,!0)},appState:{...t,...n},captureUpdate:n.currentItemStrokeColor?Z.IMMEDIATELY:Z.EVENTUALLY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:r})=>{const{stylesPanelMode:s}=kg(i);return N(fe,{children:[s==="full"&&g("h3",{"aria-hidden":"true",children:M("labels.stroke")}),g(_T,{topPicks:cB,palette:Are,type:"elementStroke",label:M("labels.stroke"),color:pr(e,i,o=>o.strokeColor,!0,o=>o?null:t.currentItemStrokeColor),onChange:o=>n({currentItemStrokeColor:o}),elements:e,appState:t,updateData:n})]})}});ue({name:"changeBackgroundColor",label:"labels.changeBackground",trackEvent:!1,perform:(e,t,n,i)=>{if(!n.currentItemBackgroundColor)return{appState:{...t,...n},captureUpdate:Z.EVENTUALLY};let r;const s=i.scene.getSelectedElements(t);if(!Ir(n.currentItemBackgroundColor)&&s.every(a=>nn(a)&&uz(a.points))){const a=ve(s);r=e.map(l=>a.has(l.id)&&nn(l)?Ie(l,{backgroundColor:n.currentItemBackgroundColor,...x9(l,!0)}):l)}else r=mr(e,t,a=>Ie(a,{backgroundColor:n.currentItemBackgroundColor}));return{elements:r,appState:{...t,...n},captureUpdate:Z.IMMEDIATELY}},PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:r})=>{const{stylesPanelMode:s}=kg(i);return N(fe,{children:[s==="full"&&g("h3",{"aria-hidden":"true",children:M("labels.background")}),g(_T,{topPicks:dB,palette:Mre,type:"elementBackground",label:M("labels.background"),color:pr(e,i,o=>o.backgroundColor,!0,o=>o?null:t.currentItemBackgroundColor),onChange:o=>n({currentItemBackgroundColor:o}),elements:e,appState:t,updateData:n})]})}});ue({name:"changeFillStyle",label:"labels.fill",trackEvent:!1,perform:(e,t,n,i)=>(et("element","changeFillStyle",`${n} (${i.editorInterface.formFactor==="phone"?"mobile":"desktop"})`),{elements:mr(e,t,r=>Ie(r,{fillStyle:n})),appState:{...t,currentItemFillStyle:n},captureUpdate:Z.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>{const r=Xe(e,t),s=r.length>0&&r.every(o=>o.fillStyle==="zigzag");return N("fieldset",{children:[g("legend",{children:M("labels.fill")}),g("div",{className:"buttonList",children:g(da,{type:"button",options:[{value:"hachure",text:`${M(s?"labels.zigzag":"labels.hachure")} (${J("Alt-Click")})`,icon:s?Kue:Zue,active:s?!0:void 0,testId:"fill-hachure"},{value:"cross-hatch",text:M("labels.crossHatch"),icon:que,testId:"fill-cross-hatch"},{value:"solid",text:M("labels.solid"),icon:Que,testId:"fill-solid"}],value:pr(e,i,o=>o.fillStyle,o=>o.hasOwnProperty("fillStyle"),o=>o?null:t.currentItemFillStyle),onClick:(o,a)=>{const l=a.altKey&&o==="hachure"&&r.every(c=>c.fillStyle==="hachure")?"zigzag":o;n(l)}})})]})}});ue({name:"changeStrokeWidth",label:"labels.strokeWidth",trackEvent:!1,perform:(e,t,n)=>({elements:mr(e,t,i=>Ie(i,{strokeWidth:n})),appState:{...t,currentItemStrokeWidth:n},captureUpdate:Z.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:r})=>N("fieldset",{children:[g("legend",{children:M("labels.strokeWidth")}),g("div",{className:"buttonList",children:g(da,{group:"stroke-width",options:[{value:M8.thin,text:M("labels.thin"),icon:HV,testId:"strokeWidth-thin"},{value:M8.bold,text:M("labels.bold"),icon:Jue,testId:"strokeWidth-bold"},{value:M8.extraBold,text:M("labels.extraBold"),icon:efe,testId:"strokeWidth-extraBold"}],value:pr(e,i,s=>s.strokeWidth,s=>s.hasOwnProperty("strokeWidth"),s=>s?null:t.currentItemStrokeWidth),onChange:s=>n(s)})})]})});ue({name:"changeSloppiness",label:"labels.sloppiness",trackEvent:!1,perform:(e,t,n)=>({elements:mr(e,t,i=>Ie(i,{seed:Ps(),roughness:n})),appState:{...t,currentItemRoughness:n},captureUpdate:Z.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:r})=>N("fieldset",{children:[g("legend",{children:M("labels.sloppiness")}),g("div",{className:"buttonList",children:g(da,{group:"sloppiness",options:[{value:0,text:M("labels.architect"),icon:ife},{value:1,text:M("labels.artist"),icon:rfe},{value:2,text:M("labels.cartoonist"),icon:sfe}],value:pr(e,i,s=>s.roughness,s=>s.hasOwnProperty("roughness"),s=>s?null:t.currentItemRoughness),onChange:s=>n(s)})})]})});ue({name:"changeStrokeStyle",label:"labels.strokeStyle",trackEvent:!1,perform:(e,t,n)=>({elements:mr(e,t,i=>Ie(i,{strokeStyle:n})),appState:{...t,currentItemStrokeStyle:n},captureUpdate:Z.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:r})=>N("fieldset",{children:[g("legend",{children:M("labels.strokeStyle")}),g("div",{className:"buttonList",children:g(da,{group:"strokeStyle",options:[{value:"solid",text:M("labels.strokeStyle_solid"),icon:HV},{value:"dashed",text:M("labels.strokeStyle_dashed"),icon:tfe},{value:"dotted",text:M("labels.strokeStyle_dotted"),icon:nfe}],value:pr(e,i,s=>s.strokeStyle,s=>s.hasOwnProperty("strokeStyle"),s=>s?null:t.currentItemStrokeStyle),onChange:s=>n(s)})})]})});ue({name:"changeOpacity",label:"labels.opacity",trackEvent:!1,perform:(e,t,n)=>({elements:mr(e,t,i=>Ie(i,{opacity:n}),!0),appState:{...t,currentItemOpacity:n},captureUpdate:Z.IMMEDIATELY}),PanelComponent:({app:e,updateData:t})=>g(q2e,{updateData:t,app:e,testId:"opacity"})});ue({name:"changeFontSize",label:"labels.fontSize",trackEvent:!1,perform:(e,t,n,i)=>ST(e,t,i,()=>n,n),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:r})=>{const{isCompact:s}=kg(i);return N("fieldset",{children:[g("legend",{children:M("labels.fontSize")}),g("div",{className:"buttonList",children:g(da,{group:"font-size",options:[{value:16,text:M("labels.small"),icon:yfe,testId:"fontSize-small"},{value:20,text:M("labels.medium"),icon:Efe,testId:"fontSize-medium"},{value:28,text:M("labels.large"),icon:vfe,testId:"fontSize-large"},{value:36,text:M("labels.veryLarge"),icon:wfe,testId:"fontSize-veryLarge"}],value:pr(e,i,o=>{if(ge(o))return o.fontSize;const a=Le(o,i.scene.getNonDeletedElementsMap());return a?a.fontSize:null},o=>ge(o)||Le(o,i.scene.getNonDeletedElementsMap())!==null,o=>o?null:t.currentItemFontSize||Il),onChange:o=>{ky(()=>n(o),s,!!t.editingTextElement,r==null?void 0:r.onPreventClose)}})})]})}});const Fk=ue({name:"decreaseFontSize",label:"labels.decreaseFontSize",icon:vy,trackEvent:!1,perform:(e,t,n,i)=>ST(e,t,i,r=>Math.round(1/(1+aG)*r.fontSize)),keyTest:e=>e[V.CTRL_OR_CMD]&&e.shiftKey&&(e.key===V.CHEVRON_LEFT||e.key===V.COMMA)}),Bk=ue({name:"increaseFontSize",label:"labels.increaseFontSize",icon:vy,trackEvent:!1,perform:(e,t,n,i)=>ST(e,t,i,r=>Math.round(r.fontSize*(1+aG))),keyTest:e=>e[V.CTRL_OR_CMD]&&e.shiftKey&&(e.key===V.CHEVRON_RIGHT||e.key===V.PERIOD)});ue({name:"changeFontFamily",label:"labels.fontFamily",trackEvent:!1,perform:(e,t,n,i)=>{var m;const{cachedElements:r,resetAll:s,resetContainers:o,...a}=n;if(s)return{elements:mr(e,t,U=>{const b=r==null?void 0:r.get(U.id);return b?Ie(U,{...b}):U},!0),appState:{...t,...a},captureUpdate:Z.NEVER};const{currentItemFontFamily:l,currentHoveredFontFamily:c}=n;let d=Z.EVENTUALLY,u,f=!1;if(l)u=l,d=Z.IMMEDIATELY;else if(c){u=c,d=Z.EVENTUALLY;const p=Xe(e,t,{includeBoundTextElement:!0}).filter(U=>ge(U));if(p.length>200)f=!0;else{let U=0,b=0;for(;U<p.length&&b<5e3;){const y=p[U];b+=(y==null?void 0:y.originalText.length)||0,U++}b>5e3&&(f=!0)}}const h={appState:{...t,...a},captureUpdate:d};if(u&&!f){const p=new Map;let U=new Set,b=!1;const y=Array.from(nl.loadedFontsCache.values()),w=(m=Object.entries(nt).find(([C,_])=>_===u))==null?void 0:m[0];c&&w&&y.some(C=>C.startsWith(w))&&(b=!0),Object.assign(h,{elements:mr(e,t,C=>{if(ge(C)&&(C.fontFamily!==u||l)){const _=Ie(C,{fontFamily:u,lineHeight:zc(u)}),T=(r==null?void 0:r.get(C.containerId||""))||{},k=i.scene.getContainerElement(C);return o&&k&&T&&i.scene.mutateElement(k,{...T}),b||(U=new Set([...U,...Array.from(_.originalText)])),p.set(_,k),_}return C},!0)});const v=`10px ${Ep({fontFamily:u})}`,I=Array.from(U.values()).join();if(b||window.document.fonts.check(v,I))for(const[C,_]of p)Qi(C,_,i.scene);else window.document.fonts.load(v,I).then(C=>{for(const[_,T]of p){const k=i.scene.getElement(_.id),x=T?i.scene.getElement(T.id):null;k&&Qi(k,x,i.scene)}i.fonts.onLoaded(C)})}return h},PanelComponent:({elements:e,appState:t,app:n,updateData:i})=>{const r=R.useRef(new Map),s=R.useRef(null),[o,a]=R.useState({}),l=R.useRef(!0),{stylesPanelMode:c,isCompact:d}=kg(n),u=R.useMemo(()=>{var h;const f=(m,p)=>pr(m,n,U=>{if(ge(U))return U.fontFamily;const b=Le(U,p);return b?b.fontFamily:null},U=>ge(U)||Le(U,p)!==null,U=>U?null:t.currentItemFontFamily||sd);return o.openPopup==="fontFamily"&&t.openPopup==="fontFamily"?f(Array.from(((h=r.current)==null?void 0:h.values())??[]),r.current):!o.openPopup&&t.openPopup!=="fontFamily"?f(e,n.scene.getNonDeletedElementsMap()):s.current},[o.openPopup,t,e,n]);return R.useEffect(()=>{s.current=u},[u]),R.useEffect(()=>{Object.keys(o).length&&(i(o),a({}))},[o]),R.useEffect(()=>(l.current=!1,()=>{l.current=!0}),[]),N(fe,{children:[c==="full"&&g("legend",{children:M("labels.fontFamily")}),g(W2e,{isOpened:t.openPopup==="fontFamily",selectedFontFamily:u,hoveredFontFamily:t.currentHoveredFontFamily,compactMode:c!=="full",onSelect:f=>{ky(()=>{a({openPopup:null,currentHoveredFontFamily:null,currentItemFontFamily:f}),r.current.clear()},d,!!t.editingTextElement)},onHover:f=>{a({currentHoveredFontFamily:f,cachedElements:new Map(r.current),resetContainers:!0})},onLeave:()=>{a({currentHoveredFontFamily:null,cachedElements:new Map(r.current),resetAll:!0})},onPopupChange:f=>{if(f){r.current.clear();const{editingTextElement:h}=t;if((h==null?void 0:h.type)==="text"){const m=n.scene.getElement(h.id);r.current.set(h.id,Ie(m||h,{},!0))}else{const m=Xe(e,t,{includeBoundTextElement:!0});for(const p of m)r.current.set(p.id,Ie(p,{},!0))}a({...o,openPopup:"fontFamily"})}else{const h={currentHoveredFontFamily:null,cachedElements:new Map(r.current),resetAll:!0};a({...h}),r.current.clear(),d&&t.editingTextElement&&vT(null)}}})]})}});ue({name:"changeTextAlign",label:"Change text alignment",trackEvent:!1,perform:(e,t,n,i)=>({elements:mr(e,t,r=>{if(ge(r)){const s=Ie(r,{textAlign:n});return Qi(s,i.scene.getContainerElement(r),i.scene),s}return r},!0),appState:{...t,currentItemTextAlign:n},captureUpdate:Z.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:r})=>{const s=i.scene.getNonDeletedElementsMap(),{isCompact:o}=kg(i);return N("fieldset",{children:[g("legend",{children:M("labels.textAlign")}),g("div",{className:"buttonList",children:g(da,{group:"text-align",options:[{value:"left",text:M("labels.left"),icon:Tfe,testId:"align-left"},{value:"center",text:M("labels.center"),icon:Ife,testId:"align-horizontal-center"},{value:"right",text:M("labels.right"),icon:Sfe,testId:"align-right"}],value:pr(e,i,a=>{if(ge(a))return a.textAlign;const l=Le(a,s);return l?l.textAlign:null},a=>ge(a)||Le(a,s)!==null,a=>a?null:t.currentItemTextAlign),onChange:a=>{ky(()=>n(a),o,!!t.editingTextElement,r==null?void 0:r.onPreventClose)}})})]})}});ue({name:"changeVerticalAlign",label:"Change vertical alignment",trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:mr(e,t,r=>{if(ge(r)){const s=Ie(r,{verticalAlign:n});return Qi(s,i.scene.getContainerElement(r),i.scene),s}return r},!0),appState:{...t},captureUpdate:Z.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:r})=>{const{isCompact:s}=kg(i);return g("fieldset",{children:g("div",{className:"buttonList",children:g(da,{group:"text-align",options:[{value:Yr.TOP,text:M("labels.alignTop"),icon:g(xfe,{theme:t.theme}),testId:"align-top"},{value:Yr.MIDDLE,text:M("labels.centerVertically"),icon:g(Afe,{theme:t.theme}),testId:"align-middle"},{value:Yr.BOTTOM,text:M("labels.alignBottom"),icon:g(Cfe,{theme:t.theme}),testId:"align-bottom"}],value:pr(e,i,o=>{if(ge(o)&&o.containerId)return o.verticalAlign;const a=Le(o,i.scene.getNonDeletedElementsMap());return a?a.verticalAlign:null},o=>ge(o)||Le(o,i.scene.getNonDeletedElementsMap())!==null,o=>o?null:Yr.MIDDLE),onChange:o=>{ky(()=>n(o),s,!!t.editingTextElement,r==null?void 0:r.onPreventClose)}})})})}});ue({name:"changeRoundness",label:"Change edge roundness",trackEvent:!1,perform:(e,t,n)=>({elements:mr(e,t,i=>me(i)?i:Ie(i,{roundness:n==="round"?{type:$u(i.type)?yn.ADAPTIVE_RADIUS:yn.PROPORTIONAL_RADIUS}:null})),appState:{...t,currentItemRoundness:n},captureUpdate:Z.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,renderAction:r})=>{const o=dy(Yt(e),t).some(a=>{var l;return((l=a.roundness)==null?void 0:l.type)===yn.LEGACY});return N("fieldset",{children:[g("legend",{children:M("labels.edges")}),N("div",{className:"buttonList",children:[g(da,{group:"edges",options:[{value:"sharp",text:M("labels.sharp"),icon:ofe},{value:"round",text:M("labels.round"),icon:afe}],value:pr(e,i,a=>o?null:a.roundness?"round":"sharp",a=>!Ce(a)&&a.hasOwnProperty("roundness"),a=>a?null:t.currentItemRoundness),onChange:a=>n(a)}),r("togglePolygon")]})]})}});const zk=e=>[{value:null,text:M("labels.arrowhead_none"),keyBinding:"q",icon:lfe},{value:"arrow",text:M("labels.arrowhead_arrow"),keyBinding:"w",icon:g(av,{flip:e})},{value:"triangle",text:M("labels.arrowhead_triangle"),icon:g(ffe,{flip:e}),keyBinding:"e"},{value:"triangle_outline",text:M("labels.arrowhead_triangle_outline"),icon:g(hfe,{flip:e}),keyBinding:"r"},{value:"circle",text:M("labels.arrowhead_circle"),keyBinding:"a",icon:g(cfe,{flip:e})},{value:"circle_outline",text:M("labels.arrowhead_circle_outline"),keyBinding:"s",icon:g(dfe,{flip:e})},{value:"diamond",text:M("labels.arrowhead_diamond"),icon:g(gfe,{flip:e}),keyBinding:"d"},{value:"diamond_outline",text:M("labels.arrowhead_diamond_outline"),icon:g(mfe,{flip:e}),keyBinding:"f"},{value:"bar",text:M("labels.arrowhead_bar"),keyBinding:"z",icon:g(ufe,{flip:e})},{value:"crowfoot_one",text:M("labels.arrowhead_crowfoot_one"),icon:g(Ufe,{flip:e}),keyBinding:"x"},{value:"crowfoot_many",text:M("labels.arrowhead_crowfoot_many"),icon:g(pfe,{flip:e}),keyBinding:"c"},{value:"crowfoot_one_or_many",text:M("labels.arrowhead_crowfoot_one_or_many"),icon:g(bfe,{flip:e}),keyBinding:"v"}];ue({name:"changeArrowhead",label:"Change arrowheads",trackEvent:!1,perform:(e,t,n)=>({elements:mr(e,t,i=>{if(xe(i)){const{position:r,type:s}=n;if(r==="start")return Ie(i,{startArrowhead:s});if(r==="end")return Ie(i,{endArrowhead:s})}return i}),appState:{...t,[n.position==="start"?"currentItemStartArrowhead":"currentItemEndArrowhead"]:n.type},captureUpdate:Z.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>{const r=vm().rtl;return N("fieldset",{children:[g("legend",{children:M("labels.arrowheads")}),N("div",{className:"iconSelectList buttonList",children:[g(Pk,{label:"arrowhead_start",options:zk(!r),value:pr(e,i,s=>xe(s)&&S6(s.type)?s.startArrowhead:t.currentItemStartArrowhead,!0,t.currentItemStartArrowhead),onChange:s=>n({position:"start",type:s}),numberOfOptionsToAlwaysShow:4}),g(Pk,{label:"arrowhead_end",group:"arrowheads",options:zk(!!r),value:pr(e,i,s=>xe(s)&&S6(s.type)?s.endArrowhead:t.currentItemEndArrowhead,!0,t.currentItemEndArrowhead),onChange:s=>n({position:"end",type:s}),numberOfOptionsToAlwaysShow:4})]})]})}});ue({name:"changeArrowProperties",label:"Change arrow properties",trackEvent:!1,perform:(e,t,n,i)=>!1,PanelComponent:({elements:e,appState:t,updateData:n,app:i,renderAction:r})=>N("div",{className:"selected-shape-actions",children:[r("changeArrowhead"),r("changeArrowType")]})});ue({name:"changeArrowType",label:"Change arrow types",trackEvent:!1,perform:(e,t,n,i)=>{var a;const r=mr(e,t,l=>{if(!Ce(l))return l;let c=Ie(l,{roundness:n===fi.round?{type:yn.PROPORTIONAL_RADIUS}:null,elbowed:n===fi.elbow,points:n===fi.elbow||l.elbowed?[l.points[0],l.points[l.points.length-1]]:l.points});if(me(c)){c.fixedSegments=null;const d=i.scene.getNonDeletedElementsMap();i.dismissLinearEditor();const u=pe.getPointAtIndexGlobalCoordinates(c,0,d),f=pe.getPointAtIndexGlobalCoordinates(c,-1,d),h=c.startBinding&&d.get(c.startBinding.elementId),m=c.endBinding&&d.get(c.endBinding.elementId),p=h&&c.startBinding?{...c.startBinding,...U6(c,h,"start",d)}:null,U=m&&c.endBinding?{...c.endBinding,...U6(c,m,"end",d)}:null;c={...c,startBinding:p,endBinding:U,..._g(c,d,{points:[u,f].map(b=>S(b[0]-c.x,b[1]-c.y)),startBinding:p,endBinding:U,fixedSegments:null})}}else{const d=i.scene.getNonDeletedElementsMap();if(c.startBinding){const u=d.get(c.startBinding.elementId);u&&na(c,u,"start",i.scene)}if(c.endBinding){const u=d.get(c.endBinding.elementId);u&&na(c,u,"end",i.scene)}}return c}),s={...t,currentItemArrowType:n},o=(a=t.selectedLinearElement)==null?void 0:a.elementId;if(o){const l=r.find(c=>c.id===o);l&&(s.selectedLinearElement=new pe(l,ve(e)))}return{elements:r,appState:s,captureUpdate:Z.IMMEDIATELY}},PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>N("fieldset",{children:[g("legend",{children:M("labels.arrowtypes")}),g("div",{className:"buttonList",children:g(da,{group:"arrowtypes",options:[{value:fi.sharp,text:M("labels.arrowtype_sharp"),icon:nT,testId:"sharp-arrow"},{value:fi.round,text:M("labels.arrowtype_round"),icon:rT,testId:"round-arrow"},{value:fi.elbow,text:M("labels.arrowtype_elbowed"),icon:iT,testId:"elbow-arrow"}],value:pr(e,i,r=>Ce(r)?r.elbowed?fi.elbow:r.roundness?fi.round:fi.sharp:null,r=>Ce(r),r=>r?null:t.currentItemArrowType),onChange:r=>n(r)})})]})});const J2e=H_.includes(devicePixelRatio)?devicePixelRatio:1,sa=()=>({showWelcomeScreen:!1,theme:ke.LIGHT,collaborators:new Map,currentChartType:"bar",currentItemBackgroundColor:mn.backgroundColor,currentItemEndArrowhead:"arrow",currentItemFillStyle:mn.fillStyle,currentItemFontFamily:sd,currentItemFontSize:Il,currentItemOpacity:mn.opacity,currentItemRoughness:mn.roughness,currentItemStartArrowhead:null,currentItemStrokeColor:mn.strokeColor,currentItemRoundness:"round",currentItemArrowType:fi.round,currentItemStrokeStyle:mn.strokeStyle,currentItemStrokeWidth:mn.strokeWidth,currentItemTextAlign:Up,currentHoveredFontFamily:null,cursorButton:"up",activeEmbeddable:null,newElement:null,editingTextElement:null,editingGroupId:null,activeTool:{type:"selection",customType:null,locked:mn.locked,fromSelection:!1,lastActiveTool:null},preferredSelectionTool:{type:"selection",initialized:!1},penMode:!1,penDetected:!1,errorMessage:null,exportBackground:!0,exportScale:J2e,exportEmbedScene:!1,exportWithDarkMode:!1,fileHandle:null,gridSize:qb,gridStep:yB,gridModeEnabled:!1,isBindingEnabled:!0,defaultSidebarDockedPreference:!1,isLoading:!1,isResizing:!1,isRotating:!1,lastPointerDownWith:"mouse",multiElement:null,name:null,contextMenu:null,openMenu:null,openPopup:null,openSidebar:null,openDialog:null,pasteDialog:{shown:!1,data:null},previousSelectedElementIds:{},resizingElement:null,scrolledOutside:!1,scrollX:0,scrollY:0,selectedElementIds:{},hoveredElementIds:{},selectedGroupIds:{},selectedElementsAreBeingDragged:!1,selectionElement:null,shouldCacheIgnoreZoom:!1,stats:{open:!1,panels:Gf.generalStats|Gf.elementProperties},startBoundElement:null,suggestedBindings:[],frameRendering:{enabled:!0,clip:!0,name:!0,outline:!0},frameToHighlight:null,editingFrame:null,elementsToHighlight:null,toast:null,viewBackgroundColor:Ye.white,zenModeEnabled:!1,zoom:{value:1},viewModeEnabled:!1,showHyperlinkPopup:!1,selectedLinearElement:null,snapLines:[],originSnapOffset:{x:0,y:0},objectsSnapModeEnabled:!1,userToFollow:null,followedBy:new Set,isCropping:!1,croppingElementId:null,searchMatches:null,lockedMultiSelections:{},activeLockedId:null}),ebe=(e=>e)({showWelcomeScreen:{browser:!0,export:!1,server:!1},theme:{browser:!0,export:!1,server:!1},collaborators:{browser:!1,export:!1,server:!1},currentChartType:{browser:!0,export:!1,server:!1},currentItemBackgroundColor:{browser:!0,export:!1,server:!1},currentItemEndArrowhead:{browser:!0,export:!1,server:!1},currentItemFillStyle:{browser:!0,export:!1,server:!1},currentItemFontFamily:{browser:!0,export:!1,server:!1},currentItemFontSize:{browser:!0,export:!1,server:!1},currentItemRoundness:{browser:!0,export:!1,server:!1},currentItemArrowType:{browser:!0,export:!1,server:!1},currentItemOpacity:{browser:!0,export:!1,server:!1},currentItemRoughness:{browser:!0,export:!1,server:!1},currentItemStartArrowhead:{browser:!0,export:!1,server:!1},currentItemStrokeColor:{browser:!0,export:!1,server:!1},currentItemStrokeStyle:{browser:!0,export:!1,server:!1},currentItemStrokeWidth:{browser:!0,export:!1,server:!1},currentItemTextAlign:{browser:!0,export:!1,server:!1},currentHoveredFontFamily:{browser:!1,export:!1,server:!1},cursorButton:{browser:!0,export:!1,server:!1},activeEmbeddable:{browser:!1,export:!1,server:!1},newElement:{browser:!1,export:!1,server:!1},editingTextElement:{browser:!1,export:!1,server:!1},editingGroupId:{browser:!0,export:!1,server:!1},activeTool:{browser:!0,export:!1,server:!1},preferredSelectionTool:{browser:!0,export:!1,server:!1},penMode:{browser:!0,export:!1,server:!1},penDetected:{browser:!0,export:!1,server:!1},errorMessage:{browser:!1,export:!1,server:!1},exportBackground:{browser:!0,export:!1,server:!1},exportEmbedScene:{browser:!0,export:!1,server:!1},exportScale:{browser:!0,export:!1,server:!1},exportWithDarkMode:{browser:!0,export:!1,server:!1},fileHandle:{browser:!1,export:!1,server:!1},gridSize:{browser:!0,export:!0,server:!0},gridStep:{browser:!0,export:!0,server:!0},gridModeEnabled:{browser:!0,export:!0,server:!0},height:{browser:!1,export:!1,server:!1},isBindingEnabled:{browser:!1,export:!1,server:!1},defaultSidebarDockedPreference:{browser:!0,export:!1,server:!1},isLoading:{browser:!1,export:!1,server:!1},isResizing:{browser:!1,export:!1,server:!1},isRotating:{browser:!1,export:!1,server:!1},lastPointerDownWith:{browser:!0,export:!1,server:!1},multiElement:{browser:!1,export:!1,server:!1},name:{browser:!0,export:!1,server:!1},offsetLeft:{browser:!1,export:!1,server:!1},offsetTop:{browser:!1,export:!1,server:!1},contextMenu:{browser:!1,export:!1,server:!1},openMenu:{browser:!0,export:!1,server:!1},openPopup:{browser:!1,export:!1,server:!1},openSidebar:{browser:!0,export:!1,server:!1},openDialog:{browser:!1,export:!1,server:!1},pasteDialog:{browser:!1,export:!1,server:!1},previousSelectedElementIds:{browser:!0,export:!1,server:!1},resizingElement:{browser:!1,export:!1,server:!1},scrolledOutside:{browser:!0,export:!1,server:!1},scrollX:{browser:!0,export:!1,server:!1},scrollY:{browser:!0,export:!1,server:!1},selectedElementIds:{browser:!0,export:!1,server:!1},hoveredElementIds:{browser:!1,export:!1,server:!1},selectedGroupIds:{browser:!0,export:!1,server:!1},selectedElementsAreBeingDragged:{browser:!1,export:!1,server:!1},selectionElement:{browser:!1,export:!1,server:!1},shouldCacheIgnoreZoom:{browser:!0,export:!1,server:!1},stats:{browser:!0,export:!1,server:!1},startBoundElement:{browser:!1,export:!1,server:!1},suggestedBindings:{browser:!1,export:!1,server:!1},frameRendering:{browser:!1,export:!1,server:!1},frameToHighlight:{browser:!1,export:!1,server:!1},editingFrame:{browser:!1,export:!1,server:!1},elementsToHighlight:{browser:!1,export:!1,server:!1},toast:{browser:!1,export:!1,server:!1},viewBackgroundColor:{browser:!0,export:!0,server:!0},width:{browser:!1,export:!1,server:!1},zenModeEnabled:{browser:!0,export:!1,server:!1},zoom:{browser:!0,export:!1,server:!1},viewModeEnabled:{browser:!1,export:!1,server:!1},showHyperlinkPopup:{browser:!1,export:!1,server:!1},selectedLinearElement:{browser:!0,export:!1,server:!1},snapLines:{browser:!1,export:!1,server:!1},originSnapOffset:{browser:!1,export:!1,server:!1},objectsSnapModeEnabled:{browser:!0,export:!1,server:!1},userToFollow:{browser:!1,export:!1,server:!1},followedBy:{browser:!1,export:!1,server:!1},isCropping:{browser:!1,export:!1,server:!1},croppingElementId:{browser:!1,export:!1,server:!1},searchMatches:{browser:!1,export:!1,server:!1},lockedMultiSelections:{browser:!0,export:!0,server:!0},activeLockedId:{browser:!1,export:!1,server:!1}}),xT=(e,t)=>{const n={};for(const i of Object.keys(e)){const r=ebe[i];if(r!=null&&r[t]){const s=e[i];n[i]=s}}return n},lG=e=>xT(e,"browser"),cG=e=>xT(e,"export"),tbe=e=>xT(e,"server"),ko=({activeTool:e})=>e.type==="eraser",Qh=({activeTool:e})=>e.type==="hand",k0=()=>{const e=document.querySelector(".excalidraw-tooltip");if(e)return e;const t=document.createElement("div");return document.body.appendChild(t),t.classList.add("excalidraw-tooltip"),t},dG=(e,t,n="bottom")=>{const i=e.getBoundingClientRect(),r=window.innerWidth,s=window.innerHeight,o=5;let a=t.left+t.width/2-i.width/2;a<0?a=o:a+i.width>=r&&(a=r-i.width-o);let l;n==="bottom"?(l=t.top+t.height+o,l+i.height>=s&&(l=t.top-i.height-o)):(l=t.top-i.height-o,l<0&&(l=t.top+t.height+o)),Object.assign(e.style,{top:`${l}px`,left:`${a}px`})},nbe=(e,t,n,i)=>{t.classList.add("excalidraw-tooltip--visible"),t.style.minWidth=i?"50ch":"10ch",t.style.maxWidth=i?"50ch":"15ch",t.textContent=n;const r=e.getBoundingClientRect();dG(t,r)},Ul=({children:e,label:t,long:n=!1,style:i,disabled:r})=>(R.useEffect(()=>()=>k0().classList.remove("excalidraw-tooltip--visible"),[]),r?null:g("div",{className:"excalidraw-tooltip-wrapper",onPointerEnter:s=>nbe(s.currentTarget,k0(),t,n),onPointerLeave:()=>k0().classList.remove("excalidraw-tooltip--visible"),style:i,children:e})),uG='<svg viewBox="0 0 24 24" stroke-width="1" width="28" height="28" xmlns="http://www.w3.org/2000/svg">',ibe='<path d="M6.164 11.755a5.314 5.314 0 0 1-4.932-5.298 5.314 5.314 0 0 1 5.311-5.311 5.314 5.314 0 0 1 5.307 5.113l8.773 8.773a3.322 3.322 0 0 1 0 4.696l-.895.895a3.322 3.322 0 0 1-4.696 0l-8.868-8.868Z" style="fill:#fff"/>',fG='<path stroke="#1b1b1f" fill="#fff" d="m7.868 11.113 7.773 7.774a2.359 2.359 0 0 0 1.667.691 2.368 2.368 0 0 0 2.357-2.358c0-.625-.248-1.225-.69-1.667L11.201 7.78 9.558 9.469l-1.69 1.643v.001Zm10.273 3.606-3.333 3.333m-3.25-6.583 2 2m-7-7 3 3M3.664 3.625l1 1M2.529 6.922l1.407-.144m5.735-2.932-1.118.866M4.285 9.823l.758-1.194m1.863-6.207-.13 1.408"/>',rbe=`data:${Te.svg},${encodeURIComponent(`${uG}${fG}</svg>`)}`,sbe=`data:${Te.svg},${encodeURIComponent(`${uG}${ibe}${fG}</svg>`)}`,Io=e=>{e&&(e.style.cursor="")},Lt=(e,t)=>{e&&(e.style.cursor=t)};let vo,Hk;const hG=(e,t)=>{const i=()=>{const r=t===ke.DARK;vo=document.createElement("canvas"),vo.theme=t,vo.height=20,vo.width=20;const s=vo.getContext("2d");s.lineWidth=1,s.beginPath(),s.arc(vo.width/2,vo.height/2,5,0,2*Math.PI),s.fillStyle=r?yi.black:yi.white,s.fill(),s.strokeStyle=r?yi.white:yi.black,s.stroke(),Hk=vo.toDataURL(Te.svg)};(!vo||vo.theme!==t)&&i(),Lt(e,`url(${Hk}) ${20/2} ${20/2}, auto`)},So=(e,t)=>{if(e)if(t.activeTool.type==="selection")Io(e);else if(Qh(t))e.style.cursor=Ct.GRAB;else if(ko(t))hG(e,t.theme);else if(t.activeTool.type==="laser"){const n=t.theme===ke.LIGHT?rbe:sbe;e.style.cursor=`url(${n}), auto`}else["image","custom"].includes(t.activeTool.type)?t.activeTool.type!=="image"&&(e.style.cursor=Ct.AUTO):e.style.cursor=Ct.CROSSHAIR},Bd=({viewportX:e,viewportY:t,nextZoom:n},i)=>{const r=e-i.offsetLeft,s=t-i.offsetTop,o=i.zoom.value,a=i.scrollX+(r-r/o),l=i.scrollY+(s-s/o),c=-(r-r/n),d=-(s-s/n);return{scrollX:a+c,scrollY:l+d,zoom:{value:n}}};ue({name:"changeViewBackgroundColor",label:"labels.canvasBackground",trackEvent:!1,predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.changeViewBackgroundColor&&!t.viewModeEnabled,perform:(e,t,n)=>({appState:{...t,...n},captureUpdate:n.viewBackgroundColor?Z.IMMEDIATELY:Z.EVENTUALLY}),PanelComponent:({elements:e,appState:t,updateData:n,appProps:i,data:r})=>g(_T,{palette:null,topPicks:uB,label:M("labels.canvasBackground"),type:"canvasBackground",color:t.viewBackgroundColor,onChange:s=>n({viewBackgroundColor:s}),"data-testid":"canvas-background-picker",elements:e,appState:t,updateData:n})});const R0=ue({name:"clearCanvas",label:"labels.clearCanvas",icon:Xc,trackEvent:{category:"canvas"},predicate:(e,t,n,i)=>{var r;return!!i.props.UIOptions.canvasActions.clearCanvas&&!t.viewModeEnabled&&((r=t.openDialog)==null?void 0:r.name)!=="elementLinkSelector"},perform:(e,t,n,i)=>(i.imageCache.clear(),{elements:e.map(r=>Ie(r,{isDeleted:!0})),appState:{...sa(),files:{},theme:t.theme,penMode:t.penMode,penDetected:t.penDetected,exportBackground:t.exportBackground,exportEmbedScene:t.exportEmbedScene,gridSize:t.gridSize,gridStep:t.gridStep,gridModeEnabled:t.gridModeEnabled,stats:t.stats,pasteDialog:t.pasteDialog,activeTool:t.activeTool.type==="image"?{...t.activeTool,type:i.state.preferredSelectionTool.type}:t.activeTool},captureUpdate:Z.IMMEDIATELY})}),Vk=ue({name:"zoomIn",label:"buttons.zoomIn",viewMode:!0,icon:YM,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>({appState:{...t,...Bd({viewportX:t.width/2+t.offsetLeft,viewportY:t.height/2+t.offsetTop,nextZoom:Xa(t.zoom.value+J5)},t),userToFollow:null},captureUpdate:Z.EVENTUALLY}),PanelComponent:({updateData:e,appState:t})=>g(je,{type:"button",className:"zoom-in-button zoom-button",icon:YM,title:`${M("buttons.zoomIn")}  ${J("CtrlOrCmd++")}`,"aria-label":M("buttons.zoomIn"),disabled:t.zoom.value>=B_,onClick:()=>{e(null)}}),keyTest:e=>(e.code===it.EQUAL||e.code===it.NUM_ADD)&&(e[V.CTRL_OR_CMD]||e.shiftKey)}),$k=ue({name:"zoomOut",label:"buttons.zoomOut",icon:WM,viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>({appState:{...t,...Bd({viewportX:t.width/2+t.offsetLeft,viewportY:t.height/2+t.offsetTop,nextZoom:Xa(t.zoom.value-J5)},t),userToFollow:null},captureUpdate:Z.EVENTUALLY}),PanelComponent:({updateData:e,appState:t})=>g(je,{type:"button",className:"zoom-out-button zoom-button",icon:WM,title:`${M("buttons.zoomOut")}  ${J("CtrlOrCmd+-")}`,"aria-label":M("buttons.zoomOut"),disabled:t.zoom.value<=F_,onClick:()=>{e(null)}}),keyTest:e=>(e.code===it.MINUS||e.code===it.NUM_SUBTRACT)&&(e[V.CTRL_OR_CMD]||e.shiftKey)}),Gk=ue({name:"resetZoom",label:"buttons.resetZoom",icon:Rue,viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>({appState:{...t,...Bd({viewportX:t.width/2+t.offsetLeft,viewportY:t.height/2+t.offsetTop,nextZoom:Xa(1)},t),userToFollow:null},captureUpdate:Z.EVENTUALLY}),PanelComponent:({updateData:e,appState:t})=>g(Ul,{label:M("buttons.resetZoom"),style:{height:"100%"},children:N(je,{type:"button",className:"reset-zoom-button zoom-button",title:M("buttons.resetZoom"),"aria-label":M("buttons.resetZoom"),onClick:()=>{e(null)},children:[(t.zoom.value*100).toFixed(0),"%"]})}),keyTest:e=>(e.code===it.ZERO||e.code===it.NUM_ZERO)&&(e[V.CTRL_OR_CMD]||e.shiftKey)}),obe=(e,t,n=1)=>{const[i,r,s,o]=e,a=s-i,l=t.width/a,c=o-r,d=t.height/c,f=Math.min(l,d)*Ze(n,.1,1);return Math.min(f,1)},gG=({bounds:e,appState:t,canvasOffsets:n,fitToViewport:i=!1,viewportZoomFactor:r=1,minZoom:s=-1/0,maxZoom:o=1/0})=>{r=Ze(r,F_,B_);const[a,l,c,d]=e,u=(a+c)/2,f=(l+d)/2,h=(n==null?void 0:n.left)??0,m=(n==null?void 0:n.top)??0,p=(n==null?void 0:n.right)??0,U=(n==null?void 0:n.bottom)??0,b=t.width-h-p,y=t.height-m-U;let w;if(i){const C=c-a,_=d-l;w=Math.min(b/C,y/_)*r}else w=obe(e,{width:b,height:y},r);const v=Xa(Ze(_se(w,J5,"floor"),s,o)),I=MV({scenePoint:{x:u,y:f},viewportDimensions:{width:t.width,height:t.height},offsets:n,zoom:{value:v}});return{appState:{...t,scrollX:I.scrollX,scrollY:I.scrollY,zoom:{value:v}},captureUpdate:Z.EVENTUALLY}},Ly=({canvasOffsets:e,targetElements:t,appState:n,fitToViewport:i,viewportZoomFactor:r,minZoom:s,maxZoom:o})=>{const a=ht(Yt(t));return gG({canvasOffsets:e,bounds:a,appState:n,fitToViewport:i,viewportZoomFactor:r,minZoom:s,maxZoom:o})};ue({name:"zoomToFitSelectionInViewport",label:"labels.zoomToFitViewport",icon:tT,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>{const r=i.scene.getSelectedElements(t);return Ly({targetElements:r.length?r:e,appState:{...t,userToFollow:null},fitToViewport:!1,canvasOffsets:i.getEditorUIOffsets()})},keyTest:e=>e.code===it.TWO&&e.shiftKey&&!e.altKey&&!e[V.CTRL_OR_CMD]});ue({name:"zoomToFitSelection",label:"helpDialog.zoomToSelection",icon:tT,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>{const r=i.scene.getSelectedElements(t);return Ly({targetElements:r.length?r:e,appState:{...t,userToFollow:null},fitToViewport:!0,canvasOffsets:i.getEditorUIOffsets()})},keyTest:e=>e.code===it.THREE&&e.shiftKey&&!e.altKey&&!e[V.CTRL_OR_CMD]});ue({name:"zoomToFit",label:"helpDialog.zoomToFit",icon:tT,viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>Ly({targetElements:e,appState:{...t,userToFollow:null},fitToViewport:!1,canvasOffsets:i.getEditorUIOffsets()}),keyTest:e=>e.code===it.ONE&&e.shiftKey&&!e.altKey&&!e[V.CTRL_OR_CMD]});const $6=ue({name:"toggleTheme",label:(e,t)=>t.theme===ke.DARK?"buttons.lightMode":"buttons.darkMode",keywords:["toggle","dark","light","mode","theme"],icon:e=>e.theme===ke.LIGHT?sv:ov,viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t,n)=>({appState:{...t,theme:n||(t.theme===ke.LIGHT?ke.DARK:ke.LIGHT)},captureUpdate:Z.EVENTUALLY}),keyTest:e=>e.altKey&&e.shiftKey&&e.code===it.D,predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.toggleTheme});ue({name:"toggleEraserTool",label:"toolBar.eraser",trackEvent:{category:"toolbar"},perform:(e,t,n,i)=>{let r;return ko(t)?r=tn(t,{...t.activeTool.lastActiveTool||{type:i.state.preferredSelectionTool.type},lastActiveToolBeforeEraser:null}):r=tn(t,{type:"eraser",lastActiveToolBeforeEraser:t.activeTool}),{appState:{...t,selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null,activeTool:r},captureUpdate:Z.IMMEDIATELY}},keyTest:e=>e.key===V.E});ue({name:"toggleLassoTool",label:"toolBar.lasso",icon:M0,trackEvent:{category:"toolbar"},predicate:(e,t,n,i)=>i.state.preferredSelectionTool.type!=="lasso",perform:(e,t,n,i)=>{let r;return t.activeTool.type!=="lasso"?(r=tn(t,{type:"lasso",fromSelection:!1}),Lt(i.interactiveCanvas,Ct.CROSSHAIR)):r=tn(t,{type:"selection"}),{appState:{...t,selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null,activeTool:r},captureUpdate:Z.NEVER}}});const abe=ue({name:"toggleHandTool",label:"toolBar.hand",trackEvent:{category:"toolbar"},icon:GV,viewMode:!1,perform:(e,t,n,i)=>{let r;return Qh(t)?r=tn(t,{...t.activeTool.lastActiveTool||{type:"selection"},lastActiveToolBeforeEraser:null}):(r=tn(t,{type:"hand",lastActiveToolBeforeEraser:t.activeTool}),Lt(i.interactiveCanvas,Ct.GRAB)),{appState:{...t,selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null,activeTool:r},captureUpdate:Z.IMMEDIATELY}},keyTest:e=>!e.altKey&&!e[V.CTRL_OR_CMD]&&e.key===V.H});ue({name:"setEmbeddableAsActiveTool",trackEvent:{category:"toolbar"},target:"Tool",label:"toolBar.embeddable",perform:(e,t,n,i)=>{const r=tn(t,{type:"embeddable"});return So(i.canvas,{...t,activeTool:r}),{elements:e,appState:{...t,activeTool:tn(t,{type:"embeddable"})},captureUpdate:Z.EVENTUALLY}}});const Vs=ue({name:"finalize",label:"",trackEvent:!1,perform:(e,t,n,i)=>{var h,m;const{interactiveCanvas:r,focusContainer:s,scene:o}=i,{event:a,sceneCoords:l}=n??{},c=o.getNonDeletedElementsMap();if(a&&t.selectedLinearElement){const p=pe.handlePointerUp(a,t.selectedLinearElement,t,i.scene),{startBindingElement:U,endBindingElement:b}=p,y=i.scene.getElement(p.elementId);if(Ga(y)&&m6(y,U,b,i.scene),p!==t.selectedLinearElement){let w=e;return y&&tl(y)&&(w=w.map(v=>v.id===y.id?Ie(v,{isDeleted:!0}):v)),{elements:w,appState:{selectedLinearElement:{...p,selectedPointsIndices:null},suggestedBindings:[]},captureUpdate:Z.IMMEDIATELY}}}if((h=t.selectedLinearElement)!=null&&h.isEditing){const{elementId:p,startBindingElement:U,endBindingElement:b}=t.selectedLinearElement,y=pe.getElement(p,c);if(y)return Ga(y)&&m6(y,U,b,o),nn(y)&&!L4(y.points)&&o.mutateElement(y,{polygon:!1}),{elements:y.points.length<2||tl(y)?e.map(w=>w.id===y.id?Ie(w,{isDeleted:!0}):w):void 0,appState:{...t,cursorButton:"up",selectedLinearElement:new pe(y,ve(c),!1)},captureUpdate:Z.IMMEDIATELY}}let d=e;window.document.activeElement instanceof HTMLElement&&s();let u=null;if(t.multiElement)u=t.multiElement;else if(((m=t.newElement)==null?void 0:m.type)==="freedraw"||Ga(t.newElement))u=t.newElement;else if(Object.keys(t.selectedElementIds).length===1){const p=c.get(Object.keys(t.selectedElementIds)[0]);p&&(u=p)}if(u){if(t.multiElement&&u.type!=="freedraw"){const{points:p,lastCommittedPoint:U}=u;(!U||p[p.length-1]!==U)&&o.mutateElement(u,{points:u.points.slice(0,-1)})}if(u&&tl(u)&&(d=d.map(p=>p.id===(u==null?void 0:u.id)?Ie(p,{isDeleted:!0}):p)),xe(u)||qi(u)){const p=Jo(u.points,t.zoom.value);if(p&&(nn(u)||qi(u))){const U=u.points,b=U[0],y=U.map((w,v)=>v===U.length-1?S(b[0],b[1]):w);nn(u)?o.mutateElement(u,{points:y,polygon:!0}):o.mutateElement(u,{points:y})}if(nn(u)&&!L4(u.points)&&o.mutateElement(u,{polygon:!1}),Ga(u)&&!p&&u.points.length>1&&tu(t)){const U=l??qa(pe.getPointAtIndexGlobalCoordinates(u,-1,ve(e)));Ule(u,t,U,o)}}}(!t.activeTool.locked&&t.activeTool.type!=="freedraw"||!u)&&Io(r);let f;return t.activeTool.type==="eraser"?f=tn(t,{...t.activeTool.lastActiveTool||{type:i.state.preferredSelectionTool.type},lastActiveToolBeforeEraser:null}):f=tn(t,{type:i.state.preferredSelectionTool.type}),{elements:d,appState:{...t,cursorButton:"up",activeTool:(t.activeTool.locked||t.activeTool.type==="freedraw")&&u?t.activeTool:f,activeEmbeddable:null,newElement:null,selectionElement:null,multiElement:null,editingTextElement:null,startBoundElement:null,suggestedBindings:[],selectedElementIds:u&&!t.activeTool.locked&&t.activeTool.type!=="freedraw"?{...t.selectedElementIds,[u.id]:!0}:t.selectedElementIds,selectedLinearElement:u&&xe(u)?new pe(u,ve(d)):t.selectedLinearElement},captureUpdate:Z.IMMEDIATELY}},keyTest:(e,t)=>{var n;return e.key===V.ESCAPE&&(((n=t.selectedLinearElement)==null?void 0:n.isEditing)||!t.newElement&&t.multiElement===null)||(e.key===V.ESCAPE||e.key===V.ENTER)&&t.multiElement!==null},PanelComponent:({appState:e,updateData:t,data:n})=>g(je,{type:"button",icon:zue,title:M("buttons.done"),"aria-label":M("buttons.done"),onClick:t,visible:e.multiElement!=null,size:(n==null?void 0:n.size)||"medium",style:{pointerEvents:"all"}})}),CT=({children:e,checked:t,onChange:n,className:i})=>N("div",{className:le("Checkbox",i,{"is-checked":t}),onClick:r=>{n(!t,r),r.currentTarget.querySelector(".Checkbox-box").focus()},children:[g("button",{type:"button",className:"Checkbox-box",role:"checkbox","aria-checked":t,children:Nue}),g("div",{className:"Checkbox-label",children:e})]}),lbe=e=>{const t=e.title||(e.value===ke.DARK?M("buttons.lightMode"):M("buttons.darkMode"));return g(je,{type:"icon",icon:e.value===ke.LIGHT?Xk.MOON:Xk.SUN,title:t,"aria-label":t,onClick:()=>e.onChange(e.value===ke.DARK?ke.LIGHT:ke.DARK),"data-testid":"toggle-dark-mode"})},Xk={SUN:g("svg",{width:"512",height:"512",className:"rtl-mirror",viewBox:"0 0 512 512",children:g("path",{fill:"currentColor",d:"M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"})}),MOON:g("svg",{width:"512",height:"512",className:"rtl-mirror",viewBox:"0 0 512 512",children:g("path",{fill:"currentColor",d:"M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"})})},cbe=e=>{const{id:t}=Dr(),[n,i]=R.useState(e.value),r=o=>{e.ignoreFocus||Jse(o.target);const a=o.target.value;a!==e.value&&e.onChange(a)},s=o=>{if(o.key===V.ENTER){if(o.preventDefault(),o.nativeEvent.isComposing||o.keyCode===229)return;o.currentTarget.blur()}};return N("div",{className:"ProjectName",children:[g("label",{className:"ProjectName-label",htmlFor:"filename",children:`${e.label}:`}),g("input",{type:"text",className:"TextInput",onBlur:r,onKeyDown:s,id:`${t}-filename`,value:n,onChange:o=>i(o.target.value)})]})};/*! pako 2.0.3 https://github.com/nodeca/pako @license (MIT AND Zlib) */const dbe=4,jk=0,Yk=1,ube=2;function Rg(e){let t=e.length;for(;--t>=0;)e[t]=0}const fbe=0,mG=1,hbe=2,gbe=3,mbe=258,AT=29,Bp=256,xm=Bp+1+AT,Eh=30,MT=19,pG=2*xm+1,zd=15,f3=16,pbe=7,kT=256,UG=16,bG=17,yG=18,vv=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Q2=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Ube=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),EG=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),bbe=512,xa=new Array((xm+2)*2);Rg(xa);const D0=new Array(Eh*2);Rg(D0);const Cm=new Array(bbe);Rg(Cm);const Am=new Array(mbe-gbe+1);Rg(Am);const RT=new Array(AT);Rg(RT);const G6=new Array(Eh);Rg(G6);function h3(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}let vG,wG,_G;function g3(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const TG=e=>e<256?Cm[e]:Cm[256+(e>>>7)],Mm=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},Sr=(e,t,n)=>{e.bi_valid>f3-n?(e.bi_buf|=t<<e.bi_valid&65535,Mm(e,e.bi_buf),e.bi_buf=t>>f3-e.bi_valid,e.bi_valid+=n-f3):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},Oo=(e,t,n)=>{Sr(e,n[t*2],n[t*2+1])},IG=(e,t)=>{let n=0;do n|=e&1,e>>>=1,n<<=1;while(--t>0);return n>>>1},ybe=e=>{e.bi_valid===16?(Mm(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},Ebe=(e,t)=>{const n=t.dyn_tree,i=t.max_code,r=t.stat_desc.static_tree,s=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,l=t.stat_desc.max_length;let c,d,u,f,h,m,p=0;for(f=0;f<=zd;f++)e.bl_count[f]=0;for(n[e.heap[e.heap_max]*2+1]=0,c=e.heap_max+1;c<pG;c++)d=e.heap[c],f=n[n[d*2+1]*2+1]+1,f>l&&(f=l,p++),n[d*2+1]=f,!(d>i)&&(e.bl_count[f]++,h=0,d>=a&&(h=o[d-a]),m=n[d*2],e.opt_len+=m*(f+h),s&&(e.static_len+=m*(r[d*2+1]+h)));if(p!==0){do{for(f=l-1;e.bl_count[f]===0;)f--;e.bl_count[f]--,e.bl_count[f+1]+=2,e.bl_count[l]--,p-=2}while(p>0);for(f=l;f!==0;f--)for(d=e.bl_count[f];d!==0;)u=e.heap[--c],!(u>i)&&(n[u*2+1]!==f&&(e.opt_len+=(f-n[u*2+1])*n[u*2],n[u*2+1]=f),d--)}},SG=(e,t,n)=>{const i=new Array(zd+1);let r=0,s,o;for(s=1;s<=zd;s++)i[s]=r=r+n[s-1]<<1;for(o=0;o<=t;o++){let a=e[o*2+1];a!==0&&(e[o*2]=IG(i[a]++,a))}},vbe=()=>{let e,t,n,i,r;const s=new Array(zd+1);for(n=0,i=0;i<AT-1;i++)for(RT[i]=n,e=0;e<1<<vv[i];e++)Am[n++]=i;for(Am[n-1]=i,r=0,i=0;i<16;i++)for(G6[i]=r,e=0;e<1<<Q2[i];e++)Cm[r++]=i;for(r>>=7;i<Eh;i++)for(G6[i]=r<<7,e=0;e<1<<Q2[i]-7;e++)Cm[256+r++]=i;for(t=0;t<=zd;t++)s[t]=0;for(e=0;e<=143;)xa[e*2+1]=8,e++,s[8]++;for(;e<=255;)xa[e*2+1]=9,e++,s[9]++;for(;e<=279;)xa[e*2+1]=7,e++,s[7]++;for(;e<=287;)xa[e*2+1]=8,e++,s[8]++;for(SG(xa,xm+1,s),e=0;e<Eh;e++)D0[e*2+1]=5,D0[e*2]=IG(e,5);vG=new h3(xa,vv,Bp+1,xm,zd),wG=new h3(D0,Q2,0,Eh,zd),_G=new h3(new Array(0),Ube,0,MT,pbe)},xG=e=>{let t;for(t=0;t<xm;t++)e.dyn_ltree[t*2]=0;for(t=0;t<Eh;t++)e.dyn_dtree[t*2]=0;for(t=0;t<MT;t++)e.bl_tree[t*2]=0;e.dyn_ltree[kT*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},CG=e=>{e.bi_valid>8?Mm(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},wbe=(e,t,n,i)=>{CG(e),Mm(e,n),Mm(e,~n),e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n},Wk=(e,t,n,i)=>{const r=t*2,s=n*2;return e[r]<e[s]||e[r]===e[s]&&i[t]<=i[n]},m3=(e,t,n)=>{const i=e.heap[n];let r=n<<1;for(;r<=e.heap_len&&(r<e.heap_len&&Wk(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!Wk(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i},Kk=(e,t,n)=>{let i,r,s=0,o,a;if(e.last_lit!==0)do i=e.pending_buf[e.d_buf+s*2]<<8|e.pending_buf[e.d_buf+s*2+1],r=e.pending_buf[e.l_buf+s],s++,i===0?Oo(e,r,t):(o=Am[r],Oo(e,o+Bp+1,t),a=vv[o],a!==0&&(r-=RT[o],Sr(e,r,a)),i--,o=TG(i),Oo(e,o,n),a=Q2[o],a!==0&&(i-=G6[o],Sr(e,i,a)));while(s<e.last_lit);Oo(e,kT,t)},wv=(e,t)=>{const n=t.dyn_tree,i=t.stat_desc.static_tree,r=t.stat_desc.has_stree,s=t.stat_desc.elems;let o,a,l=-1,c;for(e.heap_len=0,e.heap_max=pG,o=0;o<s;o++)n[o*2]!==0?(e.heap[++e.heap_len]=l=o,e.depth[o]=0):n[o*2+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=l<2?++l:0,n[c*2]=1,e.depth[c]=0,e.opt_len--,r&&(e.static_len-=i[c*2+1]);for(t.max_code=l,o=e.heap_len>>1;o>=1;o--)m3(e,n,o);c=s;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],m3(e,n,1),a=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=a,n[c*2]=n[o*2]+n[a*2],e.depth[c]=(e.depth[o]>=e.depth[a]?e.depth[o]:e.depth[a])+1,n[o*2+1]=n[a*2+1]=c,e.heap[1]=c++,m3(e,n,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],Ebe(e,t),SG(n,l,e.bl_count)},Zk=(e,t,n)=>{let i,r=-1,s,o=t[0*2+1],a=0,l=7,c=4;for(o===0&&(l=138,c=3),t[(n+1)*2+1]=65535,i=0;i<=n;i++)s=o,o=t[(i+1)*2+1],!(++a<l&&s===o)&&(a<c?e.bl_tree[s*2]+=a:s!==0?(s!==r&&e.bl_tree[s*2]++,e.bl_tree[UG*2]++):a<=10?e.bl_tree[bG*2]++:e.bl_tree[yG*2]++,a=0,r=s,o===0?(l=138,c=3):s===o?(l=6,c=3):(l=7,c=4))},qk=(e,t,n)=>{let i,r=-1,s,o=t[0*2+1],a=0,l=7,c=4;for(o===0&&(l=138,c=3),i=0;i<=n;i++)if(s=o,o=t[(i+1)*2+1],!(++a<l&&s===o)){if(a<c)do Oo(e,s,e.bl_tree);while(--a!==0);else s!==0?(s!==r&&(Oo(e,s,e.bl_tree),a--),Oo(e,UG,e.bl_tree),Sr(e,a-3,2)):a<=10?(Oo(e,bG,e.bl_tree),Sr(e,a-3,3)):(Oo(e,yG,e.bl_tree),Sr(e,a-11,7));a=0,r=s,o===0?(l=138,c=3):s===o?(l=6,c=3):(l=7,c=4)}},_be=e=>{let t;for(Zk(e,e.dyn_ltree,e.l_desc.max_code),Zk(e,e.dyn_dtree,e.d_desc.max_code),wv(e,e.bl_desc),t=MT-1;t>=3&&e.bl_tree[EG[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},Tbe=(e,t,n,i)=>{let r;for(Sr(e,t-257,5),Sr(e,n-1,5),Sr(e,i-4,4),r=0;r<i;r++)Sr(e,e.bl_tree[EG[r]*2+1],3);qk(e,e.dyn_ltree,t-1),qk(e,e.dyn_dtree,n-1)},Ibe=e=>{let t=4093624447,n;for(n=0;n<=31;n++,t>>>=1)if(t&1&&e.dyn_ltree[n*2]!==0)return jk;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Yk;for(n=32;n<Bp;n++)if(e.dyn_ltree[n*2]!==0)return Yk;return jk};let Qk=!1;const Sbe=e=>{Qk||(vbe(),Qk=!0),e.l_desc=new g3(e.dyn_ltree,vG),e.d_desc=new g3(e.dyn_dtree,wG),e.bl_desc=new g3(e.bl_tree,_G),e.bi_buf=0,e.bi_valid=0,xG(e)},AG=(e,t,n,i)=>{Sr(e,(fbe<<1)+(i?1:0),3),wbe(e,t,n)},xbe=e=>{Sr(e,mG<<1,3),Oo(e,kT,xa),ybe(e)},Cbe=(e,t,n,i)=>{let r,s,o=0;e.level>0?(e.strm.data_type===ube&&(e.strm.data_type=Ibe(e)),wv(e,e.l_desc),wv(e,e.d_desc),o=_be(e),r=e.opt_len+3+7>>>3,s=e.static_len+3+7>>>3,s<=r&&(r=s)):r=s=n+5,n+4<=r&&t!==-1?AG(e,t,n,i):e.strategy===dbe||s===r?(Sr(e,(mG<<1)+(i?1:0),3),Kk(e,xa,D0)):(Sr(e,(hbe<<1)+(i?1:0),3),Tbe(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),Kk(e,e.dyn_ltree,e.dyn_dtree)),xG(e),i&&CG(e)},Abe=(e,t,n)=>(e.pending_buf[e.d_buf+e.last_lit*2]=t>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=t&255,e.pending_buf[e.l_buf+e.last_lit]=n&255,e.last_lit++,t===0?e.dyn_ltree[n*2]++:(e.matches++,t--,e.dyn_ltree[(Am[n]+Bp+1)*2]++,e.dyn_dtree[TG(t)*2]++),e.last_lit===e.lit_bufsize-1);var Mbe=Sbe,kbe=AG,Rbe=Cbe,Dbe=Abe,Lbe=xbe,Nbe={_tr_init:Mbe,_tr_stored_block:kbe,_tr_flush_block:Rbe,_tr_tally:Dbe,_tr_align:Lbe};const Obe=(e,t,n,i)=>{let r=e&65535|0,s=e>>>16&65535|0,o=0;for(;n!==0;){o=n>2e3?2e3:n,n-=o;do r=r+t[i++]|0,s=s+r|0;while(--o);r%=65521,s%=65521}return r|s<<16|0};var km=Obe;const Pbe=()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t},Fbe=new Uint32Array(Pbe()),Bbe=(e,t,n,i)=>{const r=Fbe,s=i+n;e^=-1;for(let o=i;o<s;o++)e=e>>>8^r[(e^t[o])&255];return e^-1};var ui=Bbe,_u={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Ny={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:zbe,_tr_stored_block:Hbe,_tr_flush_block:Vbe,_tr_tally:Ic,_tr_align:$be}=Nbe,{Z_NO_FLUSH:Yu,Z_PARTIAL_FLUSH:Gbe,Z_FULL_FLUSH:Xbe,Z_FINISH:Sc,Z_BLOCK:Jk,Z_OK:Po,Z_STREAM_END:eR,Z_STREAM_ERROR:ks,Z_DATA_ERROR:jbe,Z_BUF_ERROR:p3,Z_DEFAULT_COMPRESSION:Ybe,Z_FILTERED:Wbe,Z_HUFFMAN_ONLY:JU,Z_RLE:Kbe,Z_FIXED:Zbe,Z_DEFAULT_STRATEGY:qbe,Z_UNKNOWN:Qbe,Z_DEFLATED:Oy}=Ny,Jbe=9,e6e=15,t6e=8,n6e=29,i6e=256,_v=i6e+1+n6e,r6e=30,s6e=19,o6e=2*_v+1,a6e=15,lt=3,cc=258,ao=cc+lt+1,l6e=32,Py=42,Tv=69,J2=73,eb=91,tb=103,Hd=113,G1=666,ti=1,zp=2,Tu=3,Dg=4,c6e=3,dc=(e,t)=>(e.msg=_u[t],t),tR=e=>(e<<1)-(e>4?9:0),rc=e=>{let t=e.length;for(;--t>=0;)e[t]=0};let d6e=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask,xc=d6e;const Gl=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),n!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,t.pending===0&&(t.pending_out=0))},Ri=(e,t)=>{Vbe(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Gl(e.strm)},_t=(e,t)=>{e.pending_buf[e.pending++]=t},b1=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},u6e=(e,t,n,i)=>{let r=e.avail_in;return r>i&&(r=i),r===0?0:(e.avail_in-=r,t.set(e.input.subarray(e.next_in,e.next_in+r),n),e.state.wrap===1?e.adler=km(e.adler,t,r,n):e.state.wrap===2&&(e.adler=ui(e.adler,t,r,n)),e.next_in+=r,e.total_in+=r,r)},MG=(e,t)=>{let n=e.max_chain_length,i=e.strstart,r,s,o=e.prev_length,a=e.nice_match;const l=e.strstart>e.w_size-ao?e.strstart-(e.w_size-ao):0,c=e.window,d=e.w_mask,u=e.prev,f=e.strstart+cc;let h=c[i+o-1],m=c[i+o];e.prev_length>=e.good_match&&(n>>=2),a>e.lookahead&&(a=e.lookahead);do if(r=t,!(c[r+o]!==m||c[r+o-1]!==h||c[r]!==c[i]||c[++r]!==c[i+1])){i+=2,r++;do;while(c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&i<f);if(s=cc-(f-i),i=f-cc,s>o){if(e.match_start=t,o=s,s>=a)break;h=c[i+o-1],m=c[i+o]}}while((t=u[t&d])>l&&--n!==0);return o<=e.lookahead?o:e.lookahead},Iu=e=>{const t=e.w_size;let n,i,r,s,o;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-ao)){e.window.set(e.window.subarray(t,t+t),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,i=e.hash_size,n=i;do r=e.head[--n],e.head[n]=r>=t?r-t:0;while(--i);i=t,n=i;do r=e.prev[--n],e.prev[n]=r>=t?r-t:0;while(--i);s+=t}if(e.strm.avail_in===0)break;if(i=u6e(e.strm,e.window,e.strstart+e.lookahead,s),e.lookahead+=i,e.lookahead+e.insert>=lt)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=xc(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=xc(e,e.ins_h,e.window[o+lt-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<lt)););}while(e.lookahead<ao&&e.strm.avail_in!==0)},f6e=(e,t)=>{let n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(Iu(e),e.lookahead===0&&t===Yu)return ti;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;const i=e.block_start+n;if((e.strstart===0||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,Ri(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-ao&&(Ri(e,!1),e.strm.avail_out===0))return ti}return e.insert=0,t===Sc?(Ri(e,!0),e.strm.avail_out===0?Tu:Dg):(e.strstart>e.block_start&&(Ri(e,!1),e.strm.avail_out===0),ti)},U3=(e,t)=>{let n,i;for(;;){if(e.lookahead<ao){if(Iu(e),e.lookahead<ao&&t===Yu)return ti;if(e.lookahead===0)break}if(n=0,e.lookahead>=lt&&(e.ins_h=xc(e,e.ins_h,e.window[e.strstart+lt-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),n!==0&&e.strstart-n<=e.w_size-ao&&(e.match_length=MG(e,n)),e.match_length>=lt)if(i=Ic(e,e.strstart-e.match_start,e.match_length-lt),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=lt){e.match_length--;do e.strstart++,e.ins_h=xc(e,e.ins_h,e.window[e.strstart+lt-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=xc(e,e.ins_h,e.window[e.strstart+1]);else i=Ic(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(Ri(e,!1),e.strm.avail_out===0))return ti}return e.insert=e.strstart<lt-1?e.strstart:lt-1,t===Sc?(Ri(e,!0),e.strm.avail_out===0?Tu:Dg):e.last_lit&&(Ri(e,!1),e.strm.avail_out===0)?ti:zp},ff=(e,t)=>{let n,i,r;for(;;){if(e.lookahead<ao){if(Iu(e),e.lookahead<ao&&t===Yu)return ti;if(e.lookahead===0)break}if(n=0,e.lookahead>=lt&&(e.ins_h=xc(e,e.ins_h,e.window[e.strstart+lt-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=lt-1,n!==0&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-ao&&(e.match_length=MG(e,n),e.match_length<=5&&(e.strategy===Wbe||e.match_length===lt&&e.strstart-e.match_start>4096)&&(e.match_length=lt-1)),e.prev_length>=lt&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-lt,i=Ic(e,e.strstart-1-e.prev_match,e.prev_length-lt),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=r&&(e.ins_h=xc(e,e.ins_h,e.window[e.strstart+lt-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=lt-1,e.strstart++,i&&(Ri(e,!1),e.strm.avail_out===0))return ti}else if(e.match_available){if(i=Ic(e,0,e.window[e.strstart-1]),i&&Ri(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return ti}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=Ic(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<lt-1?e.strstart:lt-1,t===Sc?(Ri(e,!0),e.strm.avail_out===0?Tu:Dg):e.last_lit&&(Ri(e,!1),e.strm.avail_out===0)?ti:zp},h6e=(e,t)=>{let n,i,r,s;const o=e.window;for(;;){if(e.lookahead<=cc){if(Iu(e),e.lookahead<=cc&&t===Yu)return ti;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=lt&&e.strstart>0&&(r=e.strstart-1,i=o[r],i===o[++r]&&i===o[++r]&&i===o[++r])){s=e.strstart+cc;do;while(i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&r<s);e.match_length=cc-(s-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=lt?(n=Ic(e,1,e.match_length-lt),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=Ic(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(Ri(e,!1),e.strm.avail_out===0))return ti}return e.insert=0,t===Sc?(Ri(e,!0),e.strm.avail_out===0?Tu:Dg):e.last_lit&&(Ri(e,!1),e.strm.avail_out===0)?ti:zp},g6e=(e,t)=>{let n;for(;;){if(e.lookahead===0&&(Iu(e),e.lookahead===0)){if(t===Yu)return ti;break}if(e.match_length=0,n=Ic(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(Ri(e,!1),e.strm.avail_out===0))return ti}return e.insert=0,t===Sc?(Ri(e,!0),e.strm.avail_out===0?Tu:Dg):e.last_lit&&(Ri(e,!1),e.strm.avail_out===0)?ti:zp};function wo(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}const X1=[new wo(0,0,0,0,f6e),new wo(4,4,8,4,U3),new wo(4,5,16,8,U3),new wo(4,6,32,32,U3),new wo(4,4,16,16,ff),new wo(8,16,32,32,ff),new wo(8,16,128,128,ff),new wo(8,32,128,256,ff),new wo(32,128,258,1024,ff),new wo(32,258,258,4096,ff)],m6e=e=>{e.window_size=2*e.w_size,rc(e.head),e.max_lazy_match=X1[e.level].max_lazy,e.good_match=X1[e.level].good_length,e.nice_match=X1[e.level].nice_length,e.max_chain_length=X1[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=lt-1,e.match_available=0,e.ins_h=0};function p6e(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Oy,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(o6e*2),this.dyn_dtree=new Uint16Array((2*r6e+1)*2),this.bl_tree=new Uint16Array((2*s6e+1)*2),rc(this.dyn_ltree),rc(this.dyn_dtree),rc(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(a6e+1),this.heap=new Uint16Array(2*_v+1),rc(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*_v+1),rc(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const kG=e=>{if(!e||!e.state)return dc(e,ks);e.total_in=e.total_out=0,e.data_type=Qbe;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?Py:Hd,e.adler=t.wrap===2?0:1,t.last_flush=Yu,zbe(t),Po},RG=e=>{const t=kG(e);return t===Po&&m6e(e.state),t},U6e=(e,t)=>!e||!e.state||e.state.wrap!==2?ks:(e.state.gzhead=t,Po),DG=(e,t,n,i,r,s)=>{if(!e)return ks;let o=1;if(t===Ybe&&(t=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),r<1||r>Jbe||n!==Oy||i<8||i>15||t<0||t>9||s<0||s>Zbe)return dc(e,ks);i===8&&(i=9);const a=new p6e;return e.state=a,a.strm=e,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+lt-1)/lt),a.window=new Uint8Array(a.w_size*2),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=t,a.strategy=s,a.method=n,RG(e)},b6e=(e,t)=>DG(e,t,Oy,e6e,t6e,qbe),y6e=(e,t)=>{let n,i;if(!e||!e.state||t>Jk||t<0)return e?dc(e,ks):ks;const r=e.state;if(!e.output||!e.input&&e.avail_in!==0||r.status===G1&&t!==Sc)return dc(e,e.avail_out===0?p3:ks);r.strm=e;const s=r.last_flush;if(r.last_flush=t,r.status===Py)if(r.wrap===2)e.adler=0,_t(r,31),_t(r,139),_t(r,8),r.gzhead?(_t(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),_t(r,r.gzhead.time&255),_t(r,r.gzhead.time>>8&255),_t(r,r.gzhead.time>>16&255),_t(r,r.gzhead.time>>24&255),_t(r,r.level===9?2:r.strategy>=JU||r.level<2?4:0),_t(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(_t(r,r.gzhead.extra.length&255),_t(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=ui(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=Tv):(_t(r,0),_t(r,0),_t(r,0),_t(r,0),_t(r,0),_t(r,r.level===9?2:r.strategy>=JU||r.level<2?4:0),_t(r,c6e),r.status=Hd);else{let o=Oy+(r.w_bits-8<<4)<<8,a=-1;r.strategy>=JU||r.level<2?a=0:r.level<6?a=1:r.level===6?a=2:a=3,o|=a<<6,r.strstart!==0&&(o|=l6e),o+=31-o%31,r.status=Hd,b1(r,o),r.strstart!==0&&(b1(r,e.adler>>>16),b1(r,e.adler&65535)),e.adler=1}if(r.status===Tv)if(r.gzhead.extra){for(n=r.pending;r.gzindex<(r.gzhead.extra.length&65535)&&!(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(e.adler=ui(e.adler,r.pending_buf,r.pending-n,n)),Gl(e),n=r.pending,r.pending===r.pending_buf_size));)_t(r,r.gzhead.extra[r.gzindex]&255),r.gzindex++;r.gzhead.hcrc&&r.pending>n&&(e.adler=ui(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=J2)}else r.status=J2;if(r.status===J2)if(r.gzhead.name){n=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(e.adler=ui(e.adler,r.pending_buf,r.pending-n,n)),Gl(e),n=r.pending,r.pending===r.pending_buf_size)){i=1;break}r.gzindex<r.gzhead.name.length?i=r.gzhead.name.charCodeAt(r.gzindex++)&255:i=0,_t(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>n&&(e.adler=ui(e.adler,r.pending_buf,r.pending-n,n)),i===0&&(r.gzindex=0,r.status=eb)}else r.status=eb;if(r.status===eb)if(r.gzhead.comment){n=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(e.adler=ui(e.adler,r.pending_buf,r.pending-n,n)),Gl(e),n=r.pending,r.pending===r.pending_buf_size)){i=1;break}r.gzindex<r.gzhead.comment.length?i=r.gzhead.comment.charCodeAt(r.gzindex++)&255:i=0,_t(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>n&&(e.adler=ui(e.adler,r.pending_buf,r.pending-n,n)),i===0&&(r.status=tb)}else r.status=tb;if(r.status===tb&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&Gl(e),r.pending+2<=r.pending_buf_size&&(_t(r,e.adler&255),_t(r,e.adler>>8&255),e.adler=0,r.status=Hd)):r.status=Hd),r.pending!==0){if(Gl(e),e.avail_out===0)return r.last_flush=-1,Po}else if(e.avail_in===0&&tR(t)<=tR(s)&&t!==Sc)return dc(e,p3);if(r.status===G1&&e.avail_in!==0)return dc(e,p3);if(e.avail_in!==0||r.lookahead!==0||t!==Yu&&r.status!==G1){let o=r.strategy===JU?g6e(r,t):r.strategy===Kbe?h6e(r,t):X1[r.level].func(r,t);if((o===Tu||o===Dg)&&(r.status=G1),o===ti||o===Tu)return e.avail_out===0&&(r.last_flush=-1),Po;if(o===zp&&(t===Gbe?$be(r):t!==Jk&&(Hbe(r,0,0,!1),t===Xbe&&(rc(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),Gl(e),e.avail_out===0))return r.last_flush=-1,Po}return t!==Sc?Po:r.wrap<=0?eR:(r.wrap===2?(_t(r,e.adler&255),_t(r,e.adler>>8&255),_t(r,e.adler>>16&255),_t(r,e.adler>>24&255),_t(r,e.total_in&255),_t(r,e.total_in>>8&255),_t(r,e.total_in>>16&255),_t(r,e.total_in>>24&255)):(b1(r,e.adler>>>16),b1(r,e.adler&65535)),Gl(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?Po:eR)},E6e=e=>{if(!e||!e.state)return ks;const t=e.state.status;return t!==Py&&t!==Tv&&t!==J2&&t!==eb&&t!==tb&&t!==Hd&&t!==G1?dc(e,ks):(e.state=null,t===Hd?dc(e,jbe):Po)},v6e=(e,t)=>{let n=t.length;if(!e||!e.state)return ks;const i=e.state,r=i.wrap;if(r===2||r===1&&i.status!==Py||i.lookahead)return ks;if(r===1&&(e.adler=km(e.adler,t,n,0)),i.wrap=0,n>=i.w_size){r===0&&(rc(i.head),i.strstart=0,i.block_start=0,i.insert=0);let l=new Uint8Array(i.w_size);l.set(t.subarray(n-i.w_size,n),0),t=l,n=i.w_size}const s=e.avail_in,o=e.next_in,a=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,Iu(i);i.lookahead>=lt;){let l=i.strstart,c=i.lookahead-(lt-1);do i.ins_h=xc(i,i.ins_h,i.window[l+lt-1]),i.prev[l&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=l,l++;while(--c);i.strstart=l,i.lookahead=lt-1,Iu(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=lt-1,i.match_available=0,e.next_in=o,e.input=a,e.avail_in=s,i.wrap=r,Po};var w6e=b6e,_6e=DG,T6e=RG,I6e=kG,S6e=U6e,x6e=y6e,C6e=E6e,A6e=v6e,M6e="pako deflate (from Nodeca project)",L0={deflateInit:w6e,deflateInit2:_6e,deflateReset:T6e,deflateResetKeep:I6e,deflateSetHeader:S6e,deflate:x6e,deflateEnd:C6e,deflateSetDictionary:A6e,deflateInfo:M6e};const k6e=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var R6e=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const i in n)k6e(n,i)&&(e[i]=n[i])}}return e},D6e=e=>{let t=0;for(let i=0,r=e.length;i<r;i++)t+=e[i].length;const n=new Uint8Array(t);for(let i=0,r=0,s=e.length;i<s;i++){let o=e[i];n.set(o,r),r+=o.length}return n},Fy={assign:R6e,flattenChunks:D6e};let LG=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{LG=!1}const Rm=new Uint8Array(256);for(let e=0;e<256;e++)Rm[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Rm[254]=Rm[254]=1;var L6e=e=>{let t,n,i,r,s,o=e.length,a=0;for(r=0;r<o;r++)n=e.charCodeAt(r),(n&64512)===55296&&r+1<o&&(i=e.charCodeAt(r+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),r++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),s=0,r=0;s<a;r++)n=e.charCodeAt(r),(n&64512)===55296&&r+1<o&&(i=e.charCodeAt(r+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),r++)),n<128?t[s++]=n:n<2048?(t[s++]=192|n>>>6,t[s++]=128|n&63):n<65536?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|n&63):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|n&63);return t};const N6e=(e,t)=>{if(t<65534&&e.subarray&&LG)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n};var O6e=(e,t)=>{let n,i;const r=t||e.length,s=new Array(r*2);for(i=0,n=0;n<r;){let o=e[n++];if(o<128){s[i++]=o;continue}let a=Rm[o];if(a>4){s[i++]=65533,n+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&n<r;)o=o<<6|e[n++]&63,a--;if(a>1){s[i++]=65533;continue}o<65536?s[i++]=o:(o-=65536,s[i++]=55296|o>>10&1023,s[i++]=56320|o&1023)}return N6e(s,i)},P6e=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let n=t-1;for(;n>=0&&(e[n]&192)===128;)n--;return n<0||n===0?t:n+Rm[e[n]]>t?n:t},Dm={string2buf:L6e,buf2string:O6e,utf8border:P6e};function F6e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var NG=F6e;const OG=Object.prototype.toString,{Z_NO_FLUSH:B6e,Z_SYNC_FLUSH:z6e,Z_FULL_FLUSH:H6e,Z_FINISH:V6e,Z_OK:X6,Z_STREAM_END:$6e,Z_DEFAULT_COMPRESSION:G6e,Z_DEFAULT_STRATEGY:X6e,Z_DEFLATED:j6e}=Ny;function By(e){this.options=Fy.assign({level:G6e,method:j6e,chunkSize:16384,windowBits:15,memLevel:8,strategy:X6e},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new NG,this.strm.avail_out=0;let n=L0.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==X6)throw new Error(_u[n]);if(t.header&&L0.deflateSetHeader(this.strm,t.header),t.dictionary){let i;if(typeof t.dictionary=="string"?i=Dm.string2buf(t.dictionary):OG.call(t.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(t.dictionary):i=t.dictionary,n=L0.deflateSetDictionary(this.strm,i),n!==X6)throw new Error(_u[n]);this._dict_set=!0}}By.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize;let r,s;if(this.ended)return!1;for(t===~~t?s=t:s=t===!0?V6e:B6e,typeof e=="string"?n.input=Dm.string2buf(e):OG.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){if(n.avail_out===0&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),(s===z6e||s===H6e)&&n.avail_out<=6){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(r=L0.deflate(n,s),r===$6e)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),r=L0.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===X6;if(n.avail_out===0){this.onData(n.output);continue}if(s>0&&n.next_out>0){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(n.avail_in===0)break}return!0};By.prototype.onData=function(e){this.chunks.push(e)};By.prototype.onEnd=function(e){e===X6&&(this.result=Fy.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Y6e(e,t){const n=new By(t);if(n.push(e,!0),n.err)throw n.msg||_u[n.err];return n.result}var W6e=Y6e,K6e={deflate:W6e};const e2=30,Z6e=12;var q6e=function(t,n){let i,r,s,o,a,l,c,d,u,f,h,m,p,U,b,y,w,v,I,C,_,T,k,x;const D=t.state;i=t.next_in,k=t.input,r=i+(t.avail_in-5),s=t.next_out,x=t.output,o=s-(n-t.avail_out),a=s+(t.avail_out-257),l=D.dmax,c=D.wsize,d=D.whave,u=D.wnext,f=D.window,h=D.hold,m=D.bits,p=D.lencode,U=D.distcode,b=(1<<D.lenbits)-1,y=(1<<D.distbits)-1;e:do{m<15&&(h+=k[i++]<<m,m+=8,h+=k[i++]<<m,m+=8),w=p[h&b];t:for(;;){if(v=w>>>24,h>>>=v,m-=v,v=w>>>16&255,v===0)x[s++]=w&65535;else if(v&16){I=w&65535,v&=15,v&&(m<v&&(h+=k[i++]<<m,m+=8),I+=h&(1<<v)-1,h>>>=v,m-=v),m<15&&(h+=k[i++]<<m,m+=8,h+=k[i++]<<m,m+=8),w=U[h&y];n:for(;;){if(v=w>>>24,h>>>=v,m-=v,v=w>>>16&255,v&16){if(C=w&65535,v&=15,m<v&&(h+=k[i++]<<m,m+=8,m<v&&(h+=k[i++]<<m,m+=8)),C+=h&(1<<v)-1,C>l){t.msg="invalid distance too far back",D.mode=e2;break e}if(h>>>=v,m-=v,v=s-o,C>v){if(v=C-v,v>d&&D.sane){t.msg="invalid distance too far back",D.mode=e2;break e}if(_=0,T=f,u===0){if(_+=c-v,v<I){I-=v;do x[s++]=f[_++];while(--v);_=s-C,T=x}}else if(u<v){if(_+=c+u-v,v-=u,v<I){I-=v;do x[s++]=f[_++];while(--v);if(_=0,u<I){v=u,I-=v;do x[s++]=f[_++];while(--v);_=s-C,T=x}}}else if(_+=u-v,v<I){I-=v;do x[s++]=f[_++];while(--v);_=s-C,T=x}for(;I>2;)x[s++]=T[_++],x[s++]=T[_++],x[s++]=T[_++],I-=3;I&&(x[s++]=T[_++],I>1&&(x[s++]=T[_++]))}else{_=s-C;do x[s++]=x[_++],x[s++]=x[_++],x[s++]=x[_++],I-=3;while(I>2);I&&(x[s++]=x[_++],I>1&&(x[s++]=x[_++]))}}else if(v&64){t.msg="invalid distance code",D.mode=e2;break e}else{w=U[(w&65535)+(h&(1<<v)-1)];continue n}break}}else if(v&64)if(v&32){D.mode=Z6e;break e}else{t.msg="invalid literal/length code",D.mode=e2;break e}else{w=p[(w&65535)+(h&(1<<v)-1)];continue t}break}}while(i<r&&s<a);I=m>>3,i-=I,m-=I<<3,h&=(1<<m)-1,t.next_in=i,t.next_out=s,t.avail_in=i<r?5+(r-i):5-(i-r),t.avail_out=s<a?257+(a-s):257-(s-a),D.hold=h,D.bits=m};const hf=15,nR=852,iR=592,rR=0,b3=1,sR=2,Q6e=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),J6e=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),e5e=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),t5e=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),n5e=(e,t,n,i,r,s,o,a)=>{const l=a.bits;let c=0,d=0,u=0,f=0,h=0,m=0,p=0,U=0,b=0,y=0,w,v,I,C,_,T=null,k=0,x;const D=new Uint16Array(hf+1),O=new Uint16Array(hf+1);let L=null,Y=0,$,H,z;for(c=0;c<=hf;c++)D[c]=0;for(d=0;d<i;d++)D[t[n+d]]++;for(h=l,f=hf;f>=1&&D[f]===0;f--);if(h>f&&(h=f),f===0)return r[s++]=1<<24|64<<16|0,r[s++]=1<<24|64<<16|0,a.bits=1,0;for(u=1;u<f&&D[u]===0;u++);for(h<u&&(h=u),U=1,c=1;c<=hf;c++)if(U<<=1,U-=D[c],U<0)return-1;if(U>0&&(e===rR||f!==1))return-1;for(O[1]=0,c=1;c<hf;c++)O[c+1]=O[c]+D[c];for(d=0;d<i;d++)t[n+d]!==0&&(o[O[t[n+d]]++]=d);if(e===rR?(T=L=o,x=19):e===b3?(T=Q6e,k-=257,L=J6e,Y-=257,x=256):(T=e5e,L=t5e,x=-1),y=0,d=0,c=u,_=s,m=h,p=0,I=-1,b=1<<h,C=b-1,e===b3&&b>nR||e===sR&&b>iR)return 1;for(;;){$=c-p,o[d]<x?(H=0,z=o[d]):o[d]>x?(H=L[Y+o[d]],z=T[k+o[d]]):(H=96,z=0),w=1<<c-p,v=1<<m,u=v;do v-=w,r[_+(y>>p)+v]=$<<24|H<<16|z|0;while(v!==0);for(w=1<<c-1;y&w;)w>>=1;if(w!==0?(y&=w-1,y+=w):y=0,d++,--D[c]===0){if(c===f)break;c=t[n+o[d]]}if(c>h&&(y&C)!==I){for(p===0&&(p=h),_+=u,m=c-p,U=1<<m;m+p<f&&(U-=D[m+p],!(U<=0));)m++,U<<=1;if(b+=1<<m,e===b3&&b>nR||e===sR&&b>iR)return 1;I=y&C,r[I]=h<<24|m<<16|_-s|0}}return y!==0&&(r[_+y]=c-p<<24|64<<16|0),a.bits=h,0};var N0=n5e;const i5e=0,PG=1,FG=2,{Z_FINISH:oR,Z_BLOCK:r5e,Z_TREES:t2,Z_OK:Su,Z_STREAM_END:s5e,Z_NEED_DICT:o5e,Z_STREAM_ERROR:Fs,Z_DATA_ERROR:BG,Z_MEM_ERROR:zG,Z_BUF_ERROR:a5e,Z_DEFLATED:aR}=Ny,HG=1,lR=2,cR=3,dR=4,uR=5,fR=6,hR=7,gR=8,mR=9,pR=10,j6=11,va=12,y3=13,UR=14,E3=15,bR=16,yR=17,ER=18,vR=19,n2=20,i2=21,wR=22,_R=23,TR=24,IR=25,SR=26,v3=27,xR=28,CR=29,on=30,VG=31,l5e=32,c5e=852,d5e=592,u5e=15,f5e=u5e,AR=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function h5e(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const $G=e=>{if(!e||!e.state)return Fs;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=HG,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(c5e),t.distcode=t.distdyn=new Int32Array(d5e),t.sane=1,t.back=-1,Su},GG=e=>{if(!e||!e.state)return Fs;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,$G(e)},XG=(e,t)=>{let n;if(!e||!e.state)return Fs;const i=e.state;return t<0?(n=0,t=-t):(n=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15)?Fs:(i.window!==null&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,GG(e))},jG=(e,t)=>{if(!e)return Fs;const n=new h5e;e.state=n,n.window=null;const i=XG(e,t);return i!==Su&&(e.state=null),i},g5e=e=>jG(e,f5e);let MR=!0,w3,_3;const m5e=e=>{if(MR){w3=new Int32Array(512),_3=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(N0(PG,e.lens,0,288,w3,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;N0(FG,e.lens,0,32,_3,0,e.work,{bits:5}),MR=!1}e.lencode=w3,e.lenbits=9,e.distcode=_3,e.distbits=5},YG=(e,t,n,i)=>{let r;const s=e.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(t.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>i&&(r=i),s.window.set(t.subarray(n-i,n-i+r),s.wnext),i-=r,i?(s.window.set(t.subarray(n-i,n),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0},p5e=(e,t)=>{let n,i,r,s,o,a,l,c,d,u,f,h,m,p,U=0,b,y,w,v,I,C,_,T;const k=new Uint8Array(4);let x,D;const O=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return Fs;n=e.state,n.mode===va&&(n.mode=y3),o=e.next_out,r=e.output,l=e.avail_out,s=e.next_in,i=e.input,a=e.avail_in,c=n.hold,d=n.bits,u=a,f=l,T=Su;e:for(;;)switch(n.mode){case HG:if(n.wrap===0){n.mode=y3;break}for(;d<16;){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}if(n.wrap&2&&c===35615){n.check=0,k[0]=c&255,k[1]=c>>>8&255,n.check=ui(n.check,k,2,0),c=0,d=0,n.mode=lR;break}if(n.flags=0,n.head&&(n.head.done=!1),!(n.wrap&1)||(((c&255)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=on;break}if((c&15)!==aR){e.msg="unknown compression method",n.mode=on;break}if(c>>>=4,d-=4,_=(c&15)+8,n.wbits===0)n.wbits=_;else if(_>n.wbits){e.msg="invalid window size",n.mode=on;break}n.dmax=1<<n.wbits,e.adler=n.check=1,n.mode=c&512?pR:va,c=0,d=0;break;case lR:for(;d<16;){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}if(n.flags=c,(n.flags&255)!==aR){e.msg="unknown compression method",n.mode=on;break}if(n.flags&57344){e.msg="unknown header flags set",n.mode=on;break}n.head&&(n.head.text=c>>8&1),n.flags&512&&(k[0]=c&255,k[1]=c>>>8&255,n.check=ui(n.check,k,2,0)),c=0,d=0,n.mode=cR;case cR:for(;d<32;){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}n.head&&(n.head.time=c),n.flags&512&&(k[0]=c&255,k[1]=c>>>8&255,k[2]=c>>>16&255,k[3]=c>>>24&255,n.check=ui(n.check,k,4,0)),c=0,d=0,n.mode=dR;case dR:for(;d<16;){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}n.head&&(n.head.xflags=c&255,n.head.os=c>>8),n.flags&512&&(k[0]=c&255,k[1]=c>>>8&255,n.check=ui(n.check,k,2,0)),c=0,d=0,n.mode=uR;case uR:if(n.flags&1024){for(;d<16;){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}n.length=c,n.head&&(n.head.extra_len=c),n.flags&512&&(k[0]=c&255,k[1]=c>>>8&255,n.check=ui(n.check,k,2,0)),c=0,d=0}else n.head&&(n.head.extra=null);n.mode=fR;case fR:if(n.flags&1024&&(h=n.length,h>a&&(h=a),h&&(n.head&&(_=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(s,s+h),_)),n.flags&512&&(n.check=ui(n.check,i,h,s)),a-=h,s+=h,n.length-=h),n.length))break e;n.length=0,n.mode=hR;case hR:if(n.flags&2048){if(a===0)break e;h=0;do _=i[s+h++],n.head&&_&&n.length<65536&&(n.head.name+=String.fromCharCode(_));while(_&&h<a);if(n.flags&512&&(n.check=ui(n.check,i,h,s)),a-=h,s+=h,_)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=gR;case gR:if(n.flags&4096){if(a===0)break e;h=0;do _=i[s+h++],n.head&&_&&n.length<65536&&(n.head.comment+=String.fromCharCode(_));while(_&&h<a);if(n.flags&512&&(n.check=ui(n.check,i,h,s)),a-=h,s+=h,_)break e}else n.head&&(n.head.comment=null);n.mode=mR;case mR:if(n.flags&512){for(;d<16;){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}if(c!==(n.check&65535)){e.msg="header crc mismatch",n.mode=on;break}c=0,d=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=va;break;case pR:for(;d<32;){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}e.adler=n.check=AR(c),c=0,d=0,n.mode=j6;case j6:if(n.havedict===0)return e.next_out=o,e.avail_out=l,e.next_in=s,e.avail_in=a,n.hold=c,n.bits=d,o5e;e.adler=n.check=1,n.mode=va;case va:if(t===r5e||t===t2)break e;case y3:if(n.last){c>>>=d&7,d-=d&7,n.mode=v3;break}for(;d<3;){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}switch(n.last=c&1,c>>>=1,d-=1,c&3){case 0:n.mode=UR;break;case 1:if(m5e(n),n.mode=n2,t===t2){c>>>=2,d-=2;break e}break;case 2:n.mode=yR;break;case 3:e.msg="invalid block type",n.mode=on}c>>>=2,d-=2;break;case UR:for(c>>>=d&7,d-=d&7;d<32;){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}if((c&65535)!==(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=on;break}if(n.length=c&65535,c=0,d=0,n.mode=E3,t===t2)break e;case E3:n.mode=bR;case bR:if(h=n.length,h){if(h>a&&(h=a),h>l&&(h=l),h===0)break e;r.set(i.subarray(s,s+h),o),a-=h,s+=h,l-=h,o+=h,n.length-=h;break}n.mode=va;break;case yR:for(;d<14;){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}if(n.nlen=(c&31)+257,c>>>=5,d-=5,n.ndist=(c&31)+1,c>>>=5,d-=5,n.ncode=(c&15)+4,c>>>=4,d-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=on;break}n.have=0,n.mode=ER;case ER:for(;n.have<n.ncode;){for(;d<3;){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}n.lens[O[n.have++]]=c&7,c>>>=3,d-=3}for(;n.have<19;)n.lens[O[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,x={bits:n.lenbits},T=N0(i5e,n.lens,0,19,n.lencode,0,n.work,x),n.lenbits=x.bits,T){e.msg="invalid code lengths set",n.mode=on;break}n.have=0,n.mode=vR;case vR:for(;n.have<n.nlen+n.ndist;){for(;U=n.lencode[c&(1<<n.lenbits)-1],b=U>>>24,y=U>>>16&255,w=U&65535,!(b<=d);){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}if(w<16)c>>>=b,d-=b,n.lens[n.have++]=w;else{if(w===16){for(D=b+2;d<D;){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}if(c>>>=b,d-=b,n.have===0){e.msg="invalid bit length repeat",n.mode=on;break}_=n.lens[n.have-1],h=3+(c&3),c>>>=2,d-=2}else if(w===17){for(D=b+3;d<D;){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}c>>>=b,d-=b,_=0,h=3+(c&7),c>>>=3,d-=3}else{for(D=b+7;d<D;){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}c>>>=b,d-=b,_=0,h=11+(c&127),c>>>=7,d-=7}if(n.have+h>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=on;break}for(;h--;)n.lens[n.have++]=_}}if(n.mode===on)break;if(n.lens[256]===0){e.msg="invalid code -- missing end-of-block",n.mode=on;break}if(n.lenbits=9,x={bits:n.lenbits},T=N0(PG,n.lens,0,n.nlen,n.lencode,0,n.work,x),n.lenbits=x.bits,T){e.msg="invalid literal/lengths set",n.mode=on;break}if(n.distbits=6,n.distcode=n.distdyn,x={bits:n.distbits},T=N0(FG,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,x),n.distbits=x.bits,T){e.msg="invalid distances set",n.mode=on;break}if(n.mode=n2,t===t2)break e;case n2:n.mode=i2;case i2:if(a>=6&&l>=258){e.next_out=o,e.avail_out=l,e.next_in=s,e.avail_in=a,n.hold=c,n.bits=d,q6e(e,f),o=e.next_out,r=e.output,l=e.avail_out,s=e.next_in,i=e.input,a=e.avail_in,c=n.hold,d=n.bits,n.mode===va&&(n.back=-1);break}for(n.back=0;U=n.lencode[c&(1<<n.lenbits)-1],b=U>>>24,y=U>>>16&255,w=U&65535,!(b<=d);){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}if(y&&!(y&240)){for(v=b,I=y,C=w;U=n.lencode[C+((c&(1<<v+I)-1)>>v)],b=U>>>24,y=U>>>16&255,w=U&65535,!(v+b<=d);){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}c>>>=v,d-=v,n.back+=v}if(c>>>=b,d-=b,n.back+=b,n.length=w,y===0){n.mode=SR;break}if(y&32){n.back=-1,n.mode=va;break}if(y&64){e.msg="invalid literal/length code",n.mode=on;break}n.extra=y&15,n.mode=wR;case wR:if(n.extra){for(D=n.extra;d<D;){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,d-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=_R;case _R:for(;U=n.distcode[c&(1<<n.distbits)-1],b=U>>>24,y=U>>>16&255,w=U&65535,!(b<=d);){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}if(!(y&240)){for(v=b,I=y,C=w;U=n.distcode[C+((c&(1<<v+I)-1)>>v)],b=U>>>24,y=U>>>16&255,w=U&65535,!(v+b<=d);){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}c>>>=v,d-=v,n.back+=v}if(c>>>=b,d-=b,n.back+=b,y&64){e.msg="invalid distance code",n.mode=on;break}n.offset=w,n.extra=y&15,n.mode=TR;case TR:if(n.extra){for(D=n.extra;d<D;){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,d-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=on;break}n.mode=IR;case IR:if(l===0)break e;if(h=f-l,n.offset>h){if(h=n.offset-h,h>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=on;break}h>n.wnext?(h-=n.wnext,m=n.wsize-h):m=n.wnext-h,h>n.length&&(h=n.length),p=n.window}else p=r,m=o-n.offset,h=n.length;h>l&&(h=l),l-=h,n.length-=h;do r[o++]=p[m++];while(--h);n.length===0&&(n.mode=i2);break;case SR:if(l===0)break e;r[o++]=n.length,l--,n.mode=i2;break;case v3:if(n.wrap){for(;d<32;){if(a===0)break e;a--,c|=i[s++]<<d,d+=8}if(f-=l,e.total_out+=f,n.total+=f,f&&(e.adler=n.check=n.flags?ui(n.check,r,f,o-f):km(n.check,r,f,o-f)),f=l,(n.flags?c:AR(c))!==n.check){e.msg="incorrect data check",n.mode=on;break}c=0,d=0}n.mode=xR;case xR:if(n.wrap&&n.flags){for(;d<32;){if(a===0)break e;a--,c+=i[s++]<<d,d+=8}if(c!==(n.total&4294967295)){e.msg="incorrect length check",n.mode=on;break}c=0,d=0}n.mode=CR;case CR:T=s5e;break e;case on:T=BG;break e;case VG:return zG;case l5e:default:return Fs}return e.next_out=o,e.avail_out=l,e.next_in=s,e.avail_in=a,n.hold=c,n.bits=d,(n.wsize||f!==e.avail_out&&n.mode<on&&(n.mode<v3||t!==oR))&&YG(e,e.output,e.next_out,f-e.avail_out),u-=e.avail_in,f-=e.avail_out,e.total_in+=u,e.total_out+=f,n.total+=f,n.wrap&&f&&(e.adler=n.check=n.flags?ui(n.check,r,f,e.next_out-f):km(n.check,r,f,e.next_out-f)),e.data_type=n.bits+(n.last?64:0)+(n.mode===va?128:0)+(n.mode===n2||n.mode===E3?256:0),(u===0&&f===0||t===oR)&&T===Su&&(T=a5e),T},U5e=e=>{if(!e||!e.state)return Fs;let t=e.state;return t.window&&(t.window=null),e.state=null,Su},b5e=(e,t)=>{if(!e||!e.state)return Fs;const n=e.state;return n.wrap&2?(n.head=t,t.done=!1,Su):Fs},y5e=(e,t)=>{const n=t.length;let i,r,s;return!e||!e.state||(i=e.state,i.wrap!==0&&i.mode!==j6)?Fs:i.mode===j6&&(r=1,r=km(r,t,n,0),r!==i.check)?BG:(s=YG(e,t,n,n),s?(i.mode=VG,zG):(i.havedict=1,Su))};var E5e=GG,v5e=XG,w5e=$G,_5e=g5e,T5e=jG,I5e=p5e,S5e=U5e,x5e=b5e,C5e=y5e,A5e="pako inflate (from Nodeca project)",Ca={inflateReset:E5e,inflateReset2:v5e,inflateResetKeep:w5e,inflateInit:_5e,inflateInit2:T5e,inflate:I5e,inflateEnd:S5e,inflateGetHeader:x5e,inflateSetDictionary:C5e,inflateInfo:A5e};function M5e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var k5e=M5e;const WG=Object.prototype.toString,{Z_NO_FLUSH:R5e,Z_FINISH:D5e,Z_OK:Lm,Z_STREAM_END:T3,Z_NEED_DICT:I3,Z_STREAM_ERROR:L5e,Z_DATA_ERROR:kR,Z_MEM_ERROR:N5e}=Ny;function zy(e){this.options=Fy.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new NG,this.strm.avail_out=0;let n=Ca.inflateInit2(this.strm,t.windowBits);if(n!==Lm)throw new Error(_u[n]);if(this.header=new k5e,Ca.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Dm.string2buf(t.dictionary):WG.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=Ca.inflateSetDictionary(this.strm,t.dictionary),n!==Lm)))throw new Error(_u[n])}zy.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?D5e:R5e,WG.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),s=Ca.inflate(n,o),s===I3&&r&&(s=Ca.inflateSetDictionary(n,r),s===Lm?s=Ca.inflate(n,o):s===kR&&(s=I3));n.avail_in>0&&s===T3&&n.state.wrap>0&&e[n.next_in]!==0;)Ca.inflateReset(n),s=Ca.inflate(n,o);switch(s){case L5e:case kR:case I3:case N5e:return this.onEnd(s),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(n.avail_out===0||s===T3))if(this.options.to==="string"){let l=Dm.utf8border(n.output,n.next_out),c=n.next_out-l,d=Dm.buf2string(n.output,l);n.next_out=c,n.avail_out=i-c,c&&n.output.set(n.output.subarray(l,l+c),0),this.onData(d)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(s===Lm&&a===0)){if(s===T3)return s=Ca.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};zy.prototype.onData=function(e){this.chunks.push(e)};zy.prototype.onEnd=function(e){e===Lm&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Fy.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function O5e(e,t){const n=new zy(t);if(n.push(e),n.err)throw n.msg||_u[n.err];return n.result}var P5e=O5e,F5e={inflate:P5e};const{deflate:B5e}=K6e,{inflate:z5e}=F5e;var KG=B5e,ZG=z5e;const nb=12,H5e=()=>{const e=new Uint8Array(nb);return window.crypto.getRandomValues(e)},DT=async e=>{const t=await window.crypto.subtle.generateKey({name:"AES-GCM",length:EB},!0,["encrypt","decrypt"]);return e==="cryptoKey"?t:(await window.crypto.subtle.exportKey("jwk",t)).k},qG=(e,t)=>window.crypto.subtle.importKey("jwk",{alg:"A128GCM",ext:!0,k:e,key_ops:["encrypt","decrypt"],kty:"oct"},{name:"AES-GCM",length:EB},!1,[t]),Hy=async(e,t)=>{const n=typeof e=="string"?await qG(e,"encrypt"):e,i=H5e(),r=typeof t=="string"?new TextEncoder().encode(t):t instanceof Uint8Array?t:t instanceof Blob?await Hp(t):t;return{encryptedBuffer:await window.crypto.subtle.encrypt({name:"AES-GCM",iv:i},n,r),iv:i}},Nm=async(e,t,n)=>{const i=await qG(n,"decrypt");return window.crypto.subtle.decrypt({name:"AES-GCM",iv:e},i,t)},Y6=e=>{const t=typeof e=="string"?new TextEncoder().encode(e):e instanceof Uint8Array?e:new Uint8Array(e);let n="";for(const i of t)n+=String.fromCharCode(i);return n},QG=e=>{const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let i=0,r=e.length;i<r;i++)n[i]=e.charCodeAt(i);return t},JG=e=>new TextDecoder("utf-8").decode(QG(e)),eX=(e,t=!1)=>t?window.btoa(e):window.btoa(Y6(e)),tX=(e,t=!1)=>t?window.atob(e):JG(window.atob(e)),RR=e=>window.atob(e.replace(/-/g,"+").replace(/_/g,"/").padEnd(e.length+(4-e.length%4)%4,"=")),nX=({text:e,compress:t})=>{let n;if(t!==!1)try{n=Y6(KG(e))}catch(i){console.error("encode: cannot deflate",i)}return{version:"1",encoding:"bstring",compressed:!!n,encoded:n||Y6(e)}},iX=e=>{let t;switch(e.encoding){case"bstring":t=e.compressed?e.encoded:JG(e.encoded);break;default:throw new Error(`decode: unknown encoding "${e.encoding}"`)}return e.compressed?ZG(new Uint8Array(QG(t)),{to:"string"}):t},rX=1,ib=4,vh=4,S3={1:8,2:16,4:32};function W6(e,t,n,i){if(i!=null){if(i>Math.pow(2,S3[t])-1)throw new Error(`attempting to set value higher than the allocated bytes (value: ${i}, bytes: ${t})`);const s=`setUint${S3[t]}`;return new DataView(e.buffer)[s](n,i),e}const r=`getUint${S3[t]}`;return new DataView(e.buffer)[r](n)}const DR=(...e)=>{const t=new Uint8Array(ib+vh*e.length+e.reduce((i,r)=>i+r.byteLength,0));let n=0;W6(t,ib,n,rX),n+=ib;for(const i of e)W6(t,vh,n,i.byteLength),n+=vh,t.set(i,n),n+=i.byteLength;return t},LR=e=>{const t=[];let n=0;const i=W6(e,vh,n);if(i>rX)throw new Error(`invalid version ${i}`);for(n+=ib;;){const r=W6(e,vh,n);if(n+=vh,t.push(e.slice(n,n+r)),n+=r,n>=e.byteLength)break}return t},V5e=async(e,t)=>{const{encryptedBuffer:n,iv:i}=await Hy(t,KG(e));return{iv:i,buffer:new Uint8Array(n)}},sX=async(e,t)=>{const n={version:2,compression:"pako@1",encryption:"AES-GCM"},i=new TextEncoder().encode(JSON.stringify(n)),r=new TextEncoder().encode(JSON.stringify(t.metadata||null)),{iv:s,buffer:o}=await V5e(DR(r,e),t.encryptionKey);return DR(i,s,o)},$5e=async(e,t,n,i)=>(t=new Uint8Array(await Nm(e,t,n)),i?ZG(t):t),oX=async(e,t)=>{const[n,i,r]=LR(e),s=JSON.parse(new TextDecoder().decode(n));try{const[o,a]=LR(await $5e(i,r,t.decryptionKey,!!s.compression));return{metadata:JSON.parse(new TextDecoder().decode(o)),data:a}}catch(o){throw console.error("Error during decompressing and decrypting the file.",s),o}},Wu=(()=>{if(typeof self>"u")return!1;if("top"in self&&self!==top)try{}catch{return!1}else if("showOpenFilePicker"in self)return"showOpenFilePicker";return!1})(),G5e=ye(Wu?()=>import("./file-open-002ab408-DIuFHtCF.js"):()=>import("./file-open-7c801643-684qeFg4.js"),__vite__mapDeps([]));async function X5e(...e){return(await G5e).default(...e)}ye(Wu?()=>import("./directory-open-4ed118d0-BzWybGaI.js"):()=>import("./directory-open-01563666-DWU9wJ6I.js"),__vite__mapDeps([]));const j5e=ye(Wu?()=>import("./file-save-745eba88-Bb9F9Kg7.js"):()=>import("./file-save-3189631c-x92wctJd.js"),__vite__mapDeps([]));async function Y5e(...e){return(await j5e).default(...e)}const NR=5e3,LT=async e=>{var r,s;const t=(r=e.extensions)==null?void 0:r.reduce((o,a)=>(o.push(Te[a]),o),[]),n=(s=e.extensions)==null?void 0:s.reduce((o,a)=>a==="jpg"?o.concat(".jpg",".jpeg"):o.concat(`.${a}`),[]),i=await X5e({description:e.description,extensions:n,mimeTypes:t,multiple:e.multiple??!1,legacySetup:(o,a,l)=>{const c=ll(a,NR),d=()=>{u(),document.addEventListener(te.KEYUP,c),document.addEventListener(te.POINTER_UP,c),c()},u=()=>{var h;if((h=l.files)!=null&&h.length){const m=e.multiple?[...l.files]:l.files[0];o(m)}};requestAnimationFrame(()=>{window.addEventListener(te.FOCUS,d)});const f=window.setInterval(()=>{u()},NR);return h=>{clearInterval(f),c.cancel(),window.removeEventListener(te.FOCUS,d),document.removeEventListener(te.KEYUP,c),document.removeEventListener(te.POINTER_UP,c),h&&(console.warn("Opening the file was canceled (legacy-fs)."),h(new Kh))}}});return Array.isArray(i)?await Promise.all(i.map(o=>Fm(o))):await Fm(i)},K6=(e,t)=>Y5e(e,{fileName:`${t.name}.${t.extension}`,description:t.description,extensions:[`.${t.extension}`],mimeTypes:t.mimeTypes},t.fileHandle),W5e=(e,t)=>{const n={};for(const i of e)!i.isDeleted&&"fileId"in i&&i.fileId&&t[i.fileId]&&(n[i.fileId]=t[i.fileId]);return n},Lg=(e,t,n,i)=>{const r={type:Cs.excalidraw,version:ey.excalidraw,source:P_(),elements:i==="local"?MH(e):tue(e),appState:i==="local"?cG(t):tbe(t),files:i==="local"?W5e(e,n):void 0};return JSON.stringify(r,null,2)},aX=async(e,t,n,i=t.name||_B)=>{const r=Lg(e,t,n,"local"),s=new Blob([r],{type:Te.excalidraw});return{fileHandle:await K6(s,{name:i,extension:"excalidraw",description:"Excalidraw file",fileHandle:FT(t.fileHandle)?null:t.fileHandle})}},K5e=async(e,t)=>{const n=await LT({description:"Excalidraw files"});return BT(n,e,t,n.handle)},Z5e=e=>(e==null?void 0:e.type)===Cs.excalidraw&&(!e.elements||Array.isArray(e.elements)&&(!e.appState||typeof e.appState=="object")),lX=e=>typeof e=="object"&&e&&e.type===Cs.excalidrawLibrary&&(e.version===1||e.version===2),q5e=e=>{const t={type:Cs.excalidrawLibrary,version:ey.excalidrawLibrary,source:P_(),libraryItems:e};return JSON.stringify(t,null,2)},Q5e=async e=>{const t=q5e(e);await K6(new Blob([t],{type:Te.excalidrawlib}),{name:"library",extension:"excalidrawlib",description:"Excalidraw library file"})},J5e=12,cX=document.createElement("img");cX.src=`data:${Te.svg}, ${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#1971c2" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>')}`;const dX=document.createElement("img");dX.src=`data:${Te.svg}, ${encodeURIComponent('<svg  xmlns="http://www.w3.org/2000/svg"  width="16"  height="16"  viewBox="0 0 24 24"  fill="none"  stroke="#1971c2"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-arrow-big-right-line"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 9v-3.586a1 1 0 0 1 1.707 -.707l6.586 6.586a1 1 0 0 1 0 1.414l-6.586 6.586a1 1 0 0 1 -1.707 -.707v-3.586h-6v-6h6z" /><path d="M3 9v6" /></svg>')}`;const NT=([e,t,n,i],r,s)=>{const o=J5e,a=s.zoom.value>1?s.zoom.value:1,l=o/a,c=o/a,d=o/a,u=(e+n)/2,f=(t+i)/2,h=(o-8)/(2*a),m=4/a,p=n+m-h,U=t-m-d+h,[b,y]=Q(S(p+l/2,U+c/2),S(u,f),r);return[b-l/2,y-c/2,l,c]},uX=(e,t,n,[i,r])=>{const s=4/n.zoom.value,[o,a,l,c]=$e(e,t),[d,u,f,h]=NT([o,a,l,c],e.angle,n);return i>d-s&&i<d+s+f&&r>u-s&&r<u+h+s},x3=(e,t,n,[i,r],s)=>!e.link||n.selectedElementIds[e.id]?!1:!s&&n.viewModeEnabled&&ay(S(i,r),e,t)?!0:uX(e,t,n,S(i,r)),Vy=(e,t,n,i,r,s=!0)=>{e.beginPath(),e.arc(t,n,i,0,Math.PI*2),s&&e.fill(),r&&e.stroke()},$y=(e,t)=>[e.width/t,e.height/t],Gy=({canvas:e,scale:t,normalizedWidth:n,normalizedHeight:i,theme:r,isExporting:s,viewBackgroundColor:o})=>{const a=e.getContext("2d");return a.setTransform(1,0,0,1,0,0),a.scale(t,t),s&&r===ke.DARK&&(a.filter=z_),typeof o=="string"?((o==="transparent"||o.length===5||o.length===9||/(hsla|rgba)\(/.test(o))&&a.clearRect(0,0,n,i),a.save(),a.fillStyle=o,a.fillRect(0,0,n,i),a.restore()):a.clearRect(0,0,n,i),a};function Pl(e,t,n=.5){const i=kse(t,n);if(i)for(let r=0;r<i.length-1;r++){const[[s,o],[a,l]]=i[r];e.quadraticCurveTo(s,o,a,l)}}function Fl(e,t,n=.5){const i=j_(t,n);if(i)for(let r=0;r<i.length;r++){const[[s,o],[a,l],[c,d]]=i[r];e.bezierCurveTo(s,o,a,l,c,d)}}const eye=(e,t,n,i)=>{const[r,s]=Q(S(t.x,t.y),oi(t,n),t.angle);e.save(),e.translate(r,s),e.rotate(t.angle);let o=ur(Math.min(t.width,t.height),t);o===0&&(o=.01),e.beginPath();{const a=Nl(S(0,0+o),S(0,0),S(0+o,0),i),l=Nl(S(t.width-o,0),S(t.width,0),S(t.width,o),i),c=Nl(S(t.width,t.height-o),S(t.width,t.height),S(t.width-o,t.height),i),d=Nl(S(o,t.height),S(0,t.height),S(0,t.height-o),i);e.moveTo(a[a.length-1][0],a[a.length-1][1]),e.lineTo(l[0][0],l[0][1]),Pl(e,l),e.lineTo(c[0][0],c[0][1]),Pl(e,c),e.lineTo(d[0][0],d[0][1]),Pl(e,d),e.lineTo(a[0][0],a[0][1]),Pl(e,a)}{const a=Nl(S(0+o,0),S(0,0),S(0,0+o),-5),l=Nl(S(t.width,o),S(t.width,0),S(t.width-o,0),-5),c=Nl(S(t.width-o,t.height),S(t.width,t.height),S(t.width,t.height-o),-5),d=Nl(S(0,t.height-o),S(0,t.height),S(o,t.height),-5);e.moveTo(a[a.length-1][0],a[a.length-1][1]),e.lineTo(d[0][0],d[0][1]),Pl(e,d),e.lineTo(c[0][0],c[0][1]),Pl(e,c),e.lineTo(l[0][0],l[0][1]),Pl(e,l),e.lineTo(a[0][0],a[0][1]),Pl(e,a)}e.closePath(),e.fill(),e.restore()},tye=(e,t,n,i,r,s)=>{e.beginPath(),e.ellipse(i,r,t/2,n/2,s,0,Math.PI*2),e.stroke()},Xy=(e,t,n,i,r,s,o,a,l=!1,c=0)=>{e.save(),e.translate(s,o),e.rotate(a),l&&e.fillRect(t-s,n-o,i,r),c&&e.roundRect?(e.beginPath(),e.roundRect(t-s,n-o,i,r,c),e.stroke(),e.closePath()):e.strokeRect(t-s,n-o,i,r),e.restore()},nye=(e,t,n,i)=>{const[r,s]=Q(S(n.x,n.y),oi(n,i),n.angle);e.save(),e.translate(r,s),e.rotate(n.angle);{e.beginPath();const[o,a,l,c,d,u,f,h]=C6(n),m=n.roundness?ur(Math.abs(o-f),n):(o-f)*.01,p=n.roundness?ur(Math.abs(c-a),n):(c-a)*.01,U=To(Hn(S(o-m,a+p),S(o,a),S(o,a),S(o+m,a+p)),t),b=To(Hn(S(l-m,c-p),S(l,c),S(l,c),S(l-m,c+p)),t),y=To(Hn(S(d+m,u-p),S(d,u),S(d,u),S(d-m,u-p)),t),w=To(Hn(S(f+m,h+p),S(f,h),S(f,h),S(f+m,h-p)),t);e.moveTo(U[U.length-1][0],U[U.length-1][1]),e.lineTo(b[1][0],b[1][1]),Fl(e,b),e.lineTo(y[1][0],y[1][1]),Fl(e,y),e.lineTo(w[1][0],w[1][1]),Fl(e,w),e.lineTo(U[1][0],U[1][1]),Fl(e,U)}{const[o,a,l,c,d,u,f,h]=C6(n),m=n.roundness?ur(Math.abs(o-f),n):(o-f)*.01,p=n.roundness?ur(Math.abs(c-a),n):(c-a)*.01,U=To(Hn(S(o+m,a+p),S(o,a),S(o,a),S(o-m,a+p)),-5),b=To(Hn(S(l-m,c+p),S(l,c),S(l,c),S(l-m,c-p)),-5),y=To(Hn(S(d-m,u-p),S(d,u),S(d,u),S(d+m,u-p)),-5),w=To(Hn(S(f+m,h-p),S(f,h),S(f,h),S(f+m,h+p)),-5);e.moveTo(U[U.length-1][0],U[U.length-1][1]),e.lineTo(w[1][0],w[1][1]),Fl(e,w),e.lineTo(y[1][0],y[1][1]),Fl(e,y),e.lineTo(b[1][0],b[1][1]),Fl(e,b),e.lineTo(U[1][0],U[1][1]),Fl(e,U)}e.closePath(),e.fill(),e.restore()},r2={Bold:"#dddddd",Regular:"#e5e5e5"},iye=(e,t,n,i,r,s,o,a)=>{const l=i%t-t,c=r%t-t,d=t*s.value,u=1/s.value;e.save(),s.value===1&&e.translate(l%1?0:.5,c%1?0:.5);for(let f=l;f<l+o+t*2;f+=t){const h=n>1&&Math.round(f-i)%(n*t)===0;if(!h&&d<10)continue;const m=Math.min(1/s.value,h?4:1);e.lineWidth=m;const p=[m*3,u+(m+u)];e.beginPath(),e.setLineDash(h?[]:p),e.strokeStyle=h?r2.Bold:r2.Regular,e.moveTo(f,c-t),e.lineTo(f,Math.ceil(c+a+t*2)),e.stroke()}for(let f=c;f<c+a+t*2;f+=t){const h=n>1&&Math.round(f-r)%(n*t)===0;if(!h&&d<10)continue;const m=Math.min(1/s.value,h?4:1);e.lineWidth=m;const p=[m*3,u+(m+u)];e.beginPath(),e.setLineDash(h?[]:p),e.strokeStyle=h?r2.Bold:r2.Regular,e.moveTo(l-t,f),e.lineTo(Math.ceil(l+o+t*2),f),e.stroke()}e.restore()},Iv=(e,t,n,i)=>{t.translate(e.x+i.scrollX,e.y+i.scrollY),t.beginPath(),t.roundRect?t.roundRect(0,0,e.width,e.height,zt.radius/i.zoom.value):t.rect(0,0,e.width,e.height),t.clip(),t.translate(-(e.x+i.scrollX),-(e.y+i.scrollY))},OR={regularLink:null,elementLink:null},PR=(e,t,n,i)=>{if(e.link&&!n.selectedElementIds[e.id]){const[r,s,o,a]=$e(e,i),[l,c,d,u]=NT([r,s,o,a],e.angle,n),f=l+d/2,h=c+u/2;t.save(),t.translate(n.scrollX+f,n.scrollY+h),t.rotate(e.angle);const m=hh(e.link)?"elementLink":"regularLink";let p=OR[m];if(!p||p.zoom!==n.zoom.value){p=Object.assign(document.createElement("canvas"),{zoom:n.zoom.value}),p.width=d*window.devicePixelRatio*n.zoom.value,p.height=u*window.devicePixelRatio*n.zoom.value,OR[m]=p;const U=p.getContext("2d");U.scale(window.devicePixelRatio*n.zoom.value,window.devicePixelRatio*n.zoom.value),U.fillStyle=n.viewBackgroundColor||"#fff",U.fillRect(0,0,d,u),m==="elementLink"?U.drawImage(dX,0,0,d,u):U.drawImage(cX,0,0,d,u),U.restore()}t.drawImage(p,l-f,c-h,d,u),t.restore()}},fX=({canvas:e,rc:t,elementsMap:n,allElementsMap:i,visibleElements:r,scale:s,appState:o,renderConfig:a})=>{var p;if(e===null)return;const{renderGrid:l=!0,isExporting:c}=a,[d,u]=$y(e,s),f=Gy({canvas:e,scale:s,normalizedWidth:d,normalizedHeight:u,theme:o.theme,isExporting:c,viewBackgroundColor:o.viewBackgroundColor});f.scale(o.zoom.value,o.zoom.value),l&&iye(f,o.gridSize,o.gridStep,o.scrollX,o.scrollY,o.zoom,d/o.zoom.value,u/o.zoom.value);const h=new Set;r.forEach(U=>{U.groupIds.length>0&&o.frameToHighlight&&o.selectedElementIds[U.id]&&(Vc(U,o.frameToHighlight,n)||U.groupIds.find(b=>h.has(b)))&&U.groupIds.forEach(b=>h.add(b))});const m=new Map;r.filter(U=>!Es(U)).forEach(U=>{var b;try{const y=U.frameId||((b=o.frameToHighlight)==null?void 0:b.id);if(ge(U)&&U.containerId&&n.has(U.containerId))return;if(f.save(),y&&o.frameRendering.enabled&&o.frameRendering.clip){const v=v6(U,n,o);v&&O4(U,v,o,n,m)&&Iv(v,f,a,o),Sd(U,n,i,t,f,a,o)}else Sd(U,n,i,t,f,a,o);const w=Le(U,n);w&&Sd(w,n,i,t,f,a,o),f.restore(),c||PR(U,f,o,n)}catch(y){console.error(y,U.id,U.x,U.y,U.width,U.height)}}),r.filter(U=>Es(U)).forEach(U=>{var b;try{const y=()=>{if(Sd(U,n,i,t,f,a,o),Es(U)&&(c||or(U)&&a.embedsValidationStatus.get(U.id)!==!0)&&U.width&&U.height){const v=gH(U);Sd(v,n,i,t,f,a,o)}c||PR(U,f,o,n)};if((U.frameId||((b=o.frameToHighlight)==null?void 0:b.id))&&o.frameRendering.enabled&&o.frameRendering.clip){f.save();const v=v6(U,n,o);v&&O4(U,v,o,n,m)&&Iv(v,f,a,o),y(),f.restore()}else y()}catch(y){console.error(y)}}),(p=a.pendingFlowchartNodes)==null||p.forEach(U=>{try{Sd(U,n,i,t,f,a,o)}catch(b){console.error(b)}})},hX=vp(e=>{fX(e)},{trailing:!0}),gX=(e,t)=>{if(t){hX(e);return}fX(e)},y1=(e,t,n)=>{const i={sets:t.sets,shape:t.shape,options:{...t.options,fixedDecimalPlaceDigits:n}};return e.draw(i)},E1=(e,t,n,i,r)=>{if(!i.enabled||!i.clip)return null;const s=Cr(e,r);if(s){const o=t.ownerDocument.createElementNS(st,"g");return o.setAttributeNS(st,"clip-path",`url(#${s.id})`),n.forEach(a=>o.appendChild(a)),o}return null},rb=(e,t,n,i,r,s,o,a)=>{var w;const l={x:s,y:o},[c,d,u,f]=$e(e,t);let h=(u-c)/2-(e.x-c),m=(f-d)/2-(e.y-d);if(ge(e)){const v=Yn(e,t);if(Ce(v)){const[I,C,_,T]=$e(v,t),k=pe.getBoundTextElementPosition(v,e,t);h=(_-I)/2-(k.x-I),m=(T-C)/2-(k.y-C),s=s+k.x-e.x,o=o+k.y-e.y}}const p=180*e.angle/Math.PI;let U=i;if(e.link){const v=i.ownerDocument.createElementNS(st,"a");v.setAttribute("href",ts(e.link)),U.appendChild(v),U=v}const b=(v,I)=>{U.appendChild(v)},y=(((w=Cr(e,t))==null?void 0:w.opacity)??100)*e.opacity/1e4;switch(e.type){case"selection":throw new Error("Selection rendering is not supported for SVG");case"rectangle":case"diamond":case"ellipse":{const v=qt.generateElementShape(e,null),I=y1(n,v,l1);y!==1&&(I.setAttribute("stroke-opacity",`${y}`),I.setAttribute("fill-opacity",`${y}`)),I.setAttribute("stroke-linecap","round"),I.setAttribute("transform",`translate(${s||0} ${o||0}) rotate(${p} ${h} ${m})`);const C=E1(e,U,[I],a.frameRendering,t);b(C||I);break}case"iframe":case"embeddable":{const v=qt.generateElementShape(e,a),I=y1(n,v,l1),C=e.opacity/100;C!==1&&(I.setAttribute("stroke-opacity",`${C}`),I.setAttribute("fill-opacity",`${C}`)),I.setAttribute("stroke-linecap","round"),I.setAttribute("transform",`translate(${s||0} ${o||0}) rotate(${p} ${h} ${m})`),b(I);const _=gH(e);rb(_,t,n,U,r,_.x+l.x-e.x,_.y+l.y-e.y,a);const T=y1(n,v,l1);for(T.setAttribute("stroke-linecap","round"),T.setAttribute("transform",`translate(${s||0} ${o||0}) rotate(${p} ${h} ${m})`);T.firstChild;)T.removeChild(T.firstChild);const k=ur(Math.min(e.width,e.height),e),x=Zf(q_(e.link||""));if(a.renderEmbeddables===!1||(x==null?void 0:x.type)==="document"){const D=i.ownerDocument.createElementNS(st,"a");D.setAttribute("href",ts(e.link||"")),D.setAttribute("target","_blank"),D.setAttribute("rel","noopener noreferrer"),D.style.borderRadius=`${k}px`,T.appendChild(D)}else{const D=i.ownerDocument.createElementNS(st,"foreignObject");D.style.width=`${e.width}px`,D.style.height=`${e.height}px`,D.style.border="none";const O=D.ownerDocument.createElementNS(st,"div");O.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),O.style.width="100%",O.style.height="100%";const L=O.ownerDocument.createElement("iframe");L.src=(x==null?void 0:x.link)??"",L.style.width="100%",L.style.height="100%",L.style.border="none",L.style.borderRadius=`${k}px`,L.style.top="0",L.style.left="0",L.allowFullscreen=!0,O.appendChild(L),D.appendChild(O),T.appendChild(D)}b(T);break}case"line":case"arrow":{const v=Le(e,t),I=i.ownerDocument.createElementNS(st,"mask");if(v){I.setAttribute("id",`mask-${e.id}`);const k=i.ownerDocument.createElementNS(st,"rect");s=s||0,o=o||0,k.setAttribute("x","0"),k.setAttribute("y","0"),k.setAttribute("fill","#fff"),k.setAttribute("width",`${e.width+100+s}`),k.setAttribute("height",`${e.height+100+o}`),I.appendChild(k);const x=i.ownerDocument.createElementNS(st,"rect"),D=pe.getBoundTextElementPosition(e,v,t),O=s+D.x-e.x,L=o+D.y-e.y;x.setAttribute("x",O.toString()),x.setAttribute("y",L.toString()),x.setAttribute("fill","#000"),x.setAttribute("width",`${v.width}`),x.setAttribute("height",`${v.height}`),x.setAttribute("opacity","1"),I.appendChild(x)}const C=i.ownerDocument.createElementNS(st,"g");v&&C.setAttribute("mask",`url(#mask-${e.id})`),C.setAttribute("stroke-linecap","round"),qt.generateElementShape(e,a).forEach(k=>{const x=y1(n,k,l1);y!==1&&(x.setAttribute("stroke-opacity",`${y}`),x.setAttribute("fill-opacity",`${y}`)),x.setAttribute("transform",`translate(${s||0} ${o||0}) rotate(${p} ${h} ${m})`),e.type==="line"&&Jo(e.points)&&e.backgroundColor!=="transparent"&&x.setAttribute("fill-rule","evenodd"),C.appendChild(x)});const T=E1(e,U,[C,I],a.frameRendering,t);T?(b(T),U.appendChild(T)):(b(C),U.append(I));break}case"freedraw":{const v=qt.generateElementShape(e,a),I=v?y1(n,v,l1):i.ownerDocument.createElementNS(st,"g");y!==1&&(I.setAttribute("stroke-opacity",`${y}`),I.setAttribute("fill-opacity",`${y}`)),I.setAttribute("transform",`translate(${s||0} ${o||0}) rotate(${p} ${h} ${m})`),I.setAttribute("stroke","none");const C=i.ownerDocument.createElementNS(st,"path");C.setAttribute("fill",e.strokeColor),C.setAttribute("d",Zz(e)),I.appendChild(C);const _=E1(e,U,[I],a.frameRendering,t);b(_||I);break}case"image":{const v=Math.round(e.width),I=Math.round(e.height),C=Dn(e)&&r[e.fileId];if(C){const{reuseImages:_=!0}=a;let T=`image-${C.id}`,k=e.width,x=e.height;e.crop&&({width:k,height:x}=ul(e),T=`image-crop-${C.id}-${B9(`${k}x${x}`)}`),_||(T=`image-${e.id}`);let D=i.querySelector(`#${T}`);if(!D){D=i.ownerDocument.createElementNS(st,"symbol"),D.id=T;const j=i.ownerDocument.createElementNS(st,"image");j.setAttribute("href",C.dataURL),j.setAttribute("preserveAspectRatio","none"),e.crop||!_?(j.setAttribute("width",`${k}`),j.setAttribute("height",`${x}`)):(j.setAttribute("width","100%"),j.setAttribute("height","100%")),D.appendChild(j),(U.querySelector("defs")||U).prepend(D)}const O=i.ownerDocument.createElementNS(st,"use");O.setAttribute("href",`#${T}`),a.exportWithDarkMode&&C.mimeType!==Te.svg&&O.setAttribute("filter",Vz);let L=0,Y=0;if(e.crop){const{width:j,height:X}=ul(e);L=e.crop.x/(e.crop.naturalWidth/j),Y=e.crop.y/(e.crop.naturalHeight/X)}const $=h+L,H=m+Y;O.setAttribute("width",`${v+L}`),O.setAttribute("height",`${I+Y}`),O.setAttribute("opacity",`${y}`),(e.scale[0]!==1||e.scale[1]!==1)&&O.setAttribute("transform",`translate(${$} ${H}) scale(${e.scale[0]} ${e.scale[1]}) translate(${-$} ${-H})`);const z=i.ownerDocument.createElementNS(st,"g");if(e.crop){const j=i.ownerDocument.createElementNS(st,"mask");j.setAttribute("id",`mask-image-crop-${e.id}`),j.setAttribute("fill","#fff");const X=i.ownerDocument.createElementNS(st,"rect");X.setAttribute("x",`${L}`),X.setAttribute("y",`${Y}`),X.setAttribute("width",`${v}`),X.setAttribute("height",`${I}`),j.appendChild(X),U.appendChild(j),z.setAttribute("mask",`url(#${j.id})`)}if(z.appendChild(O),z.setAttribute("transform",`translate(${s-L} ${o-Y}) rotate(${p} ${$} ${H})`),e.roundness){const j=i.ownerDocument.createElementNS(st,"clipPath");j.id=`image-clipPath-${e.id}`;const X=i.ownerDocument.createElementNS(st,"rect"),K=ur(Math.min(e.width,e.height),e);X.setAttribute("width",`${e.width}`),X.setAttribute("height",`${e.height}`),X.setAttribute("rx",`${K}`),X.setAttribute("ry",`${K}`),j.appendChild(X),b(j),z.setAttributeNS(st,"clip-path",`url(#${j.id})`)}const G=E1(e,U,[z],a.frameRendering,t);b(G||z)}break}case"frame":case"magicframe":{if(a.frameRendering.enabled&&a.frameRendering.outline){const v=document.createElementNS(st,"rect");v.setAttribute("transform",`translate(${s||0} ${o||0}) rotate(${p} ${h} ${m})`),v.setAttribute("width",`${e.width}px`),v.setAttribute("height",`${e.height}px`),v.setAttribute("rx",zt.radius.toString()),v.setAttribute("ry",zt.radius.toString()),v.setAttribute("fill","none"),v.setAttribute("stroke",zt.strokeColor),v.setAttribute("stroke-width",zt.strokeWidth.toString()),b(v)}break}default:if(ge(e)){const v=i.ownerDocument.createElementNS(st,"g");y!==1&&(v.setAttribute("stroke-opacity",`${y}`),v.setAttribute("fill-opacity",`${y}`)),v.setAttribute("transform",`translate(${s||0} ${o||0}) rotate(${p} ${h} ${m})`);const I=e.text.replace(/\r\n?/g,`
`).split(`
`),C=Sp(e.fontSize,e.lineHeight),_=e.textAlign==="center"?e.width/2:e.textAlign==="right"?e.width:0,T=IB(e.fontFamily,e.fontSize,C),k=VB(e.text)?"rtl":"ltr",x=e.textAlign==="center"?"middle":e.textAlign==="right"||k==="rtl"?"end":"start";for(let O=0;O<I.length;O++){const L=i.ownerDocument.createElementNS(st,"text");L.textContent=I[O],L.setAttribute("x",`${_}`),L.setAttribute("y",`${O*C+T}`),L.setAttribute("font-family",Ep(e)),L.setAttribute("font-size",`${e.fontSize}px`),L.setAttribute("fill",e.strokeColor),L.setAttribute("text-anchor",x),L.setAttribute("style","white-space: pre;"),L.setAttribute("direction",k),L.setAttribute("dominant-baseline","alphabetic"),v.appendChild(L)}const D=E1(e,U,[v],a.frameRendering,t);b(D||v)}else throw new Error(`Unimplemented type ${e.type}`)}},rye=(e,t,n,i,r,s)=>{i&&(e.filter(o=>!Es(o)).forEach(o=>{if(!o.isDeleted){if(ge(o)&&o.containerId&&t.has(o.containerId))return;try{rb(o,t,n,i,r,o.x+s.offsetX,o.y+s.offsetY,s);const a=Le(o,t);a&&rb(a,t,n,i,r,a.x+s.offsetX,a.y+s.offsetY,s)}catch(a){console.error(a)}}}),e.filter(o=>Es(o)).forEach(o=>{if(!o.isDeleted)try{rb(o,t,n,i,r,o.x+s.offsetX,o.y+s.offsetY,s)}catch(a){console.error(a)}}))},sye=(e,t)=>{if(e.width<=t)return e;const i=document.createElement("canvas").getContext("2d");i.font=mt({fontFamily:e.fontFamily,fontSize:e.fontSize});let r=e.text;if(i.measureText(r).width>t)for(let o=r.length;o>0;o--){const a=`${r.slice(0,o)}...`;if(i.measureText(a).width<=t){r=a;break}}return Ie(e,{text:r,width:t})},oye=(e,t)=>{const n=[];for(const i of e){if(we(i)){let r=os({x:i.x,y:i.y-zt.nameOffsetY,fontFamily:nt.Helvetica,fontSize:zt.nameFontSize,lineHeight:zt.nameLineHeight,strokeColor:t.exportWithDarkMode?zt.nameColorDarkTheme:zt.nameColorLightTheme,text:zz(i)});r.y-=r.height,r=sye(r,i.width),n.push(r)}n.push(i)}return n},mX=(e,t)=>(t=t||sa().frameRendering,{enabled:e?!0:t.enabled,outline:e?!1:t.outline,name:e?!1:t.name,clip:e?!0:t.clip}),pX=({elements:e,exportingFrame:t,frameRendering:n,exportWithDarkMode:i})=>{let r;return t?r=S9(e,t):n.enabled&&n.name?r=oye(e,{exportWithDarkMode:i}):r=e,r},UX=async(e,t,n,{exportBackground:i,exportPadding:r=vg,viewBackgroundColor:s,exportingFrame:o},a=(c,d)=>{const u=document.createElement("canvas");return u.width=c*t.exportScale,u.height=d*t.exportScale,{canvas:u,scale:t.exportScale}},l=async()=>{await nl.loadElementsFonts(e)})=>{await l();const c=mX(o??null,t.frameRendering??null);o&&(c.clip=!1);const d=pX({elements:e,exportingFrame:o,exportWithDarkMode:t.exportWithDarkMode,frameRendering:c});o&&(r=0);const[u,f,h,m]=PT(o?[o]:T9(d),r),{canvas:p,scale:U=1}=a(h,m),b=sa(),{imageCache:y}=await UH({imageCache:new Map,fileIds:bH(d).map(w=>w.fileId),files:n});return gX({canvas:p,rc:od.canvas(p),elementsMap:Qo(ve(d)),allElementsMap:Qo(ve(cd(e))),visibleElements:d,scale:U,appState:{...t,frameRendering:c,viewBackgroundColor:i?s:null,scrollX:-u+r,scrollY:-f+r,zoom:b.zoom,shouldCacheIgnoreZoom:!1,theme:t.exportWithDarkMode?ke.DARK:ke.LIGHT},renderConfig:{canvasBackgroundColor:s,imageCache:y,renderGrid:!1,isExporting:!0,embedsValidationStatus:new Map,elementsPendingErasure:new Set,pendingFlowchartNodes:null}}),p},j1=e=>document.createComment(` ${e} `),OT=async(e,t,n,i)=>{const r=mX((i==null?void 0:i.exportingFrame)??null,t.frameRendering??null);let{exportPadding:s=vg,exportWithDarkMode:o=!1,viewBackgroundColor:a,exportScale:l=1,exportEmbedScene:c}=t;const{exportingFrame:d=null}=i||{},u=pX({elements:e,exportingFrame:d,exportWithDarkMode:o,frameRendering:r});d&&(s=0);const[f,h,m,p]=PT(d?[d]:T9(u),s),U=-f+s,b=-h+s,y=document.createElementNS(st,"svg");y.setAttribute("version","1.1"),y.setAttribute("xmlns",st),y.setAttribute("viewBox",`0 0 ${m} ${p}`),y.setAttribute("width",`${m*l}`),y.setAttribute("height",`${p*l}`),o&&y.setAttribute("filter",z_);const w=y.ownerDocument.createElementNS(st,"defs"),v=y.ownerDocument.createElementNS(st,"metadata");if(y.appendChild(j1("svg-source:excalidraw")),y.appendChild(v),y.appendChild(w),c)try{aye({metadataElement:v,payload:Lg(e,t,n||{},"local")})}catch(D){console.error(D)}const I=_9(e);if(I.length){const D=ve(e);for(const O of I){const L=y.ownerDocument.createElementNS(st,"clipPath");L.setAttribute("id",O.id);const[Y,$,H,z]=$e(O,D),G=(H-Y)/2-(O.x-Y),j=(z-$)/2-(O.y-$),X=y.ownerDocument.createElementNS(st,"rect");X.setAttribute("transform",`translate(${O.x+U} ${O.y+b}) rotate(${O.angle} ${G} ${j})`),X.setAttribute("width",`${O.width}`),X.setAttribute("height",`${O.height}`),d||(X.setAttribute("rx",`${zt.radius}`),X.setAttribute("ry",`${zt.radius}`)),L.appendChild(X),w.appendChild(L)}}const C=i!=null&&i.skipInliningFonts?[]:await nl.generateFontFaceDeclarations(e),_=`
      `,T=y.ownerDocument.createElementNS(st,"style");if(T.classList.add("style-fonts"),T.appendChild(document.createTextNode(`${_}${C.join(_)}`)),w.appendChild(T),t.exportBackground&&a){const D=y.ownerDocument.createElementNS(st,"rect");D.setAttribute("x","0"),D.setAttribute("y","0"),D.setAttribute("width",`${m}`),D.setAttribute("height",`${p}`),D.setAttribute("fill",a),y.appendChild(D)}const k=od.svg(y),x=(i==null?void 0:i.renderEmbeddables)??!1;return rye(u,Qo(ve(u)),k,y,n||{},{offsetX:U,offsetY:b,isExporting:!0,exportWithDarkMode:o,renderEmbeddables:x,frameRendering:r,canvasBackgroundColor:a,embedsValidationStatus:x?new Map(u.filter(D=>we(D)).map(D=>[D.id,!0])):new Map,reuseImages:(i==null?void 0:i.reuseImages)??!0}),y},aye=({payload:e,metadataElement:t})=>{const n=eX(JSON.stringify(nX({text:e})),!0);t.appendChild(j1(`payload-type:${Te.excalidraw}`)),t.appendChild(j1("payload-version:2")),t.appendChild(j1("payload-start")),t.appendChild(document.createTextNode(n)),t.appendChild(j1("payload-end"))},lye=({svg:e})=>{if(e.includes(`payload-type:${Te.excalidraw}`)){const t=e.match(/<!-- payload-start -->\s*(.+?)\s*<!-- payload-end -->/);if(!t)throw new Error("INVALID");const n=e.match(/<!-- payload-version:(\d+) -->/),r=((n==null?void 0:n[1])||"1")!=="1";try{const s=tX(t[1],r),o=JSON.parse(s);if(!("encoded"in o)){if("type"in o&&o.type===Cs.excalidraw)return s;throw new Error("FAILED")}return iX(o)}catch(s){throw console.error(s),new Error("FAILED")}}throw new Error("INVALID")},PT=(e,t)=>{const[n,i,r,s]=ht(e),o=Gi(n,r)+t*2,a=Gi(i,s)+t*2;return[n,i,o,a]},cye=(e,t,n)=>{const[,,i,r]=PT(e,t).map(s=>Math.trunc(s*n));return[i,r]},dye={selection:!0,lasso:!0,text:!0,rectangle:!0,diamond:!0,ellipse:!0,line:!0,image:!0,arrow:!0,freedraw:!0,eraser:!1,custom:!0,frame:!0,embeddable:!0,hand:!0,laser:!1,magicframe:!1},uye=e=>Object.keys(nt).includes(e)?nt[e]:sd,gf=(e,t)=>{if(!t)return null;const n=t.focus||0;return me(e)?Vh(t)?{...t,focus:n,fixedPoint:ly(t.fixedPoint??[0,0])}:null:{...t,focus:n}},Bl=(e,t)=>{const n={type:t.type||e.type,version:e.version||1,versionNonce:e.versionNonce??0,index:e.index??null,isDeleted:e.isDeleted??!1,id:e.id||gr(),fillStyle:e.fillStyle||mn.fillStyle,strokeWidth:e.strokeWidth||mn.strokeWidth,strokeStyle:e.strokeStyle??mn.strokeStyle,roughness:e.roughness??mn.roughness,opacity:e.opacity==null?mn.opacity:e.opacity,angle:e.angle||0,x:t.x??e.x??0,y:t.y??e.y??0,strokeColor:e.strokeColor||mn.strokeColor,backgroundColor:e.backgroundColor||mn.backgroundColor,width:e.width||0,height:e.height||0,seed:e.seed??1,groupIds:e.groupIds??[],frameId:e.frameId??null,roundness:e.roundness?e.roundness:e.strokeSharpness==="round"?{type:$u(e.type)?yn.LEGACY:yn.PROPORTIONAL_RADIUS}:null,boundElements:e.boundElementIds?e.boundElementIds.map(r=>({type:"arrow",id:r})):e.boundElements??[],updated:e.updated??wg(),link:e.link?ts(e.link):null,locked:e.locked??!1};("customData"in e||"customData"in t)&&(n.customData="customData"in t?t.customData:e.customData);const i={...e,...n,...tH(n),...t};return delete i.strokeSharpness,delete i.boundElementIds,i},fye=(e,t)=>{var n;switch(e={...e},e.type){case"text":delete e.rawText;let i=e.fontSize,r=e.fontFamily;if("font"in e){const[f,h]=e.font.split(" ");i=parseFloat(f),r=uye(h)}const s=typeof e.text=="string"&&e.text||"",o=e.lineHeight||(e.height?xae(e):zc(e.fontFamily));return e=Bl(e,{fontSize:i,fontFamily:r,text:s,textAlign:e.textAlign||Up,verticalAlign:e.verticalAlign||Kb,containerId:e.containerId??null,originalText:e.originalText||s,autoResize:e.autoResize??!0,lineHeight:o}),t!=null&&t.deleteInvisibleElements&&!s&&!e.isDeleted&&(e={...e,originalText:s,isDeleted:!0},e=Pa(e)),e;case"freedraw":return Bl(e,{points:e.points,lastCommittedPoint:null,simulatePressure:e.simulatePressure,pressures:e.pressures});case"image":return Bl(e,{status:e.status||"pending",fileId:e.fileId,scale:e.scale||[1,1],crop:e.crop??null});case"line":case"draw":const{startArrowhead:a=null,endArrowhead:l=null}=e;let c=e.x,d=e.y,u=!Array.isArray(e.points)||e.points.length<2?[S(0,0),S(e.width,e.height)]:e.points;return(u[0][0]!==0||u[0][1]!==0)&&({points:u,x:c,y:d}=pe.getNormalizeElementPointsAndCoords(e)),Bl(e,{type:e.type==="draw"?"line":e.type,startBinding:gf(e,e.startBinding),endBinding:gf(e,e.endBinding),lastCommittedPoint:null,startArrowhead:a,endArrowhead:l,points:u,x:c,y:d,...nn(e)?{polygon:L4(e.points)?e.polygon??!1:!1}:{},...zh(u)});case"arrow":{const{startArrowhead:f=null,endArrowhead:h="arrow"}=e;let m=e.x,p=e.y,U=!Array.isArray(e.points)||e.points.length<2?[S(0,0),S(e.width,e.height)]:e.points;(U[0][0]!==0||U[0][1]!==0)&&({points:U,x:m,y:p}=pe.getNormalizeElementPointsAndCoords(e));const b={type:e.type,startBinding:gf(e,e.startBinding),endBinding:gf(e,e.endBinding),lastCommittedPoint:null,startArrowhead:f,endArrowhead:h,points:U,x:m,y:p,elbowed:e.elbowed,...zh(U)};return me(e)?Bl(e,{...b,elbowed:!0,startBinding:gf(e,e.startBinding),endBinding:gf(e,e.endBinding),fixedSegments:(n=e.fixedSegments)!=null&&n.length&&b.points.length>=4?e.fixedSegments:null,startIsSpecial:e.startIsSpecial,endIsSpecial:e.endIsSpecial}):Bl(e,b)}case"ellipse":case"rectangle":case"diamond":case"iframe":case"embeddable":return Bl(e,{});case"magicframe":case"frame":return Bl(e,{name:e.name??null})}return null},hye=(e,t)=>{if(e.boundElements){const n=e.boundElements.slice(),i=new Set;e.boundElements=n.reduce((r,s)=>{const o=t.get(s.id);if(o&&!i.has(s.id)){if(i.add(s.id),o.isDeleted)return r;r.push(s),ge(o)&&!o.containerId&&(o.containerId=e.id)}return r},[])}},gye=(e,t)=>{const n=e.containerId?t.get(e.containerId):null;if(e.angle=Ce(n)?0:(n==null?void 0:n.angle)??0,!n){e.containerId=null;return}if(!e.isDeleted&&n.boundElements&&!n.boundElements.find(i=>i.id===e.id)){const i=(n.boundElements||(n.boundElements=[])).slice();i.push({type:"text",id:e.id}),n.boundElements=i}},mye=(e,t)=>{e.frameId&&(t.get(e.frameId)||(e.frameId=null))},xu=(e,t,n)=>{const i=new Set,r=t?ve(t):null,s=cd((e||[]).reduce((a,l)=>{if(l.type==="selection")return a;let c=fye(l,{deleteInvisibleElements:n==null?void 0:n.deleteInvisibleElements});if(c){const d=r==null?void 0:r.get(l.id),u=(n==null?void 0:n.deleteInvisibleElements)&&tl(l);(u||d&&d.version>c.version)&&(c=Pa(c,d==null?void 0:d.version)),u&&(c={...c,isDeleted:!0}),i.has(c.id)&&(c={...c,id:gr()}),i.add(c.id),a.push(c)}return a},[]));if(!(n!=null&&n.repairBindings))return s;const o=ve(s);for(const a of s)a.frameId&&mye(a,o),ge(a)&&a.containerId?gye(a,o):a.boundElements&&hye(a,o),n.refreshDimensions&&ge(a)&&Object.assign(a,fH(a,Yn(a,o),o)),xe(a)&&(a.startBinding&&(!o.has(a.startBinding.elementId)||!Ce(a))&&(a.startBinding=null),a.endBinding&&(!o.has(a.endBinding.elementId)||!Ce(a))&&(a.endBinding=null));return s.map(a=>{if(me(a)&&!cz(a)&&!Tz(a.points))return{...a,..._g(a,o,{points:[S(0,0),a.points[a.points.length-1]]}),index:a.index};if(me(a)&&a.startBinding&&a.endBinding&&a.startBinding.elementId===a.endBinding.elementId&&a.points.length>1&&a.points.some(([l,c])=>Math.abs(l)>1e6||Math.abs(c)>1e6)){console.error("Fixing self-bound elbow arrow",a.id);const l=o.get(a.startBinding.elementId);return l?{...a,x:l.x+l.width/2,y:l.y-5,width:l.width,height:l.height,points:[S(0,0),S(0,-10),S(l.width/2+5,-10),S(l.width/2+5,l.height/2+5)]}:(console.error("Bound element not found",a.startBinding.elementId),a)}return a})},pye=(e,t,n)=>{const i=t[e];return i!==void 0?i:n[e]},FR={isSidebarDocked:(e,t)=>["defaultSidebarDockedPreference",e.isSidebarDocked??pye("defaultSidebarDockedPreference",e,t)]},bX=(e,t)=>{var r;e=e||{};const n=sa(),i={};for(const s of Object.keys(FR))if(s in e){const[o,a]=FR[s](e,n);i[o]=a}for(const[s,o]of Object.entries(n)){const a=e[s],l=t?t[s]:void 0;i[s]=a!==void 0?a:l!==void 0?l:o}return{...i,cursorButton:(t==null?void 0:t.cursorButton)||"up",penDetected:(t==null?void 0:t.penDetected)??(e.penMode?e.penDetected??!1:!1),activeTool:{...tn(n,i.activeTool.type&&dye[i.activeTool.type]?i.activeTool:{type:"selection"}),lastActiveTool:null,locked:i.activeTool.locked??!1},zoom:{value:Xa(v0(e.zoom)?e.zoom:((r=e.zoom)==null?void 0:r.value)??n.zoom.value)},openSidebar:typeof e.openSidebar=="string"?{name:As.name}:i.openSidebar,gridSize:vue(v0(e.gridSize)?e.gridSize:qb),gridStep:kV(v0(e.gridStep)?e.gridStep:yB),editingFrame:null}},Cu=(e,t,n,i)=>({elements:xu(e==null?void 0:e.elements,n,i),appState:bX(e==null?void 0:e.appState,t||null),files:(e==null?void 0:e.files)||{}}),BR=e=>{const t=xu(Yt(e.elements),null);return t.length?{...e,elements:t}:null},jy=(e=[],t)=>{const n=[];for(const i of e)if(Array.isArray(i)){const r=BR({status:t,elements:i,id:gr(),created:Date.now()});r&&n.push(r)}else{const r=i,s=BR({...r,id:r.id||gr(),status:r.status||t,created:r.created||Date.now()});s&&n.push(s)}return n},yX=async e=>{let t;if(e.type===Te.png)try{return await(await ye(()=>Promise.resolve().then(()=>ZX),void 0)).decodePngMetadata(e)}catch(n){throw n.message==="INVALID"?new Fd("Image doesn't contain scene","IMAGE_NOT_CONTAINS_SCENE_DATA"):new Fd("Error: cannot restore image")}else if("text"in Blob?t=await e.text():t=await new Promise(n=>{const i=new FileReader;i.readAsText(e,"utf8"),i.onloadend=()=>{i.readyState===FileReader.DONE&&n(i.result)}}),e.type===Te.svg)try{return lye({svg:t})}catch(n){throw n.message==="INVALID"?new Fd("Image doesn't contain scene","IMAGE_NOT_CONTAINS_SCENE_DATA"):new Fd("Error: cannot restore image")}return t},EX=e=>{var t;return e&&((t=e.name.match(/\.(json|excalidraw|png|svg)$/))==null?void 0:t[1])||null},Uye=e=>e==="png"||e==="svg",FT=e=>{const t=EX(e);return t==="png"||t==="svg"},vX=e=>!!e&&Object.values(Fh).includes(e),Om=e=>{const{type:t}=e||{};return vX(t)},wX=async(e,t,n,i)=>{const r=await yX(e);let s;try{try{s=JSON.parse(r)}catch(o){throw Om(e)?new Fd("Image doesn't contain scene","IMAGE_NOT_CONTAINS_SCENE_DATA"):o}if(Z5e(s))return{type:Te.excalidraw,data:Cu({elements:MH(s.elements||[]),appState:{theme:t==null?void 0:t.theme,fileHandle:i||e.handle||null,...cG(s.appState||{}),...t?wm(s.elements||[],t):{}},files:s.files},t,n,{repairBindings:!0,refreshDimensions:!1,deleteInvisibleElements:!0})};if(lX(s))return{type:Te.excalidrawlib,data:s};throw new Error("Error: invalid file")}catch(o){throw o instanceof Fd?o:new Error("Error: invalid file")}},BT=async(e,t,n,i)=>{const r=await wX(e,t,n,i);if(r.type!==Te.excalidraw)throw new Error("Error: invalid file");return r.data},_X=(e,t="unpublished")=>{const n=JSON.parse(e);if(!lX(n))throw new Error("Invalid library");const i=n.libraryItems||n.library;return jy(i,t)},bye=async(e,t="unpublished")=>_X(await yX(e),t),Pm=async e=>new Promise(async(t,n)=>{try{_p(e)&&(e=await e),e.toBlob(i=>{if(!i)return n(new dhe("Error: Canvas too big","CANVAS_POSSIBLY_TOO_BIG"));t(i)})}catch(i){n(i)}}),yye=async e=>{try{const t=await window.crypto.subtle.digest("SHA-1",await Hp(e));return XB(new Uint8Array(t))}catch(t){return console.error(t),DH(40)}},TX=async e=>new Promise((t,n)=>{const i=new FileReader;i.onload=()=>{const r=i.result;t(r)},i.onerror=r=>n(r),i.readAsDataURL(e)}),Eye=(e,t)=>`data:${t};base64,${eX(Y6(e),!0)}`,vye=e=>tX(e.slice(e.indexOf(",")+1)),IX=async(e,t)=>{if(e.type===Te.svg)return e;const[n,i]=await Promise.all([ye(()=>import("./pica-55E-7_ef.js").then(s=>s.p),__vite__mapDeps([2,3])).then(s=>s.default),ye(()=>import("./image-blob-reduce.esm-B6b2_-a4.js"),__vite__mapDeps([])).then(s=>s.default)]),r=i({pica:n({features:["js","wasm"]})});if(t.outputType){const{outputType:s}=t;r._create_blob=function(o){return this.pica.toBlob(o.out_canvas,s,.8).then(a=>(o.out_blob=a,o))}}if(!Om(e))throw new Error("Error: unsupported file type",{cause:"UNSUPPORTED"});return new File([await r.toBlob(e,{max:t.maxWidthOrHeight,alpha:!0})],e.name,{type:t.outputType||e.type})},zR=(e,t="")=>new File([new TextEncoder().encode(e)],t,{type:Te.svg}),wye=async(e,t="")=>{let n;try{n=await fetch(e)}catch{throw new Error("Error: failed to fetch image",{cause:"FETCH_ERROR"})}if(!n.ok)throw new Error("Error: failed to fetch image",{cause:"FETCH_ERROR"});const i=await n.blob();if(i.type&&Om(i)){const r=t||i.name||"";return new File([i],r,{type:i.type})}throw new Error("Error: unsupported file type",{cause:"UNSUPPORTED"})},_ye=async e=>{var t,n;if(Wu)try{return await(e instanceof DataTransferItem?e:(n=(t=e.dataTransfer)==null?void 0:t.items)==null?void 0:n[0]).getAsFileSystemHandle()||null}catch(i){return console.warn(i.name,i.message),null}return null},Tye=async e=>{let t=null;const n=[...new Uint8Array(await Hp(e.slice(0,15)))].join(" "),i={png:/^137 80 78 71 13 10 26 10\b/,jpg:/^255 216 255\b/,gif:/^71 73 70 56 57 97\b/,webp:/^82 73 70 70 \d+ \d+ \d+ \d+ 87 69 66 80 86 80 56\b/};for(const r of Object.keys(i))if(n.match(i[r])){t=Te[r];break}return t||e.type||null},sb=(e,t,n)=>new File([e],n||"",{type:t}),HR=Symbol("fileNormalized"),Fm=async e=>{var t,n,i;if(e[HR])return e;if((t=e==null?void 0:e.name)!=null&&t.endsWith(".excalidrawlib"))e=sb(e,Te.excalidrawlib,e.name);else if((n=e==null?void 0:e.name)!=null&&n.endsWith(".excalidraw"))e=sb(e,Te.excalidraw,e.name);else if(!e.type||(i=e.type)!=null&&i.startsWith("image/")){const r=await Tye(e);r&&r!==e.type&&(e=sb(e,r,e.name))}return e[HR]=!0,e},Hp=e=>"arrayBuffer"in e?e.arrayBuffer():new Promise((t,n)=>{const i=new FileReader;i.onload=r=>{var s;if(!((s=r.target)!=null&&s.result))return n(new Error("Couldn't convert blob to ArrayBuffer"));t(r.target.result)},i.readAsArrayBuffer(e)}),eo=32,Pt=12,Cc=256,SX=50,Rd="NOT_SPREADSHEET",Bm="VALID_SPREADSHEET",Y1=e=>{const t=/^([-+]?)[$]?([-+]?)([\d.,]+)[%]?$/.exec(e);return t?parseFloat(`${(t[1]||t[2])+t[3]}`.replace(/,/g,"")):null},C3=(e,t)=>e.slice(1).every(n=>Y1(n[t])!==null),VR=e=>{const t=e[0].length;if(t>2)return{type:Rd,reason:"More than 2 columns"};if(t===1){if(!C3(e,0))return{type:Rd,reason:"Value is not numeric"};const l=Y1(e[0][0])===null,c=(l?e.slice(1):e).map(d=>Y1(d[0]));return c.length<2?{type:Rd,reason:"Less than two rows"}:{type:Bm,spreadsheet:{title:l?e[0][0]:null,labels:null,values:c}}}const n=C3(e,0),i=C3(e,1);if(!n&&!i)return{type:Rd,reason:"Value is not numeric"};const[r,s]=i?[0,1]:[1,0],o=Y1(e[0][s])===null,a=o?e.slice(1):e;return a.length<2?{type:Rd,reason:"Less than 2 rows"}:{type:Bm,spreadsheet:{title:o?e[0][s]:null,labels:a.map(l=>l[r]),values:a.map(l=>Y1(l[s]))}}},Iye=e=>{const t=[];for(let n=0;n<e[0].length;n++){const i=[];for(let r=0;r<e.length;r++)i.push(e[r][n]);t.push(i)}return t},Sye=e=>{let t=e.trim().split(`
`).map(s=>s.trim().split("	"));if(t.length&&t[0].length!==2&&(t=e.trim().split(`
`).map(s=>s.trim().split(","))),t.length===0)return{type:Rd,reason:"No values"};const n=t[0].length;if(!t.every(s=>s.length===n))return{type:Rd,reason:"All rows don't have same number of columns"};const r=VR(t);if(r.type!==Bm){const s=VR(Iye(t));if(s.type===Bm)return s}return r},Z6=kre(Cre),lo={fillStyle:"hachure",fontFamily:sd,fontSize:Il,opacity:100,roughness:1,strokeColor:Ye.black,roundness:null,strokeStyle:"solid",strokeWidth:1,verticalAlign:Yr.MIDDLE,locked:!1},xX=e=>{const t=(eo+Pt)*e.values.length+Pt,n=Cc+Pt*2;return{chartWidth:t,chartHeight:n}},xye=(e,t,n,i,r)=>{var s;return((s=e.labels)==null?void 0:s.map((o,a)=>os({groupIds:[i],backgroundColor:r,...lo,text:o.length>8?`${o.slice(0,5)}...`:o,x:t+a*(eo+Pt)+Pt*2,y:n+Pt/2,width:eo,angle:5.87,fontSize:16,textAlign:"center",verticalAlign:"top"})))||[]},Cye=(e,t,n,i,r)=>{const s=os({groupIds:[i],backgroundColor:r,...lo,x:t-Pt,y:n-Pt,text:"0",textAlign:"right"}),o=os({groupIds:[i],backgroundColor:r,...lo,x:t-Pt,y:n-Cc-s.height/2,text:Math.max(...e.values).toLocaleString(),textAlign:"right"});return[s,o]},Aye=(e,t,n,i,r)=>{const{chartWidth:s,chartHeight:o}=xX(e),a=Tc({backgroundColor:r,groupIds:[i],...lo,type:"line",x:t,y:n,width:s,points:[S(0,0),S(s,0)]}),l=Tc({backgroundColor:r,groupIds:[i],...lo,type:"line",x:t,y:n,height:o,points:[S(0,0),S(0,-280)]}),c=Tc({backgroundColor:r,groupIds:[i],...lo,type:"line",x:t,y:n-Cc-Pt,strokeStyle:"dotted",width:s,opacity:SX,points:[S(0,0),S(s,0)]});return[a,l,c]},CX=(e,t,n,i,r,s)=>{const{chartWidth:o}=xX(e),a=e.title?os({backgroundColor:r,groupIds:[i],...lo,text:e.title,x:t+o/2,y:n-Cc-Pt*2-Il,roundness:null,textAlign:"center"}):null;return[...a?[a]:[],...xye(e,t,n,i,r),...Cye(e,t,n,i,r),...Aye(e,t,n,i,r)]},Mye=(e,t,n)=>{const i=Math.max(...e.values),r=gr(),s=Z6[Math.floor(Math.random()*Z6.length)];return[...e.values.map((a,l)=>{const c=a/i*Cc;return ia({backgroundColor:s,groupIds:[r],...lo,type:"rectangle",x:t+l*(eo+Pt)+Pt,y:n-c-Pt,width:eo,height:c})}),...CX(e,t,n,r,s)]},kye=(e,t,n)=>{const i=Math.max(...e.values),r=gr(),s=Z6[Math.floor(Math.random()*Z6.length)];let o=0;const a=[];for(const p of e.values){const U=o*(eo+Pt),b=-(p/i)*Cc;a.push([U,b]),o++}const l=Math.max(...a.map(p=>p[0])),c=Math.max(...a.map(p=>p[1])),d=Math.min(...a.map(p=>p[0])),u=Math.min(...a.map(p=>p[1])),f=Tc({backgroundColor:s,groupIds:[r],...lo,type:"line",x:t+Pt+eo/2,y:n-Pt,height:c-u,width:l-d,strokeWidth:2,points:a}),h=e.values.map((p,U)=>{const b=U*(eo+Pt)+Pt/2,y=-(p/i)*Cc+Pt/2;return ia({backgroundColor:s,groupIds:[r],...lo,fillStyle:"solid",strokeWidth:2,type:"ellipse",x:t+b+eo/2,y:n+y-Pt*2,width:Pt,height:Pt})}),m=e.values.map((p,U)=>{const b=U*(eo+Pt)+Pt/2,y=p/i*Cc+Pt/2+Pt;return Tc({backgroundColor:s,groupIds:[r],...lo,type:"line",x:t+b+eo/2+Pt/2,y:n-y,height:y,strokeStyle:"dotted",opacity:SX,points:[S(0,0),S(0,y)]})});return[...CX(e,t,n,r,s),f,...m,...h]},Rye=(e,t,n,i)=>e==="line"?kye(t,n,i):Mye(t,n,i),zT="clipboard"in navigator&&"writeText"in navigator.clipboard,HT="clipboard"in navigator&&"write"in navigator.clipboard&&"ClipboardItem"in window&&"toBlob"in HTMLCanvasElement.prototype,Dye=e=>!!([Cs.excalidraw,Cs.excalidrawClipboard,Cs.excalidrawClipboardWithAPI].includes(e==null?void 0:e.type)&&Array.isArray(e.elements)),Lye=({types:e,files:t})=>{var i,r,s,o,a;!e&&!t&&console.warn("createPasteEvent: no types or files provided");const n=new ClipboardEvent(te.PASTE,{clipboardData:new DataTransfer});if(e)for(const[l,c]of Object.entries(e)){if(typeof c!="string"){t=t||[],t.push(c),(i=n.clipboardData)==null||i.items.add(c);continue}try{if((r=n.clipboardData)==null||r.items.add(c,l),((s=n.clipboardData)==null?void 0:s.getData(l))!==c)throw new Error(`Failed to set "${l}" as clipboardData item`)}catch(d){throw new Error(d.message)}}if(t){let l=-1;for(const c of t){l++;try{if((o=n.clipboardData)==null||o.items.add(c),((a=n.clipboardData)==null?void 0:a.files[l])!==c)throw new Error(`Failed to set file "${c.name}" as clipboardData item`)}catch(d){throw new Error(d.message)}}}return n},Nye=({elements:e,files:t})=>{const n=ve(e),i=new Set(e.filter(a=>we(a)));let r=!1;const s=e.reduce((a,l)=>(Dn(l)&&(r=!0,t&&t[l.fileId]&&(a[l.fileId]=t[l.fileId])),a),{});r&&!t&&console.warn("copyToClipboard: attempting to file element(s) without providing associated `files` object.");const o={type:Cs.excalidrawClipboard,elements:e.map(a=>{if(Cr(a,n)&&!i.has(Cr(a,n))){const l=Gc(a);return _i(l,n,{frameId:null}),l}return a}),files:t?s:void 0};return JSON.stringify(o)},Oye=async(e,t,n)=>{await ud(Nye({elements:e,files:t}),n)},Pye=e=>{const t=Sye(e);return t.type===Bm?{spreadsheet:t.spreadsheet}:null};function AX(e){var n;let t=[];for(const i of e.childNodes)if(i.nodeType===3){const r=(n=i.textContent)==null?void 0:n.trim();r&&t.push({type:"text",value:r})}else if(i instanceof HTMLImageElement){const r=i.getAttribute("src");r&&r.startsWith("http")&&t.push({type:"imageUrl",value:r})}else t=t.concat(AX(i));return t}const Fye=e=>{const t=e.value;try{const n=new DOMParser().parseFromString(t,Te.html),i=AX(n.body);if(i.length)return{type:"mixedContent",value:i}}catch(n){console.error(`error in parseHTMLFromPaste: ${n.message}`)}return null},Bye=async()=>{var n,i,r,s;const e={};let t;try{t=await((n=navigator.clipboard)==null?void 0:n.read())}catch(o){try{if((i=navigator.clipboard)!=null&&i.readText){console.warn(`navigator.clipboard.readText() failed (${o.message}). Failling back to navigator.clipboard.read()`);const a=await((r=navigator.clipboard)==null?void 0:r.readText());if(a)return{[Te.text]:a}}}catch(a){if((s=navigator.clipboard)!=null&&s.read)console.warn(`navigator.clipboard.readText() failed (${a.message}). Failling back to navigator.clipboard.read()`);else{if(a.name==="DataError")return console.warn(`navigator.clipboard.read() error, clipboard is probably empty: ${a.message}`),e;throw a}}throw o}for(const o of t)for(const a of o.types)if(YB($re,a))try{if(a===Te.text||a===Te.html)e[a]=await(await o.getType(a)).text();else if(vX(a)){const l=await o.getType(a),c=sb(l,a,void 0);e[a]=c}else throw new io(`Unsupported clipboard type: ${a}`)}catch(l){console.warn(l instanceof io?l.message:`Cannot retrieve ${a} from clipboardItem: ${l.message}`)}return Object.keys(e).length===0&&console.warn("No clipboard data found from clipboard.read()."),e},zye=async(e,t=!1)=>{try{const n=e.findByType(Te.html),i=!t&&n&&Fye(n);return i?i.value.every(r=>r.type==="text")?{type:"text",value:e.getData(Te.text)??i.value.map(r=>r.value).join(`
`).trim()}:i:{type:"text",value:(e.getData(Te.text)||"").trim()}}catch{return{type:"text",value:""}}},Hye=function(e){return this.find(t=>t.type===e)||null},Vye=function(e){const t=this.find(n=>n.type===e);return(t==null?void 0:t.value)??null},$ye=function(){return this.filter(e=>e.kind==="file")},Sv=async e=>{var i,r;let t;Yye(e)?t=(i=e.clipboardData)==null?void 0:i.items:t=(r=e.dataTransfer)==null?void 0:r.items;const n=(await Promise.all(Array.from(t||[]).map(async s=>{var o;if(s.kind==="file"){let a=s.getAsFile();if(a){const l=await _ye(s);return a=await Fm(a),{type:a.type,kind:"file",file:a,fileHandle:l}}}else if(s.kind==="string"){const{type:a}=s;let l;return"clipboardData"in e&&e.clipboardData?l=(o=e.clipboardData)==null?void 0:o.getData(a):l=await new Promise(c=>{s.getAsString(d=>c(d))}),{type:a,kind:"string",value:l}}return null}))).filter(s=>s!=null);return Object.assign(n,{findByType:Hye,getData:Vye,getFiles:$ye})},Gye=async(e,t=!1)=>{const n=await zye(e,t);if(n.type==="mixedContent")return{mixedContent:n.value};try{const i=!t&&Pye(n.value);if(i)return i}catch(i){console.error(i)}try{const i=JSON.parse(n.value),r=i.type===Cs.excalidrawClipboardWithAPI;if(Dye(i))return{elements:i.elements,files:i.files,text:t?JSON.stringify(i.elements,null,2):void 0,programmaticAPI:r}}catch{}return{text:n.value}},Xye=async e=>{try{await navigator.clipboard.write([new window.ClipboardItem({[Te.png]:e})])}catch(t){if(_p(e))await navigator.clipboard.write([new window.ClipboardItem({[Te.png]:await e})]);else throw t}},ud=async(e,t)=>{var n,i;if(zT)try{await navigator.clipboard.writeText(e||"");return}catch(r){console.error(r)}try{if(t){if((n=t.clipboardData)==null||n.setData(Te.text,e||""),((i=t.clipboardData)==null?void 0:i.getData(Te.text))!==e)throw new Error("Failed to setData on clipboardEvent");return}}catch(r){console.error(r)}if(!jye(e))throw new Error("Error copying to clipboard.")},jye=e=>{e||(e=" ");const t=document.documentElement.getAttribute("dir")==="rtl",n=document.createElement("textarea");n.style.border="0",n.style.padding="0",n.style.margin="0",n.style.position="absolute",n.style[t?"right":"left"]="-9999px";const i=window.pageYOffset||document.documentElement.scrollTop;n.style.top=`${i}px`,n.style.fontSize="12pt",n.setAttribute("readonly",""),n.value=e,document.body.appendChild(n);let r=!1;try{n.select(),n.setSelectionRange(0,n.value.length),r=document.execCommand("copy")}catch(s){console.error(s)}return n.remove(),r},Yye=e=>e.type===te.PASTE||e.type===te.COPY||e.type===te.CUT,Yy=(e,{selectedElementIds:t},n)=>{e=Yt(e);const i=n&&Wn(e,{selectedElementIds:t});let r=null,s=i?Xe(e,{selectedElementIds:t},{includeBoundTextElement:!0}):e;return i&&(s.length===1&&we(s[0])?(r=s[0],s=S9(e,r)):s.length>1&&(s=Xe(e,{selectedElementIds:t},{includeBoundTextElement:!0,includeElementsInFrames:!0}))),{exportingFrame:r,exportedElements:Qa(s)}},Wy=async(e,t,n,i,{exportBackground:r,exportPadding:s=vg,viewBackgroundColor:o,name:a=n.name||_B,fileHandle:l=null,exportingFrame:c=null})=>{if(t.length===0)throw new Error(M("alerts.cannotExportEmptyCanvas"));if(e==="svg"||e==="clipboard-svg"){const u=OT(t,{exportBackground:r,exportWithDarkMode:n.exportWithDarkMode,viewBackgroundColor:o,exportPadding:s,exportScale:n.exportScale,exportEmbedScene:n.exportEmbedScene&&e==="svg"},i,{exportingFrame:c});if(e==="svg")return K6(u.then(f=>new Blob([qre+f.outerHTML],{type:Te.svg})),{description:"Export to SVG",name:a,extension:n.exportEmbedScene?"excalidraw.svg":"svg",mimeTypes:[Fh.svg],fileHandle:l});if(e==="clipboard-svg"){const f=await u.then(h=>h.outerHTML);try{await ud(f)}catch{throw new Error(M("errors.copyToSystemClipboardFailed"))}return}}const d=UX(t,n,i,{exportBackground:r,viewBackgroundColor:o,exportPadding:s,exportingFrame:c});if(e==="png"){let u=Pm(d);return n.exportEmbedScene&&(u=u.then(f=>ye(()=>Promise.resolve().then(()=>ZX),void 0).then(({encodePngMetadata:h})=>h({blob:f,metadata:Lg(t,n,i,"local")})))),K6(u,{description:"Export to PNG",name:a,extension:n.exportEmbedScene?"excalidraw.png":"png",mimeTypes:[Fh.png],fileHandle:l})}else if(e==="clipboard")try{const u=Pm(d);await Xye(u)}catch(u){throw console.warn(u),u.name==="CANVAS_POSSIBLY_TOO_BIG"?new Error(M("canvasError.canvasTooBig")):um&&u.name==="TypeError"?new Error(`${M("alerts.couldNotCopyToClipboard")}

${M("hints.firefox_clipboard_write")}`):new Error(M("alerts.couldNotCopyToClipboard"))}else throw new Error("Unsupported export type")},Wye=async(e,t,n,i)=>{const{exportBackground:r,viewBackgroundColor:s,fileHandle:o}=t,a=EX(o);if(!o||!Uye(a))throw new Error("fileHandle should exist and should be of type svg or png when resaving");t={...t,exportEmbedScene:!0};const{exportedElements:l,exportingFrame:c}=Yy(e,t,!1);return await Wy(a,l,t,n,{exportBackground:r,viewBackgroundColor:s,name:i,fileHandle:o,exportingFrame:c}),{fileHandle:o}},Kye=ue({name:"changeProjectName",label:"labels.fileTitle",trackEvent:!1,perform:(e,t,n)=>({appState:{...t,name:n},captureUpdate:Z.EVENTUALLY}),PanelComponent:({appState:e,updateData:t,appProps:n,data:i,app:r})=>g(cbe,{label:M("labels.fileTitle"),value:r.getName(),onChange:s=>t(s),ignoreFocus:(i==null?void 0:i.ignoreFocus)??!1})}),Zye=ue({name:"changeExportScale",label:"imageExportDialog.scale",trackEvent:{category:"export",action:"scale"},perform:(e,t,n)=>({appState:{...t,exportScale:n},captureUpdate:Z.EVENTUALLY}),PanelComponent:({elements:e,appState:t,updateData:n})=>{const i=Yt(e),s=Wn(i,t)?Xe(i,t):i;return g(fe,{children:H_.map(o=>{const[a,l]=cye(s,vg,o),c=`${M("imageExportDialog.label.scale")} ${o}x (${a}x${l})`;return g(je,{size:"small",type:"radio",icon:`${o}x`,name:"export-canvas-scale",title:c,"aria-label":c,id:"export-canvas-scale",checked:o===t.exportScale,onChange:()=>n(o)},o)})})}}),qye=ue({name:"changeExportBackground",label:"imageExportDialog.label.withBackground",trackEvent:{category:"export",action:"toggleBackground"},perform:(e,t,n)=>({appState:{...t,exportBackground:n},captureUpdate:Z.EVENTUALLY}),PanelComponent:({appState:e,updateData:t})=>g(CT,{checked:e.exportBackground,onChange:n=>t(n),children:M("imageExportDialog.label.withBackground")})}),MX=ue({name:"changeExportEmbedScene",label:"imageExportDialog.tooltip.embedScene",trackEvent:{category:"export",action:"embedScene"},perform:(e,t,n)=>({appState:{...t,exportEmbedScene:n},captureUpdate:Z.EVENTUALLY}),PanelComponent:({appState:e,updateData:t})=>N(CT,{checked:e.exportEmbedScene,onChange:n=>t(n),children:[M("imageExportDialog.label.embedScene"),g(Ul,{label:M("imageExportDialog.tooltip.embedScene"),long:!0,children:g("div",{className:"excalidraw-tooltip-icon",children:Hue})})]})}),q6=ue({name:"saveToActiveFile",label:"buttons.save",icon:Ey,trackEvent:{category:"export"},predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.saveToActiveFile&&!!t.fileHandle&&!t.viewModeEnabled,perform:async(e,t,n,i)=>{const r=!!t.fileHandle;try{const{fileHandle:s}=FT(t.fileHandle)?await Wye(e,t,i.files,i.getName()):await aX(e,t,i.files,i.getName());return{captureUpdate:Z.EVENTUALLY,appState:{...t,fileHandle:s,toast:r?{message:s!=null&&s.name?M("toast.fileSavedToFilename").replace("{filename}",`"${s.name}"`):M("toast.fileSaved")}:null}}}catch(s){return(s==null?void 0:s.name)!=="AbortError"?console.error(s):console.warn(s),{captureUpdate:Z.EVENTUALLY}}},keyTest:e=>e.key===V.S&&e[V.CTRL_OR_CMD]&&!e.shiftKey}),kX=ue({name:"saveFileToDisk",label:"exportDialog.disk_title",icon:Ey,viewMode:!0,trackEvent:{category:"export"},perform:async(e,t,n,i)=>{try{const{fileHandle:r}=await aX(e,{...t,fileHandle:null},i.files,i.getName());return{captureUpdate:Z.EVENTUALLY,appState:{...t,openDialog:null,fileHandle:r,toast:{message:M("toast.fileSaved")}}}}catch(r){return(r==null?void 0:r.name)!=="AbortError"?console.error(r):console.warn(r),{captureUpdate:Z.EVENTUALLY}}},keyTest:e=>e.key===V.S&&e.shiftKey&&e[V.CTRL_OR_CMD],PanelComponent:({updateData:e})=>g(je,{type:"button",icon:Pue,title:M("buttons.saveAs"),"aria-label":M("buttons.saveAs"),showAriaLabel:Nn().formFactor==="phone",hidden:!Wu,onClick:()=>e(null),"data-testid":"save-as-button"})}),xv=ue({name:"loadScene",label:"buttons.load",trackEvent:{category:"export"},predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.loadScene&&!t.viewModeEnabled,perform:async(e,t,n,i)=>{try{const{elements:r,appState:s,files:o}=await K5e(t,e);return{elements:r,appState:s,files:o,captureUpdate:Z.IMMEDIATELY}}catch(r){return(r==null?void 0:r.name)==="AbortError"?(console.warn(r),!1):{elements:e,appState:{...t,errorMessage:r.message},files:i.files,captureUpdate:Z.EVENTUALLY}}},keyTest:e=>e[V.CTRL_OR_CMD]&&e.key===V.O}),Qye=ue({name:"exportWithDarkMode",label:"imageExportDialog.label.darkMode",trackEvent:{category:"export",action:"toggleTheme"},perform:(e,t,n)=>({appState:{...t,exportWithDarkMode:n},captureUpdate:Z.EVENTUALLY}),PanelComponent:({appState:e,updateData:t})=>g("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"-45px",marginBottom:"10px"},children:g(lbe,{value:e.exportWithDarkMode?ke.DARK:ke.LIGHT,onChange:n=>{t(n===ke.DARK)},title:M("imageExportDialog.label.darkMode")})})});let RX="{}";const Jye=ue({name:"copyStyles",label:"labels.copyStyles",icon:XV,trackEvent:{category:"element"},perform:(e,t,n,i)=>{const r=[],s=e.find(o=>t.selectedElementIds[o.id]);if(r.push(s),s&&Li(s)){const o=Le(s,i.scene.getNonDeletedElementsMap());r.push(o)}return s&&(RX=JSON.stringify(r)),{appState:{...t,toast:{message:M("toast.copyStyles")}},captureUpdate:Z.EVENTUALLY}},keyTest:e=>e[V.CTRL_OR_CMD]&&e.altKey&&e.code===it.C}),eEe=ue({name:"pasteStyles",label:"labels.pasteStyles",icon:XV,trackEvent:{category:"element"},perform:(e,t,n,i)=>{const r=JSON.parse(RX),s=r[0],o=r[1];if(!lz(s))return{elements:e,captureUpdate:Z.EVENTUALLY};const a=Xe(e,t,{includeBoundTextElement:!0}),l=a.map(c=>c.id);return{elements:e.map(c=>{if(l.includes(c.id)){let d=s;if(ge(c)&&c.containerId&&(d=o),!d)return c;let u=Ie(c,{backgroundColor:d==null?void 0:d.backgroundColor,strokeWidth:d==null?void 0:d.strokeWidth,strokeColor:d==null?void 0:d.strokeColor,strokeStyle:d==null?void 0:d.strokeStyle,fillStyle:d==null?void 0:d.fillStyle,opacity:d==null?void 0:d.opacity,roughness:d==null?void 0:d.roughness,roundness:d.roundness?_ae(d.roundness.type,c)?d.roundness:Tae(c):null});if(ge(u)){const f=d.fontSize||Il,h=d.fontFamily||sd;u=Ie(u,{fontSize:f,fontFamily:h,textAlign:d.textAlign||Up,lineHeight:d.lineHeight||zc(h)});let m=null;u.containerId&&(m=a.find(p=>ge(u)&&p.id===u.containerId)||null),Qi(u,m,i.scene)}return u.type==="arrow"&&Ce(d)&&(u=Ie(u,{startArrowhead:d.startArrowhead,endArrowhead:d.endArrowhead})),we(c)&&(u=Ie(u,{roundness:null,backgroundColor:"transparent"})),u}return c}),captureUpdate:Z.IMMEDIATELY}},keyTest:e=>e[V.CTRL_OR_CMD]&&e.altKey&&e.code===it.V}),VT=ue({name:"toggleShortcuts",label:"welcomeScreen.defaults.helpHint",icon:Lue,viewMode:!0,trackEvent:{category:"menu",action:"toggleHelpDialog"},perform:(e,t,n,{focusContainer:i})=>{var r,s;return((r=t.openDialog)==null?void 0:r.name)==="help"&&i(),{appState:{...t,openDialog:((s=t.openDialog)==null?void 0:s.name)==="help"?null:{name:"help"},openMenu:null,openPopup:null},captureUpdate:Z.EVENTUALLY}},keyTest:e=>e.key===V.QUESTION_MARK}),tEe=e=>{if(e.length>=2){const t=e[0].groupIds;for(const n of t)if(e.reduce((i,r)=>i&&pm(r,n),!0))return!0}return!1},$R=(e,t,n)=>{const i=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0});return i.length>=2&&!tEe(i)&&!Hz(i)},nEe=ue({name:"group",label:"labels.group",icon:e=>g(lk,{theme:e.theme}),trackEvent:{category:"element"},perform:(e,t,n,i)=>{const r=T9(i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0}));if(r.length<2)return{appState:t,elements:e,captureUpdate:Z.EVENTUALLY};const s=_c(t);if(s.length===1){const U=s[0],b=new Set(At(e,U).map(v=>v.id)),y=new Set(r.map(v=>v.id));if(new Set([...Array.from(b),...Array.from(y)]).size===b.size)return{appState:t,elements:e,captureUpdate:Z.EVENTUALLY}}let o=[...e];new Set(r.map(U=>U.frameId)).size>1&&Qle(r).forEach((b,y)=>{uy(b,i.scene.getNonDeletedElementsMap())});const l=gr(),c=ve(r);o=o.map(U=>c.get(U.id)?Ie(U,{groupIds:jle(U.groupIds,l,t.editingGroupId)}):U);const d=At(o,l),u=d[d.length-1],f=o.lastIndexOf(u),h=o.slice(f+1),m=o.slice(0,f).filter(U=>!pm(U,l)),p=uo([...m,...d,...h],ve(d));return{appState:{...t,...Rz(l,{...t,selectedGroupIds:{}},Yt(o))},elements:p,captureUpdate:Z.IMMEDIATELY}},predicate:(e,t,n,i)=>$R(e,t,i),keyTest:e=>!e.shiftKey&&e[V.CTRL_OR_CMD]&&e.key===V.G,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(je,{hidden:!$R(e,t,i),type:"button",icon:g(lk,{theme:t.theme}),onClick:()=>n(null),title:`${M("labels.group")}  ${J("CtrlOrCmd+G")}`,"aria-label":M("labels.group"),visible:Wn(Yt(e),t)})}),iEe=ue({name:"ungroup",label:"labels.ungroup",icon:e=>g(ck,{theme:e.theme}),trackEvent:{category:"element"},perform:(e,t,n,i)=>{const r=_c(t),s=ve(e);if(r.length===0)return{appState:t,elements:e,captureUpdate:Z.EVENTUALLY};let o=[...e];const a=[];o=o.map(f=>{Dt(f)&&a.push(f.id);const h=Yle(f.groupIds,t.selectedGroupIds);return h.length===f.groupIds.length?f:Ie(f,{groupIds:h})});const l=Si(t,Yt(o),t,null),c=i.scene.getSelectedElements(t),d=new Set(c.filter(f=>f.frameId).map(f=>f.frameId));return _9(e).filter(f=>d.has(f.id)).forEach(f=>{f&&(o=Ig(o,jo(o,f,t,s),f,i))}),l.selectedElementIds=Object.entries(l.selectedElementIds).reduce((f,[h,m])=>(m&&!a.includes(h)&&(f[h]=!0),f),{}),{appState:{...t,...l},elements:o,captureUpdate:Z.IMMEDIATELY}},keyTest:e=>e.shiftKey&&e[V.CTRL_OR_CMD]&&e.key===V.G.toUpperCase(),predicate:(e,t)=>_c(t).length>0,PanelComponent:({elements:e,appState:t,updateData:n})=>g(je,{type:"button",hidden:_c(t).length===0,icon:g(ck,{theme:t.theme}),onClick:()=>n(null),title:`${M("labels.ungroup")}  ${J("CtrlOrCmd+Shift+G")}`,"aria-label":M("labels.ungroup"),visible:Wn(Yt(e),t)})}),DX=(e,t,n,i,r,s,o)=>{e.beginPath(),e.moveTo(t+s,n),e.lineTo(t+i-s,n),e.quadraticCurveTo(t+i,n,t+i,n+s),e.lineTo(t+i,n+r-s),e.quadraticCurveTo(t+i,n+r,t+i-s,n+r),e.lineTo(t+s,n+r),e.quadraticCurveTo(t,n+r,t,n+r-s),e.lineTo(t,n+s),e.quadraticCurveTo(t,n,t+s,n),e.closePath(),e.fill(),o&&(e.strokeStyle=o),e.stroke()};function rEe(e){let t=0;if(e.length===0)return t;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);t=(t<<5)-t+i}return t}const Ky=(e,t)=>`hsl(${Math.abs(rEe((t==null?void 0:t.id)||e))%37*10}, 100%, 83%)`,sEe=e=>{var n;const t=(n=e==null?void 0:e.trim())==null?void 0:n.codePointAt(0);return(t?String.fromCodePoint(t):"?").toUpperCase()},oEe=({context:e,renderConfig:t,appState:n,normalizedWidth:i,normalizedHeight:r})=>{for(const[s,o]of t.remotePointerViewportCoords){let{x:a,y:l}=o;const c=n.collaborators.get(s);a-=n.offsetLeft,l-=n.offsetTop;const d=11,u=14,f=a<0||a>i-d||l<0||l>r-u;a=Math.max(a,0),a=Math.min(a,i-d),l=Math.max(l,0),l=Math.min(l,r-u);const h=Ky(s,c);e.save(),e.strokeStyle=h,e.fillStyle=h;const m=t.remotePointerUserStates.get(s),p=f||m===Od.IDLE||m===Od.AWAY;p&&(e.globalAlpha=.3),t.remotePointerButton.get(s)==="down"&&(e.beginPath(),e.arc(a,l,15,0,2*Math.PI,!1),e.lineWidth=3,e.strokeStyle="#ffffff88",e.stroke(),e.closePath(),e.beginPath(),e.arc(a,l,15,0,2*Math.PI,!1),e.lineWidth=1,e.strokeStyle=h,e.stroke(),e.closePath());const U=n.theme===ke.DARK?"#2f6330":Hre,b=c==null?void 0:c.isSpeaking;b&&(e.fillStyle=U,e.strokeStyle=U,e.lineWidth=10,e.lineJoin="round",e.beginPath(),e.moveTo(a,l),e.lineTo(a+0,l+14),e.lineTo(a+4,l+9),e.lineTo(a+11,l+8),e.closePath(),e.stroke(),e.fill()),e.fillStyle=PU,e.strokeStyle=PU,e.lineWidth=6,e.lineJoin="round",e.beginPath(),e.moveTo(a,l),e.lineTo(a+0,l+14),e.lineTo(a+4,l+9),e.lineTo(a+11,l+8),e.closePath(),e.stroke(),e.fill(),e.fillStyle=h,e.strokeStyle=h,e.lineWidth=2,e.lineJoin="round",e.beginPath(),p?(e.moveTo(a-1,l-1),e.lineTo(a-1,l+15),e.lineTo(a+5,l+10),e.lineTo(a+12,l+9),e.closePath(),e.fill()):(e.moveTo(a,l),e.lineTo(a+0,l+14),e.lineTo(a+4,l+9),e.lineTo(a+11,l+8),e.closePath(),e.fill(),e.stroke());const y=t.remotePointerUsernames.get(s)||"";if(!f&&y){e.font="600 12px sans-serif";const w=(b?a+0:a)+d/2,v=(b?l+0:l)+u+2,I=5,C=3,_=e.measureText(y),T=_.actualBoundingBoxDescent+_.actualBoundingBoxAscent,k=Math.max(T,12),x=w-1,D=v-1,O=_.width+2+I*2+2,L=k+2+C*2+2;if(e.roundRect?(e.beginPath(),e.roundRect(x,D,O,L,8),e.fillStyle=h,e.fill(),e.strokeStyle=PU,e.stroke(),b&&(e.beginPath(),e.roundRect(x-2,D-2,O+4,L+4,8),e.strokeStyle=U,e.stroke())):DX(e,x,D,O,L,8,PU),e.fillStyle=zre,e.fillText(y,w+I+1,v+C+_.actualBoundingBoxAscent+Math.floor((k-T)/2)+2),b){e.fillStyle=U;const Y=8,$=8,H=5;e.fillRect(x+O+$,D+(L/2-Y/2),2,Y),e.fillRect(x+O+$+H,D+(L/2-Y*2/2),2,Y*2),e.fillRect(x+O+$+H*2,D+(L/2-Y/2),2,Y)}}e.restore(),e.closePath()}},GR=({color:e,onClick:t,name:n,src:i,className:r})=>{const s=sEe(n),[o,a]=R.useState(!1),l=!o&&i,c=l?void 0:{background:e};return g("div",{className:le("Avatar",r),style:c,onClick:t,children:l?g("img",{className:"Avatar-img",src:i,alt:s,referrerPolicy:"no-referrer",onError:()=>a(!0)}):s})};ue({name:"goToCollaborator",label:"Go to a collaborator",viewMode:!0,trackEvent:{category:"collab"},perform:(e,t,n)=>{var i;return!n.socketId||((i=t.userToFollow)==null?void 0:i.socketId)===n.socketId||n.isCurrentUser?{appState:{...t,userToFollow:null},captureUpdate:Z.EVENTUALLY}:{appState:{...t,userToFollow:{socketId:n.socketId,username:n.username||""},openMenu:t.openMenu==="canvas"?null:t.openMenu},captureUpdate:Z.EVENTUALLY}},PanelComponent:({updateData:e,data:t,appState:n})=>{const{socketId:i,collaborator:r,withName:s,isBeingFollowed:o}=t,a=Ky(i,r),l=le({"is-followed":o,"is-current-user":r.isCurrentUser===!0,"is-speaking":r.isSpeaking,"is-in-call":r.isInCall,"is-muted":r.isMuted}),c=r.isInCall?r.isSpeaking?N("div",{className:"UserList__collaborator-status-icon-speaking-indicator",title:M("userList.hint.isSpeaking"),children:[g("div",{}),g("div",{}),g("div",{})]}):r.isMuted?g("div",{className:"UserList__collaborator-status-icon-microphone-muted",title:M("userList.hint.micMuted"),children:Gfe}):g("div",{title:M("userList.hint.inCall"),children:$fe}):null;return s?N("div",{className:`dropdown-menu-item dropdown-menu-item-base UserList__collaborator ${l}`,style:{"--avatar-size":"1.5rem"},onClick:()=>e(r),children:[g(GR,{color:a,onClick:()=>{},name:r.username||"",src:r.avatarUrl,className:l}),g("div",{className:"UserList__collaborator-name",children:r.username}),N("div",{className:"UserList__collaborator-status-icons","aria-hidden":!0,children:[o&&g("div",{className:"UserList__collaborator-status-icon-is-followed",title:M("userList.hint.followStatus"),children:eT}),c]})]}):N("div",{className:`UserList__collaborator UserList__collaborator--avatar-only ${l}`,children:[g(GR,{color:a,onClick:()=>{e(r)},name:r.username||"",src:r.avatarUrl,className:l}),c&&g("div",{className:"UserList__collaborator-status-icon",children:c})]})}});const aEe=ue({name:"addToLibrary",trackEvent:{category:"element"},perform:(e,t,n,i)=>{const r=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});for(const s of wB)if(r.some(o=>o.type===s))return{captureUpdate:Z.EVENTUALLY,appState:{...t,errorMessage:M(`errors.libraryElementTypeError.${s}`)}};return i.library.getLatestLibrary().then(s=>i.library.setLibrary([{id:gr(),status:"unpublished",elements:r.map(Gc),created:Date.now()},...s])).then(()=>({captureUpdate:Z.EVENTUALLY,appState:{...t,toast:{message:M("toast.addedToLibrary")}}})).catch(s=>({captureUpdate:Z.EVENTUALLY,appState:{...t,errorMessage:s.message}}))},label:"labels.addToLibrary"}),Mr=(e,t)=>{const n=t.scene.getSelectedElements(e);return cy(n,t.scene.getNonDeletedElementsMap(),e).length>1&&!n.some(i=>we(i))},Ng=(e,t,n,i)=>{const r=n.scene.getSelectedElements(t),s=Sce(r,i,n.scene,t),o=ve(s);return Yh(e.map(a=>o.get(a.id)||a),t,n)};ue({name:"alignTop",label:"labels.alignTop",icon:nk,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Mr(t,i),perform:(e,t,n,i)=>({appState:t,elements:Ng(e,t,i,{position:"start",axis:"y"}),captureUpdate:Z.IMMEDIATELY}),keyTest:e=>e[V.CTRL_OR_CMD]&&e.shiftKey&&e.key===V.ARROW_UP,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(je,{hidden:!Mr(t,i),type:"button",icon:nk,onClick:()=>n(null),title:`${M("labels.alignTop")}  ${J("CtrlOrCmd+Shift+Up")}`,"aria-label":M("labels.alignTop"),visible:Wn(Yt(e),t)})});ue({name:"alignBottom",label:"labels.alignBottom",icon:ik,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Mr(t,i),perform:(e,t,n,i)=>({appState:t,elements:Ng(e,t,i,{position:"end",axis:"y"}),captureUpdate:Z.IMMEDIATELY}),keyTest:e=>e[V.CTRL_OR_CMD]&&e.shiftKey&&e.key===V.ARROW_DOWN,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(je,{hidden:!Mr(t,i),type:"button",icon:ik,onClick:()=>n(null),title:`${M("labels.alignBottom")}  ${J("CtrlOrCmd+Shift+Down")}`,"aria-label":M("labels.alignBottom"),visible:Wn(Yt(e),t)})});ue({name:"alignLeft",label:"labels.alignLeft",icon:rk,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Mr(t,i),perform:(e,t,n,i)=>({appState:t,elements:Ng(e,t,i,{position:"start",axis:"x"}),captureUpdate:Z.IMMEDIATELY}),keyTest:e=>e[V.CTRL_OR_CMD]&&e.shiftKey&&e.key===V.ARROW_LEFT,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(je,{hidden:!Mr(t,i),type:"button",icon:rk,onClick:()=>n(null),title:`${M("labels.alignLeft")}  ${J("CtrlOrCmd+Shift+Left")}`,"aria-label":M("labels.alignLeft"),visible:Wn(Yt(e),t)})});ue({name:"alignRight",label:"labels.alignRight",icon:sk,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Mr(t,i),perform:(e,t,n,i)=>({appState:t,elements:Ng(e,t,i,{position:"end",axis:"x"}),captureUpdate:Z.IMMEDIATELY}),keyTest:e=>e[V.CTRL_OR_CMD]&&e.shiftKey&&e.key===V.ARROW_RIGHT,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(je,{hidden:!Mr(t,i),type:"button",icon:sk,onClick:()=>n(null),title:`${M("labels.alignRight")}  ${J("CtrlOrCmd+Shift+Right")}`,"aria-label":M("labels.alignRight"),visible:Wn(Yt(e),t)})});ue({name:"alignVerticallyCentered",label:"labels.centerVertically",icon:ok,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Mr(t,i),perform:(e,t,n,i)=>({appState:t,elements:Ng(e,t,i,{position:"center",axis:"y"}),captureUpdate:Z.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(je,{hidden:!Mr(t,i),type:"button",icon:ok,onClick:()=>n(null),title:M("labels.centerVertically"),"aria-label":M("labels.centerVertically"),visible:Wn(Yt(e),t)})});ue({name:"alignHorizontallyCentered",label:"labels.centerHorizontally",icon:ak,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Mr(t,i),perform:(e,t,n,i)=>({appState:t,elements:Ng(e,t,i,{position:"center",axis:"x"}),captureUpdate:Z.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(je,{hidden:!Mr(t,i),type:"button",icon:ak,onClick:()=>n(null),title:M("labels.centerHorizontally"),"aria-label":M("labels.centerHorizontally"),visible:Wn(Yt(e),t)})});const LX=(e,t)=>{const n=t.scene.getSelectedElements(e);return cy(n,t.scene.getNonDeletedElementsMap(),e).length>2&&!n.some(i=>we(i))},NX=(e,t,n,i)=>{const r=n.scene.getSelectedElements(t),s=ode(r,n.scene.getNonDeletedElementsMap(),i,t),o=ve(s);return Yh(e.map(a=>o.get(a.id)||a),t,n)};ue({name:"distributeHorizontally",label:"labels.distributeHorizontally",trackEvent:{category:"element"},perform:(e,t,n,i)=>({appState:t,elements:NX(e,t,i,{axis:"x"}),captureUpdate:Z.IMMEDIATELY}),keyTest:e=>!e[V.CTRL_OR_CMD]&&e.altKey&&e.code===it.H,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(je,{hidden:!LX(t,i),type:"button",icon:jue,onClick:()=>n(null),title:`${M("labels.distributeHorizontally")}  ${J("Alt+H")}`,"aria-label":M("labels.distributeHorizontally"),visible:Wn(Yt(e),t)})});ue({name:"distributeVertically",label:"labels.distributeVertically",trackEvent:{category:"element"},perform:(e,t,n,i)=>({appState:t,elements:NX(e,t,i,{axis:"y"}),captureUpdate:Z.IMMEDIATELY}),keyTest:e=>!e[V.CTRL_OR_CMD]&&e.altKey&&e.code===it.V,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(je,{hidden:!LX(t,i),type:"button",icon:Yue,onClick:()=>n(null),title:`${M("labels.distributeVertically")}  ${J("Alt+V")}`,"aria-label":M("labels.distributeVertically"),visible:Wn(Yt(e),t)})});const lEe=ue({name:"flipHorizontal",label:"labels.flipHorizontal",icon:Wfe,trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:Yh(OX(e,i.scene.getNonDeletedElementsMap(),t,"horizontal",i),t,i),appState:t,captureUpdate:Z.IMMEDIATELY}),keyTest:e=>e.shiftKey&&e.code===it.H}),cEe=ue({name:"flipVertical",label:"labels.flipVertical",icon:Yfe,trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:Yh(OX(e,i.scene.getNonDeletedElementsMap(),t,"vertical",i),t,i),appState:t,captureUpdate:Z.IMMEDIATELY}),keyTest:e=>e.shiftKey&&e.code===it.V&&!e[V.CTRL_OR_CMD]}),OX=(e,t,n,i,r)=>{const s=Xe(Yt(e),n,{includeBoundTextElement:!0,includeElementsInFrames:!0}),o=dEe(s,t,n,i,r),a=ve(o);return e.map(l=>a.get(l.id)||l)},dEe=(e,t,n,i,r)=>{if(e.every(h=>Ce(h)&&(h.startBinding||h.endBinding)))return e.map(h=>{const m=h;return Ie(m,{startArrowhead:m.endArrowhead,endArrowhead:m.startArrowhead})});const{midX:s,midY:o}=Ms(e);yH(e,t,"nw",r.scene,new Map(Array.from(t.values()).map(h=>[h.id,Gc(h)])),{flipByX:i==="horizontal",flipByY:i==="vertical",shouldResizeFromCenter:!0,shouldMaintainAspectRatio:!0}),p6(e.filter(xe),tu(n),[],r.scene,n.zoom);const{elbowArrows:a,otherElements:l}=e.reduce((h,m)=>me(m)?{...h,elbowArrows:h.elbowArrows.concat(m)}:{...h,otherElements:h.otherElements.concat(m)},{elbowArrows:[],otherElements:[]}),{midX:c,midY:d}=Ms(e),[u,f]=[s-c,o-d];return l.forEach(h=>r.scene.mutateElement(h,{x:h.x+u,y:h.y+f})),a.forEach(h=>r.scene.mutateElement(h,{x:h.x+u,y:h.y+f})),e},ob=ue({name:"copy",label:"labels.copy",icon:rv,trackEvent:{category:"element"},perform:async(e,t,n,i)=>{const r=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});try{await Oye(r,i.files,n)}catch(s){return{captureUpdate:Z.EVENTUALLY,appState:{...t,errorMessage:s.message}}}return{captureUpdate:Z.EVENTUALLY}},keyTest:void 0}),XR=ue({name:"paste",label:"labels.paste",trackEvent:{category:"element"},perform:async(e,t,n,i)=>{let r;try{r=await Bye()}catch(s){return s.name==="AbortError"||s.name==="NotAllowedError"?!1:(console.error(`actionPaste ${s.name}: ${s.message}`),um?{captureUpdate:Z.EVENTUALLY,appState:{...t,errorMessage:M("hints.firefox_clipboard_write")}}:{captureUpdate:Z.EVENTUALLY,appState:{...t,errorMessage:M("errors.asyncPasteFailedOnRead")}})}try{i.pasteFromClipboard(Lye({types:r}))}catch(s){return console.error(s),{captureUpdate:Z.EVENTUALLY,appState:{...t,errorMessage:M("errors.asyncPasteFailedOnParse")}}}return{captureUpdate:Z.EVENTUALLY}},keyTest:void 0}),jR=ue({name:"cut",label:"labels.cut",icon:kfe,trackEvent:{category:"element"},perform:(e,t,n,i)=>(ob.perform(e,t,n,i),QV.perform(e,t,null,i)),keyTest:e=>e[V.CTRL_OR_CMD]&&e.key===V.X}),YR=ue({name:"copyAsSvg",label:"labels.copyAsSvg",icon:Kfe,trackEvent:{category:"element"},perform:async(e,t,n,i)=>{if(!i.canvas)return{captureUpdate:Z.EVENTUALLY};const{exportedElements:r,exportingFrame:s}=Yy(e,t,!0);try{await Wy("clipboard-svg",r,t,i.files,{...t,exportingFrame:s,name:i.getName()});const o=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});return{appState:{toast:{message:M("toast.copyToClipboardAsSvg",{exportSelection:o.length?M("toast.selection"):M("toast.canvas"),exportColorScheme:t.exportWithDarkMode?M("buttons.darkMode"):M("buttons.lightMode")})}},captureUpdate:Z.EVENTUALLY}}catch(o){return console.error(o),{appState:{errorMessage:o.message},captureUpdate:Z.EVENTUALLY}}},predicate:e=>zT&&e.length>0,keywords:["svg","clipboard","copy"]}),WR=ue({name:"copyAsPng",label:"labels.copyAsPng",icon:Zfe,trackEvent:{category:"element"},perform:async(e,t,n,i)=>{if(!i.canvas)return{captureUpdate:Z.EVENTUALLY};const r=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0}),{exportedElements:s,exportingFrame:o}=Yy(e,t,!0);try{return await Wy("clipboard",s,t,i.files,{...t,exportingFrame:o,name:i.getName()}),{appState:{...t,toast:{message:M("toast.copyToClipboardAsPng",{exportSelection:r.length?M("toast.selection"):M("toast.canvas"),exportColorScheme:t.exportWithDarkMode?M("buttons.darkMode"):M("buttons.lightMode")})}},captureUpdate:Z.EVENTUALLY}}catch(a){return console.error(a),{appState:{...t,errorMessage:a.message},captureUpdate:Z.EVENTUALLY}}},predicate:e=>HT&&e.length>0,keyTest:e=>e.code===it.C&&e.altKey&&e.shiftKey,keywords:["png","clipboard","copy"]}),KR=ue({name:"copyText",label:"labels.copyText",trackEvent:{category:"element"},perform:(e,t,n,i)=>{const r=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0});try{ud(bz(r))}catch{throw new Error(M("errors.copyToSystemClipboardFailed"))}return{captureUpdate:Z.EVENTUALLY}},predicate:(e,t,n,i)=>zT&&i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0}).some(ge),keywords:["text","clipboard","copy"]}),ZR=ue({name:"gridMode",icon:ehe,keywords:["snap"],label:"labels.toggleGrid",viewMode:!0,trackEvent:{category:"canvas",predicate:e=>e.gridModeEnabled},perform(e,t){return{appState:{...t,gridModeEnabled:!this.checked(t),objectsSnapModeEnabled:!1},captureUpdate:Z.EVENTUALLY}},checked:e=>e.gridModeEnabled,predicate:(e,t,n)=>n.gridModeEnabled===void 0,keyTest:e=>e[V.CTRL_OR_CMD]&&e.code===it.QUOTE}),Cv=ue({name:"zenMode",label:"buttons.zenMode",icon:Qfe,viewMode:!0,trackEvent:{category:"canvas",predicate:e=>!e.zenModeEnabled},perform(e,t){return{appState:{...t,zenModeEnabled:!this.checked(t)},captureUpdate:Z.EVENTUALLY}},checked:e=>e.zenModeEnabled,predicate:(e,t,n,i)=>i.editorInterface.formFactor!=="phone"&&typeof n.zenModeEnabled>"u",keyTest:e=>!e[V.CTRL_OR_CMD]&&e.altKey&&e.code===it.Z}),uEe=ue({name:"objectsSnapMode",label:"buttons.objectsSnapMode",icon:qfe,viewMode:!1,trackEvent:{category:"canvas",predicate:e=>!e.objectsSnapModeEnabled},perform(e,t){return{appState:{...t,objectsSnapModeEnabled:!this.checked(t),gridModeEnabled:!1},captureUpdate:Z.EVENTUALLY}},checked:e=>e.objectsSnapModeEnabled,predicate:(e,t,n)=>typeof n.objectsSnapModeEnabled>"u",keyTest:e=>!e[V.CTRL_OR_CMD]&&e.altKey&&e.code===it.S}),Av=ue({name:"stats",label:"stats.fullTitle",icon:jfe,viewMode:!0,trackEvent:{category:"menu"},keywords:["edit","attributes","customize"],perform(e,t){return{appState:{...t,stats:{...t.stats,open:!this.checked(t)}},captureUpdate:Z.EVENTUALLY}},checked:e=>e.stats.open,keyTest:e=>!e[V.CTRL_OR_CMD]&&e.altKey&&e.code===it.SLASH}),fEe=ue({name:"unbindText",label:"labels.unbindText",trackEvent:{category:"element"},predicate:(e,t,n,i)=>i.scene.getSelectedElements(t).some(s=>Li(s)),perform:(e,t,n,i)=>{const r=i.scene.getSelectedElements(t),s=i.scene.getNonDeletedElementsMap();return r.forEach(o=>{var l;const a=Le(o,s);if(a){const{width:c,height:d}=jn(a.originalText,mt(a),a.lineHeight),u=Iae(o.id);fz(o.id);const{x:f,y:h}=ld(o,a,s);i.scene.mutateElement(a,{containerId:null,width:c,height:d,text:a.originalText,x:f,y:h}),i.scene.mutateElement(o,{boundElements:(l=o.boundElements)==null?void 0:l.filter(m=>m.id!==a.id),height:u||o.height})}}),{elements:e,appState:t,captureUpdate:Z.IMMEDIATELY}}}),hEe=ue({name:"bindText",label:"labels.bindText",trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const r=i.scene.getSelectedElements(t);if(r.length===2){const s=ge(r[0])||ge(r[1]);let o;if(eu(r[0])?o=r[0]:eu(r[1])&&(o=r[1]),s&&o&&Le(o,i.scene.getNonDeletedElementsMap())===null)return!0}return!1},perform:(e,t,n,i)=>{const r=i.scene.getSelectedElements(t);let s,o;ge(r[0])&&eu(r[1])?(s=r[0],o=r[1]):(s=r[1],o=r[0]),i.scene.mutateElement(s,{containerId:o.id,verticalAlign:Yr.MIDDLE,textAlign:dm.CENTER,autoResize:!0,angle:Ce(o)?0:(o==null?void 0:o.angle)??0}),i.scene.mutateElement(o,{boundElements:(o.boundElements||[]).concat({type:"text",id:s.id})});const a=o.height;return Qi(s,o,i.scene),f6(o.id,a),{elements:gEe(e,o,s),appState:{...t,selectedElementIds:{[o.id]:!0}},captureUpdate:Z.IMMEDIATELY}}}),gEe=(e,t,n)=>{const i=e.slice(),r=i.findIndex(o=>o.id===n.id);i.splice(r,1);const s=i.findIndex(o=>o.id===t.id);return i.splice(s+1,0,n),uo(i,ve([t,n])),i},mEe=(e,t,n)=>{const i=e.slice(),r=i.findIndex(o=>o.id===t.id);i.splice(r,1);const s=i.findIndex(o=>o.id===n.id);return i.splice(s,0,t),uo(i,ve([t,n])),i},pEe=ue({name:"wrapTextInContainer",label:"labels.createContainerFromText",trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const r=i.scene.getSelectedElements(t),s=r.some(o=>ge(o)&&!Dt(o));return r.length>0&&s},perform:(e,t,n,i)=>{var a;const r=i.scene.getSelectedElements(t);let s=e.slice();const o={};for(const l of r)if(ge(l)&&!Dt(l)){const c=ia({type:"rectangle",backgroundColor:t.currentItemBackgroundColor,boundElements:[...l.boundElements||[],{id:l.id,type:"text"}],angle:l.angle,fillStyle:t.currentItemFillStyle,strokeColor:t.currentItemStrokeColor,roughness:t.currentItemRoughness,strokeWidth:t.currentItemStrokeWidth,strokeStyle:t.currentItemStrokeStyle,roundness:t.currentItemRoundness==="round"?{type:$u("rectangle")?yn.ADAPTIVE_RADIUS:yn.PROPORTIONAL_RADIUS}:null,opacity:100,locked:!1,x:l.x-$n,y:l.y-$n,width:bu(l.width,"rectangle"),height:bu(l.height,"rectangle"),groupIds:l.groupIds,frameId:l.frameId});if((a=l.boundElements)!=null&&a.length){const d=l.boundElements.filter(f=>f.type==="arrow").map(f=>f.id);s.filter(f=>d.includes(f.id)).forEach(f=>{let h=f.startBinding,m=f.endBinding;(h==null?void 0:h.elementId)===l.id&&(h={...h,elementId:c.id}),(m==null?void 0:m.elementId)===l.id&&(m={...m,elementId:c.id}),(h||m)&&i.scene.mutateElement(f,{startBinding:h,endBinding:m})})}i.scene.mutateElement(l,{containerId:c.id,verticalAlign:Yr.MIDDLE,boundElements:null,textAlign:dm.CENTER,autoResize:!0}),Qi(l,c,i.scene),s=mEe([...s,c],c,l),o[c.id]=!0}return{elements:s,appState:{...t,selectedElementIds:o},captureUpdate:Z.IMMEDIATELY}}}),$T=380,UEe=42,Mv=5,PX=85,bEe=500;let kv=!1;const s2=new Map,yEe=({element:e,scene:t,setAppState:n,onLinkOpen:i,setToast:r,updateEmbedValidationStatus:s})=>{const o=t.getNonDeletedElementsMap(),a=Gp(),l=$p(),c=Nn(),d=e.link||"",[u,f]=R.useState(d),h=R.useRef(null),m=a.showHyperlinkPopup==="editor",p=R.useCallback(()=>{var I;if(!h.current)return;const v=ts(h.current.value)||null;if(!e.link&&v&&et("hyperlink","create"),or(e)){if(((I=a.activeEmbeddable)==null?void 0:I.element)===e&&n({activeEmbeddable:null}),!v){t.mutateElement(e,{link:null}),s(e,!1);return}if(!G2(v,l.validateEmbeddable))v&&r({message:M("toast.unableToEmbed"),closable:!0}),e.link&&s2.set(e.id,e.link),t.mutateElement(e,{link:v}),s(e,!1);else{const{width:C,height:_}=e,T=Zf(v);(T==null?void 0:T.error)instanceof URIError&&r({message:M("toast.unrecognizedLinkFormat"),closable:!0});const k=T?T.intrinsicSize.w/T.intrinsicSize.h:1,x=s2.get(e.id)!==e.link;t.mutateElement(e,{...x?{width:(T==null?void 0:T.type)==="video"?C>_?C:_*k:C,height:(T==null?void 0:T.type)==="video"&&C>_?C/k:_}:{},link:v}),s(e,!0),s2.has(e.id)&&s2.delete(e.id)}}else t.mutateElement(e,{link:v})},[e,t,r,l.validateEmbeddable,a.activeEmbeddable,n,s]);R.useLayoutEffect(()=>()=>{p()},[p]),R.useEffect(()=>{m&&(h!=null&&h.current)&&!(c.formFactor==="phone"||c.isTouchScreen)&&h.current.select()},[m,c.formFactor,c.isTouchScreen]),R.useEffect(()=>{let v=null;const I=C=>{if(m)return;v&&clearTimeout(v),wEe(e,o,a,S(C.clientX,C.clientY))&&(v=window.setTimeout(()=>{n({showHyperlinkPopup:!1})},bEe))};return window.addEventListener(te.POINTER_MOVE,I,!1),()=>{window.removeEventListener(te.POINTER_MOVE,I,!1),v&&clearTimeout(v)}},[a,e,m,n,o]);const U=R.useCallback(()=>{et("hyperlink","delete"),t.mutateElement(e,{link:null}),n({showHyperlinkPopup:!1})},[n,e,t]),b=()=>{et("hyperlink","edit","popup-ui"),n({showHyperlinkPopup:"editor"})},{x:y,y:w}=FX(e,a,o);return a.contextMenu||a.selectedElementsAreBeingDragged||a.resizingElement||a.isRotating||a.openMenu||a.viewModeEnabled?null:N("div",{className:"excalidraw-hyperlinkContainer",style:{top:`${w}px`,left:`${y}px`,width:$T,padding:Mv},children:[m?g("input",{className:le("excalidraw-hyperlinkContainer-input"),placeholder:M("labels.link.hint"),ref:h,value:u,onChange:v=>f(v.target.value),autoFocus:!0,onKeyDown:v=>{v.stopPropagation(),v[V.CTRL_OR_CMD]&&v.key===V.K&&v.preventDefault(),(v.key===V.ENTER||v.key===V.ESCAPE)&&(p(),n({showHyperlinkPopup:"info"}))}}):e.link?g("a",{href:ts(e.link||""),className:"excalidraw-hyperlinkContainer-link",target:QB(e.link)?"_self":"_blank",onClick:v=>{if(e.link&&i){const I=jB(te.EXCALIDRAW_LINK,v.nativeEvent);i({...e,link:ts(e.link)},I),I.defaultPrevented&&v.preventDefault()}},rel:"noopener noreferrer",children:e.link}):g("div",{className:"excalidraw-hyperlinkContainer-link",children:M("labels.link.empty")}),N("div",{className:"excalidraw-hyperlinkContainer__buttons",children:[!m&&g(je,{type:"button",title:M("buttons.edit"),"aria-label":M("buttons.edit"),label:M("buttons.edit"),onClick:b,className:"excalidraw-hyperlinkContainer--edit",icon:Lp}),g(je,{type:"button",title:M("labels.linkToElement"),"aria-label":M("labels.linkToElement"),label:M("labels.linkToElement"),onClick:()=>{n({openDialog:{name:"elementLinkSelector",sourceElementId:e.id}})},icon:KV}),d&&!or(e)&&g(je,{type:"button",title:M("buttons.remove"),"aria-label":M("buttons.remove"),label:M("buttons.remove"),onClick:U,className:"excalidraw-hyperlinkContainer--remove",icon:Xc})]})]})},FX=(e,t,n)=>{const[i,r]=$e(e,n),{x:s,y:o}=Wr({sceneX:i+e.width/2,sceneY:r},t),a=s-t.offsetLeft-$T/2,l=o-t.offsetTop-PX;return{x:a,y:l}},qR=(e,t)=>{var r;const n=Xe(e,t);return or(n[0])?"labels.link.editEmbed":(r=n[0])!=null&&r.link?"labels.link.edit":"labels.link.create"};let O0=null;const EEe=(e,t,n)=>{O0&&clearTimeout(O0),O0=window.setTimeout(()=>vEe(e,t,n),Kre)},vEe=(e,t,n)=>{if(!e.link)return;const i=k0();i.classList.add("excalidraw-tooltip--visible"),i.style.maxWidth="20rem",i.textContent=hh(e.link)?M("labels.link.goToElement"):e.link;const[r,s,o,a]=$e(e,n),[l,c,d,u]=NT([r,s,o,a],e.angle,t),f=Wr({sceneX:l,sceneY:c},t);dG(i,{left:f.x,top:f.y,width:d,height:u},"top"),et("hyperlink","tooltip","link-icon"),kv=!0},QR=()=>{O0&&clearTimeout(O0),kv&&(kv=!1,k0().classList.remove("excalidraw-tooltip--visible"))},wEe=(e,t,n,[i,r])=>{const{x:s,y:o}=Nt({clientX:i,clientY:r},n),a=15/n.zoom.value;if(ay(S(s,o),e,t))return!1;const[l,c,d]=$e(e,t);if(s>=l&&s<=d&&o>=c-PX&&o<=c)return!1;const{x:u,y:f}=FX(e,n,t);return!(i>=u-a&&i<=u+$T+Mv*2+a&&r>=f-a&&r<=f+a+Mv*2+UEe)},BX=ue({name:"hyperlink",label:(e,t)=>qR(e,t),icon:N6,perform:(e,t)=>t.showHyperlinkPopup==="editor"?!1:{elements:e,appState:{...t,showHyperlinkPopup:"editor",openMenu:null},captureUpdate:Z.IMMEDIATELY},trackEvent:{category:"hyperlink",action:"click"},keyTest:e=>e[V.CTRL_OR_CMD]&&e.key===V.K,predicate:(e,t)=>Xe(e,t).length===1,PanelComponent:({elements:e,appState:t,updateData:n})=>{const i=Xe(e,t);return g(je,{type:"button",icon:N6,"aria-label":M(qR(e,t)),title:`${or(e[0])?M("labels.link.labelEmbed"):M("labels.link.label")} - ${J("CtrlOrCmd+K")}`,onClick:()=>n(null),selected:i.length===1&&!!i[0].link})}}),A3=e=>e.every(t=>!t.locked),zX=ue({name:"toggleElementLock",label:(e,t,n)=>{const i=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!1});return A3(i)?"labels.elementLock.lock":"labels.elementLock.unlock"},icon:(e,t)=>{const n=Xe(t,e);return A3(n)?$9:by},trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const r=i.scene.getSelectedElements(t);return r.length>0&&!r.some(s=>s.locked&&s.frameId)},perform:(e,t,n,i)=>{const r=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});if(!r.length)return!1;const s=A3(r),o=ve(r),a=r.length>1&&b9(r),c=r.length===1||a?null:gr();let d={...t.lockedMultiSelections};if(s)d={...t.lockedMultiSelections,...c?{[c]:!0}:{}};else if(a){const b=r[0].groupIds.at(-1);delete d[b]}const u=e.map(b=>{if(!o.has(b.id))return b;let y=b.groupIds;return s?c&&(y=[...y,c]):y=y.filter(w=>!t.lockedMultiSelections[w]),Ie(b,{locked:s,groupIds:y.length!==b.groupIds.length?y:b.groupIds})}),f=ve(u),h=s?{}:Object.fromEntries(r.map(b=>[b.id,!0])),m=r.map(b=>f.get(b.id)||b),p=s?{}:kp(m,t),U=s?c||(a?r[0].groupIds.at(-1):r[0].id):null;return{elements:u,appState:{...t,selectedElementIds:h,selectedGroupIds:p,selectedLinearElement:s?null:t.selectedLinearElement,lockedMultiSelections:d,activeLockedId:U},captureUpdate:Z.IMMEDIATELY}},keyTest:(e,t,n,i)=>e.key.toLocaleLowerCase()===V.L&&e[V.CTRL_OR_CMD]&&e.shiftKey&&i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!1}).length>0}),_Ee=ue({name:"unlockAllElements",trackEvent:{category:"canvas"},viewMode:!1,icon:by,predicate:(e,t)=>Xe(e,t).length===0&&e.some(i=>i.locked),perform:(e,t)=>{const n=e.filter(o=>o.locked),i=e.map(o=>{if(o.locked){const a=o.groupIds.filter(l=>!t.lockedMultiSelections[l]);return Ie(o,{locked:!1,groupIds:o.groupIds.length!==a.length?a:o.groupIds})}return o}),r=ve(i),s=n.map(o=>r.get(o.id)||o);return{elements:i,appState:{...t,selectedElementIds:Object.fromEntries(n.map(o=>[o.id,!0])),selectedGroupIds:kp(s,t),lockedMultiSelections:{},activeLockedId:null},captureUpdate:Z.IMMEDIATELY}},label:"labels.elementLock.unlockAll"});var HX={exports:{}};(function(e,t){(function(){var n={};e.exports=n,n.simpleFilter=function(i,r){return r.filter(function(s){return n.test(i,s)})},n.test=function(i,r){return n.match(i,r)!==null},n.match=function(i,r,s){s=s||{};var o=0,a=[],l=r.length,c=0,d=0,u=s.pre||"",f=s.post||"",h=s.caseSensitive&&r||r.toLowerCase(),m;i=s.caseSensitive&&i||i.toLowerCase();for(var p=0;p<l;p++)m=r[p],h[p]===i[o]?(m=u+m+f,o+=1,d+=1+d):d=0,c+=d,a[a.length]=m;return o===i.length?(c=h===i?1/0:c,{rendered:a.join(""),score:c}):null},n.filter=function(i,r,s){return!r||r.length===0?[]:typeof i!="string"?r:(s=s||{},r.reduce(function(o,a,l,c){var d=a;s.extract&&(d=s.extract(a));var u=n.match(i,d,s);return u!=null&&(o[o.length]={string:u.rendered,score:u.score,index:l,original:a}),o},[]).sort(function(o,a){var l=a.score-o.score;return l||o.index-a.index}))}})()})(HX);var TEe=HX.exports;const IEe=wl(TEe),SEe=8,xEe=10,W1=["rectangle","diamond","ellipse"],K1=["line","sharpArrow","curvedArrow","elbowArrow"],CEe=new Set(W1),AEe=new Set(K1),Jh=e=>CEe.has(e),Q6=e=>e==="arrow"||AEe.has(e),Aa=Wt(null),zm=new Map,Hm=new Map,MEe=({app:e})=>{const t=e.scene.getSelectedElements(e.state),n=R.useRef(null);return R.useEffect(()=>{if(t.length===0){e.updateEditorAtom(Aa,null);return}const i=Zy(t);i&&!n.current?n.current=i:(n.current&&!i||n.current&&i!==n.current)&&(e.updateEditorAtom(Aa,null),n.current=null)},[t,e]),R.useEffect(()=>()=>{zm.clear(),Hm.clear()},[]),g(kEe,{app:e,elements:t})},kEe=({app:e,elements:t})=>{const n=Zy(t),i=R.useMemo(()=>n==="generic"?GX(t):[],[n,t]),r=R.useMemo(()=>n==="linear"?Dv(t):[],[n,t]),s=n==="generic"?i.every(u=>u.type===i[0].type):n==="linear"?r.every(u=>dh(u)===dh(r[0])):!1,[o,a]=R.useState({x:0,y:0}),l=R.useRef(""),c=R.useRef(null);R.useEffect(()=>{const u=[...i,...r].sort((U,b)=>U.id.localeCompare(b.id)),f=`
      ${e.state.scrollX}${e.state.scrollY}${e.state.offsetTop}${e.state.offsetLeft}${e.state.zoom.value}${u.map(U=>U.id).join(",")}`;if(f===l.current)return;l.current=f;let h;if(u.length===1){const[U,,,b,y,w]=$e(u[0],e.scene.getNonDeletedElementsMap());h=Q(S(U,b),S(y,w),u[0].angle)}else{const{minX:U,maxY:b}=Ms(u);h=S(U,b)}const{x:m,y:p}=Wr({sceneX:h[0],sceneY:h[1]},e.state);a({x:m,y:p})},[i,r,e.scene,e.state]),R.useEffect(()=>{for(const u of r){const f=Rv(u.id,OEe(u));Hm.has(f)||Hm.set(f,u)}},[r]),R.useEffect(()=>{for(const u of i)if(!zm.has(u.id)){const f=Le(u,e.scene.getNonDeletedElementsMap());f&&zm.set(u.id,{fontSize:f.fontSize})}},[i,e.scene]);const d=n==="linear"?[["line",Y9],["sharpArrow",nT],["curvedArrow",rT],["elbowArrow",iT]]:n==="generic"?[["rectangle",G9],["diamond",X9],["ellipse",j9]]:[];return g("div",{ref:c,tabIndex:-1,style:{position:"absolute",top:`${o.y+(xEe+8)*e.state.zoom.value-e.state.offsetTop}px`,left:`${o.x-e.state.offsetLeft-SEe}px`,zIndex:2},className:Jr.CONVERT_ELEMENT_TYPE_POPUP,children:d.map(([u,f])=>{const h=s&&(n==="generic"&&i[0].type===u||n==="linear"&&dh(r[0])===u);return g(je,{className:"Shape",type:"radio",icon:f,checked:h,name:"convertElementType-option",title:u,keyBindingLabel:"","aria-label":u,"data-testid":`toolbar-${u}`,onChange:()=>{var m;e.state.activeTool.type!==u&&et("convertElementType",u,"ui"),VX(e,{conversionType:n,nextType:u}),(m=c.current)==null||m.focus()}},`${t[0].id}${t[0].version}_${u}`)})})},REe=(e,t,n)=>{const i=ta(e,t),r=Ap(e,t),s=ad(t.text,mt(t),i);let o=jn(s,mt(t),t.lineHeight),a=t.fontSize;for(;(o.width>i||o.height>r)&&a>0;){a-=1;const l={...t,fontSize:a};o=jn(t.text,mt(l),t.lineHeight)}_i(t,n.getNonDeletedElementsMap(),{fontSize:a,width:o.width,height:o.height}),Qi(t,e,n)},VX=(e,{conversionType:t,nextType:n,direction:i="right"})=>{var a;if(!t)return!1;const r=e.scene.getSelectedElements(e.state),s=r.reduce((l,c)=>({...l,[c.id]:!0}),{}),o=i==="right"?1:-1;if(t==="generic"){const l=GX(r),d=l.every(u=>u.type===l[0].type)?W1.indexOf(l[0].type):-1;if(n=n??W1[(d+W1.length+o)%W1.length],n&&Jh(n)){const u={};for(const h of l){const m=eD(h,n,e);u[m.id]=m}const f=[];for(const h of e.scene.getElementsIncludingDeleted())u[h.id]?f.push(u[h.id]):f.push(h);e.scene.replaceAllElements(f);for(const h of Object.values(u)){const m=Le(h,e.scene.getNonDeletedElementsMap());m&&(zm.get(h.id)&&_i(m,e.scene.getNonDeletedElementsMap(),{fontSize:((a=zm.get(h.id))==null?void 0:a.fontSize)??m.fontSize}),REe(h,m,e.scene))}e.setState(h=>({selectedElementIds:s,activeTool:tn(h,{type:"selection"})}))}}if(t==="linear"){const l=Dv(r);if(!n){const d=ZB(l,dh),u=d?K1.indexOf(d):-1;n=K1[(u+K1.length+o)%K1.length]}if(Q6(n)){const d=[],u=e.scene.getElementsMapIncludingDeleted();for(const f of l){const h=Hm.get(Rv(f.id,n));if(h&&dh(h)===n)u.set(h.id,h),d.push(h);else{const m=eD(f,n,e);u.set(m.id,m),d.push(m)}}e.scene.replaceAllElements(u);for(const f of d)if(xe(f))if(me(f)){const h=DEe(f);if(h.length<2)continue;const m=[];for(let U=1;U<h.length-2;U++)m.push({start:h[U],end:h[U+1],index:U+1});const p=_g(f,e.scene.getNonDeletedElementsMap(),{points:h,fixedSegments:m});_i(f,e.scene.getNonDeletedElementsMap(),{...p,endArrowhead:"arrow"})}else{const h=qse(["line","sharpArrow","curvedArrow"],m=>Hm.get(Rv(f.id,m)));if(h){const m=h.points;e.scene.mutateElement(f,{points:m})}}}const c=Dv(e.scene.getSelectedElements(e.state));e.setState(d=>({selectedElementIds:s,selectedLinearElement:c.length===1?new pe(c[0],e.scene.getNonDeletedElementsMap()):null,activeTool:tn(d,{type:"selection"})}))}return!0},Zy=e=>{if(e.length===0)return null;let t=!1;for(const n of e){if(Jh(n.type))return"generic";$X(n)&&(t=!0)}return t?"linear":null},$X=e=>xe(e)&&(!Ce(e)||!cz(e)&&!Li(e)),Rv=(e,t)=>`${e}:${t}`,GX=e=>e.filter(t=>Jh(t.type)),Dv=e=>e.filter(t=>$X(t)),o2=20,If=(e,t)=>e[0]===t[0],M3=(e,t)=>e[1]===t[1],JR=(e,t)=>If(e,t)?Math.abs(e[1]-t[1]):Math.abs(e[0]-t[0]),DEe=e=>{const t=[e.points[0]],n=LEe(e.points);for(let s=1;s<n.length;++s){const o=t[t.length-1],a=[...n[s]];Math.abs(a[0]-o[0])<o2?a[0]=o[0]:Math.abs(a[1]-o[1])<o2&&(a[1]=o[1]),If(o,a)||M3(o,a)||t.push(S(o[0],a[1])),t.push(a)}const i=[t[0]];for(let s=1;s<t.length-1;++s)If(t[s-1],t[s])&&If(t[s],t[s+1])||M3(t[s-1],t[s])&&M3(t[s],t[s+1])||i.push(t[s]);i.push(t[t.length-1]);const r=[i[0]];for(let s=1;s<i.length-1;++s){const o=r[r.length-1],a=i[s],l=i[s+1],c=If(o,a),d=If(a,l);if(c!==d){const u=JR(o,a),f=JR(a,l);if(u<o2||f<o2){if(f<u)c?l[0]=o[0]:l[1]=o[1];else if(d)for(let h=r.length-1;h>=0&&r[h][0]===o[0];--h)r[h][0]=a[0];else for(let h=r.length-1;h>=0&&r[h][1]===o[1];--h)r[h][1]=a[1];continue}}r.push(a)}return r.push(i[i.length-1]),r},LEe=e=>{if(e.length===0)return[];const t=[e[0]];for(let n=1;n<e.length;n++){const[i,r]=t[t.length-1],[s,o]=e[n];(i!==s||r!==o)&&t.push(e[n])}return t},eD=(e,t,n)=>{if(!NEe(e.type,t)||e.type===t)return e;if(qt.delete(e),Jh(t)){const i=Pa(ia({...e,type:t,roundness:t==="diamond"&&e.roundness?{type:$u(t)?yn.ADAPTIVE_RADIUS:yn.PROPORTIONAL_RADIUS}:e.roundness}));return gm(i,n.scene),i}if(Q6(t))switch(t){case"line":return Pa(Tc({...e,type:"line"}));case"sharpArrow":return Pa(gh({...e,type:"arrow",elbowed:!1,roundness:null,startArrowhead:n.state.currentItemStartArrowhead,endArrowhead:n.state.currentItemEndArrowhead}));case"curvedArrow":return Pa(gh({...e,type:"arrow",elbowed:!1,roundness:{type:yn.PROPORTIONAL_RADIUS},startArrowhead:n.state.currentItemStartArrowhead,endArrowhead:n.state.currentItemEndArrowhead}));case"elbowArrow":return Pa(gh({...e,type:"arrow",elbowed:!0,fixedSegments:null,roundness:null}))}return qo(t,`unhandled conversion type: ${t}`),e},NEe=(e,t)=>!!(Jh(e)&&Jh(t)||Q6(e)&&Q6(t)),OEe=e=>xe(e)?dh(e):e.type,PEe=ue({name:"toggleShapeSwitch",label:"labels.shapeSwitch",icon:()=>null,viewMode:!0,trackEvent:{category:"shape_switch",action:"toggle"},keywords:["change","switch","swap"],perform(e,t,n,i){return Gr.set(Aa,{type:"panel"}),{captureUpdate:Z.NEVER}},checked:e=>e.gridModeEnabled,predicate:(e,t,n)=>Zy(e)!==null}),XX=ue({name:"copyElementLink",label:"labels.copyElementLink",icon:Np,trackEvent:{category:"element"},perform:async(e,t,n,i)=>{const r=Xe(e,t);try{if(window.location){const s=dH(r,t);return s?(await ud(i.props.generateLinkForSelection?i.props.generateLinkForSelection(s.id,s.type):cH(s.id,s.type)),{appState:{toast:{message:M("toast.elementLinkCopied"),closable:!0}},captureUpdate:Z.EVENTUALLY}):{appState:t,elements:e,app:i,captureUpdate:Z.EVENTUALLY}}}catch(s){console.error(s)}return{appState:t,elements:e,app:i,captureUpdate:Z.EVENTUALLY}},predicate:(e,t)=>R6(Xe(e,t))}),FEe=ue({name:"linkToElement",label:"labels.linkToElement",icon:KV,perform:(e,t,n,i)=>{const r=Xe(e,t);return r.length!==1||!R6(r)?{elements:e,appState:t,app:i,captureUpdate:Z.EVENTUALLY}:{appState:{...t,openDialog:{name:"elementLinkSelector",sourceElementId:Xe(e,t)[0].id}},captureUpdate:Z.IMMEDIATELY}},predicate:(e,t,n,i)=>{var s;const r=Xe(e,t);return((s=t.openDialog)==null?void 0:s.name)!=="elementLinkSelector"&&r.length===1&&R6(r)},trackEvent:!1}),BEe={toggleTheme:[J("Shift+Alt+D")],saveScene:[J("CtrlOrCmd+S")],loadScene:[J("CtrlOrCmd+O")],clearCanvas:[J("CtrlOrCmd+Delete")],imageExport:[J("CtrlOrCmd+Shift+E")],commandPalette:[J("CtrlOrCmd+/"),J("CtrlOrCmd+Shift+P")],cut:[J("CtrlOrCmd+X")],copy:[J("CtrlOrCmd+C")],paste:[J("CtrlOrCmd+V")],copyStyles:[J("CtrlOrCmd+Alt+C")],pasteStyles:[J("CtrlOrCmd+Alt+V")],selectAll:[J("CtrlOrCmd+A")],deleteSelectedElements:[J("Delete")],duplicateSelection:[J("CtrlOrCmd+D"),J(`Alt+${M("helpDialog.drag")}`)],sendBackward:[J("CtrlOrCmd+[")],bringForward:[J("CtrlOrCmd+]")],sendToBack:[J(co?"CtrlOrCmd+Alt+[":"CtrlOrCmd+Shift+[")],bringToFront:[J(co?"CtrlOrCmd+Alt+]":"CtrlOrCmd+Shift+]")],copyAsPng:[J("Shift+Alt+C")],group:[J("CtrlOrCmd+G")],ungroup:[J("CtrlOrCmd+Shift+G")],gridMode:[J("CtrlOrCmd+'")],zenMode:[J("Alt+Z")],objectsSnapMode:[J("Alt+S")],stats:[J("Alt+/")],addToLibrary:[],flipHorizontal:[J("Shift+H")],flipVertical:[J("Shift+V")],viewMode:[J("Alt+R")],hyperlink:[J("CtrlOrCmd+K")],toggleElementLock:[J("CtrlOrCmd+Shift+L")],resetZoom:[J("CtrlOrCmd+0")],zoomOut:[J("CtrlOrCmd+-")],zoomIn:[J("CtrlOrCmd++")],zoomToFitSelection:[J("Shift+3")],zoomToFit:[J("Shift+1")],zoomToFitSelectionInViewport:[J("Shift+2")],toggleEraserTool:[J("E")],toggleHandTool:[J("H")],setFrameAsActiveTool:[J("F")],saveFileToDisk:[J("CtrlOrCmd+S")],saveToActiveFile:[J("CtrlOrCmd+S")],toggleShortcuts:[J("?")],searchMenu:[J("CtrlOrCmd+F")],wrapSelectionInFrame:[]},Zi=(e,t=0)=>{const n=BEe[e];return n&&n.length>0?n[t]||n[0]:""},zEe="\\u0300-\\u036f",HEe="\\ufe20-\\ufe2f",VEe="\\u20d0-\\u20ff",$Ee=zEe+HEe+VEe,GEe=`[${$Ee}]`,XEe=RegExp(GEe,"g"),jEe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,YEe={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"E",:"e",:"T",:"t",:"s",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"I",:"i",:"E",:"e",:"n",:"s"},P0=e=>e.replace(jEe,t=>YEe[t]||t).replace(XEe,""),jX=()=>{const[e,t]=R.useState(null),n=R.useCallback(i=>t(i),[]);return[e,n]};var qy={},WEe=KEe;function KEe(e,t){if(e=String(e),t=String(t),!/^[\x00-\xFF]+$/.test(e)||!/^[\x00-\xFF]+$/.test(t))throw new Error("Only Latin-1 characters are permitted in PNG tEXt chunks. You might want to consider base64 encoding and/or zEXt compression");if(e.length>=80)throw new Error('Keyword "'+e+'" is longer than the 79-character limit imposed by the PNG specification');for(var n=e.length+t.length+1,i=new Uint8Array(n),r=0,s,o=0;o<e.length;o++){if(!(s=e.charCodeAt(o)))throw new Error("0x00 character is not permitted in tEXt keywords");i[r++]=s}i[r++]=0;for(var a=0;a<t.length;a++){if(!(s=t.charCodeAt(a)))throw new Error("0x00 character is not permitted in tEXt content");i[r++]=s}return{name:"tEXt",data:i}}var ZEe=qEe;function qEe(e){e.data&&e.name&&(e=e.data);for(var t=!0,n="",i="",r=0;r<e.length;r++){var s=e[r];if(t)s?i+=String.fromCharCode(s):t=!1;else if(s)n+=String.fromCharCode(s);else throw new Error("Invalid NULL character found. 0x00 character is not permitted in tEXt content")}return{keyword:i,text:n}}qy.encode=WEe;qy.decode=ZEe;var QEe=function(e,t,n){var i=[],r=e.length;if(r===0)return i;var s=t<0?Math.max(0,t+r):t||0;for(n!==void 0&&(r=n<0?n+r:n);r-- >s;)i[r-s]=e[r];return i},GT={};(function(e){(function(t){t(typeof DO_NOT_EXPORT_CRC>"u"?e:{})})(function(t){t.version="0.3.0";function n(){for(var c=0,d=new Array(256),u=0;u!=256;++u)c=u,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,d[u]=c;return typeof Int32Array<"u"?new Int32Array(d):d}var i=n(),r=typeof Buffer<"u";function s(c){if(c.length>32768&&r)return a(new Buffer(c));for(var d=-1,u=c.length-1,f=0;f<u;)d=i[(d^c.charCodeAt(f++))&255]^d>>>8,d=i[(d^c.charCodeAt(f++))&255]^d>>>8;return f===u&&(d=d>>>8^i[(d^c.charCodeAt(f))&255]),d^-1}function o(c){if(c.length>1e4)return a(c);for(var d=-1,u=0,f=c.length-3;u<f;)d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255];for(;u<f+3;)d=d>>>8^i[(d^c[u++])&255];return d^-1}function a(c){for(var d=-1,u=0,f=c.length-7;u<f;)d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255];for(;u<f+7;)d=d>>>8^i[(d^c[u++])&255];return d^-1}function l(c){for(var d=-1,u=0,f=c.length,h,m;u<f;)h=c.charCodeAt(u++),h<128?d=d>>>8^i[(d^h)&255]:h<2048?(d=d>>>8^i[(d^(192|h>>6&31))&255],d=d>>>8^i[(d^(128|h&63))&255]):h>=55296&&h<57344?(h=(h&1023)+64,m=c.charCodeAt(u++)&1023,d=d>>>8^i[(d^(240|h>>8&7))&255],d=d>>>8^i[(d^(128|h>>2&63))&255],d=d>>>8^i[(d^(128|m>>6&15|h&3))&255],d=d>>>8^i[(d^(128|m&63))&255]):(d=d>>>8^i[(d^(224|h>>12&15))&255],d=d>>>8^i[(d^(128|h>>6&63))&255],d=d>>>8^i[(d^(128|h&63))&255]);return d^-1}t.table=i,t.bstr=s,t.buf=o,t.str=l})})(GT);var JEe=QEe,e8e=GT,t8e=r8e,xo=new Uint8Array(4),n8e=new Int32Array(xo.buffer),i8e=new Uint32Array(xo.buffer);function r8e(e){var t=8,n=t,i;for(i=0;i<e.length;i++)t+=e[i].data.length,t+=12;var r=new Uint8Array(t);for(r[0]=137,r[1]=80,r[2]=78,r[3]=71,r[4]=13,r[5]=10,r[6]=26,r[7]=10,i=0;i<e.length;i++){var s=e[i],o=s.name,a=s.data,l=a.length,c=[o.charCodeAt(0),o.charCodeAt(1),o.charCodeAt(2),o.charCodeAt(3)];i8e[0]=l,r[n++]=xo[3],r[n++]=xo[2],r[n++]=xo[1],r[n++]=xo[0],r[n++]=c[0],r[n++]=c[1],r[n++]=c[2],r[n++]=c[3];for(var d=0;d<l;)r[n++]=a[d++];var u=c.concat(JEe(a)),f=e8e.buf(u);n8e[0]=f,r[n++]=xo[3],r[n++]=xo[2],r[n++]=xo[1],r[n++]=xo[0]}return r}const s8e=wl(t8e);var o8e=GT,a8e=d8e,Co=new Uint8Array(4),l8e=new Int32Array(Co.buffer),c8e=new Uint32Array(Co.buffer);function d8e(e){if(e[0]!==137)throw new Error("Invalid .png file header");if(e[1]!==80)throw new Error("Invalid .png file header");if(e[2]!==78)throw new Error("Invalid .png file header");if(e[3]!==71)throw new Error("Invalid .png file header");if(e[4]!==13)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");if(e[5]!==10)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");if(e[6]!==26)throw new Error("Invalid .png file header");if(e[7]!==10)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");for(var t=!1,n=[],i=8;i<e.length;){Co[3]=e[i++],Co[2]=e[i++],Co[1]=e[i++],Co[0]=e[i++];var r=c8e[0]+4,s=new Uint8Array(r);s[0]=e[i++],s[1]=e[i++],s[2]=e[i++],s[3]=e[i++];var o=String.fromCharCode(s[0])+String.fromCharCode(s[1])+String.fromCharCode(s[2])+String.fromCharCode(s[3]);if(!n.length&&o!=="IHDR")throw new Error("IHDR header missing");if(o==="IEND"){t=!0,n.push({name:o,data:new Uint8Array(0)});break}for(var a=4;a<r;a++)s[a]=e[i++];Co[3]=e[i++],Co[2]=e[i++],Co[1]=e[i++],Co[0]=e[i++];var l=l8e[0],c=o8e.buf(s);if(c!==l)throw new Error("CRC values for "+o+" header do not match, PNG file is likely corrupted");var d=new Uint8Array(s.buffer.slice(4));n.push({name:o,data:d})}if(!t)throw new Error(".png file ended prematurely: no IEND header was found");return n}const YX=wl(a8e),WX=async e=>{const n=YX(new Uint8Array(await Hp(e))).find(i=>i.name==="tEXt");return n?qy.decode(n.data):null},KX=async({blob:e,metadata:t})=>{const n=YX(new Uint8Array(await Hp(e))),i=qy.encode(Te.excalidraw,JSON.stringify(nX({text:t,compress:!0})));return n.splice(-1,0,i),new Blob([s8e(n)],{type:Te.png})},u8e=async e=>{const t=await WX(e);if((t==null?void 0:t.keyword)===Te.excalidraw)try{const n=JSON.parse(t.text);if(!("encoded"in n)){if("type"in n&&n.type===Cs.excalidraw)return t.text;throw new Error("FAILED")}return iX(n)}catch(n){throw console.error(n),new Error("FAILED")}throw new Error("INVALID")},ZX=Object.freeze(Object.defineProperty({__proto__:null,decodePngMetadata:u8e,encodePngMetadata:KX,getTEXtChunk:WX},Symbol.toStringTag,{value:"Module"})),Qy=({elements:e,appState:t,files:n,maxWidthOrHeight:i,getDimensions:r,exportPadding:s,exportingFrame:o})=>{const{elements:a,appState:l}=Cu({elements:e,appState:t},null,null,{deleteInvisibleElements:!0}),{exportBackground:c,viewBackgroundColor:d}=l;return UX(a,{...l,offsetTop:0,offsetLeft:0,width:0,height:0},n||{},{exportBackground:c,exportPadding:s,viewBackgroundColor:d,exportingFrame:o},(u,f)=>{const h=document.createElement("canvas");if(i){typeof r=="function"&&console.warn("`getDimensions()` is ignored when `maxWidthOrHeight` is supplied.");const p=Math.max(u,f),U=i<p?i/p:(t==null?void 0:t.exportScale)??1;return h.width=u*U,h.height=f*U,{canvas:h,scale:U}}const m=(r==null?void 0:r(u,f))||{width:u,height:f};return h.width=m.width,h.height=m.height,{canvas:h,scale:m.scale??1}})},f8e=async e=>{var r;let{mimeType:t=Te.png,quality:n}=e;t===Te.png&&typeof n=="number"&&console.warn(`"quality" will be ignored for "${Te.png}" mimeType`),t==="image/jpg"&&(t=Te.jpg),t===Te.jpg&&!((r=e.appState)!=null&&r.exportBackground)&&(console.warn(`Defaulting "exportBackground" to "true" for "${Te.jpg}" mimeType`),e={...e,appState:{...e.appState,exportBackground:!0}});const i=await Qy(e);return n=n||(/image\/jpe?g/.test(t)?.92:.8),new Promise((s,o)=>{i.toBlob(async a=>{var l;if(!a)return o(new Error("couldn't export to blob"));a&&t===Te.png&&((l=e.appState)!=null&&l.exportEmbedScene)&&(a=await KX({blob:a,metadata:Lg(e.elements,e.appState,e.files||{},"local")})),s(a)},t,n)})},qX=async({elements:e,appState:t=sa(),files:n={},exportPadding:i,renderEmbeddables:r,exportingFrame:s,skipInliningFonts:o,reuseImages:a})=>{const{elements:l,appState:c}=Cu({elements:e,appState:t},null,null,{deleteInvisibleElements:!0}),d={...c,exportPadding:i};return OT(l,d,n,{exportingFrame:s,renderEmbeddables:r,skipInliningFonts:o,reuseImages:a})},QX=Wt(new Map),tD=async e=>await qX({elements:e,appState:{exportBackground:!1,viewBackgroundColor:Ye.white},files:null,renderEmbeddables:!1,skipInliningFonts:!0}),JX=(e,t,n,i)=>{const[r,s]=R.useState();return R.useEffect(()=>{if(t)if(e){const o=n.get(e);o?s(o):(async()=>{var l;const a=await tD(t);(l=a.querySelector(".style-fonts"))==null||l.remove(),a&&(n.set(e,a),s(a))})()}else(async()=>{const o=await tD(t);s(o)})()},[e,t,n,s]),R.useEffect(()=>{const o=i.current;if(o)return r&&(o.innerHTML=r.outerHTML),()=>{o.innerHTML=""}},[r,i]),r},XT=()=>{const[e]=un(QX);return{clearLibraryCache:()=>e.clear(),deleteItemsFromLibraryCache:i=>{i.forEach(r=>e.delete(r))},svgCache:e}},h8e=["excalidraw.com","raw.githubusercontent.com/excalidraw/excalidraw-libraries"],ej=new Ws,eg=Wt({status:"loaded",isInitialized:!1,libraryItems:[]}),v1=e=>Qa(e),g8e=(e,t)=>!e.find(n=>n.elements.length!==t.elements.length?!1:n.elements.every((i,r)=>i.id===t.elements[r].id&&i.versionNonce===t.elements[r].versionNonce)),m8e=(e,t)=>{const n=[];for(const i of t)g8e(e,i)&&n.push(i);return[...n,...e]},tj=(e,t)=>{const n=ve(t),i={deletedItems:new Map,addedItems:new Map,updatedItems:new Map};for(const s of e)n.has(s.id)||i.deletedItems.set(s.id,s);const r=ve(e);for(const s of t){const o=r.get(s.id);o?Nv(o)!==Nv(s)&&i.updatedItems.set(s.id,s):i.addedItems.set(s.id,s)}return i};class p8e{constructor(t){this.currLibraryItems=[],this.prevLibraryItems=v1(this.currLibraryItems),this.updateQueue=[],this.getLastUpdateTask=()=>this.updateQueue[this.updateQueue.length-1],this.notifyListeners=()=>{var n,i;if(this.updateQueue.length>0)Gr.set(eg,r=>({status:"loading",libraryItems:this.currLibraryItems,isInitialized:r.isInitialized}));else{Gr.set(eg,{status:"loaded",libraryItems:this.currLibraryItems,isInitialized:!0});try{const r=this.prevLibraryItems;this.prevLibraryItems=v1(this.currLibraryItems);const s=v1(this.currLibraryItems);(i=(n=this.app.props).onLibraryChange)==null||i.call(n,s),ej.trigger(tj(r,s),s)}catch(r){console.error(r)}}},this.destroy=()=>{this.updateQueue=[],this.currLibraryItems=[],Gr.set(QX,new Map)},this.resetLibrary=()=>this.setLibrary([]),this.getLatestLibrary=()=>new Promise(async n=>{try{const i=await(this.getLastUpdateTask()||this.currLibraryItems);this.updateQueue.length>0?n(this.getLatestLibrary()):n(v1(i))}catch{return n(this.currLibraryItems)}}),this.updateLibrary=async({libraryItems:n,prompt:i=!1,merge:r=!1,openLibraryMenu:s=!1,defaultStatus:o="unpublished"})=>(s&&this.app.setState({openSidebar:{name:As.name,tab:Qb}}),this.setLibrary(()=>new Promise(async(a,l)=>{try{const c=await(typeof n=="function"&&!(n instanceof Blob)?n(this.currLibraryItems):n);let d;c instanceof Blob?d=await bye(c,o):d=jy(c,o),!i||window.confirm(M("alerts.confirmAddLibrary",{numShapes:d.length}))?(i&&this.app.focusContainer(),a(r?m8e(this.currLibraryItems,d):d)):l(new Kh)}catch(c){l(c)}}))),this.setLibrary=n=>{const i=new Promise(async(r,s)=>{try{await this.getLastUpdateTask(),typeof n=="function"&&(n=n(this.currLibraryItems)),this.currLibraryItems=v1(await n),r(this.currLibraryItems)}catch(o){s(o)}}).catch(r=>{if(r.name==="AbortError")return console.warn("Library update aborted by user"),this.currLibraryItems;throw r}).finally(()=>{this.updateQueue=this.updateQueue.filter(r=>r!==i),this.notifyListeners()});return this.updateQueue.push(i),this.notifyListeners(),i},this.app=t}}const jT=e=>{const n=Math.ceil(Math.sqrt(e.length)),i=[],r=h=>e.slice(h*n,h*n+n).reduce((p,U)=>{const{height:b}=Ms(U.elements);return Math.max(p,b)},0),s=h=>{let m=0,p=0,U=0;for(const b of e){if(m%n===0&&(p=0),p===h){const{width:y}=Ms(b.elements);U=Math.max(U,y)}m++,p++}return U};let o=0,a=0,l=0,c=0,d=0,u=0,f=0;for(const h of e){d&&d%n===0&&(a+=l+50,o=0,u=0,f++),u===0&&(l=r(f)),c=s(u);const{minX:m,minY:p,width:U,height:b}=Ms(h.elements),y=(c-U)/2,w=(l-b)/2;i.push(...h.elements.map(v=>({...v,x:v.x+o+y-m,y:v.y+a+w-p}))),o+=c+50,d++,u++}return i},U8e=(e,t=h8e)=>{if(typeof t=="function"?t(e):t.some(n=>{const i=new URL(`https://${n.replace(/^https?:\/\//,"")}`),{hostname:r,pathname:s}=new URL(e);return new RegExp(`(^|\\.)${i.hostname}$`).test(r)&&new RegExp(`^${i.pathname.replace(/\/+$/,"")}(/+|$)`).test(s)}))return!0;throw new Error(`Invalid or disallowed library URL: "${e}"`)},Lv=()=>{const e=new URLSearchParams(window.location.hash.slice(1)).get(w4.addLibrary)||new URLSearchParams(window.location.search).get(v4.addLibrary),t=e?new URLSearchParams(window.location.hash.slice(1)).get("token"):null;return e?{libraryUrl:e,idToken:t}:null},ql=class ql{static async getLibraryItems(t,n,i=!0){const r=()=>new Promise(async(s,o)=>{try{const a=await t.load({source:n});s(jy((a==null?void 0:a.libraryItems)||[],"published"))}catch(a){o(a)}});return i?ql.queue.push(r):r()}constructor(t){this.adapter=t}getLibraryItems(t){return ql.getLibraryItems(this.adapter,t,!1)}};ql.queue=new rse,ql.run=async(t,n)=>{const i=new ql(t);return ql.queue.push(()=>n(i))};let wh=ql,F0=0,J6=0;const Nv=e=>`${e.id}:${e.name||""}:${AH(e.elements)}`,Ov=e=>B9(e.map(t=>Nv(t)).sort().join()),nD=async(e,t)=>{try{return J6++,await wh.run(e,async n=>{const i=ve(await n.getLibraryItems("save"));for(const[a]of t.deletedItems)i.delete(a);const r=[];for(const[a,l]of t.addedItems)i.has(a)?i.set(a,l):r.push(l);if(t.updatedItems)for(const[a,l]of t.updatedItems)i.set(a,l);const s=r.concat(Array.from(i.values())),o=Ov(s);return o!==F0&&await e.save({libraryItems:s}),F0=o,s})}finally{J6--}},b8e=e=>{const{excalidrawAPI:t}=e,n=R.useRef(e);n.current=e;const i=R.useRef(!1);R.useEffect(()=>{if(!t)return;i.current=!1;const r=async({libraryUrl:a,idToken:l})=>{const c=new Promise(async(u,f)=>{try{a=decodeURIComponent(a),a=q_(a),U8e(a,n.current.validateLibraryUrl);const m=await(await fetch(a)).blob();u(m)}catch(h){f(h)}}),d=l!==t.id;await(d&&document.hidden?new Promise(u=>{window.addEventListener("focus",()=>u(),{once:!0})}):null);try{await t.updateLibrary({libraryItems:c,prompt:d,merge:!0,defaultStatus:"published",openLibraryMenu:!0})}catch(u){throw t.updateScene({appState:{errorMessage:u.message}}),u}finally{if(window.location.hash.includes(w4.addLibrary)){const u=new URLSearchParams(window.location.hash.slice(1));u.delete(w4.addLibrary),window.history.replaceState({},wc,`#${u.toString()}`)}else if(window.location.search.includes(v4.addLibrary)){const u=new URLSearchParams(window.location.search);u.delete(v4.addLibrary),window.history.replaceState({},wc,`?${u.toString()}`)}}},s=a=>{a.preventDefault();const l=Lv();l&&(a.stopImmediatePropagation(),window.history.replaceState({},"",a.oldURL),r(l))},o=Lv();if(o&&r(o),"getInitialLibraryItems"in n.current&&n.current.getInitialLibraryItems&&(console.warn("useHandleLibrar `opts.getInitialLibraryItems` is deprecated. Use `opts.adapter` instead."),Promise.resolve(n.current.getInitialLibraryItems()).then(a=>{t.updateLibrary({libraryItems:a,merge:!0})}).catch(a=>{console.error(`UseHandeLibrary getInitialLibraryItems failed: ${a==null?void 0:a.message}`)})),"adapter"in n.current&&n.current.adapter){const a=n.current.adapter,l=n.current.migrationAdapter,c=iy();l?c.resolve(Hc(l.load).then(async d=>{let u=null;try{if(!d)return wh.getLibraryItems(a,"load");u=jy(d.libraryItems||[],"published");const f=await nD(a,tj([],u));try{await l.clear()}catch(h){console.error(`couldn't delete legacy library data: ${h.message}`)}return f}catch(f){return console.error(`couldn't migrate legacy library data: ${f.message}`),u}}).catch(d=>(console.error(`error during library migration: ${d.message}`),wh.getLibraryItems(a,"load")))):c.resolve(Hc(wh.getLibraryItems,a,"load")),t.updateLibrary({libraryItems:c.then(d=>{const u=d||[];return F0=Ov(u),u}),merge:!0}).finally(()=>{i.current=!0})}return window.addEventListener(te.HASHCHANGE,s),()=>{window.removeEventListener(te.HASHCHANGE,s)}},[t]),R.useEffect(()=>{const r=ej.on(async(o,a)=>{const l=i.current,c="adapter"in n.current&&n.current.adapter||null;try{c&&F0!==Ov(a)&&await nD(c,o)}catch(d){console.error(`couldn't persist library update: ${d.message}`,o),l&&n.current.excalidrawAPI&&n.current.excalidrawAPI.updateScene({appState:{errorMessage:M("errors.saveLibraryError")}})}}),s=o=>{J6&&W_(o)};return window.addEventListener(te.BEFORE_UNLOAD,s),()=>{window.removeEventListener(te.BEFORE_UNLOAD,s),r(),F0=0,J6=0}},[])},y8e=({theme:e,id:t,libraryReturnUrl:n})=>{const i=n||window.location.origin+window.location.pathname;return g("a",{className:"library-menu-browse-button",href:`https://libraries.excalidraw.com?target=${window.name||"_blank"}&referrer=${i}&useHash=true&token=${t}&theme=${e}&version=${ey.excalidrawLibrary}`,target:"_excalidraw_libraries",children:M("labels.libraries")})},nj=({libraryReturnUrl:e,theme:t,id:n,style:i,children:r,className:s})=>N("div",{className:le("library-menu-control-buttons",s),style:i,children:[g(y8e,{id:n,libraryReturnUrl:e,theme:t}),r]}),E8e=Wt(0),v8e=e=>{const[t,n]=un(E8e);return R.useEffect(()=>{const{current:i}=e;if(!i)return;const r=zo(()=>{const{scrollTop:s}=i;n(s)},200);return i.addEventListener("scroll",r),()=>{r.cancel(),i.removeEventListener("scroll",r)}},[e,n]),t},tg=({label:e,onClick:t,className:n,children:i,actionType:r,type:s="button",isLoading:o,...a})=>{const l=r?`Dialog__action-button--${r}`:"";return N("button",{className:le("Dialog__action-button",l,n),type:s,"aria-label":e,onClick:t,...a,children:[i&&g("div",{style:o?{visibility:"hidden"}:{},children:i}),g("div",{style:o?{visibility:"hidden"}:{},children:e}),o&&g("div",{style:{position:"absolute",inset:0},children:g(hl,{})})]})},ij=e=>{const{onConfirm:t,onCancel:n,children:i,confirmText:r=M("buttons.confirm"),cancelText:s=M("buttons.cancel"),className:o="",...a}=e,l=xn(),c=py(YT),{container:d}=Dr();return N(as,{onCloseRequest:n,size:"small",...a,className:`confirm-dialog ${o}`,children:[i,N("div",{className:"confirm-dialog-buttons",children:[g(tg,{label:s,onClick:()=>{l({openMenu:null}),c(!1),mi.flushSync(()=>{n()}),d==null||d.focus()}}),g(tg,{label:r,onClick:()=>{l({openMenu:null}),c(!1),mi.flushSync(()=>{t()}),d==null||d.focus()},actionType:"danger"})]})]})};class iu{static has(t){try{return!!window.localStorage.getItem(t)}catch(n){return console.warn(`localStorage.getItem error: ${n.message}`),!1}}static get(t){try{const n=window.localStorage.getItem(t);return n?JSON.parse(n):null}catch(n){return console.warn(`localStorage.getItem error: ${n.message}`),null}}}F(iu,"set",(t,n)=>{try{return window.localStorage.setItem(t,JSON.stringify(n)),!0}catch(i){return console.warn(`localStorage.setItem error: ${i.message}`),!1}}),F(iu,"delete",t=>{try{window.localStorage.removeItem(t)}catch(n){console.warn(`localStorage.removeItem error: ${n.message}`)}});const w8e=/({{[\w-]+}})|(<[\w-]+>)|(<\/[\w-]+>)/g,_8e=/{{([\w-]+)}}/,T8e=/<([\w-]+)>/,I8e=/<\/([\w-]+)>/,S8e=(e,t)=>{const n=[{name:"",children:[]}];return e.split(w8e).filter(Boolean).forEach(i=>{const r=i.match(T8e),s=i.match(I8e),o=i.match(_8e);if(r!==null){const a=r[1];t.hasOwnProperty(a)?n.push({name:a,children:[]}):console.warn(`Trans: missed to pass in prop ${a} for interpolating ${e}`)}else if(s!==null)if(s[1]===n[n.length-1].name){const l=n.pop(),c=de.createElement(de.Fragment,{},...l.children),d=t[l.name];typeof d=="function"&&n[n.length-1].children.push(d(c))}else console.warn(`Trans: unexpected end tag ${i} for interpolating ${e}`);else if(o!==null){const a=o[1];t.hasOwnProperty(a)?n[n.length-1].children.push(t[a]):console.warn(`Trans: key ${a} not in props for interpolating ${e}`)}else n[n.length-1].children.push(i)}),n.length!==1&&console.warn(`Trans: stack not empty for interpolating ${e}`),n[0].children},xr=({i18nKey:e,children:t,...n})=>{const{t:i}=fn();return de.createElement(de.Fragment,{},...S8e(i(e),n))},x8e=async e=>{const i=Math.round(8),r=Math.max(Math.round(128/64),2),s=Yse(e,6),o=document.createElement("canvas");o.width=s[0].length*128+(s[0].length+1)*(i*2)-i*2,o.height=s.length*128+(s.length+1)*(i*2)-i*2;const a=o.getContext("2d");a.fillStyle=yi.white,a.fillRect(0,0,o.width,o.height);for(const[l,c]of e.entries()){const d=await Qy({elements:c.elements,files:null,maxWidthOrHeight:128}),{width:u,height:f}=d,h=Math.floor(l/6)*(128+i*2),m=l%6*(128+i*2);a.drawImage(d,m+(128-u)/2+i,h+(128-f)/2+i),a.lineWidth=r,a.strokeStyle=yi.gray[4],a.strokeRect(m+i/2,h+i/2,128+i,128+i)}return await IX(new File([await Pm(o)],"preview",{type:Te.png}),{outputType:Te.jpg,maxWidthOrHeight:5e3})},C8e=({libItem:e,appState:t,index:n,onChange:i,onRemove:r})=>{const s=R.useRef(null),o=R.useRef(null);return R.useEffect(()=>{const a=s.current;a&&(async()=>{const l=await qX({elements:e.elements,appState:{...t,viewBackgroundColor:yi.white,exportBackground:!0},files:null,skipInliningFonts:!0});a.innerHTML=l.outerHTML})()},[e.elements,t]),N("div",{className:"single-library-item",children:[e.status==="published"&&g("span",{className:"single-library-item-status",children:M("labels.statusPublished")}),g("div",{ref:s,className:"single-library-item__svg"}),g(je,{"aria-label":M("buttons.remove"),type:"button",icon:ju,className:"single-library-item--remove",onClick:r.bind(null,e.id),title:M("buttons.remove")}),N("div",{style:{display:"flex",margin:"0.8rem 0",width:"100%",fontSize:"14px",fontWeight:500,flexDirection:"column"},children:[N("label",{style:{display:"flex",justifyContent:"space-between",flexDirection:"column"},children:[N("div",{style:{padding:"0.5em 0"},children:[g("span",{style:{fontWeight:500,color:yi.gray[6]},children:M("publishDialog.itemName")}),g("span",{"aria-hidden":"true",className:"required",children:"*"})]}),g("input",{type:"text",ref:o,style:{width:"80%",padding:"0.2rem"},defaultValue:e.name,placeholder:"Item name",onChange:a=>{i(a.target.value,n)}})]}),g("span",{className:"error",children:e.error})]})]})},A8e=({onClose:e,libraryItems:t,appState:n,onSuccess:i,onError:r,updateItemsInStorage:s,onRemove:o})=>{const[a,l]=R.useState({authorName:"",githubHandle:"",name:"",description:"",twitterHandle:"",website:""}),[c,d]=R.useState(!1);R.useEffect(()=>{const w=iu.get(b0.PUBLISH_LIBRARY);w&&l(w)},[]);const[u,f]=R.useState(t.slice());R.useEffect(()=>{f(t.slice())},[t]);const h=w=>{l({...a,[w.target.name]:w.target.value})},m=async w=>{w.preventDefault(),d(!0);const v=[];let I=!1;if(u.forEach(D=>{let O="";D.name||(O=M("publishDialog.errors.required"),I=!0),v.push({...D,error:O})}),I){f(v),d(!1);return}const C=await x8e(u),_={type:Cs.excalidrawLibrary,version:ey.excalidrawLibrary,source:P_(),libraryItems:u},T=JSON.stringify(_,null,2),k=new Blob([T],{type:"application/json"}),x=new FormData;x.append("excalidrawLib",k),x.append("previewImage",C),x.append("previewImageType",C.type),x.append("title",a.name),x.append("authorName",a.authorName),x.append("githubHandle",a.githubHandle),x.append("name",a.name),x.append("description",a.description),x.append("twitterHandle",a.twitterHandle),x.append("website",a.website),fetch("https://us-central1-excalidraw-room-persistence.cloudfunctions.net/libraries/submit",{method:"post",body:x}).then(D=>D.ok?D.json().then(({url:O})=>{iu.delete(b0.PUBLISH_LIBRARY),i({url:O,authorName:a.authorName,items:u})}):D.json().catch(()=>{throw new Error(D.statusText||"something went wrong")}).then(O=>{throw new Error(O.message||D.statusText||"something went wrong")}),D=>{console.error(D),r(D),d(!1)}).catch(D=>{console.error(D),r(D),d(!1)})},p=()=>{const w=[];return u.forEach((v,I)=>{w.push(g("div",{className:"single-library-item-wrapper",children:g(C8e,{libItem:v,appState:n,index:I,onChange:(C,_)=>{const T=u.slice();T[_].name=C,f(T)},onRemove:o})},I))}),g("div",{className:"selected-library-items",children:w})},U=R.useCallback(()=>{s(u),iu.set(b0.PUBLISH_LIBRARY,a),e()},[u,e,s,a]),b=!!t.length,y=t.some(w=>w.status==="published");return g(as,{onCloseRequest:U,title:M("publishDialog.title"),className:"publish-library",children:b?N("form",{onSubmit:m,children:[g("div",{className:"publish-library-note",children:g(xr,{i18nKey:"publishDialog.noteDescription",link:w=>g("a",{href:"https://libraries.excalidraw.com",target:"_blank",rel:"noopener",children:w})})}),g("span",{className:"publish-library-note",children:g(xr,{i18nKey:"publishDialog.noteGuidelines",link:w=>g("a",{href:"https://github.com/excalidraw/excalidraw-libraries#guidelines",target:"_blank",rel:"noopener noreferrer",children:w})})}),g("div",{className:"publish-library-note",children:M("publishDialog.noteItems")}),y&&g("span",{className:"publish-library-note publish-library-warning",children:M("publishDialog.republishWarning")}),p(),N("div",{className:"publish-library__fields",children:[N("label",{children:[N("div",{children:[g("span",{children:M("publishDialog.libraryName")}),g("span",{"aria-hidden":"true",className:"required",children:"*"})]}),g("input",{type:"text",name:"name",required:!0,value:a.name,onChange:h,placeholder:M("publishDialog.placeholder.libraryName")})]}),N("label",{style:{alignItems:"flex-start"},children:[N("div",{children:[g("span",{children:M("publishDialog.libraryDesc")}),g("span",{"aria-hidden":"true",className:"required",children:"*"})]}),g("textarea",{name:"description",rows:4,required:!0,value:a.description,onChange:h,placeholder:M("publishDialog.placeholder.libraryDesc")})]}),N("label",{children:[N("div",{children:[g("span",{children:M("publishDialog.authorName")}),g("span",{"aria-hidden":"true",className:"required",children:"*"})]}),g("input",{type:"text",name:"authorName",required:!0,value:a.authorName,onChange:h,placeholder:M("publishDialog.placeholder.authorName")})]}),N("label",{children:[g("span",{children:M("publishDialog.githubUsername")}),g("input",{type:"text",name:"githubHandle",value:a.githubHandle,onChange:h,placeholder:M("publishDialog.placeholder.githubHandle")})]}),N("label",{children:[g("span",{children:M("publishDialog.twitterUsername")}),g("input",{type:"text",name:"twitterHandle",value:a.twitterHandle,onChange:h,placeholder:M("publishDialog.placeholder.twitterHandle")})]}),N("label",{children:[g("span",{children:M("publishDialog.website")}),g("input",{type:"text",name:"website",pattern:"https?://.+",title:M("publishDialog.errors.website"),value:a.website,onChange:h,placeholder:M("publishDialog.placeholder.website")})]}),g("span",{className:"publish-library-note",children:g(xr,{i18nKey:"publishDialog.noteLicense",link:w=>g("a",{href:"https://github.com/excalidraw/excalidraw-libraries/blob/main/LICENSE",target:"_blank",rel:"noopener noreferrer",children:w})})})]}),N("div",{className:"publish-library__buttons",children:[g(tg,{label:M("buttons.saveLibNames"),onClick:U,"data-testid":"cancel-clear-canvas-button"}),g(tg,{type:"submit",label:M("buttons.submit"),actionType:"primary",isLoading:c})]})]}):g("p",{style:{padding:"1em",textAlign:"center",fontWeight:500},children:M("publishDialog.atleastOneLibItem")})})},M8e=R.forwardRef(({children:e,gap:t,align:n,justifyContent:i,className:r,style:s},o)=>g("div",{className:le("Stack Stack_horizontal",r),style:{"--gap":t,alignItems:n,justifyContent:i,...s},ref:o,children:e})),k8e=R.forwardRef(({children:e,gap:t,align:n,justifyContent:i,className:r,style:s},o)=>g("div",{className:le("Stack Stack_vertical",r),style:{"--gap":t,justifyItems:n,justifyContent:i,...s},ref:o,children:e})),ja={Row:M8e,Col:k8e},rj=({children:e,onClickOutside:t,className:n="",onSelect:i,style:r,placement:s="bottom"})=>{const o=Nn(),a=R.useRef(null),l=Cy({onClickOutside:t});yT(a,d=>{var u,f,h;(f=(u=a.current)==null?void 0:u.closest(".dropdown-menu-container"))!=null&&f.contains(d.target)||(h=l.onClickOutside)==null||h.call(l)}),R.useEffect(()=>{const d=f=>{var h;f.key===V.ESCAPE&&(f.stopImmediatePropagation(),(h=l.onClickOutside)==null||h.call(l))},u={capture:!0};return document.addEventListener(te.KEYDOWN,d,u),()=>{document.removeEventListener(te.KEYDOWN,d,u)}},[l]);const c=le(`dropdown-menu ${n}`,{"dropdown-menu--mobile":o.formFactor==="phone","dropdown-menu--placement-top":s==="top"}).trim();return g(iG.Provider,{value:{onSelect:i},children:g("div",{ref:a,className:c,style:r,"data-testid":"dropdown-menu",children:o.formFactor==="phone"?g(ja.Col,{className:"dropdown-menu-container",children:e}):g(Is,{className:"dropdown-menu-container",padding:2,style:{zIndex:2},children:e})})})};rj.displayName="DropdownMenuContent";const R8e=({children:e,className:t="",selected:n,...i})=>g("div",{...i,className:`dropdown-menu-item-base dropdown-menu-item-custom ${t} ${n?"dropdown-menu-item--selected":""}`.trim(),children:e}),B0=({icon:e,shortcut:t,href:n,children:i,onSelect:r,className:s="",selected:o,rel:a="noopener",...l})=>{const c=sG(l.onClick,r);return g("a",{...l,href:n,target:"_blank",rel:a||"noopener",className:rG(s,o),title:l.title??l["aria-label"],onClick:c,children:g(nG,{icon:e,shortcut:t,children:i})})};B0.displayName="DropdownMenuItemLink";const sj=()=>g("div",{style:{height:"1px",backgroundColor:"var(--default-border-color)",margin:".5rem 0",flex:"0 0 auto"}});sj.displayName="DropdownMenuSeparator";const oj=({className:e="",children:t,onToggle:n,title:i,...r})=>{const s=Nn(),o=le(`dropdown-menu-button ${e}`,"zen-mode-transition",{"dropdown-menu-button--mobile":s.formFactor==="phone"}).trim();return g("button",{className:o,onClick:n,type:"button","data-testid":"dropdown-menu-button",title:i,...r,children:t})};oj.displayName="DropdownMenuTrigger";const D8e=e=>{const t=de.Children.toArray(e).find(n=>de.isValidElement(n)&&typeof n.type!="string"&&(n==null?void 0:n.type.displayName)&&n.type.displayName==="DropdownMenuTrigger");return t||null},L8e=e=>{const t=de.Children.toArray(e).find(n=>de.isValidElement(n)&&typeof n.type!="string"&&(n==null?void 0:n.type.displayName)&&n.type.displayName==="DropdownMenuContent");return t||null},Ve=({children:e,open:t,placement:n})=>{const i=D8e(e),r=L8e(e),s=r&&de.isValidElement(r)?de.cloneElement(r,{placement:n}):r;return N("div",{className:"dropdown-menu-container",style:{display:"contents"},children:[i,t&&s]})};Ve.Trigger=oj;Ve.Content=rj;Ve.Item=Rr;Ve.ItemLink=B0;Ve.ItemCustom=R8e;Ve.Group=V6;Ve.Separator=sj;Ve.displayName="DropdownMenu";const N8e=(e,t)=>e.filter(n=>t.includes(n.id)),O8e=({setAppState:e,selectedItems:t,library:n,onRemoveFromLibrary:i,resetLibrary:r,onSelectItems:s,appState:o,className:a})=>{const[l]=un(eg),[c,d]=un(YT),u=()=>{const x=t.length?M("alerts.removeItemsFromsLibrary",{count:t.length}):M("alerts.resetLibrary"),D=t.length?M("confirmDialog.removeItemsFromLib"):M("confirmDialog.resetLibrary");return g(ij,{onConfirm:()=>{t.length?i():r(),h(!1)},onCancel:()=>{h(!1)},title:D,children:g("p",{children:x})})},[f,h]=R.useState(!1),m=!!t.length,p=m?l.libraryItems.filter(x=>t.includes(x.id)):l.libraryItems,U=M(m?"buttons.remove":"buttons.resetLibrary"),[b,y]=R.useState(!1),[w,v]=R.useState(null),I=R.useCallback(()=>N(as,{onCloseRequest:()=>v(null),title:M("publishSuccessDialog.title"),className:"publish-library-success",size:"small",children:[g("p",{children:g(xr,{i18nKey:"publishSuccessDialog.content",authorName:w.authorName,link:x=>g("a",{href:w==null?void 0:w.url,target:"_blank",rel:"noopener noreferrer",children:x})})}),g(je,{type:"button",title:M("buttons.close"),"aria-label":M("buttons.close"),label:M("buttons.close"),onClick:()=>v(null),"data-testid":"publish-library-success-close",className:"publish-library-success-close"})]}),[v,w]),C=(x,D)=>{y(!1),v({url:x.url,authorName:x.authorName});const O=D.slice();O.forEach(L=>{t.includes(L.id)&&(L.status="published")}),n.setLibrary(O)},_=async()=>{try{await n.updateLibrary({libraryItems:LT({description:"Excalidraw library files"}),merge:!0,openLibraryMenu:!0})}catch(x){if((x==null?void 0:x.name)==="AbortError"){console.warn(x);return}e({errorMessage:M("errors.importLibraryError")})}},T=async()=>{const x=m?p:await n.getLatestLibrary();Q5e(x).catch($B).catch(D=>{e({errorMessage:D.message})})},k=()=>N(Ve,{open:c,children:[g(Ve.Trigger,{onToggle:()=>d(!c),children:_ue}),N(Ve.Content,{onClickOutside:()=>d(!1),onSelect:()=>d(!1),className:"library-menu",children:[!m&&g(Ve.Item,{onSelect:_,icon:Z9,"data-testid":"lib-dropdown--load",children:M("buttons.load")}),!!p.length&&g(Ve.Item,{onSelect:T,icon:Ey,"data-testid":"lib-dropdown--export",children:M("buttons.export")}),m&&g(Ve.Item,{icon:Mfe,onSelect:()=>y(!0),"data-testid":"lib-dropdown--remove",children:M("buttons.publishLibrary")}),!!p.length&&g(Ve.Item,{onSelect:()=>h(!0),icon:Xc,children:U})]})]});return N("div",{className:le("library-menu-dropdown-container",a),children:[k(),t.length>0&&g("div",{className:"library-actions-counter",children:t.length}),f&&u(),b&&g(A8e,{onClose:()=>y(!1),libraryItems:N8e(l.libraryItems,t),appState:o,onSuccess:x=>C(x,l.libraryItems),onError:x=>window.alert(x),updateItemsInStorage:()=>n.setLibrary(l.libraryItems),onRemove:x=>s(t.filter(D=>D!==x))}),w&&I()]})},P8e=({selectedItems:e,onSelectItems:t,className:n})=>{const{library:i}=bo(),{clearLibraryCache:r,deleteItemsFromLibraryCache:s}=XT(),o=ai(),a=xn(),[l]=un(eg),c=async u=>{const f=u.filter(h=>!e.includes(h.id));i.setLibrary(f).catch(()=>{a({errorMessage:M("alerts.errorRemovingFromLibrary")})}),s(e),t([])};return g(O8e,{appState:o,setAppState:a,selectedItems:e,onSelectItems:t,library:i,onRemoveFromLibrary:()=>c(l.libraryItems),resetLibrary:()=>{i.resetLibrary(),r()},className:n})};function F8e(){return[!1,R.useCallback(t=>t(),[])]}const B8e=de.useTransition||F8e,z8e=R.memo(({id:e,elements:t,isPending:n,onClick:i,selected:r,onToggle:s,onDrag:o,svgCache:a})=>{const l=R.useRef(null),c=JX(e,t,a,l),[d,u]=R.useState(!1),f=Nn().formFactor==="phone",h=n&&g("div",{className:"library-unit__adder",children:wue});return N("div",{className:le("library-unit",{"library-unit__active":t,"library-unit--hover":t&&d,"library-unit--selected":r,"library-unit--skeleton":!c}),onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:[g("div",{className:le("library-unit__dragger",{"library-unit__pulse":!!n}),ref:l,draggable:!!t,onClick:t||n?m=>{e&&m.shiftKey?s(e,m):i(e)}:void 0,onDragStart:m=>{if(!e){m.preventDefault();return}u(!1),o(e,m)}}),h,e&&t&&(d||f||r)&&g(CT,{checked:r,onChange:(m,p)=>s(e,p),className:"library-unit__checkbox"})]})}),H8e=()=>g("div",{className:"library-unit library-unit--skeleton"}),k3=({children:e})=>g("div",{className:"library-menu-items-container__grid",children:e}),a2=R.memo(({items:e,onItemSelectToggle:t,onItemDrag:n,isItemSelected:i,onClick:r,svgCache:s,itemsRenderedPerBatch:o})=>{const[,a]=B8e(),[l,c]=R.useState(0);return R.useEffect(()=>{l<e.length&&a(()=>{c(l+o)})},[l,e.length,a,o]),g(fe,{children:e.map((d,u)=>u<l?g(z8e,{elements:d==null?void 0:d.elements,isPending:!(d!=null&&d.id)&&!!(d!=null&&d.elements),onClick:r,svgCache:s,id:d==null?void 0:d.id,selected:i(d.id),onToggle:t,onDrag:n},(d==null?void 0:d.id)??u):g(H8e,{},u))})}),Kc=({type:e="button",onSelect:t,selected:n,children:i,className:r="",...s})=>g("button",{onClick:ry(s.onClick,o=>{t()}),type:e,className:le("excalidraw-button",r,{selected:n}),...s,children:i}),Au=R.forwardRef(({onChange:e,label:t,fullWidth:n,placeholder:i,readonly:r,selectOnRender:s,onKeyDown:o,isRedacted:a=!1,icon:l,className:c,type:d,...u},f)=>{const h=R.useRef(null);R.useImperativeHandle(f,()=>h.current),R.useLayoutEffect(()=>{var U,b;s&&((U=h.current)==null||U.focus(),(b=h.current)==null||b.select())},[s]);const[m,p]=R.useState(!1);return N("div",{className:le("ExcTextField",c,{"ExcTextField--fullWidth":n,"ExcTextField--hasIcon":!!l}),onClick:()=>{var U;(U=h.current)==null||U.focus()},children:[l,t&&g("div",{className:"ExcTextField__label",children:t}),N("div",{className:le("ExcTextField__input",{"ExcTextField__input--readonly":r}),children:[g("input",{className:le({"is-redacted":"value"in u&&u.value&&a&&!m}),readOnly:r,value:"value"in u?u.value:void 0,defaultValue:"defaultValue"in u?u.defaultValue:void 0,placeholder:i,ref:h,onChange:U=>e==null?void 0:e(U.target.value),onKeyDown:o,type:d}),a&&g(Kc,{onSelect:()=>p(!m),style:{border:0,userSelect:"none"},children:m?Bfe:eT})]})]})}),V8e=17,$8e=64;function G8e({isLoading:e,libraryItems:t,onAddToLibrary:n,onInsertLibraryItems:i,pendingElements:r,theme:s,id:o,libraryReturnUrl:a,onSelectItems:l,selectedItems:c}){const d=Nn(),u=R.useRef(null),f=v8e(u);R.useEffect(()=>{var z;f>0&&((z=u.current)==null||z.scrollTo(0,f))},[]);const{svgCache:h}=XT(),[m,p]=R.useState(null),[U,b]=R.useState(""),y=!t.length&&!r.length,w=!y&&!!U.trim(),v=R.useMemo(()=>{const z=P0(U.trim().toLowerCase());return z?t.filter(G=>{const j=G.name||"";return j.trim()&&P0(j.toLowerCase()).includes(z)}):[]},[t,U]),I=R.useMemo(()=>t.filter(z=>z.status!=="published"),[t]),C=R.useMemo(()=>t.filter(z=>z.status==="published"),[t]),_=R.useCallback((z,G)=>{const j=!c.includes(z),X=[...I,...C];if(j){if(G.shiftKey&&m){const K=X.findIndex(De=>De.id===m),ne=X.findIndex(De=>De.id===z);if(K===-1||ne===-1){l([...c,z]);return}const se=ve(c),oe=Math.min(K,ne),Ee=Math.max(K,ne),Re=X.reduce((De,vt,Vt)=>((Vt>=oe&&Vt<=Ee||se.has(vt.id))&&De.push(vt.id),De),[]);l(Re)}else l([...c,z]);p(z)}else p(null),l(c.filter(K=>K!==z))},[m,l,C,c,I]);R.useEffect(()=>{c.length||p(null)},[c]);const T=R.useCallback(z=>{let G;return c.includes(z)?G=t.filter(j=>c.includes(j.id)):G=t.filter(j=>j.id===z),G.map(j=>({...j,elements:S0({type:"everything",elements:j.elements,randomizeSeed:!0}).duplicatedElements}))},[t,c]),k=R.useCallback((z,G)=>{const j={itemIds:c.includes(z)?c:[z]};G.dataTransfer.setData(Te.excalidrawlibIds,JSON.stringify(j))},[c]),x=R.useCallback(z=>z?c.includes(z):!1,[c]),D=R.useCallback(()=>{n(r)},[r,n]),O=R.useCallback(z=>{z&&i(T(z))},[T,i]),L=h.size>=(v.length?v:t).length?$8e:V8e,Y=R.useRef(null);R.useEffect(()=>{Xse(()=>{var z;(z=Y.current)==null||z.focus()})},[]);const $=!w&&N(fe,{children:[!y&&g("div",{className:"library-menu-items-container__header",children:M("labels.personalLib")}),!r.length&&!I.length?N("div",{className:"library-menu-items__no-items",children:[!C.length&&g("div",{className:"library-menu-items__no-items__label",children:M("library.noItems")}),g("div",{className:"library-menu-items__no-items__hint",children:C.length>0?M("library.hint_emptyPrivateLibrary"):M("library.hint_emptyLibrary")})]}):N(k3,{children:[r.length>0&&g(a2,{itemsRenderedPerBatch:L,items:[{id:null,elements:r}],onItemSelectToggle:_,onItemDrag:k,onClick:D,isItemSelected:x,svgCache:h}),g(a2,{itemsRenderedPerBatch:L,items:I,onItemSelectToggle:_,onItemDrag:k,onClick:O,isItemSelected:x,svgCache:h})]}),C.length>0&&g("div",{className:"library-menu-items-container__header",style:{marginTop:"0.75rem"},children:M("labels.excalidrawLib")}),C.length>0&&g(k3,{children:g(a2,{itemsRenderedPerBatch:L,items:C,onItemSelectToggle:_,onItemDrag:k,onClick:O,isItemSelected:x,svgCache:h})})]}),H=w&&N(fe,{children:[N("div",{className:"library-menu-items-container__header",children:[M("library.search.heading"),!e&&N("div",{className:"library-menu-items-container__header__hint",style:{cursor:"pointer"},onPointerDown:z=>z.preventDefault(),onClick:z=>{b("")},children:[g("kbd",{children:"esc"})," to clear"]})]}),v.length>0?g(k3,{children:g(a2,{itemsRenderedPerBatch:L,items:v,onItemSelectToggle:_,onItemDrag:k,onClick:O,isItemSelected:x,svgCache:h})}):N("div",{className:"library-menu-items__no-items",children:[g("div",{className:"library-menu-items__no-items__hint",children:M("library.search.noResults")}),g(Kc,{onPointerDown:z=>z.preventDefault(),onSelect:()=>{b("")},style:{width:"auto",marginTop:"1rem"},children:M("library.search.clearSearch")})]})]});return N("div",{className:"library-menu-items-container",style:r.length||I.length||C.length?{justifyContent:"flex-start"}:{borderBottom:0},children:[N("div",{className:"library-menu-items-header",children:[!y&&g(Au,{ref:Y,type:"search",className:le("library-menu-items-container__search",{hideCancelButton:d.formFactor!=="phone"}),placeholder:M("library.search.inputPlaceholder"),value:U,onChange:z=>b(z)}),g(P8e,{selectedItems:c,onSelectItems:l,className:"library-menu-dropdown-container--in-heading"})]}),N(ja.Col,{className:"library-menu-items-container__items",align:"start",gap:1,style:{flex:C.length>0?1:"0 1 auto",margin:y?"auto":0},ref:u,children:[e&&g("div",{style:{position:"absolute",top:"var(--container-padding-y)",right:"var(--container-padding-x)",transform:"translateY(50%)"},children:g(hl,{})}),$,H,y&&g(nj,{style:{padding:"16px 0",width:"100%"},id:o,libraryReturnUrl:a,theme:s})]})]})}const YT=Wt(!1),iD=({children:e})=>g("div",{className:"layer-ui__library",children:e}),X8e=R.memo(({onInsertLibraryItems:e,pendingElements:t,onAddToLibrary:n,setAppState:i,libraryReturnUrl:r,library:s,id:o,theme:a,selectedItems:l,onSelectItems:c})=>{const[d]=un(eg),u=R.useCallback(m=>{(async(U,b)=>{et("element","addToLibrary","ui");for(const w of wB)if(U.some(v=>v.type===w))return i({errorMessage:M(`errors.libraryElementTypeError.${w}`)});const y=[{status:"unpublished",elements:U,id:gr(),created:Date.now()},...b];n(),s.setLibrary(y).catch(()=>{i({errorMessage:M("alerts.errorAddingToLibrary")})})})(m,d.libraryItems)},[n,s,i,d.libraryItems]),f=R.useMemo(()=>d.libraryItems,[d]);if(d.status==="loading"&&!d.isInitialized)return g(iD,{children:g("div",{className:"layer-ui__library-message",children:N("div",{children:[g(hl,{size:"2em"}),g("span",{children:M("labels.libraryLoadingMessage")})]})})});const h=d.libraryItems.length>0||t.length>0;return N(iD,{children:[g(G8e,{isLoading:d.status==="loading",libraryItems:f,onAddToLibrary:u,onInsertLibraryItems:e,pendingElements:t,id:o,libraryReturnUrl:r,theme:a,onSelectItems:c,selectedItems:l}),h&&g(nj,{className:"library-menu-control-buttons--at-bottom",style:{padding:"16px 12px 0 12px"},id:o,libraryReturnUrl:r,theme:a})]})}),R3=(e,t)=>({elements:e,pending:Xe(e,{selectedElementIds:t},{includeBoundTextElement:!0,includeElementsInFrames:!0}),selectedElementIds:t}),j8e=(e,t)=>{const n=sE(),[i,r]=R.useState(()=>R3(n,e.selectedElementIds)),s=R.useRef(new Map);return R.useEffect(()=>{for(const o of i.pending)s.current.set(o.id,o.version)},[i.pending]),R.useEffect(()=>{t.state.cursorButton==="up"&&t.state.activeTool.type==="selection"&&r(o=>{var l;if(!Ki(o.selectedElementIds,e.selectedElementIds))return s.current.clear(),R3(n,e.selectedElementIds);const a=t.scene.getNonDeletedElementsMap();for(const c of Object.keys(e.selectedElementIds)){const d=(l=a.get(c))==null?void 0:l.version;if(d&&d!==s.current.get(c))return R3(n,e.selectedElementIds)}return o})},[t,t.state.cursorButton,t.state.activeTool.type,e.selectedElementIds,n]),i.pending},Y8e=R.memo(()=>{const e=bo(),{onInsertElements:t}=e,n=$p(),i=ai(),r=xn(),[s,o]=R.useState([]),a=R.useMemo(()=>e.library,[e.library]),l=j8e(i,e);R.useEffect(()=>en(document,te.KEYDOWN,u=>{if(u.key===V.ESCAPE&&u.target instanceof HTMLElement){const f=u.target;if(f.closest(`.${Jr.SIDEBAR}`))s.length>0?(u.stopPropagation(),o([])):Na(f)&&f instanceof HTMLInputElement&&!f.value&&(u.stopPropagation(),r({openSidebar:null}),e.focusContainer());else if(s.length>0){const{x:h,y:m}=e.lastViewportPosition,p=document.elementFromPoint(h,m);p!=null&&p.closest(`.${Jr.SIDEBAR}`)&&(u.stopPropagation(),o([]))}}},{capture:!0}),[s,r,e]);const c=R.useCallback(u=>{t(jT(u)),e.focusContainer()},[t,e]),d=R.useCallback(()=>{r({selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null})},[r]);return g(X8e,{pendingElements:l,onInsertLibraryItems:c,onAddToLibrary:d,setAppState:r,libraryReturnUrl:n.libraryReturnUrl,library:a,id:e.id,theme:i.theme,selectedItems:s,onSelectItems:o})}),W8e=e=>{const{closeOnClickOutside:t=!0}=e,n=q$({className:"excalidraw-modal-container"}),i=R.useRef(document.body.classList.contains("excalidraw-animations-disabled"));if(!n)return null;const r=s=>{s.key===V.ESCAPE&&(s.nativeEvent.stopImmediatePropagation(),s.stopPropagation(),e.onCloseRequest())};return mi.createPortal(N("div",{className:le("Modal",e.className,{"animations-disabled":i.current}),role:"dialog","aria-modal":"true",onKeyDown:r,"aria-labelledby":e.labelledBy,"data-prevent-outside-click":!0,children:[g("div",{className:"Modal__background",onClick:t?e.onCloseRequest:void 0}),g("div",{className:"Modal__content",style:{"--max-width":`${e.maxWidth}px`},tabIndex:0,children:e.children})]}),n)};function K8e(e){if(e&&typeof e=="number")return e;switch(e){case"small":return 550;case"wide":return 1024;case"regular":default:return 800}}const as=e=>{const[t,n]=jX(),[i]=R.useState(document.activeElement),{id:r}=Dr(),s=Nn().formFactor==="phone";R.useEffect(()=>{if(!t)return;const c=x4(t);setTimeout(()=>{c.length>0&&e.autofocus!==!1&&(c[1]||c[0]).focus()});const d=u=>{if(u.key===V.TAB){const f=x4(t),{activeElement:h}=document,m=f.findIndex(p=>p===h);m===0&&u.shiftKey?(f[f.length-1].focus(),u.preventDefault()):m===f.length-1&&!u.shiftKey&&(f[0].focus(),u.preventDefault())}};return t.addEventListener("keydown",d),()=>t.removeEventListener("keydown",d)},[t,e.autofocus]);const o=xn(),a=py(YT),l=()=>{o({openMenu:null}),a(!1),i.focus(),e.onCloseRequest()};return g(W8e,{className:le("Dialog",e.className,{"Dialog--fullscreen":s}),labelledBy:"dialog-title",maxWidth:K8e(e.size),onCloseRequest:l,closeOnClickOutside:e.closeOnClickOutside,children:N(Is,{ref:n,children:[e.title&&g("h2",{id:`${r}-dialog-title`,className:"Dialog__title",children:g("span",{className:"Dialog__titleContent",children:e.title})}),s&&g("button",{className:"Dialog__close",onClick:l,title:M("buttons.close"),"aria-label":M("buttons.close"),type:"button",children:ju}),g("div",{className:"Dialog__content",children:e.children})]})})},Pv=[{icon:yy,value:"selection",key:V.V,numericKey:V[1],fillable:!0},{icon:G9,value:"rectangle",key:V.R,numericKey:V[2],fillable:!0},{icon:X9,value:"diamond",key:V.D,numericKey:V[3],fillable:!0},{icon:j9,value:"ellipse",key:V.O,numericKey:V[4],fillable:!0},{icon:LV,value:"arrow",key:V.A,numericKey:V[5],fillable:!0},{icon:Y9,value:"line",key:V.L,numericKey:V[6],fillable:!0},{icon:Lp,value:"freedraw",key:[V.P,V.X],numericKey:V[7],fillable:!1},{icon:Uh,value:"text",key:V.T,numericKey:V[8],fillable:!1},{icon:j2,value:"image",key:null,numericKey:V[9],fillable:!1},{icon:NV,value:"eraser",key:V.E,numericKey:V[0],fillable:!1}],aj=e=>e.state.preferredSelectionTool.type==="lasso"?[{value:"lasso",icon:yy,key:V.V,numericKey:V[1],fillable:!0},...Pv.slice(1)]:Pv,Z8e=(e,t)=>{const n=aj(t).find((i,r)=>i.numericKey!=null&&e===i.numericKey.toString()||i.key&&(typeof i.key=="string"?i.key===e:i.key.includes(e)));return(n==null?void 0:n.value)||null};var q8e={};const rD=e=>{let t;const n=new Set,i=(d,u)=>{const f=typeof d=="function"?d(t):d;if(!Object.is(f,t)){const h=t;t=u??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(m=>m(t,h))}},r=()=>t,l={setState:i,getState:r,getInitialState:()=>c,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{(q8e?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=t=e(i,r,l);return l},Q8e=e=>e?rD(e):rD;var lj={exports:{}},cj={},dj={exports:{}},uj={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ng=R;function J8e(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var e3e=typeof Object.is=="function"?Object.is:J8e,t3e=ng.useState,n3e=ng.useEffect,i3e=ng.useLayoutEffect,r3e=ng.useDebugValue;function s3e(e,t){var n=t(),i=t3e({inst:{value:n,getSnapshot:t}}),r=i[0].inst,s=i[1];return i3e(function(){r.value=n,r.getSnapshot=t,D3(r)&&s({inst:r})},[e,n,t]),n3e(function(){return D3(r)&&s({inst:r}),e(function(){D3(r)&&s({inst:r})})},[e]),r3e(n),n}function D3(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!e3e(e,n)}catch{return!0}}function o3e(e,t){return t()}var a3e=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?o3e:s3e;uj.useSyncExternalStore=ng.useSyncExternalStore!==void 0?ng.useSyncExternalStore:a3e;dj.exports=uj;var l3e=dj.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jy=R,c3e=l3e;function d3e(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var u3e=typeof Object.is=="function"?Object.is:d3e,f3e=c3e.useSyncExternalStore,h3e=Jy.useRef,g3e=Jy.useEffect,m3e=Jy.useMemo,p3e=Jy.useDebugValue;cj.useSyncExternalStoreWithSelector=function(e,t,n,i,r){var s=h3e(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=m3e(function(){function l(h){if(!c){if(c=!0,d=h,h=i(h),r!==void 0&&o.hasValue){var m=o.value;if(r(m,h))return u=m}return u=h}if(m=u,u3e(d,h))return m;var p=i(h);return r!==void 0&&r(m,p)?(d=h,m):(d=h,u=p)}var c=!1,d,u,f=n===void 0?null:n;return[function(){return l(t())},f===null?void 0:function(){return l(f())}]},[t,n,i,r]);var a=f3e(e,s[0],s[1]);return g3e(function(){o.hasValue=!0,o.value=a},[a]),p3e(a),a};lj.exports=cj;var U3e=lj.exports;const b3e=wl(U3e);var fj={};const{useDebugValue:y3e}=de,{useSyncExternalStoreWithSelector:E3e}=b3e;let sD=!1;const v3e=e=>e;function w3e(e,t=v3e,n){(fj?"production":void 0)!=="production"&&n&&!sD&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),sD=!0);const i=E3e(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return y3e(i),i}const oD=e=>{(fj?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?Q8e(e):e,n=(i,r)=>w3e(t,i,r);return Object.assign(n,t),n},_3e=e=>e?oD(e):oD;var aD,lD;const cD=typeof window<"u"&&((aD=window.document)!=null&&aD.createElement||((lD=window.navigator)==null?void 0:lD.product)==="ReactNative")?de.useLayoutEffect:de.useEffect;function _o(){const e=_3e(t=>({current:new Array,version:0,set:t}));return{In:({children:t})=>{const n=e(r=>r.set),i=e(r=>r.version);return cD(()=>{n(r=>({version:r.version+1}))},[]),cD(()=>(n(({current:r})=>({current:[...r,t]})),()=>n(({current:r})=>({current:r.filter(s=>s!==t)}))),[t,i]),null},Out:()=>{const t=e(n=>n.current);return de.createElement(de.Fragment,null,t)}}}const hj=de.createContext(null),er=()=>de.useContext(hj),T3e=BH(),I3e=()=>de.useMemo(()=>({MainMenuTunnel:_o(),WelcomeScreenMenuHintTunnel:_o(),WelcomeScreenToolbarHintTunnel:_o(),WelcomeScreenHelpHintTunnel:_o(),WelcomeScreenCenterTunnel:_o(),FooterCenterTunnel:_o(),DefaultSidebarTriggerTunnel:_o(),DefaultSidebarTabTriggersTunnel:_o(),OverwriteConfirmDialogTunnel:_o(),TTDDialogTriggerTunnel:_o(),tunnelsJotai:T3e}),[]),Fv=ue({name:"viewMode",label:"labels.viewMode",icon:eT,viewMode:!0,trackEvent:{category:"canvas",predicate:e=>!e.viewModeEnabled},perform(e,t){return{appState:{...t,viewModeEnabled:!this.checked(t)},captureUpdate:Z.EVENTUALLY}},checked:e=>e.viewModeEnabled,predicate:(e,t,n)=>typeof n.viewModeEnabled>"u",keyTest:e=>!e[V.CTRL_OR_CMD]&&e.altKey&&e.code===it.R}),ab=({app:e,options:t,activeTool:n,defaultOption:i,className:r="Shape",namePrefix:s,title:o,"data-testid":a,onToolChange:l,displayedOption:c,fillable:d=!1})=>{const[u,f]=R.useState(!1),h=n.type,m=c.type===h,p=32/2+10,{container:U}=Dr();return!t.some(b=>b.type===h)&&u&&f(!1),R.useEffect(()=>{const b=e.onPointerDownEmitter.on(()=>{f(!1)});return()=>b==null?void 0:b()},[e]),N(Sl,{open:u,children:[g(xl,{asChild:!0,children:g(je,{className:le(r,{fillable:d,active:t.some(b=>b.type===n.type)}),type:"radio",icon:c.icon,checked:m,name:"editor-current-shape",title:o,"aria-label":o,"data-testid":a,onPointerDown:()=>{f(b=>!b),l(i)}})}),g(xy,{className:"tool-popover-content",sideOffset:p,collisionBoundary:U??void 0,children:t.map(({type:b,icon:y,title:w})=>g(je,{className:le(r,{active:h===b}),type:"radio",icon:y,checked:h===b,name:`${s}-option`,title:w||kt(b),keyBindingLabel:"","aria-label":w||kt(b),"data-testid":`toolbar-${b}`,onChange:()=>{e.state.activeTool.type!==b&&et("toolbar",b,"ui"),e.setActiveTool({type:b}),l==null||l(b)}},b))})]})},WT=le([Jr.SHAPE_ACTIONS_THEME_SCOPE,"properties-content"]),eE=(e,t)=>{var i;let n=((i=t[0])==null?void 0:i.type)||null;for(const r of t)if(r.type!==n){n=null;break}return F4(e.activeTool.type)&&n!=="image"&&n!=="frame"&&n!=="magicframe"||t.some(r=>F4(r.type))},tE=(e,t)=>$c(e.activeTool.type)||t.some(n=>$c(n.type)),S3e=({appState:e,elementsMap:t,renderAction:n,app:i})=>{var m;const r=dy(t,e);let s=!1;r.length===2&&(Li(r[0])||Li(r[1]))&&(s=!0);const o=!!(e.editingTextElement||e.newElement),a=Nn(),l=document.documentElement.getAttribute("dir")==="rtl",c=$c(e.activeTool.type)&&!Ir(e.currentItemBackgroundColor)||r.some(p=>$c(p.type)&&!Ir(p.backgroundColor)),d=r.length===1||s,u=!((m=e.selectedLinearElement)!=null&&m.isEditing)&&r.length===1&&xe(r[0])&&!me(r[0]),f=!e.croppingElementId&&r.length===1&&yt(r[0]),h=!s&&Mr(e,i);return N("div",{className:"selected-shape-actions",children:[g("div",{children:eE(e,r)&&n("changeStrokeColor")}),tE(e,r)&&g("div",{children:n("changeBackgroundColor")}),c&&n("changeFillStyle"),(_6(e.activeTool.type)||r.some(p=>_6(p.type)))&&n("changeStrokeWidth"),(e.activeTool.type==="freedraw"||r.some(p=>p.type==="freedraw"))&&n("changeStrokeShape"),(T6(e.activeTool.type)||r.some(p=>T6(p.type)))&&N(fe,{children:[n("changeStrokeStyle"),n("changeSloppiness")]}),(Um(e.activeTool.type)||r.some(p=>Um(p.type)))&&g(fe,{children:n("changeRoundness")}),(I6(e.activeTool.type)||r.some(p=>I6(p.type)))&&g(fe,{children:n("changeArrowType")}),(e.activeTool.type==="text"||r.some(ge))&&N(fe,{children:[n("changeFontFamily"),n("changeFontSize"),(e.activeTool.type==="text"||Uz(r,t))&&n("changeTextAlign")]}),pz(r,t)&&n("changeVerticalAlign"),(S6(e.activeTool.type)||r.some(p=>S6(p.type)))&&g(fe,{children:n("changeArrowhead")}),n("changeOpacity"),N("fieldset",{children:[g("legend",{children:M("labels.layers")}),N("div",{className:"buttonList",children:[n("sendToBack"),n("sendBackward"),n("bringForward"),n("bringToFront")]})]}),h&&!s&&N("fieldset",{children:[g("legend",{children:M("labels.align")}),N("div",{className:"buttonList",children:[l?N(fe,{children:[n("alignRight"),n("alignHorizontallyCentered"),n("alignLeft")]}):N(fe,{children:[n("alignLeft"),n("alignHorizontallyCentered"),n("alignRight")]}),r.length>2&&n("distributeHorizontally"),g("div",{style:{flexBasis:"100%",height:0}}),N("div",{style:{display:"flex",flexWrap:"wrap",gap:".5rem",marginTop:"-0.5rem"},children:[n("alignTop"),n("alignVerticallyCentered"),n("alignBottom"),r.length>2&&n("distributeVertically")]})]})]}),!o&&r.length>0&&N("fieldset",{children:[g("legend",{children:M("labels.actions")}),N("div",{className:"buttonList",children:[a.formFactor!=="phone"&&n("duplicateSelection"),a.formFactor!=="phone"&&n("deleteSelectedElements"),n("group"),n("ungroup"),d&&n("hyperlink"),f&&n("cropEditor"),u&&n("toggleLinearEditor")]})]})]})},gj=({appState:e,renderAction:t,setAppState:n,targetElements:i,container:r})=>{const s=$c(e.activeTool.type)&&!Ir(e.currentItemBackgroundColor)||i.some(l=>$c(l.type)&&!Ir(l.backgroundColor)),o=i.length>0||e.activeTool.type!=="selection"&&e.activeTool.type!=="eraser"&&e.activeTool.type!=="hand"&&e.activeTool.type!=="laser"&&e.activeTool.type!=="lasso",a=e.openPopup==="compactStrokeStyles";return o?g("div",{className:"compact-action-item",children:N(Sl,{open:a,onOpenChange:l=>{n(l?{openPopup:"compactStrokeStyles"}:{openPopup:null})},children:[g(xl,{asChild:!0,children:g("button",{type:"button",className:le("compact-action-button properties-trigger",{active:a}),title:M("labels.stroke"),onClick:l=>{l.preventDefault(),l.stopPropagation(),n({openPopup:a?null:"compactStrokeStyles"})},children:rhe})}),a&&g(Ag,{className:WT,container:r,style:{maxWidth:"13rem"},onClose:()=>{},children:N("div",{className:"selected-shape-actions",children:[s&&t("changeFillStyle"),(_6(e.activeTool.type)||i.some(l=>_6(l.type)))&&t("changeStrokeWidth"),(T6(e.activeTool.type)||i.some(l=>T6(l.type)))&&N(fe,{children:[t("changeStrokeStyle"),t("changeSloppiness")]}),(Um(e.activeTool.type)||i.some(l=>Um(l.type)))&&t("changeRoundness"),t("changeOpacity")]})})]})}):null},mj=({appState:e,renderAction:t,setAppState:n,targetElements:i,container:r,app:s})=>{const o=I6(e.activeTool.type)||i.some(l=>I6(l.type)),a=e.openPopup==="compactArrowProperties";return o?g("div",{className:"compact-action-item",children:N(Sl,{open:a,onOpenChange:l=>{n(l?{openPopup:"compactArrowProperties"}:{openPopup:null})},children:[g(xl,{asChild:!0,children:g("button",{type:"button",className:le("compact-action-button properties-trigger",{active:a}),title:M("labels.arrowtypes"),onClick:l=>{l.preventDefault(),l.stopPropagation(),n({openPopup:a?null:"compactArrowProperties"})},children:(()=>{const l=pr(i,s,c=>Ce(c)?c.elbowed?"elbow":c.roundness?"round":"sharp":null,c=>Ce(c),c=>c?null:e.currentItemArrowType);return l==="elbow"?iT:l==="round"?rT:nT})()})}),a&&g(Ag,{container:r,className:"properties-content",style:{maxWidth:"13rem"},onClose:()=>{},children:t("changeArrowProperties")})]})}):null},pj=({appState:e,renderAction:t,setAppState:n,targetElements:i,container:r,elementsMap:s})=>{const{saveCaretPosition:o,restoreCaretPosition:a}=t0e(),l=e.openPopup==="compactTextProperties";return g("div",{className:"compact-action-item",children:N(Sl,{open:l,onOpenChange:c=>{c?(e.editingTextElement&&o(),n({openPopup:"compactTextProperties"})):(n({openPopup:null}),e.editingTextElement&&a())},children:[g(xl,{asChild:!0,children:g("button",{type:"button",className:le("compact-action-button properties-trigger",{active:l}),title:M("labels.textAlign"),onClick:c=>{c.preventDefault(),c.stopPropagation(),l?n({openPopup:null}):(e.editingTextElement&&o(),n({openPopup:"compactTextProperties"}))},children:kue})}),e.openPopup==="compactTextProperties"&&g(Ag,{className:WT,container:r,style:{maxWidth:"13rem"},preventAutoFocusOnTouch:!!e.editingTextElement,onClose:()=>{e.editingTextElement&&a()},children:N("div",{className:"selected-shape-actions",children:[(e.activeTool.type==="text"||i.some(ge))&&t("changeFontSize"),(e.activeTool.type==="text"||Uz(i,s))&&t("changeTextAlign"),pz(i,s)&&t("changeVerticalAlign")]})})]})})},Uj=({appState:e,renderAction:t,targetElements:n,setAppState:i,container:r,app:s,showDuplicate:o,showDelete:a})=>{const l=!!(e.editingTextElement||e.newElement),c=!e.croppingElementId&&n.length===1&&yt(n[0]),d=n.length===1,u=Mr(e,s);let f=!1;n.length===2&&(Li(n[0])||Li(n[1]))&&(f=!0);const h=document.documentElement.getAttribute("dir")==="rtl",m=e.openPopup==="compactOtherProperties";return l||n.length===0?null:g("div",{className:"compact-action-item",children:N(Sl,{open:m,onOpenChange:p=>{i(p?{openPopup:"compactOtherProperties"}:{openPopup:null})},children:[g(xl,{asChild:!0,children:g("button",{type:"button",className:le("compact-action-button properties-trigger",{active:m}),title:M("labels.actions"),onClick:p=>{p.preventDefault(),p.stopPropagation(),i({openPopup:m?null:"compactOtherProperties"})},children:Tue})}),m&&g(Ag,{className:WT,container:r,style:{maxWidth:"12rem",justifyContent:"center",alignItems:"center"},onClose:()=>{},children:N("div",{className:"selected-shape-actions",children:[N("fieldset",{children:[g("legend",{children:M("labels.layers")}),N("div",{className:"buttonList",children:[t("sendToBack"),t("sendBackward"),t("bringForward"),t("bringToFront")]})]}),u&&!f&&N("fieldset",{children:[g("legend",{children:M("labels.align")}),N("div",{className:"buttonList",children:[h?N(fe,{children:[t("alignRight"),t("alignHorizontallyCentered"),t("alignLeft")]}):N(fe,{children:[t("alignLeft"),t("alignHorizontallyCentered"),t("alignRight")]}),n.length>2&&t("distributeHorizontally"),g("div",{style:{flexBasis:"100%",height:0}}),N("div",{style:{display:"flex",flexWrap:"wrap",gap:".5rem",marginTop:"-0.5rem"},children:[t("alignTop"),t("alignVerticallyCentered"),t("alignBottom"),n.length>2&&t("distributeVertically")]})]})]}),N("fieldset",{children:[g("legend",{children:M("labels.actions")}),N("div",{className:"buttonList",children:[t("group"),t("ungroup"),d&&t("hyperlink"),c&&t("cropEditor"),o&&t("duplicateSelection"),a&&t("deleteSelectedElements")]})]})]})})]})})},x3e=({appState:e,renderAction:t,targetElements:n})=>{var r;return!((r=e.selectedLinearElement)!=null&&r.isEditing)&&n.length===1&&xe(n[0])&&!me(n[0])?g("div",{className:"compact-action-item",children:t("toggleLinearEditor")}):null},C3e=({appState:e,elementsMap:t,renderAction:n,app:i,setAppState:r})=>{var c;const s=dy(t,e),{container:o}=Dr(),a=!!(e.editingTextElement||e.newElement),l=!((c=e.selectedLinearElement)!=null&&c.isEditing)&&s.length===1&&xe(s[0])&&!me(s[0]);return N("div",{className:"compact-shape-actions",children:[eE(e,s)&&g("div",{className:le("compact-action-item"),children:n("changeStrokeColor")}),tE(e,s)&&g("div",{className:"compact-action-item",children:n("changeBackgroundColor")}),g(gj,{appState:e,renderAction:n,setAppState:r,targetElements:s,container:o}),g(mj,{appState:e,renderAction:n,setAppState:r,targetElements:s,container:o,app:i}),l&&g("div",{className:"compact-action-item",children:n("toggleLinearEditor")}),(e.activeTool.type==="text"||s.some(ge))&&N(fe,{children:[g("div",{className:"compact-action-item",children:n("changeFontFamily")}),g(pj,{appState:e,renderAction:n,setAppState:r,targetElements:s,container:o,elementsMap:t})]}),!a&&s.length>0&&g("div",{className:"compact-action-item",children:n("duplicateSelection")}),!a&&s.length>0&&g("div",{className:"compact-action-item",children:n("deleteSelectedElements")}),g(Uj,{appState:e,renderAction:n,targetElements:s,setAppState:r,container:o,app:i})]})},A3e=({appState:e,elementsMap:t,renderAction:n,app:i,setAppState:r})=>{var U,b;const s=dy(t,e),{container:o}=Dr(),a=R.useRef(null),l=((b=(U=a.current)==null?void 0:U.getBoundingClientRect())==null?void 0:b.width)??0,c=9,d=6,u=32,f=c*u+(c-1)*d,h=u+d,m=l>=f+h,p=l>=f+2*h;return N(Is,{className:"compact-shape-actions mobile-shape-actions",style:{flexDirection:"row",boxShadow:"none",padding:0,zIndex:2,backgroundColor:"transparent",height:u*1.35,marginBottom:4,alignItems:"center",gap:d,pointerEvents:"none"},ref:a,children:[N("div",{style:{display:"flex",flexDirection:"row",gap:d,flex:1},children:[eE(e,s)&&g("div",{className:le("compact-action-item"),children:n("changeStrokeColor")}),tE(e,s)&&g("div",{className:"compact-action-item",children:n("changeBackgroundColor")}),g(gj,{appState:e,renderAction:n,setAppState:r,targetElements:s,container:o}),g(mj,{appState:e,renderAction:n,setAppState:r,targetElements:s,container:o,app:i}),g(x3e,{appState:e,renderAction:n,targetElements:s}),(e.activeTool.type==="text"||s.some(ge))&&N(fe,{children:[g("div",{className:"compact-action-item",children:n("changeFontFamily")}),g(pj,{appState:e,renderAction:n,setAppState:r,targetElements:s,container:o,elementsMap:t})]}),g(Uj,{appState:e,renderAction:n,targetElements:s,setAppState:r,container:o,app:i,showDuplicate:!p,showDelete:!m})]}),N("div",{style:{display:"flex",flexDirection:"row",gap:d},children:[g("div",{className:"compact-action-item",children:n("undo")}),g("div",{className:"compact-action-item",children:n("redo")}),p&&g("div",{className:"compact-action-item",children:n("duplicateSelection")}),m&&g("div",{className:"compact-action-item",children:n("deleteSelectedElements")})]})]})},M3e=({activeTool:e,setAppState:t,app:n,UIOptions:i})=>{const[r,s]=R.useState(!1),o=fa(),a=o==="full",l=o==="compact",c=[{type:"selection",icon:yy,title:kt(M("toolBar.selection"))},{type:"lasso",icon:M0,title:kt(M("toolBar.lasso"))}],d=e.type==="frame",u=e.type==="laser",f=a&&e.type==="lasso"&&n.state.preferredSelectionTool.type!=="lasso",h=e.type==="embeddable",{TTDDialogTriggerTunnel:m}=er();return N(fe,{children:[aj(n).map(({value:p,icon:U,key:b,numericKey:y,fillable:w},v)=>{var T;if(((T=i.tools)==null?void 0:T[p])===!1)return null;const I=M(`toolBar.${p}`),C=b&&kt(typeof b=="string"?b:b[0]),_=C?`${C} ${M("helpDialog.or")} ${y}`:`${y}`;return(p==="selection"||p==="lasso")&&l?g(ab,{app:n,options:c,activeTool:e,defaultOption:n.state.preferredSelectionTool.type,namePrefix:"selectionType",title:kt(M("toolBar.selection")),"data-testid":"toolbar-selection",onToolChange:k=>{(k==="selection"||k==="lasso")&&(n.setActiveTool({type:k}),t({preferredSelectionTool:{type:k,initialized:!0}}))},displayedOption:c.find(k=>k.type===n.state.preferredSelectionTool.type)||c[0],fillable:e.type==="selection"},"selection-popover"):g(je,{className:le("Shape",{fillable:w}),type:"radio",icon:U,checked:e.type===p,name:"editor-current-shape",title:`${kt(I)}  ${_}`,keyBindingLabel:y||C,"aria-label":kt(I),"aria-keyshortcuts":_,"data-testid":`toolbar-${p}`,onPointerDown:({pointerType:k})=>{!n.state.penDetected&&k==="pen"&&n.togglePenMode(!0),p==="selection"&&(n.state.activeTool.type==="selection"?n.setActiveTool({type:"lasso"}):n.setActiveTool({type:"selection"}))},onChange:({pointerType:k})=>{n.state.activeTool.type!==p&&et("toolbar",p,"ui"),p==="image"?n.setActiveTool({type:p}):n.setActiveTool({type:p})}},p)}),g("div",{className:"App-toolbar__divider"}),N(Ve,{open:r,children:[g(Ve.Trigger,{className:le("App-toolbar__extra-tools-trigger",{"App-toolbar__extra-tools-trigger--selected":d||h||f||u&&!n.props.isCollaborating}),onToggle:()=>{s(!r),t({openMenu:null,openPopup:null})},title:M("toolBar.extraTools"),children:d?nu:h?L6:u&&!n.props.isCollaborating?_m:f?M0:cv}),N(Ve.Content,{onClickOutside:()=>s(!1),onSelect:()=>s(!1),className:"App-toolbar__extra-tools-dropdown",children:[g(Ve.Item,{onSelect:()=>n.setActiveTool({type:"frame"}),icon:nu,shortcut:V.F.toLocaleUpperCase(),"data-testid":"toolbar-frame",selected:d,children:M("toolBar.frame")}),g(Ve.Item,{onSelect:()=>n.setActiveTool({type:"embeddable"}),icon:L6,"data-testid":"toolbar-embeddable",selected:h,children:M("toolBar.embeddable")}),g(Ve.Item,{onSelect:()=>n.setActiveTool({type:"laser"}),icon:_m,"data-testid":"toolbar-laser",selected:u,shortcut:V.K.toLocaleUpperCase(),children:M("toolBar.laser")}),a&&g(Ve.Item,{onSelect:()=>n.setActiveTool({type:"lasso"}),icon:M0,"data-testid":"toolbar-lasso",selected:f,children:M("toolBar.lasso")}),g("div",{style:{margin:"6px 0",fontSize:14,fontWeight:600},children:"Generate"}),n.props.aiEnabled!==!1&&g(m.Out,{}),g(Ve.Item,{onSelect:()=>n.setOpenDialog({name:"ttd",tab:"mermaid"}),icon:J9,"data-testid":"toolbar-embeddable",children:M("toolBar.mermaidToExcalidraw")}),n.props.aiEnabled!==!1&&n.plugins.diagramToCode&&N(Ve.Item,{onSelect:()=>n.onMagicframeToolSelect(),icon:O6,"data-testid":"toolbar-magicframe",children:[M("toolBar.magicframe"),g(Ve.Item.Badge,{children:"AI"})]})]})]})]})},k3e=({renderAction:e,zoom:t})=>g(ja.Col,{gap:1,className:Jr.ZOOM_ACTIONS,children:N(ja.Row,{align:"center",children:[e("zoomOut"),e("resetZoom"),e("zoomIn")]})}),R3e=({renderAction:e,className:t})=>N("div",{className:`undo-redo-buttons ${t}`,children:[g("div",{className:"undo-button-container",children:g(Ul,{label:M("buttons.undo"),children:e("undo")})}),g("div",{className:"redo-button-container",children:N(Ul,{label:M("buttons.redo"),children:[" ",e("redo")]})})]}),D3e=({actionManager:e,showExitZenModeBtn:t})=>g("button",{type:"button",className:le("disable-zen-mode",{"disable-zen-mode--visible":t}),onClick:()=>e.executeAction(Cv),children:M("buttons.exitZenMode")}),L3e=({actionManager:e})=>g("button",{type:"button",className:"disable-view-mode",onClick:()=>e.executeAction(Fv),children:ohe}),dD=e=>{const t=R.useRef({userFn:e});return t.current.userFn=e,t.current.stableFn||(t.current.stableFn=(...n)=>t.current.userFn(...n)),t.current.stableFn},nE=Wt(null),N3e=()=>{const[e,t]=un(nE),n=Lr();return e&&e==="clearCanvas"?g(ij,{onConfirm:()=>{n.executeAction(R0),t(null)},onCancel:()=>t(null),title:M("clearCanvasDialog.title"),children:N("p",{className:"clear-canvas__content",children:[" ",M("alerts.clearReset")]})}):null},O3e={...$6,category:"App",label:"Toggle theme",perform:({actionManager:e})=>{e.executeAction($6,"commandPalette")}},P3e=Object.freeze(Object.defineProperty({__proto__:null,toggleTheme:O3e},Symbol.toStringTag,{value:"Module"})),F3e=Wt(null),ot={app:"App",export:"Export",tools:"Tools",editor:"Editor",elements:"Elements",links:"Links"},uD=e=>{switch(e){case ot.app:return 1;case ot.export:return 2;case ot.editor:return 3;case ot.tools:return 4;case ot.elements:return 5;case ot.links:return 6;default:return 10}},lb=({shortcut:e,className:t,children:n})=>{const i=e.replace("++","+$").split("+");return N("div",{className:le("shortcut",t),children:[i.map((r,s)=>g("div",{className:"shortcut-wrapper",children:g("div",{className:"shortcut-key",children:r==="$"?"+":r})},r)),g("div",{className:"shortcut-desc",children:n})]})},bj=e=>!e.altKey&&e[V.CTRL_OR_CMD]&&(e.shiftKey&&e.key.toLowerCase()===V.P||e.key===V.SLASH),fD=Object.assign(e=>{var i;const t=ai(),n=xn();return R.useEffect(()=>{const r=s=>{bj(s)&&(s.preventDefault(),s.stopPropagation(),n(o=>{var l;const a=((l=o.openDialog)==null?void 0:l.name)==="commandPalette"?null:{name:"commandPalette"};return a&&et("command_palette","open","shortcut"),{openDialog:a}}))};return window.addEventListener(te.KEYDOWN,r,{capture:!0}),()=>window.removeEventListener(te.KEYDOWN,r,{capture:!0})},[n]),((i=t.openDialog)==null?void 0:i.name)!=="commandPalette"?null:g(B3e,{...e})},{defaultItems:P3e});function B3e({customCommandPaletteItems:e}){const t=bo(),n=ai(),i=xn(),r=$p(),s=Lr(),[o,a]=un(F3e),[l,c]=R.useState(null),d=R.useRef(null),u=Cy({uiAppState:n,customCommandPaletteItems:e,appProps:r}),[f]=un(eg),h=R.useMemo(()=>{var T;return((T=f.libraryItems)==null?void 0:T.filter(k=>!!k.name).map(k=>({label:k.name,icon:g(z3e,{id:k.id,elements:k.elements}),category:"Library",order:uD("Library"),haystack:P0(k.name),perform:()=>{t.onInsertElements(jT([k]))}})))||[]},[t,f.libraryItems]);R.useEffect(()=>{const{uiAppState:T,customCommandPaletteItems:k,appProps:x}=u,D=$=>{let H="";return $.label&&(typeof $.label=="function"?H=M($.label(t.scene.getNonDeletedElements(),T,t)):H=M($.label)),H},O=$=>typeof $.icon=="function"?$.icon(T,t.scene.getNonDeletedElements()):$.icon;let L=[];const Y=($,H,z)=>{const G={label:D($),icon:O($),category:H,shortcut:Zi($.name),keywords:$.keywords,predicate:$.predicate,viewMode:$.viewMode,perform:()=>{s.executeAction($,"commandPalette")}};return z?z(G,$):G};if(T&&t.scene&&s){const $=[s.actions.group,s.actions.ungroup,s.actions.cut,s.actions.copy,s.actions.deleteSelectedElements,s.actions.wrapSelectionInFrame,s.actions.copyStyles,s.actions.pasteStyles,s.actions.bringToFront,s.actions.bringForward,s.actions.sendBackward,s.actions.sendToBack,s.actions.alignTop,s.actions.alignBottom,s.actions.alignLeft,s.actions.alignRight,s.actions.alignVerticallyCentered,s.actions.alignHorizontallyCentered,s.actions.duplicateSelection,s.actions.flipHorizontal,s.actions.flipVertical,s.actions.zoomToFitSelection,s.actions.zoomToFitSelectionInViewport,s.actions.increaseFontSize,s.actions.decreaseFontSize,s.actions.toggleLinearEditor,s.actions.cropEditor,s.actions.togglePolygon,BX,XX,FEe].map(K=>Y(K,ot.elements,(ne,se)=>({...ne,predicate:se.predicate?se.predicate:(oe,Ee,Re,De)=>Xe(oe,Ee).length>0}))),H=[s.actions.toggleHandTool,s.actions.setFrameAsActiveTool,s.actions.toggleLassoTool].map(K=>Y(K,ot.tools)),z=[s.actions.undo,s.actions.redo,s.actions.zoomIn,s.actions.zoomOut,s.actions.resetZoom,s.actions.zoomToFit,s.actions.zenMode,s.actions.viewMode,s.actions.gridMode,s.actions.objectsSnapMode,s.actions.toggleShortcuts,s.actions.selectAll,s.actions.toggleElementLock,s.actions.unlockAllElements,s.actions.stats].map(K=>Y(K,ot.editor)),G=[s.actions.saveToActiveFile,s.actions.saveFileToDisk,s.actions.copyAsPng,s.actions.copyAsSvg].map(K=>Y(K,ot.export));L=[...$,...z,{label:D(R0),icon:O(R0),shortcut:Zi(R0.name),category:ot.editor,keywords:["delete","destroy"],viewMode:!1,perform:()=>{Gr.set(nE,"clearCanvas")}},{label:M("buttons.exportImage"),category:ot.export,icon:FV,shortcut:Zi("imageExport"),keywords:["export","image","png","jpeg","svg","clipboard","picture"],perform:()=>{i({openDialog:{name:"imageExport"}})}},...G];const j=[{label:M("toolBar.library"),category:ot.app,icon:DV,viewMode:!1,perform:()=>{T.openSidebar?i({openSidebar:null}):i({openSidebar:{name:As.name,tab:As.defaultTab}})}},{label:M("search.title"),category:ot.app,icon:Eu,viewMode:!0,perform:()=>{s.executeAction(yj)}},{label:M("labels.shapeSwitch"),category:ot.elements,icon:dv,perform:()=>{s.executeAction(PEe)}},{label:M("labels.changeStroke"),keywords:["color","outline"],category:ot.elements,icon:q8,viewMode:!1,predicate:(K,ne)=>{const se=Xe(K,ne);return se.length>0&&eE(ne,se)},perform:()=>{i(K=>({openPopup:"elementStroke"}))}},{label:M("labels.changeBackground"),keywords:["color","fill"],icon:q8,category:ot.elements,viewMode:!1,predicate:(K,ne)=>{const se=Xe(K,ne);return se.length>0&&tE(ne,se)},perform:()=>{i(K=>({openPopup:"elementBackground"}))}},{label:M("labels.canvasBackground"),keywords:["color"],icon:q8,category:ot.editor,viewMode:!1,perform:()=>{i(K=>({openMenu:K.openMenu==="canvas"?null:"canvas",openPopup:"canvasBackground"}))}},...Pv.reduce((K,ne)=>{var Be;const{value:se,icon:oe,key:Ee,numericKey:Re}=ne;if(((Be=x.UIOptions.tools)==null?void 0:Be[se])===!1)return K;const vt=Ee&&kt(typeof Ee=="string"?Ee:Ee[0])||Re,Vt={label:M(`toolBar.${se}`),category:ot.tools,shortcut:vt,icon:oe,keywords:["toolbar"],viewMode:!1,perform:({event:Qe})=>{se==="image"?t.setActiveTool({type:se}):t.setActiveTool({type:se})}};return K.push(Vt),K},[]),...H,{label:M("toolBar.lock"),category:ot.tools,icon:T.activeTool.locked?$9:by,shortcut:V.Q.toLocaleUpperCase(),viewMode:!1,perform:()=>{t.toggleLock()}},{label:`${M("labels.textToDiagram")}...`,category:ot.tools,icon:Hfe,viewMode:!1,predicate:x.aiEnabled,perform:()=>{i(K=>({...K,openDialog:{name:"ttd",tab:"text-to-diagram"}}))}},{label:`${M("toolBar.mermaidToExcalidraw")}...`,category:ot.tools,icon:J9,viewMode:!1,predicate:x.aiEnabled,perform:()=>{i(K=>({...K,openDialog:{name:"ttd",tab:"mermaid"}}))}}],X=[...L,...j,...k||[]].map(K=>{var ne;return{...K,icon:K.icon||dv,order:K.order??uD(K.category),haystack:`${P0(K.label.toLocaleLowerCase())} ${((ne=K.keywords)==null?void 0:ne.join(" "))||""}`}});c(X),a([...X,...h].find(K=>K.label===(o==null?void 0:o.label))??null)}},[u,t,s,c,o==null?void 0:o.label,a,i,h]);const[m,p]=R.useState(""),[U,b]=R.useState(null),[y,w]=R.useState({}),v=T=>{i({openDialog:null},T),p("")},I=(T,k)=>{var x;((x=n.openDialog)==null?void 0:x.name)==="commandPalette"&&(k.stopPropagation(),k.preventDefault(),document.body.classList.add("excalidraw-animations-disabled"),v(()=>{T.perform({actionManager:s,event:k}),a(T),requestAnimationFrame(()=>{document.body.classList.remove("excalidraw-animations-disabled")})}))},C=dD(T=>T.viewMode===!1&&n.viewModeEnabled?!1:typeof T.predicate=="function"?T.predicate(t.scene.getNonDeletedElements(),n,r,t):T.predicate===void 0||T.predicate),_=dD(T=>{var O;const k=Na(T.target)||bj(T)||T.key===V.ESCAPE;if(k&&T.key!==V.ARROW_UP&&T.key!==V.ARROW_DOWN&&T.key!==V.ENTER)return;const x=Object.values(y).flat(),D=o&&!m&&C(o);if(T.key===V.ARROW_UP){T.preventDefault();const L=x.findIndex(H=>H.label===(U==null?void 0:U.label));if(D){if(L===0){b(o);return}if(U===o){const H=x[x.length-1];H&&b(H);return}}let Y;L===-1?Y=x.length-1:Y=L===0?x.length-1:(L-1)%x.length;const $=x[Y];$&&b($);return}if(T.key===V.ARROW_DOWN){T.preventDefault();const L=x.findIndex(H=>H.label===(U==null?void 0:U.label));if(D){if(!U||L===x.length-1){b(o);return}if(U===o){const H=x[0];H&&b(H);return}}const Y=(L+1)%x.length,$=x[Y];$&&b($);return}if(T.key===V.ENTER&&U&&setTimeout(()=>{I(U,T)}),!k){if(T.stopPropagation(),/^[a-zA-Z0-9]$/.test(T.key)){(O=d==null?void 0:d.current)==null||O.focus();return}T.preventDefault()}});return R.useEffect(()=>(window.addEventListener(te.KEYDOWN,_,{capture:!0}),()=>window.removeEventListener(te.KEYDOWN,_,{capture:!0})),[_]),R.useEffect(()=>{if(!l)return;const T=O=>{const L={};for(const Y of O)L[Y.category]?L[Y.category].push(Y):L[Y.category]=[Y];return L};let k=(m==null?void 0:m.length)>1?[...l.filter(C).sort((O,L)=>O.order-L.order),...h]:l.filter(C).sort((O,L)=>O.order-L.order);const x=!m&&o&&C(o);if(!m){w(T(x?k.filter(O=>O.label!==(o==null?void 0:o.label)):k)),b(x?o:k[0]||null);return}const D=P0(m.toLocaleLowerCase().replace(/[<>_| -]/g,""));k=IEe.filter(D,k,{extract:O=>O.haystack??""}).sort((O,L)=>L.score-O.score).map(O=>O.original),w(T(k)),b(k[0]??null)},[m,l,C,o,h]),N(as,{onCloseRequest:()=>v(),closeOnClickOutside:!0,title:!1,size:720,autofocus:!0,className:"command-palette-dialog",children:[g(Au,{value:m,placeholder:M("commandPalette.search.placeholder"),onChange:T=>{p(T)},selectOnRender:!0,ref:d}),t.editorInterface.formFactor!=="phone"&&N("div",{className:"shortcuts-wrapper",children:[g(lb,{shortcut:"",children:M("commandPalette.shortcuts.select")}),g(lb,{shortcut:"",children:M("commandPalette.shortcuts.confirm")}),g(lb,{shortcut:J("Esc"),children:M("commandPalette.shortcuts.close")})]}),N("div",{className:"commands",children:[o&&!m&&N("div",{className:"command-category",children:[N("div",{className:"command-category-title",children:[M("commandPalette.recents"),g("div",{className:"icon",style:{marginLeft:"6px"},children:Vfe})]}),g(hD,{command:o,isSelected:o.label===(U==null?void 0:U.label),onClick:T=>I(o,T),disabled:!C(o),onMouseMove:()=>b(o),showShortcut:t.editorInterface.formFactor!=="phone",appState:n})]}),Object.keys(y).length>0?Object.keys(y).map((T,k)=>N("div",{className:"command-category",children:[g("div",{className:"command-category-title",children:T}),y[T].map(x=>g(hD,{command:x,isSelected:x.label===(U==null?void 0:U.label),onClick:D=>I(x,D),onMouseMove:()=>b(x),showShortcut:t.editorInterface.formFactor!=="phone",appState:n,size:T==="Library"?"large":"small"},x.label))]},T)):l?N("div",{className:"no-match",children:[g("div",{className:"icon",children:Eu})," ",M("commandPalette.search.noMatch")]}):null]})]})}const z3e=({id:e,elements:t})=>{const n=R.useRef(null),{svgCache:i}=XT();return JX(e,t,i,n),g("div",{className:"library-item-icon",ref:n})},hD=({command:e,isSelected:t,disabled:n,onMouseMove:i,onClick:r,showShortcut:s,appState:o,size:a="small"})=>{const l=()=>{};return N("div",{className:le("command-item",{"item-selected":t,"item-disabled":n,"command-item-large":a==="large"}),ref:c=>{var d;t&&!n&&((d=c==null?void 0:c.scrollIntoView)==null||d.call(c,{block:"nearest"}))},onClick:n?l:r,onMouseMove:n?l:i,title:n?M("commandPalette.itemNotAvailable"):"",children:[N("div",{className:"name",children:[e.icon&&g(Dy,{className:"icon",size:"var(--icon-size, 1rem)",icon:typeof e.icon=="function"?e.icon(o):e.icon}),g(tG,{children:e.label})]}),s&&e.shortcut&&g(lb,{shortcut:e.shortcut})]})},l2=ue({name:"toggleLinearEditor",category:ot.elements,label:(e,t,n)=>{const i=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds})[0];return(i==null?void 0:i.type)==="arrow"?"labels.lineEditor.editArrow":"labels.lineEditor.edit"},keywords:["line"],trackEvent:{category:"element"},predicate:(e,t,n,i)=>{var s;const r=i.scene.getSelectedElements(t);return!!(!((s=t.selectedLinearElement)!=null&&s.isEditing)&&r.length===1&&xe(r[0])&&!me(r[0]))},perform(e,t,n,i){const r=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0})[0];gn(r,"No selected element found"),gn(t.selectedLinearElement,"No selected linear element found"),gn(r.id===t.selectedLinearElement.elementId,"Selected element ID and linear editor elementId does not match");const s={...t.selectedLinearElement,isEditing:!t.selectedLinearElement.isEditing};return{appState:{...t,selectedLinearElement:s},captureUpdate:Z.IMMEDIATELY}},PanelComponent:({appState:e,updateData:t,app:n})=>{const i=n.scene.getSelectedElements({selectedElementIds:e.selectedElementIds})[0];if(!i)return null;const r=M(i.type==="arrow"?"labels.lineEditor.editArrow":"labels.lineEditor.edit");return g(je,{type:"button",icon:the,title:r,"aria-label":r,onClick:()=>t(null)})}});ue({name:"togglePolygon",category:ot.elements,icon:jM,keywords:["loop"],label:(e,t,n)=>!n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds}).some(s=>!nn(s)||!s.polygon)?"labels.polygon.breakPolygon":"labels.polygon.convertToPolygon",trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const r=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds});return r.length>0&&r.every(s=>nn(s)&&s.points.length>=4)},perform(e,t,n,i){const r=i.scene.getSelectedElements(t);if(r.some(l=>!nn(l)))return!1;const s=r,o=s.some(l=>!l.polygon),a=ve(s);return{elements:e.map(l=>!a.has(l.id)||!nn(l)?l:Ie(l,{backgroundColor:o?l.backgroundColor:"transparent",...x9(l,o)})),appState:t,captureUpdate:Z.IMMEDIATELY}},PanelComponent:({appState:e,updateData:t,app:n})=>{const i=n.scene.getSelectedElements({selectedElementIds:e.selectedElementIds});if(i.length===0||i.some(o=>!nn(o)||!o.polygon||o.points.length<3))return null;const r=i.every(o=>nn(o)&&o.polygon),s=M(r?"labels.polygon.breakPolygon":"labels.polygon.convertToPolygon");return g(sT,{icon:jM,title:s,"aria-label":s,active:r,onClick:()=>t(null),style:{marginLeft:"auto"}})}});const yj=ue({name:"searchMenu",icon:Eu,keywords:["search","find"],label:"search.title",viewMode:!0,trackEvent:{category:"search_menu",action:"toggle",predicate:e=>e.gridModeEnabled},perform(e,t,n,i){var r,s;if(t.openDialog)return!1;if(((r=t.openSidebar)==null?void 0:r.name)===As.name&&t.openSidebar.tab===Qd){const o=(s=i.excalidrawContainerValue.container)==null?void 0:s.querySelector(`.${Jr.SEARCH_MENU_INPUT_WRAPPER} input`);return o==null||o.focus(),o==null||o.select(),!1}return{appState:{...t,openSidebar:{name:As.name,tab:Qd},openDialog:null},captureUpdate:Z.EVENTUALLY}},checked:e=>e.gridModeEnabled,predicate:(e,t,n)=>n.gridModeEnabled===void 0,keyTest:e=>e[V.CTRL_OR_CMD]&&e.key===V.F}),H3e=ue({name:"cropEditor",label:"helpDialog.cropStart",icon:uk,viewMode:!0,trackEvent:{category:"menu"},keywords:["image","crop"],perform(e,t,n,i){const r=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0})[0];return{appState:{...t,isCropping:!1,croppingElementId:r.id},captureUpdate:Z.IMMEDIATELY}},predicate:(e,t,n,i)=>{const r=i.scene.getSelectedElements(t);return!!(!t.croppingElementId&&r.length===1&&yt(r[0]))},PanelComponent:({appState:e,updateData:t,app:n})=>{const i=M("helpDialog.cropStart");return g(je,{type:"button",icon:uk,title:i,"aria-label":i,onClick:()=>t(null)})}}),Ej=(e,t)=>{const n=t.scene.getSelectedElements(e);return n.length===1&&we(n[0])},V3e=ue({name:"selectAllElementsInFrame",label:"labels.selectAllElementsInFrame",trackEvent:{category:"canvas"},perform:(e,t,n,i)=>{const r=i.scene.getSelectedElements(t).at(0)||null;if(we(r)){const s=ns(Yt(e),r.id).filter(o=>!(o.type==="text"&&o.containerId));return{elements:e,appState:{...t,selectedElementIds:s.reduce((o,a)=>(o[a.id]=!0,o),{})},captureUpdate:Z.IMMEDIATELY}}return{elements:e,appState:t,captureUpdate:Z.EVENTUALLY}},predicate:(e,t,n,i)=>Ej(t,i)}),$3e=ue({name:"removeAllElementsFromFrame",label:"labels.removeAllElementsFromFrame",trackEvent:{category:"history"},perform:(e,t,n,i)=>{const r=i.scene.getSelectedElements(t).at(0)||null;return we(r)?{elements:Bz(e,r),appState:{...t,selectedElementIds:{[r.id]:!0}},captureUpdate:Z.IMMEDIATELY}:{elements:e,appState:t,captureUpdate:Z.EVENTUALLY}},predicate:(e,t,n,i)=>Ej(t,i)});ue({name:"updateFrameRendering",label:"labels.updateFrameRendering",viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t)=>({elements:e,appState:{...t,frameRendering:{...t.frameRendering,enabled:!t.frameRendering.enabled}},captureUpdate:Z.EVENTUALLY}),checked:e=>e.frameRendering.enabled});ue({name:"setFrameAsActiveTool",label:"toolBar.frame",trackEvent:{category:"toolbar"},icon:nu,viewMode:!1,perform:(e,t,n,i)=>{const r=tn(t,{type:"frame"});return So(i.interactiveCanvas,{...t,activeTool:r}),{elements:e,appState:{...t,activeTool:tn(t,{type:"frame"})},captureUpdate:Z.EVENTUALLY}},keyTest:e=>!e[V.CTRL_OR_CMD]&&!e.shiftKey&&!e.altKey&&e.key.toLocaleLowerCase()===V.F});const G3e=ue({name:"wrapSelectionInFrame",label:"labels.wrapSelectionInFrame",trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const r=Xe(e,t);return r.length>0&&!r.some(s=>we(s))},perform:(e,t,n,i)=>{const r=Xe(e,t),s=i.scene.getNonDeletedElementsMap(),[o,a,l,c]=ht(r,s),d=16,u=L9({x:o-d,y:a-d,width:l-o+d*2,height:c-a+d*2});if(t.editingGroupId){const h=At(r,t.editingGroupId);for(const m of h){const p=m.groupIds.indexOf(t.editingGroupId);_i(m,s,{groupIds:m.groupIds.slice(0,p)})}}return{elements:I0([...i.scene.getElementsIncludingDeleted(),u],r,u,t),appState:{selectedElementIds:{[u.id]:!0}},captureUpdate:Z.IMMEDIATELY}}});class c2 extends yu{applyTo(t,n,i){const[r,s]=this.elements.applyTo(t,i.elements,{excludedProperties:new Set(["version","versionNonce"])}),[o,a]=this.appState.applyTo(n,r);return[r,o,s||a]}static calculate(t,n){return super.calculate(t,n)}static inverse(t){return super.inverse(t)}static applyLatestChanges(t,n,i,r){return super.applyLatestChanges(t,n,i,r)}}class e5{constructor(t=!0,n=!0){this.isUndoStackEmpty=t,this.isRedoStackEmpty=n}}class Vd{constructor(t){F(this,"onHistoryChangedEmitter",new Ws);F(this,"undoStack",[]);F(this,"redoStack",[]);this.store=t}get isUndoStackEmpty(){return this.undoStack.length===0}get isRedoStackEmpty(){return this.redoStack.length===0}clear(){this.undoStack.length=0,this.redoStack.length=0}record(t){if(t.isEmpty()||t instanceof c2)return;const n=c2.inverse(t);this.undoStack.push(n),n.elements.isEmpty()||(this.redoStack.length=0),this.onHistoryChangedEmitter.trigger(new e5(this.isUndoStackEmpty,this.isRedoStackEmpty))}undo(t,n){return this.perform(t,n,()=>Vd.pop(this.undoStack),i=>Vd.push(this.redoStack,i))}redo(t,n){return this.perform(t,n,()=>Vd.pop(this.redoStack),i=>Vd.push(this.undoStack,i))}perform(t,n,i,r){try{let s=i();if(s===null)return;const o=Z.IMMEDIATELY;let a=this.store.snapshot,l=t,c=n,d=!1;for(;s;){try{[l,c,d]=s.applyTo(l,c,a);const u=a.elements,f=a.maybeClone(o,l,c),h=uh.create(a,f),m=c2.applyLatestChanges(s,u,l);m.isEmpty()||(this.store.scheduleMicroAction({action:o,change:h,delta:m}),s=m),a=f}finally{r(s)}if(d)break;s=i()}return[l,c]}finally{this.onHistoryChangedEmitter.trigger(new e5(this.isUndoStackEmpty,this.isRedoStackEmpty))}}static pop(t){if(!t.length)return null;const n=t.pop();return n!==void 0?n:null}static push(t,n){const i=c2.inverse(n);return t.push(i)}}const vj=(e,t)=>{const[n,i]=R.useState(t);return R.useEffect(()=>{const r=e.on(s=>{i(s)});return()=>{r()}},[e]),n},wj=(e,t,n)=>{if(!t.multiElement&&!t.resizingElement&&!t.editingTextElement&&!t.newElement&&!t.selectedElementsAreBeingDragged&&!t.selectionElement&&!e.flowChartCreator.isCreatingChart){const i=n();if(!i)return{captureUpdate:Z.EVENTUALLY};const[r,s]=i,o=R9(Array.from(r.values()));return{appState:s,elements:o,captureUpdate:Z.NEVER}}return{captureUpdate:Z.EVENTUALLY}},X3e=e=>({name:"undo",label:"buttons.undo",icon:ZM,trackEvent:{category:"history"},viewMode:!1,perform:(t,n,i,r)=>wj(r,n,()=>e.undo(ve(t),n)),keyTest:t=>t[V.CTRL_OR_CMD]&&_4(t,V.Z)&&!t.shiftKey,PanelComponent:({appState:t,updateData:n,data:i,app:r})=>{const{isUndoStackEmpty:s}=vj(e.onHistoryChangedEmitter,new e5(e.isUndoStackEmpty,e.isRedoStackEmpty)),o=fa()==="mobile";return g(je,{type:"button",icon:ZM,"aria-label":M("buttons.undo"),onClick:n,size:(i==null?void 0:i.size)||"medium",disabled:s,"data-testid":"button-undo",style:{...o?bp:{}}})}}),j3e=e=>({name:"redo",label:"buttons.redo",icon:qM,trackEvent:{category:"history"},viewMode:!1,perform:(t,n,i,r)=>wj(r,n,()=>e.redo(ve(t),n)),keyTest:t=>t[V.CTRL_OR_CMD]&&t.shiftKey&&_4(t,V.Z)||CB&&t.ctrlKey&&!t.shiftKey&&_4(t,V.Y),PanelComponent:({appState:t,updateData:n,data:i,app:r})=>{const{isRedoStackEmpty:s}=vj(e.onHistoryChangedEmitter,new e5(e.isUndoStackEmpty,e.isRedoStackEmpty)),o=fa()==="mobile";return g(je,{type:"button",icon:qM,"aria-label":M("buttons.redo"),onClick:n,size:(i==null?void 0:i.size)||"medium",disabled:s,"data-testid":"button-redo",style:{...o?bp:{}}})}}),Y3e=ue({name:"autoResize",label:"labels.autoResize",icon:null,trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const r=Xe(e,t);return r.length===1&&ge(r[0])&&!r[0].autoResize},perform:(e,t,n,i)=>{const r=Xe(e,t);return{appState:t,elements:e.map(s=>{if(s.id===r[0].id&&ge(s)){const o=jn(s.originalText,mt(s),s.lineHeight);return Ie(s,{autoResize:!0,width:o.width,height:o.height,text:s.originalText})}return s}),captureUpdate:Z.IMMEDIATELY}}}),L3=(e,t,n,i,r,s)=>{if(e.trackEvent)try{typeof e.trackEvent=="object"&&(!e.trackEvent.predicate||e.trackEvent.predicate(n,i,s))&&et(e.trackEvent.category,e.trackEvent.action||e.name,`${t} (${r.editorInterface.formFactor==="phone"?"mobile":"desktop"})`)}catch(o){console.error("error while logging action:",o)}};class W3e{constructor(t,n,i,r){F(this,"actions",{});F(this,"updater");F(this,"getAppState");F(this,"getElementsIncludingDeleted");F(this,"app");F(this,"renderAction",(t,n)=>{const i=this.app.props.UIOptions.canvasActions;if(this.actions[t]&&"PanelComponent"in this.actions[t]&&(!(t in i)||i[t])){const r=this.actions[t],s=r.PanelComponent;s.displayName="PanelComponent";const o=this.getElementsIncludingDeleted(),a=this.getAppState(),l=c=>{L3(r,"ui",a,o,this.app,c),this.updater(r.perform(this.getElementsIncludingDeleted(),this.getAppState(),c,this.app))};return g(s,{elements:this.getElementsIncludingDeleted(),appState:this.getAppState(),updateData:l,appProps:this.app.props,app:this.app,data:n,renderAction:this.renderAction})}return null});F(this,"isActionEnabled",t=>{const n=this.getElementsIncludingDeleted(),i=this.getAppState();return!t.predicate||t.predicate(n,i,this.app.props,this.app)});this.updater=s=>{if(_p(s))s.then(o=>t(o));else return t(s)},this.getAppState=n,this.getElementsIncludingDeleted=i,this.app=r}registerAction(t){this.actions[t.name]=t}registerAll(t){t.forEach(n=>this.registerAction(n))}handleKeyDown(t){const n=this.app.props.UIOptions.canvasActions,i=Object.values(this.actions).sort((l,c)=>(c.keyPriority||0)-(l.keyPriority||0)).filter(l=>(l.name in n?n[l.name]:!0)&&l.keyTest&&l.keyTest(t,this.getAppState(),this.getElementsIncludingDeleted(),this.app));if(i.length!==1)return i.length>1&&console.warn("Canceling as multiple actions match this shortcut",i),!1;const r=i[0];if(this.getAppState().viewModeEnabled&&r.viewMode!==!0)return!1;const s=this.getElementsIncludingDeleted(),o=this.getAppState(),a=null;return L3(r,"keyboard",o,s,this.app,null),t.preventDefault(),t.stopPropagation(),this.updater(i[0].perform(s,o,a,this.app)),!0}executeAction(t,n="api",i=null){const r=this.getElementsIncludingDeleted(),s=this.getAppState();L3(t,n,s,r,this.app,i),this.updater(t.perform(r,s,i,this.app))}}class K3e{constructor(){F(this,"targets",new WeakMap);F(this,"rafIds",new WeakMap)}register(t,n){this.targets.set(t,{callback:n,stopped:!0})}start(t){const n=this.targets.get(t);n&&(this.rafIds.has(t)||(this.targets.set(t,{...n,stopped:!1}),this.scheduleFrame(t)))}stop(t){const n=this.targets.get(t);n&&!n.stopped&&this.targets.set(t,{...n,stopped:!0}),this.cancelFrame(t)}constructFrame(t){return n=>{const i=this.targets.get(t);if(!i)return;const r=this.onFrame(i,n);!i.stopped&&!r?this.scheduleFrame(t):this.cancelFrame(t)}}scheduleFrame(t){const n=requestAnimationFrame(this.constructFrame(t));this.rafIds.set(t,n)}cancelFrame(t){if(this.rafIds.has(t)){const n=this.rafIds.get(t);cancelAnimationFrame(n)}this.rafIds.delete(t)}onFrame(t,n){return t.callback(n)??!1}}const gD=e=>{const t=Array.from(e.values());return{x:pD(t,n=>n.x)/t.length,y:pD(t,n=>n.y)/t.length}},mD=([e,t])=>Math.hypot(e.x-t.x,e.y-t.y),pD=(e,t)=>e.reduce((n,i)=>n+t(i),0),Z3e=8,UD=99999,iE=e=>Z3e/e,rr=class rr{};F(rr,"referenceSnapPoints",null),F(rr,"visibleGaps",null),F(rr,"setReferenceSnapPoints",t=>{rr.referenceSnapPoints=t}),F(rr,"getReferenceSnapPoints",()=>rr.referenceSnapPoints),F(rr,"setVisibleGaps",t=>{rr.visibleGaps=t}),F(rr,"getVisibleGaps",()=>rr.visibleGaps),F(rr,"destroy",()=>{rr.referenceSnapPoints=null,rr.visibleGaps=null});let Ks=rr;const Vm=e=>e.props.gridModeEnabled??e.state.gridModeEnabled,Zc=({event:e,app:t,selectedElements:n})=>{if(e){const i=t.state.activeTool.type==="lasso"&&t.state.selectedElementsAreBeingDragged;return(t.state.activeTool.type!=="lasso"||i)&&(t.state.objectsSnapModeEnabled&&!e[V.CTRL_OR_CMD]||!t.state.objectsSnapModeEnabled&&e[V.CTRL_OR_CMD]&&!Vm(t))}return n.length===1&&n[0].type==="arrow"?!1:t.state.objectsSnapModeEnabled},q3e=(e,t,n=.01)=>Math.abs(e-t)<=n,$m=(e,t,{omitCenter:n,boundingBoxCorners:i,dragOffset:r}={omitCenter:!1,boundingBoxCorners:!1})=>{let s=[];if(e.length===1){const o=e[0];let[a,l,c,d,u,f]=$e(o,t);r&&(a+=r.x,c+=r.x,u+=r.x,l+=r.y,d+=r.y,f+=r.y);const h=(c-a)/2,m=(d-l)/2;if((o.type==="diamond"||o.type==="ellipse")&&!i){const p=Q(S(a,l+m),S(u,f),o.angle),U=Q(S(a+h,l),S(u,f),o.angle),b=Q(S(c,l+m),S(u,f),o.angle),y=Q(S(a+h,d),S(u,f),o.angle),w=S(u,f);s=n?[p,U,b,y]:[p,U,b,y,w]}else{const p=Q(S(a,l),S(u,f),o.angle),U=Q(S(c,l),S(u,f),o.angle),b=Q(S(a,d),S(u,f),o.angle),y=Q(S(c,d),S(u,f),o.angle),w=S(u,f);s=n?[p,U,b,y]:[p,U,b,y,w]}}else if(e.length>1){const[o,a,l,c]=M9(e,r??{x:0,y:0}),d=l-o,u=c-a,f=S(o,a),h=S(l,a),m=S(o,c),p=S(l,c),U=S(o+d/2,a+u/2);s=n?[f,h,m,p]:[f,h,m,p,U]}return s.map(o=>S(ln(o[0]),ln(o[1])))},_j=(e,t,n,i)=>Oz(e,t,n,i),Q3e=(e,t,n,i)=>{const r=_j(e,t,n,i),s=Nz(r,i).filter(u=>!(u.length===1&&Dt(u[0]))).map(u=>ht(u).map(f=>ln(f))),o=s.sort((u,f)=>u[0]-f[0]),a=[];let l=0;e:for(let u=0;u<o.length;u++){const f=o[u];for(let h=u+1;h<o.length;h++){if(++l>UD)break e;const m=o[h],[,p,U,b]=f,[y,w,,v]=m;U<y&&s6(Vi(p,b),Vi(w,v))&&a.push({startBounds:f,endBounds:m,startSide:[S(U,p),S(U,b)],endSide:[S(y,w),S(y,v)],length:y-U,overlap:o6(Vi(p,b),Vi(w,v))})}}const c=s.sort((u,f)=>u[1]-f[1]),d=[];l=0;e:for(let u=0;u<c.length;u++){const f=c[u];for(let h=u+1;h<c.length;h++){if(++l>UD)break e;const m=c[h],[p,,U,b]=f,[y,w,v]=m;b<w&&s6(Vi(p,U),Vi(y,v))&&d.push({startBounds:f,endBounds:m,startSide:[S(p,b),S(U,b)],endSide:[S(y,w),S(v,w)],length:w-b,overlap:o6(Vi(p,U),Vi(y,v))})}}return{horizontalGaps:a,verticalGaps:d}},bD=(e,t,n,i,r,s,o)=>{if(!Zc({app:n,event:i,selectedElements:e}))return[];if(e.length===0)return[];const a=Ks.getVisibleGaps();if(a){const{horizontalGaps:l,verticalGaps:c}=a,[d,u,f,h]=M9(e,t).map(U=>ln(U)),m=(d+f)/2,p=(u+h)/2;for(const U of l){if(!s6(Vi(u,h),U.overlap))continue;const b=U.startSide[0][0]+U.length/2,y=ln(b-m);if(U.length>f-d&&Math.abs(y)<=o.x){Math.abs(y)<o.x&&(r.length=0),o.x=Math.abs(y);const x={type:"gap",direction:"center_horizontal",gap:U,offset:y};r.push(x);continue}const[,,v]=U.endBounds,I=d-v,C=ln(U.length-I);if(Math.abs(C)<=o.x){Math.abs(C)<o.x&&(r.length=0),o.x=Math.abs(C);const x={type:"gap",direction:"side_right",gap:U,offset:C};r.push(x);continue}const[_,,,]=U.startBounds,T=_-f,k=ln(T-U.length);if(Math.abs(k)<=o.x){Math.abs(k)<o.x&&(r.length=0),o.x=Math.abs(k);const x={type:"gap",direction:"side_left",gap:U,offset:k};r.push(x);continue}}for(const U of c){if(!s6(Vi(d,f),U.overlap))continue;const b=U.startSide[0][1]+U.length/2,y=ln(b-p);if(U.length>h-u&&Math.abs(y)<=o.y){Math.abs(y)<o.y&&(s.length=0),o.y=Math.abs(y);const x={type:"gap",direction:"center_vertical",gap:U,offset:y};s.push(x);continue}const[,v,,]=U.startBounds,I=v-h,C=ln(I-U.length);if(Math.abs(C)<=o.y){Math.abs(C)<o.y&&(s.length=0),o.y=Math.abs(C);const x={type:"gap",direction:"side_top",gap:U,offset:C};s.push(x);continue}const[,,,_]=U.endBounds,T=ln(u-_),k=U.length-T;if(Math.abs(k)<=o.y){Math.abs(k)<o.y&&(s.length=0),o.y=Math.abs(k);const x={type:"gap",direction:"side_bottom",gap:U,offset:k};s.push(x);continue}}}},J3e=(e,t,n,i)=>{const r=_j(e,t,n,i);return Nz(r,i).filter(s=>!(s.length===1&&Dt(s[0]))).flatMap(s=>$m(s,i))},ig=(e,t,n,i,r,s,o)=>{if(!Zc({app:n,event:i,selectedElements:e})||e.length===0&&t.length===0)return[];const a=Ks.getReferenceSnapPoints();if(a)for(const l of t)for(const c of a){const d=c[0]-l[0],u=c[1]-l[1];Math.abs(d)<=o.x&&(Math.abs(d)<o.x&&(r.length=0),r.push({type:"point",points:[l,c],offset:d}),o.x=Math.abs(d)),Math.abs(u)<=o.y&&(Math.abs(u)<o.y&&(s.length=0),s.push({type:"point",points:[l,c],offset:u}),o.y=Math.abs(u))}},e7e=(e,t,n,i,r)=>{var U,b;const s=n.state,o=Xe(e,s);if(!Zc({app:n,event:i,selectedElements:o})||o.length===0)return{snapOffset:{x:0,y:0},snapLines:[]};t.x=ln(t.x),t.y=ln(t.y);const a=[],l=[],c=iE(s.zoom.value),d={x:c,y:c},u=$m(o,r,{dragOffset:t});ig(o,u,n,i,a,l,d),bD(o,t,n,i,a,l,d);const f={x:((U=a[0])==null?void 0:U.offset)??0,y:((b=l[0])==null?void 0:b.offset)??0};d.x=0,d.y=0,a.length=0,l.length=0;const h={x:ln(t.x+f.x),y:ln(t.y+f.y)};ig(o,$m(o,r,{dragOffset:h}),n,i,a,l,d),bD(o,h,n,i,a,l,d);const m=KT(a,l),p=n7e(o,h,[...a,...l].filter(y=>y.type==="gap"));return{snapOffset:f,snapLines:[...m,...p]}},ln=e=>Math.round(e*10**6)/10**6,yD=e=>{const t=new Map;for(const n of e){const i=n.join(",");t.has(i)||t.set(i,n)}return Array.from(t.values())},KT=(e,t)=>{const n={},i={};if(e.length>0){for(const r of e)if(r.type==="point"){const s=ln(r.points[0][0]);n[s]||(n[s]=[]),n[s].push(...r.points.map(o=>S(ln(o[0]),ln(o[1]))))}}if(t.length>0){for(const r of t)if(r.type==="point"){const s=ln(r.points[0][1]);i[s]||(i[s]=[]),i[s].push(...r.points.map(o=>S(ln(o[0]),ln(o[1]))))}}return Object.entries(n).map(([r,s])=>({type:"points",points:yD(s.map(o=>S(Number(r),o[1])).sort((o,a)=>o[1]-a[1]))})).concat(Object.entries(i).map(([r,s])=>({type:"points",points:yD(s.map(o=>S(o[0],Number(r))).sort((o,a)=>o[0]-a[0]))})))},t7e=e=>{const t=new Map;for(const n of e){const i=n.points.flat().map(r=>[ln(r)]).join(",");t.has(i)||t.set(i,n)}return Array.from(t.values())},n7e=(e,t,n)=>{const[i,r,s,o]=M9(e,t),a=[];for(const l of n){const[c,d,u,f]=l.gap.startBounds,[h,m,p,U]=l.gap.endBounds,b=o6(Vi(r,o),l.gap.overlap),y=o6(Vi(i,s),l.gap.overlap);switch(l.direction){case"center_horizontal":{if(b){const w=(b[0]+b[1])/2;a.push({type:"gap",direction:"horizontal",points:[S(l.gap.startSide[0][0],w),S(i,w)]},{type:"gap",direction:"horizontal",points:[S(s,w),S(l.gap.endSide[0][0],w)]})}break}case"center_vertical":{if(y){const w=(y[0]+y[1])/2;a.push({type:"gap",direction:"vertical",points:[S(w,l.gap.startSide[0][1]),S(w,r)]},{type:"gap",direction:"vertical",points:[S(w,o),S(w,l.gap.endSide[0][1])]})}break}case"side_right":{if(b){const w=(b[0]+b[1])/2;a.push({type:"gap",direction:"horizontal",points:[S(u,w),S(h,w)]},{type:"gap",direction:"horizontal",points:[S(p,w),S(i,w)]})}break}case"side_left":{if(b){const w=(b[0]+b[1])/2;a.push({type:"gap",direction:"horizontal",points:[S(s,w),S(c,w)]},{type:"gap",direction:"horizontal",points:[S(u,w),S(h,w)]})}break}case"side_top":{if(y){const w=(y[0]+y[1])/2;a.push({type:"gap",direction:"vertical",points:[S(w,o),S(w,d)]},{type:"gap",direction:"vertical",points:[S(w,f),S(w,m)]})}break}case"side_bottom":{if(y){const w=(y[0]+y[1])/2;a.push({type:"gap",direction:"vertical",points:[S(w,f),S(w,m)]},{type:"gap",direction:"vertical",points:[S(w,U),S(w,r)]})}break}}}return t7e(a.map(l=>({...l,points:l.points.map(c=>S(ln(c[0]),ln(c[1])))})))},ED=(e,t,n,i,r,s)=>{var C,_;if(!Zc({event:i,selectedElements:e,app:n})||e.length===0||e.length===1&&!q3e(e[0].angle,0))return{snapOffset:{x:0,y:0},snapLines:[]};let[o,a,l,c]=ht(t);s&&(s.includes("e")?l+=r.x:s.includes("w")&&(o+=r.x),s.includes("n")?a+=r.y:s.includes("s")&&(c+=r.y));const d=[];if(s)switch(s){case"e":{d.push(S(l,a),S(l,c));break}case"w":{d.push(S(o,a),S(o,c));break}case"n":{d.push(S(o,a),S(l,a));break}case"s":{d.push(S(o,c),S(l,c));break}case"ne":{d.push(S(l,a));break}case"nw":{d.push(S(o,a));break}case"se":{d.push(S(l,c));break}case"sw":{d.push(S(o,c));break}}const u=iE(n.state.zoom.value),f={x:u,y:u},h=[],m=[];ig(t,d,n,i,h,m,f);const p={x:((C=h[0])==null?void 0:C.offset)??0,y:((_=m[0])==null?void 0:_.offset)??0};f.x=0,f.y=0,h.length=0,m.length=0;const[U,b,y,w]=ht(e).map(T=>ln(T)),v=[S(U,b),S(U,w),S(y,b),S(y,w)];ig(e,v,n,i,h,m,f);const I=KT(h,m);return{snapOffset:p,snapLines:I}},i7e=(e,t,n,i,r,s)=>{var m,p;if(!Zc({event:n,selectedElements:[e],app:t}))return{snapOffset:{x:0,y:0},snapLines:[]};const o=[S(i.x+r.x,i.y+r.y)],a=iE(t.state.zoom.value),l={x:a,y:a},c=[],d=[];ig([e],o,t,n,c,d,l);const u={x:((m=c[0])==null?void 0:m.offset)??0,y:((p=d[0])==null?void 0:p.offset)??0};l.x=0,l.y=0,c.length=0,d.length=0;const f=$m([e],s,{boundingBoxCorners:!0,omitCenter:!0});ig([e],f,t,n,c,d,l);const h=KT(c,d);return{snapOffset:u,snapLines:h}},r7e=(e,t,n,i,r)=>{if(!Zc({event:i,selectedElements:[],app:t}))return{originOffset:{x:0,y:0},snapLines:[]};const s=Oz(e,[],t.state,r),o=iE(t.state.zoom.value),a={x:o,y:o},l=[],c=[];for(const d of s){const u=$m([d],r);for(const f of u){const h=f[0]-n.x;Math.abs(h)<=Math.abs(a.x)&&(Math.abs(h)<Math.abs(a.x)&&(c.length=0),c.push({type:"pointer",points:[f,S(f[0],n.y)],direction:"vertical"}),a.x=h);const m=f[1]-n.y;Math.abs(m)<=Math.abs(a.y)&&(Math.abs(m)<Math.abs(a.y)&&(l.length=0),l.push({type:"pointer",points:[f,S(n.x,f[1])],direction:"horizontal"}),a.y=m)}}return{originOffset:{x:c.length>0?c[0].points[0][0]-n.x:0,y:l.length>0?l[0].points[0][1]-n.y:0},snapLines:[...c,...l]}},s7e=e=>e===Qn.rectangle||e===Qn.ellipse||e===Qn.diamond||e===Qn.frame||e===Qn.magicframe||e===Qn.image||e===Qn.text,d2={width:100,height:0},uc=100,o7e=(e,t,n)=>{const i=os({x:0,y:0,textAlign:dm.CENTER,verticalAlign:Yr.MIDDLE,...t,containerId:e.id,strokeColor:t.strokeColor||e.strokeColor});return Object.assign(e,{boundElements:(e.boundElements||[]).concat({type:"text",id:i.id})}),Qi(i,e,n),[e,i]},vD=(e,t,n,i,r)=>{let s,o;if(Object.assign(e,{startBinding:(e==null?void 0:e.startBinding)||null,endBinding:e.endBinding||null}),t){const d=(t==null?void 0:t.width)??uc,u=(t==null?void 0:t.height)??uc;let f;t.id&&(f=i.getElement(t.id),f||console.error(`No element for start binding with id ${t.id} found`));const h=t.x||e.x-d,m=t.y||e.y-u/2,p=f?f.type:t.type;if(p){if(p==="text"){let U="";f&&f.type==="text"?U=f.text:t.type==="text"&&(U=t.text),U||console.error(`No text found for start binding text element for ${e.id}`),s=os({x:h,y:m,type:"text",...f,...t,text:U}),Object.assign(s,{x:t.x||e.x-s.width,y:t.y||e.y-s.height/2})}else switch(p){case"rectangle":case"ellipse":case"diamond":{s=ia({x:h,y:m,width:d,height:u,...f,...t,type:p});break}default:qo(e,`Unhandled element start type "${t.type}"`,!0)}na(e,s,"start",r)}}if(n){const d=(n==null?void 0:n.height)??uc,u=(n==null?void 0:n.width)??uc;let f;n.id&&(f=i.getElement(n.id),f||console.error(`No element for end binding with id ${n.id} found`));const h=n.x||e.x+e.width,m=n.y||e.y-d/2,p=f?f.type:n.type;if(p){if(p==="text"){let U="";f&&f.type==="text"?U=f.text:n.type==="text"&&(U=n.text),U||console.error(`No text found for end binding text element for ${e.id}`),o=os({x:h,y:m,type:"text",...f,...n,text:U}),Object.assign(o,{y:n.y||e.y-o.height/2})}else switch(p){case"rectangle":case"ellipse":case"diamond":{o=ia({x:h,y:m,width:u,height:d,...f,...n,type:p});break}default:qo(e,`Unhandled element end type "${p}"`,!0)}na(e,o,"end",r)}}if(e.points.length<2)return{linearElement:e,startBoundElement:s,endBoundElement:o};const a=e.points.length-1,l=.5,c=Qa(e.points);return e.points[a][0]>e.points[a-1][0]&&(c[0][0]=l,c[a][0]-=l),e.points[a][0]<e.points[a-1][0]&&(c[0][0]=-.5,c[a][0]+=l),e.points[a][1]>e.points[a-1][1]&&(c[0][1]=l,c[a][1]-=l),e.points[a][1]<e.points[a-1][1]&&(c[0][1]=-.5,c[a][1]+=l),Object.assign(e,pe.getNormalizeElementPointsAndCoords({...e,points:c})),{linearElement:e,startBoundElement:s,endBoundElement:o}};class a7e{constructor(){F(this,"excalidrawElements",new Map);F(this,"add",t=>{t&&this.excalidrawElements.set(t.id,t)});F(this,"getElements",()=>cd(Array.from(this.excalidrawElements.values())));F(this,"getElementsMap",()=>Qo(ve(this.getElements())));F(this,"getElement",t=>this.excalidrawElements.get(t))}}const Bv=(e,t)=>{var l,c,d;if(!e)return[];const n=Qa(e),i=new a7e,r=new Map,s=new Map;for(const u of n){let f;const h=u.id;switch((t==null?void 0:t.regenerateIds)!==!1&&Object.assign(u,{id:gr()}),u.type){case"rectangle":case"ellipse":case"diamond":{const p=(l=u==null?void 0:u.label)!=null&&l.text&&u.width===void 0?0:(u==null?void 0:u.width)||uc,U=(c=u==null?void 0:u.label)!=null&&c.text&&u.height===void 0?0:(u==null?void 0:u.height)||uc;f=ia({...u,width:p,height:U});break}case"line":{const p=u.width||d2.width,U=u.height||d2.height;f=Tc({width:p,height:U,points:[S(0,0),S(p,U)],...u});break}case"arrow":{const p=u.width||d2.width,U=u.height||d2.height;f=gh({width:p,height:U,endArrowhead:"arrow",points:[S(0,0),S(p,U)],...u,type:"arrow"}),Object.assign(f,zh(f.points));break}case"text":{const p=(u==null?void 0:u.fontFamily)||sd,U=(u==null?void 0:u.fontSize)||Il,b=(u==null?void 0:u.lineHeight)||zc(p),y=u.text??"",w=Gh(y),v=jn(w,mt({fontFamily:p,fontSize:U}),b);f=os({width:v.width,height:v.height,fontFamily:p,fontSize:U,...u});break}case"image":{f=hH({width:(u==null?void 0:u.width)||uc,height:(u==null?void 0:u.height)||uc,...u});break}case"frame":{f=L9({x:0,y:0,...u});break}case"magicframe":{f=G4({x:0,y:0,...u});break}case"freedraw":case"iframe":case"embeddable":{f=u;break}default:f=u,qo(u,`Unhandled element type "${u.type}"`,!0)}i.getElement(f.id)?console.error(`Duplicate id found for ${f.id}`):(i.add(f),r.set(f.id,u),h&&s.set(h,f.id))}const o=i.getElementsMap(),a=new k6(o);for(const[u,f]of r){const h=i.getElement(u);switch(f.type){case"rectangle":case"ellipse":case"diamond":case"arrow":{if((d=f.label)!=null&&d.text){let[m,p]=o7e(h,f==null?void 0:f.label,a);if(i.add(m),i.add(p),Ce(m)){const U=f.type==="arrow"?f==null?void 0:f.start:void 0,b=f.type==="arrow"?f==null?void 0:f.end:void 0;if(U&&U.id){const I=s.get(U.id);I&&Object.assign(U,{id:I})}if(b&&b.id){const I=s.get(b.id);I&&Object.assign(b,{id:I})}const{linearElement:y,startBoundElement:w,endBoundElement:v}=vD(m,U,b,i,a);m=y,i.add(y),i.add(w),i.add(v)}}else switch(f.type){case"arrow":{const{start:m,end:p}=f;if(m&&m.id){const w=s.get(m.id);Object.assign(m,{id:w})}if(p&&p.id){const w=s.get(p.id);Object.assign(p,{id:w})}const{linearElement:U,startBoundElement:b,endBoundElement:y}=vD(h,m,p,i,a);i.add(U),i.add(b),i.add(y);break}}break}}}for(const[u,f]of r){if(f.type!=="frame"&&f.type!=="magicframe")continue;const h=i.getElement(u);if(!h)throw new Error(`Excalidraw element with id ${u} doesn't exist`);const m=[];f.children.forEach(T=>{var D;const k=s.get(T);if(!k)throw new Error(`Element with ${T} wasn't mapped correctly`);const x=i.getElement(k);if(!x)throw new Error(`Frame element with id ${k} doesn't exist`);Object.assign(x,{frameId:h.id}),(D=x==null?void 0:x.boundElements)==null||D.forEach(O=>{const L=i.getElement(O.id);if(!L)throw new Error(`Bound element with id ${O.id} doesn't exist`);Object.assign(L,{frameId:h.id}),m.push(L)}),m.push(x)});let[p,U,b,y]=ht(m);const w=10;p=p-w,U=U-w,b=b+w,y=y+w;const v=(h==null?void 0:h.x)||p,I=(h==null?void 0:h.y)||U,C=(h==null?void 0:h.width)||b-p,_=(h==null?void 0:h.height)||y-U;Object.assign(h,{x:v,y:I,width:C,height:_})}return i.getElements()};class wD{constructor(t){F(this,"scene");F(this,"getRenderableElements",(()=>{const t=({elementsMap:i,zoom:r,offsetLeft:s,offsetTop:o,scrollX:a,scrollY:l,height:c,width:d})=>{const u=[];for(const f of i.values())A6(f,d,c,{zoom:r,offsetLeft:s,offsetTop:o,scrollX:a,scrollY:l},i)&&u.push(f);return u},n=({elements:i,editingTextElement:r,newElementId:s})=>{const o=Qo(new Map);for(const a of i)s!==a.id&&(!r||r.type!=="text"||a.id!==r.id)&&o.set(a.id,a);return o};return ooe(({zoom:i,offsetLeft:r,offsetTop:s,scrollX:o,scrollY:a,height:l,width:c,editingTextElement:d,newElementId:u,sceneNonce:f})=>{const h=this.scene.getNonDeletedElements(),m=n({elements:h,editingTextElement:d,newElementId:u}),p=t({elementsMap:m,zoom:i,offsetLeft:r,offsetTop:s,scrollX:o,scrollY:a,height:l,width:c});return{elementsMap:m,visibleElements:p}})})());this.scene=t}destroy(){hX.cancel(),this.getRenderableElements.clear()}}const l7e=5,c7e=(e,t,n)=>{const[i,r]=$e(e,n),{x:s,y:o}=Wr({sceneX:i+e.width,sceneY:r},t),a=s-t.offsetLeft+10,l=o-t.offsetTop;return{x:a,y:l}},_D=({children:e,element:t,elementsMap:n})=>{const i=Gp();if(i.contextMenu||i.newElement||i.resizingElement||i.isRotating||i.openMenu||i.viewModeEnabled)return null;const{x:r,y:s}=c7e(t,i,n);return g("div",{className:"excalidraw-canvas-buttons",style:{top:`${s}px`,left:`${r}px`,padding:l7e},children:e})};function d7e(e,t,n,i){Object.defineProperty(e,t,{get:n,set:i,enumerable:!0,configurable:!0})}var u7e={};d7e(u7e,"LaserPointer",()=>n5);function vn([e,t,n],[i,r,s]){return[e+i,t+r,n+s]}function Z1([e,t,n],[i,r,s]){return[e-i,t-r,n-s]}function On([e,t,n],i){return[e*i,t*i,n*i]}function mf([e,t,n]){return[e/Math.sqrt(e**2+t**2),t/Math.sqrt(e**2+t**2),n]}function Bi([e,t,n],i){return[Math.cos(i)*e-Math.sin(i)*t,Math.sin(i)*e+Math.cos(i)*t,n]}function f7e(e,t,n){return vn(e,On(Z1(t,e),n))}function TD(e,t,n){return Math.atan2(n[1]-e[1],n[0]-e[0])-Math.atan2(t[1]-e[1],t[0]-e[0])}function ID(e){return Math.atan2(Math.sin(e),Math.cos(e))}function SD([e,t]){return Math.sqrt(e**2+t**2)}function _h([e,t],[n,i]){return Math.sqrt((n-e)**2+(i-t)**2)}function h7e(e){if(e.length<2)return 0;let t=0;for(let n=1;n<=e.length-1;n++)t+=_h(e[n-1],e[n]);return t+=_h(e[e.length-2],e[e.length-1]),t}const g7e=(e,t,n)=>Math.max(t,Math.min(n,e));function m7e(e,t,n){const i=_h(t,n);if(i===0)return _h(e,t);const r=g7e(((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/i**2,0,1),s=[t[0]+r*(n[0]-t[0]),t[1]+r*(n[1]-t[1]),e[2]];return _h(s,e)}function t5(e,t){if(t===0||e.length<=2)return e;const n=e[0],i=e[e.length-1],[r,s]=e.reduce(([o,a],l,c)=>{const d=m7e(l,n,i);return d>o?[d,c]:[o,a]},[0,-1]);if(r>=t){const o=e[s];return[...t5([n,...e.slice(1,s),o],t).slice(0,-1),o,...t5([o,...e.slice(s,-1),i],t).slice(1)]}else return[n,i]}const Ql=class Ql{constructor(t){this.originalPoints=[],this.stablePoints=[],this.tailPoints=[],this.isFresh=!0,this.options=Object.assign({},Ql.defaults,t)}get lastPoint(){return this.tailPoints[this.tailPoints.length-1]??this.stablePoints[this.stablePoints.length-1]}addPoint(t){const n=this.originalPoints[this.originalPoints.length-1];if(!(n&&n[0]===t[0]&&n[1]===t[1])){if(this.originalPoints.push(t),this.isFresh){this.isFresh=!1,this.stablePoints.push(t);return}this.options.streamline>0&&(t=f7e(this.lastPoint,t,1-this.options.streamline)),this.tailPoints.push(t),h7e(this.tailPoints)>Ql.constants.maxTailLength&&this.stabilizeTail()}}close(){this.stabilizeTail()}stabilizeTail(){if(this.options.simplify>0&&this.options.simplifyPhase=="tail")throw new Error("Not implemented yet");this.stablePoints.push(...this.tailPoints),this.tailPoints=[]}getSize(t,n,i,r,s){return(t??this.options.size)*this.options.sizeMapping({pressure:n,runningLength:s,currentIndex:i,totalLength:r})}getStrokeOutline(t){if(this.isFresh)return[];let n=[...this.stablePoints,...this.tailPoints];this.options.simplify>0&&this.options.simplifyPhase==="input"&&(n=t5(n,this.options.simplify));const i=n.length;if(i===0)return[];if(i===1){const _=n[0],T=this.getSize(t,_[2],0,i,0);if(T<.5)return[];const k=[];for(let x=0;x<=Math.PI*2;x+=Math.PI/16)k.push(vn(_,On(Bi([1,0,0],x),T)));return k.push(vn(_,On([1,0,0],this.getSize(t,_[2],0,i,0)))),k}if(i===2){const _=n[0],T=n[1],k=this.getSize(t,_[2],0,i,0),x=this.getSize(t,T[2],0,i,0);if(k<.5||x<.5)return[];const D=[],O=TD(_,[_[0],_[1]-100,_[2]],T);for(let L=O;L<=Math.PI+O;L+=Math.PI/16)D.push(vn(_,On(Bi([1,0,0],L),k)));for(let L=Math.PI+O;L<=Math.PI*2+O;L+=Math.PI/16)D.push(vn(T,On(Bi([1,0,0],L),x)));return D.push(D[0]),D}const r=[],s=[];let o=0,a=0,l=0,c=0;for(let _=1;_<i-1;_++){const T=n[_-1],k=n[_],x=n[_+1];let D=k[2];const O=_h(T,k);c+=O,o=a+(O-a)*.2;const L=this.getSize(t,D,_,i,c);if(L===0){l=_+1;continue}const Y=mf(Z1(T,k)),$=mf(Z1(x,k)),H=Bi(Y,Math.PI/2),z=Bi(Y,-Math.PI/2),G=Bi($,Math.PI/2),j=Bi($,-Math.PI/2),X=vn(k,On(H,L)),K=vn(k,On(z,L)),ne=vn(k,On(G,L)),se=vn(k,On(j,L)),oe=vn(H,j),Ee=vn(z,G),Re=vn(k,On(SD(oe)===0?Y:mf(oe),L)),De=vn(k,On(SD(Ee)===0?$:mf(Ee),L)),vt=ID(TD(k,T,x)),Vt=Ql.constants.cornerDetectionMaxAngle/180*Math.PI*Ql.constants.cornerDetectionVariance(o);if(Math.abs(vt)<Vt){const Be=Math.abs(ID(Math.PI-vt));if(Be===0)continue;if(vt<0){s.push(K,De);for(let Qe=0;Qe<=Be;Qe+=Be/4)r.push(vn(k,Bi(On(H,L),Qe)));for(let Qe=Be;Qe>=0;Qe-=Be/4)s.push(vn(k,Bi(On(H,L),Qe)));s.push(De,ne)}else{r.push(X,Re);for(let Qe=0;Qe<=Be;Qe+=Be/4)s.push(vn(k,Bi(On(H,-L),-Qe)));for(let Qe=Be;Qe>=0;Qe-=Be/4)r.push(vn(k,Bi(On(H,-L),-Qe)));r.push(Re,se)}}else r.push(Re),s.push(De);a=o}if(l>=i-2)if(this.options.keepHead){const _=n[i-1],T=[];for(let k=0;k<=Math.PI*2;k+=Math.PI/16)T.push(vn(_,On(Bi([1,0,0],k),this.options.size)));return T.push(vn(_,On([1,0,0],this.options.size))),T}else return[];const d=n[l],u=n[l+1],f=n[i-2],h=n[i-1],m=mf(Z1(u,d)),p=mf(Z1(f,h)),U=Bi(m,-Math.PI/2),b=Bi(p,Math.PI/2),y=this.getSize(t,d[2],0,i,0),w=[],v=this.options.keepHead?this.options.size:this.getSize(t,f[2],i-2,i,c),I=[];if(y>1){for(let _=0;_<=Math.PI;_+=Math.PI/16)w.unshift(vn(d,Bi(On(U,y),-_)));w.unshift(vn(d,On(U,-y)))}else w.push(d);for(let _=0;_<=Math.PI*3;_+=Math.PI/16)I.push(vn(h,Bi(On(b,-v),-_)));const C=[...w,...r,...I.reverse(),...s.reverse()];return w.length>0&&C.push(w[0]),this.options.simplify>0&&this.options.simplifyPhase==="output"?t5(C,this.options.simplify):C}};Ql.defaults={size:2,streamline:.45,simplify:.1,simplifyPhase:"output",keepHead:!1,sizeMapping:()=>1},Ql.constants={cornerDetectionMaxAngle:75,cornerDetectionVariance:t=>t>35?.5:1,maxTailLength:50};let n5=Ql;class i5{constructor(t,n,i){F(this,"currentTrail");F(this,"pastTrails",[]);F(this,"container");F(this,"trailElement");F(this,"trailAnimation");this.animationFrameHandler=t,this.app=n,this.options=i,this.animationFrameHandler.register(this,this.onFrame.bind(this)),this.trailElement=document.createElementNS(st,"path"),this.options.animateTrail&&(this.trailAnimation=document.createElementNS(st,"animate"),this.trailAnimation.setAttribute("attributeName","stroke-dashoffset"),this.trailElement.setAttribute("stroke-dasharray","7 7"),this.trailElement.setAttribute("stroke-dashoffset","10"),this.trailAnimation.setAttribute("from","0"),this.trailAnimation.setAttribute("to","-14"),this.trailAnimation.setAttribute("dur","0.3s"),this.trailElement.appendChild(this.trailAnimation))}get hasCurrentTrail(){return!!this.currentTrail}hasLastPoint(t,n){if(this.currentTrail){const i=this.currentTrail.originalPoints.length;return this.currentTrail.originalPoints[i-1][0]===t&&this.currentTrail.originalPoints[i-1][1]===n}return!1}start(t){t&&(this.container=t),this.trailElement.parentNode!==this.container&&this.container&&this.container.appendChild(this.trailElement),this.animationFrameHandler.start(this)}stop(){var t;this.animationFrameHandler.stop(this),this.trailElement.parentNode===this.container&&((t=this.container)==null||t.removeChild(this.trailElement))}startPath(t,n){this.currentTrail=new n5(this.options),this.currentTrail.addPoint([t,n,performance.now()]),this.update()}addPointToPath(t,n){this.currentTrail&&(this.currentTrail.addPoint([t,n,performance.now()]),this.update())}endPath(){this.currentTrail&&(this.currentTrail.close(),this.currentTrail.options.keepHead=!1,this.pastTrails.push(this.currentTrail),this.currentTrail=void 0,this.update())}getCurrentTrail(){return this.currentTrail}clearTrails(){this.pastTrails=[],this.currentTrail=void 0,this.update()}update(){this.start(),this.trailAnimation&&(this.trailAnimation.setAttribute("begin","indefinite"),this.trailAnimation.setAttribute("repeatCount","indefinite"))}onFrame(){const t=[];for(const i of this.pastTrails)t.push(this.drawTrail(i,this.app.state));if(this.currentTrail){const i=this.drawTrail(this.currentTrail,this.app.state);t.push(i)}this.pastTrails=this.pastTrails.filter(i=>i.getStrokeOutline().length!==0),t.length===0&&this.stop();const n=t.join(" ").trim();this.trailElement.setAttribute("d",n),this.trailAnimation?(this.trailElement.setAttribute("fill",(this.options.fill??(()=>"black"))(this)),this.trailElement.setAttribute("stroke",(this.options.stroke??(()=>"black"))(this))):this.trailElement.setAttribute("fill",(this.options.fill??(()=>"black"))(this))}drawTrail(t,n){const i=t.getStrokeOutline(t.options.size/n.zoom.value).map(([s,o])=>{const a=Wr({sceneX:s,sceneY:o},n);return[a.x,a.y]}),r=this.trailAnimation?i.slice(0,i.length/2):i;return aoe(r,!0)}}class p7e{constructor(t,n){F(this,"localTrail");F(this,"collabTrails",new Map);F(this,"container");this.animationFrameHandler=t,this.app=n,this.animationFrameHandler.register(this,this.onFrame.bind(this)),this.localTrail=new i5(t,n,{...this.getTrailOptions(),fill:()=>Ore})}getTrailOptions(){return{simplify:0,streamline:.4,sizeMapping:t=>{const r=Math.max(0,1-(performance.now()-t.pressure)/1e3),s=(50-Math.min(50,t.totalLength-t.currentIndex))/50;return Math.min(cl(s),cl(r))}}}startPath(t,n){this.localTrail.startPath(t,n)}addPointToPath(t,n){this.localTrail.addPointToPath(t,n)}endPath(){this.localTrail.endPath()}start(t){this.container=t,this.animationFrameHandler.start(this),this.localTrail.start(t)}stop(){this.animationFrameHandler.stop(this),this.localTrail.stop()}onFrame(){this.updateCollabTrails()}updateCollabTrails(){if(!(!this.container||this.app.state.collaborators.size===0)){for(const[t,n]of this.app.state.collaborators.entries()){let i;this.collabTrails.has(t)?i=this.collabTrails.get(t):(i=new i5(this.animationFrameHandler,this.app,{...this.getTrailOptions(),fill:()=>{var r;return((r=n.pointer)==null?void 0:r.laserColor)||Ky(t,n)}}),i.start(this.container),this.collabTrails.set(t,i)),n.pointer&&n.pointer.tool==="laser"&&(n.button==="down"&&!i.hasCurrentTrail&&i.startPath(n.pointer.x,n.pointer.y),n.button==="down"&&i.hasCurrentTrail&&!i.hasLastPoint(n.pointer.x,n.pointer.y)&&i.addPointToPath(n.pointer.x,n.pointer.y),n.button==="up"&&i.hasCurrentTrail&&(i.addPointToPath(n.pointer.x,n.pointer.y),i.endPath()))}for(const t of this.collabTrails.keys())this.app.state.collaborators.has(t)||(this.collabTrails.get(t).stop(),this.collabTrails.delete(t))}}}const an=e=>t=>{mi.unstable_batchedUpdates(e,t)},N3=e=>vp(t=>{mi.unstable_batchedUpdates(e,t)}),r5=(()=>{let e;try{const n=R.version.split(".");e=Number(n[0])>17}catch{e=!1}let t=!1;return()=>window.EXCALIDRAW_THROTTLE_RENDER===!0?e?!0:(t||(t=!0,console.warn("Excalidraw: render throttling is disabled on React versions < 18.")),!1):!1})(),U7e=(e,t,n,i,r,s)=>{const{zoom:o}=i,a=180*n/Math.PI;let l=e*(o.value-1)/2,c=t*(o.value-1)/2;return e>r&&o.value!==1&&(l=r*(o.value-1)/2),t>s&&o.value!==1&&(c=s*(o.value-1)/2),`translate(${l}px, ${c}px) scale(${o.value}) rotate(${a}deg)`},b7e=({id:e,onChange:t,onSubmit:n,getViewportCoords:i,element:r,canvas:s,excalidrawContainer:o,app:a,autoSelect:l=!0})=>{const c=($,H)=>{if(!H.style.fontFamily||!H.style.fontSize)return!1;const z=H.style.fontFamily.replace(/"/g,"");return Ep({fontFamily:$.fontFamily})!==z||`${$.fontSize}px`!==H.style.fontSize},d=()=>{const $=a.state,H=a.scene.getElement(e);if(!H)return;const{textAlign:z,verticalAlign:G}=H,j=a.scene.getNonDeletedElementsMap();if(H&&ge(H)){let X=H.x,K=H.y;const ne=Yn(H,a.scene.getNonDeletedElementsMap());let se=H.width,oe=H.height,Ee=H.width,Re=H.height;if(ne&&H.containerId){if(Ce(ne)){const li=pe.getBoundTextElementPosition(ne,H,j);X=li.x,K=li.y}const Qe=c(H,u);let $t;if(Qe?$t=f6(ne.id,ne.height):($t=$h[ne.id],$t||($t=f6(ne.id,ne.height))),Ee=ta(ne,H),Re=Ap(ne,H),!Ce(ne)&&oe>Re){const li=bu(oe,ne.type);a.scene.mutateElement(ne,{height:li});return}else if(!Ce(ne)&&ne.height>$t.height&&oe<Re){const li=bu(oe,ne.type);a.scene.mutateElement(ne,{height:li})}else{const{x:li,y:Al}=ld(ne,H,j);X=li,K=Al}}const[De,vt]=i(X,K);ne?se+=.5:(Ee=($.width-8-De)/$.zoom.value,se=Math.min(se,Ee)),oe*=1.05;const Vt=mt(H),Be=($.height-vt)/$.zoom.value;Object.assign(u.style,{font:Vt,lineHeight:H.lineHeight,width:`${se}px`,height:`${oe}px`,left:`${De}px`,top:`${vt}px`,transform:U7e(se,oe,Vae(H,ne),$,Ee,Be),textAlign:z,verticalAlign:G,color:H.strokeColor,opacity:H.opacity/100,filter:"var(--theme-filter)",maxHeight:`${Be}px`}),u.scrollTop=0,a.scene.mutateElement(H,{x:X,y:K})}},u=document.createElement("textarea");u.dir="auto",u.tabIndex=0,u.dataset.type="wysiwyg",u.wrap="off",u.classList.add("excalidraw-wysiwyg");let f="pre",h="normal";(Dt(r)||!r.autoResize)&&(f="pre-wrap",h="break-word"),Object.assign(u.style,{position:"absolute",display:"inline-block",minHeight:"1em",backfaceVisibility:"hidden",margin:0,padding:0,border:0,outline:0,resize:"none",background:"transparent",overflow:"hidden",zIndex:"var(--zIndex-wysiwyg)",wordBreak:h,whiteSpace:f,overflowWrap:"break-word",boxSizing:"content-box"}),u.value=r.originalText,d(),t&&(u.onpaste=async $=>{const H=(await Sv($)).findByType(Te.text);if(!H)return;const z=Gh(H.value);if(!z)return;const G=Yn(r,a.scene.getNonDeletedElementsMap()),j=mt({fontSize:a.state.currentItemFontSize,fontFamily:a.state.currentItemFontFamily});if(G){const X=Le(G,a.scene.getNonDeletedElementsMap()),K=ad(`${u.value}${z}`,j,ta(G,X)),ne=l9(K,j);u.style.width=`${ne}px`}},u.oninput=()=>{const $=Gh(u.value);if(u.value!==$){const H=u.selectionStart;u.value=$,u.selectionStart=H,u.selectionEnd=H}t(u.value)}),u.onkeydown=$=>{if(!$.shiftKey&&Vk.keyTest($))$.preventDefault(),a.actionManager.executeAction(Vk),d();else if(!$.shiftKey&&$k.keyTest($))$.preventDefault(),a.actionManager.executeAction($k),d();else if(!$.shiftKey&&Gk.keyTest($))$.preventDefault(),a.actionManager.executeAction(Gk),d();else if(Fk.keyTest($))a.actionManager.executeAction(Fk);else if(Bk.keyTest($))a.actionManager.executeAction(Bk);else if($.key===V.ESCAPE)$.preventDefault(),I=!0,C();else if(q6.keyTest($))$.preventDefault(),C(),a.actionManager.executeAction(q6);else if($.key===V.ENTER&&$[V.CTRL_OR_CMD]){if($.preventDefault(),$.isComposing||$.keyCode===229)return;I=!0,C()}else if($.key===V.TAB||$[V.CTRL_OR_CMD]&&($.code===it.BRACKET_LEFT||$.code===it.BRACKET_RIGHT)){if($.preventDefault(),$.isComposing)return;$.shiftKey||$.code===it.BRACKET_LEFT?y():b(),u.dispatchEvent(new Event("input"))}};const m=4,p=" ".repeat(m),U=new RegExp(`^ {1,${m}}`),b=()=>{const{selectionStart:$,selectionEnd:H}=u,z=w();let G=u.value;z.forEach(j=>{const X=G.slice(0,j),K=G.slice(j);G=`${X}${p}${K}`}),u.value=G,u.selectionStart=$+m,u.selectionEnd=H+m*z.length},y=()=>{const{selectionStart:$,selectionEnd:H}=u,z=w(),G=[];let j=u.value;z.forEach(X=>{const K=j.slice(X,X+m).match(U);if(K){const ne=j.slice(0,X),se=j.slice(X+K[0].length);j=`${ne}${se}`,G.push(X)}}),u.value=j,G.length&&($>G[G.length-1]?u.selectionStart=Math.max($-m,G[G.length-1]):u.selectionStart=$,u.selectionEnd=Math.max(u.selectionStart,H-m*G.length))},w=()=>{let{selectionStart:$,selectionEnd:H,value:z}=u;const G=z.slice(0,$).match(/[^\n]*$/)[0].length;return $=$-G,z.slice($,H).split(`
`).reduce((X,K,ne,se)=>X.concat(ne?X[ne-1]+se[ne-1].length+1:$),[]).reverse()},v=$=>{$.target instanceof HTMLCanvasElement&&($.preventDefault(),$.stopPropagation())};let I=!1;const C=()=>{var z;if(L)return;L=!0,_();const $=a.scene.getElement(r.id);if(!$)return;const H=Yn($,a.scene.getNonDeletedElementsMap());if(H){if(u.value.trim()){const G=ea(H);!G||G!==r.id?a.scene.mutateElement(H,{boundElements:(H.boundElements||[]).concat({type:"text",id:r.id})}):Ce(H)&&Pa(H)}else a.scene.mutateElement(H,{boundElements:(z=H.boundElements)==null?void 0:z.filter(G=>!ge(G))});Qi($,H,a.scene)}n({viaKeyboard:I,nextOriginalText:u.value})},_=()=>{u.onblur=null,u.oninput=null,u.onkeydown=null,Y&&Y.disconnect(),window.removeEventListener("resize",d),window.removeEventListener("wheel",v,!0),window.removeEventListener("pointerdown",x),window.removeEventListener("pointerup",T),window.removeEventListener("blur",C),window.removeEventListener("beforeunload",C),D(),O(),u.remove()},T=$=>{window.removeEventListener("pointerup",T);const H=$==null?void 0:$.target,z=H instanceof HTMLElement&&H.classList.contains("properties-trigger"),G=(H instanceof HTMLElement||H instanceof SVGElement)&&!!H.closest(".properties-content"),j=(H instanceof HTMLElement||H instanceof SVGElement)&&(!!H.closest(`.${Jr.SHAPE_ACTIONS_MENU}`)||!!H.closest(".compact-shape-actions-island"));setTimeout(()=>{j||z||G||(u.onblur=C,u.focus())})},k=()=>{u.onblur=null,window.addEventListener("pointerup",T),window.addEventListener("blur",C)},x=$=>{const H=$==null?void 0:$.target;if($.button===Vl.WHEEL){H instanceof HTMLTextAreaElement&&($.preventDefault(),a.handleCanvasPanUsingWheelOrSpaceDrag($)),k();return}const z=H instanceof HTMLElement&&H.classList.contains("properties-trigger"),G=(H instanceof HTMLElement||H instanceof SVGElement)&&!!H.closest(".properties-content");($.target instanceof HTMLElement||$.target instanceof SVGElement)&&($.target.closest(`.${Jr.SHAPE_ACTIONS_MENU}, .${Jr.ZOOM_ACTIONS}`)||$.target.closest(".compact-shape-actions-island"))&&!Na($.target)||z||G?k():$.target instanceof HTMLCanvasElement&&requestAnimationFrame(()=>{C()})},D=a.scene.onUpdate(()=>{var H;d(),!!((H=document.activeElement)!=null&&H.closest(".properties-content"))||u.focus()}),O=a.onScrollChangeEmitter.on(()=>{d()});let L=!1;l&&u.select(),T();let Y=null;return s&&"ResizeObserver"in window?(Y=new window.ResizeObserver(()=>{d()}),Y.observe(s)):window.addEventListener("resize",d),u.onpointerdown=$=>$.stopPropagation(),requestAnimationFrame(()=>{window.addEventListener("pointerdown",x,{capture:!0})}),window.addEventListener("beforeunload",C),o==null||o.querySelector(".excalidraw-textEditorContainer").appendChild(u),C},Xl=4,Ao=6,y7e="rgba(0,0,0,0.3)",E7e=(e,t,n,i)=>{if(!e.size)return{horizontal:null,vertical:null};const[r,s,o,a]=ht(e),l=t/i.zoom.value,c=n/i.zoom.value,d={top:parseInt(zU("sat"))||0,bottom:parseInt(zU("sab"))||0,left:parseInt(zU("sal"))||0,right:parseInt(zU("sar"))||0},u=vm().rtl,f=-i.scrollX+d.left,h=-i.scrollY+d.top,m=f+l-d.right,p=h+c-d.bottom,U=Math.min(r,f),b=Math.min(s,h),y=Math.max(o,m),w=Math.max(a,p),v=o-r,I=a-s,C=y-U,_=w-b,T=Math.max(Xl*2,d.left+d.right)+Ao*2,k=t*(l/C)-T,x=Math.max(Xl*2,d.top+d.bottom)+Ao*2,D=n*(c/_)-x,O=C>v?C*i.zoom.value/(k+T):t/(k+T),L=_>I?_*i.zoom.value/(D+x):n/(D+x);return{horizontal:f===U&&m===y?null:{x:Math.max(d.left,Xl)+Ao+(f-U)/C*t,y:n-Ao-Math.max(Xl,d.bottom),width:k,height:Ao,deltaMultiplier:O},vertical:h===b&&p===w?null:{x:u?Math.max(d.left,Xl):t-Ao-Math.max(d.right,Xl),y:Math.max(d.top,Xl)+Ao+(h-b)/_*n,width:Ao,height:D,deltaMultiplier:L}}},xD=(e,t,n)=>{const[i,r]=[e.horizontal,e.vertical].map(o=>o!=null&&o.x<=t&&t<=o.x+o.width&&o.y<=n&&n<=o.y+o.height);return{isOverEither:i||r,isOverHorizontal:i,isOverVertical:r}},v7e=e=>{const t=["flowchart","graph","sequenceDiagram","classDiagram","stateDiagram","stateDiagram-v2","erDiagram","journey","gantt","pie","quadrantChart","requirementDiagram","gitGraph","C4Context","mindmap","timeline","zenuml","sankey","xychart","block"];return new RegExp(`^(?:%%{.*?}%%[\\s\\n]*)?\\b(?:${t.map(i=>`\\s*${i}(-beta)?`).join("|")})\\b`).test(e.trim())};function O3(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function w7e(e,t,n){const i=O3(t,n);if(i===0)return O3(e,t);let r=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/i;return r=Math.max(0,Math.min(1,r)),O3(e,_7e(t,n,r))}function _7e(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function T7e(e,t){return zv(e,0,e.length,t)}function zv(e,t,n,i,r){const s=r||[],o=e[t],a=e[n-1];let l=0,c=1;for(let d=t+1;d<n-1;++d){const u=w7e(e[d],o,a);u>l&&(l=u,c=d)}return Math.sqrt(l)>i?(zv(e,t,c+1,i,s),zv(e,c,n,i,s)):(s.length||s.push(o),s.push(a)),s}const I7e=e=>{const{lassoPath:t,elements:n,elementsMap:i,elementsSegments:r,intersectedElements:s,enclosedElements:o,simplifyDistance:a}=e;let l=t;a&&(l=T7e(t,a));const c=n.filter(f=>!f.locked);o.clear(),s.clear();const d=t.reduce((f,h)=>[Math.min(f[0],h[0]),Math.min(f[1],h[1]),Math.max(f[2],h[0]),Math.max(f[3],h[1])],[1/0,1/0,-1/0,-1/0]);for(const f of c){const h=si(f,i);Gu(d,h)&&!s.has(f.id)&&!o.has(f.id)&&(S7e(l,f,r)?o.add(f.id):x7e(l,f,i)&&s.add(f.id))}return{selectedElementIds:[...s,...o]}},S7e=(e,t,n)=>{const i=r6(e),r=n.get(t.id);return r?r.some(s=>s.some(o=>PB(o,i))):!1},x7e=(e,t,n)=>{const i=e.slice(1).map((s,o)=>Me(e[o],s)).concat([Me(e[e.length-1],e[0])]),r=Le(t,n);return i.some(s=>Xo(t,n,s,0,!0).length>0||!!r&&Xo({...r,...ld(t,r,n)},n,s,0,!0).length>0)};class C7e extends i5{constructor(n,i){super(n,i,{animateTrail:!0,streamline:.4,sizeMapping:r=>{const a=Math.max(0,1-(performance.now()-r.pressure)/(1/0)),l=(5e3-Math.min(5e3,r.totalLength-r.currentIndex))/5e3;return Math.min(cl(l),cl(a))},fill:()=>"rgba(105,101,219,0.05)",stroke:()=>"rgba(105,101,219)"});F(this,"intersectedElements",new Set);F(this,"enclosedElements",new Set);F(this,"elementsSegments",null);F(this,"canvasTranslate",null);F(this,"keepPreviousSelection",!1);F(this,"selectElementsFromIds",n=>{this.app.setState(i=>{const r=n.reduce((l,c)=>(l[c]=!0,l),{});if(this.keepPreviousSelection)for(const l of Object.keys(i.selectedElementIds))r[l]=!0;for(const[l]of Object.entries(r)){const c=this.app.scene.getNonDeletedElement(l);if(c&&ge(c)){const d=Yn(c,this.app.scene.getNonDeletedElementsMap());d&&(r[d.id]=!0,delete r[c.id])}}for(const[l]of Object.entries(r)){const c=this.app.scene.getNonDeletedElement(l);if(c&&we(c)){const d=ns(this.app.scene.getNonDeletedElementsMap(),c.id);for(const u of d)delete r[u.id]}}const s=Si({editingGroupId:i.editingGroupId,selectedElementIds:r},this.app.scene.getNonDeletedElements(),i,this.app),o=[...Object.keys(s.selectedElementIds)],a=[...Object.keys(s.selectedGroupIds)];return{selectedElementIds:s.selectedElementIds,selectedGroupIds:s.selectedGroupIds,selectedLinearElement:o.length===1&&!a.length&&xe(this.app.scene.getNonDeletedElement(o[0]))?new pe(this.app.scene.getNonDeletedElement(o[0]),this.app.scene.getNonDeletedElementsMap()):null}})});F(this,"addPointToPath",(n,i,r=!1)=>{super.addPointToPath(n,i),this.keepPreviousSelection=r,this.updateSelection()});F(this,"updateSelection",()=>{var r,s;const n=(s=(r=super.getCurrentTrail())==null?void 0:r.originalPoints)==null?void 0:s.map(o=>S(o[0],o[1])),i={scrollX:this.app.state.scrollX,scrollY:this.app.state.scrollY,zoom:this.app.state.zoom.value};if(!this.elementsSegments||!Ki(i,this.canvasTranslate??{})){this.canvasTranslate=i,this.elementsSegments=new Map;const o=ve(this.app.visibleElements);for(const a of this.app.visibleElements){const l=x6(a,o);this.elementsSegments.set(a.id,l)}}if(n){const{selectedElementIds:o}=I7e({lassoPath:n,elements:this.app.visibleElements,elementsMap:this.app.scene.getNonDeletedElementsMap(),elementsSegments:this.elementsSegments,intersectedElements:this.intersectedElements,enclosedElements:this.enclosedElements,simplifyDistance:5/this.app.state.zoom.value});this.selectElementsFromIds(o)}})}startPath(n,i,r=!1){this.endPath(),super.startPath(n,i),this.intersectedElements.clear(),this.enclosedElements.clear(),this.keepPreviousSelection=r,this.keepPreviousSelection||this.app.setState({selectedElementIds:{},selectedGroupIds:{},selectedLinearElement:null})}endPath(){super.endPath(),super.clearTrails(),this.intersectedElements.clear(),this.enclosedElements.clear(),this.elementsSegments=null}}class A7e extends i5{constructor(n,i){super(n,i,{streamline:.2,size:5,keepHead:!0,sizeMapping:r=>{const a=Math.max(0,1-(performance.now()-r.pressure)/200),l=(10-Math.min(10,r.totalLength-r.currentIndex))/10;return Math.min(cl(l),cl(a))},fill:()=>i.state.theme===ke.LIGHT?"rgba(0, 0, 0, 0.2)":"rgba(255, 255, 255, 0.2)"});F(this,"elementsToErase",new Set);F(this,"groupsToErase",new Set)}startPath(n,i){this.endPath(),super.startPath(n,i),this.elementsToErase.clear()}addPointToPath(n,i,r=!1){return super.addPointToPath(n,i),this.updateElementsToBeErased(r)}updateElementsToBeErased(n){var a,l;const i=((l=(a=super.getCurrentTrail())==null?void 0:a.originalPoints)==null?void 0:l.map(c=>S(c[0],c[1])))||[];if(i.length<2)return[];const r=Me(i[i.length-1],i[i.length-2]),s=this.app.visibleElements.filter(c=>!c.locked),o=ve(s);for(const c of s)if(n&&this.elementsToErase.has(c.id)){if(CD(r,c,o,this.app.state.zoom.value)){const u=c.groupIds.at(-1);if(this.groupsToErase.has(u)){const f=At(this.app.scene.getNonDeletedElementsMap(),u);for(const h of f)this.elementsToErase.delete(h.id);this.groupsToErase.delete(u)}if(Dt(c)&&this.elementsToErase.delete(c.containerId),Li(c)){const f=ea(c);f&&this.elementsToErase.delete(f)}this.elementsToErase.delete(c.id)}}else if(!n&&!this.elementsToErase.has(c.id)&&CD(r,c,o,this.app.state.zoom.value)){const u=c.groupIds.at(-1);if(!this.groupsToErase.has(u)){const f=At(this.app.scene.getNonDeletedElementsMap(),u);for(const h of f)this.elementsToErase.add(h.id);this.groupsToErase.add(u)}if(Li(c)){const f=ea(c);f&&this.elementsToErase.add(f)}Dt(c)&&this.elementsToErase.add(c.containerId),this.elementsToErase.add(c.id)}return Array.from(this.elementsToErase)}endPath(){super.endPath(),super.clearTrails(),this.elementsToErase.clear(),this.groupsToErase.clear()}}const CD=(e,t,n,i)=>{const r=e[1],s=qi(t)?15:t.strokeWidth/2,o=[Math.min(e[0][0],e[1][0])-s,Math.min(e[0][1],e[1][1])-s,Math.max(e[0][0],e[1][0])+s,Math.max(e[0][1],e[1][1])+s],a=si(t,n),l=[a[0]-s,a[1]-s,a[2]+s,a[3]+s];if(!Gu(o,l))return!1;if(h6(t)&&d9(r,t,n))return!0;if(qi(t)){const d=qz(t),u=cce(t,d,n),f=Math.max(2.25,5/i);for(const m of u)if(xA(m,e)<=f)return!0;const h=T4(...d.map(([m,p])=>S(t.x+m,t.y+p)));return!!PB(e[0],h)}const c=Le(t,n);if(Ce(t)||nn(t)&&!t.polygon){const d=Math.max(t.strokeWidth,t.strokeWidth*2/i),u=x6(t,n);for(const f of u)if(xA(f,e)<=d)return!0;return!1}return Xo(t,n,e,0,!0).length>0||!!c&&Xo({...c,...ld(t,c,n)},n,e,0,!0).length>0},M7e=()=>N("div",{"data-testid":"brave-measure-text-error",children:[g("p",{children:g(xr,{i18nKey:"errors.brave_measure_text_error.line1",bold:e=>g("span",{style:{fontWeight:600},children:e})})}),g("p",{children:g(xr,{i18nKey:"errors.brave_measure_text_error.line2",bold:e=>g("span",{style:{fontWeight:600},children:e})})}),g("p",{children:g(xr,{i18nKey:"errors.brave_measure_text_error.line3",link:e=>g("a",{href:"http://docs.excalidraw.com/docs/@excalidraw/excalidraw/faq#turning-off-aggresive-block-fingerprinting-in-brave-browser",children:e})})}),g("p",{children:g(xr,{i18nKey:"errors.brave_measure_text_error.line4",issueLink:e=>g("a",{href:"https://github.com/excalidraw/excalidraw/issues/new",children:e}),discordLink:e=>N("a",{href:"https://discord.gg/UexuTaE",children:[e,"."]})})})]}),k7e=({children:e,left:t,top:n,onCloseRequest:i,fitInViewport:r=!1,offsetLeft:s=0,offsetTop:o=0,viewportWidth:a=window.innerWidth,viewportHeight:l=window.innerHeight,className:c})=>{const d=R.useRef(null);R.useEffect(()=>{const f=d.current;if(!f)return;f.contains(document.activeElement)||f.focus();const h=m=>{var p,U,b;if(m.key===V.TAB){const y=x4(f),{activeElement:w}=document,v=y.findIndex(I=>I===w);w===f?(m.shiftKey?(p=y[y.length-1])==null||p.focus():y[0].focus(),m.preventDefault(),m.stopImmediatePropagation()):v===0&&m.shiftKey?((U=y[y.length-1])==null||U.focus(),m.preventDefault(),m.stopImmediatePropagation()):v===y.length-1&&!m.shiftKey&&((b=y[0])==null||b.focus(),m.preventDefault(),m.stopImmediatePropagation())}};return f.addEventListener("keydown",h),()=>f.removeEventListener("keydown",h)},[]);const u=R.useRef(null);return R.useLayoutEffect(()=>{var f,h;if(r&&d.current&&n!=null&&t!=null){const m=d.current,{width:p,height:U}=m.getBoundingClientRect();if(((f=u.current)==null?void 0:f.top)===n&&((h=u.current)==null?void 0:h.left)===t)return;u.current={top:n,left:t},p>=a?(m.style.width=`${a}px`,m.style.left="0px",m.style.overflowX="scroll"):t+p-s>a?m.style.left=`${a-p-10}px`:m.style.left=`${t}px`,U>=l?(m.style.height=`${l-20}px`,m.style.top="10px",m.style.overflowY="scroll"):n+U-o>l?m.style.top=`${l-U}px`:m.style.top=`${n}px`}},[n,t,r,a,l,s,o]),R.useEffect(()=>{if(i){const f=h=>{var m;(m=d.current)!=null&&m.contains(h.target)||mi.unstable_batchedUpdates(()=>i(h))};return document.addEventListener("pointerdown",f,!1),()=>document.removeEventListener("pointerdown",f,!1)}},[i]),g("div",{className:le("popover",c),ref:d,tabIndex:-1,children:e})},qn="separator",R7e=de.memo(({actionManager:e,items:t,top:n,left:i,onClose:r})=>{const s=Gp(),o=sE(),a=t.reduce((l,c)=>(c&&(c===qn||!c.predicate||c.predicate(o,s,e.app.props,e.app))&&l.push(c),l),[]);return g(k7e,{onCloseRequest:()=>{r()},top:n,left:i,fitInViewport:!0,offsetLeft:s.offsetLeft,offsetTop:s.offsetTop,viewportWidth:s.width,viewportHeight:s.height,className:"context-menu-popover",children:g("ul",{className:"context-menu",onContextMenu:l=>l.preventDefault(),children:a.map((l,c)=>{var f;if(l===qn)return!a[c-1]||a[c-1]===qn?null:g("hr",{className:"context-menu-item-separator"},c);const d=l.name;let u="";return l.label&&(typeof l.label=="function"?u=M(l.label(o,s,e.app)):u=M(l.label)),g("li",{"data-testid":d,onClick:()=>{r(()=>{e.executeAction(l,"contextMenu")})},children:N("button",{type:"button",className:le("context-menu-item",{dangerous:d==="deleteSelectedElements",checkmark:(f=l.checked)==null?void 0:f.call(l,s)}),children:[g("div",{className:"context-menu-item__label",children:u}),g("kbd",{className:"context-menu-item__shortcut",children:d?Zi(d):""})]})},c)})})})}),D7e=({height:e,width:t,userToFollow:n,onDisconnect:i})=>g("div",{className:"follow-mode",style:{width:t,height:e},children:N("div",{className:"follow-mode__badge",children:[N("div",{className:"follow-mode__badge__label",children:["Following"," ",g("span",{className:"follow-mode__badge__username",title:n.username,children:n.username})]}),g("button",{type:"button",onClick:i,className:"follow-mode__disconnect-btn",children:ju})]})}),Tj=({delay:e,theme:t})=>{const[n,i]=R.useState(!!e);return R.useEffect(()=>{if(!e)return;const r=setTimeout(()=>{i(!1)},e);return()=>clearTimeout(r)},[e]),n?null:N("div",{className:le("LoadingMessage",{"LoadingMessage--dark":t===ke.DARK}),children:[g("div",{children:g(hl,{})}),g("div",{className:"LoadingMessage-text",children:M("labels.loadingScene")})]})},L7e="medium",AD={CHECKED:$9,UNCHECKED:by},N7e=e=>N("label",{className:le("ToolIcon ToolIcon__lock",`ToolIcon_size_${L7e}`,{"is-mobile":e.isMobile}),title:`${e.title}  Q`,children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,onChange:e.onChange,checked:e.checked,"aria-label":e.title,"data-testid":"toolbar-lock"}),g("div",{className:"ToolIcon__icon",children:e.checked?AD.CHECKED:AD.UNCHECKED})]}),Ij=e=>g(je,{className:le("Shape",{fillable:!1,active:e.checked}),type:"radio",icon:GV,name:"editor-current-shape",checked:e.checked,title:`${e.title}  H`,keyBindingLabel:e.isMobile?void 0:V.H.toLocaleUpperCase(),"aria-label":`${e.title}  H`,"aria-keyshortcuts":V.H,"data-testid":"toolbar-hand",onChange:()=>{var t;return(t=e.onChange)==null?void 0:t.call(e)}}),P3=[{type:"rectangle",icon:G9,title:kt(M("toolBar.rectangle"))},{type:"diamond",icon:X9,title:kt(M("toolBar.diamond"))},{type:"ellipse",icon:j9,title:kt(M("toolBar.ellipse"))}],F3=[{type:"selection",icon:yy,title:kt(M("toolBar.selection"))},{type:"lasso",icon:M0,title:kt(M("toolBar.lasso"))}],B3=[{type:"arrow",icon:LV,title:kt(M("toolBar.arrow"))},{type:"line",icon:Y9,title:kt(M("toolBar.line"))}],O7e=({app:e,onHandToolToggle:t,setAppState:n})=>{const i=e.state.activeTool,[r,s]=R.useState(!1),[o,a]=R.useState("rectangle"),[l,c]=R.useState("arrow");R.useEffect(()=>{(i.type==="rectangle"||i.type==="diamond"||i.type==="ellipse")&&a(i.type)},[i.type]),R.useEffect(()=>{(i.type==="arrow"||i.type==="line")&&c(i.type)},[i.type]);const d=i.type==="frame",u=i.type==="laser",f=i.type==="embeddable",{TTDDialogTriggerTunnel:h}=er(),m=(O,L)=>{e.state.activeTool.type!==O&&et("toolbar",O,"ui"),O==="selection"?e.state.activeTool.type==="selection"||e.setActiveTool({type:"selection"}):e.setActiveTool({type:O})},[p,U]=R.useState(0),b=36,y=4,w=7,v=w*b+(w-1)*y,I=b+y,C=p>=v+1*I,_=p>=v+2*I,T=p>=v+3*I,x=["text","frame","embeddable","laser","magicframe"].filter(O=>!(C&&O==="text"||_&&O==="image"||T&&O==="frame")).includes(i.type),D=x?i.type==="text"?Uh:i.type==="image"?j2:i.type==="frame"?nu:i.type==="embeddable"?L6:i.type==="laser"?_m:i.type==="magicframe"?O6:cv:cv;return N("div",{className:"mobile-toolbar",ref:O=>{O&&U(O.getBoundingClientRect().width)},children:[g(Ij,{checked:Qh(e.state),onChange:t,title:M("toolBar.hand"),isMobile:!0}),g(ab,{app:e,options:F3,activeTool:i,defaultOption:e.state.preferredSelectionTool.type,namePrefix:"selectionType",title:kt(M("toolBar.selection")),"data-testid":"toolbar-selection",onToolChange:O=>{(O==="selection"||O==="lasso")&&(e.setActiveTool({type:O}),n({preferredSelectionTool:{type:O,initialized:!0}}))},displayedOption:F3.find(O=>O.type===e.state.preferredSelectionTool.type)||F3[0]}),g(je,{className:le({active:i.type==="freedraw"}),type:"radio",icon:Lp,checked:i.type==="freedraw",name:"editor-current-shape",title:`${kt(M("toolBar.freedraw"))}`,"aria-label":kt(M("toolBar.freedraw")),"data-testid":"toolbar-freedraw",onChange:()=>m("freedraw")}),g(je,{className:le({active:i.type==="eraser"}),type:"radio",icon:NV,checked:i.type==="eraser",name:"editor-current-shape",title:`${kt(M("toolBar.eraser"))}`,"aria-label":kt(M("toolBar.eraser")),"data-testid":"toolbar-eraser",onChange:()=>m("eraser")}),g(ab,{app:e,options:P3,activeTool:i,defaultOption:o,namePrefix:"shapeType",title:kt(M(o==="rectangle"?"toolBar.rectangle":o==="diamond"?"toolBar.diamond":o==="ellipse"?"toolBar.ellipse":"toolBar.rectangle")),"data-testid":"toolbar-rectangle",onToolChange:O=>{(O==="rectangle"||O==="diamond"||O==="ellipse")&&(a(O),e.setActiveTool({type:O}))},displayedOption:P3.find(O=>O.type===o)||P3[0]}),g(ab,{app:e,options:B3,activeTool:i,defaultOption:l,namePrefix:"linearElementType",title:kt(M(l==="arrow"?"toolBar.arrow":"toolBar.line")),"data-testid":"toolbar-arrow",fillable:!0,onToolChange:O=>{(O==="arrow"||O==="line")&&(c(O),e.setActiveTool({type:O}))},displayedOption:B3.find(O=>O.type===l)||B3[0]}),C&&g(je,{className:le({active:i.type==="text"}),type:"radio",icon:Uh,checked:i.type==="text",name:"editor-current-shape",title:`${kt(M("toolBar.text"))}`,"aria-label":kt(M("toolBar.text")),"data-testid":"toolbar-text",onChange:()=>m("text")}),_&&g(je,{className:le({active:i.type==="image"}),type:"radio",icon:j2,checked:i.type==="image",name:"editor-current-shape",title:`${kt(M("toolBar.image"))}`,"aria-label":kt(M("toolBar.image")),"data-testid":"toolbar-image",onChange:()=>m("image")}),T&&g(je,{className:le({active:d}),type:"radio",icon:nu,checked:d,name:"editor-current-shape",title:`${kt(M("toolBar.frame"))}`,"aria-label":kt(M("toolBar.frame")),"data-testid":"toolbar-frame",onChange:()=>m("frame")}),N(Ve,{open:r,placement:"top",children:[g(Ve.Trigger,{className:le("App-toolbar__extra-tools-trigger App-toolbar__extra-tools-trigger--mobile",{"App-toolbar__extra-tools-trigger--selected":x||r}),onToggle:()=>{s(!r),n({openMenu:null,openPopup:null})},title:M("toolBar.extraTools"),style:{width:b,height:b,display:"flex",alignItems:"center",justifyContent:"center"},children:D}),N(Ve.Content,{onClickOutside:()=>s(!1),onSelect:()=>s(!1),className:"App-toolbar__extra-tools-dropdown",children:[!C&&g(Ve.Item,{onSelect:()=>e.setActiveTool({type:"text"}),icon:Uh,shortcut:V.T.toLocaleUpperCase(),"data-testid":"toolbar-text",selected:i.type==="text",children:M("toolBar.text")}),!_&&g(Ve.Item,{onSelect:()=>e.setActiveTool({type:"image"}),icon:j2,"data-testid":"toolbar-image",selected:i.type==="image",children:M("toolBar.image")}),!T&&g(Ve.Item,{onSelect:()=>e.setActiveTool({type:"frame"}),icon:nu,shortcut:V.F.toLocaleUpperCase(),"data-testid":"toolbar-frame",selected:d,children:M("toolBar.frame")}),g(Ve.Item,{onSelect:()=>e.setActiveTool({type:"embeddable"}),icon:L6,"data-testid":"toolbar-embeddable",selected:f,children:M("toolBar.embeddable")}),g(Ve.Item,{onSelect:()=>e.setActiveTool({type:"laser"}),icon:_m,"data-testid":"toolbar-laser",selected:u,shortcut:V.K.toLocaleUpperCase(),children:M("toolBar.laser")}),g("div",{style:{margin:"6px 0",fontSize:14,fontWeight:600},children:"Generate"}),e.props.aiEnabled!==!1&&g(h.Out,{}),g(Ve.Item,{onSelect:()=>e.setOpenDialog({name:"ttd",tab:"mermaid"}),icon:J9,"data-testid":"toolbar-embeddable",children:M("toolBar.mermaidToExcalidraw")}),e.props.aiEnabled!==!1&&e.plugins.diagramToCode&&g(fe,{children:N(Ve.Item,{onSelect:()=>e.onMagicframeToolSelect(),icon:O6,"data-testid":"toolbar-magicframe",children:[M("toolBar.magicframe"),g(Ve.Item.Badge,{children:"AI"})]})})]})]})]})},Sj=({children:e,side:t,className:n})=>g("div",{className:le("FixedSideContainer",`FixedSideContainer_side_${t}`,n),children:e}),P7e="medium",xj=e=>e.penDetected?N("label",{className:le("ToolIcon ToolIcon__penMode",`ToolIcon_size_${P7e}`,{"is-mobile":e.isMobile}),title:`${e.title}`,children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,onChange:e.onChange,checked:e.checked,"aria-label":e.title}),g("div",{className:"ToolIcon__icon",children:Mue})]}):null,F7e=({appState:e,elements:t,actionManager:n,setAppState:i,onHandToolToggle:r,renderTopLeftUI:s,renderTopRightUI:o,renderSidebars:a,renderWelcomeScreen:l,UIOptions:c,app:d,onPenModeToggle:u})=>{var b;const{WelcomeScreenCenterTunnel:f,MainMenuTunnel:h,DefaultSidebarTriggerTunnel:m}=er(),p=()=>{var v;if(((v=e.openDialog)==null?void 0:v.name)==="elementLinkSelector")return null;const y=N("div",{className:"excalidraw-ui-top-right",children:[(o==null?void 0:o(!0,e))??(!e.viewModeEnabled&&N(fe,{children:[g(xj,{checked:e.penMode,onChange:()=>u(null),title:M("toolBar.penMode"),isMobile:!0,penDetected:e.penDetected}),g(m.Out,{})]})),e.viewModeEnabled&&g(L3e,{actionManager:n})]}),w=N("div",{className:"excalidraw-ui-top-left",children:[s==null?void 0:s(!0,e),g(h.Out,{})]});return N("div",{className:"App-toolbar-content",style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[w,y]})},U=()=>g(O7e,{app:d,onHandToolToggle:r,setAppState:i});return N(fe,{children:[a(),g("div",{className:"App-welcome-screen",children:l&&g(f.Out,{})}),!e.viewModeEnabled&&N("div",{className:"App-bottom-bar",style:{marginBottom:Ao+Xl},children:[g(A3e,{appState:e,elementsMap:d.scene.getNonDeletedElementsMap(),renderAction:n.renderAction,app:d,setAppState:i}),N(Is,{className:"App-toolbar",children:[!e.viewModeEnabled&&((b=e.openDialog)==null?void 0:b.name)!=="elementLinkSelector"&&U(),e.scrolledOutside&&!e.openMenu&&!e.openSidebar&&g("button",{type:"button",className:"scroll-back-to-content",onClick:()=>{i(y=>({...wm(t,y)}))},children:M("buttons.scrollBackToContent")})]})]}),g(Sj,{side:"top",className:"App-top-bar",children:p()})]})},MD=e=>{const t=R.useRef(null),[n,i]=R.useState(null);return R.useLayoutEffect(()=>{if(!e.spreadsheet)return;const r=Rye(e.chartType,e.spreadsheet,0,0);i(r);let s;const o=t.current;return(async()=>{var a;s=await OT(r,{exportBackground:!1,viewBackgroundColor:yi.white},null,{skipInliningFonts:!0}),(a=s.querySelector(".style-fonts"))==null||a.remove(),o.replaceChildren(),o.appendChild(s),e.selected&&o.parentNode.focus()})(),()=>{o.replaceChildren()}},[e.spreadsheet,e.chartType,e.selected]),g("button",{type:"button",className:"ChartPreview",onClick:()=>{n&&e.onClick(e.chartType,n)},children:g("div",{ref:t})})},B7e=({setAppState:e,appState:t,onClose:n})=>{const{onInsertElements:i}=bo(),r=de.useCallback(()=>{n&&n()},[n]),s=(o,a)=>{i(a),et("paste","chart",o),e({currentChartType:o,pasteDialog:{shown:!1,data:null}})};return g(as,{size:"small",onCloseRequest:r,title:M("labels.pasteCharts"),className:"PasteChartDialog",autofocus:!1,children:N("div",{className:"container",children:[g(MD,{chartType:"bar",spreadsheet:t.pasteDialog.data,selected:t.currentChartType==="bar",onClick:s}),g(MD,{chartType:"line",spreadsheet:t.pasteDialog.data,selected:t.currentChartType==="line",onClick:s})]})})},Hv=({heading:e,children:t,...n})=>{const{id:i}=Dr(),r=g("h2",{className:"visually-hidden",id:`${i}-${e}-title`,children:M(`headings.${e}`)});return g("section",{...n,"aria-labelledby":`${i}-${e}-title`,children:typeof t=="function"?t(r):N(fe,{children:[r,t]})})},z7e=4,H7e=8,V7e=({shouldWrap:e,children:t,username:n})=>e?g(Ul,{label:n||"Unknown user",children:t}):g(fe,{children:t}),z3=({actionManager:e,collaborator:t,socketId:n,withName:i=!1,shouldWrapWithTooltip:r=!1,isBeingFollowed:s})=>{const o={socketId:n,collaborator:t,withName:i,isBeingFollowed:s},a=e.renderAction("goToCollaborator",o);return g(V7e,{username:t.username,shouldWrap:r,children:a},n)},$7e=["avatarUrl","id","socketId","username","isInCall","isSpeaking","isMuted"],Cj=de.memo(({className:e,mobile:t,collaborators:n,userToFollow:i})=>{const r=Lr(),s=new Map;n.forEach((p,U)=>{const b=p.id||U;s.set(b,{...p,socketId:U})});const o=Array.from(s.values()).filter(p=>{var U;return(U=p.username)==null?void 0:U.trim()}),[a,l]=de.useState(""),c=o.filter(p=>{var U;return(U=p.username)==null?void 0:U.toLowerCase().includes(a)}),d=de.useRef(null);R.useLayoutEffect(()=>{if(d.current){const p=b=>{const y=Math.max(1,Math.min(8,Math.floor(b/38)));f(y)};if(p(d.current.clientWidth),!fB)return;const U=new ResizeObserver(b=>{for(const y of b){const{width:w}=y.contentRect;p(w)}});return U.observe(d.current),()=>{U.disconnect()}}},[]);const[u,f]=de.useState(z7e),m=o.slice(0,u-1).map(p=>z3({actionManager:r,collaborator:p,socketId:p.socketId,shouldWrapWithTooltip:!0,isBeingFollowed:p.socketId===i}));return t?g("div",{className:le("UserList UserList_mobile",e),children:o.map(p=>z3({actionManager:r,collaborator:p,socketId:p.socketId,shouldWrapWithTooltip:!0,isBeingFollowed:p.socketId===i}))}):g("div",{className:"UserList__wrapper",ref:d,children:N("div",{className:le("UserList",e),style:{"--max-avatars":u},children:[m,o.length>u-1&&N(Sl,{children:[N(xl,{className:"UserList__more",children:["+",o.length-u+1]}),g(xy,{style:{zIndex:2,width:"15rem",textAlign:"left"},align:"end",sideOffset:10,children:N(Is,{padding:2,children:[o.length>=H7e&&g(J$,{placeholder:M("quickSearch.placeholder"),onChange:l}),g(eG,{className:"dropdown-menu UserList__collaborators",placeholder:M("userList.empty"),children:c.length>0?[g("div",{className:"hint",children:M("userList.hint.text")}),c.map(p=>z3({actionManager:r,collaborator:p,socketId:p.socketId,withName:!0,isBeingFollowed:p.socketId===i}))]:[]}),g(W$,{width:20,height:10,style:{fill:"var(--popup-bg-color)",filter:"drop-shadow(rgba(0, 0, 0, 0.05) 0px 3px 2px)"}})]})})]})]})})},(e,t)=>{if(e.collaborators.size!==t.collaborators.size||e.mobile!==t.mobile||e.className!==t.className||e.userToFollow!==t.userToFollow)return!1;const n=t.collaborators.keys();for(const[i,r]of e.collaborators){const s=t.collaborators.get(i);if(!s||i!==n.next().value||!Ki(r,s,$7e))return!1}return!0}),G7e=e=>g("button",{className:"help-icon",onClick:e.onClick,type:"button",title:`${M("helpDialog.title")}  ?`,"aria-label":M("helpDialog.title"),children:W9}),Aj=({appState:e,actionManager:t,showExitZenModeBtn:n,renderWelcomeScreen:i})=>{const{FooterCenterTunnel:r,WelcomeScreenHelpHintTunnel:s}=er();return N("footer",{role:"contentinfo",className:"layer-ui__wrapper__footer App-menu App-menu_bottom",children:[g("div",{className:le("layer-ui__wrapper__footer-left zen-mode-transition",{"layer-ui__wrapper__footer-left--transition-left":e.zenModeEnabled}),children:g(ja.Col,{gap:2,children:N(Hv,{heading:"canvasActions",children:[g(k3e,{renderAction:t.renderAction,zoom:e.zoom}),!e.viewModeEnabled&&g(R3e,{renderAction:t.renderAction,className:le("zen-mode-transition",{"layer-ui__wrapper__footer-left--transition-bottom":e.zenModeEnabled})})]})})}),g(r.Out,{}),g("div",{className:le("layer-ui__wrapper__footer-right zen-mode-transition",{"transition-right":e.zenModeEnabled}),children:N("div",{style:{position:"relative"},children:[i&&g(s.Out,{}),g(G7e,{onClick:()=>t.executeAction(VT)})]})}),g(D3e,{actionManager:t,showExitZenModeBtn:n})]})};Aj.displayName="Footer";const Mj=de.createContext({}),kj=({children:e,className:t})=>{const n=Nn(),i=R.useContext(Mj),r=!!(n.canFitSidebar&&i.shouldRenderDockButton);return N("div",{className:le("sidebar__header",t),"data-testid":"sidebar-header",children:[e,N("div",{className:"sidebar__header__buttons",children:[r&&g(Ul,{label:M("labels.sidebarLock"),children:g(Kc,{onSelect:()=>{var s;return(s=i.onDock)==null?void 0:s.call(i,!i.docked)},selected:!!i.docked,className:"sidebar__dock","data-testid":"sidebar-dock","aria-label":M("labels.sidebarLock"),children:Iue})}),g(Kc,{"data-testid":"sidebar-close",className:"sidebar__close",onSelect:i.onCloseRequest,"aria-label":M("buttons.close"),children:ju})]})]})};kj.displayName="SidebarHeader";function X7e(e){const t=e+"CollectionProvider",[n,i]=Op(t),[r,s]=n(t,{collectionRef:{current:null},itemMap:new Map}),o=h=>{const{scope:m,children:p}=h,U=de.useRef(null),b=de.useRef(new Map).current;return g(r,{scope:m,itemMap:b,collectionRef:U,children:p})};o.displayName=t;const a=e+"CollectionSlot",l=de.forwardRef((h,m)=>{const{scope:p,children:U}=h,b=s(a,p),y=ho(m,b.collectionRef);return g(Tm,{ref:y,children:U})});l.displayName=a;const c=e+"CollectionItemSlot",d="data-radix-collection-item",u=de.forwardRef((h,m)=>{const{scope:p,children:U,...b}=h,y=de.useRef(null),w=ho(m,y),v=s(c,p);return de.useEffect(()=>(v.itemMap.set(y,{ref:y,...b}),()=>void v.itemMap.delete(y))),g(Tm,{[d]:"",ref:w,children:U})});u.displayName=c;function f(h){const m=s(e+"CollectionConsumer",h);return de.useCallback(()=>{const U=m.collectionRef.current;if(!U)return[];const b=Array.from(U.querySelectorAll(`[${d}]`));return Array.from(m.itemMap.values()).sort((v,I)=>b.indexOf(v.ref.current)-b.indexOf(I.ref.current))},[m.collectionRef,m.itemMap])}return[{Provider:o,Slot:l,ItemSlot:u},f,i]}var j7e=R.createContext(void 0);function Rj(e){const t=R.useContext(j7e);return e||t||"ltr"}var H3="rovingFocusGroup.onEntryFocus",Y7e={bubbles:!1,cancelable:!0},rE="RovingFocusGroup",[Vv,Dj,W7e]=X7e(rE),[K7e,Lj]=Op(rE,[W7e]),[Z7e,q7e]=K7e(rE),Nj=R.forwardRef((e,t)=>g(Vv.Provider,{scope:e.__scopeRovingFocusGroup,children:g(Vv.Slot,{scope:e.__scopeRovingFocusGroup,children:g(Q7e,{...e,ref:t})})}));Nj.displayName=rE;var Q7e=R.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:i,loop:r=!1,dir:s,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:d=!1,...u}=e,f=R.useRef(null),h=ho(t,f),m=Rj(s),[p=null,U]=pT({prop:o,defaultProp:a,onChange:l}),[b,y]=R.useState(!1),w=gl(c),v=Dj(n),I=R.useRef(!1),[C,_]=R.useState(0);return R.useEffect(()=>{const T=f.current;if(T)return T.addEventListener(H3,w),()=>T.removeEventListener(H3,w)},[w]),g(Z7e,{scope:n,orientation:i,dir:m,loop:r,currentTabStopId:p,onItemFocus:R.useCallback(T=>U(T),[U]),onItemShiftTab:R.useCallback(()=>y(!0),[]),onFocusableItemAdd:R.useCallback(()=>_(T=>T+1),[]),onFocusableItemRemove:R.useCallback(()=>_(T=>T-1),[]),children:g(br.div,{tabIndex:b||C===0?-1:0,"data-orientation":i,...u,ref:h,style:{outline:"none",...e.style},onMouseDown:Di(e.onMouseDown,()=>{I.current=!0}),onFocus:Di(e.onFocus,T=>{const k=!I.current;if(T.target===T.currentTarget&&k&&!b){const x=new CustomEvent(H3,Y7e);if(T.currentTarget.dispatchEvent(x),!x.defaultPrevented){const D=v().filter(H=>H.focusable),O=D.find(H=>H.active),L=D.find(H=>H.id===p),$=[O,L,...D].filter(Boolean).map(H=>H.ref.current);Fj($,d)}}I.current=!1}),onBlur:Di(e.onBlur,()=>y(!1))})})}),Oj="RovingFocusGroupItem",Pj=R.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:i=!0,active:r=!1,tabStopId:s,...o}=e,a=oT(),l=s||a,c=q7e(Oj,n),d=c.currentTabStopId===l,u=Dj(n),{onFocusableItemAdd:f,onFocusableItemRemove:h}=c;return R.useEffect(()=>{if(i)return f(),()=>h()},[i,f,h]),g(Vv.ItemSlot,{scope:n,id:l,focusable:i,active:r,children:g(br.span,{tabIndex:d?0:-1,"data-orientation":c.orientation,...o,ref:t,onMouseDown:Di(e.onMouseDown,m=>{i?c.onItemFocus(l):m.preventDefault()}),onFocus:Di(e.onFocus,()=>c.onItemFocus(l)),onKeyDown:Di(e.onKeyDown,m=>{if(m.key==="Tab"&&m.shiftKey){c.onItemShiftTab();return}if(m.target!==m.currentTarget)return;const p=t4e(m,c.orientation,c.dir);if(p!==void 0){if(m.metaKey||m.ctrlKey||m.altKey||m.shiftKey)return;m.preventDefault();let b=u().filter(y=>y.focusable).map(y=>y.ref.current);if(p==="last")b.reverse();else if(p==="prev"||p==="next"){p==="prev"&&b.reverse();const y=b.indexOf(m.currentTarget);b=c.loop?n4e(b,y+1):b.slice(y+1)}setTimeout(()=>Fj(b))}})})})});Pj.displayName=Oj;var J7e={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function e4e(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function t4e(e,t,n){const i=e4e(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return J7e[i]}function Fj(e,t=!1){const n=document.activeElement;for(const i of e)if(i===n||(i.focus({preventScroll:t}),document.activeElement!==n))return}function n4e(e,t){return e.map((n,i)=>e[(t+i)%e.length])}var i4e=Nj,r4e=Pj,ZT="Tabs",[s4e,DAe]=Op(ZT,[Lj]),Bj=Lj(),[o4e,qT]=s4e(ZT),zj=R.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,onValueChange:r,defaultValue:s,orientation:o="horizontal",dir:a,activationMode:l="automatic",...c}=e,d=Rj(a),[u,f]=pT({prop:i,onChange:r,defaultProp:s});return g(o4e,{scope:n,baseId:oT(),value:u,onValueChange:f,orientation:o,dir:d,activationMode:l,children:g(br.div,{dir:d,"data-orientation":o,...c,ref:t})})});zj.displayName=ZT;var Hj="TabsList",Vj=R.forwardRef((e,t)=>{const{__scopeTabs:n,loop:i=!0,...r}=e,s=qT(Hj,n),o=Bj(n);return g(i4e,{asChild:!0,...o,orientation:s.orientation,dir:s.dir,loop:i,children:g(br.div,{role:"tablist","aria-orientation":s.orientation,...r,ref:t})})});Vj.displayName=Hj;var $j="TabsTrigger",Gj=R.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,disabled:r=!1,...s}=e,o=qT($j,n),a=Bj(n),l=Yj(o.baseId,i),c=Wj(o.baseId,i),d=i===o.value;return g(r4e,{asChild:!0,...a,focusable:!r,active:d,children:g(br.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":c,"data-state":d?"active":"inactive","data-disabled":r?"":void 0,disabled:r,id:l,...s,ref:t,onMouseDown:Di(e.onMouseDown,u=>{!r&&u.button===0&&u.ctrlKey===!1?o.onValueChange(i):u.preventDefault()}),onKeyDown:Di(e.onKeyDown,u=>{[" ","Enter"].includes(u.key)&&o.onValueChange(i)}),onFocus:Di(e.onFocus,()=>{const u=o.activationMode!=="manual";!d&&!r&&u&&o.onValueChange(i)})})})});Gj.displayName=$j;var Xj="TabsContent",jj=R.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,forceMount:r,children:s,...o}=e,a=qT(Xj,n),l=Yj(a.baseId,i),c=Wj(a.baseId,i),d=i===a.value,u=R.useRef(d);return R.useEffect(()=>{const f=requestAnimationFrame(()=>u.current=!1);return()=>cancelAnimationFrame(f)},[]),g(Iy,{present:r||d,children:({present:f})=>g(br.div,{"data-state":d?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":l,hidden:!f,id:c,tabIndex:0,...o,ref:t,style:{...e.style,animationDuration:u.current?"0s":void 0},children:f&&s})})});jj.displayName=Xj;function Yj(e,t){return`${e}-trigger-${t}`}function Wj(e,t){return`${e}-content-${t}`}var Kj=zj,Zj=Vj,qj=Gj,Qj=jj;const Jj=({children:e,tab:t,onSelect:n,...i})=>g(qj,{value:t,asChild:!0,onSelect:n,children:g("button",{type:"button",className:"excalidraw-button sidebar-tab-trigger",...i,children:e})});Jj.displayName="SidebarTabTrigger";const eY=({children:e,...t})=>g(Zj,{className:"sidebar-triggers",...t,children:e});eY.displayName="SidebarTabTriggers";const tY=({name:e,tab:t,icon:n,title:i,children:r,onToggle:s,className:o,style:a})=>{var d;const l=xn(),c=ai();return N("label",{title:i,className:"sidebar-trigger__label-element",children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",onChange:u=>{var h;(h=document.querySelector(".layer-ui__wrapper"))==null||h.classList.remove("animate");const f=u.target.checked;l({openSidebar:f?{name:e,tab:t}:null,openMenu:null,openPopup:null}),s==null||s(f)},checked:((d=c.openSidebar)==null?void 0:d.name)===e,"aria-label":i,"aria-keyshortcuts":"0"}),N("div",{className:le("sidebar-trigger",o),style:a,children:[n&&g("div",{children:n}),r&&g("div",{className:"sidebar-trigger__label",children:r})]})]})};tY.displayName="SidebarTrigger";const nY=({children:e,...t})=>{const n=ai(),i=xn();if(!n.openSidebar)return null;const{name:r}=n.openSidebar;return g(Kj,{className:"sidebar-tabs-root",value:n.openSidebar.tab,onValueChange:s=>i(o=>({...o,openSidebar:{...o.openSidebar,name:r,tab:s}})),...t,children:e})};nY.displayName="SidebarTabs";const iY=({tab:e,children:t,...n})=>g(Qj,{...n,value:e,"data-testid":e,children:t});iY.displayName="SidebarTab";const QT=Wt(!1),rY=R.forwardRef(({name:e,children:t,onDock:n,docked:i,className:r,...s},o)=>{const a=xn(),l=py(QT);R.useLayoutEffect(()=>(l(!!i),()=>{l(!1)}),[l,i]);const c=R.useRef({});c.current.onCloseRequest=()=>{a({openSidebar:null})},c.current.onDock=h=>n==null?void 0:n(h),c.current=O2(c.current,{docked:i,shouldRenderDockButton:!!n&&i!=null});const d=R.useRef(null);R.useImperativeHandle(o,()=>d.current);const u=Nn(),f=R.useCallback(()=>{document.querySelector(".Dialog")||a({openSidebar:null})},[a]);return yT(d,R.useCallback(h=>{h.target.closest(".sidebar-trigger")||(!i||!u.canFitSidebar)&&f()},[f,i,u.canFitSidebar])),R.useEffect(()=>{const h=m=>{m.key===V.ESCAPE&&(!i||!u.canFitSidebar)&&f()};return document.addEventListener(te.KEYDOWN,h),()=>{document.removeEventListener(te.KEYDOWN,h)}},[f,i,u.canFitSidebar]),g(Is,{...s,className:le(Jr.SIDEBAR,{"sidebar--docked":i},r),ref:d,children:g(Mj.Provider,{value:c.current,children:t})})});rY.displayName="SidebarInner";const vr=Object.assign(R.forwardRef((e,t)=>{var l;const n=ai(),{onStateChange:i}=e,r=R.useRef(n.openSidebar);R.useEffect(()=>{var c,d,u,f,h;(!n.openSidebar&&((c=r==null?void 0:r.current)==null?void 0:c.name)===e.name||((d=n.openSidebar)==null?void 0:d.name)===e.name&&((u=r==null?void 0:r.current)==null?void 0:u.name)!==e.name||((f=r.current)==null?void 0:f.name)===e.name)&&n.openSidebar!==r.current&&(i==null||i(((h=n.openSidebar)==null?void 0:h.name)!==e.name?null:n.openSidebar)),r.current=n.openSidebar},[n.openSidebar,i,e.name]);const[s,o]=R.useState(!1);return R.useLayoutEffect(()=>(o(!0),()=>o(!1)),[]),s&&((l=n.openSidebar)==null?void 0:l.name)===e.name?R.createElement(rY,{...e,ref:t,key:e.name}):null}),{Header:kj,TabTriggers:eY,TabTrigger:Jj,Tabs:nY,Tab:iY,Trigger:tY});vr.displayName="Sidebar";const Vp=(e,t)=>{const n=Wt(0),i=r=>{const{tunnelsJotai:{useAtom:s}}=er(),[,o]=s(n),a=R.useRef({preferHost:!1,counter:0});return R.useLayoutEffect(()=>{const l=a.current;return o(c=>{const d=c+1;return l.counter=d,d}),()=>{o(c=>{const d=c-1;return l.counter=d,d||(l.preferHost=!1),d})}},[o]),r.__fallback||(a.current.preferHost=!0),!a.current.counter&&r.__fallback&&a.current.preferHost||a.current.counter>1&&r.__fallback?null:g(t,{...r})};return i.displayName=e,i},sY=Wt({active:!1});async function $v({title:e,description:t,actionLabel:n,color:i}){return new Promise(r=>{Gr.set(sY,{active:!0,onConfirm:()=>r(!0),onClose:()=>r(!1),onReject:()=>r(!1),title:e,description:t,actionLabel:n,color:i})})}const oY=function({onChange:e,value:t,choices:n,name:i}){return g("div",{className:"RadioGroup",children:n.map(r=>N("div",{className:le("RadioGroup__choice",{active:r.value===t}),title:r.ariaLabel,children:[g("input",{name:i,type:"radio",checked:r.value===t,onChange:()=>e(r.value),"aria-label":r.ariaLabel}),r.label]},String(r.value)))})},aY=({value:e,shortcut:t,onChange:n,choices:i,children:r,name:s})=>{const o=Nn();return N(fe,{children:[N("div",{className:"dropdown-menu-item-base dropdown-menu-item-bare",children:[g("label",{className:"dropdown-menu-item__text",htmlFor:s,children:r}),g(oY,{name:s,value:e,onChange:n,choices:i})]}),t&&o.formFactor!=="phone"&&g("div",{className:"dropdown-menu-item__shortcut dropdown-menu-item__shortcut--orphaned",children:t})]})};aY.displayName="DropdownMenuItemContentRadio";const lY=()=>{const{t:e}=fn(),t=Lr(),n=sE();return t.isActionEnabled(xv)?g(Rr,{icon:Z9,onSelect:async()=>{(!n.length||await $v({title:e("overwriteConfirm.modal.loadFromFile.title"),actionLabel:e("overwriteConfirm.modal.loadFromFile.button"),color:"warning",description:g(xr,{i18nKey:"overwriteConfirm.modal.loadFromFile.description",bold:r=>g("strong",{children:r}),br:()=>g("br",{})})}))&&t.executeAction(xv)},"data-testid":"load-button",shortcut:Zi("loadScene"),"aria-label":e("buttons.load"),children:e("buttons.load")}):null};lY.displayName="LoadScene";const cY=()=>{const{t:e}=fn(),t=Lr();return t.isActionEnabled(q6)?g(Rr,{shortcut:Zi("saveScene"),"data-testid":"save-button",onSelect:()=>t.executeAction(q6),icon:Oue,"aria-label":`${e("buttons.save")}`,children:`${e("buttons.save")}`}):null};cY.displayName="SaveToActiveFile";const dY=()=>{const e=xn(),{t}=fn();return g(Rr,{icon:FV,"data-testid":"image-export-button",onSelect:()=>e({openDialog:{name:"imageExport"}}),shortcut:Zi("imageExport"),"aria-label":t("buttons.exportImage"),children:t("buttons.exportImage")})};dY.displayName="SaveAsImage";const uY=e=>{const t=xn(),{t:n}=fn();return g(Rr,{icon:dv,"data-testid":"command-palette-button",onSelect:()=>{et("command_palette","open","menu"),t({openDialog:{name:"commandPalette"}})},shortcut:Zi("commandPalette"),"aria-label":n("commandPalette.title"),className:e==null?void 0:e.className,children:n("commandPalette.title")})};uY.displayName="CommandPalette";const fY=e=>{const{t}=fn(),n=Lr();return g(Rr,{icon:Eu,"data-testid":"search-menu-button",onSelect:()=>{n.executeAction(yj)},shortcut:Zi("searchMenu"),"aria-label":t("search.title"),className:e==null?void 0:e.className,children:t("search.title")})};fY.displayName="SearchMenu";const hY=()=>{const{t:e}=fn(),t=Lr();return g(Rr,{"data-testid":"help-menu-item",icon:W9,onSelect:()=>t.executeAction(VT),shortcut:"?","aria-label":e("helpDialog.title"),children:e("helpDialog.title")})};hY.displayName="Help";const gY=()=>{const{t:e}=fn(),t=py(nE);return Lr().isActionEnabled(R0)?g(Rr,{icon:Xc,onSelect:()=>t("clearCanvas"),"data-testid":"clear-canvas-button","aria-label":e("buttons.clearReset"),children:e("buttons.clearReset")}):null};gY.displayName="ClearCanvas";const mY=e=>{const{t}=fn(),n=ai(),i=Lr(),r=Zi("toggleTheme");return i.isActionEnabled($6)?e!=null&&e.allowSystemTheme?g(aY,{name:"theme",value:e.theme,onChange:s=>e.onSelect(s),choices:[{value:ke.LIGHT,label:ov,ariaLabel:`${t("buttons.lightMode")} - ${r}`},{value:ke.DARK,label:sv,ariaLabel:`${t("buttons.darkMode")} - ${r}`},{value:"system",label:Jfe,ariaLabel:t("buttons.systemMode")}],children:t("labels.theme")}):g(Rr,{onSelect:s=>{if(s.preventDefault(),e!=null&&e.onSelect)e.onSelect(n.theme===ke.DARK?ke.LIGHT:ke.DARK);else return i.executeAction($6)},icon:n.theme===ke.DARK?ov:sv,"data-testid":"toggle-dark-mode",shortcut:r,"aria-label":n.theme===ke.DARK?t("buttons.lightMode"):t("buttons.darkMode"),children:n.theme===ke.DARK?t("buttons.lightMode"):t("buttons.darkMode")}):null};mY.displayName="ToggleTheme";const pY=()=>{const{t:e}=fn(),t=ai(),n=Lr(),i=$p();return t.viewModeEnabled||!i.UIOptions.canvasActions.changeViewBackgroundColor?null:N("div",{style:{marginTop:"0.5rem"},children:[g("div",{"data-testid":"canvas-background-label",style:{fontSize:".75rem",marginBottom:".5rem"},children:e("labels.canvasBackground")}),g("div",{style:{padding:"0 0.625rem"},children:n.renderAction("changeViewBackgroundColor")})]})};pY.displayName="ChangeCanvasBackground";const UY=()=>{const{t:e}=fn(),t=xn();return g(Rr,{icon:Ey,onSelect:()=>{t({openDialog:{name:"jsonExport"}})},"data-testid":"json-export-button","aria-label":e("buttons.export"),children:e("buttons.export")})};UY.displayName="Export";const bY=()=>{const{t:e}=fn();return N(fe,{children:[g(B0,{icon:K9,href:"https://github.com/excalidraw/excalidraw","aria-label":"GitHub",children:"GitHub"}),g(B0,{icon:PV,href:"https://x.com/excalidraw","aria-label":"X",children:e("labels.followUs")}),g(B0,{icon:OV,href:"https://discord.gg/UexuTaE","aria-label":"Discord",children:e("labels.discordChat")})]})};bY.displayName="Socials";const yY=({onSelect:e,isCollaborating:t})=>{const{t:n}=fn();return g(Rr,{"data-testid":"collab-button",icon:Q9,className:le({"active-collab":t}),onSelect:e,children:n("labels.liveCollaboration")})};yY.displayName="LiveCollaborationTrigger";const a4e=Object.freeze(Object.defineProperty({__proto__:null,ChangeCanvasBackground:pY,ClearCanvas:gY,CommandPalette:uY,Export:UY,Help:hY,LiveCollaborationTrigger:yY,LoadScene:lY,SaveAsImage:dY,SaveToActiveFile:cY,SearchMenu:fY,Socials:bY,ToggleTheme:mY},Symbol.toStringTag,{value:"Module"})),It=Object.assign(Vp("MainMenu",({children:e,onSelect:t})=>{var o;const{MainMenuTunnel:n}=er(),i=Nn(),r=ai(),s=xn();return g(n.In,{children:N(Ve,{open:r.openMenu==="canvas",children:[g(Ve.Trigger,{onToggle:()=>{s({openMenu:r.openMenu==="canvas"?null:"canvas",openPopup:null,openDialog:null})},"data-testid":"main-menu-trigger",className:"main-menu-trigger",children:Due}),N(Ve.Content,{onClickOutside:()=>s({openMenu:null}),onSelect:ry(t,()=>{s({openMenu:null})}),placement:"bottom",className:i.formFactor==="phone"?"main-menu-dropdown":"",children:[e,i.formFactor==="phone"&&r.collaborators.size>0&&N("fieldset",{className:"UserList-Wrapper",children:[g("legend",{children:M("labels.collaborators")}),g(Cj,{mobile:!0,collaborators:r.collaborators,userToFollow:((o=r.userToFollow)==null?void 0:o.socketId)||null})]})]})]})})}),{Trigger:Ve.Trigger,Item:Ve.Item,ItemLink:Ve.ItemLink,ItemCustom:Ve.ItemCustom,Group:Ve.Group,Separator:Ve.Separator,DefaultItems:a4e}),Rs=R.forwardRef(({children:e,icon:t,onClick:n,label:i,variant:r="filled",color:s="primary",size:o="medium",fullWidth:a,className:l,status:c},d)=>{const[u,f]=R.useState(!1),h=async p=>{const U=n==null?void 0:n(p);if(_p(U)){const b=window.setTimeout(()=>{f(!0)},50);try{await U}catch(y){if(y instanceof Kh)console.warn(y);else throw y}finally{clearTimeout(b),f(!1)}}},m=u?"loading":c;return s=m==="success"?"success":s,g("button",{className:le("ExcButton",`ExcButton--color-${s}`,`ExcButton--variant-${r}`,`ExcButton--size-${o}`,`ExcButton--status-${m}`,{"ExcButton--fullWidth":a},l),onClick:h,type:"button","aria-label":i,ref:d,disabled:m==="loading"||m==="success",children:N("div",{className:"ExcButton__contents",children:[m==="loading"?g(hl,{className:"ExcButton__statusIcon"}):m==="success"&&g("div",{className:"ExcButton__statusIcon",children:Nfe}),t&&g("div",{className:"ExcButton__icon","aria-hidden":!0,children:t}),r!=="icon"&&(e??i)]})})}),JT=({title:e,children:t,actionLabel:n,onClick:i})=>N("div",{className:"OverwriteConfirm__Actions__Action",children:[g("h4",{children:e}),g("div",{className:"OverwriteConfirm__Actions__Action__content",children:t}),g(Rs,{variant:"outlined",color:"muted",label:n,size:"large",fullWidth:!0,onClick:i})]}),l4e=()=>{const{t:e}=fn(),t=Lr(),n=xn();return g(JT,{title:e("overwriteConfirm.action.exportToImage.title"),actionLabel:e("overwriteConfirm.action.exportToImage.button"),onClick:()=>{t.executeAction(MX,"ui",!0),n({openDialog:{name:"imageExport"}})},children:e("overwriteConfirm.action.exportToImage.description")})},c4e=()=>{const{t:e}=fn(),t=Lr();return g(JT,{title:e("overwriteConfirm.action.saveToDisk.title"),actionLabel:e("overwriteConfirm.action.saveToDisk.button"),onClick:()=>{t.executeAction(kX,"ui")},children:e("overwriteConfirm.action.saveToDisk.description")})},kD=Object.assign(({children:e})=>g("div",{className:"OverwriteConfirm__Actions",children:e}),{ExportToImage:l4e,SaveToDisk:c4e}),$d=Object.assign(Vp("OverwriteConfirmDialog",({children:e})=>{const{OverwriteConfirmDialogTunnel:t}=er(),[n,i]=un(sY);if(!n.active)return null;const r=()=>{n.onClose(),i(o=>({...o,active:!1}))},s=()=>{n.onConfirm(),i(o=>({...o,active:!1}))};return g(t.In,{children:g(as,{onCloseRequest:r,title:!1,size:916,children:N("div",{className:"OverwriteConfirm",children:[g("h3",{children:n.title}),N("div",{className:`OverwriteConfirm__Description OverwriteConfirm__Description--color-${n.color}`,children:[g("div",{className:"OverwriteConfirm__Description__icon",children:Ofe}),g("div",{children:n.description}),g("div",{className:"OverwriteConfirm__Description__spacer"}),g(Rs,{color:n.color,size:"large",label:n.actionLabel,onClick:s})]}),g(kD,{children:e})]})})})}),{Actions:kD,Action:JT});var d4e="Expected a function",RD=NaN,u4e="[object Symbol]",f4e=/^\s+|\s+$/g,h4e=/^[-+]0x[0-9a-f]+$/i,g4e=/^0b[01]+$/i,m4e=/^0o[0-7]+$/i,p4e=parseInt,U4e=typeof Fa=="object"&&Fa&&Fa.Object===Object&&Fa,b4e=typeof self=="object"&&self&&self.Object===Object&&self,y4e=U4e||b4e||Function("return this")(),E4e=Object.prototype,v4e=E4e.toString,w4e=Math.max,_4e=Math.min,V3=function(){return y4e.Date.now()};function T4e(e,t,n){var i,r,s,o,a,l,c=0,d=!1,u=!1,f=!0;if(typeof e!="function")throw new TypeError(d4e);t=DD(t)||0,Gv(n)&&(d=!!n.leading,u="maxWait"in n,s=u?w4e(DD(n.maxWait)||0,t):s,f="trailing"in n?!!n.trailing:f);function h(C){var _=i,T=r;return i=r=void 0,c=C,o=e.apply(T,_),o}function m(C){return c=C,a=setTimeout(b,t),d?h(C):o}function p(C){var _=C-l,T=C-c,k=t-_;return u?_4e(k,s-T):k}function U(C){var _=C-l,T=C-c;return l===void 0||_>=t||_<0||u&&T>=s}function b(){var C=V3();if(U(C))return y(C);a=setTimeout(b,p(C))}function y(C){return a=void 0,f&&i?h(C):(i=r=void 0,o)}function w(){a!==void 0&&clearTimeout(a),c=0,i=l=r=a=void 0}function v(){return a===void 0?o:y(V3())}function I(){var C=V3(),_=U(C);if(i=arguments,r=this,l=C,_){if(a===void 0)return m(l);if(u)return a=setTimeout(b,t),h(l)}return a===void 0&&(a=setTimeout(b,t)),o}return I.cancel=w,I.flush=v,I}function Gv(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function I4e(e){return!!e&&typeof e=="object"}function S4e(e){return typeof e=="symbol"||I4e(e)&&v4e.call(e)==u4e}function DD(e){if(typeof e=="number")return e;if(S4e(e))return RD;if(Gv(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Gv(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(f4e,"");var n=g4e.test(e);return n||m4e.test(e)?p4e(e.slice(2),n?2:8):h4e.test(e)?RD:+e}var x4e=T4e;const C4e=wl(x4e),A4e=Wt(""),EY=Wt(null),M4e=350,k4e=()=>{const e=bo(),t=xn(),n=R.useRef(null),[i,r]=un(A4e),s=i.trim(),[o,a]=R.useState(!1),[l,c]=R.useState({nonce:null,items:[]}),d=R.useRef(null),u=R.useRef(void 0),[f,h]=un(EY),m=e.scene.getNonDeletedElementsMap();R.useEffect(()=>{o||(s!==d.current||e.scene.getSceneNonce()!==u.current)&&(d.current=null,OD(s,e,(w,v)=>{c({nonce:Ps(),items:w}),d.current=s,u.current=e.scene.getSceneNonce(),t({searchMatches:w.length?{focusedId:null,matches:w.map(I=>({id:I.element.id,focus:!1,matchedLines:I.matchedLines}))}:null})}))},[o,s,m,e,t,h,u]);const p=()=>{l.items.length>0&&h(w=>w===null?0:(w+1)%l.items.length)},U=()=>{l.items.length>0&&h(w=>w===null?0:w-1<0?l.items.length-1:w-1)};R.useEffect(()=>{t(w=>{var I,C;return w.searchMatches?{searchMatches:{focusedId:f!==null&&((C=(I=w.searchMatches)==null?void 0:I.matches[f])==null?void 0:C.id)||null,matches:w.searchMatches.matches.map((_,T)=>T===f?{..._,focus:!0}:{..._,focus:!1})}}:null})},[f,t]),R.useEffect(()=>{var w,v,I,C;if(l.items.length>0&&f!==null){const _=l.items[f];if(_){const T=e.state.zoom.value,k=os({text:_.searchQuery,x:_.element.x+(((w=_.matchedLines[0])==null?void 0:w.offsetX)??0),y:_.element.y+(((v=_.matchedLines[0])==null?void 0:v.offsetY)??0),width:(I=_.matchedLines[0])==null?void 0:I.width,height:(C=_.matchedLines[0])==null?void 0:C.height,fontSize:we(_.element)?zt.nameFontSize:_.element.fontSize,fontFamily:we(_.element)?nt.Assistant:_.element.fontFamily}),x=14,D=k.fontSize,O=D*T<x;if(!$2([k],e.canvas.width/window.devicePixelRatio,e.canvas.height/window.devicePixelRatio,{offsetLeft:e.state.offsetLeft,offsetTop:e.state.offsetTop,scrollX:e.state.scrollX,scrollY:e.state.scrollY,zoom:e.state.zoom},e.scene.getNonDeletedElementsMap(),e.getEditorUIOffsets())||O){let L;O?D>=x?L={fitToContent:!0}:L={fitToViewport:!0,maxZoom:Za(x/D,1)}:L={fitToContent:!0},e.scrollToContent(k,{animate:!0,duration:300,...L,canvasOffsets:e.getEditorUIOffsets()})}}}},[f,l,e]),R.useEffect(()=>()=>{h(null),d.current=null,u.current=void 0,t({searchMatches:null}),a(!1)},[t,h]);const b=Cy({goToNextItem:p,goToPreviousItem:U,searchMatches:l});R.useEffect(()=>{const w=v=>{var I,C,_;if(v.key===V.ESCAPE&&!e.state.openDialog&&!e.state.openPopup){v.preventDefault(),v.stopPropagation(),t({openSidebar:null});return}if(v[V.CTRL_OR_CMD]&&v.key===V.F){if(v.preventDefault(),v.stopPropagation(),e.state.openDialog)return;(I=n.current)!=null&&I.matches(":focus")||(e.state.openDialog&&t({openDialog:null}),(C=n.current)==null||C.focus(),(_=n.current)==null||_.select())}v.target instanceof HTMLElement&&v.target.closest(".layer-ui__search")&&b.searchMatches.items.length&&(v.key===V.ENTER&&(v.stopPropagation(),b.goToNextItem()),v.key===V.ARROW_UP?(v.stopPropagation(),b.goToPreviousItem()):v.key===V.ARROW_DOWN&&(v.stopPropagation(),b.goToNextItem()))};return en(window,te.KEYDOWN,w,{capture:!0,passive:!1})},[t,b,e]);const y=`${l.items.length} ${l.items.length===1?M("search.singleResult"):M("search.multipleResults")}`;return N("div",{className:"layer-ui__search",children:[g("div",{className:"layer-ui__search-header",children:g(Au,{className:Jr.SEARCH_MENU_INPUT_WRAPPER,value:i,ref:n,placeholder:M("search.placeholder"),icon:Eu,onChange:w=>{r(w),a(!0);const v=w.trim();OD(v,e,(I,C)=>{c({nonce:Ps(),items:I}),h(C),d.current=v,u.current=e.scene.getSceneNonce(),t({searchMatches:I.length?{focusedId:null,matches:I.map(_=>({id:_.element.id,focus:!1,matchedLines:_.matchedLines}))}:null}),a(!1)})},selectOnRender:!0})}),N("div",{className:"layer-ui__search-count",children:[l.items.length>0&&N(fe,{children:[f!==null&&f>-1?N("div",{children:[f+1," / ",y]}):g("div",{children:y}),N("div",{className:"result-nav",children:[g(Kc,{onSelect:()=>{p()},className:"result-nav-btn",children:WV}),g(Kc,{onSelect:()=>{U()},className:"result-nav-btn",children:ihe})]})]}),l.items.length===0&&s&&d.current&&g("div",{style:{margin:"1rem auto"},children:M("search.noMatch")})]}),g(L4e,{matches:l,onItemClick:h,focusIndex:f,searchQuery:s})]})},LD=e=>{const t=[e.preview.moreBefore?"...":"",e.preview.previewText.slice(0,e.preview.indexInSearchQuery),e.preview.previewText.slice(e.preview.indexInSearchQuery,e.preview.indexInSearchQuery+e.searchQuery.length),e.preview.previewText.slice(e.preview.indexInSearchQuery+e.searchQuery.length),e.preview.moreAfter?"...":""];return g("div",{tabIndex:-1,className:le("layer-ui__result-item",{active:e.highlighted}),onClick:e.onClick,ref:n=>{e.highlighted&&(n==null||n.scrollIntoView({behavior:"auto",block:"nearest"}))},children:g("div",{className:"preview-text",children:t.flatMap((n,i)=>g(R.Fragment,{children:i===2?g("b",{children:n}):n},i))})})},R4e=e=>{const t=R.useMemo(()=>e.matches.items.filter(i=>we(i.element)),[e.matches]),n=R.useMemo(()=>e.matches.items.filter(i=>ge(i.element)),[e.matches]);return N("div",{children:[t.length>0&&N("div",{className:"layer-ui__search-result-container",children:[N("div",{className:"layer-ui__search-result-title",children:[g("div",{className:"title-icon",children:nu}),g("div",{children:M("search.frames")})]}),t.map((i,r)=>g(LD,{searchQuery:e.searchQuery,preview:i.preview,highlighted:r===e.focusIndex,onClick:()=>e.onItemClick(r)},i.element.id+i.index)),n.length>0&&g("div",{className:"layer-ui__divider"})]}),n.length>0&&N("div",{className:"layer-ui__search-result-container",children:[N("div",{className:"layer-ui__search-result-title",children:[g("div",{className:"title-icon",children:Uh}),g("div",{children:M("search.texts")})]}),n.map((i,r)=>g(LD,{searchQuery:e.searchQuery,preview:i.preview,highlighted:r+t.length===e.focusIndex,onClick:()=>e.onItemClick(r+t.length)},i.element.id+i.index))]})]})},D4e=(e,t)=>e.matches.nonce===t.matches.nonce&&e.focusIndex===t.focusIndex,L4e=R.memo(R4e,D4e),ND=(e,t,n)=>{const s=e.slice(0,t),o=s.split(/\s+/),a=s.endsWith(" "),l=o.length-2-1-(a?0:1);let c=o.slice(l<=0?0:l).join(" ")+(a?" ":"");c=c.length>20?c.slice(-20):c;const u=e.slice(t+n.length),f=u.split(/\s+/),h=!u.startsWith(" "),m=h?6:5,p=(h?"":" ")+f.slice(0,m).join(" ");return{indexInSearchQuery:c.length,previewText:c+n+p,moreBefore:l>0,moreAfter:f.length>m}},N4e=(e,t)=>{const n=e.split(`
`),i=[];let r=0;for(let s=0;s<n.length;s++){let o=n[s];const a=n[s+1];if(a){const l=t.indexOf(a,r);if(l>o.length+r){let c=l-(o.length+r);for(;c>0;)o+=" ",c--}}i.push(o),r=r+o.length}return i.join(`
`)},O4e=(e,t,n)=>{const r=N4e(e.text,e.originalText).split(`
`),s=[];let o=0,a=0;for(const u of r){const f=o,h=f+u.length-1;s.push({line:u,startIndex:f,endIndex:h,lineNumber:a}),o=h+1,a++}let l=n,c=e.originalText.slice(n,n+t.length);const d=[];for(const u of s){if(c==="")break;if(l>=u.startIndex&&l<=u.endIndex){const f=u.endIndex+1-l,h=u.line.slice(0,l-u.startIndex),m=c.slice(0,f);c=c.slice(f);const p=jn(h,mt(e),e.lineHeight);if(h===""&&(p.width=0),e.textAlign!=="left"&&u.line.length>0){const v=jn(u.line,mt(e),e.lineHeight),I=e.textAlign==="center"?(e.width-v.width)/2:e.width-v.width;p.width+=I}const{width:U,height:b}=jn(m,mt(e),e.lineHeight),y=p.width,w=u.lineNumber*p.height;d.push({offsetX:y,offsetY:w,width:U,height:b,showOnCanvas:!0}),l+=f}}return d},P4e=(e,t,n,i)=>{const r=e.name??I9(e),s=r.slice(n,n+t.length),o=r.slice(0,n),a=mt({fontSize:zt.nameFontSize,fontFamily:nt.Assistant}),l=zc(nt.Assistant),c=jn(o,a,l);o===""&&(c.width=0);const d=jn(s,a,l),u=c.width,f=-c.height-zt.strokeWidth,h=d.width;return[{offsetX:u,offsetY:f,width:h,height:d.height,showOnCanvas:u+h<=e.width*i}]},F4e=e=>e.replace(/[.*+?^${}()|[\]\\-]/g,"\\$&"),OD=C4e((e,t,n)=>{if(!e||e===""){n([],null);return}const i=t.scene.getNonDeletedElements(),r=i.filter(f=>ge(f)),s=i.filter(f=>we(f));r.sort((f,h)=>f.y-h.y),s.sort((f,h)=>f.y-h.y);const o=[],a=new RegExp(F4e(e),"gi");for(const f of r){let h=null;const m=f.originalText;for(;(h=a.exec(m))!==null;){const p=ND(m,h.index,e),U=O4e(f,e,h.index);U.length>0&&o.push({element:f,searchQuery:e,preview:p,index:h.index,matchedLines:U})}}const l=[];for(const f of s){let h=null;const m=f.name??I9(f);for(;(h=a.exec(m))!==null;){const p=ND(m,h.index,e),U=P4e(f,e,h.index,t.state.zoom.value);U.length>0&&l.push({element:f,searchQuery:e,preview:p,index:h.index,matchedLines:U})}}const c=new Set(t.visibleElements.map(f=>f.id)),d=[...l,...o],u=d.findIndex(f=>c.has(f.element.id))??null;n(d,u)},M4e),vY=Vp("DefaultSidebarTrigger",e=>{const{DefaultSidebarTriggerTunnel:t}=er();return g(t.In,{children:g(vr.Trigger,{...e,className:"default-sidebar-trigger",name:As.name})})});vY.displayName="DefaultSidebarTrigger";const wY=({children:e})=>{const{DefaultSidebarTabTriggersTunnel:t}=er();return g(t.In,{children:e})};wY.displayName="DefaultTabTriggers";const s5=Object.assign(Vp("DefaultSidebar",({children:e,className:t,onDock:n,docked:i,...r})=>{var c;const s=ai(),o=xn(),{DefaultSidebarTabTriggersTunnel:a}=er(),l=((c=s.openSidebar)==null?void 0:c.tab)===Qd;return R.createElement(vr,{...r,name:"default",key:"default",className:le("default-sidebar",t),docked:l||(i??s.defaultSidebarDockedPreference),onDock:l||n===!1||!n&&i!=null?void 0:ry(n,d=>{o({defaultSidebarDockedPreference:d})})},N(vr.Tabs,{children:[g(vr.Header,{children:N(vr.TabTriggers,{children:[g(vr.TabTrigger,{tab:Qd,children:Eu}),g(vr.TabTrigger,{tab:Qb,children:DV}),g(a.Out,{})]})}),g(vr.Tab,{tab:Qb,children:g(Y8e,{})}),g(vr.Tab,{tab:Qd,children:g(k4e,{})}),e]}))}),{Trigger:vY,TabTriggers:wY}),_Y=({input:e,placeholder:t,onChange:n,onKeyboardSubmit:i})=>{const r=R.useRef(null),s=R.useRef(i);return s.current=i,R.useEffect(()=>{if(!s.current)return;const o=r.current;if(o){const a=l=>{var c;l[V.CTRL_OR_CMD]&&l.key===V.ENTER&&(l.preventDefault(),(c=s.current)==null||c.call(s))};return o.focus(),o.addEventListener(te.KEYDOWN,a),()=>{o.removeEventListener(te.KEYDOWN,a)}}},[]),g("textarea",{className:"ttd-dialog-input",onChange:n,value:e,placeholder:t,ref:r})},B4e=({error:e})=>N("div",{"data-testid":"ttd-dialog-output-error",className:"ttd-dialog-output-error",children:["Error! ",g("p",{children:e})]}),TY=({error:e,canvasRef:t,loaded:n})=>N("div",{className:"ttd-dialog-output-wrapper",children:[e&&g(B4e,{error:e.message}),n?g("div",{ref:t,style:{opacity:e?"0.15":1},className:"ttd-dialog-output-canvas-container"}):g(hl,{size:"2rem"})]}),o5=({label:e,children:t,panelAction:n,panelActionDisabled:i=!1,onTextSubmitInProgess:r,renderTopRight:s,renderSubmitShortcut:o,renderBottomRight:a})=>N("div",{className:"ttd-dialog-panel",children:[N("div",{className:"ttd-dialog-panel__header",children:[g("label",{children:e}),s==null?void 0:s()]}),t,N("div",{className:le("ttd-dialog-panel-button-container",{invisible:!n}),style:{display:"flex",alignItems:"center"},children:[N(Kc,{className:"ttd-dialog-panel-button",onSelect:n?n.action:()=>{},disabled:i||r,children:[N("div",{className:le({invisible:r}),children:[n==null?void 0:n.label,(n==null?void 0:n.icon)&&g("span",{children:n.icon})]}),r&&g(hl,{})]}),!i&&!r&&(o==null?void 0:o()),a==null?void 0:a()]})]}),IY=({children:e})=>g("div",{className:"ttd-dialog-panels",children:e}),SY=()=>N("div",{className:"ttd-dialog-submit-shortcut",children:[g("div",{className:"ttd-dialog-submit-shortcut__key",children:J("CtrlOrCmd")}),g("div",{className:"ttd-dialog-submit-shortcut__key",children:J("Enter")})]}),z4e=({canvasRef:e,setError:t})=>{const n=e.current;if(!n)return;const i=n.parentElement;i&&(i.style.background="",t(null),n.replaceChildren())},xY=async({canvasRef:e,mermaidToExcalidrawLib:t,mermaidDefinition:n,setError:i,data:r})=>{const s=e.current,o=s==null?void 0:s.parentElement;if(!(!s||!o)){if(!n){z4e({canvasRef:e,setError:i});return}try{const a=await t.api;let l;try{l=await a.parseMermaidToExcalidraw(n)}catch{l=await a.parseMermaidToExcalidraw(n.replace(/"/g,"'"))}const{elements:c,files:d}=l;i(null),r.current={elements:Bv(c,{regenerateIds:!0}),files:d};const u=await Qy({elements:r.current.elements,files:r.current.files,exportPadding:vg,maxWidthOrHeight:Math.max(o.offsetWidth,o.offsetHeight)*window.devicePixelRatio});try{await Pm(u)}catch(f){throw f.name==="CANVAS_POSSIBLY_TOO_BIG"?new Error(M("canvasError.canvasTooBig")):f}o.style.background="var(--default-bg-color)",s.replaceChildren(u)}catch(a){throw o.style.background="var(--default-bg-color)",n&&i(a),a}}},eI=e=>{iu.set(b0.MERMAID_TO_EXCALIDRAW,e)},CY=({app:e,data:t,text:n,shouldSaveMermaidDataToStorage:i})=>{const{elements:r,files:s}=t.current;r.length&&(e.addElementsFromPasteOrLibrary({elements:r,files:s,position:"center",fitToContent:!0}),e.setOpenDialog(null),i&&n&&eI(n))},H4e=`flowchart TD
 A[Christmas] -->|Get money| B(Go shopping)
 B --> C{Let me think}
 C -->|One| D[Laptop]
 C -->|Two| E[iPhone]
 C -->|Three| F[Car]`,PD=ll(eI,300),V4e=({mermaidToExcalidrawLib:e})=>{const[t,n]=R.useState(()=>iu.get(b0.MERMAID_TO_EXCALIDRAW)||H4e),i=R.useDeferredValue(t.trim()),[r,s]=R.useState(null),o=R.useRef(null),a=R.useRef({elements:[],files:null}),l=bo();R.useEffect(()=>{xY({canvasRef:o,data:a,mermaidToExcalidrawLib:e,setError:s,mermaidDefinition:i}).catch(d=>{}),PD(i)},[i,e]),R.useEffect(()=>()=>{PD.flush()},[]);const c=()=>{CY({app:l,data:a,text:t,shouldSaveMermaidDataToStorage:!0})};return N(fe,{children:[g("div",{className:"ttd-dialog-desc",children:g(xr,{i18nKey:"mermaid.description",flowchartLink:d=>g("a",{href:"https://mermaid.js.org/syntax/flowchart.html",children:d}),sequenceLink:d=>g("a",{href:"https://mermaid.js.org/syntax/sequenceDiagram.html",children:d}),classLink:d=>g("a",{href:"https://mermaid.js.org/syntax/classDiagram.html",children:d})})}),N(IY,{children:[g(o5,{label:M("mermaid.syntax"),children:g(_Y,{input:t,placeholder:"Write Mermaid diagram defintion here...",onChange:d=>n(d.target.value),onKeyboardSubmit:()=>{c()}})}),g(o5,{label:M("mermaid.preview"),panelAction:{action:()=>{c()},label:M("mermaid.button"),icon:Y2},renderSubmitShortcut:()=>g(SY,{}),children:g(TY,{canvasRef:o,loaded:e.loaded,error:r})})]})]})},AY=e=>{const t=xn(),n=R.useRef(null),i=R.useRef(0);return g(Kj,{ref:n,className:"ttd-dialog-tabs-root",value:e.tab,onValueChange:r=>{var o;if(!r)return;const s=(o=n.current)==null?void 0:o.closest(".Modal__content");if(s){const a=s.offsetHeight||0;a>i.current&&(i.current=a,s.style.minHeight=`min(${i.current}px, 100%)`)}e.dialog==="ttd"&&YB(["text-to-diagram","mermaid"],r)&&t({openDialog:{name:e.dialog,tab:r}})},children:e.children})};AY.displayName="TTDDialogTabs";const MY=({children:e,...t})=>g(Zj,{className:"ttd-dialog-triggers",...t,children:e});MY.displayName="TTDDialogTabTriggers";const Xv=({children:e,tab:t,onSelect:n,...i})=>g(qj,{value:t,asChild:!0,onSelect:n,children:g("button",{type:"button",className:"ttd-dialog-tab-trigger",...i,children:e})});Xv.displayName="TTDDialogTabTrigger";const jv=({tab:e,children:t,...n})=>g(Qj,{...n,value:e,children:t});jv.displayName="TTDDialogTab";const $3=3,pf=1e3,$4e=Wt(null),G4e=Wt(null),kY=e=>{var n;const t=ai();return((n=t.openDialog)==null?void 0:n.name)!=="ttd"?null:g(X4e,{...e,tab:t.openDialog.tab})},X4e=Vp("TTDDialogBase",({tab:e,...t})=>{const n=bo(),i=xn(),r=R.useRef(null),[s,o]=un(G4e),[a,l]=R.useState((s==null?void 0:s.prompt)??""),c=a.trim(),d=C=>{l(C.target.value),o(_=>({generatedResponse:(_==null?void 0:_.generatedResponse)??null,prompt:C.target.value}))},[u,f]=R.useState(!1),[h,m]=un($4e),p=async()=>{if(c.length>pf||c.length<$3||u||(h==null?void 0:h.rateLimitRemaining)===0||"__fallback"in t){c.length<$3&&I(new Error(`Prompt is too short (min ${$3} characters)`)),c.length>pf&&I(new Error(`Prompt is too long (max ${pf} characters)`));return}try{f(!0),et("ai","generate","ttd");const{generatedResponse:C,error:_,rateLimit:T,rateLimitRemaining:k}=await t.onTextSubmit(c);if(typeof C=="string"&&o(x=>({generatedResponse:C,prompt:(x==null?void 0:x.prompt)??null})),v0(T)&&v0(k)&&m({rateLimit:T,rateLimitRemaining:k}),_){I(_);return}if(!C){I(new Error("Generation failed"));return}try{await xY({canvasRef:r,data:w,mermaidToExcalidrawLib:b,setError:I,mermaidDefinition:C}),et("ai","mermaid parse success","ttd")}catch(x){console.info(`%cTTD mermaid render errror: ${x.message}`,"color: red"),console.info(`>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
TTD mermaid definition render errror: ${x.message}`,"color: yellow"),et("ai","mermaid parse failed","ttd"),I(new Error("Generated an invalid diagram :(. You may also try a different prompt."))}}catch(C){let _=C.message;(!_||_==="Failed to fetch")&&(_="Request failed"),I(new Error(_))}finally{f(!1)}},U=R.useRef(p);U.current=p;const[b,y]=R.useState({loaded:!1,api:ye(()=>import("./index-DUwR343_.js").then(C=>C.b6),__vite__mapDeps([]))});R.useEffect(()=>{(async()=>{await b.api,y(_=>({..._,loaded:!0}))})()},[b.api]);const w=R.useRef({elements:[],files:null}),[v,I]=R.useState(null);return g(as,{className:"ttd-dialog",onCloseRequest:()=>{n.setOpenDialog(null)},size:1200,title:!1,...t,autofocus:!1,children:N(AY,{dialog:"ttd",tab:e,children:["__fallback"in t&&t.__fallback?g("p",{className:"dialog-mermaid-title",children:M("mermaid.title")}):N(MY,{children:[g(Xv,{tab:"text-to-diagram",children:N("div",{style:{display:"flex",alignItems:"center"},children:[M("labels.textToDiagram"),g("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"1px 6px",marginLeft:"10px",fontSize:10,borderRadius:"12px",background:"var(--color-promo)",color:"var(--color-surface-lowest)"},children:"AI Beta"})]})}),g(Xv,{tab:"mermaid",children:"Mermaid"})]}),g(jv,{className:"ttd-dialog-content",tab:"mermaid",children:g(V4e,{mermaidToExcalidrawLib:b})}),!("__fallback"in t)&&N(jv,{className:"ttd-dialog-content",tab:"text-to-diagram",children:[g("div",{className:"ttd-dialog-desc",children:"Currently we use Mermaid as a middle step, so you'll get best results if you describe a diagram, workflow, flow chart, and similar."}),N(IY,{children:[g(o5,{label:M("labels.prompt"),panelAction:{action:p,label:"Generate",icon:Y2},onTextSubmitInProgess:u,panelActionDisabled:c.length>pf||(h==null?void 0:h.rateLimitRemaining)===0,renderTopRight:()=>h?N("div",{className:"ttd-dialog-rate-limit",style:{fontSize:12,marginLeft:"auto",color:h.rateLimitRemaining===0?"var(--color-danger)":void 0},children:[h.rateLimitRemaining," requests left today"]}):null,renderSubmitShortcut:()=>g(SY,{}),renderBottomRight:()=>{if(typeof(s==null?void 0:s.generatedResponse)=="string")return N("div",{className:"excalidraw-link",style:{marginLeft:"auto",fontSize:14},onClick:()=>{typeof(s==null?void 0:s.generatedResponse)=="string"&&(eI(s.generatedResponse),i({openDialog:{name:"ttd",tab:"mermaid"}}))},children:["View as Mermaid",g(Dy,{icon:Y2})]});const C=c.length/pf;return C>.8?N("div",{style:{marginLeft:"auto",fontSize:12,fontFamily:"monospace",color:C>1?"var(--color-danger)":void 0},children:["Length: ",c.length,"/",pf]}):null},children:g(_Y,{onChange:d,input:a,placeholder:"Describe what you want to see...",onKeyboardSubmit:()=>{U.current()}})}),g(o5,{label:"Preview",panelAction:{action:()=>{console.info("Panel action clicked"),CY({app:n,data:w})},label:"Insert",icon:Y2},children:g(TY,{canvasRef:r,error:v,loaded:b.loaded})})]})]})]})})}),j4e=.01,Yv=10,bl=(e,t)=>!(t==="angle"&&we(e)),Xi=(e,t)=>{const n=e+t/2;return n-n%t},a5=(e,t,n)=>Object.keys(e).map(i=>({original:(n??t).get(i),latest:t.get(i)})).filter(i=>i.original!==void 0&&i.latest!==void 0),Gm=(e,t,n,i,r,s=!0)=>{const o=i.getNonDeletedElementsMap(),a=o.get(n.id);if(!a)return;const[l,c]=[n.x+n.width/2,n.y+n.height/2],[d,u]=Q(S(n.x,n.y),S(l,c),n.angle),f=e-d,h=t-u,[m,p]=Q(S(e,t),S(l+f,c+h),-n.angle);i.mutateElement(a,{x:m,y:p},{informMutation:s,isDragging:!1}),gm(a,i);const U=Le(n,r);if(U){const b=o.get(U.id);b&&i.mutateElement(b,{x:U.x+f,y:U.y+h},{informMutation:s,isDragging:!1})}if(we(n)){const b=ns(r,n.id);b.forEach(y=>{const w=o.get(y.id);if(!w)return;const[v,I]=[y.x+y.width/2,y.y+y.height/2],[C,_]=Q(S(y.x,y.y),S(v,I),y.angle),T=Math.round(C+f),k=Math.round(_+h),[x,D]=Q(S(T,k),S(v+f,I+h),-y.angle);i.mutateElement(w,{x,y:D},{informMutation:s,isDragging:!1}),gm(w,i,{simultaneouslyUpdated:b})})}},tI=(e,t)=>{const i=_c(t).map(r=>At(e,r).reduce((s,o)=>(s[o.id]=!0,s),{}));return e.filter(r=>!jh(r)).forEach(r=>{i.push({[r.id]:!0})}),i},Cl=({label:e,icon:t,dragInputCallback:n,value:i,elements:r,editable:s=!0,shouldKeepAspectRatio:o,property:a,scene:l,appState:c,sensitivity:d=1,dragFinishedCallback:u})=>{const f=bo(),h=xn(),m=R.useRef(null),p=R.useRef(null),[U,b]=R.useState(i.toString()),y=R.useRef(null);y.current||(y.current={originalAppState:Qa(c),originalElements:r,lastUpdatedValue:U,updatePending:!1}),R.useEffect(()=>{const I=i.toString();b(I),y.current.lastUpdatedValue=I},[i]);const w=(I,C,_)=>{if(!y.current.updatePending)return!1;y.current.updatePending=!1;const T=Number(I);if(isNaN(T)){b(i.toString());return}const k=Number(T.toFixed(2)),x=Number(i);(isNaN(x)||Math.abs(k-x)>=j4e)&&(y.current.lastUpdatedValue=I,n({accumulatedChange:0,instantChange:0,originalElements:C,originalElementsMap:f.scene.getNonDeletedElementsMap(),shouldKeepAspectRatio:o,shouldChangeByStepSize:!1,scene:l,nextValue:k,property:a,originalAppState:_,setInputValue:D=>b(String(D)),app:f,setAppState:h}),f.syncActionResult({captureUpdate:Z.IMMEDIATELY}))},v=R.useRef({});return v.current.handleInputValue=w,R.useEffect(()=>{const I=m.current,C=v.current;return()=>{var T;const _=I==null?void 0:I.value;_&&((T=C.handleInputValue)==null||T.call(C,_,y.current.originalElements,y.current.originalAppState)),window.removeEventListener(te.POINTER_MOVE,C.onPointerMove,!1),window.removeEventListener(te.POINTER_UP,C.onPointerUp,!1)}},[s]),s?N("div",{className:le("drag-input-container",!s&&"disabled"),"data-testid":e,children:[g("div",{className:"drag-input-label",ref:p,onPointerDown:I=>{if(m.current&&s){document.body.classList.add("excalidraw-cursor-resize"),Number(m.current.value);let C=null,_=f.scene.getNonDeletedElements().reduce((Y,$)=>(Y.set($.id,Gc($)),Y),new Map),T=r.map(Y=>_.get(Y.id));const k=Qa(c);let x=0,D=0;const O=Y=>{if(C&&_!==null&&T!==null){const $=Y.clientX-C.x;$!==0&&(D+=$,Math.abs(D)>=d&&(D=Math.sign(D)*Math.floor(Math.abs(D)/d),x+=D,n({accumulatedChange:x,instantChange:D,originalElements:T,originalElementsMap:_,shouldKeepAspectRatio:o,shouldChangeByStepSize:Y.shiftKey,property:a,scene:l,originalAppState:k,setInputValue:H=>b(String(H)),app:f,setAppState:h}),D=0))}C={x:Y.clientX,y:Y.clientY}},L=()=>{window.removeEventListener(te.POINTER_MOVE,O,!1),f.syncActionResult({captureUpdate:Z.IMMEDIATELY}),u==null||u({app:f,setAppState:h,originalElements:T,originalAppState:k}),C=null,x=0,D=0,T=null,_=null,document.body.classList.remove("excalidraw-cursor-resize"),window.removeEventListener(te.POINTER_UP,L,!1)};v.current.onPointerMove=O,v.current.onPointerUp=L,window.addEventListener(te.POINTER_MOVE,O,!1),window.addEventListener(te.POINTER_UP,L,!1)}},onPointerEnter:()=>{p.current&&(p.current.style.cursor="ew-resize")},children:t?g(Dy,{icon:t}):e}),g("input",{className:"drag-input",autoComplete:"off",spellCheck:"false",onKeyDown:I=>{if(s){const C=I.target;C instanceof HTMLInputElement&&I.key===V.ENTER&&(w(C.value,r,c),f.focusContainer())}},ref:m,value:U,onChange:I=>{y.current.updatePending=!0,b(I.target.value)},onFocus:I=>{I.target.select(),y.current.originalElements=r,y.current.originalAppState=Qa(c)},onBlur:I=>{U?s&&w(I.target.value,y.current.originalElements,y.current.originalAppState):b(i.toString())},disabled:!s})]}):null},Y4e=15,W4e=({accumulatedChange:e,originalElements:t,shouldChangeByStepSize:n,nextValue:i,scene:r})=>{const s=r.getNonDeletedElementsMap(),o=t[0];if(o&&!me(o)){const a=s.get(o.id);if(!a)return;if(i!==void 0){const h=Jd(i);r.mutateElement(a,{angle:h}),gm(a,r);const m=Le(a,s);m&&!Ce(a)&&r.mutateElement(m,{angle:h});return}const l=Math.round(ty(o.angle)*100)/100,c=Math.round(e);let d=(l+c)%360;n&&(d=Xi(d,Y4e)),d=d<0?d+360:d;const u=Jd(d);r.mutateElement(a,{angle:u}),gm(a,r);const f=Le(a,s);f&&!Ce(a)&&r.mutateElement(f,{angle:u})}},K4e=({element:e,scene:t,appState:n,property:i})=>g(Cl,{label:"A",icon:$V,value:Math.round(ty(e.angle)%360*100)/100,elements:[e],dragInputCallback:W4e,editable:bl(e,"angle"),scene:t,appState:n,property:i}),FD=5,Z4e=({property:e,scene:t,appState:n,setAppState:i})=>g(Cl,{label:"Grid step",sensitivity:8,elements:[],dragInputCallback:({nextValue:r,instantChange:s,shouldChangeByStepSize:o,setInputValue:a})=>{i(l=>{let c;return r?c=r:s&&(c=o?Xi(l.gridStep+FD*Math.sign(s),FD):l.gridStep+s),c?(c=kV(c),a(c),{gridStep:c}):(a(l.gridStep),null)})},scene:t,value:n.gridStep,property:e,appState:n}),BD=10,q4e=e=>e.type==="image",Q4e=({accumulatedChange:e,originalElements:t,originalElementsMap:n,shouldKeepAspectRatio:i,shouldChangeByStepSize:r,nextValue:s,property:o,originalAppState:a,instantChange:l,scene:c,app:d,setAppState:u})=>{const f=c.getNonDeletedElementsMap(),h=t[0],m=f.get(h.id);if(h&&m){const p=i||q4e(h),U=h.width/h.height;if(a.croppingElementId===h.id){const b=f.get(h.id);if(!b||!yt(b)||!b.crop)return;const y=b.crop;let w={...y};const v=b.scale[0]===-1,I=b.scale[1]===-1,{width:C,height:_}=ul(b),T=y.naturalWidth/C,k=y.naturalHeight/_,x=v?y.width+y.x:y.naturalWidth-y.x,D=I?y.height+y.y:y.naturalHeight-y.y,O=ci*T,L=ci*k;if(s!==void 0){if(o==="width"){const G=s*T,j=Ze(G,O,x);w={...w,width:j,x:v?y.x+y.width-j:y.x}}else if(o==="height"){const G=s*k,j=Ze(G,L,D);w={...w,height:j,y:I?y.y+y.height-j:y.y}}c.mutateElement(b,{crop:w,width:w.width/(y.naturalWidth/C),height:w.height/(y.naturalHeight/_)});return}const Y=o==="width"?l:0,$=o==="height"?l:0,H=Ze(y.width+Y,O,x),z=Ze(y.height+$,O,D);w={...y,x:v?y.x+y.width-H:y.x,y:I?y.y+y.height-z:y.y,width:H,height:z},c.mutateElement(b,{crop:w,width:w.width/(y.naturalWidth/C),height:w.height/(y.naturalHeight/_)});return}if(s!==void 0){const b=Math.max(o==="width"?s:p?s*U:h.width,gs),y=Math.max(o==="height"?s:p?s/U:h.height,gs);if(Em(b,y,m,h,n,c,o==="width"?"e":"s",{shouldMaintainAspectRatio:p}),we(m)){const w=jo(c.getElementsIncludingDeleted(),m,a,c.getNonDeletedElementsMap()),v=Ig(c.getElementsIncludingDeleted(),w,m,d);c.replaceAllElements(v)}return}{const b=o==="width"?e:0,y=o==="height"?e:0;let w=Math.max(0,h.width+b);o==="width"&&(r?w=Xi(w,BD):w=Math.round(w));let v=Math.max(0,h.height+y);if(o==="height"&&(r?v=Xi(v,BD):v=Math.round(v)),p&&(o==="width"?v=Math.round(w/U*100)/100:w=Math.round(v*U*100)/100),v=Math.max(gs,v),w=Math.max(gs,w),Em(w,v,m,h,n,c,o==="width"?"e":"s",{shouldMaintainAspectRatio:p}),we(m)){const I=jo(c.getElementsIncludingDeleted(),m,a,c.getNonDeletedElementsMap());u({elementsToHighlight:I})}}}},J4e=({setAppState:e,app:t,originalElements:n,originalAppState:i})=>{const r=t.scene.getNonDeletedElementsMap(),s=n==null?void 0:n[0],o=s&&r.get(s.id);if(o&&we(o)){const a=jo(t.scene.getElementsIncludingDeleted(),o,i,t.scene.getNonDeletedElementsMap()),l=Ig(t.scene.getElementsIncludingDeleted(),a,o,t);t.scene.replaceAllElements(l),e({elementsToHighlight:null})}},zD=({property:e,element:t,scene:n,appState:i})=>{let r=Za(e==="width"?t.width:t.height,2);if(i.croppingElementId&&i.croppingElementId===t.id&&yt(t)&&t.crop){const{width:s,height:o}=ul(t);if(e==="width"){const a=s/t.crop.naturalWidth;r=Za(t.crop.width*a,2)}if(e==="height"){const a=o/t.crop.naturalHeight;r=Za(t.crop.height*a,2)}}return g(Cl,{label:e==="width"?"W":"H",elements:[t],dragInputCallback:Q4e,value:r,editable:bl(t,e),scene:n,appState:i,property:e,dragFinishedCallback:J4e})},HD=4,eve=4,tve=({accumulatedChange:e,originalElements:t,shouldChangeByStepSize:n,nextValue:i,scene:r})=>{const s=r.getNonDeletedElementsMap(),o=t[0];if(o){const a=s.get(o.id);if(!a||!ge(a))return;let l;if(i!==void 0)l=Math.max(Math.round(i),HD);else if(o.type==="text"){const c=Math.round(o.fontSize),d=Math.round(e);l=Math.max(c+d,HD),n&&(l=Xi(l,eve))}l&&(r.mutateElement(a,{fontSize:l}),Qi(a,r.getContainerElement(a),r))}},nve=({element:e,scene:t,appState:n,property:i})=>{const r=ge(e)?e:Li(e)?Le(e,t.getNonDeletedElementsMap()):null;return r?g(Cl,{label:"F",value:Math.round(r.fontSize*10)/10,elements:[r],dragInputCallback:tve,icon:vy,appState:n,scene:t,property:i}):null},ive=15,rve=({accumulatedChange:e,originalElements:t,shouldChangeByStepSize:n,nextValue:i,property:r,scene:s})=>{const o=s.getNonDeletedElementsMap(),a=t.map(c=>o.get(c.id)).filter(c=>c&&!jh(c)&&bl(c,r)),l=t.filter(c=>!jh(c)&&bl(c,r));if(i!==void 0){const c=Jd(i);for(const d of a){if(!d)continue;s.mutateElement(d,{angle:c});const u=Le(d,o);u&&!Ce(d)&&s.mutateElement(u,{angle:c})}s.triggerUpdate();return}for(let c=0;c<a.length;c++){const d=a[c];if(!d)continue;const u=l[c],f=Math.round(ty(u.angle)*100)/100,h=Math.round(e);let m=(f+h)%360;n&&(m=Xi(m,ive)),m=m<0?m+360:m;const p=Jd(m);s.mutateElement(d,{angle:p});const U=Le(d,o);U&&!Ce(d)&&s.mutateElement(U,{angle:p})}s.triggerUpdate()},sve=({elements:e,scene:t,appState:n,property:i})=>{const r=e.filter(l=>!jh(l)&&bl(l,"angle")),s=r.map(l=>Math.round(ty(l.angle)%360*100)/100),o=new Set(s).size===1?s[0]:"Mixed",a=r.some(l=>bl(l,"angle"));return g(Cl,{label:"A",icon:$V,value:o,elements:e,dragInputCallback:rve,editable:a,appState:n,scene:t,property:i})},Uf=10,ove=(e,t,n,i)=>{const r=i.x-e,s=i.y-t,o=i.width*n,a=i.height*n,l=e+r*n,c=t+s*n;return{width:o,height:a,x:l,y:c,...N9(i,o,a,!1),...ge(i)?{fontSize:i.fontSize*n}:{}}},ave=(e,t,n,i,r,s,o,a)=>{const l=a.getNonDeletedElementsMap(),c=ove(e,t,i,s);a.mutateElement(r,c);const d=Le(s,o);if(d){const u=d.fontSize*i;fr(r,a,{newSize:{width:c.width,height:c.height}});const f=l.get(d.id);f&&ge(f)&&(a.mutateElement(f,{fontSize:u}),Cp(r,a,n==="width"?"e":"s",!0))}},VD=(e,t,n,i,r,s,o,a,l,c)=>{s==="width"?t=Math.round(e/i*100)/100:e=Math.round(t*i*100)/100;const d=t/n;for(let u=0;u<a.length;u++){const f=a[u],h=o[u];ave(r[0],r[1],s,d,h,f,l,c)}},lve=({accumulatedChange:e,originalElements:t,originalElementsMap:n,originalAppState:i,shouldChangeByStepSize:r,nextValue:s,scene:o,property:a,setAppState:l,app:c})=>{const d=o.getNonDeletedElementsMap(),u=tI(t,i);if(s!==void 0){for(const p of u){const U=a5(p,d,n);if(U.length>1){const b=U.map(O=>O.latest),y=U.map(O=>O.original),[w,v,I,C]=ht(y),_=I-w,T=C-v,k=_/T,x=Math.max(gs,a==="width"?Math.max(0,s):_),D=Math.max(gs,a==="height"?Math.max(0,s):T);VD(x,D,T,k,S(w,v),a,b,y,n,o)}else{const[b]=U,y=b==null?void 0:b.latest,w=b==null?void 0:b.original;if(y&&w&&bl(y,a)){let v=a==="width"?Math.max(0,s):y.width;a==="width"&&(r?v=Xi(v,Uf):v=Math.round(v));let I=a==="height"?Math.max(0,s):y.height;if(a==="height"&&(r?I=Xi(I,Uf):I=Math.round(I)),v=Math.max(gs,v),I=Math.max(gs,I),Em(v,I,y,w,n,o,a==="width"?"e":"s",{shouldInformMutation:!1}),we(y)){const C=jo(o.getElementsIncludingDeleted(),y,i,o.getNonDeletedElementsMap()),_=Ig(o.getElementsIncludingDeleted(),C,y,c);o.replaceAllElements(_)}}}}o.triggerUpdate();return}const f=a==="width"?e:0,h=a==="height"?e:0,m=[];for(const p of u){const U=a5(p,d,n);if(U.length>1){const b=U.map(O=>O.latest),y=U.map(O=>O.original),[w,v,I,C]=ht(y),_=I-w,T=C-v,k=_/T;let x=Math.max(0,_+f);a==="width"&&(r?x=Xi(x,Uf):x=Math.round(x));let D=Math.max(0,T+h);a==="height"&&(r?D=Xi(D,Uf):D=Math.round(D)),x=Math.max(gs,x),D=Math.max(gs,D),VD(x,D,T,k,S(w,v),a,b,y,n,o)}else{const[b]=U,y=b==null?void 0:b.latest,w=b==null?void 0:b.original;if(y&&w&&bl(y,a)){let v=Math.max(0,w.width+f);a==="width"&&(r?v=Xi(v,Uf):v=Math.round(v));let I=Math.max(0,w.height+h);if(a==="height"&&(r?I=Xi(I,Uf):I=Math.round(I)),v=Math.max(gs,v),I=Math.max(gs,I),Em(v,I,y,w,n,o,a==="width"?"e":"s",{shouldInformMutation:!1}),we(y)){const C=jo(o.getElementsIncludingDeleted(),y,i,o.getNonDeletedElementsMap());m.push(...C)}}}}l({elementsToHighlight:m}),o.triggerUpdate()},cve=({setAppState:e,app:t,originalElements:n,originalAppState:i})=>{const r=t.scene.getNonDeletedElementsMap(),s=n==null?void 0:n[0],o=s&&r.get(s.id);if(o&&we(o)){const a=jo(t.scene.getElementsIncludingDeleted(),o,i,t.scene.getNonDeletedElementsMap()),l=Ig(t.scene.getElementsIncludingDeleted(),a,o,t);t.scene.replaceAllElements(l),e({elementsToHighlight:null})}},$D=({property:e,elements:t,elementsMap:n,atomicUnits:i,scene:r,appState:s})=>{const o=R.useMemo(()=>i.map(c=>{const d=a5(c,n);if(d.length>1){const[f,h,m,p]=ht(d.map(U=>U.latest));return Math.round((e==="width"?m-f:p-h)*100)/100}const[u]=d;return Math.round((e==="width"?u.latest.width:u.latest.height)*100)/100}),[n,i,e]),a=new Set(o).size===1?Math.round(o[0]*100)/100:"Mixed",l=o.length>0;return g(Cl,{label:e==="width"?"W":"H",elements:t,dragInputCallback:lve,value:a,editable:l,appState:s,property:e,scene:r,dragFinishedCallback:cve})},GD=4,dve=4,uve=(e,t)=>e.reduce((n,i)=>{if(!i||jh(i))return n;if(ge(i))return n.push(i),n;if(Li(i)){const r=Le(i,t);if(r)return n.push(r),n}return n},[]),fve=({accumulatedChange:e,originalElements:t,shouldChangeByStepSize:n,nextValue:i,scene:r})=>{const s=r.getNonDeletedElementsMap(),o=t.map(l=>s.get(l.id));let a;if(i){a=Math.max(Math.round(i),GD);for(const l of o)r.mutateElement(l,{fontSize:a}),Qi(l,r.getContainerElement(l),r);r.triggerUpdate()}else{const l=t;for(let c=0;c<o.length;c++){const d=o[c],u=l[c],f=Math.round(u.fontSize),h=Math.round(e);let m=Math.max(f+h,GD);n&&(m=Xi(m,dve)),r.mutateElement(d,{fontSize:m}),Qi(d,r.getContainerElement(d),r)}r.triggerUpdate()}},hve=({elements:e,scene:t,appState:n,property:i,elementsMap:r})=>{const s=uve(e,r);if(!s.length)return null;const o=s.map(c=>Math.round(c.fontSize*10)/10),a=new Set(o).size===1?o[0]:"Mixed",l=o.length>0;return g(Cl,{label:"F",icon:vy,elements:s,dragInputCallback:fve,value:a,editable:l,scene:t,property:i,appState:n})},gve=(e,t,n,i,r,s)=>{for(let o=0;o<i.length;o++){const a=i[o],[l,c]=[a.x+a.width/2,a.y+a.height/2],[d,u]=Q(S(a.x,a.y),S(l,c),a.angle),f=e==="x"?Math.round(d+t):d,h=e==="y"?Math.round(u+n):u;Gm(f,h,a,s,r,!1)}},mve=(e,t,n,i,r)=>{const s=r.getNonDeletedElementsMap(),[o,a,,]=ht(n),l=e-o,c=t-a;for(let d=0;d<n.length;d++){const u=n[d],f=s.get(u.id);if(f&&(!ge(f)||!f.containerId)){const[h,m]=[f.x+f.width/2,f.y+f.height/2],[p,U]=Q(S(f.x,f.y),S(h,m),f.angle);Gm(p+l,U+c,u,r,i,!1)}}},pve=({accumulatedChange:e,originalElements:t,originalElementsMap:n,shouldChangeByStepSize:i,nextValue:r,property:s,scene:o,originalAppState:a})=>{var f,h;const l=o.getNonDeletedElementsMap();if(r!==void 0){for(const m of tI(t,a)){const p=a5(m,l,n);if(p.length>1){const[U,b,,]=ht(p.map(v=>v.latest));mve(s==="x"?r:U,s==="y"?r:b,p.map(v=>v.original),n,o)}else{const U=(f=p[0])==null?void 0:f.original,b=(h=p[0])==null?void 0:h.latest;if(U&&b&&bl(b,s)){const[y,w]=[U.x+U.width/2,U.y+U.height/2],[v,I]=Q(S(U.x,U.y),S(y,w),U.angle);Gm(s==="x"?r:v,s==="y"?r:I,U,o,n,!1)}}}o.triggerUpdate();return}const c=i?Xi(e,Yv):e;gve(s,s==="x"?c:0,s==="y"?c:0,t,n,o),o.triggerUpdate()},XD=({property:e,elements:t,elementsMap:n,atomicUnits:i,scene:r,appState:s})=>{const o=R.useMemo(()=>i.map(l=>{const c=Object.keys(l).map(p=>n.get(p)).filter(p=>p!==void 0);if(c.length>1){const[p,U]=ht(c);return Math.round((e==="x"?p:U)*100)/100}const[d]=c,[u,f]=[d.x+d.width/2,d.y+d.height/2],[h,m]=Q(S(d.x,d.y),S(u,f),d.angle);return Math.round((e==="x"?h:m)*100)/100}),[i,n,e]),a=new Set(o).size===1?o[0]:"Mixed";return g(Cl,{label:e==="x"?"X":"Y",elements:t,dragInputCallback:pve,value:a,property:e,scene:r,appState:s})},Uve=({accumulatedChange:e,instantChange:t,originalElements:n,originalElementsMap:i,shouldChangeByStepSize:r,nextValue:s,property:o,scene:a,originalAppState:l})=>{const c=a.getNonDeletedElementsMap(),d=n[0],[u,f]=[d.x+d.width/2,d.y+d.height/2],[h,m]=Q(S(d.x,d.y),S(u,f),d.angle);if(l.croppingElementId===d.id){const w=c.get(d.id);if(!w||!yt(w)||!w.crop)return;const v=w.crop;let I=v;const C=w.scale[0]===-1,_=w.scale[1]===-1,{width:T,height:k}=ul(w);if(s!==void 0){if(o==="x"){const O=s*(v.naturalWidth/T);C?I={...v,x:Ze(v.naturalWidth-O-v.width,0,v.naturalWidth-v.width)}:I={...v,x:Ze(s*(v.naturalWidth/T),0,v.naturalWidth-v.width)}}o==="y"&&(I={...v,y:Ze(s*(v.naturalHeight/k),0,v.naturalHeight-v.height)}),a.mutateElement(w,{crop:I});return}const x=(o==="x"?t:0)*(C?-1:1),D=(o==="y"?t:0)*(_?-1:1);I={...v,x:Ze(v.x+x,0,v.naturalWidth-v.width),y:Ze(v.y+D,0,v.naturalHeight-v.height)},a.mutateElement(w,{crop:I});return}if(s!==void 0){Gm(o==="x"?s:h,o==="y"?s:m,d,a,i);return}const p=o==="x"?e:0,U=o==="y"?e:0,b=o==="x"?Math.round(r?Xi(d.x+p,Yv):h+p):h,y=o==="y"?Math.round(r?Xi(d.y+U,Yv):m+U):m;Gm(b,y,d,a,i)},jD=({property:e,element:t,elementsMap:n,scene:i,appState:r})=>{const[s,o]=Q(S(t.x,t.y),S(t.x+t.width/2,t.y+t.height/2),t.angle);let a=Za(e==="x"?s:o,2);if(r.croppingElementId===t.id&&yt(t)&&t.crop){const l=Uae(t);l&&(a=Za(e==="x"?l.x:l.y,2))}return g(Cl,{label:e==="x"?"X":"Y",elements:[t],dragInputCallback:Uve,scene:i,value:a,property:e,appState:r})},bve=50,Ma=e=>{const t=Gp(),n=e.app.scene.getSceneNonce()||1,i=e.app.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!1}),r=Vm(e.app);return g(yve,{...e,appState:t,sceneNonce:n,selectedElements:i,gridModeEnabled:r})},Kt=({children:e,columns:t=1,heading:n,style:i,...r})=>g("div",{className:le("exc-stats__row",{"exc-stats__row--heading":n}),style:{gridTemplateColumns:`repeat(${t}, 1fr)`,...i},...r,children:e});Kt.displayName="StatsRow";const l5=({children:e,order:t,style:n,...i})=>g("div",{className:"exc-stats__rows",style:{order:t,...n},...i,children:e});l5.displayName="StatsRows";Ma.StatsRow=Kt;Ma.StatsRows=l5;const yve=R.memo(({app:e,onClose:t,renderCustomStats:n,selectedElements:i,appState:r,sceneNonce:s,gridModeEnabled:o})=>{const a=e.scene,l=a.getNonDeletedElements(),c=a.getNonDeletedElementsMap(),d=xn(),u=i.length===1?i[0]:null,f=i.length>1?i:null,h=r.croppingElementId&&yt(u),m=h?ul(u):null,[p,U]=R.useState({width:0,height:0}),b=R.useMemo(()=>zo(v=>{const I=ht(v);U({width:Math.round(I[2])-Math.round(I[0]),height:Math.round(I[3])-Math.round(I[1])})},bve),[]);R.useEffect(()=>{b(l)},[s,l,b]),R.useEffect(()=>()=>b.cancel(),[b]);const y=R.useMemo(()=>tI(i,r),[i,r]),w=R.useMemo(()=>Hz(i),[i]);return g("div",{className:"exc-stats",children:N(Is,{padding:3,children:[N("div",{className:"title",children:[g("h2",{children:M("stats.title")}),g("div",{className:"close",onClick:t,children:ju})]}),N(Ev,{label:g("h3",{children:M("stats.generalStats")}),open:!!(r.stats.panels&Gf.generalStats),openTrigger:()=>d(v=>({stats:{open:!0,panels:v.stats.panels^Gf.generalStats}})),children:[N(l5,{children:[g(Kt,{heading:!0,children:M("stats.scene")}),N(Kt,{columns:2,children:[g("div",{children:M("stats.shapes")}),g("div",{children:l.length})]}),N(Kt,{columns:2,children:[g("div",{children:M("stats.width")}),g("div",{children:p.width})]}),N(Kt,{columns:2,children:[g("div",{children:M("stats.height")}),g("div",{children:p.height})]}),o&&N(fe,{children:[g(Kt,{heading:!0,children:"Canvas"}),g(Kt,{children:g(Z4e,{property:"gridStep",scene:a,appState:r,setAppState:d})})]})]}),n==null?void 0:n(l,r)]}),!w&&i.length>0&&g("div",{id:"elementStats",style:{marginTop:12},children:g(Ev,{label:g("h3",{children:M("stats.elementProperties")}),open:!!(r.stats.panels&Gf.elementProperties),openTrigger:()=>d(v=>({stats:{open:!0,panels:v.stats.panels^Gf.elementProperties}})),children:N(l5,{children:[u&&N(fe,{children:[h&&g(Kt,{heading:!0,children:M("labels.unCroppedDimension")}),r.croppingElementId&&yt(u)&&m&&N(Kt,{columns:2,children:[g("div",{children:M("stats.width")}),g("div",{children:Za(m.width,2)})]}),r.croppingElementId&&yt(u)&&m&&N(Kt,{columns:2,children:[g("div",{children:M("stats.height")}),g("div",{children:Za(m.height,2)})]}),g(Kt,{heading:!0,"data-testid":"stats-element-type",style:{margin:"0.3125rem 0"},children:r.croppingElementId?M("labels.imageCropping"):M(`element.${u.type}`)}),g(Kt,{children:g(jD,{element:u,property:"x",elementsMap:c,scene:a,appState:r})}),g(Kt,{children:g(jD,{element:u,property:"y",elementsMap:c,scene:a,appState:r})}),g(Kt,{children:g(zD,{property:"width",element:u,scene:a,appState:r})}),g(Kt,{children:g(zD,{property:"height",element:u,scene:a,appState:r})}),!me(u)&&g(Kt,{children:g(K4e,{property:"angle",element:u,scene:a,appState:r})}),g(Kt,{children:g(nve,{property:"fontSize",element:u,scene:a,appState:r})})]}),f&&N(fe,{children:[b9(f)&&g(Kt,{heading:!0,children:M("element.group")}),N(Kt,{columns:2,style:{margin:"0.3125rem 0"},children:[g("div",{children:M("stats.shapes")}),g("div",{children:i.length})]}),g(Kt,{children:g(XD,{property:"x",elements:f,elementsMap:c,atomicUnits:y,scene:a,appState:r})}),g(Kt,{children:g(XD,{property:"y",elements:f,elementsMap:c,atomicUnits:y,scene:a,appState:r})}),g(Kt,{children:g($D,{property:"width",elements:f,elementsMap:c,atomicUnits:y,scene:a,appState:r})}),g(Kt,{children:g($D,{property:"height",elements:f,elementsMap:c,atomicUnits:y,scene:a,appState:r})}),g(Kt,{children:g(sve,{property:"angle",elements:f,scene:a,appState:r})}),g(Kt,{children:g(hve,{property:"fontSize",elements:f,scene:a,appState:r,elementsMap:c})})]})]})})})]})})},(e,t)=>e.sceneNonce===t.sceneNonce&&e.selectedElements===t.selectedElements&&e.appState.stats.panels===t.appState.stats.panels&&e.gridModeEnabled===t.gridModeEnabled&&e.appState.gridStep===t.appState.gridStep&&e.appState.croppingElementId===t.appState.croppingElementId),Eve=({sourceElementId:e,onClose:t,appState:n,scene:i,generateLinkForSelection:r=cH})=>{var f;const s=i.getNonDeletedElementsMap(),o=((f=s.get(e))==null?void 0:f.link)??null,[a,l]=R.useState(o),[c,d]=R.useState(!1);R.useEffect(()=>{const h=Xe(s,n);let m=o;if(h.length>0&&r){const p=dH(h,n);p&&(m=ts(r(p.id,p.type)))}l(m)},[s,n,n.selectedElementIds,o,r]);const u=R.useCallback(()=>{var h;if(a&&a!==((h=s.get(e))==null?void 0:h.link)){const m=s.get(e);m&&i.mutateElement(m,{link:a})}if(!a&&c&&e){const m=s.get(e);m&&i.mutateElement(m,{link:null})}t==null||t()},[e,a,s,c,i,t]);return R.useEffect(()=>{const h=m=>{var p,U;((p=n.openDialog)==null?void 0:p.name)==="elementLinkSelector"&&m.key===V.ENTER&&u(),((U=n.openDialog)==null?void 0:U.name)==="elementLinkSelector"&&m.key===V.ESCAPE&&(t==null||t())};return window.addEventListener("keydown",h),()=>{window.removeEventListener("keydown",h)}},[n,t,u]),N("div",{className:"ElementLinkDialog",children:[N("div",{className:"ElementLinkDialog__header",children:[g("h2",{children:M("elementLink.title")}),g("p",{children:M("elementLink.desc")})]}),N("div",{className:"ElementLinkDialog__input",children:[g(Au,{value:a??"",onChange:h=>{c||d(!0),l(h)},onKeyDown:h=>{h.key===V.ENTER&&u()},className:"ElementLinkDialog__input-field",selectOnRender:!0}),o&&a&&g(je,{type:"button",title:M("buttons.remove"),"aria-label":M("buttons.remove"),label:M("buttons.remove"),onClick:()=>{l(null),d(!0)},className:"ElementLinkDialog__remove",icon:Xc})]}),N("div",{className:"ElementLinkDialog__actions",children:[g(tg,{label:M("buttons.cancel"),onClick:()=>{t==null||t()},style:{marginRight:10}}),g(tg,{label:M("buttons.confirm"),onClick:u,actionType:"primary"})]})]})},nI=({children:e,onClose:t})=>{const[n,i]=R.useState(!!e),{container:r}=Dr(),s=de.useCallback(()=>{i(!1),t&&t(),r==null||r.focus()},[t,r]);return g(fe,{children:n&&g(as,{size:"small",onCloseRequest:s,title:M("errorDialog.title"),children:g("div",{style:{whiteSpace:"pre-wrap"},children:e})})})},vve=()=>N("div",{className:"HelpDialog__header",children:[N("a",{className:"HelpDialog__btn",href:"https://docs.excalidraw.com",target:"_blank",rel:"noopener",children:[g("div",{className:"HelpDialog__link-icon",children:KM}),M("helpDialog.documentation")]}),N("a",{className:"HelpDialog__btn",href:"https://plus.excalidraw.com/blog",target:"_blank",rel:"noopener",children:[g("div",{className:"HelpDialog__link-icon",children:KM}),M("helpDialog.blog")]}),N("a",{className:"HelpDialog__btn",href:"https://github.com/excalidraw/excalidraw/issues",target:"_blank",rel:"noopener noreferrer",children:[g("div",{className:"HelpDialog__link-icon",children:K9}),M("helpDialog.github")]}),N("a",{className:"HelpDialog__btn",href:"https://youtube.com/@excalidraw",target:"_blank",rel:"noopener noreferrer",children:[g("div",{className:"HelpDialog__link-icon",children:YV}),"YouTube"]})]}),wve=e=>N(fe,{children:[g("h3",{children:e.title}),g("div",{className:"HelpDialog__islands-container",children:e.children})]}),G3=e=>N("div",{className:`HelpDialog__island ${e.className}`,children:[g("h4",{className:"HelpDialog__island-title",children:e.caption}),g("div",{className:"HelpDialog__island-content",children:e.children})]});function*_ve(e,t){let n=!0;for(const i of e)n||(yield t),n=!1,yield i}const Tve=e=>e.replace(/\b[a-z]\b/,t=>t.toUpperCase()),be=({label:e,shortcuts:t,isOr:n=!0})=>{const i=t.map(r=>(r.endsWith("++")?[...r.slice(0,-2).split("+"),"+"]:r.split("+")).map(o=>g(Ive,{children:Tve(o)},o)));return N("div",{className:"HelpDialog__shortcut",children:[g("div",{children:e}),g("div",{className:"HelpDialog__key-container",children:[..._ve(i,n?M("helpDialog.or"):null)]})]})},Ive=e=>g("kbd",{className:"HelpDialog__key",...e}),Sve=({onClose:e})=>{const t=de.useCallback(()=>{e&&e()},[e]);return g(fe,{children:N(as,{onCloseRequest:t,title:M("helpDialog.title"),className:"HelpDialog",children:[g(vve,{}),N(wve,{title:M("helpDialog.shortcuts"),children:[N(G3,{className:"HelpDialog__island--tools",caption:M("helpDialog.tools"),children:[g(be,{label:M("toolBar.hand"),shortcuts:[V.H]}),g(be,{label:M("toolBar.selection"),shortcuts:[V.V,V[1]]}),g(be,{label:M("toolBar.rectangle"),shortcuts:[V.R,V[2]]}),g(be,{label:M("toolBar.diamond"),shortcuts:[V.D,V[3]]}),g(be,{label:M("toolBar.ellipse"),shortcuts:[V.O,V[4]]}),g(be,{label:M("toolBar.arrow"),shortcuts:[V.A,V[5]]}),g(be,{label:M("toolBar.line"),shortcuts:[V.L,V[6]]}),g(be,{label:M("toolBar.freedraw"),shortcuts:[V.P,V[7]]}),g(be,{label:M("toolBar.text"),shortcuts:[V.T,V[8]]}),g(be,{label:M("toolBar.image"),shortcuts:[V[9]]}),g(be,{label:M("toolBar.eraser"),shortcuts:[V.E,V[0]]}),g(be,{label:M("toolBar.frame"),shortcuts:[V.F]}),g(be,{label:M("toolBar.laser"),shortcuts:[V.K]}),g(be,{label:M("labels.eyeDropper"),shortcuts:[V.I,"Shift+S","Shift+G"]}),g(be,{label:M("helpDialog.editLineArrowPoints"),shortcuts:[J("CtrlOrCmd+Enter")]}),g(be,{label:M("helpDialog.editText"),shortcuts:[J("Enter")]}),g(be,{label:M("helpDialog.textNewLine"),shortcuts:[J("Enter"),J("Shift+Enter")]}),g(be,{label:M("helpDialog.textFinish"),shortcuts:[J("Esc"),J("CtrlOrCmd+Enter")]}),g(be,{label:M("helpDialog.curvedArrow"),shortcuts:["A",M("helpDialog.click"),M("helpDialog.click"),M("helpDialog.click")],isOr:!1}),g(be,{label:M("helpDialog.curvedLine"),shortcuts:["L",M("helpDialog.click"),M("helpDialog.click"),M("helpDialog.click")],isOr:!1}),g(be,{label:M("helpDialog.cropStart"),shortcuts:[M("helpDialog.doubleClick"),J("Enter")],isOr:!0}),g(be,{label:M("helpDialog.cropFinish"),shortcuts:[J("Enter"),J("Escape")],isOr:!0}),g(be,{label:M("toolBar.lock"),shortcuts:[V.Q]}),g(be,{label:M("helpDialog.preventBinding"),shortcuts:[J("CtrlOrCmd")]}),g(be,{label:M("toolBar.link"),shortcuts:[J("CtrlOrCmd+K")]}),g(be,{label:M("toolBar.convertElementType"),shortcuts:["Tab","Shift+Tab"],isOr:!0})]}),N(G3,{className:"HelpDialog__island--view",caption:M("helpDialog.view"),children:[g(be,{label:M("buttons.zoomIn"),shortcuts:[J("CtrlOrCmd++")]}),g(be,{label:M("buttons.zoomOut"),shortcuts:[J("CtrlOrCmd+-")]}),g(be,{label:M("buttons.resetZoom"),shortcuts:[J("CtrlOrCmd+0")]}),g(be,{label:M("helpDialog.zoomToFit"),shortcuts:["Shift+1"]}),g(be,{label:M("helpDialog.zoomToSelection"),shortcuts:["Shift+2"]}),g(be,{label:M("helpDialog.movePageUpDown"),shortcuts:["PgUp/PgDn"]}),g(be,{label:M("helpDialog.movePageLeftRight"),shortcuts:["Shift+PgUp/PgDn"]}),g(be,{label:M("buttons.zenMode"),shortcuts:[J("Alt+Z")]}),g(be,{label:M("buttons.objectsSnapMode"),shortcuts:[J("Alt+S")]}),g(be,{label:M("labels.toggleGrid"),shortcuts:[J("CtrlOrCmd+'")]}),g(be,{label:M("labels.viewMode"),shortcuts:[J("Alt+R")]}),g(be,{label:M("labels.toggleTheme"),shortcuts:[J("Alt+Shift+D")]}),g(be,{label:M("stats.fullTitle"),shortcuts:[J("Alt+/")]}),g(be,{label:M("search.title"),shortcuts:[Zi("searchMenu")]}),g(be,{label:M("commandPalette.title"),shortcuts:um?[Zi("commandPalette")]:[Zi("commandPalette"),Zi("commandPalette",1)]})]}),N(G3,{className:"HelpDialog__island--editor",caption:M("helpDialog.editor"),children:[g(be,{label:M("helpDialog.createFlowchart"),shortcuts:[J("CtrlOrCmd+Arrow Key")],isOr:!0}),g(be,{label:M("helpDialog.navigateFlowchart"),shortcuts:[J("Alt+Arrow Key")],isOr:!0}),g(be,{label:M("labels.moveCanvas"),shortcuts:[J(`Space+${M("helpDialog.drag")}`),J(`Wheel+${M("helpDialog.drag")}`)],isOr:!0}),g(be,{label:M("buttons.clearReset"),shortcuts:[J("CtrlOrCmd+Delete")]}),g(be,{label:M("labels.delete"),shortcuts:[J("Delete")]}),g(be,{label:M("labels.cut"),shortcuts:[J("CtrlOrCmd+X")]}),g(be,{label:M("labels.copy"),shortcuts:[J("CtrlOrCmd+C")]}),g(be,{label:M("labels.paste"),shortcuts:[J("CtrlOrCmd+V")]}),g(be,{label:M("labels.pasteAsPlaintext"),shortcuts:[J("CtrlOrCmd+Shift+V")]}),g(be,{label:M("labels.selectAll"),shortcuts:[J("CtrlOrCmd+A")]}),g(be,{label:M("labels.multiSelect"),shortcuts:[J(`Shift+${M("helpDialog.click")}`)]}),g(be,{label:M("helpDialog.deepSelect"),shortcuts:[J(`CtrlOrCmd+${M("helpDialog.click")}`)]}),g(be,{label:M("helpDialog.deepBoxSelect"),shortcuts:[J(`CtrlOrCmd+${M("helpDialog.drag")}`)]}),(HT||um)&&g(be,{label:M("labels.copyAsPng"),shortcuts:[J("Shift+Alt+C")]}),g(be,{label:M("labels.copyStyles"),shortcuts:[J("CtrlOrCmd+Alt+C")]}),g(be,{label:M("labels.pasteStyles"),shortcuts:[J("CtrlOrCmd+Alt+V")]}),g(be,{label:M("labels.sendToBack"),shortcuts:[J(co?"CtrlOrCmd+Alt+[":"CtrlOrCmd+Shift+[")]}),g(be,{label:M("labels.bringToFront"),shortcuts:[J(co?"CtrlOrCmd+Alt+]":"CtrlOrCmd+Shift+]")]}),g(be,{label:M("labels.sendBackward"),shortcuts:[J("CtrlOrCmd+[")]}),g(be,{label:M("labels.bringForward"),shortcuts:[J("CtrlOrCmd+]")]}),g(be,{label:M("labels.alignTop"),shortcuts:[J("CtrlOrCmd+Shift+Up")]}),g(be,{label:M("labels.alignBottom"),shortcuts:[J("CtrlOrCmd+Shift+Down")]}),g(be,{label:M("labels.alignLeft"),shortcuts:[J("CtrlOrCmd+Shift+Left")]}),g(be,{label:M("labels.alignRight"),shortcuts:[J("CtrlOrCmd+Shift+Right")]}),g(be,{label:M("labels.duplicateSelection"),shortcuts:[J("CtrlOrCmd+D"),J(`Alt+${M("helpDialog.drag")}`)]}),g(be,{label:M("helpDialog.toggleElementLock"),shortcuts:[J("CtrlOrCmd+Shift+L")]}),g(be,{label:M("buttons.undo"),shortcuts:[J("CtrlOrCmd+Z")]}),g(be,{label:M("buttons.redo"),shortcuts:CB?[J("CtrlOrCmd+Y"),J("CtrlOrCmd+Shift+Z")]:[J("CtrlOrCmd+Shift+Z")]}),g(be,{label:M("labels.group"),shortcuts:[J("CtrlOrCmd+G")]}),g(be,{label:M("labels.ungroup"),shortcuts:[J("CtrlOrCmd+Shift+G")]}),g(be,{label:M("labels.flipHorizontal"),shortcuts:[J("Shift+H")]}),g(be,{label:M("labels.flipVertical"),shortcuts:[J("Shift+V")]}),g(be,{label:M("labels.showStroke"),shortcuts:[J("S")]}),g(be,{label:M("labels.showBackground"),shortcuts:[J("G")]}),g(be,{label:M("labels.showFonts"),shortcuts:[J("Shift+F")]}),g(be,{label:M("labels.decreaseFontSize"),shortcuts:[J("CtrlOrCmd+Shift+<")]}),g(be,{label:M("labels.increaseFontSize"),shortcuts:[J("CtrlOrCmd+Shift+>")]})]})]})]})})},Mt=e=>Array.isArray(e)?`<kbd>${e.map(J).join(" + ")}</kbd>`:`<kbd>${J(e)}</kbd>`,xve=({appState:e,isMobile:t,editorInterface:n,app:i})=>{var d,u,f,h;const{activeTool:r,isResizing:s,isRotating:o,lastPointerDownWith:a}=e,l=e.multiElement!==null;if(((d=e.openSidebar)==null?void 0:d.name)===As.name&&e.openSidebar.tab===Qd&&((u=e.searchMatches)!=null&&u.matches.length))return M("hints.dismissSearch",{shortcut:Mt("Escape")});if(e.openSidebar&&!n.canFitSidebar)return null;if(ko(e))return M("hints.eraserRevert",{shortcut:Mt("Alt")});if(r.type==="arrow"||r.type==="line")return l?M("hints.linearElementMulti",{shortcut_1:Mt("Escape"),shortcut_2:Mt("Enter")}):r.type==="arrow"?M("hints.arrowTool",{shortcut:Mt("A")}):M("hints.linearElement");if(r.type==="freedraw")return M("hints.freeDraw");if(r.type==="text")return M("hints.text");if(r.type==="embeddable")return M("hints.embeddable");const c=i.scene.getSelectedElements(e);if(s&&a==="mouse"&&c.length===1){const m=c[0];return xe(m)&&m.points.length===2?M("hints.lockAngle",{shortcut:Mt("Shift")}):yt(m)?M("hints.resizeImage",{shortcut_1:Mt("Shift"),shortcut_2:Mt("Alt")}):M("hints.resize",{shortcut_1:Mt("Shift"),shortcut_2:Mt("Alt")})}if(o&&a==="mouse")return M("hints.rotate",{shortcut:Mt("Shift")});if(c.length===1&&ge(c[0]))return M("hints.text_selected",{shortcut:Mt("Enter")});if(e.editingTextElement)return M("hints.text_editing",{shortcut_1:Mt("Escape"),shortcut_2:Mt(["CtrlOrCmd","Enter"])});if(e.croppingElementId)return M("hints.leaveCropEditor",{shortcut_1:Mt("Enter"),shortcut_2:Mt("Escape")});if(c.length===1&&yt(c[0]))return M("hints.enterCropEditor",{shortcut:Mt("Enter")});if(r.type==="selection"){if(e.selectionElement&&!c.length&&!e.editingTextElement&&!((f=e.selectedLinearElement)!=null&&f.isEditing))return M("hints.deepBoxSelect",{shortcut:Mt("CtrlOrCmd")});if(Vm(i)&&e.selectedElementsAreBeingDragged)return M("hints.disableSnapping",{shortcut:Mt("CtrlOrCmd")});if(!c.length&&!t)return M("hints.canvasPanning",{shortcut_1:Mt(M("keys.mmb")),shortcut_2:Mt("Space")});if(c.length===1){if(xe(c[0]))return(h=e.selectedLinearElement)!=null&&h.isEditing?e.selectedLinearElement.selectedPointsIndices?M("hints.lineEditor_pointSelected",{shortcut_1:Mt("Delete"),shortcut_2:Mt(["CtrlOrCmd","D"])}):M("hints.lineEditor_nothingSelected",{shortcut_1:Mt("Shift"),shortcut_2:Mt("Alt")}):nn(c[0])?M("hints.lineEditor_line_info",{shortcut:Mt("Enter")}):M("hints.lineEditor_info",{shortcut_1:Mt("CtrlOrCmd"),shortcut_2:Mt(["CtrlOrCmd","Enter"])});if(!e.newElement&&!e.selectedElementsAreBeingDragged&&eu(c[0])){const m=M("hints.bindTextToElement",{shortcut:Mt("Enter")}),p=M("hints.createFlowchart",{shortcut:Mt(["CtrlOrCmd",""])});return oy(c[0])?kde(c[0],i.scene.getNonDeletedElementsMap())?[m,p]:[m,p]:m}}}return null},Cve=({appState:e,isMobile:t,editorInterface:n,app:i})=>{const r=xve({appState:e,isMobile:t,editorInterface:n,app:i});if(!r)return null;const o=(Array.isArray(r)?r.map(a=>a.replace(/\. ?$/,"")).join(", "):r).split(/(<kbd>[^<]+<\/kbd>)/g).map((a,l)=>{if(l%2===1){const c=a[0]==="<"&&a.match(/^<kbd>([^<]+)<\/kbd>$/);return g("kbd",{children:c?c[1]:a},l)}return a});return g("div",{className:"HintViewer",children:g("span",{children:o})})},Ave=2e3,iI=()=>{const[e,t]=R.useState(null),n=R.useRef(0),i=()=>{clearTimeout(n.current),t("success"),n.current=window.setTimeout(()=>{t(null)},Ave)},r=R.useCallback(()=>{t(null)},[]);return{copyStatus:e,resetCopyStatus:r,onCopy:i}},u2=({title:e,name:t,checked:n,onChange:i,disabled:r=!1})=>g("div",{className:le("Switch",{toggled:n,disabled:r}),children:g("input",{name:t,id:t,title:e,type:"checkbox",checked:n,disabled:r,onChange:()=>i(!n),onKeyDown:s=>{s.key===" "&&i(!n)}})}),Mve="filter"in document.createElement("canvas").getContext("2d"),kve=()=>N("div",{children:[g("h3",{children:M("canvasError.cannotShowPreview")}),g("p",{children:g("span",{children:M("canvasError.canvasTooBig")})}),N("em",{children:["(",M("canvasError.canvasTooBigTip"),")"]})]}),Rve=({appStateSnapshot:e,elementsSnapshot:t,files:n,actionManager:i,onExportImage:r,name:s})=>{const o=Wn(t,e),[a,l]=R.useState(s),[c,d]=R.useState(o),[u,f]=R.useState(e.exportBackground),[h,m]=R.useState(e.exportWithDarkMode),[p,U]=R.useState(e.exportEmbedScene),[b,y]=R.useState(e.exportScale),w=R.useRef(null),[v,I]=R.useState(null),{onCopy:C,copyStatus:_,resetCopyStatus:T}=iI();R.useEffect(()=>{T()},[a,u,h,b,p,T]);const{exportedElements:k,exportingFrame:x}=Yy(t,e,c);return R.useEffect(()=>{const D=w.current;if(!D)return;const O=D.offsetWidth,L=D.offsetHeight;O&&Qy({elements:k,appState:{...e,name:a,exportBackground:u,exportWithDarkMode:h,exportScale:b,exportEmbedScene:p},files:n,exportPadding:vg,maxWidthOrHeight:Math.max(O,L),exportingFrame:x}).then(Y=>(I(null),Pm(Y).then(()=>{D.replaceChildren(Y)}).catch($=>{throw $.name==="CANVAS_POSSIBLY_TOO_BIG"?new Error(M("canvasError.canvasTooBig")):$}))).catch(Y=>{console.error(Y),I(Y)})},[e,n,k,x,a,u,h,b,p]),N("div",{className:"ImageExportModal",children:[g("h3",{children:M("imageExportDialog.header")}),N("div",{className:"ImageExportModal__preview",children:[g("div",{className:"ImageExportModal__preview__canvas",ref:w,children:v&&g(kve,{})}),g("div",{className:"ImageExportModal__preview__filename",children:!Wu&&g("input",{type:"text",className:"TextInput",value:a,style:{width:"30ch"},onChange:D=>{l(D.target.value),i.executeAction(Kye,"ui",D.target.value)}})})]}),N("div",{className:"ImageExportModal__settings",children:[g("h3",{children:M("imageExportDialog.header")}),o&&g(w1,{label:M("imageExportDialog.label.onlySelected"),name:"exportOnlySelected",children:g(u2,{name:"exportOnlySelected",checked:c,onChange:D=>{d(D)}})}),g(w1,{label:M("imageExportDialog.label.withBackground"),name:"exportBackgroundSwitch",children:g(u2,{name:"exportBackgroundSwitch",checked:u,onChange:D=>{f(D),i.executeAction(qye,"ui",D)}})}),Mve&&g(w1,{label:M("imageExportDialog.label.darkMode"),name:"exportDarkModeSwitch",children:g(u2,{name:"exportDarkModeSwitch",checked:h,onChange:D=>{m(D),i.executeAction(Qye,"ui",D)}})}),g(w1,{label:M("imageExportDialog.label.embedScene"),tooltip:M("imageExportDialog.tooltip.embedScene"),name:"exportEmbedSwitch",children:g(u2,{name:"exportEmbedSwitch",checked:p,onChange:D=>{U(D),i.executeAction(MX,"ui",D)}})}),g(w1,{label:M("imageExportDialog.label.scale"),name:"exportScale",children:g(oY,{name:"exportScale",value:b,onChange:D=>{y(D),i.executeAction(Zye,"ui",D)},choices:H_.map(D=>({value:D,label:`${D}`}))})}),N("div",{className:"ImageExportModal__settings__buttons",children:[g(Rs,{className:"ImageExportModal__settings__buttons__button",label:M("imageExportDialog.title.exportToPng"),onClick:()=>r(C8.png,k,{exportingFrame:x}),icon:dk,children:M("imageExportDialog.button.exportToPng")}),g(Rs,{className:"ImageExportModal__settings__buttons__button",label:M("imageExportDialog.title.exportToSvg"),onClick:()=>r(C8.svg,k,{exportingFrame:x}),icon:dk,children:M("imageExportDialog.button.exportToSvg")}),(HT||um)&&g(Rs,{className:"ImageExportModal__settings__buttons__button",label:M("imageExportDialog.title.copyPngToClipboard"),status:_,onClick:async()=>{await r(C8.clipboard,k,{exportingFrame:x}),C()},icon:Np,children:M("imageExportDialog.button.copyPngToClipboard")})]})]})]})},w1=({label:e,children:t,tooltip:n,name:i})=>N("div",{className:"ImageExportModal__settings__setting",title:e,children:[N("label",{htmlFor:i,className:"ImageExportModal__settings__setting__label",children:[e,n&&g(Ul,{label:n,long:!0,children:Rfe})]}),g("div",{className:"ImageExportModal__settings__setting__content",children:t})]}),Dve=({elements:e,appState:t,files:n,actionManager:i,onExportImage:r,onCloseRequest:s,name:o})=>{const[{appStateSnapshot:a,elementsSnapshot:l}]=R.useState(()=>({appStateSnapshot:Qa(t),elementsSnapshot:Qa(e)}));return g(as,{onCloseRequest:s,size:"wide",title:!1,children:g(Rve,{elementsSnapshot:l,appStateSnapshot:a,files:n,actionManager:i,onExportImage:r,name:o})})},Wv=({children:e,color:t})=>g("div",{className:"Card",style:{"--card-color":t==="primary"?"var(--color-primary)":yi[t][7],"--card-color-darker":t==="primary"?"var(--color-primary-darker)":yi[t][8],"--card-color-darkest":t==="primary"?"var(--color-primary-darkest)":yi[t][9]},children:e}),Lve=({elements:e,appState:t,setAppState:n,files:i,actionManager:r,exportOpts:s,canvas:o,onCloseRequest:a})=>{const{onExportToBackend:l}=s;return g("div",{className:"ExportDialog ExportDialog--json",children:N("div",{className:"ExportDialog-cards",children:[s.saveFileToDisk&&N(Wv,{color:"lime",children:[g("div",{className:"Card-icon",children:Bue}),g("h2",{children:M("exportDialog.disk_title")}),N("div",{className:"Card-details",children:[M("exportDialog.disk_details"),!Wu&&r.renderAction("changeProjectName")]}),g(je,{className:"Card-button",type:"button",title:M("exportDialog.disk_button"),"aria-label":M("exportDialog.disk_button"),showAriaLabel:!0,onClick:()=>{r.executeAction(kX,"ui")}})]}),l&&N(Wv,{color:"pink",children:[g("div",{className:"Card-icon",children:N6}),g("h2",{children:M("exportDialog.link_title")}),g("div",{className:"Card-details",children:M("exportDialog.link_details")}),g(je,{className:"Card-button",type:"button",title:M("exportDialog.link_button"),"aria-label":M("exportDialog.link_button"),showAriaLabel:!0,onClick:async()=>{try{et("export","link",`ui (${wp()})`),await l(e,t,i),a()}catch(c){n({errorMessage:c.message})}}})]}),s.renderCustomUI&&s.renderCustomUI(e,t,i,o)]})})},Nve=({elements:e,appState:t,files:n,actionManager:i,exportOpts:r,canvas:s,setAppState:o})=>{var l;const a=de.useCallback(()=>{o({openDialog:null})},[o]);return g(fe,{children:((l=t.openDialog)==null?void 0:l.name)==="jsonExport"&&g(as,{onCloseRequest:a,title:M("buttons.export"),children:g(Lve,{elements:e,appState:t,setAppState:o,files:n,actionManager:i,onCloseRequest:a,exportOpts:r,canvas:s})})})},Ove="small",Pve=e=>N("label",{className:le("ToolIcon ToolIcon__LaserPointer",`ToolIcon_size_${Ove}`,{"is-mobile":e.isMobile}),title:`${e.title}`,children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,onChange:e.onChange,checked:e.checked,"aria-label":e.title,"data-testid":"toolbar-LaserPointer"}),g("div",{className:"ToolIcon__icon",children:_m})]}),Fve=({UIOptions:e})=>N(It,{__fallback:!0,children:[g(It.DefaultItems.LoadScene,{}),g(It.DefaultItems.SaveToActiveFile,{}),e.canvasActions.export&&g(It.DefaultItems.Export,{}),e.canvasActions.saveAsImage&&g(It.DefaultItems.SaveAsImage,{}),g(It.DefaultItems.SearchMenu,{}),g(It.DefaultItems.Help,{}),g(It.DefaultItems.ClearCanvas,{}),g(It.Separator,{}),g(It.Group,{title:"Excalidraw links",children:g(It.DefaultItems.Socials,{})}),g(It.Separator,{}),g(It.DefaultItems.ToggleTheme,{}),g(It.DefaultItems.ChangeCanvasBackground,{})]}),Bve=()=>N($d,{__fallback:!0,children:[g($d.Actions.SaveToDisk,{}),g($d.Actions.ExportToImage,{})]}),zve=({actionManager:e,appState:t,files:n,setAppState:i,elements:r,canvas:s,onLockToggle:o,onHandToolToggle:a,onPenModeToggle:l,showExitZenModeBtn:c,renderTopLeftUI:d,renderTopRightUI:u,renderCustomStats:f,UIOptions:h,onExportImage:m,renderWelcomeScreen:p,children:U,app:b,isCollaborating:y,generateLinkForSelection:w})=>{var X,K,ne;const v=Nn(),C=fa()==="compact",_=I3e(),T=C?{menuTopGap:4,toolbarColGap:4,toolbarRowGap:1,toolbarInnerRowGap:.5,islandPadding:1,collabMarginLeft:8}:{menuTopGap:6,toolbarColGap:4,toolbarRowGap:1,toolbarInnerRowGap:1,islandPadding:1,collabMarginLeft:8},k=_.tunnelsJotai.Provider,[x,D]=un(Ay),O=()=>h.canvasActions.export?g(Nve,{elements:r,appState:t,files:n,actionManager:e,exportOpts:h.canvasActions.export,canvas:s,setAppState:i}):null,L=()=>{var se;return!h.canvasActions.saveAsImage||((se=t.openDialog)==null?void 0:se.name)!=="imageExport"?null:g(Dve,{elements:r,appState:t,files:n,actionManager:e,onExportImage:m,onCloseRequest:()=>i({openDialog:null}),name:b.getName()})},Y=()=>N("div",{style:{position:"relative"},children:[g(_.MainMenuTunnel.Out,{}),p&&g(_.WelcomeScreenMenuHintTunnel.Out,{})]}),$=()=>{const se=C;return g(Hv,{heading:"selectedShapeActions",className:le("selected-shape-actions zen-mode-transition",{"transition-left":t.zenModeEnabled}),children:se?g(Is,{className:le("compact-shape-actions-island"),padding:0,style:{maxHeight:`${t.height-166}px`},children:g(C3e,{appState:t,elementsMap:b.scene.getNonDeletedElementsMap(),renderAction:e.renderAction,app:b,setAppState:i})}):g(Is,{className:Jr.SHAPE_ACTIONS_MENU,padding:2,style:{maxHeight:`${t.height-166}px`},children:g(S3e,{appState:t,elementsMap:b.scene.getNonDeletedElementsMap(),renderAction:e.renderAction,app:b})})})},H=()=>{var Ee,Re,De,vt,Vt;const se=jde(t,r),oe=t.stats.open&&!t.zenModeEnabled&&!t.viewModeEnabled&&((Ee=t.openDialog)==null?void 0:Ee.name)!=="elementLinkSelector";return g(Sj,{side:"top",children:N("div",{className:"App-menu App-menu_top",children:[N(ja.Col,{gap:T.menuTopGap,className:le("App-menu_top__left"),children:[Y(),g("div",{className:le("selected-shape-actions-container",{"selected-shape-actions-container--compact":C}),children:se&&$()})]}),!t.viewModeEnabled&&((Re=t.openDialog)==null?void 0:Re.name)!=="elementLinkSelector"&&g(Hv,{heading:"shapes",className:"shapes-section",children:Be=>N("div",{style:{position:"relative"},children:[p&&g(_.WelcomeScreenToolbarHintTunnel.Out,{}),g(ja.Col,{gap:T.toolbarColGap,align:"start",children:N(ja.Row,{gap:T.toolbarRowGap,className:le("App-toolbar-container",{"zen-mode":t.zenModeEnabled}),children:[N(Is,{padding:T.islandPadding,className:le("App-toolbar",{"zen-mode":t.zenModeEnabled,"App-toolbar--compact":C}),children:[g(Cve,{appState:t,isMobile:v.formFactor==="phone",editorInterface:v,app:b}),Be,N(ja.Row,{gap:T.toolbarInnerRowGap,children:[g(xj,{zenModeEnabled:t.zenModeEnabled,checked:t.penMode,onChange:()=>l(null),title:M("toolBar.penMode"),penDetected:t.penDetected}),g(N7e,{checked:t.activeTool.locked,onChange:o,title:M("toolBar.lock")}),g("div",{className:"App-toolbar__divider"}),g(Ij,{checked:Qh(t),onChange:()=>a(),title:M("toolBar.hand"),isMobile:!0}),g(M3e,{setAppState:i,activeTool:t.activeTool,UIOptions:h,app:b})]})]}),y&&g(Is,{style:{marginLeft:T.collabMarginLeft,alignSelf:"center",height:"fit-content"},children:g(Pve,{title:M("toolBar.laser"),checked:t.activeTool.type===Qn.laser,onChange:()=>b.setActiveTool({type:Qn.laser}),isMobile:!0})})]})})]})}),N("div",{className:le("layer-ui__wrapper__top-right zen-mode-transition",{"transition-right":t.zenModeEnabled,"layer-ui__wrapper__top-right--compact":C}),children:[t.collaborators.size>0&&g(Cj,{collaborators:t.collaborators,userToFollow:((De=t.userToFollow)==null?void 0:De.socketId)||null}),u==null?void 0:u(v.formFactor==="phone",t),!t.viewModeEnabled&&((vt=t.openDialog)==null?void 0:vt.name)!=="elementLinkSelector"&&(!G||((Vt=t.openSidebar)==null?void 0:Vt.name)!==As.name)&&g(_.DefaultSidebarTriggerTunnel.Out,{}),oe&&g(Ma,{app:b,onClose:()=>{e.executeAction(Av)},renderCustomStats:f})]})]})})},z=()=>g(s5,{__fallback:!0,onDock:se=>{et("sidebar",`toggleDock (${se?"dock":"undock"})`,`(${v.formFactor==="phone"?"mobile":"desktop"})`)}}),G=HH(QT),j=N(fe,{children:[U,g(Fve,{UIOptions:h}),g(s5.Trigger,{__fallback:!0,icon:ahe,title:kt(M("toolBar.library")),onToggle:se=>{se&&et("sidebar",`${As.name} (open)`,`button (${v.formFactor==="phone"?"mobile":"desktop"})`)},tab:As.defaultTab}),g(Bve,{}),((X=t.openDialog)==null?void 0:X.name)==="ttd"&&g(kY,{__fallback:!0}),t.isLoading&&g(Tj,{delay:250}),t.errorMessage&&g(nI,{onClose:()=>i({errorMessage:null}),children:t.errorMessage}),x&&v.formFactor!=="phone"&&g(e0e,{colorPickerType:x.colorPickerType,onCancel:()=>{D(null)},onChange:(se,oe,Ee,{altKey:Re})=>{if(!(se!=="elementBackground"&&se!=="elementStroke"))if(Ee.length){for(const De of Ee)_i(De,ve(r),{[Re&&x.swapPreviewOnAlt?se==="elementBackground"?"strokeColor":"backgroundColor":se==="elementBackground"?"backgroundColor":"strokeColor"]:oe}),qt.delete(De);b.scene.triggerUpdate()}else i(se==="elementBackground"?{currentItemBackgroundColor:oe}:{currentItemStrokeColor:oe})},onSelect:(se,oe)=>{var Ee;D(Re=>Re!=null&&Re.keepOpenOnAlt&&oe.altKey?Re:null),(Ee=x==null?void 0:x.onSelect)==null||Ee.call(x,se,oe)}}),((K=t.openDialog)==null?void 0:K.name)==="help"&&g(Sve,{onClose:()=>{i({openDialog:null})}}),g(N3e,{}),((ne=t.openDialog)==null?void 0:ne.name)==="elementLinkSelector"&&g(Eve,{sourceElementId:t.openDialog.sourceElementId,onClose:()=>{i({openDialog:null})},scene:b.scene,appState:t,generateLinkForSelection:w}),g(_.OverwriteConfirmDialogTunnel.Out,{}),L(),O(),t.pasteDialog.shown&&g(B7e,{setAppState:i,appState:t,onClose:()=>i({pasteDialog:{shown:!1,data:null}})}),v.formFactor==="phone"&&g(F7e,{app:b,appState:t,elements:r,actionManager:e,renderJSONExportDialog:O,renderImageExportDialog:L,setAppState:i,onHandToolToggle:a,onPenModeToggle:l,renderTopLeftUI:d,renderTopRightUI:u,renderSidebars:z,renderWelcomeScreen:p,UIOptions:h}),v.formFactor!=="phone"&&N(fe,{children:[N("div",{className:"layer-ui__wrapper",style:t.openSidebar&&G&&v.canFitSidebar?{width:"calc(100% - var(--right-sidebar-width))"}:{},children:[p&&g(_.WelcomeScreenCenterTunnel.Out,{}),H(),g(Aj,{appState:t,actionManager:e,showExitZenModeBtn:c,renderWelcomeScreen:p}),t.scrolledOutside&&g("button",{type:"button",className:"scroll-back-to-content",onClick:()=>{i(se=>({...wm(r,se)}))},children:M("buttons.scrollBackToContent")})]}),z()]})]});return g(Z$.Provider,{value:t,children:g(k,{children:g(hj.Provider,{value:_,children:j})})})},YD=e=>{const{suggestedBindings:t,startBoundElement:n,cursorButton:i,scrollX:r,scrollY:s,...o}=e;return o},Hve=(e,t)=>{if(e.children!==t.children)return!1;const{canvas:n,appState:i,...r}=e,{canvas:s,appState:o,...a}=t;return Ki(YD(i),YD(o),{selectedElementIds:Ki,selectedGroupIds:Ki})&&Ki(r,a)},Vve=de.memo(zve,Hve),$ve="small",X3=e=>N("label",{className:le("ToolIcon ToolIcon__MagicButton",`ToolIcon_size_${$ve}`,{"is-mobile":e.isMobile}),title:`${e.title}`,children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,onChange:e.onChange,checked:e.checked,"aria-label":e.title}),g("div",{className:"ToolIcon__icon",children:e.icon})]}),Gve=({trails:e})=>{const t=R.useRef(null);return R.useEffect(()=>{if(t.current)for(const n of e)n.start(t.current);return()=>{for(const n of e)n.stop()}},e),g("div",{className:"SVGLayer",children:g("svg",{ref:t})})},di=class di{static start(t,n){const i=n({deltaTime:0,state:void 0});i&&(di.animations.set(t,{animation:n,lastTime:0,state:i}),di.isRunning||(di.isRunning=!0,r5()?requestAnimationFrame(di.tick):setTimeout(di.tick,0)))}static tick(){if(di.animations.size>0){for(const[t,n]of di.animations){const i=performance.now(),r=n.lastTime===0?0:i-n.lastTime,s=n.animation({deltaTime:r,state:n.state});if(s)n.lastTime=i,n.state=s;else if(di.animations.delete(t),di.animations.size===0){di.isRunning=!1;return}}r5()?requestAnimationFrame(di.tick):setTimeout(di.tick,0)}}static running(t){return di.animations.has(t)}static cancel(t){di.animations.delete(t)}};F(di,"isRunning",!1),F(di,"animations",new Map);let c5=di;const Xve="#ff6b6b",jve="#ff0000",WD=1,KD=2,Yve=(e,t)=>{if(!t.snapLines.length)return;const n=t.theme===ke.LIGHT||t.zenModeEnabled?Xve:jve,i=(t.zenModeEnabled?WD*1.5:WD)/t.zoom.value;e.save(),e.translate(t.scrollX,t.scrollY);for(const r of t.snapLines)r.type==="pointer"?(e.lineWidth=i,e.strokeStyle=n,Kve(r,e,t)):r.type==="gap"?(e.lineWidth=i,e.strokeStyle=n,Zve(r.points[0],r.points[1],r.direction,t,e)):r.type==="points"&&(e.lineWidth=i,e.strokeStyle=n,Wve(r,e,t));e.restore()},Wve=(e,t,n)=>{if(!n.zenModeEnabled){const i=e.points[0],r=e.points[e.points.length-1];us(i,r,t)}for(const i of e.points)RY(i,n,t)},Kve=(e,t,n)=>{RY(e.points[0],n,t),n.zenModeEnabled||us(e.points[0],e.points[1],t)},RY=([e,t],n,i)=>{i.save();const r=(n.zenModeEnabled?KD*1.5:KD)/n.zoom.value;i.beginPath(),i.moveTo(e-r,t-r),i.lineTo(e+r,t+r),i.moveTo(e+r,t-r),i.lineTo(e-r,t+r),i.stroke(),i.restore()},us=(e,t,n)=>{n.beginPath(),n.lineTo(e[0],e[1]),n.lineTo(t[0],t[1]),n.stroke()},Zve=(e,t,n,i,r)=>{const s=8/i.zoom.value,o=s/2,a=s/4;if(n==="horizontal"){const l=[(e[0]+t[0])/2,e[1]];i.zenModeEnabled||us(S(e[0],e[1]-s),S(e[0],e[1]+s),r),us(S(l[0]-a,l[1]-o),S(l[0]-a,l[1]+o),r),us(S(l[0]+a,l[1]-o),S(l[0]+a,l[1]+o),r),i.zenModeEnabled||(us(S(t[0],t[1]-s),S(t[0],t[1]+s),r),us(e,t,r))}else{const l=[e[0],(e[1]+t[1])/2];i.zenModeEnabled||us(S(e[0]-s,e[1]),S(e[0]+s,e[1]),r),us(S(l[0]-o,l[1]-a),S(l[0]+o,l[1]-a),r),us(S(l[0]-o,l[1]+a),S(l[0]+o,l[1]+a),r),i.zenModeEnabled||(us(S(t[0]-s,t[1]),S(t[0]+s,t[1]),r),us(e,t,r))}},qve=(e,t)=>{gn(t.selectedLinearElement,"selectedLinearElement is null");const{segmentMidPointHoveredCoords:n}=t.selectedLinearElement;gn(n,"midPointCoords is null"),e.save(),e.translate(t.scrollX,t.scrollY),DY(n,e,t),e.restore()},Qve=(e,t,n)=>{var a,l,c;const{elementId:i,hoverPointIndex:r}=t.selectedLinearElement;if((a=t.selectedLinearElement)!=null&&a.isEditing&&((c=(l=t.selectedLinearElement)==null?void 0:l.selectedPointsIndices)!=null&&c.includes(r)))return;const s=pe.getElement(i,n);if(!s)return;const o=pe.getPointAtIndexGlobalCoordinates(s,r,n);e.save(),e.translate(t.scrollX,t.scrollY),DY(o,e,t),e.restore()},DY=(e,t,n)=>{t.fillStyle="rgba(105, 101, 219, 0.4)",Vy(t,e[0],e[1],pe.POINT_HANDLE_SIZE/n.zoom.value,!1)},j3=(e,t,n,i,r,s,o)=>{var a;e.strokeStyle="#5e5ad8",e.setLineDash([]),e.fillStyle="rgba(255, 255, 255, 0.9)",r?e.fillStyle="rgba(134, 131, 226, 0.9)":s&&(e.fillStyle="rgba(177, 151, 252, 0.7)"),Vy(e,n[0],n[1],(o?i*((a=t.selectedLinearElement)!=null&&a.isEditing?1.5:2):i)/t.zoom.value,!s,!o||r)},Jve=(e,t,n,i)=>{const r=Tg(t,t.width,t.height,i);switch(e.fillStyle="rgba(0,0,0,.05)",t.type){case"rectangle":case"text":case"image":case"iframe":case"embeddable":case"frame":case"magicframe":eye(e,t,n,r);break;case"diamond":nye(e,r,t,n);break;case"ellipse":{const[s,o,a,l]=$e(t,n),c=a-s,d=l-o;e.strokeStyle="rgba(0,0,0,.05)",e.lineWidth=r-Rt,tye(e,c+r+Rt,d+r+Rt,s+c/2,o+d/2,t.angle);break}}},ewe=(e,t,n,i)=>{const[r,s,o]=t,a=Tg(o,o.width,o.height,i);e.strokeStyle="rgba(0,0,0,0)",e.fillStyle="rgba(0,0,0,.05)",(s==="both"?[0,-1]:s==="start"?[0]:[-1]).forEach(c=>{const[d,u]=pe.getPointAtIndexGlobalCoordinates(r,c,n);Vy(e,d,u,a,!0)})},LY=(e,t,n)=>{const{angle:i,x1:r,y1:s,x2:o,y2:a,selectionColors:l,cx:c,cy:d,dashed:u,activeEmbeddable:f}=n,h=o-r,m=a-s,U=(n.padding??pu*2)/t.zoom.value,b=8/t.zoom.value,y=4/t.zoom.value;e.save(),e.translate(t.scrollX,t.scrollY),e.lineWidth=(f?4:1)/t.zoom.value;const w=l.length;for(let v=0;v<w;++v)e.strokeStyle=l[v],u&&e.setLineDash([b,y+(b+y)*(w-1)]),e.lineDashOffset=(b+y)*v,Xy(e,r-U,s-U,h+U*2,m+U*2,c,d,i);e.restore()},twe=(e,t,n,i)=>{const r=Array.isArray(n)?ewe:Jve;e.save(),e.translate(t.scrollX,t.scrollY),r(e,n,i,t.zoom),e.restore()},nwe=(e,t,n,i)=>{const[r,s,o,a]=$e(n,i),l=o-r,c=a-s;e.strokeStyle="rgb(0,118,255)",e.lineWidth=zt.strokeWidth/t.zoom.value,e.save(),e.translate(t.scrollX,t.scrollY),Xy(e,r,s,l,c,r+l/2,s+c/2,n.angle,!1,zt.radius/t.zoom.value),e.restore()},ZD=(e,t,n,i)=>{const{colors:r=["rgb(0,118,255)"],dashed:s=!1}=i||{},o=n.filter(d=>d.groupIds.length===0),a=n.filter(d=>d.groupIds.length>0),l=d=>{const[u,f,h,m]=ht(d);return{angle:0,x1:u,x2:h,y1:f,y2:m,selectionColors:r,dashed:s,cx:u+(h-u)/2,cy:f+(m-f)/2,activeEmbeddable:!1}},c=d=>{const u=At(n,d);return l(u)};Object.entries(kp(a,t)).filter(([d,u])=>u).map(([d,u])=>d).map(d=>c(d)).concat(o.map(d=>l([d]))).forEach(d=>LY(e,t,d))},Y3=(e,t,n,i)=>{var c,d;if(!t.selectedLinearElement)return;e.save(),e.translate(t.scrollX,t.scrollY),e.lineWidth=1/t.zoom.value;const r=pe.getPointsGlobalCoordinates(n,i),{POINT_HANDLE_SIZE:s}=pe,o=(c=t.selectedLinearElement)!=null&&c.isEditing?s:s/2,a=me(n),l=nn(n);if(r.forEach((u,f)=>{var p,U,b,y,w,v;if(a&&f!==0&&f!==r.length-1)return;const h=f>0&&(f!==r.length-1||!l||!n.polygon)&&Os(u,f===r.length-1?r[0]:r[f-1],2/t.zoom.value);let m=!!((p=t.selectedLinearElement)!=null&&p.isEditing)&&!!((b=(U=t.selectedLinearElement)==null?void 0:U.selectedPointsIndices)!=null&&b.includes(f));l&&n.polygon&&!m&&f===n.points.length-1&&((y=t.selectedLinearElement)!=null&&y.isEditing)&&((v=(w=t.selectedLinearElement)==null?void 0:w.selectedPointsIndices)!=null&&v.includes(0))&&(m=!0),j3(e,t,u,o,m,!1,h)}),me(n)){const u=((d=n.fixedSegments)==null?void 0:d.map(f=>f.index))||[];r.slice(0,-1).forEach((f,h)=>{pe.isSegmentTooShort(n,r[h+1],r[h],h,t.zoom)||j3(e,t,S((f[0]+r[h+1][0])/2,(f[1]+r[h+1][1])/2),s/2,!1,!u.includes(h+1),!1)})}else pe.getEditorMidPoints(n,i,t).filter((f,h,m)=>f!==null&&!(me(n)&&(h===0||h===m.length-1))).forEach(f=>{var h;((h=t.selectedLinearElement)!=null&&h.isEditing||r.length===2)&&j3(e,t,f,s/2,!1,!0,!1)});e.restore()},qD=(e,t,n,i,r)=>{Object.keys(i).forEach(s=>{const o=i[s];if(o!==void 0){const[a,l,c,d]=o;e.save(),e.lineWidth=1/n.zoom.value,t.selectionColor&&(e.strokeStyle=t.selectionColor),s==="rotation"?Vy(e,a+c/2,l+d/2,c/2,!0):e.roundRect?(e.beginPath(),e.roundRect(a,l,c,d,2/n.zoom.value),e.fill(),e.stroke()):Xy(e,a,l,c,d,a+c/2,l+d/2,r,!0),e.restore()}})},iwe=(e,t,n,i,r)=>{const[s,o,,,a,l]=$e(i,r),c=3,d=20,u=c/n.zoom.value,f=u/2,h=a-s+u,m=l-o+u,p=Math.min(d/n.zoom.value,h),U=Math.min(d/n.zoom.value,m);e.save(),e.fillStyle=t.selectionColor,e.strokeStyle=t.selectionColor,e.lineWidth=u,[[[-h,-m],[0,f],[p,f],[f,0],[f,U]],[[h-f,-m],[f,f],[-p+f,f],[0,0],[0,U]],[[-h,m],[0,-f],[p,-f],[f,0],[f,-U]],[[h-f,m],[f,-f],[-p+f,-f],[0,0],[0,-U]]].forEach(y=>{const[[w,v],[I,C],[_,T],[k,x],[D,O]]=y;e.save(),e.translate(a,l),e.rotate(i.angle),e.beginPath(),e.moveTo(w+I,v+C),e.lineTo(w+_,v+T),e.stroke(),e.beginPath(),e.moveTo(w+k,v+x),e.lineTo(w+D,v+O),e.stroke(),e.restore()}),e.restore()},rwe=(e,t,n,i)=>{t.save();const r=pu*2/n.zoom.value,s=e.width+r*2,o=e.height+r*2,a=e.x+s/2,l=e.y+o/2,c=-(s/2+r),d=-(o/2+r);t.translate(a+n.scrollX,l+n.scrollY),t.rotate(e.angle),t.lineWidth=1/n.zoom.value,t.strokeStyle=i,t.strokeRect(c,d,s,o),t.restore()},swe=({canvas:e,elementsMap:t,visibleElements:n,selectedElements:i,allElementsMap:r,scale:s,appState:o,renderConfig:a,editorInterface:l,animationState:c,deltaTime:d})=>{var y,w,v,I,C;if(e===null)return{atLeastOneVisibleElement:!1,elementsMap:t};const[u,f]=$y(e,s),h=c,m=Gy({canvas:e,scale:s,normalizedWidth:u,normalizedHeight:f});m.save(),m.scale(o.zoom.value,o.zoom.value);let p;if(n.forEach(_=>{var T;(T=o.selectedLinearElement)!=null&&T.isEditing&&o.selectedLinearElement.elementId===_.id&&_&&(p=_)}),p&&Y3(m,o,p,t),o.selectionElement&&!o.isCropping)try{oce(o.selectionElement,m,o,a.selectionColor)}catch(_){console.error(_)}if(o.editingTextElement&&ge(o.editingTextElement)){const _=r.get(o.editingTextElement.id);_&&!_.autoResize&&rwe(_,m,o,a.selectionColor)}if(o.isBindingEnabled&&o.suggestedBindings.filter(_=>_!=null).forEach(_=>{twe(m,o,_,t)}),o.frameToHighlight&&nwe(m,o,o.frameToHighlight,t),o.elementsToHighlight&&ZD(m,o,o.elementsToHighlight),o.activeLockedId){const _=r.get(o.activeLockedId),T=_?[_]:At(r,o.activeLockedId);ZD(m,o,T,{colors:["#ced4da"],dashed:!0})}const U=i.some(_=>we(_));if(i.length===1&&((y=o.selectedLinearElement)!=null&&y.isEditing)&&o.selectedLinearElement.elementId===i[0].id&&Y3(m,o,i[0],t),o.selectedLinearElement){const _=o.selectedLinearElement,T=i.find(k=>k.id===_.elementId);_.segmentMidPointHoveredCoords?qve(m,o):(me(T)?_.hoverPointIndex===0||_.hoverPointIndex===T.points.length-1:_.hoverPointIndex>=0)&&Qve(m,o,t)}if(!o.multiElement&&!((w=o.selectedLinearElement)!=null&&w.isEditing)){const _=wH(i,o,l),T=i.length===1&&xe(i[0]);T&&((v=o.selectedLinearElement)==null?void 0:v.elementId)===i[0].id&&!i[0].locked&&Y3(m,o,i[0],t);const k=a.selectionColor||yi.black;if(_){const x=ve(i),D=[];for(const L of t.values()){const Y=[],$=a.remoteSelectedElementIds.get(L.id);if(T&&me(L)&&(L.startBinding||L.endBinding)||(x.has(L.id)&&!U9(o,L)&&Y.push(k),$&&Y.push(...$.map(H=>Ky(H,o.collaborators.get(H))))),Y.length){const[H,z,G,j,X,K]=$e(L,t,!0);D.push({angle:L.angle,x1:H,y1:z,x2:G,y2:j,selectionColors:L.locked?["#ced4da"]:Y,dashed:!!$||L.locked,cx:X,cy:K,activeEmbeddable:((I=o.activeEmbeddable)==null?void 0:I.element)===L&&o.activeEmbeddable.state==="active",padding:L.id===o.croppingElementId||yt(L)?0:void 0})}}const O=L=>{const Y=At(t,L),[$,H,z,G]=ht(Y);D.push({angle:0,x1:$,x2:z,y1:H,y2:G,selectionColors:Y.some(j=>j.locked)?["#ced4da"]:[yi.black],dashed:!0,cx:$+(z-$)/2,cy:H+(G-H)/2,activeEmbeddable:!1})};for(const L of _c(o))O(L);o.editingGroupId&&O(o.editingGroupId),D.forEach(L=>LY(m,o,L))}if(m.save(),m.translate(o.scrollX,o.scrollY),i.length===1){m.fillStyle=yi.white;const x=vH(i[0],o.zoom,t,"mouse",C0(l));if(!o.viewModeEnabled&&_&&!ge(o.editingTextElement)&&!o.croppingElementId&&qD(m,a,o,x,i[0].angle),o.croppingElementId&&!o.isCropping){const D=t.get(o.croppingElementId);D&&yt(D)&&iwe(m,a,o,D,t)}}else if(i.length>1&&!o.isRotating&&!i.some(x=>x.locked)){const x=pu*2/o.zoom.value;m.fillStyle=yi.white;const[D,O,L,Y]=ht(i,t),$=m.getLineDash();m.setLineDash([2/o.zoom.value]);const H=m.lineWidth;m.lineWidth=1/o.zoom.value,m.strokeStyle=k,Xy(m,D-x,O-x,L-D+x*2,Y-O+x*2,(D+L)/2,(O+Y)/2,0),m.lineWidth=H,m.setLineDash($);const z=F9([D,O,L,Y,(D+L)/2,(O+Y)/2],0,o.zoom,"mouse",U?{...C0(l),rotation:!0}:C0(l));i.some(G=>!G.locked)&&qD(m,a,o,z,0)}m.restore()}(C=o.searchMatches)==null||C.matches.forEach(({id:_,focus:T,matchedLines:k})=>{const x=t.get(_);if(x){const[D,O,,,L,Y]=$e(x,t,!0);m.save(),o.theme===ke.LIGHT?T?m.fillStyle="rgba(255, 124, 0, 0.4)":m.fillStyle="rgba(255, 226, 0, 0.4)":T?m.fillStyle="rgba(229, 82, 0, 0.4)":m.fillStyle="rgba(99, 52, 0, 0.4)";const $=we(x)?o.zoom.value:1;m.translate(o.scrollX,o.scrollY),m.translate(L,Y),m.rotate(x.angle),k.forEach(H=>{(H.showOnCanvas||T)&&m.fillRect(D+H.offsetX/$-L,O+H.offsetY/$-Y,H.width/$,H.height/$)}),m.restore()}}),Yve(m,o),m.restore(),oEe({context:m,renderConfig:a,appState:o,normalizedWidth:u,normalizedHeight:f});let b;return a.renderScrollbars&&(b=E7e(t,u,f,o),m.save(),m.fillStyle=y7e,m.strokeStyle="rgba(255,255,255,0.8)",[b.horizontal,b.vertical].forEach(_=>{_&&DX(m,_.x,_.y,_.width,_.height,Ao/2)}),m.restore()),{scrollBars:b,atLeastOneVisibleElement:n.length>0,elementsMap:t,animationState:h}},owe=e=>{const t=swe(e);return e.callback(t),t},QD="animateInteractiveScene",awe=e=>{const t=R.useRef(!1),n=R.useRef(null);return R.useEffect(()=>{var c;if(!t.current){t.current=!0;return}const i=new Map,r=new Map,s=new Map,o=new Map,a=new Map;e.appState.collaborators.forEach((d,u)=>{if(d.selectedElementIds)for(const f of Object.keys(d.selectedElementIds))s.has(f)||s.set(f,[]),s.get(f).push(u);!d.pointer||d.pointer.renderCursor===!1||(d.username&&o.set(u,d.username),d.userState&&a.set(u,d.userState),r.set(u,Wr({sceneX:d.pointer.x,sceneY:d.pointer.y},e.appState)),i.set(u,d.button))});const l=((c=e.containerRef)==null?void 0:c.current)&&getComputedStyle(e.containerRef.current).getPropertyValue("--color-selection")||"#6965db";n.current={app:e.app,canvas:e.canvas,elementsMap:e.elementsMap,visibleElements:e.visibleElements,selectedElements:e.selectedElements,allElementsMap:e.allElementsMap,scale:window.devicePixelRatio,appState:e.appState,renderConfig:{remotePointerViewportCoords:r,remotePointerButton:i,remoteSelectedElementIds:s,remotePointerUsernames:o,remotePointerUserStates:a,selectionColor:l,renderScrollbars:e.renderScrollbars},editorInterface:e.editorInterface,callback:e.renderInteractiveSceneCallback,animationState:{bindingHighlight:void 0},deltaTime:0},c5.running(QD)||c5.start(QD,({deltaTime:d,state:u})=>{const f=owe({...n.current,deltaTime:d,animationState:u}).animationState;if(f){for(const h in f)if(f[h]!==void 0)return f}})}),g("canvas",{className:"excalidraw__canvas interactive",style:{width:e.appState.width,height:e.appState.height,cursor:e.appState.viewModeEnabled?Ct.GRAB:Ct.AUTO},width:e.appState.width*e.scale,height:e.appState.height*e.scale,ref:e.handleCanvasRef,onContextMenu:e.onContextMenu,onPointerMove:e.onPointerMove,onPointerUp:e.onPointerUp,onPointerCancel:e.onPointerCancel,onTouchMove:e.onTouchMove,onPointerDown:e.onPointerDown,onDoubleClick:e.appState.viewModeEnabled?void 0:e.onDoubleClick,children:M("labels.drawingCanvas")})},JD=e=>({zoom:e.zoom,scrollX:e.scrollX,scrollY:e.scrollY,width:e.width,height:e.height,viewModeEnabled:e.viewModeEnabled,openDialog:e.openDialog,editingGroupId:e.editingGroupId,selectedElementIds:e.selectedElementIds,frameToHighlight:e.frameToHighlight,offsetLeft:e.offsetLeft,offsetTop:e.offsetTop,theme:e.theme,selectionElement:e.selectionElement,selectedGroupIds:e.selectedGroupIds,selectedLinearElement:e.selectedLinearElement,multiElement:e.multiElement,isBindingEnabled:e.isBindingEnabled,suggestedBindings:e.suggestedBindings,isRotating:e.isRotating,elementsToHighlight:e.elementsToHighlight,collaborators:e.collaborators,activeEmbeddable:e.activeEmbeddable,snapLines:e.snapLines,zenModeEnabled:e.zenModeEnabled,editingTextElement:e.editingTextElement,isCropping:e.isCropping,croppingElementId:e.croppingElementId,searchMatches:e.searchMatches,activeLockedId:e.activeLockedId}),lwe=(e,t)=>e.selectionNonce!==t.selectionNonce||e.sceneNonce!==t.sceneNonce||e.scale!==t.scale||e.elementsMap!==t.elementsMap||e.visibleElements!==t.visibleElements||e.selectedElements!==t.selectedElements||e.renderScrollbars!==t.renderScrollbars?!1:Ki(JD(e.appState),JD(t.appState)),cwe=de.memo(awe,lwe),dwe=e=>{const t=R.useRef(null),n=R.useRef(!1);return R.useEffect(()=>{e.canvas.style.width=`${e.appState.width}px`,e.canvas.style.height=`${e.appState.height}px`,e.canvas.width=e.appState.width*e.scale,e.canvas.height=e.appState.height*e.scale},[e.appState.height,e.appState.width,e.canvas,e.scale]),R.useEffect(()=>{const i=t.current;if(!i)return;const r=e.canvas;n.current||(n.current=!0,i.replaceChildren(r),r.classList.add("excalidraw__canvas","static")),gX({canvas:r,rc:e.rc,scale:e.scale,elementsMap:e.elementsMap,allElementsMap:e.allElementsMap,visibleElements:e.visibleElements,appState:e.appState,renderConfig:e.renderConfig},r5())}),g("div",{className:"excalidraw__canvas-wrapper",ref:t})},eL=e=>({zoom:e.zoom,scrollX:e.scrollX,scrollY:e.scrollY,width:e.width,height:e.height,viewModeEnabled:e.viewModeEnabled,openDialog:e.openDialog,hoveredElementIds:e.hoveredElementIds,offsetLeft:e.offsetLeft,offsetTop:e.offsetTop,theme:e.theme,shouldCacheIgnoreZoom:e.shouldCacheIgnoreZoom,viewBackgroundColor:e.viewBackgroundColor,exportScale:e.exportScale,selectedElementsAreBeingDragged:e.selectedElementsAreBeingDragged,gridSize:e.gridSize,gridStep:e.gridStep,frameRendering:e.frameRendering,selectedElementIds:e.selectedElementIds,frameToHighlight:e.frameToHighlight,editingGroupId:e.editingGroupId,currentHoveredFontFamily:e.currentHoveredFontFamily,croppingElementId:e.croppingElementId}),uwe=(e,t)=>e.sceneNonce!==t.sceneNonce||e.scale!==t.scale||e.elementsMap!==t.elementsMap||e.visibleElements!==t.visibleElements?!1:Ki(eL(e.appState),eL(t.appState))&&Ki(e.renderConfig,t.renderConfig),fwe=de.memo(dwe,uwe),NY=({canvas:e,rc:t,newElement:n,elementsMap:i,allElementsMap:r,scale:s,appState:o,renderConfig:a})=>{var l;if(e){const[c,d]=$y(e,s),u=Gy({canvas:e,scale:s,normalizedWidth:c,normalizedHeight:d});if(u.save(),u.scale(o.zoom.value,o.zoom.value),n&&n.type!=="selection"){if(tl(n))return;if((n.frameId||((l=o.frameToHighlight)==null?void 0:l.id))&&o.frameRendering.enabled&&o.frameRendering.clip){const h=v6(n,i,o);h&&O4(n,h,o,i)&&Iv(h,u,a,o)}Sd(n,i,r,t,u,a,o)}else u.clearRect(0,0,c,d);u.restore()}},hwe=vp(e=>{NY(e)},{trailing:!0}),gwe=(e,t)=>{if(t){hwe(e);return}NY(e)},mwe=e=>{const t=R.useRef(null);return R.useEffect(()=>{t.current&&gwe({canvas:t.current,scale:e.scale,newElement:e.appState.newElement,elementsMap:e.elementsMap,allElementsMap:e.allElementsMap,rc:e.rc,renderConfig:e.renderConfig,appState:e.appState},r5())}),g("canvas",{className:"excalidraw__canvas",style:{width:e.appState.width,height:e.appState.height},width:e.appState.width*e.scale,height:e.appState.height*e.scale,ref:t})},pwe=5e3,Uwe=({message:e,onClose:t,closable:n=!1,duration:i=pwe,style:r})=>{const s=R.useRef(0),o=i!==1/0,a=R.useCallback(()=>{o&&(s.current=window.setTimeout(()=>t(),i))},[t,i,o]);return R.useEffect(()=>{if(o)return a(),()=>clearTimeout(s.current)},[a,e,i,o]),N("div",{className:"Toast",onMouseEnter:o?()=>clearTimeout(s==null?void 0:s.current):void 0,onMouseLeave:o?a:void 0,style:r,children:[g("p",{className:"Toast__message",children:e}),n&&g(je,{icon:ju,"aria-label":"close",type:"icon",onClick:t,className:"close"})]})},bwe=({app:e,activeLockedId:t})=>{const n=e.scene.getElement(t),i=n?[n]:At(e.scene.getNonDeletedElementsMap(),t);if(i.length===0)return null;const[r,s]=ht(i),{x:o,y:a}=Wr({sceneX:r,sceneY:s},e.state);return g("div",{className:"UnlockPopup",style:{bottom:`${e.state.height+12-a+e.state.offsetTop}px`,left:`${o-e.state.offsetLeft}px`},onClick:()=>{mi.flushSync(()=>{const l=kp(i,e.state);e.setState({selectedElementIds:i.reduce((c,d)=>({...c,[d.id]:!0}),{}),selectedGroupIds:l,activeLockedId:null})}),e.actionManager.executeAction(zX)},title:M("labels.elementLock.unlock"),children:Sue})},OY=de.createContext(null),PY=de.createContext(null),Kv={formFactor:"desktop",desktopUIMode:"full",userAgent:MB(typeof navigator<"u"?navigator.userAgent:""),isTouchScreen:!1,canFitSidebar:!1,isLandscape:!0},rI=de.createContext(Kv);rI.displayName="EditorInterfaceContext";const sI=de.createContext({container:null,id:null});sI.displayName="ExcalidrawContainerContext";const oI=de.createContext([]);oI.displayName="ExcalidrawElementsContext";const aI=de.createContext({...sa(),width:0,height:0,offsetLeft:0,offsetTop:0});aI.displayName="ExcalidrawAppStateContext";const lI=de.createContext(()=>{console.warn("Uninitialized ExcalidrawSetAppStateContext context!")});lI.displayName="ExcalidrawSetAppStateContext";const cI=de.createContext(null);cI.displayName="ExcalidrawActionManagerContext";const bo=()=>R.useContext(OY),$p=()=>R.useContext(PY),Nn=()=>R.useContext(rI),fa=()=>y0(Nn()),Dr=()=>R.useContext(sI),sE=()=>R.useContext(oI),Gp=()=>R.useContext(aI),xn=()=>R.useContext(lI),Lr=()=>R.useContext(cI);let _1=!1,W3=0,T1=null,Ed=!1,I1=!1,K3=!1,S1={horizontal:null,vertical:null},zl=0,x1=!1;const Z3=new Map;let q3=!1,tL=0,nL=!1,vd=null;const pt={pointers:new Map,lastCenter:null,initialDistance:null,initialScale:null};class dI extends de.Component{constructor(n){super(n);F(this,"canvas");F(this,"interactiveCanvas",null);F(this,"rc");F(this,"unmounted",!1);F(this,"actionManager");F(this,"editorInterface",Kv);F(this,"stylesPanelMode",y0(Kv));F(this,"excalidrawContainerRef",de.createRef());F(this,"scene");F(this,"fonts");F(this,"renderer");F(this,"visibleElements");F(this,"resizeObserver");F(this,"nearestScrollableContainer");F(this,"library");F(this,"libraryItemsFromStorage");F(this,"id");F(this,"store");F(this,"history");F(this,"excalidrawContainerValue");F(this,"files",{});F(this,"imageCache",new Map);F(this,"iFrameRefs",new Map);F(this,"embedsValidationStatus",new Map);F(this,"initializedEmbeds",new Set);F(this,"handleToastClose",()=>{this.setToast(null)});F(this,"elementsPendingErasure",new Set);F(this,"flowChartCreator",new Mde);F(this,"flowChartNavigator",new Ade);F(this,"hitLinkElement");F(this,"lastPointerDownEvent",null);F(this,"lastPointerUpEvent",null);F(this,"lastPointerMoveEvent",null);F(this,"lastPointerMoveCoords",null);F(this,"lastViewportPosition",{x:0,y:0});F(this,"animationFrameHandler",new K3e);F(this,"laserTrails",new p7e(this.animationFrameHandler,this));F(this,"eraserTrail",new A7e(this.animationFrameHandler,this));F(this,"lassoTrail",new C7e(this.animationFrameHandler,this));F(this,"onChangeEmitter",new Ws);F(this,"onPointerDownEmitter",new Ws);F(this,"onPointerUpEmitter",new Ws);F(this,"onUserFollowEmitter",new Ws);F(this,"onScrollChangeEmitter",new Ws);F(this,"missingPointerEventCleanupEmitter",new Ws);F(this,"onRemoveEventListenersEmitter",new Ws);F(this,"updateEditorAtom",(n,...i)=>{const r=Gr.set(n,...i);return this.triggerRender(),r});F(this,"getEffectiveGridSize",()=>Vm(this)?this.state.gridSize:null);F(this,"updateEmbedValidationStatus",(n,i)=>{this.embedsValidationStatus.set(n.id,i),qt.delete(n)});F(this,"updateEmbeddables",()=>{const n=new Set;let i=!1;this.scene.getNonDeletedElements().filter(r=>{if(or(r)){if(n.add(r.id),!this.embedsValidationStatus.has(r.id)){i=!0;const s=G2(r.link,this.props.validateEmbeddable);this.updateEmbedValidationStatus(r,s)}}else Zl(r)&&n.add(r.id);return!1}),i&&this.scene.triggerUpdate(),this.iFrameRefs.forEach((r,s)=>{n.has(s)||this.iFrameRefs.delete(s)})});F(this,"getFrameNameDOMId",n=>`${this.id}-frame-name-${n.id}`);F(this,"frameNameBoundsCache",{get:n=>{let i=this.frameNameBoundsCache._cache.get(n.id);if(!i||i.zoom!==this.state.zoom.value||i.versionNonce!==n.versionNonce){const r=document.getElementById(this.getFrameNameDOMId(n));if(r){const s=r.getBoundingClientRect(),o=Nt({clientX:s.x,clientY:s.y},this.state),a=Nt({clientX:s.right,clientY:s.bottom},this.state);return i={x:o.x,y:o.y,width:a.x-o.x,height:a.y-o.y,angle:0,zoom:this.state.zoom.value,versionNonce:n.versionNonce},this.frameNameBoundsCache._cache.set(n.id,i),i}return null}return i},_cache:new Map});F(this,"resetEditingFrame",n=>{var i;n&&this.scene.mutateElement(n,{name:((i=n.name)==null?void 0:i.trim())||null}),this.setState({editingFrame:null})});F(this,"renderFrameNames",()=>{var s;if(!this.state.frameRendering.enabled||!this.state.frameRendering.name)return this.state.editingFrame&&this.resetEditingFrame(null),null;const n=this.state.theme===ke.DARK,i=this.scene.getNonDeletedFramesLikes(),r=i.length>0&&(s=this.state.searchMatches)!=null&&s.focusedId&&we(this.scene.getElement(this.state.searchMatches.focusedId))?this.state.searchMatches.matches.find(o=>o.focus):null;return i.map(o=>{if(!A6(o,this.canvas.width/window.devicePixelRatio,this.canvas.height/window.devicePixelRatio,{offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,zoom:this.state.zoom},this.scene.getNonDeletedElementsMap()))return this.state.editingFrame===o.id&&this.resetEditingFrame(o),null;const{x:a,y:l}=Wr({sceneX:o.x,sceneY:o.y},this.state),c=6;let d;const u=zz(o);if(o.id===this.state.editingFrame){const f=u;d=g("input",{autoFocus:!0,value:f,onChange:h=>{this.scene.mutateElement(o,{name:h.target.value})},onFocus:h=>h.target.select(),onBlur:()=>this.resetEditingFrame(o),onKeyDown:h=>{(h.key===V.ESCAPE||h.key===V.ENTER)&&this.resetEditingFrame(o)},style:{background:this.state.viewBackgroundColor,filter:n?z_:"none",zIndex:2,border:"none",display:"block",padding:`${c}px`,borderRadius:4,boxShadow:"inset 0 0 0 1px var(--color-primary)",fontFamily:"Assistant",fontSize:`${zt.nameFontSize}px`,transform:`translate(-${c}px, ${c}px)`,color:"var(--color-gray-80)",overflow:"hidden",maxWidth:`${document.body.clientWidth-a-c}px`},size:f.length+1||1,dir:"auto",autoComplete:"off",autoCapitalize:"off",autoCorrect:"off"})}else d=u;return g("div",{id:this.getFrameNameDOMId(o),style:{position:"absolute",bottom:`${this.state.height+zt.nameOffsetY-l+this.state.offsetTop}px`,left:`${a-this.state.offsetLeft}px`,zIndex:2,fontSize:zt.nameFontSize,color:n?zt.nameColorDarkTheme:zt.nameColorLightTheme,lineHeight:zt.nameLineHeight,width:"max-content",maxWidth:(r==null?void 0:r.id)===o.id&&(r!=null&&r.focus)?"none":`${o.width*this.state.zoom.value}px`,overflow:o.id===this.state.editingFrame?"visible":"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",cursor:Ct.MOVE,pointerEvents:this.state.viewModeEnabled?Td.disabled:Td.enabled},onPointerDown:f=>this.handleCanvasPointerDown(f),onWheel:f=>this.handleWheel(f),onContextMenu:this.handleCanvasContextMenu,onDoubleClick:()=>{this.setState({editingFrame:o.id})},children:d},o.id)})});F(this,"focusContainer",()=>{var n;(n=this.excalidrawContainerRef.current)==null||n.focus()});F(this,"getSceneElementsIncludingDeleted",()=>this.scene.getElementsIncludingDeleted());F(this,"getSceneElementsMapIncludingDeleted",()=>this.scene.getElementsMapIncludingDeleted());F(this,"getSceneElements",()=>this.scene.getNonDeletedElements());F(this,"onInsertElements",n=>{this.addElementsFromPasteOrLibrary({elements:n,position:"center",files:null})});F(this,"onExportImage",async(n,i,r)=>{et("export",n,"ui");const s=await Wy(n,i,this.state,this.files,{exportBackground:this.state.exportBackground,name:this.getName(),viewBackgroundColor:this.state.viewBackgroundColor,exportingFrame:r.exportingFrame}).catch($B).catch(o=>{console.error(o),this.setState({errorMessage:o.message})});this.state.exportEmbedScene&&s&&FT(s)&&this.setState({fileHandle:s})});F(this,"magicGenerations",new Map);F(this,"updateMagicGeneration",({frameElement:n,data:i})=>{i.status==="pending"?this.scene.mutateElement(n,{customData:{generationData:void 0}},{informMutation:!1,isDragging:!1}):this.scene.mutateElement(n,{customData:{generationData:i}},{informMutation:!1,isDragging:!1}),this.magicGenerations.set(n.id,i),this.triggerRender()});F(this,"plugins",{});F(this,"onMagicframeToolSelect",()=>{const n=this.scene.getSelectedElements({selectedElementIds:this.state.selectedElementIds});if(n.length===0)this.setActiveTool({type:Qn.magicframe}),et("ai","tool-select (empty-selection)","d2c");else{const i=n.length===1&&z2(n[0])&&n[0];if(!i&&n.some(s=>we(s)||s.frameId)){this.setActiveTool({type:Qn.magicframe});return}et("ai","tool-select (existing selection)","d2c");let r;if(i)r=i;else{const[s,o,a,l]=ht(n),c=50;r=G4({...zt,x:s-c,y:o-c,width:a-s+c*2,height:l-o+c*2,opacity:100,locked:!1}),this.scene.insertElement(r);for(const d of n)this.scene.mutateElement(d,{frameId:r.id});this.setState({selectedElementIds:{[r.id]:!0}})}this.onMagicFrameGenerate(r,"upstream")}});F(this,"openEyeDropper",({type:n})=>{this.updateEditorAtom(Ay,{swapPreviewOnAlt:!0,colorPickerType:n==="stroke"?"elementStroke":"elementBackground",onSelect:(i,r)=>{const s=n==="background"&&r.altKey||n==="stroke"&&!r.altKey;!this.scene.getSelectedElements(this.state).length||this.state.activeTool.type!=="selection"?s?this.syncActionResult({appState:{...this.state,currentItemStrokeColor:i},captureUpdate:Z.IMMEDIATELY}):this.syncActionResult({appState:{...this.state,currentItemBackgroundColor:i},captureUpdate:Z.IMMEDIATELY}):this.updateScene({elements:this.scene.getElementsIncludingDeleted().map(a=>this.state.selectedElementIds[a.id]?Ie(a,{[s?"strokeColor":"backgroundColor"]:i}):a),captureUpdate:Z.IMMEDIATELY})},keepOpenOnAlt:!1})});F(this,"dismissLinearEditor",()=>{setTimeout(()=>{var n;(n=this.state.selectedLinearElement)!=null&&n.isEditing&&this.setState({selectedLinearElement:{...this.state.selectedLinearElement,isEditing:!1}})})});F(this,"syncActionResult",an(n=>{var s,o,a,l,c,d;if(this.unmounted||n===!1)return;this.store.scheduleAction(n.captureUpdate);let i=!1,r=null;if(n.elements&&(this.scene.replaceAllElements(n.elements),i=!0),n.files&&(this.addMissingFiles(n.files,n.replaceFiles),this.addNewImagesToImageCache()),n.appState||r||this.state.contextMenu){let u=((s=n==null?void 0:n.appState)==null?void 0:s.viewModeEnabled)||!1,f=((o=n==null?void 0:n.appState)==null?void 0:o.zenModeEnabled)||!1;const h=((a=n==null?void 0:n.appState)==null?void 0:a.theme)||this.props.theme||ke.LIGHT,m=((l=n==null?void 0:n.appState)==null?void 0:l.name)??this.state.name,p=((c=n==null?void 0:n.appState)==null?void 0:c.errorMessage)??this.state.errorMessage;typeof this.props.viewModeEnabled<"u"&&(u=this.props.viewModeEnabled),typeof this.props.zenModeEnabled<"u"&&(f=this.props.zenModeEnabled),r=((d=n.appState)==null?void 0:d.editingTextElement)||null,n.elements&&r&&n.elements.forEach(U=>{(r==null?void 0:r.id)===U.id&&r!==U&&Q4(U)&&ge(U)&&(r=U)}),r!=null&&r.isDeleted&&(r=null),this.setState(U=>{const b=n.appState||{};return{...U,...b,contextMenu:null,editingTextElement:r,viewModeEnabled:u,zenModeEnabled:f,theme:h,name:m,errorMessage:p}}),i=!0}i||this.scene.triggerUpdate()}));F(this,"onBlur",an(()=>{Ed=!1,this.setState({isBindingEnabled:!0})}));F(this,"onUnload",()=>{this.onBlur()});F(this,"disableEvent",n=>{n.preventDefault()});F(this,"resetHistory",()=>{this.history.clear()});F(this,"resetStore",()=>{this.store.clear()});F(this,"resetScene",an(n=>{this.scene.replaceAllElements([]),this.setState(i=>({...sa(),isLoading:n!=null&&n.resetLoadingState?!1:i.isLoading,theme:this.state.theme})),this.resetStore(),this.resetHistory()}));F(this,"initializeScene",async()=>{var s;"launchQueue"in window&&"LaunchParams"in window&&window.launchQueue.setConsumer(async o=>{if(!o.files.length)return;const a=o.files[0],l=await a.getFile();this.loadFileToCanvas(new File([l],l.name||"",{type:l.type}),a)}),this.props.theme&&this.setState({theme:this.props.theme}),this.state.isLoading||this.setState({isLoading:!0});let n=null;try{typeof this.props.initialData=="function"?n=await this.props.initialData()||null:n=await this.props.initialData||null,n!=null&&n.libraryItems&&this.library.updateLibrary({libraryItems:n.libraryItems,merge:!0}).catch(o=>{console.error(o)})}catch(o){console.error(o),n={appState:{errorMessage:o.message||"Encountered an error during importing or restoring scene data"}}}const i=Cu(n,null,null,{repairBindings:!0,deleteInvisibleElements:!0}),r=i.appState.activeTool;i.appState.preferredSelectionTool.initialized||(i.appState.preferredSelectionTool={type:this.editorInterface.formFactor==="phone"?"lasso":"selection",initialized:!0}),i.appState={...i.appState,theme:this.props.theme||i.appState.theme,openSidebar:((s=i.appState)==null?void 0:s.openSidebar)||this.state.openSidebar,activeTool:r.type==="image"||r.type==="lasso"||r.type==="selection"?{...r,type:i.appState.preferredSelectionTool.type}:i.appState.activeTool,isLoading:!1,toast:this.state.toast},n!=null&&n.scrollToContent&&(i.appState={...i.appState,...wm(i.elements,{...i.appState,width:this.state.width,height:this.state.height,offsetTop:this.state.offsetTop,offsetLeft:this.state.offsetLeft})}),this.resetStore(),this.resetHistory(),this.syncActionResult({...i,captureUpdate:Z.NEVER}),this.clearImageShapeCache(),this.fonts.loadSceneFonts().then(o=>{this.fonts.onLoaded(o)}),hh(window.location.href)&&this.scrollToContent(window.location.href,{animate:!1})});F(this,"getFormFactor",(n,i)=>this.props.UIOptions.formFactor??Use(n,i));F(this,"refreshEditorInterface",()=>{const n=this.excalidrawContainerRef.current;if(!n)return;const{width:i,height:r}=n.getBoundingClientRect(),s=bse(),o=MB(typeof navigator<"u"?navigator.userAgent:""),a=this.props.UIOptions.dockedSidebarBreakpoint!=null?this.props.UIOptions.dockedSidebarBreakpoint:dse,l=O2(this.editorInterface,{desktopUIMode:this.props.UIOptions.desktopUIMode??s??this.editorInterface.desktopUIMode,formFactor:this.getFormFactor(i,r),userAgent:o,canFitSidebar:i>a,isLandscape:i>r});this.editorInterface=l,this.reconcileStylesPanelMode(l)});F(this,"reconcileStylesPanelMode",n=>{const i=y0(n);if(i===this.stylesPanelMode)return;const r=this.stylesPanelMode;this.stylesPanelMode=i,r!=="full"&&i==="full"&&this.setState(s=>({preferredSelectionTool:{type:"selection",initialized:!0}}))});F(this,"setDesktopUIMode",n=>{const i=Ese(n);this.editorInterface=O2(this.editorInterface,{desktopUIMode:i}),this.reconcileStylesPanelMode(this.editorInterface)});F(this,"onResize",an(()=>{this.scene.getElementsIncludingDeleted().forEach(n=>qt.delete(n)),this.refreshEditorInterface(),this.updateDOMRect(),this.setState({})}));F(this,"onFullscreenChange",()=>{var n;!document.fullscreenElement&&((n=this.state.activeEmbeddable)==null?void 0:n.state)==="active"&&this.setState({activeEmbeddable:null})});F(this,"renderInteractiveSceneCallback",({atLeastOneVisibleElement:n,scrollBars:i,elementsMap:r})=>{i&&(S1=i);const s=this.state.editingTextElement?!1:!n&&r.size>0;this.state.scrolledOutside!==s&&this.setState({scrolledOutside:s}),this.scheduleImageRefresh()});F(this,"onScroll",ll(()=>{const{offsetTop:n,offsetLeft:i}=this.getCanvasOffsets();this.setState(r=>r.offsetLeft===i&&r.offsetTop===n?null:{offsetTop:n,offsetLeft:i})},Wre));F(this,"onCut",an(n=>{var r;!((r=this.excalidrawContainerRef.current)!=null&&r.contains(document.activeElement))||Na(n.target)||(this.actionManager.executeAction(jR,"keyboard",n),n.preventDefault(),n.stopPropagation())}));F(this,"onCopy",an(n=>{var r;!((r=this.excalidrawContainerRef.current)!=null&&r.contains(document.activeElement))||Na(n.target)||(this.actionManager.executeAction(ob,"keyboard",n),n.preventDefault(),n.stopPropagation())}));F(this,"onTouchStart",n=>{if($_&&n.preventDefault(),!_1){_1=!0,n.touches.length===1&&(T1={x:n.touches[0].clientX,y:n.touches[0].clientY}),clearTimeout(W3),W3=window.setTimeout(dI.resetTapTwice,Xre);return}if(_1&&n.touches.length===1&&T1){const i=n.touches[0];ct(S(i.clientX,i.clientY),S(T1.x,T1.y))<=ise&&(this.lassoTrail.endPath(),this.deselectElements(),this.handleCanvasDoubleClick({clientX:i.clientX,clientY:i.clientY})),_1=!1,clearTimeout(W3)}n.touches.length===2&&this.setState({selectedElementIds:xt({},this.state),activeEmbeddable:null})});F(this,"onTouchEnd",n=>{this.resetContextMenuTimer(),n.touches.length>0?this.setState({previousSelectedElementIds:{},selectedElementIds:xt(this.state.previousSelectedElementIds,this.state)}):pt.pointers.clear()});F(this,"pasteFromClipboard",an(async n=>{var d;const i=!!q3,r=document.activeElement,s=(d=this.excalidrawContainerRef.current)==null?void 0:d.contains(r);if(n&&!s)return;const o=document.elementFromPoint(this.lastViewportPosition.x,this.lastViewportPosition.y);if(n&&(!(o instanceof HTMLCanvasElement)||Na(r)))return;const a=await Sv(n),l=a.getFiles(),c=await Gye(a,i);if(this.props.onPaste)try{if(await this.props.onPaste(c,n)===!1)return}catch(u){console.error(u)}await this.insertClipboardContent(c,l,i),this.setActiveTool({type:this.state.preferredSelectionTool.type},!0),n==null||n.preventDefault()}));F(this,"addElementsFromPasteOrLibrary",n=>{var T,k;const i=xu(n.elements,null,{deleteInvisibleElements:!0}),[r,s,o,a]=ht(i),l=Gi(r,o)/2,c=Gi(s,a)/2,d=typeof n.position=="object"?n.position.clientX:n.position==="cursor"?this.lastViewportPosition.x:this.state.width/2+this.state.offsetLeft,u=typeof n.position=="object"?n.position.clientY:n.position==="cursor"?this.lastViewportPosition.y:this.state.height/2+this.state.offsetTop,{x:f,y:h}=Nt({clientX:d,clientY:u},this.state),m=f-l,p=h-c,[U,b]=Pn(m,p,this.getEffectiveGridSize()),{duplicatedElements:y}=S0({type:"everything",elements:i.map(x=>Ie(x,{x:x.x+U-r,y:x.y+b-s})),randomizeSeed:!n.retainSeed}),w=this.scene.getElementsIncludingDeleted();let v=[...w,...y];v=((k=(T=this.props).onDuplicate)==null?void 0:k.call(T,v,w))||v,uo(v,ve(y));const C=this.getTopLayerFrameAtSceneCoords({x:f,y:h});if(C){const x=tce(y,C);I0(v,x,C,this.state)}this.scene.replaceAllElements(v),y.forEach(x=>{if(ge(x)&&Dt(x)){const D=Yn(x,this.scene.getElementsMapIncludingDeleted());Qi(x,D,this.scene)}}),fse&&nl.loadElementsFonts(y).then(x=>{this.fonts.onLoaded(x)}),n.files&&this.addMissingFiles(n.files);const _=y9(y);this.store.scheduleCapture(),this.setState({...this.state,openSidebar:this.state.openSidebar&&this.editorInterface.canFitSidebar&&Gr.get(QT)?this.state.openSidebar:null,...Si({editingGroupId:null,selectedElementIds:_.reduce((x,D)=>(Dt(D)||(x[D.id]=!0),x),{})},this.scene.getNonDeletedElements(),this.state,this)},()=>{n.files&&this.addNewImagesToImageCache()}),this.setActiveTool({type:this.state.preferredSelectionTool.type},!0),n.fitToContent&&this.scrollToContent(y,{fitToContent:!0,canvasOffsets:this.getEditorUIOffsets()})});F(this,"setAppState",(n,i)=>{this.setState(n,i)});F(this,"removePointer",n=>{zl&&this.resetContextMenuTimer(),pt.pointers.delete(n.pointerId)});F(this,"toggleLock",(n="ui")=>{this.state.activeTool.locked||et("toolbar","toggleLock",`${n} (${this.editorInterface.formFactor==="phone"?"mobile":"desktop"})`),this.setState(i=>({activeTool:{...i.activeTool,...tn(this.state,i.activeTool.locked?{type:this.state.preferredSelectionTool.type}:i.activeTool),locked:!i.activeTool.locked}}))});F(this,"updateFrameRendering",n=>{this.setState(i=>{const r=typeof n=="function"?n(i.frameRendering):n;return{frameRendering:{enabled:(r==null?void 0:r.enabled)??i.frameRendering.enabled,clip:(r==null?void 0:r.clip)??i.frameRendering.clip,name:(r==null?void 0:r.name)??i.frameRendering.name,outline:(r==null?void 0:r.outline)??i.frameRendering.outline}}})});F(this,"togglePenMode",n=>{this.setState(i=>({penMode:n??!i.penMode,penDetected:!0}))});F(this,"onHandToolToggle",()=>{this.actionManager.executeAction(abe)});F(this,"zoomCanvas",n=>{this.setState({...Bd({viewportX:this.state.width/2+this.state.offsetLeft,viewportY:this.state.height/2+this.state.offsetTop,nextZoom:Xa(n)},this.state)})});F(this,"cancelInProgressAnimation",null);F(this,"scrollToContent",(n=this.scene.getNonDeletedElements(),i)=>{var l;if(typeof n=="string"){let c;if(hh(n)?c=dde(n):c=n,c){const d=this.scene.getElementsFromId(c);d!=null&&d.length?this.scrollToContent(d,{fitToContent:(i==null?void 0:i.fitToContent)??!0,animate:(i==null?void 0:i.animate)??!0}):hh(n)&&this.setState({toast:{message:M("elementLink.notFound"),duration:3e3,closable:!0}})}return}(l=this.cancelInProgressAnimation)==null||l.call(this);const r=Array.isArray(n)?n:[n];let s=this.state.zoom,o=this.state.scrollX,a=this.state.scrollY;if(i!=null&&i.fitToContent||i!=null&&i.fitToViewport){const{appState:c}=Ly({canvasOffsets:i.canvasOffsets,targetElements:r,appState:this.state,fitToViewport:!!(i!=null&&i.fitToViewport),viewportZoomFactor:i==null?void 0:i.viewportZoomFactor,minZoom:i==null?void 0:i.minZoom,maxZoom:i==null?void 0:i.maxZoom});s=c.zoom,o=c.scrollX,a=c.scrollY}else{const c=wm(r,this.state);o=c.scrollX,a=c.scrollY}if(i!=null&&i.animate){const c=this.state.scrollX,d=this.state.scrollY,u=this.state.zoom.value,f=jse({fromValues:{scrollX:c,scrollY:d,zoom:u},toValues:{scrollX:o,scrollY:a,zoom:s.value},interpolateValue:(h,m,p,U)=>{if(U==="zoom")return h*Math.pow(m/h,cl(p))},onStep:({scrollX:h,scrollY:m,zoom:p})=>{this.setState({scrollX:h,scrollY:m,zoom:{value:p}})},onStart:()=>{this.setState({shouldCacheIgnoreZoom:!0})},onEnd:()=>{this.setState({shouldCacheIgnoreZoom:!1})},onCancel:()=>{this.setState({shouldCacheIgnoreZoom:!1})},duration:(i==null?void 0:i.duration)??500});this.cancelInProgressAnimation=()=>{f(),this.cancelInProgressAnimation=null}}else this.setState({scrollX:o,scrollY:a,zoom:s})});F(this,"maybeUnfollowRemoteUser",()=>{this.state.userToFollow&&this.setState({userToFollow:null})});F(this,"translateCanvas",n=>{var i;(i=this.cancelInProgressAnimation)==null||i.call(this),this.maybeUnfollowRemoteUser(),this.setState(n)});F(this,"setToast",n=>{this.setState({toast:n})});F(this,"restoreFileFromShare",async()=>{try{const n=await caches.open("web-share-target"),i=await n.match("shared-file");if(i){const r=await i.blob(),s=new File([r],r.name||"",{type:r.type});this.loadFileToCanvas(s,null),await n.delete("shared-file"),window.history.replaceState(null,wc,window.location.pathname)}}catch(n){this.setState({errorMessage:n.message})}});F(this,"addFiles",an(n=>{const{addedFiles:i}=this.addMissingFiles(n);this.clearImageShapeCache(i),this.scene.triggerUpdate(),this.addNewImagesToImageCache()}));F(this,"addMissingFiles",(n,i=!1)=>{const r=i?{}:{...this.files},s={},o=Array.isArray(n)?n:Object.values(n);for(const a of o)if(!r[a.id]&&(s[a.id]=a,r[a.id]=a,a.mimeType===Te.svg))try{const l=Eye(kM(vye(a.dataURL)),Te.svg);a.dataURL!==l&&(a.version=(a.version??1)+1,a.dataURL=l)}catch(l){console.error(l)}return this.files=r,{addedFiles:s}});F(this,"updateScene",an(n=>{const{elements:i,appState:r,collaborators:s,captureUpdate:o}=n;if(o){const a=i||void 0,l=r?fh({...this.store.snapshot.appState,...r}):void 0;this.store.scheduleMicroAction({action:o,elements:a,appState:l})}r&&this.setState(r),i&&this.scene.replaceAllElements(i),s&&this.setState({collaborators:s})}));F(this,"applyDeltas",(n,i)=>{const r=yu.squash(...n),s={...this.state},o=new Map(this.scene.getElementsMapIncludingDeleted());return yu.applyTo(r,o,s,i)});F(this,"mutateElement",(n,i,r=!0)=>this.scene.mutateElement(n,i,{informMutation:r,isDragging:!1}));F(this,"triggerRender",n=>{n===!0?this.scene.triggerUpdate():this.setState({})});F(this,"toggleSidebar",({name:n,tab:i,force:r})=>{var a,l;let s;r===void 0?s=((a=this.state.openSidebar)==null?void 0:a.name)===n&&((l=this.state.openSidebar)==null?void 0:l.tab)===i?null:n:s=r?n:null;const o=s?{name:s}:null;return o&&i&&(o.tab=i),this.setState({openSidebar:o}),!!s});F(this,"updateCurrentCursorPosition",an(n=>{this.lastViewportPosition.x=n.clientX,this.lastViewportPosition.y=n.clientY}));F(this,"getEditorUIOffsets",()=>{var o,a,l,c,d,u,f,h,m,p;const n=((c=(l=(a=(o=this.excalidrawContainerRef)==null?void 0:o.current)==null?void 0:a.querySelector(".App-toolbar"))==null?void 0:l.getBoundingClientRect())==null?void 0:c.bottom)??0,i=(f=(u=(d=this.excalidrawContainerRef)==null?void 0:d.current)==null?void 0:u.querySelector(".sidebar"))==null?void 0:f.getBoundingClientRect(),r=(p=(m=(h=this.excalidrawContainerRef)==null?void 0:h.current)==null?void 0:m.querySelector(".App-menu__left"))==null?void 0:p.getBoundingClientRect(),s=16;return vm().rtl?{top:n+s,right:Math.max(this.state.width-((r==null?void 0:r.left)??this.state.width),0)+s,bottom:s,left:Math.max((i==null?void 0:i.right)??0,0)+s}:{top:n+s,right:Math.max(this.state.width-((i==null?void 0:i.left)??this.state.width)+s,0),bottom:s,left:Math.max((r==null?void 0:r.right)??0,0)+s}});F(this,"onKeyDown",an(n=>{var o,a,l,c,d,u;if("Proxy"in window&&(!n.shiftKey&&/^[A-Z]$/.test(n.key)||n.shiftKey&&/^[a-z]$/.test(n.key))&&(n=new Proxy(n,{get(f,h){const m=f[h];return typeof m=="function"?m.bind(f):h==="key"?n.shiftKey?f.key.toUpperCase():f.key.toLowerCase():m}})),!I4(n.target)){if((n.key===V.ESCAPE||n.key===V.ENTER)&&this.state.croppingElementId){this.finishImageCropping();return}const f=Xe(this.scene.getNonDeletedElementsMap(),this.state);if(f.length===1&&yt(f[0])&&n.key===V.ENTER){this.startImageCropping(f[0]);return}if(n.key===V.ESCAPE)this.updateEditorAtom(Aa,null);else if(n.key===V.TAB&&(document.activeElement===((o=this.excalidrawContainerRef)==null?void 0:o.current)||(a=document.activeElement)!=null&&a.classList.contains(Jr.CONVERT_ELEMENT_TYPE_POPUP))){n.preventDefault();const m=Zy(f);((l=Gr.get(Aa))==null?void 0:l.type)==="panel"&&VX(this,{conversionType:m,direction:n.shiftKey?"left":"right"})&&this.store.scheduleCapture(),m&&this.updateEditorAtom(Aa,{type:"panel"})}if(n.key===V.ESCAPE&&this.flowChartCreator.isCreatingChart){this.flowChartCreator.clear(),this.triggerRender(!0);return}const h=B1(n.key);if(n[V.CTRL_OR_CMD]&&h&&!n.shiftKey){n.preventDefault();const m=Xe(this.scene.getNonDeletedElementsMap(),this.state);m.length===1&&oy(m[0])&&this.flowChartCreator.createNodes(m[0],this.state,MM(n.key),this.scene),(c=this.flowChartCreator.pendingNodes)!=null&&c.length&&!$2(this.flowChartCreator.pendingNodes,this.canvas.width/window.devicePixelRatio,this.canvas.height/window.devicePixelRatio,{offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,zoom:this.state.zoom},this.scene.getNonDeletedElementsMap(),this.getEditorUIOffsets())&&this.scrollToContent(this.flowChartCreator.pendingNodes,{animate:!0,duration:300,fitToContent:!0,canvasOffsets:this.getEditorUIOffsets()});return}if(n.altKey){const m=Xe(this.scene.getNonDeletedElementsMap(),this.state);if(m.length===1&&h){n.preventDefault();const p=this.flowChartNavigator.exploreByDirection(m[0],this.scene.getNonDeletedElementsMap(),MM(n.key));if(p){this.setState(b=>({selectedElementIds:xt({[p]:!0},b)}));const U=this.scene.getNonDeletedElementsMap().get(p);U&&!$2([U],this.canvas.width/window.devicePixelRatio,this.canvas.height/window.devicePixelRatio,{offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,zoom:this.state.zoom},this.scene.getNonDeletedElementsMap(),this.getEditorUIOffsets())&&this.scrollToContent(U,{animate:!0,duration:300,canvasOffsets:this.getEditorUIOffsets()})}return}}}if(n[V.CTRL_OR_CMD]&&n.key===V.P&&!n.shiftKey&&!n.altKey){this.setToast({message:M("commandPalette.shortcutHint",{shortcut:Zi("commandPalette")})}),n.preventDefault();return}if(n[V.CTRL_OR_CMD]&&n.key.toLowerCase()===V.V&&(q3=n.shiftKey,clearTimeout(tL),tL=window.setTimeout(()=>{q3=!1},100)),n[V.CTRL_OR_CMD]&&Na(n.target)&&(n.code===it.MINUS||n.code===it.EQUAL)){n.preventDefault();return}if(Na(n.target)&&n.key!==V.ESCAPE||B1(n.key)&&I4(n.target))return;if(n.key===V.QUESTION_MARK){this.setState({openDialog:{name:"help"}});return}else if(n.key.toLowerCase()===V.E&&n.shiftKey&&n[V.CTRL_OR_CMD]){n.preventDefault(),this.setState({openDialog:{name:"imageExport"}});return}if(n.key===V.PAGE_UP||n.key===V.PAGE_DOWN){let f=(n.shiftKey?this.state.width:this.state.height)/this.state.zoom.value;n.key===V.PAGE_DOWN&&(f=-f),n.shiftKey?this.translateCanvas(h=>({scrollX:h.scrollX+f})):this.translateCanvas(h=>({scrollY:h.scrollY+f}))}if(((d=this.state.openDialog)==null?void 0:d.name)==="elementLinkSelector"||this.actionManager.handleKeyDown(n)||this.state.viewModeEnabled)return;if(n[V.CTRL_OR_CMD]&&this.state.isBindingEnabled&&this.setState({isBindingEnabled:!1}),B1(n.key)){let f=this.scene.getSelectedElements({selectedElementIds:this.state.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});const h=f.find(me),m=new Set;f.filter(me).filter(y=>{const w=y.startBinding&&!f.some(I=>{var C;return I.id===((C=y.startBinding)==null?void 0:C.elementId)}),v=y.endBinding&&!f.some(I=>{var C;return I.id===((C=y.endBinding)==null?void 0:C.elementId)});return w||v}).forEach(y=>m.add(y.id)),f=f.filter(y=>!m.has(y.id));const p=this.getEffectiveGridSize()&&(n.shiftKey?bA:this.getEffectiveGridSize())||(n.shiftKey?Lre:bA);let U=0,b=0;n.key===V.ARROW_LEFT?U=-p:n.key===V.ARROW_RIGHT?U=p:n.key===V.ARROW_UP?b=-p:n.key===V.ARROW_DOWN&&(b=p),f.forEach(y=>{this.scene.mutateElement(y,{x:y.x+U,y:y.y+b},{informMutation:!1,isDragging:!1}),fr(y,this.scene,{simultaneouslyUpdated:f})}),this.setState({suggestedBindings:V8(f.filter(y=>y.id!==(h==null?void 0:h.id)||p!==0),this.scene.getNonDeletedElementsMap(),this.state.zoom)}),this.scene.triggerUpdate(),n.preventDefault()}else if(n.key===V.ENTER){const f=this.scene.getSelectedElements(this.state);if(f.length===1){const h=f[0];if(n[V.CTRL_OR_CMD]||nn(h))xe(h)&&(!((u=this.state.selectedLinearElement)!=null&&u.isEditing)||this.state.selectedLinearElement.elementId!==h.id)&&(this.store.scheduleCapture(),me(h)||this.actionManager.executeAction(l2));else if(ge(h)||Gae(h)){let m;ge(h)||(m=h);const p=z8(h,this.state,this.scene.getNonDeletedElementsMap()),U=p.x,b=p.y;this.startTextEditing({sceneX:U,sceneY:b,container:m}),n.preventDefault();return}else we(h)&&this.setState({editingFrame:h.id})}}else if(!n.ctrlKey&&!n.altKey&&!n.metaKey&&!this.state.newElement&&!this.state.selectionElement&&!this.state.selectedElementsAreBeingDragged){const f=Z8e(n.key,this);f?(this.state.activeTool.type!==f&&et("toolbar",f,`keyboard (${this.editorInterface.formFactor==="phone"?"mobile":"desktop"})`),f==="arrow"&&this.state.activeTool.type==="arrow"&&this.setState(h=>({currentItemArrowType:h.currentItemArrowType===fi.sharp?fi.round:h.currentItemArrowType===fi.round?fi.elbow:fi.sharp})),this.setActiveTool({type:f}),n.stopPropagation()):n.key===V.Q&&(this.toggleLock("keyboard"),n.stopPropagation())}if(n.key===V.SPACE&&pt.pointers.size===0&&(Ed=!0,Lt(this.interactiveCanvas,Ct.GRAB),n.preventDefault()),(n.key===V.G||n.key===V.S)&&!n.altKey&&!n[V.CTRL_OR_CMD]){const f=this.scene.getSelectedElements(this.state);if(this.state.activeTool.type==="selection"&&!f.length)return;n.key===V.G&&($c(this.state.activeTool.type)||f.some(h=>$c(h.type)))&&(this.setState({openPopup:"elementBackground"}),n.stopPropagation()),n.key===V.S&&(this.setState({openPopup:"elementStroke"}),n.stopPropagation())}if(!n[V.CTRL_OR_CMD]&&n.shiftKey&&n.key.toLowerCase()===V.F){const f=this.scene.getSelectedElements(this.state);if(this.state.activeTool.type==="selection"&&!f.length)return;(this.state.activeTool.type==="text"||f.find(h=>ge(h)||Le(h,this.scene.getNonDeletedElementsMap())))&&(n.preventDefault(),this.setState({openPopup:"fontFamily"}))}if(n.key===V.K&&!n.altKey&&!n[V.CTRL_OR_CMD]){this.state.activeTool.type==="laser"?this.setActiveTool({type:this.state.preferredSelectionTool.type}):this.setActiveTool({type:"laser"});return}n[V.CTRL_OR_CMD]&&(n.key===V.BACKSPACE||n.key===V.DELETE)&&this.updateEditorAtom(nE,"clearCanvas");const i=n.key.toLocaleLowerCase(),r=i===V.S&&n.shiftKey,s=n.key===V.I||i===V.G&&n.shiftKey;(r||s)&&this.openEyeDropper({type:r?"stroke":"background"})}));F(this,"onKeyUp",an(n=>{var i,r,s,o;if(n.key===V.SPACE&&(this.state.viewModeEnabled||((i=this.state.openDialog)==null?void 0:i.name)==="elementLinkSelector"?Lt(this.interactiveCanvas,Ct.GRAB):this.state.activeTool.type==="selection"||this.state.activeTool.type==="lasso"?Io(this.interactiveCanvas):(So(this.interactiveCanvas,this.state),this.setState({selectedElementIds:xt({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null})),Ed=!1),!n[V.CTRL_OR_CMD]&&!this.state.isBindingEnabled&&this.setState({isBindingEnabled:!0}),B1(n.key)&&(p6(this.scene.getSelectedElements(this.state).filter(xe),tu(this.state),((r=this.state.selectedLinearElement)==null?void 0:r.selectedPointsIndices)??[],this.scene,this.state.zoom),this.setState({suggestedBindings:[]})),n.altKey||this.flowChartNavigator.isExploring&&(this.flowChartNavigator.clear(),this.syncActionResult({captureUpdate:Z.IMMEDIATELY})),!n[V.CTRL_OR_CMD]&&this.flowChartCreator.isCreatingChart){(s=this.flowChartCreator.pendingNodes)!=null&&s.length&&this.scene.insertElements(this.flowChartCreator.pendingNodes);const a=(o=this.flowChartCreator.pendingNodes)==null?void 0:o[0];a&&(this.setState(l=>({selectedElementIds:xt({[a.id]:!0},l)})),$2([a],this.canvas.width/window.devicePixelRatio,this.canvas.height/window.devicePixelRatio,{offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,zoom:this.state.zoom},this.scene.getNonDeletedElementsMap(),this.getEditorUIOffsets())||this.scrollToContent(a,{animate:!0,duration:300,canvasOffsets:this.getEditorUIOffsets()})),this.flowChartCreator.clear(),this.syncActionResult({captureUpdate:Z.IMMEDIATELY})}}));F(this,"isToolSupported",n=>{var i;return((i=this.props.UIOptions.tools)==null?void 0:i[n])!==!1});F(this,"setActiveTool",(n,i=!1)=>{if(!this.isToolSupported(n.type)){console.warn(`"${n.type}" tool is disabled via "UIOptions.canvasActions.tools.${n.type}"`);return}const r=tn(this.state,n);r.type==="hand"?Lt(this.interactiveCanvas,Ct.GRAB):Ed||So(this.interactiveCanvas,{...this.state,activeTool:r}),$se(document.activeElement)&&this.focusContainer(),s9(r.type)||this.setState({suggestedBindings:[]}),r.type==="image"&&this.onImageToolbarButtonClick(),this.setState(s=>{const o={snapLines:s.snapLines.length?[]:s.snapLines,originSnapOffset:null,activeEmbeddable:null};return r.type==="freedraw"&&this.store.scheduleCapture(),r.type==="lasso"?{...s,activeTool:r,...i?{}:{selectedElementIds:xt({},s),selectedGroupIds:xt({},s),editingGroupId:null,multiElement:null},...o}:r.type!=="selection"?{...s,activeTool:r,selectedElementIds:xt({},s),selectedGroupIds:xt({},s),editingGroupId:null,multiElement:null,...o}:{...s,activeTool:r,...o}})});F(this,"setOpenDialog",n=>{this.setState({openDialog:n})});F(this,"setCursor",n=>{Lt(this.interactiveCanvas,n)});F(this,"resetCursor",()=>{Io(this.interactiveCanvas)});F(this,"isTouchScreenMultiTouchGesture",()=>pt.pointers.size>=2);F(this,"getName",()=>this.state.name||this.props.name||`${M("labels.untitled")}-${AA()}`);F(this,"onGestureStart",an(n=>{n.preventDefault(),this.isTouchScreenMultiTouchGesture()&&this.setState({selectedElementIds:xt({},this.state),activeEmbeddable:null}),pt.initialScale=this.state.zoom.value}));F(this,"onGestureChange",an(n=>{if(n.preventDefault(),this.isTouchScreenMultiTouchGesture())return;const i=pt.initialScale;i&&this.setState(r=>({...Bd({viewportX:this.lastViewportPosition.x,viewportY:this.lastViewportPosition.y,nextZoom:Xa(i*n.scale)},r)}))}));F(this,"onGestureEnd",an(n=>{n.preventDefault(),this.isTouchScreenMultiTouchGesture()&&this.setState({previousSelectedElementIds:{},selectedElementIds:xt(this.state.previousSelectedElementIds,this.state)}),pt.initialScale=null}));F(this,"startTextEditing",({sceneX:n,sceneY:i,insertAtParentCenter:r=!0,container:s,autoEdit:o=!0})=>{let a=!1,l=r&&this.getTextWysiwygSnappedToCenterPosition(n,i,this.state,s);s&&l&&(Le(s,this.scene.getNonDeletedElementsMap())||(a=!0));let c=null;const d=this.scene.getSelectedElements(this.state);d.length===1?ge(d[0])?c=d[0]:s?c=Le(d[0],this.scene.getNonDeletedElementsMap()):c=this.getTextElementAtPosition(n,i):c=this.getTextElementAtPosition(n,i);const u=(c==null?void 0:c.fontFamily)||this.state.currentItemFontFamily,f=(c==null?void 0:c.lineHeight)||zc(u),h=this.state.currentItemFontSize;if(!c&&a&&s&&!Ce(s)){const b=gz(mt({fontSize:h,fontFamily:u}),f),y=mz(h,f),w=Math.max(s.height,y),v=Math.max(s.width,b);this.scene.mutateElement(s,{height:w,width:v}),n=s.x+v/2,i=s.y+w/2,l&&(l=this.getTextWysiwygSnappedToCenterPosition(n,i,this.state,s))}const m=this.getTopLayerFrameAtSceneCoords({x:n,y:i}),p=c||os({x:l?l.elementCenterX:n,y:l?l.elementCenterY:i,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,text:"",fontSize:h,fontFamily:u,textAlign:l?"center":this.state.currentItemTextAlign,verticalAlign:l?Yr.MIDDLE:Kb,containerId:a?s==null?void 0:s.id:void 0,groupIds:(s==null?void 0:s.groupIds)??[],lineHeight:f,angle:s?Ce(s)?0:s.angle:0,frameId:m?m.id:null});if(!c&&a&&s&&this.scene.mutateElement(s,{boundElements:(s.boundElements||[]).concat({type:"text",id:p.id})}),this.setState({editingTextElement:p}),!c)if(s&&a){const U=this.scene.getElementIndex(s.id);this.scene.insertElementAtIndex(p,U+1)}else this.scene.insertElement(p);o||c||s?this.handleTextWysiwyg(p,{isExistingElement:!!c}):this.setState({newElement:p,multiElement:null})});F(this,"startImageCropping",n=>{this.store.scheduleCapture(),this.setState({croppingElementId:n.id})});F(this,"finishImageCropping",()=>{this.state.croppingElementId&&(this.store.scheduleCapture(),this.setState({croppingElementId:null}))});F(this,"handleCanvasDoubleClick",n=>{var a,l,c;if(this.state.multiElement||this.state.activeTool.type!==this.state.preferredSelectionTool.type)return;const i=this.scene.getSelectedElements(this.state);let{x:r,y:s}=Nt(n,this.state);if(i.length===1&&xe(i[0])){const d=i[0];if((n[V.CTRL_OR_CMD]&&yae(d)||nn(d))&&(!((a=this.state.selectedLinearElement)!=null&&a.isEditing)||this.state.selectedLinearElement.elementId!==d.id)){this.actionManager.executeAction(l2);return}else if(this.state.selectedLinearElement&&me(i[0])){const u=pe.getSegmentMidpointHitCoords(this.state.selectedLinearElement,{x:r,y:s},this.state,this.scene.getNonDeletedElementsMap()),f=u?pe.getSegmentMidPointIndex(this.state.selectedLinearElement,this.state,u,this.scene.getNonDeletedElementsMap()):-1;if(f&&f>-1){this.store.scheduleCapture(),pe.deleteFixedSegment(i[0],this.scene,f);const h=pe.getSegmentMidpointHitCoords({...this.state.selectedLinearElement,segmentMidPointHoveredCoords:null},{x:r,y:s},this.state,this.scene.getNonDeletedElementsMap()),m=h?pe.getSegmentMidPointIndex(this.state.selectedLinearElement,this.state,h,this.scene.getNonDeletedElementsMap()):null;this.setState({selectedLinearElement:{...this.state.selectedLinearElement,pointerDownState:{...this.state.selectedLinearElement.pointerDownState,segmentMidpoint:{index:m,value:u,added:!1}},segmentMidPointHoveredCoords:h}});return}}else if((l=this.state.selectedLinearElement)!=null&&l.isEditing&&this.state.selectedLinearElement.elementId===d.id&&nn(d))return}if(i.length===1&&yt(i[0])){this.startImageCropping(i[0]);return}if(Io(this.interactiveCanvas),_c(this.state).length>0){const d=this.getElementAtPosition(r,s),u=d&&Lz(d,this.state.selectedGroupIds);if(u){this.store.scheduleCapture(),this.setState(f=>({...f,...Si({editingGroupId:u,selectedElementIds:{[d.id]:!0}},this.scene.getNonDeletedElements(),f,this)}));return}}if(Io(this.interactiveCanvas),!n[V.CTRL_OR_CMD]&&!this.state.viewModeEnabled){const d=this.getElementAtPosition(r,s);if(Es(d)){this.setState({activeEmbeddable:{element:d,state:"active"}});return}if(!((c=this.state.selectedLinearElement)!=null&&c.isEditing)){const u=this.getTextBindableContainerAtPosition(r,s);if(u&&(Li(u)||!Ir(u.backgroundColor)||Tf({point:S(r,s),element:u,elementsMap:this.scene.getNonDeletedElementsMap(),threshold:this.getElementHitThreshold(u)}))){const f=z8(u,this.state,this.scene.getNonDeletedElementsMap());r=f.x,s=f.y}this.startTextEditing({sceneX:r,sceneY:s,insertAtParentCenter:!n.altKey,container:u})}}});F(this,"getElementLinkAtPosition",(n,i)=>{if(i&&i.locked)return;const r=this.scene.getNonDeletedElements();let s=-1;for(let o=r.length-1;o>=0;o--){const a=r[o];if(i&&a.id===i.id&&(s=o),a.link&&o>=s&&x3(a,this.scene.getNonDeletedElementsMap(),this.state,S(n.x,n.y),this.editorInterface.formFactor==="phone"))return a}});F(this,"redirectToLink",(n,i)=>{const r=ct(S(this.lastPointerDownEvent.clientX,this.lastPointerDownEvent.clientY),S(this.lastPointerUpEvent.clientX,this.lastPointerUpEvent.clientY));if(!this.hitLinkElement||r>hB)return;const s=Nt(this.lastPointerDownEvent,this.state),o=this.scene.getNonDeletedElementsMap(),a=x3(this.hitLinkElement,o,this.state,S(s.x,s.y),this.editorInterface.formFactor==="phone"),l=Nt(this.lastPointerUpEvent,this.state),c=x3(this.hitLinkElement,o,this.state,S(l.x,l.y),this.editorInterface.formFactor==="phone");if(a&&c){QR();let d=this.hitLinkElement.link;if(d){d=ts(d);let u;if(this.props.onLinkOpen&&(u=jB(te.EXCALIDRAW_LINK,n.nativeEvent),this.props.onLinkOpen({...this.hitLinkElement,link:d},u)),!(u!=null&&u.defaultPrevented)){const f=QB(d)?"_self":"_blank",h=window.open(void 0,f);h&&(h.opener=null,h.location=d)}}}});F(this,"getTopLayerFrameAtSceneCoords",n=>{const i=this.scene.getNonDeletedElementsMap(),r=this.scene.getNonDeletedFramesLikes().filter(s=>!s.locked&&iM(n,s,i));return r.length?r[r.length-1]:null});F(this,"handleCanvasPointerMove",n=>{var m,p,U,b,y,w,v,I;this.savePointer(n.clientX,n.clientY,this.state.cursorButton),this.lastPointerMoveEvent=n.nativeEvent,pt.pointers.has(n.pointerId)&&pt.pointers.set(n.pointerId,{x:n.clientX,y:n.clientY});const i=pt.initialScale;if(pt.pointers.size===2&&pt.lastCenter&&i&&pt.initialDistance){const C=gD(pt.pointers),_=C.x-pt.lastCenter.x,T=C.y-pt.lastCenter.y;pt.lastCenter=C;const k=mD(Array.from(pt.pointers.values())),x=this.state.activeTool.type==="freedraw"&&this.state.penMode?1:k/pt.initialDistance,D=x?Xa(i*x):this.state.zoom.value;this.setState(O=>{const L=Bd({viewportX:C.x,viewportY:C.y,nextZoom:D},O);this.translateCanvas({zoom:L.zoom,scrollX:L.scrollX+2*(_/D),scrollY:L.scrollY+2*(T/D),shouldCacheIgnoreZoom:!0})}),this.resetShouldCacheIgnoreZoomDebounced()}else pt.lastCenter=pt.initialDistance=pt.initialScale=null;if(Ed||I1||K3||Qh(this.state))return;const s=xD(S1,n.clientX-this.state.offsetLeft,n.clientY-this.state.offsetTop).isOverEither;!this.state.newElement&&!this.state.selectionElement&&!this.state.selectedElementsAreBeingDragged&&!this.state.multiElement&&(s?Io(this.interactiveCanvas):So(this.interactiveCanvas,this.state));const o=Nt(n,this.state),{x:a,y:l}=o;if(!this.state.newElement&&s7e(this.state.activeTool.type)){const{originOffset:C,snapLines:_}=r7e(this.scene.getNonDeletedElements(),this,{x:a,y:l},n,this.scene.getNonDeletedElementsMap());this.setState(T=>{const k=d1(T.snapLines,_),x=T.originSnapOffset?d1(T.originSnapOffset,C):C;return T.snapLines===k&&T.originSnapOffset===x?null:{snapLines:k,originSnapOffset:x}})}else!this.state.newElement&&!this.state.selectedElementsAreBeingDragged&&!this.state.selectionElement&&this.setState(C=>C.snapLines.length?{snapLines:[]}:null);if((m=this.state.selectedLinearElement)!=null&&m.isEditing&&!this.state.selectedLinearElement.isDragging){const C=pe.handlePointerMove(n,a,l,this),_=C?this.scene.getElement(C.elementId):null;C&&C!==this.state.selectedLinearElement&&mi.flushSync(()=>{this.setState({selectedLinearElement:C})}),(C==null?void 0:C.lastUncommittedPoint)!=null&&_&&D4(_.type)?this.maybeSuggestBindingAtCursor(o,C.elbowed):this.state.suggestedBindings.length&&this.setState({suggestedBindings:[]})}if(D4(this.state.activeTool.type)){const{newElement:C}=this.state;Ga(C,!1)?this.setState({suggestedBindings:N4(C,[o],this.scene,this.state.zoom,this.state.startBoundElement)}):this.maybeSuggestBindingAtCursor(o,!1)}if(this.state.multiElement){const{multiElement:C}=this.state,{x:_,y:T}=C,{points:k,lastCommittedPoint:x}=C,D=k[k.length-1];if(So(this.interactiveCanvas,this.state),D===x)ct(S(a-_,l-T),D)>=L2?this.scene.mutateElement(C,{points:[...k,S(a-_,l-T)]},{informMutation:!1,isDragging:!1}):Lt(this.interactiveCanvas,Ct.POINTER);else if(k.length>2&&x&&ct(S(a-_,l-T),x)<L2)Lt(this.interactiveCanvas,Ct.POINTER),this.scene.mutateElement(C,{points:k.slice(0,-1)},{informMutation:!1,isDragging:!1});else{const[O,L]=Pn(a,l,n[V.CTRL_OR_CMD]||me(C)?null:this.getEffectiveGridSize()),[Y,$]=(C==null?void 0:C.lastCommittedPoint)??[0,0];let H=O-_-Y,z=L-T-$;E0(n)&&({width:H,height:z}=z4(Y+_,$+T,O,L)),Jo(k,this.state.zoom.value)&&Lt(this.interactiveCanvas,Ct.POINTER),this.scene.mutateElement(C,{points:[...k.slice(0,-1),S(Y+H,$+z)]},{isDragging:!0,informMutation:!1}),this.triggerRender(!1)}return}if(!!n.buttons||this.state.activeTool.type!=="selection"&&this.state.activeTool.type!=="lasso"&&this.state.activeTool.type!=="text"&&this.state.activeTool.type!=="eraser")return;const d=this.scene.getNonDeletedElements(),u=this.scene.getSelectedElements(this.state);if(u.length===1&&!s&&!((p=this.state.selectedLinearElement)!=null&&p.isEditing)){if(this.state.selectedLinearElement&&this.handleHoverSelectedLinearElement(this.state.selectedLinearElement,a,l),(!this.state.selectedLinearElement||this.state.selectedLinearElement.hoverPointIndex===-1)&&((U=this.state.openDialog)==null?void 0:U.name)!=="elementLinkSelector"&&!(u.length===1&&me(u[0]))&&!(xe(u[0])&&(this.editorInterface.userAgent.isMobileDevice||u[0].points.length===2))){const C=NM(d,this.state,a,l,this.state.zoom,n.pointerType,this.scene.getNonDeletedElementsMap(),this.editorInterface);if(C&&C.transformHandleType){Lt(this.interactiveCanvas,PM(C));return}}}else if(u.length>1&&!s&&((b=this.state.openDialog)==null?void 0:b.name)!=="elementLinkSelector"){const C=OM(ht(u),a,l,this.state.zoom,n.pointerType,this.editorInterface);if(C){Lt(this.interactiveCanvas,PM({transformHandleType:C}));return}}const f=this.getElementAtPosition(a,l,{preferSelected:!0,includeLockedElements:!0});let h=null;f&&f.locked?h=null:h=f,this.hitLinkElement=this.getElementLinkAtPosition(o,f),!ko(this.state)&&(this.hitLinkElement&&!this.state.selectedElementIds[this.hitLinkElement.id]?(Lt(this.interactiveCanvas,Ct.POINTER),EEe(this.hitLinkElement,this.state,this.scene.getNonDeletedElementsMap())):(QR(),h&&(h.link||or(h))&&this.state.selectedElementIds[h.id]&&!this.state.contextMenu&&!this.state.showHyperlinkPopup?this.setState({showHyperlinkPopup:"info"}):this.state.activeTool.type==="text"?Lt(this.interactiveCanvas,ge(h)?Ct.TEXT:Ct.CROSSHAIR):this.state.viewModeEnabled?Lt(this.interactiveCanvas,Ct.GRAB):((y=this.state.openDialog)==null?void 0:y.name)==="elementLinkSelector"?Lt(this.interactiveCanvas,Ct.AUTO):s?Lt(this.interactiveCanvas,Ct.AUTO):n[V.CTRL_OR_CMD]?Lt(this.interactiveCanvas,Ct.AUTO):(h||this.isHittingCommonBoundingBoxOfSelectedElements(o,u))&&!(h!=null&&h.locked)&&(h&&Es(h)&&this.isIframeLikeElementCenter(h,n,a,l)?(Lt(this.interactiveCanvas,Ct.POINTER),this.setState({activeEmbeddable:{element:h,state:"hover"}})):(!h||!me(h)||!(h.startBinding||h.endBinding))&&((this.state.activeTool.type!=="lasso"||u.length>0)&&Lt(this.interactiveCanvas,Ct.MOVE),((w=this.state.activeEmbeddable)==null?void 0:w.state)==="hover"&&this.setState({activeEmbeddable:null}))),this.state.selectedLinearElement&&this.handleHoverSelectedLinearElement(this.state.selectedLinearElement,a,l)),((v=this.state.openDialog)==null?void 0:v.name)==="elementLinkSelector"&&h?this.setState(C=>({hoveredElementIds:d1(C.hoveredElementIds,Si({editingGroupId:C.editingGroupId,selectedElementIds:{[h.id]:!0}},this.scene.getNonDeletedElements(),C,this).selectedElementIds)})):((I=this.state.openDialog)==null?void 0:I.name)==="elementLinkSelector"&&!h&&this.setState(C=>({hoveredElementIds:d1(C.hoveredElementIds,{})})))});F(this,"handleEraser",(n,i)=>{const r=this.eraserTrail.addPointToPath(i.x,i.y,n.altKey);this.elementsPendingErasure=new Set(r),this.triggerRender()});F(this,"handleTouchMove",n=>{x1=!0});F(this,"handleCanvasPointerDown",n=>{var u,f,h;const i=n.target;if(i.setPointerCapture&&i.setPointerCapture(n.pointerId),this.maybeCleanupAfterMissingPointerUp(n.nativeEvent),this.maybeUnfollowRemoteUser(),this.state.searchMatches&&(this.setState(m=>({searchMatches:m.searchMatches&&{focusedId:null,matches:m.searchMatches.matches.map(p=>({...p,focus:!1}))}})),this.updateEditorAtom(EY,null)),Gr.get(Aa)&&this.updateEditorAtom(Aa,null),this.state.contextMenu&&this.setState({contextMenu:null}),this.state.snapLines&&this.setAppState({snapLines:[]}),this.state.openPopup&&this.setState({openPopup:null}),this.updateGestureOnPointerDown(n),n.pointerType==="touch"&&this.state.newElement&&this.state.newElement.type==="freedraw"){const m=this.state.newElement;this.updateScene({...m.points.length<10?{elements:this.scene.getElementsIncludingDeleted().filter(p=>p.id!==m.id)}:{},appState:{newElement:null,editingTextElement:null,startBoundElement:null,suggestedBindings:[],selectedElementIds:xt(Object.keys(this.state.selectedElementIds).filter(p=>p!==m.id).reduce((p,U)=>(p[U]=this.state.selectedElementIds[U],p),{}),this.state)},captureUpdate:((u=this.state.openDialog)==null?void 0:u.name)==="elementLinkSelector"?Z.EVENTUALLY:Z.NEVER});return}const r=document.getSelection();if(r!=null&&r.anchorNode&&r.removeAllRanges(),this.maybeOpenContextMenuAfterPointerDownOnTouchDevices(n),!this.state.penDetected&&n.pointerType==="pen"&&this.setState(m=>({penMode:!0,penDetected:!0})),!this.editorInterface.isTouchScreen&&["pen","touch"].includes(n.pointerType)&&(this.editorInterface=O2(this.editorInterface,{isTouchScreen:!0})),I1||(this.lastPointerDownEvent=n,this.handleCanvasPanUsingWheelOrSpaceDrag(n)))return;if(this.setState({lastPointerDownWith:n.pointerType,cursorButton:"down"}),this.savePointer(n.clientX,n.clientY,"down"),n.button===Vl.ERASER&&this.state.activeTool.type!==Qn.eraser){this.setState({activeTool:tn(this.state,{type:Qn.eraser,lastActiveToolBeforeEraser:this.state.activeTool})},()=>{this.handleCanvasPointerDown(n);const m=()=>{p(),U==null||U(),ko(this.state)&&this.setState({activeTool:tn(this.state,{...this.state.activeTool.lastActiveTool||{type:Qn.selection},lastActiveToolBeforeEraser:null})})},p=en(window,te.POINTER_UP,m,{once:!0});let U;requestAnimationFrame(()=>{U=this.missingPointerEventCleanupEmitter.once(m)})});return}if(n.button!==Vl.MAIN&&n.button!==Vl.TOUCH&&n.button!==Vl.ERASER||pt.pointers.size>1)return;const s=this.initialPointerDownState(n);if(this.setState({selectedElementsAreBeingDragged:!1}),this.handleDraggingScrollBar(n,s)||(this.clearSelectionIfNotUsingSelection(),this.updateBindingEnabledOnPointerMove(n),this.handleSelectionOnPointerDown(n,s))||!(!this.state.penMode||n.pointerType!=="touch"||this.state.activeTool.type==="selection"||this.state.activeTool.type==="lasso"||this.state.activeTool.type==="text"||this.state.activeTool.type==="image"))return;if(this.state.activeTool.type==="lasso"){const m=s.hit.element&&this.isASelectedElement(s.hit.element);!s.hit.hasHitCommonBoundingBoxOfSelectedElements&&!s.resize.handleType&&!m&&(this.lassoTrail.startPath(s.origin.x,s.origin.y,n.shiftKey),s.drag.blockDragging=this.editorInterface.formFactor==="desktop"),this.editorInterface.formFactor!=="desktop"&&s.hit.element&&!m&&(this.setState(p=>{const U={...p.selectedElementIds,[s.hit.element.id]:!0},b=[];Object.keys(p.selectedElementIds).forEach(w=>{const v=this.scene.getElement(w);v&&b.push(v)});const y=s.hit.element;if(we(y))ns(b,y.id).forEach(w=>{delete U[w.id]});else if(y.frameId)U[y.frameId]&&delete U[y.id];else{const w=y.groupIds,v=new Set(w.flatMap(I=>At(this.scene.getNonDeletedElements(),I)).filter(I=>we(I)).map(I=>I.id));v.size>0&&b.forEach(I=>{I.frameId&&v.has(I.frameId)&&(delete U[I.id],I.groupIds.flatMap(C=>At(this.scene.getNonDeletedElements(),C)).forEach(C=>{delete U[C.id]}))})}return{...Si({editingGroupId:p.editingGroupId,selectedElementIds:U},this.scene.getNonDeletedElements(),p,this),showHyperlinkPopup:y.link||or(y)?"info":!1}}),s.hit.wasAddedToSelection=!0)}else this.state.activeTool.type==="text"?this.handleTextOnPointerDown(n,s):this.state.activeTool.type==="arrow"||this.state.activeTool.type==="line"?this.handleLinearElementOnPointerDown(n,this.state.activeTool.type,s):this.state.activeTool.type==="freedraw"?this.handleFreeDrawElementOnPointerDown(n,this.state.activeTool.type,s):this.state.activeTool.type==="custom"?So(this.interactiveCanvas,this.state):this.state.activeTool.type===Qn.frame||this.state.activeTool.type===Qn.magicframe?this.createFrameElementOnPointerDown(s,this.state.activeTool.type):this.state.activeTool.type==="laser"?this.laserTrails.startPath(s.lastCoords.x,s.lastCoords.y):this.state.activeTool.type!=="eraser"&&this.state.activeTool.type!=="hand"&&this.state.activeTool.type!=="image"&&this.createGenericElementOnPointerDown(this.state.activeTool.type,s);(h=(f=this.props)==null?void 0:f.onPointerDown)==null||h.call(f,this.state.activeTool,s),this.onPointerDownEmitter.trigger(this.state.activeTool,s,n),this.state.activeTool.type==="eraser"&&this.eraserTrail.startPath(s.lastCoords.x,s.lastCoords.y);const a=this.onPointerMoveFromPointerDownHandler(s),l=this.onPointerUpFromPointerDownHandler(s),c=this.onKeyDownFromPointerDownHandler(s),d=this.onKeyUpFromPointerDownHandler(s);this.missingPointerEventCleanupEmitter.once(m=>l(m||n.nativeEvent)),(!this.state.viewModeEnabled||this.state.activeTool.type==="laser")&&(window.addEventListener(te.POINTER_MOVE,a),window.addEventListener(te.POINTER_UP,l),window.addEventListener(te.KEYDOWN,c),window.addEventListener(te.KEYUP,d),s.eventListeners.onMove=a,s.eventListeners.onUp=l,s.eventListeners.onKeyUp=d,s.eventListeners.onKeyDown=c)});F(this,"handleCanvasPointerUp",n=>{var s;this.removePointer(n),this.lastPointerUpEvent=n;const i=Nt({clientX:n.clientX,clientY:n.clientY},this.state),r=n.timeStamp-(((s=this.lastPointerDownEvent)==null?void 0:s.timeStamp)??0);if(this.editorInterface.formFactor==="phone"&&r<300){const o=this.getElementAtPosition(i.x,i.y);if(Es(o)&&this.isIframeLikeElementCenter(o,n,i.x,i.y)){this.handleEmbeddableCenterClick(o);return}}if(this.editorInterface.isTouchScreen){const o=this.getElementAtPosition(i.x,i.y,{includeLockedElements:!0});this.hitLinkElement=this.getElementLinkAtPosition(i,o)}this.hitLinkElement&&!this.state.selectedElementIds[this.hitLinkElement.id]?r<300&&Es(this.hitLinkElement)&&!uX(this.hitLinkElement,this.scene.getNonDeletedElementsMap(),this.state,S(i.x,i.y))?this.handleEmbeddableCenterClick(this.hitLinkElement):this.redirectToLink(n,this.editorInterface.isTouchScreen):this.state.viewModeEnabled&&this.setState({activeEmbeddable:null,selectedElementIds:{}})});F(this,"maybeOpenContextMenuAfterPointerDownOnTouchDevices",n=>{n.pointerType==="touch"&&(x1=!1,zl?x1=!0:zl=window.setTimeout(()=>{zl=0,x1||this.handleCanvasContextMenu(n)},jre))});F(this,"resetContextMenuTimer",()=>{clearTimeout(zl),zl=0,x1=!1});F(this,"maybeCleanupAfterMissingPointerUp",n=>{vd==null||vd(),this.missingPointerEventCleanupEmitter.trigger(n).clear()});F(this,"handleCanvasPanUsingWheelOrSpaceDrag",n=>{if(!(pt.pointers.size<=1&&(n.button===Vl.WHEEL||n.button===Vl.MAIN&&Ed||Qh(this.state)||this.state.viewModeEnabled)))return!1;I1=!0,this.focusContainer(),this.state.editingTextElement||n.preventDefault();let i=!1;const r=typeof window===void 0?!1:/Linux/.test(window.navigator.platform);Lt(this.interactiveCanvas,Ct.GRABBING);let{clientX:s,clientY:o}=n;const a=N3(c=>{const d=s-c.clientX,u=o-c.clientY;if(s=c.clientX,o=c.clientY,r&&!i&&(Math.abs(d)>1||Math.abs(u)>1)){i=!0;const f=m=>{document.body.removeEventListener(te.PASTE,f),m.stopPropagation()},h=()=>{setTimeout(()=>{document.body.removeEventListener(te.PASTE,f),window.removeEventListener(te.POINTER_UP,h)},100)};document.body.addEventListener(te.PASTE,f),window.addEventListener(te.POINTER_UP,h)}this.translateCanvas({scrollX:this.state.scrollX-d/this.state.zoom.value,scrollY:this.state.scrollY-u/this.state.zoom.value})}),l=an(vd=()=>{vd=null,I1=!1,Ed||(this.state.viewModeEnabled?Lt(this.interactiveCanvas,Ct.GRAB):So(this.interactiveCanvas,this.state)),this.setState({cursorButton:"up"}),this.savePointer(n.clientX,n.clientY,"up"),window.removeEventListener(te.POINTER_MOVE,a),window.removeEventListener(te.POINTER_UP,l),window.removeEventListener(te.BLUR,l),a.flush()});return window.addEventListener(te.BLUR,l),window.addEventListener(te.POINTER_MOVE,a,{passive:!0}),window.addEventListener(te.POINTER_UP,l),!0});F(this,"clearSelectionIfNotUsingSelection",()=>{this.state.activeTool.type!=="selection"&&this.state.activeTool.type!=="lasso"&&this.setState({selectedElementIds:xt({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null})});F(this,"handleSelectionOnPointerDown",(n,i)=>{var r,s,o,a;if(this.state.activeTool.type==="selection"||this.state.activeTool.type==="lasso"){const l=this.scene.getNonDeletedElements(),c=this.scene.getNonDeletedElementsMap(),d=this.scene.getSelectedElements(this.state);if(d.length===1&&!((r=this.state.selectedLinearElement)!=null&&r.isEditing)&&!me(d[0])&&!(xe(d[0])&&(this.editorInterface.userAgent.isMobileDevice||d[0].points.length===2))&&!(this.state.selectedLinearElement&&this.state.selectedLinearElement.hoverPointIndex!==-1)){const u=NM(l,this.state,i.origin.x,i.origin.y,this.state.zoom,n.pointerType,this.scene.getNonDeletedElementsMap(),this.editorInterface);u!=null&&(u.transformHandleType==="rotation"?(this.setState({resizingElement:u.element}),i.resize.handleType=u.transformHandleType):(this.state.croppingElementId||this.setState({resizingElement:u.element}),i.resize.handleType=u.transformHandleType))}else d.length>1&&(i.resize.handleType=OM(ht(d),i.origin.x,i.origin.y,this.state.zoom,n.pointerType,this.editorInterface));if(i.resize.handleType)i.resize.isResizing=!0,i.resize.offset=qa(Fde(i.resize.handleType,d,c,i.origin.x,i.origin.y)),d.length===1&&xe(d[0])&&d[0].points.length===2&&(i.resize.arrowDirection=Bde(i.resize.handleType,d[0]));else{if(this.state.selectedLinearElement){const U=this.state.selectedLinearElement,b=pe.handlePointerDown(n,this,this.store,i.origin,U,this.scene);if(b.hitElement&&(i.hit.element=b.hitElement),b.linearElementEditor&&this.setState({selectedLinearElement:b.linearElementEditor}),b.didAddPoint)return!0}const u=this.getElementsAtPosition(i.origin.x,i.origin.y,{includeLockedElements:!0}),f=u.filter(U=>!U.locked),h=this.getElementAtPosition(i.origin.x,i.origin.y,{allHitElements:u});if((!h||h.id!==this.state.activeLockedId)&&this.setState({activeLockedId:null}),h&&h.locked&&!f.some(U=>this.state.selectedElementIds[U.id])?i.hit.element=null:i.hit.element=i.hit.element??this.getElementAtPosition(i.origin.x,i.origin.y),this.hitLinkElement=this.getElementLinkAtPosition(i.origin,h),this.hitLinkElement)return!0;if(this.state.croppingElementId&&((s=i.hit.element)==null?void 0:s.id)!==this.state.croppingElementId&&this.finishImageCropping(),i.hit.element&&this.getElementLinkAtPosition({x:i.origin.x,y:i.origin.y},i.hit.element))return!1;i.hit.allHitElements=f;const m=i.hit.element,p=i.hit.allHitElements.some(U=>this.isASelectedElement(U));if((m===null||!p)&&!n.shiftKey&&!i.hit.hasHitCommonBoundingBoxOfSelectedElements&&this.clearSelection(m),(o=this.state.selectedLinearElement)!=null&&o.isEditing)this.setState({selectedElementIds:xt({[this.state.selectedLinearElement.elementId]:!0},this.state)});else if(m!=null){if(n[V.CTRL_OR_CMD])return n.altKey?(((a=this.state.openDialog)==null?void 0:a.name)==="elementLinkSelector"&&this.setOpenDialog(null),this.lassoTrail.startPath(i.origin.x,i.origin.y,n.shiftKey),this.setActiveTool({type:"lasso",fromSelection:!0}),!1):(this.state.selectedElementIds[m.id]||(i.hit.wasAddedToSelection=!0),this.setState(U=>({...Xle(U,m),previousSelectedElementIds:this.state.selectedElementIds})),!1);this.state.selectedElementIds[m.id]||(this.state.editingGroupId&&!pm(m,this.state.editingGroupId)&&this.setState({selectedElementIds:xt({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null}),!p&&!i.hit.hasHitCommonBoundingBoxOfSelectedElements&&(this.setState(U=>{var w;let b={...U.selectedElementIds,[m.id]:!0};const y=[];if(Object.keys(U.selectedElementIds).forEach(v=>{const I=this.scene.getElement(v);I&&y.push(I)}),we(m))ns(y,m.id).forEach(v=>{delete b[v.id]});else if(m.frameId)b[m.frameId]&&delete b[m.id];else{const v=m.groupIds,I=new Set(v.flatMap(C=>At(this.scene.getNonDeletedElements(),C)).filter(C=>we(C)).map(C=>C.id));I.size>0&&y.forEach(C=>{C.frameId&&I.has(C.frameId)&&(delete b[C.id],C.groupIds.flatMap(_=>At(this.scene.getNonDeletedElements(),_)).forEach(_=>{delete b[_.id]}))})}return((w=U.openDialog)==null?void 0:w.name)==="elementLinkSelector"&&(m.groupIds.some(v=>U.selectedGroupIds[v])||(b={[m.id]:!0})),{...Si({editingGroupId:U.editingGroupId,selectedElementIds:b},this.scene.getNonDeletedElements(),U,this),showHyperlinkPopup:m.link||or(m)?"info":!1}}),i.hit.wasAddedToSelection=!0))}this.setState({previousSelectedElementIds:this.state.selectedElementIds})}}return!1});F(this,"handleTextOnPointerDown",(n,i)=>{if(this.state.editingTextElement)return;let r=i.origin.x,s=i.origin.y;const o=this.getElementAtPosition(r,s,{includeBoundTextElement:!0});let a=this.getTextBindableContainerAtPosition(r,s);Li(o)&&(a=o,r=o.x+o.width/2,s=o.y+o.height/2),this.startTextEditing({sceneX:r,sceneY:s,insertAtParentCenter:!n.altKey,container:a,autoEdit:!1}),Io(this.interactiveCanvas),this.state.activeTool.locked||this.setState({activeTool:tn(this.state,{type:this.state.preferredSelectionTool.type})})});F(this,"handleFreeDrawElementOnPointerDown",(n,i,r)=>{const[s,o]=Pn(r.origin.x,r.origin.y,null),a=this.getTopLayerFrameAtSceneCoords({x:s,y:o}),l=n.pressure===.5,c=gde({type:i,x:s,y:o,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:null,simulatePressure:l,locked:!1,frameId:a?a.id:null,points:[S(0,0)],pressures:l?[]:[n.pressure]});this.scene.insertElement(c),this.setState(u=>{const f={...u.selectedElementIds};return delete f[c.id],{selectedElementIds:xt(f,u)}});const d=el(r.origin,this.scene.getNonDeletedElements(),this.scene.getNonDeletedElementsMap(),this.state.zoom);this.setState({newElement:c,startBoundElement:d,suggestedBindings:[]})});F(this,"insertIframeElement",({sceneX:n,sceneY:i,width:r,height:s})=>{var c;const[o,a]=Pn(n,i,(c=this.lastPointerDownEvent)!=null&&c[V.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),l=ude({type:"iframe",x:o,y:a,strokeColor:"transparent",backgroundColor:"transparent",fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,roundness:this.getCurrentItemRoundness("iframe"),opacity:this.state.currentItemOpacity,locked:!1,width:r,height:s});return this.scene.insertElement(l),l});F(this,"insertEmbeddableElement",({sceneX:n,sceneY:i,link:r})=>{var c;const[s,o]=Pn(n,i,(c=this.lastPointerDownEvent)!=null&&c[V.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),a=Zf(r);if(!a)return;a.error instanceof URIError&&this.setToast({message:M("toast.unrecognizedLinkFormat"),closable:!0});const l=TM({type:"embeddable",x:s,y:o,strokeColor:"transparent",backgroundColor:"transparent",fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,roundness:this.getCurrentItemRoundness("embeddable"),opacity:this.state.currentItemOpacity,locked:!1,width:a.intrinsicSize.w,height:a.intrinsicSize.h,link:r});return this.scene.insertElement(l),l});F(this,"newImagePlaceholder",({sceneX:n,sceneY:i,addToFrameUnderCursor:r=!0})=>{var c;const[s,o]=Pn(n,i,(c=this.lastPointerDownEvent)!=null&&c[V.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),a=r?this.getTopLayerFrameAtSceneCoords({x:s,y:o}):null,l=100/this.state.zoom.value;return hH({type:"image",strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,roundness:null,opacity:this.state.currentItemOpacity,locked:!1,frameId:a?a.id:null,x:s-l/2,y:o-l/2,width:l,height:l})});F(this,"handleLinearElementOnPointerDown",(n,i,r)=>{if(this.state.multiElement){const{multiElement:s}=this.state;if(s.type==="line"&&Jo(s.points,this.state.zoom.value)){this.scene.mutateElement(s,{lastCommittedPoint:s.points[s.points.length-1]}),this.actionManager.executeAction(Vs);return}if(me(s)&&s.points.length>1){this.scene.mutateElement(s,{lastCommittedPoint:s.points[s.points.length-1]}),this.actionManager.executeAction(Vs);return}const{x:o,y:a,lastCommittedPoint:l}=s;if(s.points.length>1&&l&&ct(S(r.origin.x-o,r.origin.y-a),l)<L2){this.actionManager.executeAction(Vs);return}this.setState(c=>({selectedElementIds:xt({...c.selectedElementIds,[s.id]:!0},c)})),this.scene.mutateElement(s,{lastCommittedPoint:s.points[s.points.length-1]}),Lt(this.interactiveCanvas,Ct.POINTER)}else{const[s,o]=Pn(r.origin.x,r.origin.y,n[V.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),a=this.getTopLayerFrameAtSceneCoords({x:s,y:o}),{currentItemStartArrowhead:l,currentItemEndArrowhead:c}=this.state,[d,u]=i==="arrow"?[l,c]:[null,null],f=i==="arrow"?gh({type:i,x:s,y:o,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:this.state.currentItemArrowType===fi.round?{type:yn.PROPORTIONAL_RADIUS}:null,startArrowhead:d,endArrowhead:u,locked:!1,frameId:a?a.id:null,elbowed:this.state.currentItemArrowType===fi.elbow,fixedSegments:this.state.currentItemArrowType===fi.elbow?[]:null}):Tc({type:i,x:s,y:o,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:this.state.currentItemRoundness==="round"?{type:yn.PROPORTIONAL_RADIUS}:null,locked:!1,frameId:a?a.id:null});this.setState(m=>{const p={...m.selectedElementIds};return delete p[f.id],{selectedElementIds:xt(p,m)}}),this.scene.mutateElement(f,{points:[...f.points,S(0,0)]});const h=el(r.origin,this.scene.getNonDeletedElements(),this.scene.getNonDeletedElementsMap(),this.state.zoom,me(f),me(f));this.scene.insertElement(f),this.setState({newElement:f,startBoundElement:h,suggestedBindings:[]})}});F(this,"createGenericElementOnPointerDown",(n,i)=>{var c;const[r,s]=Pn(i.origin.x,i.origin.y,(c=this.lastPointerDownEvent)!=null&&c[V.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),o=this.getTopLayerFrameAtSceneCoords({x:r,y:s}),a={x:r,y:s,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:this.getCurrentItemRoundness(n),locked:!1,frameId:o?o.id:null};let l;n==="embeddable"?l=TM({type:"embeddable",...a}):l=ia({type:n,...a}),l.type==="selection"?this.setState({selectionElement:l}):(this.scene.insertElement(l),this.setState({multiElement:null,newElement:l}))});F(this,"createFrameElementOnPointerDown",(n,i)=>{var l;const[r,s]=Pn(n.origin.x,n.origin.y,(l=this.lastPointerDownEvent)!=null&&l[V.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),o={x:r,y:s,opacity:this.state.currentItemOpacity,locked:!1,...zt},a=i===Qn.magicframe?G4(o):L9(o);this.scene.insertElement(a),this.setState({multiElement:null,newElement:a})});F(this,"restoreReadyToEraseElements",()=>{this.elementsPendingErasure=new Set,this.triggerRender()});F(this,"eraseElements",()=>{let n=!1;const i=this.scene.getElementsIncludingDeleted().map(r=>this.elementsPendingErasure.has(r.id)||r.frameId&&this.elementsPendingErasure.has(r.frameId)||Dt(r)&&this.elementsPendingErasure.has(r.containerId)?(n=!0,Ie(r,{isDeleted:!0})):r);this.elementsPendingErasure=new Set,n&&(this.store.scheduleCapture(),this.scene.replaceAllElements(i))});F(this,"initializeImage",async(n,i)=>{var l,c,d;if(!Om(i))throw new Error(M("errors.unsupportedFileType"));const r=i.type;if(Lt(this.interactiveCanvas,"wait"),r===Te.svg)try{i=zR(kM(await i.text()),i.name)}catch(u){throw console.warn(u),new Error(M("errors.svgImageInsertError"))}const s=await(((c=(l=this.props).generateIdForFile)==null?void 0:c.call(l,i))||yye(i));if(!s)throw console.warn("Couldn't generate file id or the supplied `generateIdForFile` didn't resolve to one."),new Error(M("errors.imageInsertError"));const o=this.files[s];if(!(o!=null&&o.dataURL)){try{i=await IX(i,{maxWidthOrHeight:Zre})}catch(u){console.error("Error trying to resizing image file on insertion",u)}if(i.size>_A)throw new Error(M("errors.fileTooBig",{maxSize:`${Math.trunc(_A/1024/1024)}MB`}))}const a=((d=this.files[s])==null?void 0:d.dataURL)||await TX(i);return new Promise(async(u,f)=>{var h,m;try{let p=this.getLatestInitializedImageElement(n,s);if(this.addMissingFiles([{mimeType:r,id:s,dataURL:a,created:Date.now(),lastRetrieved:Date.now()}]),!this.imageCache.get(s)){this.addNewImagesToImageCache();const{erroredFiles:b}=await this.updateImageCache([p]);if(b.size)throw new Error("Image cache update resulted with an error.")}const U=await((h=this.imageCache.get(s))==null?void 0:h.image);if(U&&((m=this.state.newElement)==null?void 0:m.id)!==p.id){p=this.getLatestInitializedImageElement(n,s);const b=this.getImageNaturalDimensions(p,U);Object.assign(p,b)}u(p)}catch(p){console.error(p),f(new Error(M("errors.imageInsertError")))}})});F(this,"getLatestInitializedImageElement",(n,i)=>{const r=this.scene.getElement(n.id)??n;return Ie(r,{fileId:i})});F(this,"onImageToolbarButtonClick",async()=>{try{const n=this.state.width/2+this.state.offsetLeft,i=this.state.height/2+this.state.offsetTop,{x:r,y:s}=Nt({clientX:n,clientY:i},this.state),o=await LT({description:"Image",extensions:Object.keys(Fh),multiple:!0});this.insertImages(o,r,s)}catch(n){n.name!=="AbortError"?console.error(n):console.warn(n),this.setState({newElement:null,activeTool:tn(this.state,{type:this.state.preferredSelectionTool.type})},()=>{this.actionManager.executeAction(Vs)})}});F(this,"getImageNaturalDimensions",(n,i)=>{const r=Math.max(this.state.height-120,160),s=Math.min(r,Math.floor(this.state.height*.5)/this.state.zoom.value),o=Math.min(i.naturalHeight,s),a=o*(i.naturalWidth/i.naturalHeight),l=n.x+n.width/2-a/2,c=n.y+n.height/2-o/2;return{x:l,y:c,width:a,height:o,crop:null}});F(this,"updateImageCache",async(n,i=this.files)=>{const{updatedFiles:r,erroredFiles:s}=await UH({imageCache:this.imageCache,fileIds:n.map(o=>o.fileId),files:i});return s.size&&(this.store.scheduleAction(Z.NEVER),this.scene.replaceAllElements(this.scene.getElementsIncludingDeleted().map(o=>Dn(o)&&s.has(o.fileId)?Ie(o,{status:"error"}):o))),{updatedFiles:r,erroredFiles:s}});F(this,"addNewImagesToImageCache",async(n=bH(this.scene.getNonDeletedElements()),i=this.files)=>{const r=n.filter(s=>!s.isDeleted&&!this.imageCache.has(s.fileId));if(r.length){const{updatedFiles:s}=await this.updateImageCache(r,i);if(s.size)for(const o of r)s.has(o.fileId)&&qt.delete(o);s.size&&this.scene.triggerUpdate()}});F(this,"scheduleImageRefresh",zo(()=>{this.addNewImagesToImageCache()},Gre));F(this,"updateBindingEnabledOnPointerMove",n=>{const i=fle(n);this.state.isBindingEnabled!==i&&this.setState({isBindingEnabled:i})});F(this,"maybeSuggestBindingAtCursor",(n,i)=>{const r=el(n,this.scene.getNonDeletedElements(),this.scene.getNonDeletedElementsMap(),this.state.zoom,!1,i);this.setState({suggestedBindings:r!=null?[r]:[]})});F(this,"handleInteractiveCanvasRef",n=>{var i,r;n!==null?(this.interactiveCanvas=n,this.interactiveCanvas.addEventListener(te.TOUCH_START,this.onTouchStart,{passive:!1}),this.interactiveCanvas.addEventListener(te.TOUCH_END,this.onTouchEnd)):((i=this.interactiveCanvas)==null||i.removeEventListener(te.TOUCH_START,this.onTouchStart),(r=this.interactiveCanvas)==null||r.removeEventListener(te.TOUCH_END,this.onTouchEnd))});F(this,"insertImages",async(n,i,r)=>{const s=50/this.state.zoom.value,o=RM(n.map(()=>this.newImagePlaceholder({sceneX:i,sceneY:r})),i,r,s);o.forEach(f=>this.scene.insertElement(f));const a=await Promise.all(o.map(async(f,h)=>{try{return await this.initializeImage(f,await Fm(n[h]))}catch(m){return this.setState({errorMessage:m.message||M("errors.imageInsertError")}),Ie(f,{isDeleted:!0})}})),l=ve(a),c=RM(a.filter(f=>!f.isDeleted),i,r,s),d=ve(c),u=this.scene.getElementsIncludingDeleted().map(f=>d.get(f.id)??l.get(f.id)??f);this.updateScene({appState:{selectedElementIds:xt(Object.fromEntries(c.map(f=>[f.id,!0])),this.state)},elements:u,captureUpdate:Z.IMMEDIATELY}),this.setState({},()=>{this.actionManager.executeAction(Vs)})});F(this,"handleAppOnDrop",async n=>{var u;const{x:i,y:r}=Nt(n,this.state),s=await Sv(n),o=s.getFiles();if(o.length===1){const{file:f,fileHandle:h}=o[0];if(f&&(f.type===Te.png||f.type===Te.svg))try{const m=await BT(f,this.state,this.scene.getElementsIncludingDeleted(),h);this.syncActionResult({...m,appState:{...m.appState||this.state,isLoading:!1},replaceFiles:!0,captureUpdate:Z.IMMEDIATELY});return}catch(m){if(m.name!=="EncodingError")throw new Error(M("alerts.couldNotLoadInvalidFile"))}}const a=o.map(f=>f.file).filter(f=>Om(f));if(a.length>0&&this.isToolSupported("image"))return this.insertImages(a,i,r);const l=s.getData(Te.excalidrawlibIds),c=s.getData(Te.excalidrawlib);if(l||c){try{let f=null;if(l){const{itemIds:h}=JSON.parse(l);f=(await this.library.getLatestLibrary()).filter(p=>h.includes(p.id))}else c&&(f=_X(c));f!=null&&f.length&&(f=f.map(h=>({...h,elements:S0({type:"everything",elements:h.elements,randomizeSeed:!0}).duplicatedElements})),this.addElementsFromPasteOrLibrary({elements:jT(f),position:n,files:null}))}catch(f){this.setState({errorMessage:f.message})}return}if(o.length>0){const{file:f,fileHandle:h}=o[0];f&&await this.loadFileToCanvas(f,h)}const d=s.findByType(Te.text);if(d){const f=d.value;if(f&&G2(f,this.props.validateEmbeddable)&&(/^(http|https):\/\/[^\s/$.?#].[^\s]*$/.test(f)||((u=Zf(f))==null?void 0:u.type)==="video")){const h=this.insertEmbeddableElement({sceneX:i,sceneY:r,link:ts(f)});h&&(this.store.scheduleCapture(),this.setState({selectedElementIds:{[h.id]:!0}}))}}});F(this,"loadFileToCanvas",async(n,i)=>{n=await Fm(n);try{const r=this.scene.getElementsIncludingDeleted();let s;try{s=await wX(n,this.state,r,i)}catch(o){const a=o instanceof Fd;if(a&&o.code==="IMAGE_NOT_CONTAINS_SCENE_DATA"&&!this.isToolSupported("image")){this.setState({isLoading:!1,errorMessage:M("errors.imageToolNotSupported")});return}const l=M(a?"alerts.cannotRestoreFromImage":"alerts.couldNotLoadInvalidFile");this.setState({isLoading:!1,errorMessage:l})}if(!s)return;s.type===Te.excalidraw?(cd(r.concat(s.data.elements)),this.store.scheduleMicroAction({action:Z.NEVER,elements:r,appState:void 0}),this.setState({isLoading:!0}),this.syncActionResult({...s.data,appState:{...s.data.appState||this.state,isLoading:!1},replaceFiles:!0,captureUpdate:Z.IMMEDIATELY})):s.type===Te.excalidrawlib&&await this.library.updateLibrary({libraryItems:n,merge:!0,openLibraryMenu:!0}).catch(o=>{console.error(o),this.setState({errorMessage:M("errors.importLibraryError")})})}catch(r){this.setState({isLoading:!1,errorMessage:r.message})}});F(this,"handleCanvasContextMenu",n=>{if(n.preventDefault(),("pointerType"in n.nativeEvent&&n.nativeEvent.pointerType==="touch"||"pointerType"in n.nativeEvent&&n.nativeEvent.pointerType==="pen"&&n.button!==Vl.SECONDARY)&&this.state.activeTool.type!==this.state.preferredSelectionTool.type)return;const{x:i,y:r}=Nt(n,this.state),s=this.getElementAtPosition(i,r,{preferSelected:!0,includeLockedElements:!0}),o=this.scene.getSelectedElements(this.state),a=this.isHittingCommonBoundingBoxOfSelectedElements({x:i,y:r},o),l=s||a?"element":"canvas",c=this.excalidrawContainerRef.current,{top:d,left:u}=c.getBoundingClientRect(),f=n.clientX-u,h=n.clientY-d;et("contextMenu","openContextMenu",l),this.setState({...s&&!this.state.selectedElementIds[s.id]?{...this.state,...Si({editingGroupId:this.state.editingGroupId,selectedElementIds:{[s.id]:!0}},this.scene.getNonDeletedElements(),this.state,this),selectedLinearElement:xe(s)?new pe(s,this.scene.getNonDeletedElementsMap()):null}:this.state,showHyperlinkPopup:!1},()=>{this.setState({contextMenu:{top:h,left:f,items:this.getContextMenuItems(l)}})})});F(this,"maybeDragNewGenericElement",(n,i,r=!0)=>{var m,p,U;const s=this.state.selectionElement,o=n.lastCoords;if(s&&this.state.activeTool.type!=="eraser"){_M({newElement:s,elementType:this.state.activeTool.type,originX:n.origin.x,originY:n.origin.y,x:o.x,y:o.y,width:Gi(n.origin.x,o.x),height:Gi(n.origin.y,o.y),shouldMaintainAspectRatio:c1(i),shouldResizeFromCenter:!1,scene:this.scene,zoom:this.state.zoom.value,informMutation:!1});return}const a=this.state.newElement;if(!a)return;let[l,c]=Pn(o.x,o.y,i[V.CTRL_OR_CMD]?null:this.getEffectiveGridSize());const d=Dn(a)&&((m=this.imageCache.get(a.fileId))==null?void 0:m.image),u=d&&!(d instanceof Promise)?d.width/d.height:null;this.maybeCacheReferenceSnapPoints(i,[a]);const{snapOffset:f,snapLines:h}=i7e(a,this,i,{x:n.originInGrid.x+(((p=this.state.originSnapOffset)==null?void 0:p.x)??0),y:n.originInGrid.y+(((U=this.state.originSnapOffset)==null?void 0:U.y)??0)},{x:l-n.originInGrid.x,y:c-n.originInGrid.y},this.scene.getNonDeletedElementsMap());l+=f.x,c+=f.y,this.setState({snapLines:h}),_M({newElement:a,elementType:this.state.activeTool.type,originX:n.originInGrid.x,originY:n.originInGrid.y,x:l,y:c,width:Gi(n.originInGrid.x,l),height:Gi(n.originInGrid.y,c),shouldMaintainAspectRatio:yt(a)?!c1(i):c1(i),shouldResizeFromCenter:TA(i),zoom:this.state.zoom.value,scene:this.scene,widthAspectRatio:u,originOffset:this.state.originSnapOffset,informMutation:r}),this.setState({newElement:a}),(this.state.activeTool.type===Qn.frame||this.state.activeTool.type===Qn.magicframe)&&this.setState({elementsToHighlight:jo(this.scene.getNonDeletedElements(),a,this.state,this.scene.getNonDeletedElementsMap())})});F(this,"maybeHandleCrop",(n,i)=>{var c;if(!this.state.croppingElementId)return!1;const r=n.resize.handleType,s=n.lastCoords,[o,a]=Pn(s.x-n.resize.offset.x,s.y-n.resize.offset.y,i[V.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),l=this.scene.getNonDeletedElementsMap().get(this.state.croppingElementId);if(r&&l&&yt(l)){const d=n.originalElements.get(l.id),u=Dn(l)&&((c=this.imageCache.get(l.fileId))==null?void 0:c.image);if(d&&yt(d)&&u&&!(u instanceof Promise)){const[f,h]=Pn(s.x,s.y,i[V.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),m={x:f-n.originInGrid.x,y:h-n.originInGrid.y};this.maybeCacheReferenceSnapPoints(i,[l]);const{snapOffset:p,snapLines:U}=ED([l],[d],this,i,m,r);this.scene.mutateElement(l,hae(l,this.scene.getNonDeletedElementsMap(),r,u.naturalWidth,u.naturalHeight,o+p.x,a+p.y,i.shiftKey?d.width/d.height:void 0)),fr(l,this.scene,{newSize:{width:l.width,height:l.height}}),this.setState({isCropping:r&&r!=="rotation",snapLines:U})}return!0}return!1});F(this,"maybeHandleResize",(n,i)=>{const r=this.scene.getSelectedElements(this.state),s=r.filter(u=>we(u)),o=n.resize.handleType;if(s.length>0&&o==="rotation"||r.length===1&&me(r[0])||this.state.croppingElementId)return!1;this.setState({isResizing:o&&o!=="rotation",isRotating:o==="rotation",activeEmbeddable:null});const a=n.lastCoords;let[l,c]=Pn(a.x-n.resize.offset.x,a.y-n.resize.offset.y,i[V.CTRL_OR_CMD]?null:this.getEffectiveGridSize());const d=new Map;if(s.forEach(u=>{ns(this.scene.getNonDeletedElements(),u.id).forEach(h=>{d.set(u.id+h.id,{x:h.x-u.x,y:h.y-u.y})})}),!this.state.selectedElementsAreBeingDragged){const[u,f]=Pn(a.x,a.y,i[V.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),h={x:u-n.originInGrid.x,y:f-n.originInGrid.y},m=[...n.originalElements.values()];this.maybeCacheReferenceSnapPoints(i,r);const{snapOffset:p,snapLines:U}=ED(r,Xe(m,this.state),this,i,h,o);l+=p.x,c+=p.y,this.setState({snapLines:U})}if(Lde(n.originalElements,o,r,this.scene,E0(i),TA(i),r.some(u=>yt(u))?!c1(i):c1(i),l,c,n.resize.center.x,n.resize.center.y)){const u=V8(r,this.scene.getNonDeletedElementsMap(),this.state.zoom),f=new Set;return s.forEach(h=>{jo(this.scene.getNonDeletedElements(),h,this.state,this.scene.getNonDeletedElementsMap()).forEach(m=>f.add(m))}),this.setState({elementsToHighlight:[...f],suggestedBindings:u}),!0}return!1});F(this,"getContextMenuItems",n=>{const i=[];if(i.push(WR,YR),n==="canvas")return this.state.viewModeEnabled?[...i,ZR,Cv,Fv,Av]:[XR,qn,WR,YR,KR,qn,phe,_Ee,qn,ZR,uEe,Cv,Fv,Av];if(i.push(KR),this.state.viewModeEnabled)return[ob,...i];const r=this.editorInterface.formFactor==="desktop"?[qn,fhe,hhe,ghe,mhe]:[];return[qn,jR,ob,XR,qn,V3e,$3e,G3e,qn,H3e,qn,...i,qn,Jye,eEe,qn,nEe,Y3e,fEe,hEe,pEe,iEe,qn,aEe,...r,qn,lEe,cEe,qn,l2,qn,BX,XX,qn,Uhe,zX,qn,QV]});F(this,"handleWheel",an(n=>{if(!(n.target instanceof HTMLCanvasElement||n.target instanceof HTMLTextAreaElement||n.target instanceof HTMLIFrameElement)){n[V.CTRL_OR_CMD]&&n.preventDefault();return}if(n.preventDefault(),I1)return;const{deltaX:i,deltaY:r}=n;if(n.metaKey||n.ctrlKey){const s=Math.sign(r),o=J5*100,a=Math.abs(r);let l=r;a>o&&(l=o*s);let c=this.state.zoom.value-l/100;c+=Math.log10(Math.max(1,this.state.zoom.value))*-s*Math.min(1,a/20),this.translateCanvas(d=>({...Bd({viewportX:this.lastViewportPosition.x,viewportY:this.lastViewportPosition.y,nextZoom:Xa(c)},d),shouldCacheIgnoreZoom:!0})),this.resetShouldCacheIgnoreZoomDebounced();return}if(n.shiftKey){this.translateCanvas(({zoom:s,scrollX:o})=>({scrollX:o-(r||i)/s.value}));return}this.translateCanvas(({zoom:s,scrollX:o,scrollY:a})=>({scrollX:o-i/s.value,scrollY:a-r/s.value}))}));F(this,"savePointer",(n,i,r)=>{var l,c;if(!n||!i)return;const{x:s,y:o}=Nt({clientX:n,clientY:i},this.state),a={x:s,y:o,tool:this.state.activeTool.type==="laser"?"laser":"pointer"};(c=(l=this.props).onPointerUpdate)==null||c.call(l,{pointer:a,button:r,pointersMap:pt.pointers})});F(this,"resetShouldCacheIgnoreZoomDebounced",ll(()=>{this.unmounted||this.setState({shouldCacheIgnoreZoom:!1})},300));F(this,"updateDOMRect",n=>{var i;if((i=this.excalidrawContainerRef)!=null&&i.current){const r=this.excalidrawContainerRef.current,{width:s,height:o,left:a,top:l}=r.getBoundingClientRect(),{width:c,height:d,offsetTop:u,offsetLeft:f}=this.state;if(s===c&&o===d&&a===f&&l===u){n&&n();return}this.setState({width:s,height:o,offsetLeft:a,offsetTop:l},()=>{n&&n()})}});F(this,"refresh",()=>{this.setState({...this.getCanvasOffsets()})});const i=sa(),{excalidrawAPI:r,viewModeEnabled:s=!1,zenModeEnabled:o=!1,gridModeEnabled:a=!1,objectsSnapModeEnabled:l=!1,theme:c=i.theme,name:d=`${M("labels.untitled")}-${AA()}`}=n;if(this.state={...i,theme:c,isLoading:!0,...this.getCanvasOffsets(),viewModeEnabled:s,zenModeEnabled:o,objectsSnapModeEnabled:l,gridModeEnabled:a??i.gridModeEnabled,name:d,width:window.innerWidth,height:window.innerHeight},this.refreshEditorInterface(),this.stylesPanelMode=y0(this.editorInterface),this.id=DH(),this.library=new p8e(this),this.actionManager=new W3e(this.syncActionResult,()=>this.state,()=>this.scene.getElementsIncludingDeleted(),this),this.scene=new k6,this.canvas=document.createElement("canvas"),this.rc=od.canvas(this.canvas),this.renderer=new wD(this.scene),this.visibleElements=[],this.store=new Rce(this),this.history=new Vd(this.store),r){const u={updateScene:this.updateScene,applyDeltas:this.applyDeltas,mutateElement:this.mutateElement,updateLibrary:this.library.updateLibrary,addFiles:this.addFiles,resetScene:this.resetScene,getSceneElementsIncludingDeleted:this.getSceneElementsIncludingDeleted,getSceneElementsMapIncludingDeleted:this.getSceneElementsMapIncludingDeleted,history:{clear:this.resetHistory},scrollToContent:this.scrollToContent,getSceneElements:this.getSceneElements,getAppState:()=>this.state,getFiles:()=>this.files,getName:this.getName,registerAction:f=>{this.actionManager.registerAction(f)},refresh:this.refresh,setToast:this.setToast,id:this.id,setActiveTool:this.setActiveTool,setCursor:this.setCursor,resetCursor:this.resetCursor,getEditorInterface:()=>this.editorInterface,updateFrameRendering:this.updateFrameRendering,toggleSidebar:this.toggleSidebar,onChange:f=>this.onChangeEmitter.on(f),onIncrement:f=>this.store.onStoreIncrementEmitter.on(f),onPointerDown:f=>this.onPointerDownEmitter.on(f),onPointerUp:f=>this.onPointerUpEmitter.on(f),onScrollChange:f=>this.onScrollChangeEmitter.on(f),onUserFollow:f=>this.onUserFollowEmitter.on(f)};typeof r=="function"?r(u):console.error("excalidrawAPI should be a function!")}this.excalidrawContainerValue={container:this.excalidrawContainerRef.current,id:this.id},this.fonts=new nl(this.scene),this.history=new Vd(this.store),this.actionManager.registerAll(uv),this.actionManager.registerAction(X3e(this.history)),this.actionManager.registerAction(j3e(this.history))}onWindowMessage(n){if(n.origin!=="https://player.vimeo.com"&&n.origin!=="https://www.youtube.com")return;let i=null;try{i=JSON.parse(n.data)}catch{}if(i)switch(n.origin){case"https://player.vimeo.com":if(i.method==="paused"){let r=null;const s=document.body.querySelectorAll("iframe.excalidraw__embeddable");if(!s)break;for(const o of s)o.contentWindow===n.source&&(r=o.contentWindow);r==null||r.postMessage(JSON.stringify({method:i.value?"play":"pause",value:!0}),"*")}break;case"https://www.youtube.com":if(i.event==="infoDelivery"&&i.info&&i.id&&typeof i.info.playerState=="number"){const r=i.id,s=i.info.playerState;Object.values(OU).includes(s)&&Z3.set(r,s)}break}}cacheEmbeddableRef(n,i){i&&this.iFrameRefs.set(n.id,i)}getHTMLIFrameElement(n){return this.iFrameRefs.get(n.id)}handleEmbeddableCenterClick(n){var r,s,o,a;if(((r=this.state.activeEmbeddable)==null?void 0:r.element)===n&&((s=this.state.activeEmbeddable)==null?void 0:s.state)==="active"||(setTimeout(()=>{this.setState({activeEmbeddable:{element:n,state:"active"},selectedElementIds:{[n.id]:!0},newElement:null,selectionElement:null})},100),Zl(n)))return;const i=this.getHTMLIFrameElement(n);if(i!=null&&i.contentWindow){if(i.src.includes("youtube")){const l=Z3.get(n.id);switch(l||(Z3.set(n.id,OU.UNSTARTED),i.contentWindow.postMessage(JSON.stringify({event:"listening",id:n.id}),"*")),l){case OU.PLAYING:case OU.BUFFERING:(o=i.contentWindow)==null||o.postMessage(JSON.stringify({event:"command",func:"pauseVideo",args:""}),"*");break;default:(a=i.contentWindow)==null||a.postMessage(JSON.stringify({event:"command",func:"playVideo",args:""}),"*")}}i.src.includes("player.vimeo.com")&&i.contentWindow.postMessage(JSON.stringify({method:"paused"}),"*")}}isIframeLikeElementCenter(n,i,r,s){var o,a;return n&&!i.altKey&&!i.shiftKey&&!i.metaKey&&!i.ctrlKey&&(((o=this.state.activeEmbeddable)==null?void 0:o.element)!==n||((a=this.state.activeEmbeddable)==null?void 0:a.state)==="hover"||!this.state.activeEmbeddable)&&r>=n.x+n.width/3&&r<=n.x+2*n.width/3&&s>=n.y+n.height/3&&s<=n.y+2*n.height/3}renderEmbeddables(){const n=this.state.zoom.value,i=this.state.width,r=this.state.height,s=this.scene.getNonDeletedElements().filter(o=>or(o)&&this.embedsValidationStatus.get(o.id)===!0||Zl(o));return g(fe,{children:s.map(o=>{var p,U,b,y,w,v,I,C,_;const{x:a,y:l}=Wr({sceneX:o.x,sceneY:o.y},this.state),c=A6(o,i,r,this.state,this.scene.getNonDeletedElementsMap()),d=this.initializedEmbeds.has(o.id);if(c&&!d&&this.initializedEmbeds.add(o.id),!(c||d))return null;let f;if(Zl(o)){f=null;const T=(((p=o.customData)==null?void 0:p.generationData)??this.magicGenerations.get(o.id))||{status:"error",message:"No generation data",code:"ERR_NO_GENERATION_DATA"};if(T.status==="done"){const k=T.html;f={intrinsicSize:{w:o.width,h:o.height},type:"document",srcdoc:()=>k}}else if(T.status==="pending")f={intrinsicSize:{w:o.width,h:o.height},type:"document",srcdoc:()=>x0(`
                    <style>
                      html, body {
                        width: 100%;
                        height: 100%;
                        color: ${this.state.theme===ke.DARK?"white":"black"};
                      }
                      body {
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        flex-direction: column;
                        gap: 1rem;
                      }

                      .Spinner {
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        margin-left: auto;
                        margin-right: auto;
                      }

                      .Spinner svg {
                        animation: rotate 1.6s linear infinite;
                        transform-origin: center center;
                        width: 40px;
                        height: 40px;
                      }

                      .Spinner circle {
                        stroke: currentColor;
                        animation: dash 1.6s linear 0s infinite;
                        stroke-linecap: round;
                      }

                      @keyframes rotate {
                        100% {
                          transform: rotate(360deg);
                        }
                      }

                      @keyframes dash {
                        0% {
                          stroke-dasharray: 1, 300;
                          stroke-dashoffset: 0;
                        }
                        50% {
                          stroke-dasharray: 150, 300;
                          stroke-dashoffset: -200;
                        }
                        100% {
                          stroke-dasharray: 1, 300;
                          stroke-dashoffset: -280;
                        }
                      }
                    </style>
                    <div class="Spinner">
                      <svg
                        viewBox="0 0 100 100"
                      >
                        <circle
                          cx="50"
                          cy="50"
                          r="46"
                          stroke-width="8"
                          fill="none"
                          stroke-miter-limit="10"
                        />
                      </svg>
                    </div>
                    <div>Generating...</div>
                  `)};else{let k;T.code==="ERR_GENERATION_INTERRUPTED"?k="Generation was interrupted...":k=T.message||"Generation failed",f={intrinsicSize:{w:o.width,h:o.height},type:"document",srcdoc:()=>x0(`
                    <style>
                    html, body {
                      height: 100%;
                    }
                      body {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        justify-content: center;
                        color: ${Ye.red[3]};
                      }
                      h1, h3 {
                        margin-top: 0;
                        margin-bottom: 0.5rem;
                      }
                    </style>
                    <h1>Error!</h1>
                    <h3>${k}</h3>
                  `)}}}else f=Zf(q_(o.link||""));const h=((U=this.state.activeEmbeddable)==null?void 0:U.element)===o&&((b=this.state.activeEmbeddable)==null?void 0:b.state)==="active",m=((y=this.state.activeEmbeddable)==null?void 0:y.element)===o&&((w=this.state.activeEmbeddable)==null?void 0:w.state)==="hover";return g("div",{className:le("excalidraw__embeddable-container",{"is-hovered":m}),style:{transform:c?`translate(${a-this.state.offsetLeft}px, ${l-this.state.offsetTop}px) scale(${n})`:"none",display:c?"block":"none",opacity:Xz(o,Cr(o,this.scene.getNonDeletedElementsMap()),this.elementsPendingErasure,null,((v=this.state.openDialog)==null?void 0:v.name)==="elementLinkSelector"?TB:1),"--embeddable-radius":`${ur(Math.min(o.width,o.height),o)}px`},children:N("div",{className:"excalidraw__embeddable-container__inner",style:{width:c?`${o.width}px`:0,height:c?`${o.height}px`:0,transform:c?`rotate(${o.angle}rad)`:"none",pointerEvents:h?Td.enabled:Td.disabled},children:[m&&g("div",{className:"excalidraw__embeddable-hint",children:M("buttons.embeddableInteractionButton")}),g("div",{className:"excalidraw__embeddable__outer",style:{padding:`${o.strokeWidth}px`},children:(or(o)?(C=(I=this.props).renderEmbeddable)==null?void 0:C.call(I,o,this.state):null)??g("iframe",{ref:T=>this.cacheEmbeddableRef(o,T),className:"excalidraw__embeddable",srcDoc:(f==null?void 0:f.type)==="document"?f.srcdoc(this.state.theme):void 0,src:(f==null?void 0:f.type)!=="document"?(f==null?void 0:f.link)??"":void 0,scrolling:"no",referrerPolicy:"no-referrer-when-downgrade",title:"Excalidraw Embedded Content",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,sandbox:`${(_=f==null?void 0:f.sandbox)!=null&&_.allowSameOrigin?"allow-same-origin":""} allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox allow-presentation allow-downloads`})})]})},o.id)})})}toggleOverscrollBehavior(n){document.documentElement.style.overscrollBehaviorX=n.type==="pointerenter"?"none":"auto"}render(){var h,m,p,U,b,y,w,v,I;const n=this.scene.getSelectedElements(this.state),{renderTopRightUI:i,renderTopLeftUI:r,renderCustomStats:s}=this.props,o=this.scene.getSceneNonce(),{elementsMap:a,visibleElements:l}=this.renderer.getRenderableElements({sceneNonce:o,zoom:this.state.zoom,offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,height:this.state.height,width:this.state.width,editingTextElement:this.state.editingTextElement,newElementId:(h=this.state.newElement)==null?void 0:h.id});this.visibleElements=l;const c=this.scene.getNonDeletedElementsMap(),d="setPointerCapture"in HTMLElement.prototype?!1:this.state.selectionElement||this.state.newElement||this.state.selectedElementsAreBeingDragged||this.state.resizingElement||this.state.activeTool.type==="laser"&&this.state.cursorButton==="down",u=n[0],f=((m=Gr.get(Aa))==null?void 0:m.type)==="panel";return g("div",{className:le("excalidraw excalidraw-container",{"excalidraw--view-mode":this.state.viewModeEnabled||((p=this.state.openDialog)==null?void 0:p.name)==="elementLinkSelector","excalidraw--mobile":this.editorInterface.formFactor==="phone"}),style:{"--ui-pointerEvents":d?Td.disabled:Td.enabled,"--right-sidebar-width":"302px"},ref:this.excalidrawContainerRef,onDrop:this.handleAppOnDrop,tabIndex:0,onKeyDown:this.props.handleKeyboardGlobally?void 0:this.onKeyDown,onPointerEnter:this.toggleOverscrollBehavior,onPointerLeave:this.toggleOverscrollBehavior,children:g(OY.Provider,{value:this,children:g(PY.Provider,{value:this.props,children:g(sI.Provider,{value:this.excalidrawContainerValue,children:g(rI.Provider,{value:this.editorInterface,children:g(lI.Provider,{value:this.setAppState,children:g(aI.Provider,{value:this.state,children:N(oI.Provider,{value:this.scene.getNonDeletedElements(),children:[N(cI.Provider,{value:this.actionManager,children:[g(Vve,{canvas:this.canvas,appState:this.state,files:this.files,setAppState:this.setAppState,actionManager:this.actionManager,elements:this.scene.getNonDeletedElements(),onLockToggle:this.toggleLock,onPenModeToggle:this.togglePenMode,onHandToolToggle:this.onHandToolToggle,langCode:vm().code,renderTopLeftUI:r,renderTopRightUI:i,renderCustomStats:s,showExitZenModeBtn:typeof((U=this.props)==null?void 0:U.zenModeEnabled)>"u"&&this.state.zenModeEnabled,UIOptions:this.props.UIOptions,onExportImage:this.onExportImage,renderWelcomeScreen:!this.state.isLoading&&this.state.showWelcomeScreen&&this.state.activeTool.type===this.state.preferredSelectionTool.type&&!this.state.zenModeEnabled&&!this.scene.getElementsIncludingDeleted().length,app:this,isCollaborating:this.props.isCollaborating,generateLinkForSelection:this.props.generateLinkForSelection,children:this.props.children}),g("div",{className:"excalidraw-textEditorContainer"}),g("div",{className:"excalidraw-contextMenuContainer"}),g("div",{className:"excalidraw-eye-dropper-container"}),g(Gve,{trails:[this.laserTrails,this.lassoTrail,this.eraserTrail]}),n.length===1&&((b=this.state.openDialog)==null?void 0:b.name)!=="elementLinkSelector"&&this.state.showHyperlinkPopup&&g(yEe,{element:u,scene:this.scene,setAppState:this.setAppState,onLinkOpen:this.props.onLinkOpen,setToast:this.setToast,updateEmbedValidationStatus:this.updateEmbedValidationStatus},u.id),this.props.aiEnabled!==!1&&n.length===1&&z2(u)&&g(_D,{element:u,elementsMap:a,children:g(X3,{title:M("labels.convertToCode"),icon:O6,checked:!1,onChange:()=>this.onMagicFrameGenerate(u,"button")})}),n.length===1&&Zl(u)&&((w=(y=u.customData)==null?void 0:y.generationData)==null?void 0:w.status)==="done"&&N(_D,{element:u,elementsMap:a,children:[g(X3,{title:M("labels.copySource"),icon:Np,checked:!1,onChange:()=>this.onIframeSrcCopy(u)}),g(X3,{title:"Enter fullscreen",icon:Ffe,checked:!1,onChange:()=>{const C=this.getHTMLIFrameElement(u);if(C)try{C.requestFullscreen(),this.setState({activeEmbeddable:{element:u,state:"active"},selectedElementIds:{[u.id]:!0},newElement:null,selectionElement:null})}catch(_){console.warn(_),this.setState({errorMessage:"Couldn't enter fullscreen"})}}})]}),this.state.toast!==null&&g(Uwe,{message:this.state.toast.message,onClose:this.handleToastClose,duration:this.state.toast.duration,closable:this.state.toast.closable}),this.state.contextMenu&&g(R7e,{items:this.state.contextMenu.items,top:this.state.contextMenu.top,left:this.state.contextMenu.left,actionManager:this.actionManager,onClose:C=>{this.setState({contextMenu:null},()=>{this.focusContainer(),C==null||C()})}}),g(fwe,{canvas:this.canvas,rc:this.rc,elementsMap:a,allElementsMap:c,visibleElements:l,sceneNonce:o,selectionNonce:(v=this.state.selectionElement)==null?void 0:v.versionNonce,scale:window.devicePixelRatio,appState:this.state,renderConfig:{imageCache:this.imageCache,isExporting:!1,renderGrid:Vm(this),canvasBackgroundColor:this.state.viewBackgroundColor,embedsValidationStatus:this.embedsValidationStatus,elementsPendingErasure:this.elementsPendingErasure,pendingFlowchartNodes:this.flowChartCreator.pendingNodes}}),this.state.newElement&&g(mwe,{appState:this.state,scale:window.devicePixelRatio,rc:this.rc,elementsMap:a,allElementsMap:c,renderConfig:{imageCache:this.imageCache,isExporting:!1,renderGrid:!1,canvasBackgroundColor:this.state.viewBackgroundColor,embedsValidationStatus:this.embedsValidationStatus,elementsPendingErasure:this.elementsPendingErasure,pendingFlowchartNodes:null}}),g(cwe,{app:this,containerRef:this.excalidrawContainerRef,canvas:this.interactiveCanvas,elementsMap:a,visibleElements:l,allElementsMap:c,selectedElements:n,sceneNonce:o,selectionNonce:(I=this.state.selectionElement)==null?void 0:I.versionNonce,scale:window.devicePixelRatio,appState:this.state,renderScrollbars:this.props.renderScrollbars===!0,editorInterface:this.editorInterface,renderInteractiveSceneCallback:this.renderInteractiveSceneCallback,handleCanvasRef:this.handleInteractiveCanvasRef,onContextMenu:this.handleCanvasContextMenu,onPointerMove:this.handleCanvasPointerMove,onPointerUp:this.handleCanvasPointerUp,onPointerCancel:this.removePointer,onTouchMove:this.handleTouchMove,onPointerDown:this.handleCanvasPointerDown,onDoubleClick:this.handleCanvasDoubleClick}),this.state.userToFollow&&g(D7e,{width:this.state.width,height:this.state.height,userToFollow:this.state.userToFollow,onDisconnect:this.maybeUnfollowRemoteUser}),this.renderFrameNames(),this.state.activeLockedId&&g(bwe,{app:this,activeLockedId:this.state.activeLockedId}),f&&g(MEe,{app:this})]}),this.renderEmbeddables()]})})})})})})})})}setPlugins(n){Object.assign(this.plugins,n)}async onMagicFrameGenerate(n,i){var a;const r=(a=this.plugins.diagramToCode)==null?void 0:a.generate;if(!r){this.setState({errorMessage:"No diagram to code plugin found"});return}const s=S9(this.scene.getNonDeletedElements(),n).filter(l=>!z2(l));if(!s.length){i==="button"?(this.setState({errorMessage:"Cannot generate from an empty frame"}),et("ai","generate (no-children)","d2c")):this.setActiveTool({type:"magicframe"});return}const o=this.insertIframeElement({sceneX:n.x+n.width+30,sceneY:n.y,width:n.width,height:n.height});if(o){this.updateMagicGeneration({frameElement:o,data:{status:"pending"}}),this.setState({selectedElementIds:{[o.id]:!0}}),et("ai","generate (start)","d2c");try{const{html:l}=await r({frame:n,children:s});if(et("ai","generate (success)","d2c"),!l.trim()){this.updateMagicGeneration({frameElement:o,data:{status:"error",code:"ERR_OAI",message:"Nothing genereated :("}});return}const c=l.includes("<!DOCTYPE html>")&&l.includes("</html>")?l.slice(l.indexOf("<!DOCTYPE html>"),l.indexOf("</html>")+7):l;this.updateMagicGeneration({frameElement:o,data:{status:"done",html:c}})}catch(l){et("ai","generate (failed)","d2c"),this.updateMagicGeneration({frameElement:o,data:{status:"error",code:"ERR_OAI",message:l.message||"Unknown error during generation"}})}}}onIframeSrcCopy(n){var i,r;((r=(i=n.customData)==null?void 0:i.generationData)==null?void 0:r.status)==="done"&&(ud(n.customData.generationData.html),this.setToast({message:"copied to clipboard",closable:!1,duration:1500}))}clearImageShapeCache(n){const i=n??this.files;this.scene.getNonDeletedElements().forEach(r=>{Dn(r)&&i[r.fileId]&&(this.imageCache.delete(r.fileId),qt.delete(r))})}async componentDidMount(){var r;this.unmounted=!1,this.excalidrawContainerValue.container=this.excalidrawContainerRef.current,this.store.onDurableIncrementEmitter.on(s=>{this.history.record(s.delta)});const{onIncrement:n}=this.props;n&&this.store.onStoreIncrementEmitter.on(s=>{n(s)}),this.scene.onUpdate(this.triggerRender),this.addEventListeners(),this.props.autoFocus&&this.excalidrawContainerRef.current&&this.focusContainer(),fB&&this.excalidrawContainerRef.current&&(this.resizeObserver=new ResizeObserver(()=>{this.refreshEditorInterface(),this.updateDOMRect()}),(r=this.resizeObserver)==null||r.observe(this.excalidrawContainerRef.current)),new URLSearchParams(window.location.search.slice(1)).has("web-share-target")?this.restoreFileFromShare():this.updateDOMRect(this.initializeScene),hse()&&!Sae()&&this.setState({errorMessage:g(M7e,{})})}componentWillUnmount(){var n,i;(n=window.launchQueue)==null||n.setConsumer(()=>{}),this.renderer.destroy(),this.scene.destroy(),this.scene=new k6,this.fonts=new nl(this.scene),this.renderer=new wD(this.scene),this.files={},this.imageCache.clear(),(i=this.resizeObserver)==null||i.disconnect(),this.unmounted=!0,this.removeEventListeners(),this.library.destroy(),this.laserTrails.stop(),this.eraserTrail.stop(),this.onChangeEmitter.clear(),this.store.onStoreIncrementEmitter.clear(),this.store.onDurableIncrementEmitter.clear(),qt.destroy(),Ks.destroy(),clearTimeout(zl),Wn.clearCache(),Si.clearCache(),zl=0,document.documentElement.style.overscrollBehaviorX=""}removeEventListeners(){this.onRemoveEventListenersEmitter.trigger()}addEventListeners(){this.removeEventListeners(),this.props.handleKeyboardGlobally&&this.onRemoveEventListenersEmitter.once(en(document,te.KEYDOWN,this.onKeyDown,!1)),this.onRemoveEventListenersEmitter.once(en(this.excalidrawContainerRef.current,te.WHEEL,this.handleWheel,{passive:!1}),en(window,te.MESSAGE,this.onWindowMessage,!1),en(document,te.POINTER_UP,this.removePointer,{passive:!1}),en(document,te.COPY,this.onCopy,{passive:!1}),en(document,te.KEYUP,this.onKeyUp,{passive:!0}),en(document,te.POINTER_MOVE,this.updateCurrentCursorPosition,{passive:!1}),en(document.fonts,"loadingdone",n=>{const i=n.fontfaces;this.fonts.onLoaded(i)},{passive:!1}),en(document,te.GESTURE_START,this.onGestureStart,!1),en(document,te.GESTURE_CHANGE,this.onGestureChange,!1),en(document,te.GESTURE_END,this.onGestureEnd,!1),en(window,te.FOCUS,()=>{this.maybeCleanupAfterMissingPointerUp(null),this.triggerRender(!0)},{passive:!1})),!this.state.viewModeEnabled&&(this.onRemoveEventListenersEmitter.once(en(document,te.FULLSCREENCHANGE,this.onFullscreenChange,{passive:!1}),en(document,te.PASTE,this.pasteFromClipboard,{passive:!1}),en(document,te.CUT,this.onCut,{passive:!1}),en(window,te.RESIZE,this.onResize,!1),en(window,te.UNLOAD,this.onUnload,!1),en(window,te.BLUR,this.onBlur,!1),en(this.excalidrawContainerRef.current,te.WHEEL,this.handleWheel,{passive:!1}),en(this.excalidrawContainerRef.current,te.DRAG_OVER,this.disableEvent,!1),en(this.excalidrawContainerRef.current,te.DROP,this.disableEvent,!1)),this.props.detectScroll&&this.onRemoveEventListenersEmitter.once(en(Qse(this.excalidrawContainerRef.current),te.SCROLL,this.onScroll,{passive:!1})))}componentDidUpdate(n,i){var a,l,c,d,u,f,h,m,p,U,b;this.updateEmbeddables();const r=this.scene.getElementsIncludingDeleted(),s=this.scene.getElementsMapIncludingDeleted();!this.state.showWelcomeScreen&&!r.length&&this.setState({showWelcomeScreen:!0}),i.userToFollow&&!this.state.collaborators.has(i.userToFollow.socketId)&&this.maybeUnfollowRemoteUser(),(i.zoom.value!==this.state.zoom.value||i.scrollX!==this.state.scrollX||i.scrollY!==this.state.scrollY)&&((l=(a=this.props)==null?void 0:a.onScrollChange)==null||l.call(a,this.state.scrollX,this.state.scrollY,this.state.zoom),this.onScrollChangeEmitter.trigger(this.state.scrollX,this.state.scrollY,this.state.zoom)),i.userToFollow!==this.state.userToFollow&&(i.userToFollow&&this.onUserFollowEmitter.trigger({userToFollow:i.userToFollow,action:"UNFOLLOW"}),this.state.userToFollow&&this.onUserFollowEmitter.trigger({userToFollow:this.state.userToFollow,action:"FOLLOW"})),Object.keys(this.state.selectedElementIds).length&&ko(this.state)&&this.setState({activeTool:tn(this.state,{type:"selection"})}),this.state.activeTool.type==="eraser"&&i.theme!==this.state.theme&&hG(this.interactiveCanvas,this.state.theme),i.activeTool.type==="selection"&&this.state.activeTool.type!=="selection"&&this.state.showHyperlinkPopup&&this.setState({showHyperlinkPopup:!1}),n.langCode!==this.props.langCode&&this.updateLanguage(),ko(i)&&!ko(this.state)&&this.eraserTrail.endPath(),n.viewModeEnabled!==this.props.viewModeEnabled&&this.setState({viewModeEnabled:!!this.props.viewModeEnabled}),i.viewModeEnabled!==this.state.viewModeEnabled&&(this.addEventListeners(),this.deselectElements()),(((c=i.openDialog)==null?void 0:c.name)==="elementLinkSelector"||((d=this.state.openDialog)==null?void 0:d.name)==="elementLinkSelector")&&((u=i.openDialog)==null?void 0:u.name)!==((f=this.state.openDialog)==null?void 0:f.name)&&(this.deselectElements(),this.setState({hoveredElementIds:{}})),n.zenModeEnabled!==this.props.zenModeEnabled&&this.setState({zenModeEnabled:!!this.props.zenModeEnabled}),n.theme!==this.props.theme&&this.props.theme&&this.setState({theme:this.props.theme}),(h=this.excalidrawContainerRef.current)==null||h.classList.toggle("theme--dark",this.state.theme===ke.DARK),(m=this.state.selectedLinearElement)!=null&&m.isEditing&&!this.state.selectedElementIds[this.state.selectedLinearElement.elementId]&&setTimeout(()=>{var y;(y=this.state.selectedLinearElement)!=null&&y.isEditing&&this.actionManager.executeAction(Vs)}),(p=this.state.editingTextElement)!=null&&p.isDeleted&&this.setState({editingTextElement:null}),this.state.selectedLinearElement&&!this.state.selectedElementIds[this.state.selectedLinearElement.elementId]&&this.setState({selectedLinearElement:null}),this.store.commit(s,this.state),this.state.isLoading||((b=(U=this.props).onChange)==null||b.call(U,r,this.state,this.files),this.onChangeEmitter.trigger(r,this.state,this.files))}static resetTapTwice(){_1=!1,T1=null}async insertClipboardContent(n,i,r){const{x:s,y:o}=Nt({clientX:this.lastViewportPosition.x,clientY:this.lastViewportPosition.y},this.state);if(n.errorMessage){this.setState({errorMessage:n.errorMessage});return}if(i.length===0&&!r&&n.mixedContent){await this.addElementsFromMixedContentPaste(n.mixedContent,{isPlainPaste:r,sceneX:s,sceneY:o});return}if(n.spreadsheet&&!r){this.setState({pasteDialog:{data:n.spreadsheet,shown:!0}});return}const a=i.map(d=>d.file);if(a.length===0&&n.text&&!r){const d=n.text.trim();d.startsWith("<svg")&&d.endsWith("</svg>")&&a.push(zR(d))}if(a.length>0){this.isToolSupported("image")?await this.insertImages(a,s,o):this.setState({errorMessage:M("errors.imageToolNotSupported")});return}if(n.elements){const d=n.programmaticAPI?Bv(n.elements):n.elements;this.addElementsFromPasteOrLibrary({elements:d,files:n.files||null,position:this.editorInterface.formFactor==="desktop"?"cursor":"center",retainSeed:r});return}if(!n.text)return;if(!r&&v7e(n.text)){const d=await ye(()=>import("./index-DUwR343_.js").then(u=>u.b6),__vite__mapDeps([]));try{const{elements:u,files:f}=await d.parseMermaidToExcalidraw(n.text),h=Bv(u,{regenerateIds:!0});this.addElementsFromPasteOrLibrary({elements:h,files:f,position:this.editorInterface.formFactor==="desktop"?"cursor":"center"});return}catch(u){console.warn(`parsing pasted text as mermaid definition failed: ${u.message}`)}}const l=WB(n.text).split(/\n+/).map(d=>d.trim()).filter(Boolean),c=l.map(d=>Ide(d)).filter(d=>{var u;return G2(d,this.props.validateEmbeddable)&&(/^(http|https):\/\/[^\s/$.?#].[^\s]*$/.test(d)||((u=Zf(d))==null?void 0:u.type)==="video")});if(!r&&c.length>0&&c.length===l.length){const d=[];for(const u of c){const f=d[d.length-1],h=this.insertEmbeddableElement({sceneX:f?f.x+f.width+20:s,sceneY:o,link:ts(u)});h&&d.push(h)}d.length&&(this.store.scheduleCapture(),this.setState({selectedElementIds:Object.fromEntries(d.map(u=>[u.id,!0]))}));return}this.addTextFromPaste(n.text,r)}async addElementsFromMixedContentPaste(n,{isPlainPaste:i,sceneX:r,sceneY:s}){if(!i&&n.some(o=>o.type==="imageUrl")&&this.isToolSupported("image")){const o=n.filter(d=>d.type==="imageUrl").map(d=>d.value),a=await Promise.all(o.map(async d=>{try{return{file:await wye(d)}}catch(u){let f=u.message;return u.cause==="FETCH_ERROR"?f=M("errors.failedToFetchImage"):u.cause==="UNSUPPORTED"&&(f=M("errors.unsupportedFileType")),{errorMessage:f}}})),l=a.filter(d=>!!d.file).map(d=>d.file);await this.insertImages(l,r,s);const c=a.find(d=>!!d.errorMessage);c&&c.errorMessage&&this.setState({errorMessage:c.errorMessage})}else{const o=n.filter(a=>a.type==="text");o.length&&this.addTextFromPaste(o.map(a=>a.value).join(`

`),i)}}addTextFromPaste(n,i=!1){const{x:r,y:s}=Nt({clientX:this.lastViewportPosition.x,clientY:this.lastViewportPosition.y},this.state),o={x:r,y:s,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roundness:null,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,text:n,fontSize:this.state.currentItemFontSize,fontFamily:this.state.currentItemFontFamily,textAlign:Up,verticalAlign:Kb,locked:!1},a=mt({fontSize:o.fontSize,fontFamily:o.fontFamily}),l=zc(o.fontFamily),[c,,d]=eH(this.state),u=Math.max(Math.min((d-c)*.5,800),200),f=10;let h=s;const m=i?[n]:n.split(`
`),p=m.reduce((U,b,y)=>{var v;const w=Gh(b).trim();if(w.length){const I=this.getTopLayerFrameAtSceneCoords({x:r,y:h});let C=jn(w,a,l);const _=C.width>u,T=_?ad(w,a,u):w;C=_?jn(T,a,l):C;const k=r-C.width/2,x=h-C.height/2,D=os({...o,x:k,y:x,text:T,originalText:w,lineHeight:l,autoResize:!_,frameId:I?I.id:null});U.push(D),h+=D.height+f}else((v=m[y-1])==null?void 0:v.trim())&&(h+=Sp(o.fontSize,l)+f);return U},[]);p.length!==0&&(this.scene.insertElements(p),this.store.scheduleCapture(),this.setState({selectedElementIds:xt(Object.fromEntries(p.map(U=>[U.id,!0])),this.state)}),!i&&p.length>1&&nL===!1&&this.editorInterface.formFactor!=="phone"&&(this.setToast({message:M("toast.pasteAsSingleElement",{shortcut:J("CtrlOrCmd+Shift+V")}),duration:5e3}),nL=!0))}handleTextWysiwyg(n,{isExistingElement:i=!1}){const r=this.scene.getElementsMapIncludingDeleted(),s=(o,a)=>{this.scene.replaceAllElements([...this.scene.getElementsIncludingDeleted().map(l=>l.id===n.id&&ge(l)?Ie(l,{originalText:o,isDeleted:a??l.isDeleted,...fH(l,Yn(l,r),r,o)}):l)])};b7e({id:n.id,canvas:this.canvas,getViewportCoords:(o,a)=>{const{x:l,y:c}=Wr({sceneX:o,sceneY:a},this.state);return[l-this.state.offsetLeft,c-this.state.offsetTop]},onChange:an(o=>{s(o,!1),Q4(n)&&fr(n,this.scene)}),onSubmit:an(({viaKeyboard:o,nextOriginalText:a})=>{const l=!a.trim();if(s(a,l),!l&&o){const c=n.containerId?n.containerId:n.id;mi.flushSync(()=>{this.setState(d=>({selectedElementIds:xt({...d.selectedElementIds,[c]:!0},d)}))})}l&&kz(this.scene.getNonDeletedElements(),[n]),(!l||i)&&this.store.scheduleCapture(),mi.flushSync(()=>{this.setState({newElement:null,editingTextElement:null})}),this.state.activeTool.locked&&So(this.interactiveCanvas,this.state),this.focusContainer()}),element:n,excalidrawContainer:this.excalidrawContainerRef.current,app:this,autoSelect:!this.editorInterface.isTouchScreen}),this.deselectElements(),s(n.originalText,!1)}deselectElements(){this.setState({selectedElementIds:xt({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null})}getTextElementAtPosition(n,i){const r=this.getElementAtPosition(n,i,{includeBoundTextElement:!0});return r&&ge(r)&&!r.isDeleted?r:null}getElementAtPosition(n,i,r){let s=[];if(r&&"allHitElements"in r?s=(r==null?void 0:r.allHitElements)||[]:s=this.getElementsAtPosition(n,i,{includeBoundTextElement:r==null?void 0:r.includeBoundTextElement,includeLockedElements:r==null?void 0:r.includeLockedElements}),s.length>1){if(r!=null&&r.preferSelected){for(let a=s.length-1;a>-1;a--)if(this.state.selectedElementIds[s[a].id])return s[a]}const o=s[s.length-1];return Tf({point:S(n,i),element:o,threshold:this.getElementHitThreshold(o)/2,elementsMap:this.scene.getNonDeletedElementsMap(),frameNameBound:we(o)?this.frameNameBoundsCache.get(o):null})?o:s[s.length-2]}return s.length===1?s[0]:null}getElementsAtPosition(n,i,r){const s=[],o=this.scene.getNonDeletedElementsMap();return(r!=null&&r.includeBoundTextElement&&(r!=null&&r.includeLockedElements)?this.scene.getNonDeletedElements():this.scene.getNonDeletedElements().filter(l=>((r==null?void 0:r.includeLockedElements)||!l.locked)&&((r==null?void 0:r.includeBoundTextElement)||!(ge(l)&&l.containerId)))).filter(l=>this.hitElement(n,i,l)).filter(l=>{const c=Cr(l,o);return c&&this.state.frameRendering.enabled&&this.state.frameRendering.clip?iM({x:n,y:i},c,o):!0}).filter(l=>Zl(l)?(s.push(l),!1):!0).concat(s)}getElementHitThreshold(n){return Math.max(n.strokeWidth/2+.1,.85*(yA/this.state.zoom.value))}hitElement(n,i,r,s=!0){return s&&this.state.selectedElementIds[r.id]&&wH([r],this.state,this.editorInterface)&&ay(S(n,i),r,this.scene.getNonDeletedElementsMap(),this.getElementHitThreshold(r))||yz(S(n,i),r,this.scene.getNonDeletedElementsMap())?!0:Tf({point:S(n,i),element:r,threshold:this.getElementHitThreshold(r),elementsMap:this.scene.getNonDeletedElementsMap(),frameNameBound:we(r)?this.frameNameBoundsCache.get(r):null})}getTextBindableContainerAtPosition(n,i){const r=this.scene.getNonDeletedElements(),s=this.scene.getSelectedElements(this.state);if(s.length===1)return eu(s[0],!1)?s[0]:null;let o=null;for(let a=r.length-1;a>=0;--a){if(r[a].isDeleted)continue;const[l,c,d,u]=$e(r[a],this.scene.getNonDeletedElementsMap());if(Ce(r[a])&&Tf({point:S(n,i),element:r[a],elementsMap:this.scene.getNonDeletedElementsMap(),threshold:this.getElementHitThreshold(r[a])})){o=r[a];break}else if(l<n&&n<d&&c<i&&i<u){o=r[a];break}}return eu(o,!1)?o:null}handleHoverSelectedLinearElement(n,i,r){const s=this.scene.getNonDeletedElementsMap(),o=pe.getElement(n.elementId,s);if(o)if(this.state.selectedLinearElement){let a=-1,l=null;Tf({point:S(i,r),element:o,elementsMap:s,threshold:this.getElementHitThreshold(o)})?(a=pe.getPointIndexUnderCursor(o,s,this.state.zoom,i,r),l=pe.getSegmentMidpointHitCoords(n,{x:i,y:r},this.state,this.scene.getNonDeletedElementsMap()),(me(o)?a===0||a===o.points.length-1:a>=0)||l?Lt(this.interactiveCanvas,Ct.POINTER):this.hitElement(i,r,o)&&(!me(o)||!(o.startBinding||o.endBinding))&&(this.state.activeTool.type!=="lasso"||Object.keys(this.state.selectedElementIds).length>0)&&Lt(this.interactiveCanvas,Ct.MOVE)):this.hitElement(i,r,o)&&(!me(o)||!(o.startBinding||o.endBinding))&&(this.state.activeTool.type!=="lasso"||Object.keys(this.state.selectedElementIds).length>0)&&Lt(this.interactiveCanvas,Ct.MOVE),this.state.selectedLinearElement.hoverPointIndex!==a&&this.setState({selectedLinearElement:{...this.state.selectedLinearElement,hoverPointIndex:a}}),pe.arePointsEqual(this.state.selectedLinearElement.segmentMidPointHoveredCoords,l)||this.setState({selectedLinearElement:{...this.state.selectedLinearElement,segmentMidPointHoveredCoords:l}})}else Lt(this.interactiveCanvas,Ct.AUTO)}updateGestureOnPointerDown(n){pt.pointers.set(n.pointerId,{x:n.clientX,y:n.clientY}),pt.pointers.size===2&&(pt.lastCenter=gD(pt.pointers),pt.initialScale=this.state.zoom.value,pt.initialDistance=mD(Array.from(pt.pointers.values())))}initialPointerDownState(n){const i=Nt(n,this.state),r=this.scene.getSelectedElements(this.state),[s,o,a,l]=ht(r),c=r.findIndex(me)===0;return{origin:i,withCmdOrCtrl:n[V.CTRL_OR_CMD],originInGrid:qa(Pn(i.x,i.y,n[V.CTRL_OR_CMD]||c?null:this.getEffectiveGridSize())),scrollbars:xD(S1,n.clientX-this.state.offsetLeft,n.clientY-this.state.offsetTop),lastCoords:{...i},originalElements:this.scene.getNonDeletedElements().reduce((d,u)=>(d.set(u.id,Gc(u)),d),new Map),resize:{handleType:!1,isResizing:!1,offset:{x:0,y:0},arrowDirection:"origin",center:{x:(a+s)/2,y:(l+o)/2}},hit:{element:null,allHitElements:[],wasAddedToSelection:!1,hasBeenDuplicated:!1,hasHitCommonBoundingBoxOfSelectedElements:this.isHittingCommonBoundingBoxOfSelectedElements(i,r)},drag:{hasOccurred:!1,offset:null,origin:{...i},blockDragging:!1},eventListeners:{onMove:null,onUp:null,onKeyUp:null,onKeyDown:null},boxSelection:{hasOccurred:!1}}}handleDraggingScrollBar(n,i){if(!(i.scrollbars.isOverEither&&!this.state.multiElement))return!1;K3=!0,i.lastCoords.x=n.clientX,i.lastCoords.y=n.clientY;const r=N3(o=>{o.target instanceof HTMLElement&&this.handlePointerMoveOverScrollbars(o,i)}),s=an(()=>{vd=null,K3=!1,So(this.interactiveCanvas,this.state),this.setState({cursorButton:"up"}),this.savePointer(n.clientX,n.clientY,"up"),window.removeEventListener(te.POINTER_MOVE,r),window.removeEventListener(te.POINTER_UP,s),r.flush()});return vd=s,window.addEventListener(te.POINTER_MOVE,r),window.addEventListener(te.POINTER_UP,s),!0}isASelectedElement(n){return n!=null&&this.state.selectedElementIds[n.id]}isHittingCommonBoundingBoxOfSelectedElements(n,i){if(i.length<2)return!1;const r=Math.max(yA/this.state.zoom.value,1),[s,o,a,l]=ht(i);return n.x>s-r&&n.x<a+r&&n.y>o-r&&n.y<l+r}getCurrentItemRoundness(n){return this.state.currentItemRoundness==="round"?{type:$u(n)?yn.ADAPTIVE_RADIUS:yn.PROPORTIONAL_RADIUS}:null}maybeCacheReferenceSnapPoints(n,i,r=!1){Zc({event:n,app:this,selectedElements:i})&&(r||!Ks.getReferenceSnapPoints())&&Ks.setReferenceSnapPoints(J3e(this.scene.getNonDeletedElements(),i,this.state,this.scene.getNonDeletedElementsMap()))}maybeCacheVisibleGaps(n,i,r=!1){Zc({event:n,app:this,selectedElements:i})&&(r||!Ks.getVisibleGaps())&&Ks.setVisibleGaps(Q3e(this.scene.getNonDeletedElements(),i,this.state,this.scene.getNonDeletedElementsMap()))}onKeyDownFromPointerDownHandler(n){return an(i=>{this.maybeHandleResize(n,i)||this.maybeDragNewGenericElement(n,i)})}onKeyUpFromPointerDownHandler(n){return an(i=>{i.key===V.ALT&&i.preventDefault(),!this.maybeHandleResize(n,i)&&this.maybeDragNewGenericElement(n,i)})}onPointerMoveFromPointerDownHandler(n){return N3(i=>{var f,h,m,p,U,b,y,w;if(((f=this.state.openDialog)==null?void 0:f.name)==="elementLinkSelector")return;const r=Nt(i,this.state);if(this.state.activeLockedId&&this.setState({activeLockedId:null}),this.state.selectedLinearElement&&this.state.selectedLinearElement.elbowed&&this.state.selectedLinearElement.pointerDownState.segmentMidpoint.index){const[v,I]=Pn(r.x,r.y,i[V.CTRL_OR_CMD]?null:this.getEffectiveGridSize());let C=this.state.selectedLinearElement.pointerDownState.segmentMidpoint.index;if(C<0){const T=pe.getSegmentMidpointHitCoords({...this.state.selectedLinearElement,segmentMidPointHoveredCoords:null},{x:v,y:I},this.state,this.scene.getNonDeletedElementsMap());C=T?pe.getSegmentMidPointIndex(this.state.selectedLinearElement,this.state,T,this.scene.getNonDeletedElementsMap()):-1}const _=pe.moveFixedSegment(this.state.selectedLinearElement,C,v,I,this.scene);this.setState({selectedLinearElement:{...this.state.selectedLinearElement,segmentMidPointHoveredCoords:_.segmentMidPointHoveredCoords,pointerDownState:_.pointerDownState}});return}const s=this.lastPointerMoveCoords??n.origin;if(this.lastPointerMoveCoords=r,n.drag.offset===null&&(n.drag.offset=qa(cde(this.scene.getSelectedElements(this.state),n.origin.x,n.origin.y))),!(i.target instanceof HTMLElement)||this.handlePointerMoveOverScrollbars(i,n))return;if(ko(this.state)){this.handleEraser(i,r);return}this.state.activeTool.type==="laser"&&this.laserTrails.addPointToPath(r.x,r.y);const[a,l]=Pn(r.x,r.y,i[V.CTRL_OR_CMD]?null:this.getEffectiveGridSize());if(!n.drag.hasOccurred&&(this.state.activeTool.type==="arrow"||this.state.activeTool.type==="line")&&ct(S(r.x,r.y),S(n.origin.x,n.origin.y))*this.state.zoom.value<UA)return;if(n.resize.isResizing&&(n.lastCoords.x=r.x,n.lastCoords.y=r.y,this.maybeHandleCrop(n,i)||this.maybeHandleResize(n,i)))return!0;const c=this.scene.getNonDeletedElementsMap();if(this.state.selectedLinearElement){const v=this.state.selectedLinearElement;if(pe.shouldAddMidpoint(this.state.selectedLinearElement,r,this.state,c)){const C=pe.addMidpoint(this.state.selectedLinearElement,r,this,!i[V.CTRL_OR_CMD],this.scene);if(!C)return;mi.flushSync(()=>{this.state.selectedLinearElement&&this.setState({selectedLinearElement:{...this.state.selectedLinearElement,pointerDownState:C.pointerDownState,selectedPointsIndices:C.selectedPointsIndices,segmentMidPointHoveredCoords:null}})});return}else if(v.pointerDownState.segmentMidpoint.value!==null&&!v.pointerDownState.segmentMidpoint.added)return;const I=pe.handlePointDragging(i,this,r.x,r.y,v);if(I){n.lastCoords.x=r.x,n.lastCoords.y=r.y,n.drag.hasOccurred=!0,this.setState(I);return}}const d=n.hit.allHitElements.some(v=>this.isASelectedElement(v)),u=((h=this.state.selectedLinearElement)==null?void 0:h.isEditing)&&i.shiftKey&&this.state.selectedLinearElement.elementId===((m=n.hit.element)==null?void 0:m.id);if((d||n.hit.hasHitCommonBoundingBoxOfSelectedElements)&&!u&&!n.drag.blockDragging){const v=this.scene.getSelectedElements(this.state);if(v.length>0&&v.every(T=>T.locked))return;const I=v.find(T=>we(T)),C=this.getTopLayerFrameAtSceneCoords(r),_=C&&!I?C:null;if(this.state.frameToHighlight!==_&&mi.flushSync(()=>{this.setState({frameToHighlight:_})}),n.drag.hasOccurred=!0,this.state.activeTool.type==="lasso"&&this.lassoTrail.hasCurrentTrail&&!(this.editorInterface.formFactor!=="desktop"&&n.hit.element)&&!this.state.activeTool.fromSelection)return;if(this.state.activeTool.type==="lasso"&&v.length>0&&n.drag.hasOccurred&&!this.state.activeTool.fromSelection&&this.lassoTrail.endPath(),v.length>0&&!n.withCmdOrCtrl&&!this.state.editingTextElement&&((p=this.state.activeEmbeddable)==null?void 0:p.state)!=="active"){const T={x:r.x-n.drag.origin.x,y:r.y-n.drag.origin.y},k=[...n.originalElements.values()],x=i.shiftKey;if(x){const L=Math.abs(T.x),Y=Math.abs(T.y),$=x&&L<Y,H=x&&L>Y;$&&(T.x=0),H&&(T.y=0)}if(this.state.croppingElementId){const L=this.scene.getNonDeletedElementsMap().get(this.state.croppingElementId);if(L&&yt(L)&&L.crop!==null&&n.hit.element===L){const Y=L.crop,$=Dn(L)&&((U=this.imageCache.get(L.fileId))==null?void 0:U.image);if($&&!($ instanceof Promise)){const H=In(pn(r.x-s.x,r.y-s.y),Math.max(this.state.zoom.value,2)),[z,G,j,X,K,ne]=$e(L,c),se=he(Q(S(z,G),S(K,ne),L.angle)),oe=he(Q(S(j,G),S(K,ne),L.angle)),Ee=he(Q(S(z,X),S(K,ne),L.angle)),Re=es(e6(oe,se)),De=es(e6(Ee,se)),vt=pn(w0(H,Re),w0(H,De)),Vt={...Y,x:Ze(Y.x-vt[0]*Math.sign(L.scale[0]),0,$.naturalWidth-Y.width),y:Ze(Y.y-vt[1]*Math.sign(L.scale[1]),0,$.naturalHeight-Y.height)};this.scene.mutateElement(L,{crop:Vt});return}}}this.maybeCacheVisibleGaps(i,v),this.maybeCacheReferenceSnapPoints(i,v);const{snapOffset:D,snapLines:O}=e7e(k,T,this,i,this.scene.getNonDeletedElementsMap());if(this.setState({snapLines:O}),this.state.editingFrame||ade(n,v,T,this.scene,D,i[V.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),this.setState({selectedElementsAreBeingDragged:!0,selectionElement:null}),(v.length!==1||!me(v[0]))&&this.setState({suggestedBindings:V8(v,this.scene.getNonDeletedElementsMap(),this.state.zoom)}),i.altKey&&!n.hit.hasBeenDuplicated){n.hit.hasBeenDuplicated=!0;const L=this.scene.getElementsIncludingDeleted(),Y=n.hit.element,$=this.scene.getSelectedElements({selectedElementIds:this.state.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});Y&&n.hit.wasAddedToSelection&&!$.find(oe=>oe.id===Y.id)&&$.push(Y);const H=new Map($.map(oe=>[oe.id,oe])),{duplicatedElements:z,duplicateElementsMap:G,elementsWithDuplicates:j,origIdToDuplicateId:X}=S0({type:"in-place",elements:L,appState:this.state,randomizeSeed:!0,idsOfElementsToDuplicate:H,overrides:({duplicateElement:oe,origElement:Ee})=>({frameId:oe.frameId??Ee.frameId,seed:Ps()})});z.forEach(oe=>{n.originalElements.set(oe.id,Gc(oe))});const K=j.map(oe=>{if(H.has(oe.id)){const Ee=n.originalElements.get(oe.id);if(Ee)return Ie(oe,{x:Ee.x,y:Ee.y})}return oe}),ne=(y=(b=this.props).onDuplicate)==null?void 0:y.call(b,K,L),se=uo(ne||K,ve(z));mi.flushSync(()=>{if(n.hit.element){const oe=X.get(n.hit.element.id),Ee=oe&&G.get(oe);n.hit.element=Ee||null}n.hit.allHitElements=n.hit.allHitElements.reduce((oe,Ee)=>{const Re=X.get(Ee.id),De=Re&&G.get(Re);return De&&oe.push(De),oe},[]),n.drag.origin=Nt(i,this.state),this.setState(oe=>({...Pz(z,this.scene.getNonDeletedElements(),oe)})),this.scene.replaceAllElements(se),$.forEach(oe=>{var Ee;ss(oe)&&((Ee=oe.boundElements)!=null&&Ee.some(Re=>Re.type==="arrow"))&&fr(oe,this.scene)}),this.maybeCacheVisibleGaps(i,$,!0),this.maybeCacheReferenceSnapPoints(i,$,!0)})}return}}if(this.state.selectionElement){if(n.lastCoords.x=r.x,n.lastCoords.y=r.y,i.altKey){this.setActiveTool({type:"lasso",fromSelection:!0},i.shiftKey),this.lassoTrail.startPath(n.origin.x,n.origin.y,i.shiftKey),this.setAppState({selectionElement:null});return}this.maybeDragNewGenericElement(n,i)}else if(this.state.activeTool.type==="lasso")!i.altKey&&this.state.activeTool.fromSelection?(this.setActiveTool({type:"selection"}),this.createGenericElementOnPointerDown("selection",n),n.lastCoords.x=r.x,n.lastCoords.y=r.y,this.maybeDragNewGenericElement(n,i),this.lassoTrail.endPath()):this.lassoTrail.addPointToPath(r.x,r.y,i.shiftKey);else{const v=this.state.newElement;if(!v)return;if(v.type==="freedraw"){const I=v.points,C=r.x-v.x,_=r.y-v.y,T=I.length>0&&I[I.length-1];if(!(T&&T[0]===C&&T[1]===_)){const x=v.simulatePressure?v.pressures:[...v.pressures,i.pressure];this.scene.mutateElement(v,{points:[...I,S(C,_)],pressures:x},{informMutation:!1,isDragging:!1}),this.setState({newElement:v})}}else if(xe(v)){n.drag.hasOccurred=!0;const I=v.points;let C=a-v.x,_=l-v.y;E0(i)&&I.length===2&&({width:C,height:_}=z4(v.x,v.y,r.x,r.y)),I.length===1?this.scene.mutateElement(v,{points:[...I,S(C,_)]},{informMutation:!1,isDragging:!1}):(I.length===2||I.length>1&&me(v))&&this.scene.mutateElement(v,{points:[...I.slice(0,-1),S(C,_)]},{isDragging:!0,informMutation:!1}),this.setState({newElement:v}),Ga(v,!1)&&this.setState({suggestedBindings:N4(v,[r],this.scene,this.state.zoom,this.state.startBoundElement)})}else n.lastCoords.x=r.x,n.lastCoords.y=r.y,this.maybeDragNewGenericElement(n,i,!1)}if(this.state.activeTool.type==="selection"){n.boxSelection.hasOccurred=!0;const v=this.scene.getNonDeletedElements();if((w=this.state.selectedLinearElement)!=null&&w.isEditing)pe.handleBoxSelection(i,this.state,this.setState.bind(this),this.scene.getNonDeletedElementsMap());else{let I=!0;!i.shiftKey&&Wn(v,this.state)&&(n.withCmdOrCtrl&&n.hit.element?this.setState(_=>Si({..._,selectedElementIds:{[n.hit.element.id]:!0}},this.scene.getNonDeletedElements(),_,this)):I=!1);const C=this.state.selectionElement?E9(v,this.state.selectionElement,this.scene.getNonDeletedElementsMap(),!1):[];this.setState(_=>{const T={...I&&_.selectedElementIds,...C.reduce((k,x)=>(k[x.id]=!0,k),{})};return n.hit.element&&(C.length?delete T[n.hit.element.id]:T[n.hit.element.id]=!0),_=I?_:{..._,selectedGroupIds:{},editingGroupId:null},{...Si({editingGroupId:_.editingGroupId,selectedElementIds:T},this.scene.getNonDeletedElements(),_,this),selectedLinearElement:C.length===1&&xe(C[0])?new pe(C[0],this.scene.getNonDeletedElementsMap()):null,showHyperlinkPopup:C.length===1&&(C[0].link||or(C[0]))?"info":!1}})}}})}handlePointerMoveOverScrollbars(n,i){var r,s;if(i.scrollbars.isOverHorizontal){const o=n.clientX,a=o-i.lastCoords.x;return this.translateCanvas({scrollX:this.state.scrollX-a*(((r=S1.horizontal)==null?void 0:r.deltaMultiplier)||1)/this.state.zoom.value}),i.lastCoords.x=o,!0}if(i.scrollbars.isOverVertical){const o=n.clientY,a=o-i.lastCoords.y;return this.translateCanvas({scrollY:this.state.scrollY-a*(((s=S1.vertical)==null?void 0:s.deltaMultiplier)||1)/this.state.zoom.value}),i.lastCoords.y=o,!0}return!1}onPointerUpFromPointerDownHandler(n){return an(i=>{var y,w,v,I,C,_,T,k,x,D,O,L,Y,$,H,z;this.removePointer(i),n.drag.blockDragging=!1,n.eventListeners.onMove&&n.eventListeners.onMove.flush();const{newElement:r,resizingElement:s,croppingElementId:o,multiElement:a,activeTool:l,isResizing:c,isRotating:d,isCropping:u}=this.state;this.setState(G=>({isResizing:!1,isRotating:!1,isCropping:!1,resizingElement:null,selectionElement:null,frameToHighlight:null,elementsToHighlight:null,cursorButton:"up",snapLines:d1(G.snapLines,[]),originSnapOffset:null})),this.lassoTrail.endPath(),this.lastPointerMoveCoords=null,Ks.setReferenceSnapPoints(null),Ks.setVisibleGaps(null),this.savePointer(i.clientX,i.clientY,"up");const f=n.hit.allHitElements,h=Nt({clientX:i.clientX,clientY:i.clientY},this.state);if(this.state.activeTool.type==="selection"&&!n.boxSelection.hasOccurred&&!n.resize.isResizing&&!f.some(G=>this.state.selectedElementIds[G.id])){const G=this.getElementAtPosition(h.x,h.y,{includeLockedElements:!0});this.store.scheduleCapture(),G!=null&&G.locked?this.setState({activeLockedId:G.groupIds.length>0?G.groupIds.at(-1)||"":G.id}):this.setState({activeLockedId:null})}else this.setState({activeLockedId:null});this.setState({selectedElementsAreBeingDragged:!1});const m=this.scene.getNonDeletedElementsMap();if(n.drag.hasOccurred&&((w=(y=n.hit)==null?void 0:y.element)!=null&&w.id)){const G=m.get(n.hit.element.id);ss(G)&&((v=G.boundElements)==null||v.filter(j=>j.type==="arrow").map(j=>m.get(j.id)).filter(j=>me(j)).forEach(j=>{j&&this.scene.mutateElement(j,{})}))}if((I=this.state.selectedLinearElement)!=null&&I.isEditing)if(!n.boxSelection.hasOccurred&&((_=(C=n.hit)==null?void 0:C.element)==null?void 0:_.id)!==this.state.selectedLinearElement.elementId)this.actionManager.executeAction(Vs);else{const G=pe.handlePointerUp(i,this.state.selectedLinearElement,this.state,this.scene);G!==this.state.selectedLinearElement&&this.setState({selectedLinearElement:G,suggestedBindings:[]})}else if(this.state.selectedLinearElement){if(this.state.selectedLinearElement.elbowed){const G=pe.getElement(this.state.selectedLinearElement.elementId,this.scene.getNonDeletedElementsMap());G&&this.scene.mutateElement(G,{})}((k=(T=n.hit)==null?void 0:T.element)==null?void 0:k.id)!==this.state.selectedLinearElement.elementId?this.scene.getSelectedElements(this.state).length>1&&this.setState({selectedLinearElement:null}):this.state.selectedLinearElement.isDragging&&this.actionManager.executeAction(Vs,"ui",{event:i,sceneCoords:h})}if(this.missingPointerEventCleanupEmitter.clear(),window.removeEventListener(te.POINTER_MOVE,n.eventListeners.onMove),window.removeEventListener(te.POINTER_UP,n.eventListeners.onUp),window.removeEventListener(te.KEYDOWN,n.eventListeners.onKeyDown),window.removeEventListener(te.KEYUP,n.eventListeners.onKeyUp),(D=(x=this.props)==null?void 0:x.onPointerUp)==null||D.call(x,l,n),this.onPointerUpEmitter.trigger(this.state.activeTool,n,i),(r==null?void 0:r.type)==="freedraw"){const G=Nt(i,this.state),j=r.points;let X=G.x-r.x,K=G.y-r.y;X===j[0][0]&&K===j[0][1]&&(K+=1e-4,X+=1e-4);const ne=r.simulatePressure?[]:[...r.pressures,i.pressure];this.scene.mutateElement(r,{points:[...j,S(X,K)],pressures:ne,lastCommittedPoint:S(X,K)}),this.actionManager.executeAction(Vs);return}if(xe(r)){r.points.length>1&&this.store.scheduleCapture();const G=Nt(i,this.state),j=ct(S(G.x,G.y),S(n.origin.x,n.origin.y))*this.state.zoom.value;if((!n.drag.hasOccurred||j<UA)&&r&&!a)if(this.editorInterface.isTouchScreen){const X=Math.min(this.state.width*.7/this.state.zoom.value,100);this.scene.mutateElement(r,{x:r.x-X/2,points:[S(0,0),S(X,0)]},{informMutation:!1,isDragging:!1}),this.actionManager.executeAction(Vs)}else{const X=G.x-r.x,K=G.y-r.y;this.scene.mutateElement(r,{points:[...r.points,S(X,K)]},{informMutation:!1,isDragging:!1}),this.setState({multiElement:r,newElement:r})}else n.drag.hasOccurred&&!a&&(tu(this.state)&&Ga(r,!1)&&this.actionManager.executeAction(Vs,"ui",{event:i,sceneCoords:h}),this.setState({suggestedBindings:[],startBoundElement:null}),l.locked?this.setState(X=>({newElement:null})):(Io(this.interactiveCanvas),this.setState(X=>({newElement:null,activeTool:tn(this.state,{type:this.state.preferredSelectionTool.type}),selectedElementIds:xt({...X.selectedElementIds,[r.id]:!0},X),selectedLinearElement:new pe(r,this.scene.getNonDeletedElementsMap())}))),this.scene.triggerUpdate());return}if(ge(r)){const G=o9(mt({fontSize:r.fontSize,fontFamily:r.fontFamily}),r.lineHeight);r.width<G&&this.scene.mutateElement(r,{autoResize:!0}),this.resetCursor(),this.handleTextWysiwyg(r,{isExistingElement:!0})}if(l.type!=="selection"&&r&&tl(r)){this.updateScene({elements:this.scene.getElementsIncludingDeleted().filter(G=>G.id!==r.id),appState:{newElement:null},captureUpdate:Z.NEVER});return}if(we(r)){const G=Jle(this.scene.getElementsIncludingDeleted(),r,this.scene.getNonDeletedElementsMap());this.scene.replaceAllElements(I0(this.scene.getElementsMapIncludingDeleted(),G,r,this.state))}if(r&&(this.scene.mutateElement(r,tH(r),{informMutation:!1,isDragging:!1}),this.scene.triggerUpdate()),n.drag.hasOccurred){const G=Nt(i,this.state);if(this.state.selectedLinearElement&&this.state.selectedLinearElement.isDragging){const j=this.scene.getElement(this.state.selectedLinearElement.elementId);if(j!=null&&j.frameId){const X=Cr(j,m);X&&j&&(Vc(j,X,this.scene.getNonDeletedElementsMap())||(this.scene.mutateElement(j,{groupIds:[]}),uy([j],this.scene.getNonDeletedElementsMap()),this.scene.triggerUpdate()))}}else{const j=this.getTopLayerFrameAtSceneCoords(G),X=this.scene.getSelectedElements(this.state);let K=this.scene.getElementsMapIncludingDeleted();const ne=se=>{if(se.length>0){for(const oe of se){const Ee=oe.groupIds.indexOf(this.state.editingGroupId);this.scene.mutateElement(oe,{groupIds:oe.groupIds.slice(0,Ee)},{informMutation:!1,isDragging:!1})}K.forEach(oe=>{oe.groupIds.length&&At(K,oe.groupIds[oe.groupIds.length-1]).length<2&&this.scene.mutateElement(oe,{groupIds:[]},{informMutation:!1,isDragging:!1})}),this.setState({editingGroupId:null})}};if(j&&!this.state.selectedElementIds[j.id]){const se=X.filter(oe=>oe.frameId!==j.id&&w6(oe,K,this.state));this.state.editingGroupId&&ne(se),K=I0(K,se,j,this.state)}else if(!j&&this.state.editingGroupId){const se=X.filter(oe=>oe.frameId&&!w6(oe,K,this.state));ne(se)}K=Yh(K,this.state,this),this.scene.replaceAllElements(K)}}if(s&&this.store.scheduleCapture(),s&&tl(s)&&this.updateScene({elements:this.scene.getElementsIncludingDeleted().filter(G=>G.id!==s.id),captureUpdate:Z.NEVER}),n.resize.isResizing){let G=Yh(this.scene.getElementsIncludingDeleted(),this.state,this);const j=this.scene.getSelectedElements(this.state).filter(X=>we(X));for(const X of j)G=Ig(G,jo(this.scene.getElementsIncludingDeleted(),X,this.state,m),X,this);this.scene.replaceAllElements(G)}const p=n.hit.element;((O=this.state.selectedLinearElement)==null?void 0:O.elementId)!==(p==null?void 0:p.id)&&xe(p)&&this.scene.getSelectedElements(this.state).length===1&&this.setState({selectedLinearElement:new pe(p,this.scene.getNonDeletedElementsMap())}),(!o||o&&(!p&&!u||p&&p.id!==o))&&this.finishImageCropping();const U=this.lastPointerDownEvent,b=this.lastPointerUpEvent||this.lastPointerMoveEvent;if(ko(this.state)&&U&&b){if(this.eraserTrail.endPath(),ct(S(U.clientX,U.clientY),S(b.clientX,b.clientY))===0){const j=Nt({clientX:b.clientX,clientY:b.clientY},this.state);this.getElementsAtPosition(j.x,j.y).forEach(K=>this.elementsPendingErasure.add(K.id))}this.eraseElements();return}else this.elementsPendingErasure.size&&this.restoreReadyToEraseElements();if(p&&!n.drag.hasOccurred&&!n.hit.wasAddedToSelection&&(!((L=this.state.selectedLinearElement)!=null&&L.isEditing)||!n.boxSelection.hasOccurred)&&this.state.activeTool.type!=="lasso"&&(i.shiftKey&&!((Y=this.state.selectedLinearElement)!=null&&Y.isEditing)?this.state.selectedElementIds[p.id]?U9(this.state,p)?this.setState(G=>{const j={...G.selectedElementIds};for(const X of p.groupIds.flatMap(K=>At(this.scene.getNonDeletedElements(),K)))delete j[X.id];return{selectedGroupIds:{...G.selectedElementIds,...p.groupIds.map(X=>({[X]:!1})).reduce((X,K)=>({...X,...K}),{})},selectedElementIds:xt(j,G)}}):($=this.state.selectedLinearElement)!=null&&$.isDragging||this.setState(G=>{const j={...G.selectedElementIds};delete j[p.id];const X=Xe(this.scene.getNonDeletedElements(),{selectedElementIds:j});return{...Si({editingGroupId:G.editingGroupId,selectedElementIds:j},this.scene.getNonDeletedElements(),G,this),selectedLinearElement:X.length===1&&xe(X[0])?new pe(X[0],this.scene.getNonDeletedElementsMap()):G.selectedLinearElement}}):p.frameId&&this.state.selectedElementIds[p.frameId]?this.setState(G=>{var X;const j={...G.selectedElementIds,[p.id]:!0};return delete j[p.frameId],(((X=this.scene.getElement(p.frameId))==null?void 0:X.groupIds)??[]).flatMap(K=>At(this.scene.getNonDeletedElements(),K)).forEach(K=>{delete j[K.id]}),{...Si({editingGroupId:G.editingGroupId,selectedElementIds:j},this.scene.getNonDeletedElements(),G,this),showHyperlinkPopup:p.link||or(p)?"info":!1}}):this.setState(G=>({selectedElementIds:xt({...G.selectedElementIds,[p.id]:!0},G)})):this.setState(G=>{var j;return{...Si({editingGroupId:G.editingGroupId,selectedElementIds:{[p.id]:!0}},this.scene.getNonDeletedElements(),G,this),selectedLinearElement:xe(p)&&((j=G.selectedLinearElement)==null?void 0:j.elementId)!==p.id?new pe(p,this.scene.getNonDeletedElementsMap()):G.selectedLinearElement}})),this.state.activeTool.type!=="lasso"&&!(p&&me(p))&&!n.drag.hasOccurred&&!this.state.isResizing&&(p&&Kae({point:S(n.origin.x,n.origin.y),element:p,elementsMap:m,threshold:this.getElementHitThreshold(p),frameNameBound:we(p)?this.frameNameBoundsCache.get(p):null},m)||!p&&n.hit.hasHitCommonBoundingBoxOfSelectedElements)){(H=this.state.selectedLinearElement)!=null&&H.isEditing?this.actionManager.executeAction(l2):this.setState({selectedElementIds:xt({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null}),Lt(this.interactiveCanvas,Ct.AUTO);return}if(!l.locked&&l.type!=="freedraw"&&r&&this.setState(G=>({selectedElementIds:xt({...G.selectedElementIds,[r.id]:!0},G),showHyperlinkPopup:or(r)&&!r.link?"editor":G.showHyperlinkPopup})),(l.type!=="selection"||Wn(this.scene.getNonDeletedElements(),this.state)||!Ki(this.state.previousSelectedElementIds,this.state.selectedElementIds))&&this.store.scheduleCapture(),n.drag.hasOccurred&&!this.state.selectedLinearElement||c||d||u){const G=this.scene.getSelectedElements(this.state).filter(xe);p6(G,tu(this.state),((z=this.state.selectedLinearElement)==null?void 0:z.selectedPointsIndices)??[],this.scene,this.state.zoom)}if(l.type==="laser"){this.laserTrails.endPath();return}!l.locked&&l.type!=="freedraw"&&(l.type!=="lasso"||l.type==="lasso"&&l.fromSelection)?(Io(this.interactiveCanvas),this.setState({newElement:null,suggestedBindings:[],activeTool:tn(this.state,{type:this.state.preferredSelectionTool.type})})):this.setState({newElement:null,suggestedBindings:[]}),p&&this.lastPointerUpEvent&&this.lastPointerDownEvent&&this.lastPointerUpEvent.timeStamp-this.lastPointerDownEvent.timeStamp<300&&pt.pointers.size<=1&&Es(p)&&this.isIframeLikeElementCenter(p,this.lastPointerUpEvent,n.origin.x,n.origin.y)&&this.handleEmbeddableCenterClick(p)})}clearSelection(n){this.setState(i=>({selectedElementIds:xt({},i),activeEmbeddable:null,selectedGroupIds:{},editingGroupId:i.editingGroupId&&n!=null&&pm(n,i.editingGroupId)?i.editingGroupId:null})),this.setState({selectedElementIds:xt({},this.state),activeEmbeddable:null,previousSelectedElementIds:this.state.selectedElementIds})}getTextWysiwygSnappedToCenterPosition(n,i,r,s){if(s){let o=s.x+s.width/2,a=s.y+s.height/2;const l=z8(s,r,this.scene.getNonDeletedElementsMap());if(l&&(o=l.x,a=l.y),Math.hypot(n-o,i-a)<Nre){const{x:u,y:f}=Wr({sceneX:o,sceneY:a},r);return{viewportX:u,viewportY:f,elementCenterX:o,elementCenterY:a}}}}getCanvasOffsets(){var n;if((n=this.excalidrawContainerRef)!=null&&n.current){const i=this.excalidrawContainerRef.current,{left:r,top:s}=i.getBoundingClientRect();return{offsetLeft:r,offsetTop:s}}return{offsetLeft:0,offsetTop:0}}async updateLanguage(){const n=Uy.find(i=>i.code===this.props.langCode)||Xu;await CV(n),this.setAppState({})}}const ywe=e=>{const[t,n]=R.useState(!0);return R.useEffect(()=>{const i=async()=>{await CV(r),n(!1)},r=Uy.find(s=>s.code===e.langCode)||Xu;i()},[e.langCode]),t?g(Tj,{theme:e.theme}):e.children},FY=({children:e})=>{const{FooterCenterTunnel:t}=er(),n=ai();return g(t.In,{children:g("div",{className:le("footer-center zen-mode-transition",{"layer-ui__wrapper__footer-left--transition-bottom":n.zenModeEnabled}),children:e})})};FY.displayName="FooterCenter";const BY=({isCollaborating:e,onSelect:t,editorInterface:n,...i})=>{const r=ai(),s=(n==null?void 0:n.formFactor)!=="desktop"||r.width<cse;return N(Kc,{...i,className:le("collab-button",{active:e}),type:"button",onSelect:t,style:{position:"relative",width:s?void 0:"auto"},title:M("labels.liveCollaboration"),children:[s?q9:M("labels.share"),r.collaborators.size>0&&g("div",{className:"CollabButton-collaborators",children:r.collaborators.size})]})};BY.displayName="LiveCollaborationTrigger";const Ewe=()=>g("svg",{viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"ExcalidrawLogo-icon",children:g("path",{d:"M39.9 32.889a.326.326 0 0 0-.279-.056c-2.094-3.083-4.774-6-7.343-8.833l-.419-.472a.212.212 0 0 0-.056-.139.586.586 0 0 0-.167-.111l-.084-.083-.056-.056c-.084-.167-.28-.278-.475-.167-.782.39-1.507.973-2.206 1.528-.92.722-1.842 1.445-2.708 2.25a8.405 8.405 0 0 0-.977 1.028c-.14.194-.028.361.14.444-.615.611-1.23 1.223-1.843 1.861a.315.315 0 0 0-.084.223c0 .083.056.166.111.194l1.09.833v.028c1.535 1.528 4.244 3.611 7.12 5.861.418.334.865.667 1.284 1 .195.223.39.473.558.695.084.11.28.139.391.055.056.056.14.111.196.167a.398.398 0 0 0 .167.056.255.255 0 0 0 .224-.111.394.394 0 0 0 .055-.167c.029 0 .028.028.056.028a.318.318 0 0 0 .224-.084l5.082-5.528a.309.309 0 0 0 0-.444Zm-14.63-1.917a.485.485 0 0 0 .111.14c.586.5 1.2 1 1.843 1.555l-2.569-1.945-.251-.166c-.056-.028-.112-.084-.168-.111l-.195-.167.056-.056.055-.055.112-.111c.866-.861 2.346-2.306 3.1-3.028-.81.805-2.43 3.167-2.095 3.944Zm8.767 6.89-2.122-1.612a44.713 44.713 0 0 0-2.625-2.5c1.145.861 2.122 1.611 2.262 1.75 1.117.972 1.06.806 1.815 1.445l.921.666a1.06 1.06 0 0 1-.251.25Zm.558.416-.056-.028c.084-.055.168-.111.252-.194l-.196.222ZM1.089 5.75c.055.361.14.722.195 1.056.335 1.833.67 3.5 1.284 4.75l.252.944c.084.361.223.806.363.917 1.424 1.25 3.602 3.11 5.947 4.889a.295.295 0 0 0 .363 0s0 .027.028.027a.254.254 0 0 0 .196.084.318.318 0 0 0 .223-.084c2.988-3.305 5.221-6.027 6.813-8.305.112-.111.14-.278.14-.417.111-.111.195-.25.307-.333.111-.111.111-.306 0-.39l-.028-.027c0-.055-.028-.139-.084-.167-.698-.666-1.2-1.138-1.731-1.638-.922-.862-1.871-1.75-3.881-3.75l-.028-.028c-.028-.028-.056-.056-.112-.056-.558-.194-1.703-.389-3.127-.639C6.087 2.223 3.21 1.723.614.944c0 0-.168 0-.196.028l-.083.084c-.028.027-.056.055-.224.11h.056-.056c.028.167.028.278.084.473 0 .055.112.5.112.555l.782 3.556Zm15.496 3.278-.335-.334c.084.112.196.195.335.334Zm-3.546 4.666-.056.056c0-.028.028-.056.056-.056Zm-2.038-10c.168.167.866.834 1.033.973-.726-.334-2.54-1.167-3.379-1.445.838.167 1.983.334 2.346.472ZM1.424 2.306c.419.722.754 3.222 1.089 5.666-.196-.778-.335-1.555-.503-2.278-.251-1.277-.503-2.416-.838-3.416.056 0 .14 0 .252.028Zm-.168-.584c-.112 0-.223-.028-.307-.028 0-.027 0-.055-.028-.055.14 0 .223.028.335.083Zm-1.089.222c0-.027 0-.027 0 0ZM39.453 1.333c.028-.11-.558-.61-.363-.639.42-.027.42-.666 0-.666-.558.028-1.144.166-1.675.25-.977.194-1.982.389-2.96.61-2.205.473-4.383.973-6.561 1.557-.67.194-1.424.333-2.066.666-.224.111-.196.333-.084.472-.056.028-.084.028-.14.056-.195.028-.363.056-.558.083-.168.028-.252.167-.224.334 0 .027.028.083.028.11-1.173 1.556-2.485 3.195-3.909 4.945-1.396 1.611-2.876 3.306-4.356 5.056-4.719 5.5-10.052 11.75-15.943 17.25a.268.268 0 0 0 0 .389c.028.027.056.055.084.055-.084.084-.168.14-.252.222-.056.056-.084.111-.084.167a.605.605 0 0 0-.111.139c-.112.111-.112.305.028.389.111.11.307.11.39-.028.029-.028.029-.056.056-.056a.44.44 0 0 1 .615 0c.335.362.67.723.977 1.028l-.698-.583c-.112-.111-.307-.083-.39.028-.113.11-.085.305.027.389l7.427 6.194c.056.056.112.056.196.056s.14-.028.195-.084l.168-.166c.028.027.083.027.111.027.084 0 .14-.027.196-.083 10.052-10.055 18.15-17.639 27.42-24.417.083-.055.111-.166.111-.25.112 0 .196-.083.251-.194 1.704-5.194 2.039-9.806 2.15-12.083v-.028c0-.028.028-.056.028-.083.028-.056.028-.084.028-.084a1.626 1.626 0 0 0-.111-1.028ZM21.472 9.5c.446-.5.893-1.028 1.34-1.5-2.876 3.778-7.65 9.583-14.408 16.5 4.607-5.083 9.242-10.333 13.068-15ZM5.193 35.778h.084-.084Zm3.462 3.194c-.027-.028-.027-.028 0-.028v.028Zm4.16-3.583c.224-.25.448-.472.699-.722 0 0 0 .027.028.027-.252.223-.475.445-.726.695Zm1.146-1.111c.14-.14.279-.334.446-.5l.028-.028c1.648-1.694 3.351-3.389 5.082-5.111l.028-.028c.419-.333.921-.694 1.368-1.028a379.003 379.003 0 0 0-6.952 6.695ZM24.794 6.472c-.921 1.195-1.954 2.778-2.82 4.028-2.736 3.944-11.532 13.583-11.727 13.75a1976.983 1976.983 0 0 1-8.042 7.639l-.167.167c-.14-.167-.14-.417.028-.556C14.49 19.861 22.03 10.167 25.074 5.917c-.084.194-.14.36-.28.555Zm4.83 5.695c-1.116-.64-1.646-1.64-1.34-2.611l.084-.334c.028-.083.084-.194.14-.277.307-.5.754-.917 1.257-1.167.027 0 .055 0 .083-.028-.028-.056-.028-.139-.028-.222.028-.167.14-.278.335-.278.335 0 1.369.306 1.76.639.111.083.223.194.335.305.14.167.363.445.474.667.056.028.112.306.196.445.056.222.111.472.084.694-.028.028 0 .194-.028.194a2.668 2.668 0 0 1-.363 1.028c-.028.028-.028.056-.056.084l-.028.027c-.14.223-.335.417-.53.556-.643.444-1.369.583-2.095.389 0 0-.195-.084-.28-.111Zm8.154-.834a39.098 39.098 0 0 1-.893 3.167c0 .028-.028.083 0 .111-.056 0-.084.028-.14.056-2.206 1.61-4.356 3.305-6.506 5.028 1.843-1.64 3.686-3.306 5.613-4.945.558-.5.949-1.139 1.06-1.861l.28-1.667v-.055c.14-.334.67-.195.586.166Z",fill:"currentColor"})}),vwe=()=>N("svg",{viewBox:"0 0 450 55",xmlns:"http://www.w3.org/2000/svg",fill:"none",className:"ExcalidrawLogo-text",children:[g("path",{d:"M429.27 96.74c2.47-1.39 4.78-3.02 6.83-4.95 1.43-1.35 2.73-2.86 3.81-4.51-.66.9-1.4 1.77-2.23 2.59-2.91 2.84-5.72 5.09-8.42 6.87h.01ZM343.6 69.36c.33 3.13.58 6.27.79 9.4.09 1.37.18 2.75.25 4.12-.12-4.46-.27-8.93-.5-13.39-.11-2.08-.24-4.16-.4-6.24-.06 1.79-.11 3.85-.13 6.11h-.01ZM378.47 98.34c.01-.37.07-1.13.01-6.51-.11 1.9-.22 3.81-.31 5.71-.07 1.42-.22 2.91-.16 4.35.39.03.78.07 1.17.1-.92-.85-.76-2.01-.72-3.66l.01.01ZM344.09 86.12c-.09-2.41-.22-4.83-.39-7.24v12.21c.15-.05.32-.09.47-.14.05-1.61-.03-3.23-.09-4.83h.01ZM440.69 66.79c-.22-.34-.45-.67-.69-.99-3.71-4.87-9.91-7.14-15.65-8.55-1.05-.26-2.12-.49-3.18-.71 2.29.59 4.48 1.26 6.64 2.02 7.19 2.54 10.57 5.41 12.88 8.23ZM305.09 72.46l1.2 3.6c.84 2.53 1.67 5.06 2.46 7.61.24.78.5 1.57.73 2.36.22-.04.44-.08.67-.12a776.9 776.9 0 0 1-5.01-13.57c-.02.04-.03.09-.05.13v-.01ZM345.49 90.25v.31c1.48-.42 3.05-.83 4.66-1.2-1.56.25-3.12.52-4.66.89ZM371.02 90.22c0-.57-.04-1.14-.11-1.71-.06-.02-.12-.04-.19-.05-.21-.05-.43-.08-.65-.11.42.16.74.88.95 1.87ZM398.93 54.23c-.13 0-.27-.01-.4-.02l.03.4c.11-.15.23-.27.37-.38ZM401.57 62.28v-.15c-1.22-.24-2.86-.61-3.23-1.25-.09-.15-.18-.51-.27-.98-.09.37-.2.73-.33 1.09 1.24.56 2.52.98 3.83 1.29ZM421.73 88.68c-2.97 1.65-6.28 3.12-9.69 3.68v.18c4.72-.14 11.63-3.85 16.33-8.38-2.04 1.75-4.33 3.24-6.63 4.53l-.01-.01ZM411.28 80.92c-.05-1.2-.09-2.4-.15-3.6-.21 5.66-.46 11.38-.47 14.51.24-.02.48-.04.71-.07.15-3.61.05-7.23-.09-10.83v-.01Z",transform:"translate(-144.023 -51.76)"}),g("path",{d:"M425.38 67.41c-3.5-1.45-7.19-2.57-14.06-3.62.09 1.97.06 4.88-.03 8.12.03.04.06.09.06.15.19 1.36.28 2.73.37 4.1.25 3.77.39 7.55.41 11.33 0 1.38-.01 2.76-.07 4.13 1.4-.25 2.78-.65 4.12-1.15 4.07-1.5 7.94-3.78 11.28-6.54 2.33-1.92 5.13-4.49 5.88-7.58.63-3.53-2.45-6.68-7.97-8.96l.01.02ZM411.35 92.53v-.06l-.34.03c.11.01.22.03.34.03ZM314.26 64.06c-.23-.59-.47-1.17-.7-1.75.57 1.62 1.11 3.25 1.6 4.9l.15.54 2.35 6.05c.32.82.66 1.64.98 2.46-1.38-4.1-2.83-8.17-4.39-12.2h.01ZM156.82 103.07c-.18.13-.38.23-.58.33 1.32-.03 2.66-.2 3.93-.34.86-.09 1.72-.22 2.58-.33-2.12.1-4.12.17-5.94.34h.01ZM210.14 68.88s.03.04.05.07c.18-.31.39-.64.58-.96-.21.3-.42.6-.64.89h.01ZM201.65 82.8c-.5.77-1.02 1.56-1.49 2.37 1.11-1.55 2.21-3.1 3.2-4.59-.23.23-.49.51-.75.79-.32.47-.65.95-.96 1.43ZM194.03 98.66c-.33-.4-.65-.84-1.05-1.17-.24-.2-.07-.49.17-.56-.23-.26-.42-.5-.63-.75 1.51-2.55 3.93-5.87 6.4-9.28-.17-.08-.29-.28-.2-.49.04-.09.09-.17.13-.26-1.21 1.78-2.42 3.55-3.61 5.33-.87 1.31-1.74 2.64-2.54 4-.29.5-.63 1.04-.87 1.61.81.65 1.63 1.27 2.47 1.88-.09-.11-.18-.21-.27-.32v.01ZM307.79 82.93c-1-3.17-2.05-6.32-3.1-9.48-1.62 4.08-3.69 9.17-6.16 15.19 3.32-1.04 6.77-1.87 10.27-2.5-.32-1.08-.67-2.15-1.01-3.21ZM149.5 80.7c.05-1.71.04-3.43 0-5.14-.1 2.26-.16 4.51-.22 6.77-.02.73-.03 1.46-.04 2.19.14-1.27.2-2.55.24-3.82h.02ZM228.98 98.3c.39 1.25.91 3.03.94 3.91.06-.03.12-.07.17-.1.08-1.29-.55-2.65-1.11-3.81ZM307.72 53.36c.81.5 1.53 1.04 2.07 1.49-.38-.8-.78-1.58-1.21-2.35-.17.03-.34.06-.51.11-.43.12-.86.26-1.29.41.35-.01.53.1.94.34ZM283.69 96.14c3.91-7.25 6.89-13.35 8.88-18.15l1.1-2.66c-1.27 2.64-2.56 5.27-3.83 7.9-1.53 3.15-3.06 6.31-4.58 9.47-.87 1.81-1.76 3.62-2.54 5.47.04.02.07.04.11.07.05.05.1.09.15.14.05-.73.27-1.48.71-2.24ZM289.92 103.23s-.04.01-.05.03c0-.02.04-.03.05-.04.05-.05.11-.1.16-.15l.21-.21c-.55 0-1.5-.27-2.55-.72.4.26.8.51 1.22.74.24.13.48.26.73.37.05.02.1.03.14.05a.27.27 0 0 1 .08-.07h.01ZM269.23 68.49c-.39-.19-.82-.48-1.33-.87-3.06-1.56-6.31-2.78-9.36-2.35-3.5.49-5.7 1.11-7.74 2.44 5.71-2.6 12.82-2.07 18.44.79l-.01-.01ZM177.87 53.69l1.06.03c-.96-.22-2-.25-2.89-.3-4.95-.26-9.99.33-14.86 1.19-2.44.43-4.88.95-7.28 1.59 9.09-1.76 15.69-2.77 23.97-2.51ZM219.85 55.51c-.18.12-.36.27-.56.45-.45.53-.86 1.11-1.26 1.66-1.91 2.61-3.71 5.31-5.57 7.95l-.12.18 8.05-10.11c-.18-.05-.36-.1-.55-.13h.01ZM510.71 54.1c.12-.15.29-.3.53-.45.69-.4 3.72-.63 5.87-.74-.36-.02-.73-.04-1.09-.05-1.84-.03-3.67.09-5.49.35.05.3.12.59.18.88v.01ZM510.76 86.02c1.37-3.07 2.49-6.27 3.57-9.46.55-1.64 1.12-3.3 1.6-4.97-1.59 4.01-3.67 9.14-6.2 15.3.24-.08.5-.14.74-.22.1-.22.19-.44.29-.65ZM566.95 75.76c.11-.02.23.03.31.11-.05-.13-.09-.26-.14-.39-.05.09-.11.18-.17.28ZM511.33 86.41c3.08-.89 6.24-1.62 9.46-2.14-1.51-3.98-2.98-7.96-4.39-11.87-.05.15-.09.31-.14.46-1.02 3.32-2.15 6.61-3.39 9.85-.48 1.25-.98 2.49-1.53 3.7h-.01ZM578.24 74.45c.11-.44.23-.87.35-1.31-.31.7-.64 1.39-.97 2.08.09.21.19.4.28.61.12-.46.23-.92.35-1.38h-.01ZM520.62 53.11c-.09 0-.18-.01-.28-.02.38.34.29 1.08.93 2.53l6.65 17.15c2.2 5.68 4.69 11.36 7.41 16.87l1.06 2.17c-2.95-7.05-5.92-14.08-8.87-21.13-1.58-3.79-3.16-7.59-4.7-11.4-.78-1.92-1.73-3.89-2.25-5.91-.03-.1 0-.19.04-.26h.01ZM578.78 77.87c1.45-5.77 3.07-10.43 3.58-13.36.05-.34.16-.88.31-1.55-.67 1.79-1.37 3.56-2.08 5.33-.12.43-.23.86-.35 1.29-.65 2.43-1.29 4.86-1.9 7.3.14.33.29.65.43 1l.01-.01ZM545.3 94.66c.02-.44.03-.83.05-1.12.02-1.01.05-2.02.11-3.02.03-6.66-.46-14.33-1.46-22.8-.13-.42-.27-1.24-.56-2.89 0-.02 0-.04-.01-.06.62 6.61.95 13.25 1.32 19.87.17 3.08.33 6.16.52 9.23.02.25.03.52.04.78l-.01.01ZM580.77 102.81c.13.2.27.38.37.49.27-.11.53-.22.8-.32-.43.09-.82.05-1.17-.16v-.01ZM530.48 104.07h.33c-.36-.13-.71-.32-1.04-.56.14.24.3.47.45.7.06-.08.14-.13.26-.13v-.01ZM542.63 58.82c.06.23.11.47.15.71.14-.33.36-.62.7-.86-.28.05-.57.11-.85.15ZM583.81 57.87c.15-.7.29-1.41.42-2.11-.14.45-.28.9-.42 1.34-.46 1.44-.89 2.89-1.31 4.34.44-1.19.88-2.37 1.31-3.57ZM523.62 91.48c-4.66 1.17-9.05 2.89-14.02 5.27 4.65-1.84 9.48-3.29 14.28-4.63-.09-.22-.17-.41-.26-.64ZM460.64 78.3c-.04-2.9-.11-5.81-.28-8.71-.1-1.68-.17-3.43-.5-5.09-.07.02-.14.03-.2.05.3 6.54.45 12.17.51 17.12.17-.07.34-.14.51-.2 0-1.06-.01-2.11-.03-3.17h-.01ZM470.63 63.24c-3.38-.26-6.81.32-10.1 1.1.41 2.01.47 4.14.57 6.18.18 3.55.25 7.11.27 10.67 3.31-1.38 6.5-3.12 9.3-5.35 1.96-1.56 3.86-3.41 5.02-5.66.73-1.41 1.19-3.22.26-4.65-1.09-1.7-3.46-2.14-5.32-2.29ZM460.29 63.68c1-.24 2.01-.46 3.04-.65-1.15.16-2.37.38-3.71.69v.13c.07-.02.15-.04.22-.05.11-.13.3-.18.45-.11v-.01ZM457.24 100.96c.43-.03.86-.07 1.29-.11.14-.49.27-.99.38-1.49-.44.7-1 1.23-1.67 1.6ZM482.88 104.98c-.18.23-.36.38-.55.47.14.09.27.19.4.28a70.76 70.76 0 0 0 4.37-4.63c.76-.89 1.52-1.81 2.19-2.77-.3-.27-.61-.53-.92-.79-.07 1.94-4.62 6.32-5.49 7.45v-.01Z",transform:"translate(-144.023 -51.76)"}),g("path",{d:"M474.36 63.31c-.4-.16-.84-.27-1.29-.37 1.56.42 3.08 1.22 3.76 2.74.62 1.4.32 2.95-.28 4.32.7-1.22.94-2.34.74-3.47-.24-1.33-1.19-2.54-2.93-3.21v-.01ZM477.34 89.18c-1.2-.81-2.4-1.62-3.6-2.42-.14.1-.26.19-.4.29 1.4.67 2.73 1.39 4 2.13ZM465.88 93.85c.37.25.74.5 1.1.75.46.32.92.65 1.38.97-1.57-1.2-2.01-1.61-2.49-1.72h.01ZM574.92 90.06c-2.28-5.21-4.93-11.13-5.67-12.26-.1-.15-1.57-3.01-1.63-3.08 0 0-.01.02-.02.02.4 1.37 1.09 2.69 1.65 3.99 2.14 4.95 4.36 9.86 6.67 14.73.6 1.26 1.21 2.52 1.83 3.78-.75-2.01-1.64-4.45-2.83-7.18ZM448.73 65.29c.1.2.22.38.34.57.22-.02.43-.06.65-.08v-.08c-.14-.05-.25 0-.99-.41ZM460.16 94.81c-.02.31-.06.59-.1.89-.03 1.71-.33 3.43-.79 5.07.15-.02.3-.03.45-.05.01-.04.02-.08.03-.11.09-.34.15-.69.2-1.03.17-1.07.25-2.16.33-3.24.05-.69.08-1.39.12-2.08-.27.1-.27.26-.24.57v-.02Z",transform:"translate(-144.023 -51.76)"}),g("path",{d:"m328.67 98.12-3.22-6.58c-1.29-2.63-2.53-5.29-3.72-7.97-.25-.85-.52-1.69-.79-2.53-.81-2.57-1.67-5.12-2.55-7.67-1.92-5.53-3.9-11.08-6.32-16.41-.72-1.58-1.46-3.44-2.63-4.79-.03-.17-.16-.29-.34-.36a.282.282 0 0 0-.23-.04c-.06-.01-.12 0-.18.01-.74.06-1.5.38-2.19.61-2.22.77-4.4 1.64-6.63 2.38-.03-.08-.06-.16-.09-.25-.15-.42-.82-.24-.67.19.03.09.07.19.1.28l-.18.06c-.36.11-.28.6 0 .68.18 1.18.63 2.36.98 3.49.03.09.06.17.08.26-.08.23-.17.46-.24.64-.37.98-.79 1.94-1.21 2.9-1.27 2.89-2.62 5.75-3.98 8.6-3.18 6.67-6.44 13.31-9.64 19.97-1.08 2.25-2.2 4.5-3.15 6.81-.13.32.24.5.5.37 1.34 1.33 2.84 2.5 4.4 3.57.65.44 1.31.87 2.01 1.24.4.22.86.48 1.33.5.24.01.35-.19.33-.37.11-.1.21-.21.28-.28.41-.41.81-.84 1.2-1.26.85-.92 1.69-1.87 2.5-2.84 6.31-2.34 12.6-4.31 18.71-5.84 2.14 5.3 3.43 8.43 3.97 9.58.55 1.05 1.15 1.88 1.82 2.52 1.32.56 6.96-.03 9.23-1.96.87-1.28 1.19-2.67.93-4.15-.09-.5-.22-.95-.4-1.33l-.01-.03Zm-20.09-45.61c.43.77.83 1.56 1.21 2.35-.54-.45-1.27-.99-2.07-1.49-.42-.24-.6-.35-.94-.34.43-.15.85-.29 1.29-.41.17-.05.34-.08.51-.11Zm-25.86 45.66c.78-1.85 1.67-3.66 2.54-5.47 1.51-3.16 3.05-6.31 4.58-9.47 1.28-2.63 2.56-5.26 3.83-7.9l-1.1 2.66c-1.99 4.79-4.97 10.9-8.88 18.15-.43.76-.66 1.51-.71 2.24-.05-.05-.1-.09-.15-.14a.259.259 0 0 0-.11-.07Zm6.24 4.71c-.42-.23-.82-.48-1.22-.74 1.05.45 2 .72 2.55.72l-.21.21c-.05.05-.11.1-.16.15-.01.01-.04.03-.05.04 0-.02.03-.02.05-.03a.27.27 0 0 0-.08.07c-.05-.02-.1-.03-.14-.05-.25-.1-.49-.24-.73-.37h-.01Zm15.73-29.43c1.05 3.15 2.1 6.31 3.1 9.48.34 1.06.69 2.13 1.01 3.21-3.5.63-6.95 1.46-10.27 2.5 2.48-6.03 4.54-11.11 6.16-15.19Zm4.79 12.57c-.23-.79-.49-1.58-.73-2.36-.79-2.54-1.63-5.08-2.46-7.61l-1.2-3.6c.02-.04.04-.09.05-.13 1.6 4.45 3.28 9 5.01 13.57l-.67.12v.01Zm5.83-18.27-.15-.54c-.49-1.64-1.03-3.28-1.6-4.9.23.58.47 1.17.7 1.75 1.56 4.03 3.01 8.1 4.39 12.2-.33-.82-.67-1.64-.98-2.46l-2.35-6.05h-.01ZM390.43 79.37c-.13-10.43-.22-17.5-.24-19.97-.24-1.6.21-2.88-.65-3.65-.14-.13-.32-.23-.52-.32h.03c.45 0 .45-.69 0-.7-1.75-.03-3.5-.04-5.25-.14-1.38-.08-2.76-.21-4.15-.31-.07 0-.12.01-.17.04-.21-.07-.47.03-.45.31l.03.45c-.11.14-.19.3-.22.5-.21 1.26-.32 13.67-.36 23.59-.32 5.79-.67 11.57-.97 17.36-.09 1.73-.29 3.54-.21 5.3-.39.02-.38.64.04.69v.12c.05.44.74.45.7 0v-.06c1.1.09 2.2.21 3.3.3 1.14.19 2.44.2 3.29.17 1.73-.05 2.92-.05 3.8-.37.45-.05.9-.11 1.35-.17.44-.06.25-.73-.19-.67h-.01c.24-.32.45-.72.62-1.25.66-1.84.41-6.36.34-11.33l-.13-9.9.02.01Zm-12.26 18.17c.09-1.91.2-3.81.31-5.71.06 5.38 0 6.14-.01 6.51-.05 1.65-.21 2.81.72 3.66-.39-.04-.78-.07-1.17-.1-.06-1.44.09-2.93.16-4.35l-.01-.01ZM588.97 53.85c-2.06-.25-3.17-.51-3.76-.6a.3.3 0 0 1 .04-.08c.22-.39-.39-.75-.6-.35-.56 1.02-.9 2.19-1.26 3.29-.61 1.88-1.17 3.78-1.72 5.68-.63 2.19-1.24 4.39-1.83 6.59-.81 2.03-1.67 4.05-2.61 6.03-1.7-3.64-3.11-6.04-4.03-7.57-2.26-3.74-2.85-5.48-3.57-6.08l.31-.09c.43-.12.25-.8-.19-.67-1.06.3-2.12.6-3.17.95-.93.32-1.85.69-2.76 1.07-.13.05-.19.16-.22.27-.04.02-.08.05-.11.07-.04-.06-.07-.12-.11-.18a.354.354 0 0 0-.48-.12c-.16.09-.22.32-.13.48l.33.54c0 .09.02.18.06.28.51 1.16.78 1.38.72 1.47-2.42 3.44-5.41 7.86-6.2 9.1-1.27 1.97-2.01 3.14-2.45 3.84l-.91-6.56-.43-4.1c-.19-1.85-.37-3.23-.53-4.13-.19-1.1-.3-2.15-.45-3.16-.2-1.36-.29-2.06-.47-2.42h.04c.45.02.45-.68 0-.7-3.43-.16-6.81.94-10.17 1.48-.24-.22-.73-.04-.58.32.24.59.33 1.25.43 1.87.17 1.06.29 2.13.4 3.2.32 3.09.53 6.2.74 9.3.44 6.75.77 13.51 1.17 20.26.11 1.95.13 3.96.46 5.89.05.3.37.31.55.14.74 1.71 2.87 1.27 6.13 1.27 1.34 0 2.39.04 2.99-.11.02.32.48.53.63.18 3.61-8.26 7.41-16.46 12.05-24.2.03-.05.04-.1.05-.15.3.73.64 1.45.94 2.16.97 2.26 1.97 4.52 2.98 6.76 2.26 5.03 4.54 10.07 7.09 14.96.47.9.94 1.79 1.47 2.65.2.32.4.67.66.96-.18.25 0 .68.34.54.91-.38 1.82-.75 2.76-1.07 1.04-.35 2.11-.65 3.17-.95.39-.11.28-.66-.07-.68.62-.4.95-.96.87-1.91-.3-3.34.72-7.47.86-8.52l2.14-11.43c1.75-10.74 3.13-17.51 3.23-20.86.02-.49.08-2.84.13-3.24.17-1.25.48-1-4.96-1.65l.03-.02Zm-46.19 5.67c-.04-.24-.09-.48-.15-.71l.85-.15c-.34.24-.56.53-.7.86Zm1.95 25.12c-.36-6.63-.7-13.26-1.32-19.87 0 .02 0 .04.01.06.29 1.65.44 2.47.56 2.89 1 8.46 1.5 16.14 1.46 22.8-.06.99-.1 2-.11 3.02-.01.29-.03.68-.05 1.12-.01-.26-.03-.53-.04-.78-.19-3.08-.35-6.16-.52-9.23l.01-.01Zm36.4 18.66c-.11-.11-.24-.29-.37-.49.35.21.74.26 1.17.16-.27.11-.53.22-.8.32v.01Zm-.89-33.72c.12-.43.23-.86.35-1.29.71-1.77 1.41-3.55 2.08-5.33-.15.68-.26 1.22-.31 1.55-.5 2.94-2.13 7.59-3.58 13.36-.15-.35-.29-.66-.43-1 .61-2.44 1.25-4.87 1.9-7.3l-.01.01Zm3.56-12.48c.14-.44.28-.89.42-1.34-.13.7-.27 1.41-.42 2.11-.43 1.19-.86 2.38-1.31 3.57.42-1.45.85-2.9 1.31-4.34Zm-5.22 16.05c-.11.44-.23.87-.35 1.31-.12.46-.23.92-.35 1.38-.1-.22-.19-.4-.28-.61.34-.69.66-1.38.97-2.08h.01Zm-11.64 2.62c.06-.1.12-.19.17-.28.05.13.09.26.14.39a.398.398 0 0 0-.31-.11Zm2.3 2.98c-.56-1.3-1.25-2.63-1.65-3.99 0 0 .01-.02.02-.02.06.08 1.52 2.93 1.63 3.08.73 1.13 3.38 7.04 5.67 12.26 1.2 2.73 2.08 5.17 2.83 7.18-.62-1.25-1.23-2.51-1.83-3.78-2.31-4.87-4.53-9.78-6.67-14.73ZM275.92 87.03c-1.06-2.18-1.13-3.45-2.44-2.93-1.52.57-2.94 1.3-4.5 2.1-1.4.72-2.68 1.44-3.92 2.12.01-.25-.24-.5-.51-.34-4.8 2.93-12.41 4.7-17.28 1.31-1.98-1.77-3.32-4.15-3.97-5.78-.29-.95-.49-1.94-.63-2.93-.14-3.34 1.58-6.53 3.9-9.12.8-.79 1.68-1.51 2.66-2.12 3.7-2.3 8.22-3.07 12.51-2.51 2.71.35 5.32 1.24 7.71 2.55.39.22.75-.39.35-.6-.18-.1-.37-.18-.55-.27.56.27 1.03.33 1.51.19l-.48.39c-.15.11-.23.3-.13.48.09.15.33.24.48.13 1.3-.97 2.46-2.09 3.45-3.37.37-.29.64-.6.65-.97v-.02c.08-.33-.03-.7-.21-1.08-.31-.87-.98-2.01-2.19-3.26-2.43-2.52-3.79-3.45-5.68-4.26-1.14-.49-3.12-1.06-4.42-1.23-3.28-.42-10.64-1.21-18.18 4.11-7.74 5.46-11.94 12.3-12.23 20.61-.08 2.06.04 3.98.34 5.71.74 4.18 2.57 8 5.44 11.34 4.26 4.99 9.76 7.52 16.34 7.52 4.85 0 9.69-1.77 14.89-4.62.23-.12.45-.23.68-.35 2.19-1.1 4.37-2.23 6.46-3.5.49-.3 1.03-.61 1.5-.98 1.47-.87 1.11-1.12.49-2.95-.39-1.14-.76-2.7-2.06-5.36l.02-.01Zm-17.38-21.76c3.05-.42 6.31.79 9.36 2.35.51.39.94.68 1.33.87-5.61-2.86-12.72-3.39-18.44-.79 2.05-1.33 4.24-1.95 7.74-2.44l.01.01ZM443.67 72.67c-.4-2.2-1.15-4.33-2.37-6.22-1.49-2.32-3.58-4.19-5.91-5.64-6.17-3.81-13.75-5.11-20.83-6.01-3.23-.41-6.47-.69-9.72-.92l-1.39-.12c-.85-.07-1.52-.1-2.05-.1-1.08-.06-2.17-.12-3.25-.17-.08 0-.14.02-.19.05-.1.05-.18.14-.16.3.27 2.55-.01 5.12-.92 7.52-.15.38.4.56.62.28 1.32.59 2.68 1.05 4.08 1.37 0 2.78-.14 7.58-.33 12.91 0 0 0 .02-.01.03-.61 3.66-.79 7.42-1 11.12-.23 4.01-.43 8.03-.44 12.05 0 .64 0 1.28.03 1.93.02.31 0 .68.15.96.06.11.14.16.24.17-.2.17-.21.54.11.59 3.83.67 7.78.71 11.68.25 2.3-.19 4.87-.65 7.65-1.56 1.85-.54 3.67-1.18 5.43-1.91 7.2-3.02 14.31-8.07 17.35-15.53.76-1.86 1.17-3.8 1.31-5.75.3-1.93.28-3.82-.09-5.58l.01-.02Zm-19.32-15.42c5.74 1.41 11.94 3.68 15.65 8.55.25.32.47.65.69.99-2.3-2.82-5.68-5.69-12.88-8.23-2.16-.76-4.35-1.43-6.64-2.02 1.06.21 2.13.45 3.18.71Zm-25.82-3.04c.13 0 .27.01.4.02-.14.1-.26.23-.37.38 0-.13-.02-.26-.03-.4Zm34.82 22.17c-.75 3.09-3.55 5.66-5.88 7.58-3.35 2.76-7.21 5.03-11.28 6.54-1.33.49-2.71.9-4.12 1.15.06-1.38.08-2.76.07-4.13-.02-3.78-.16-7.56-.41-11.33-.09-1.37-.18-2.74-.37-4.1 0-.06-.03-.11-.06-.15.09-3.25.12-6.16.03-8.12 6.86 1.05 10.56 2.17 14.06 3.62 5.52 2.28 8.59 5.44 7.97 8.96l-.01-.02Zm-22 16.15c-.12 0-.23-.02-.34-.03l.34-.03v.06Zm-.69-.7c0-3.13.26-8.84.47-14.51.06 1.2.11 2.41.15 3.6.15 3.6.25 7.23.09 10.83-.24.03-.48.05-.71.07v.01Zm-12.33-30.94c.37.63 2.01 1.01 3.23 1.25v.15c-1.31-.31-2.59-.73-3.83-1.29.12-.36.23-.72.33-1.09.08.48.18.84.27.98Zm13.7 31.65v-.18c3.41-.56 6.71-2.02 9.69-3.68 2.31-1.28 4.59-2.78 6.63-4.53-4.69 4.53-11.61 8.24-16.33 8.38l.01.01Zm24.07-.75c-2.05 1.93-4.37 3.56-6.83 4.95 2.7-1.78 5.52-4.03 8.42-6.87.82-.82 1.56-1.69 2.23-2.59-1.08 1.65-2.38 3.16-3.81 4.51h-.01ZM187.16 92.14c-.79-2.47-2.1-7.12-3.1-6.87-.19-.01-2.09.77-4.08 1.54-3.06 1.18-5.91 2.13-10.09 2.82-2.74.42-5.87 1.01-10.61 1.06.04-3.34.05-6.01.05-7.99 7.97-.65 12.33-2.11 16.37-3.55 1.11-.39 2.69-1.01 2.63-1.8-.08-.35-.55-1.39-1.17-2.61-.47-1.16-.98-2.31-1.61-3.38-.42-.71-1.04-1.69-1.86-2.06-.11-.08-.22-.13-.29-.12-.02 0-.04 0-.07.01-.19-.04-.39-.05-.6-.01-.17.03-.24.15-.25.28-.04.02-.09.04-.14.05-4.33 1.48-8.85 2.33-13.24 3.61a499.1 499.1 0 0 0-.31-8.19c4.51-.99 8.88-1.38 13.11-1.82 3.68-.38 6.28.12 7.47.34.59.11.9.16 1.16.18h.1c-.1.37.44.66.62.28.02-.04.03-.08.05-.13.15.2.53.22.62-.1.17-.58.19-1.21.21-1.81v-.36c.03-.15.05-.3.07-.45.52-2.47.33-5.09-.64-7.44-.11-.27-.44-.28-.6-.14-.08-.21-.15-.42-.24-.62-.19-.41-.79-.05-.6.35.03.07.05.15.09.22-.98-.42-2.15-.54-3.17-.63-2.17-.19-4.37-.14-6.54 0-5.7.35-11.4 1.3-16.91 2.79-2.08.56-4.13 1.22-6.14 2-4.54 1.05-3.79 1.51-2.17 6.07.18.51.46 1.68.54 1.94.82 2.47 1.08 2.13 3.1 2.13s0 .05 0 .08h.52c-.48 2.66-.51 5.45-.62 8.13-.15 3.48-.22 6.96-.28 10.45 0 .41-.01.82-.02 1.23-.16.29-.33.57-.51.85-.05.38-.09.77-.14 1.18-.42 3.52-.59 6.48-.52 8.8v.34c.02.47.05.76.06.87.16 1.57-.26 3.47 1.35 3.79 1.61.32 3.5.55 4.85.55.11 0 .22-.02.33-.02 1.79.24 3.67.05 5.45-.12 2.85-.28 5.69-.7 8.51-1.19 3.03-.53 6.05-1.14 9.04-1.86 2.4-.58 4.82-1.19 7.13-2.06.51-.19 1.73-.57 2.46-1.14 1.81-.68 2.18-1 1.57-2.67-.23-.62-.48-1.49-.91-2.78l-.03-.02Zm-11.12-38.71c.89.05 1.93.08 2.89.3-.33 0-.68-.02-1.06-.03-8.28-.26-14.88.75-23.97 2.51 2.41-.64 4.85-1.16 7.28-1.59 4.87-.86 9.91-1.45 14.86-1.19Zm-26.53 22.13c.03 1.71.04 3.43 0 5.14-.04 1.27-.11 2.55-.24 3.82 0-.73.02-1.46.04-2.19.05-2.26.12-4.51.22-6.77h-.02Zm6.73 27.85c.2-.1.4-.21.58-.33 1.82-.17 3.82-.24 5.94-.34-.86.11-1.72.24-2.58.33-1.27.14-2.61.31-3.93.34h-.01ZM534.48 85.44c-3.52-8.38-7.07-16.75-10.5-25.17-.63-1.54-1.25-3.09-1.86-4.65-.31-.8-.65-1.6-.87-2.43-.04-.17-.17-.24-.31-.25.1-.2 0-.51-.29-.53-1.59-.08-3.18-.22-4.78-.25-1.96-.03-3.91.13-5.84.42-.31.05-.31.38-.13.56-.03.06-.05.14-.04.22.23 1.54.63 3.06 1.16 4.53.13.35.27.7.41 1.06l-2.68 6.18c-.11.03-.2.09-.25.22-.67 1.9-1.52 3.73-2.34 5.56a536.85 536.85 0 0 1-3.9 8.45c-2.64 5.64-5.34 11.25-7.91 16.93-.44.97-.88 1.94-1.29 2.93-.2.48-.47 1-.55 1.52v.05c-.02.12.02.26.16.34 1.19.73 2.41 1.41 3.66 2.05 1.2.62 2.45 1.25 3.76 1.61.43.12.62-.55.19-.67-1.13-.31-2.2-.83-3.24-1.36 1.09.36 2.1.69 2.75.93 2.82 1.01 2.38 1.1 4.3-3.75 2.1-1.09 4.34-1.96 6.53-2.79 4.35-1.64 8.8-3.03 13.27-4.29.82 2.01 1.77 3.97 2.72 5.92.35.83.62 1.45.79 1.82.22.42.45.8.69 1.15.17.33.33.67.5 1 .42.8.84 1.63 1.4 2.35.23.29.6 0 .55-.31 1.53-.02 3.06-.07 4.58-.27.92-.12 1.82-.32 2.71-.54 1.39-.27 3.85-1.11 3.74-1.42-.67-1.96-1.55-3.87-2.34-5.78-1.57-3.78-3.16-7.56-4.75-11.33v-.01Zm-11.65-26.16c1.54 3.81 3.12 7.6 4.7 11.4 2.94 7.05 5.91 14.09 8.87 21.13l-1.06-2.17c-2.71-5.51-5.2-11.19-7.41-16.87l-6.65-17.15c-.65-1.45-.55-2.19-.93-2.53.09 0 .18.01.28.02a.29.29 0 0 0-.04.26c.52 2.02 1.47 3.98 2.25 5.91h-.01Zm-6.58 13.58c.05-.15.09-.31.14-.46 1.41 3.92 2.88 7.9 4.39 11.87-3.22.52-6.38 1.25-9.46 2.14.55-1.22 1.05-2.46 1.53-3.7 1.24-3.24 2.37-6.53 3.39-9.85h.01Zm-.23-20c.36 0 .73.03 1.09.05-2.15.1-5.18.33-5.87.74-.24.15-.41.3-.53.45-.06-.29-.13-.58-.18-.88 1.82-.26 3.65-.39 5.49-.35v-.01Zm-.09 18.72c-.49 1.67-1.05 3.33-1.6 4.97-1.07 3.19-2.19 6.38-3.57 9.46-.09.21-.19.43-.29.65-.25.07-.5.14-.74.22 2.53-6.16 4.61-11.29 6.2-15.3Zm-6.34 25.16c4.97-2.38 9.37-4.1 14.02-5.27l.26.64c-4.8 1.35-9.63 2.8-14.28 4.63Zm20.17 6.76c.33.23.68.42 1.04.56h-.33c-.12 0-.21.06-.26.13-.15-.23-.31-.45-.45-.7v.01ZM226.57 91.75c-3.55-4.74-6.68-9.11-9.31-12.99 9.2-15.25 10.05-17.81 10.35-18.38.17-.34 1.09-2.27.64-2.53-1.13-.65-1.03-.65-2.97-1.71-1.19-.65-3.04-1.61-4.53-2.12-1.71-.59-1.24-.36-3 2.77-.06.1-.11.2-.17.3-.75 1.02-1.48 2.05-2.2 3.09-1.88 2.71-3.73 5.45-5.69 8.1-3.68-4.91-6.88-8.76-9.51-11.43-.15-.15-.3-.29-.46-.42-1.27-1.28-7.24 3.53-7.93 5.58-.09.09-.19.16-.28.25-.27.26.03.64.33.58.19.65.5 1.29.94 1.91 3.85 5.06 7.19 9.76 9.94 14-1.23 2.61-3.06 5-4.67 7.38l-2.28 3.33c-.5.66-.93 1.23-1.29 1.69-.67.93-2.09 2.61-2.3 3.87-.51.85-1.16 1.84-1.29 2.83-.06.44.61.63.67.19.01-.08.04-.15.06-.22 1.36 1.08 2.76 2.11 4.19 3.11 1.3.91 2.62 1.85 4.04 2.56.21.1.4 0 .48-.17.24.07.48.14.72.2.44.1.62-.57.19-.67-2.02-.48-3.77-1.57-5.23-3.02-.47-.46-.9-.96-1.32-1.46 1.74 1.35 4.2 2.89 5.89 4.14 1.39 1.03 2.85-2.27 4.22-4.2 1.86-2.64 3.96-5.86 5.52-8.29l10.39 14.51c.67.81 1.14 1.21 1.57 1.36-.05.24.12.51.41.4 1.53-.58 3.05-1.19 4.54-1.87 1.52-.69 3.06-1.45 4.36-2.5a.28.28 0 0 0 .12-.23c1.66-1.1.81-1.74-1.41-4.91-1.13-1.58-1.71-2.36-3.7-5.01l-.03-.02Zm2.41 6.54c.56 1.15 1.19 2.52 1.11 3.81-.06.04-.12.07-.17.1-.03-.88-.55-2.66-.94-3.91Zm-16.51-32.73c1.86-2.65 3.65-5.35 5.57-7.95.4-.55.81-1.13 1.26-1.66.19-.18.38-.33.56-.45.18.03.36.08.55.13l-8.05 10.11.12-.18h-.01ZM192.7 95.48c.79-1.37 1.66-2.69 2.54-4 1.19-1.79 2.4-3.56 3.61-5.33-.04.09-.09.17-.13.26-.1.22.03.41.2.49-2.47 3.42-4.89 6.73-6.4 9.28.21.24.4.48.63.75-.24.07-.4.36-.17.56.4.33.72.77 1.05 1.17.09.11.18.21.27.32-.84-.61-1.66-1.24-2.47-1.88.24-.57.58-1.11.87-1.61v-.01Zm7.46-10.32c.47-.81.98-1.59 1.49-2.37.31-.48.64-.95.96-1.43.26-.29.52-.56.75-.79-.99 1.48-2.09 3.03-3.2 4.59Zm10.03-16.22s-.03-.05-.05-.07c.22-.29.43-.59.64-.89-.2.32-.4.65-.58.96h-.01ZM371.54 87.96c-.01-.08-.01-.16-.03-.23-.06-.38-.58-.29-.66.03-.3-.05-.6-.08-.81-.11-1.14-.15-2.29-.19-3.44-.2 1.04-.09 2.09-.18 3.14-.23.45-.02.45-.72 0-.7-6.57.35-13.14 1.23-19.65 2.11-1.53.21-3.05.42-4.57.68-.01 0-.02.01-.04.01-.04-3.33-.13-6.66-.24-9.99-.19-5.7-.4-11.41-.88-17.1-.13-1.51-.23-3.07-.49-4.58 0-.25 0-.48-.02-.68-.06-1.19-.04-2.61-.68-2.78-.16-.07-.72-.16-1.5-.24.22-.17.16-.62-.2-.63-1.19-.04-2.39.09-3.57.23-1.2.14-2.41.32-3.59.6-.16-.1-.41-.06-.5.12-.06.02-.13.03-.19.05-.35.1-.29.55-.03.66-.26.6-.19 2.27-.21 3-.02.66-.66 33.73-.9 40.3-.03.65.06 1.12.04 1.45-.16 3.05.87 4.96 6.34 3.93 1.09-.08 2.75-.77 5.36-1.43 4.13-1.04 5.78-1.52 6.2-1.65 6.43-1.69 6.78-1.97 11.72-2.43.55-.05 4.8-.38 6.03-.3.64.04 1.19.07 1.65.1.09 0 .16-.03.24-.05.1.27.56.33.66-.02.39-1.32.61-2.71.78-4.08.2-1.61.29-3.24.15-4.86.24.03.52-.23.38-.53-.09-.2-.27-.33-.49-.43v-.02Zm-.63.56c.07.57.11 1.14.11 1.71-.21-.99-.53-1.71-.95-1.87.22.03.44.06.65.11.06.01.12.04.19.05Zm-25.41 1.73c1.54-.36 3.1-.64 4.66-.89-1.61.37-3.18.77-4.66 1.2v-.31Zm-.86-7.37c-.07-1.37-.16-2.75-.25-4.12-.21-3.13-.45-6.27-.79-9.4.02-2.25.08-4.31.13-6.11.16 2.08.29 4.16.4 6.24.23 4.46.38 8.93.5 13.39h.01Zm-.94-4c.16 2.41.29 4.83.39 7.24.06 1.6.14 3.22.09 4.83-.15.05-.32.09-.47.14V78.88h-.01ZM483.72 92.83c-3.05-2.28-6.22-4.4-9.38-6.51 8.86-6.49 13.49-12.95 13.73-19.23.04-.76 0-1.5-.13-2.2-.67-3.82-3.5-6.68-8.39-8.48.13.04.27.08.4.13 3.92 1.39 7.74 4.23 8.5 8.56.34 1.95-.05 3.96-.98 5.69-.21.4.39.75.6.35 1.86-3.46 1.46-7.55-.97-10.63-3.53-4.47-9.76-5.88-15.16-6.16-2.32-.12-4.64-.04-6.95.19-6 .32-12.71 1.68-17.63 3.21-.37.11-.67.23-.92.35-.2-.17-.62.02-.57.37v.03c-.64.68-.18 1.64.48 3.21.38.91.67 1.89 1.15 2.58.32.76.68 1.51 1.13 2.19.14.21.38.19.53.07.19-.02.38-.05.57-.08v1.57c-.06.06-.1.13-.11.23-.27 4.18-.34 8.38-.48 12.57l-.3 9.03c-.24 3.91-.44 6.77-.46 7.26-.05.88-.11 1.95.07 2.81-.01.22-.02.43-.04.65 0 .11-.02.23-.03.35 0 .05-.03.27-.01.16-.05.4.5.59.64.28.05.04.12.08.2.08 1.75.13 3.5.28 5.25.3 1.69.02 3.38-.12 5.06-.32.08.23.36.39.55.15.06-.08.11-.17.16-.26.18-.09.24-.32.18-.48.05-.2.1-.4.13-.6.16-.86.25-1.74.33-2.62.11-1.17.17-2.34.23-3.51.15-.01.32-.03.52-.04.36-.03 1.73-.15 2.06-.15.39 0 .7-.02.95-.04 1.76 1.11 3.45 2.35 5.14 3.55 2.83 2.01 5.64 4.04 8.47 6.04 1.42 1 2.85 2 4.29 2.97.1.06.19.07.27.04.08 0 .17-.02.25-.1 1.61-1.56 3.15-3.18 4.6-4.88.75-.88 1.49-1.78 2.15-2.73.01.01.03.02.04.03.34.3.83-.2.49-.49-2.16-1.9-4.34-3.76-6.64-5.48l.03-.01Zm-6.38-3.65a55.72 55.72 0 0 0-4-2.13c.14-.1.26-.19.4-.29 1.2.81 2.4 1.61 3.6 2.42Zm-20.1 11.78c.67-.37 1.23-.91 1.67-1.6-.11.5-.24 1-.38 1.49-.43.04-.86.08-1.29.11Zm2.38-37.24c1.34-.31 2.56-.52 3.71-.69-1.03.19-2.04.41-3.04.65-.14-.07-.34-.02-.45.11-.07.02-.15.04-.22.05v-.13.01Zm.04.84c.07-.02.14-.03.2-.05.34 1.66.41 3.41.5 5.09.17 2.9.24 5.81.28 8.71l.03 3.17c-.17.07-.34.14-.51.2-.06-4.96-.21-10.58-.51-17.12h.01Zm16.04 5.62c-1.16 2.25-3.06 4.1-5.02 5.66-2.8 2.23-5.99 3.97-9.3 5.35-.01-3.56-.09-7.12-.27-10.67-.1-2.04-.16-4.16-.57-6.18 3.3-.78 6.72-1.36 10.1-1.1 1.85.14 4.23.59 5.32 2.29.92 1.43.46 3.24-.26 4.65Zm.85-.18c.6-1.37.9-2.92.28-4.32-.67-1.52-2.2-2.32-3.76-2.74.46.1.89.21 1.29.37 1.74.67 2.69 1.88 2.93 3.21.2 1.13-.05 2.25-.74 3.47V70Zm-27.47-4.14c-.12-.19-.23-.38-.34-.57.74.42.85.36.99.41v.08c-.22.03-.43.06-.65.08Zm11.21 30.46c-.08 1.08-.16 2.17-.33 3.24-.05.35-.11.69-.2 1.03 0 .04-.02.07-.03.11-.15.02-.3.04-.45.05.45-1.64.76-3.36.79-5.07.03-.29.08-.57.1-.89-.03-.31-.03-.47.24-.57-.04.69-.07 1.39-.12 2.08v.02Zm5.6-2.47c.48.11.92.52 2.49 1.72-.46-.32-.92-.65-1.38-.97-.37-.25-.73-.5-1.1-.75h-.01Zm21.23 7.24a70.76 70.76 0 0 1-4.37 4.63c-.14-.09-.27-.19-.4-.28.19-.09.37-.24.55-.47.87-1.14 5.43-5.51 5.49-7.45.31.26.62.53.92.79-.67.97-1.42 1.88-2.19 2.77v.01Z",fill:"currentColor",transform:"translate(-144.023 -51.76)"})]}),zY=({style:e,size:t="small",withText:n})=>N("div",{className:`ExcalidrawLogo is-${t}`,style:e,children:[g(Ewe,{}),n&&g(vwe,{})]}),uI=({icon:e,shortcut:t,children:n})=>{const i=Nn();return N(fe,{children:[g("div",{className:"welcome-screen-menu-item__icon",children:e}),g("div",{className:"welcome-screen-menu-item__text",children:n}),t&&i.formFactor!=="phone"&&g("div",{className:"welcome-screen-menu-item__shortcut",children:t})]})};uI.displayName="WelcomeScreenMenuItemContent";const Xp=({onSelect:e,children:t,icon:n,shortcut:i,className:r="",...s})=>g("button",{...s,type:"button",className:`welcome-screen-menu-item ${r}`,onClick:e,children:g(uI,{icon:n,shortcut:i,children:t})});Xp.displayName="WelcomeScreenMenuItem";const HY=({children:e,href:t,icon:n,shortcut:i,className:r="",...s})=>g("a",{...s,className:`welcome-screen-menu-item ${r}`,href:t,target:"_blank",rel:"noopener",children:g(uI,{icon:n,shortcut:i,children:e})});HY.displayName="WelcomeScreenMenuItemLink";const yo=({children:e})=>{const{WelcomeScreenCenterTunnel:t}=er();return g(t.In,{children:g("div",{className:"welcome-screen-center",children:e||N(fe,{children:[g(fI,{}),g(hI,{children:M("welcomeScreen.defaults.center_heading")}),N(gI,{children:[g(pI,{}),g(mI,{})]})]})})})};yo.displayName="Center";const fI=({children:e})=>g("div",{className:"welcome-screen-center__logo excalifont welcome-screen-decor",children:e||g(zY,{withText:!0})});fI.displayName="Logo";const hI=({children:e})=>g("div",{className:"welcome-screen-center__heading welcome-screen-decor excalifont",children:e});hI.displayName="Heading";const gI=({children:e})=>g("div",{className:"welcome-screen-menu",children:e});gI.displayName="Menu";const mI=()=>{const e=Lr();return g(Xp,{onSelect:()=>e.executeAction(VT),shortcut:"?",icon:W9,children:M("helpDialog.title")})};mI.displayName="MenuItemHelp";const pI=()=>{const e=ai(),t=Lr();return e.viewModeEnabled?null:g(Xp,{onSelect:()=>t.executeAction(xv),shortcut:Zi("loadScene"),icon:Z9,children:M("buttons.load")})};pI.displayName="MenuItemLoadScene";const VY=({onSelect:e})=>{const{t}=fn();return g(Xp,{shortcut:null,onSelect:e,icon:Q9,children:t("labels.liveCollaboration")})};VY.displayName="MenuItemLiveCollaborationTrigger";yo.Logo=fI;yo.Heading=hI;yo.Menu=gI;yo.MenuItem=Xp;yo.MenuItemLink=HY;yo.MenuItemHelp=mI;yo.MenuItemLoadScene=pI;yo.MenuItemLiveCollaborationTrigger=VY;const UI=({children:e})=>{const{WelcomeScreenMenuHintTunnel:t}=er();return g(t.In,{children:N("div",{className:"excalifont welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--menu",children:[xue,g("div",{className:"welcome-screen-decor-hint__label",children:e||M("welcomeScreen.defaults.menuHint")})]})})};UI.displayName="MenuHint";const bI=({children:e})=>{const{WelcomeScreenToolbarHintTunnel:t}=er();return g(t.In,{children:N("div",{className:"excalifont welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--toolbar",children:[g("div",{className:"welcome-screen-decor-hint__label",children:e||M("welcomeScreen.defaults.toolbarHint")}),Aue]})})};bI.displayName="ToolbarHint";const yI=({children:e})=>{const{WelcomeScreenHelpHintTunnel:t}=er();return g(t.In,{children:N("div",{className:"excalifont welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--help",children:[g("div",{children:e||M("welcomeScreen.defaults.helpHint")}),Cue]})})};yI.displayName="HelpHint";const sr=e=>g(fe,{children:e.children||N(fe,{children:[g(yo,{}),g(UI,{}),g(bI,{}),g(yI,{})]})});sr.displayName="WelcomeScreen";sr.Center=yo;sr.Hints={MenuHint:UI,ToolbarHint:bI,HelpHint:yI};const $Y=()=>{Array.prototype.at||Object.defineProperty(Array.prototype,"at",{value:function(e){if(e=Math.trunc(e)||0,e<0&&(e+=this.length),!(e<0||e>=this.length))return this[e]},writable:!0,enumerable:!1,configurable:!0}),Element.prototype.replaceChildren||(Element.prototype.replaceChildren=function(...e){this.innerHTML="",this.append(...e)})},wwe=(e,t,n)=>{var i,r,s;return!!(t&&(t.id===((i=e.editingTextElement)==null?void 0:i.id)||t.id===((r=e.resizingElement)==null?void 0:r.id)||t.id===((s=e.newElement)==null?void 0:s.id)||t.version>n.version||t.version===n.version&&t.versionNonce<n.versionNonce))},_we=zo((e,t,n)=>{if(window!=null&&window.DEBUG_FRACTIONAL_INDICES){const i=cd(e.map(r=>({...r})));k9(i,{shouldThrow:K_(),includeBoundTextValidation:!0,reconciliationContext:{localElements:t,remoteElements:n}})}},1e3*60,{leading:!0,trailing:!1}),EI=(e,t,n)=>{const i=ve(e),r=[],s=new Set;for(const a of t)if(!s.has(a.id)){const l=i.get(a.id),c=wwe(n,l,a);l&&c?(r.push(l),s.add(l.id)):(r.push(a),s.add(a.id))}for(const a of e)s.has(a.id)||(r.push(a),s.add(a.id));const o=R9(r);return _we(o,e,t),cd(o),o},GY=({children:e,icon:t})=>{const{t:n}=fn(),{TTDDialogTriggerTunnel:i}=er(),r=xn();return g(i.In,{children:N(Ve.Item,{onSelect:()=>{et("ai","dialog open","ttd"),r({openDialog:{name:"ttd",tab:"text-to-diagram"}})},icon:t??zfe,children:[e??n("labels.textToDiagram"),g(Ve.Item.Badge,{children:"AI"})]})})};GY.displayName="TTDDialogTrigger";const Twe=e=>{const t=bo();return R.useLayoutEffect(()=>{t.setPlugins({diagramToCode:{generate:e.generate}})},[t,e.generate]),null};$Y();const Iwe=e=>{var K,ne,se,oe;const{onChange:t,onIncrement:n,initialData:i,excalidrawAPI:r,isCollaborating:s=!1,onPointerUpdate:o,renderTopLeftUI:a,renderTopRightUI:l,langCode:c=Xu.code,viewModeEnabled:d,zenModeEnabled:u,gridModeEnabled:f,libraryReturnUrl:h,theme:m,name:p,renderCustomStats:U,onPaste:b,detectScroll:y=!0,handleKeyboardGlobally:w=!1,onLibraryChange:v,autoFocus:I=!1,generateIdForFile:C,onLinkOpen:_,generateLinkForSelection:T,onPointerDown:k,onPointerUp:x,onScrollChange:D,onDuplicate:O,children:L,validateEmbeddable:Y,renderEmbeddable:$,aiEnabled:H,showDeprecatedFonts:z,renderScrollbars:G}=e,j=(K=e.UIOptions)==null?void 0:K.canvasActions,X={...e.UIOptions,canvasActions:{...wA.canvasActions,...j},tools:{image:((se=(ne=e.UIOptions)==null?void 0:ne.tools)==null?void 0:se.image)??!0}};return j!=null&&j.export&&(X.canvasActions.export.saveFileToDisk=((oe=j.export)==null?void 0:oe.saveFileToDisk)??wA.canvasActions.export.saveFileToDisk),X.canvasActions.toggleTheme===null&&typeof m>"u"&&(X.canvasActions.toggleTheme=!0),R.useEffect(()=>{(async()=>{await ye(()=>import("./roundRect-0PYZxl1G.js"),__vite__mapDeps([]))})();const Re=De=>{typeof De.scale=="number"&&De.scale!==1&&De.preventDefault()};return document.addEventListener("touchmove",Re,{passive:!1}),()=>{document.removeEventListener("touchmove",Re)}},[]),g(pue,{store:Gr,children:g(ywe,{langCode:c,theme:m,children:g(dI,{onChange:t,onIncrement:n,initialData:i,excalidrawAPI:r,isCollaborating:s,onPointerUpdate:o,renderTopLeftUI:a,renderTopRightUI:l,langCode:c,viewModeEnabled:d,zenModeEnabled:u,gridModeEnabled:f,libraryReturnUrl:h,theme:m,name:p,renderCustomStats:U,UIOptions:X,onPaste:b,detectScroll:y,handleKeyboardGlobally:w,onLibraryChange:v,autoFocus:I,generateIdForFile:C,onLinkOpen:_,generateLinkForSelection:T,onPointerDown:k,onPointerUp:x,onScrollChange:D,onDuplicate:O,validateEmbeddable:Y,renderEmbeddable:$,aiEnabled:H!==!1,showDeprecatedFonts:z,renderScrollbars:G,children:L})})})},Swe=(e,t)=>{if(e.children!==t.children)return!1;const{initialData:n,UIOptions:i={},...r}=e,{initialData:s,UIOptions:o={},...a}=t,l=Object.keys(i),c=Object.keys(o);return l.length!==c.length?!1:l.every(u=>u==="canvasActions"?Object.keys(i.canvasActions).every(h=>{var m,p,U,b;return h==="export"&&((m=i==null?void 0:i.canvasActions)!=null&&m.export)&&((p=o==null?void 0:o.canvasActions)!=null&&p.export)?i.canvasActions.export.saveFileToDisk===o.canvasActions.export.saveFileToDisk:((U=i==null?void 0:i.canvasActions)==null?void 0:U[h])===((b=o==null?void 0:o.canvasActions)==null?void 0:b[h])}):i[u]===o[u])&&Ki(r,a)},XY=de.memo(Iwe,Swe);XY.displayName="Excalidraw";const xwe=({link:e,onCloseRequest:t,setErrorMessage:n})=>{const{t:i}=fn(),[,r]=R.useState(!1),s=R.useRef(0),o=R.useRef(null),a=async()=>{var d;try{await ud(e)}catch{n(i("errors.copyToSystemClipboardFailed"))}r(!0),s.current&&window.clearTimeout(s.current),s.current=window.setTimeout(()=>{r(!1)},3e3),(d=o.current)==null||d.select()},{onCopy:l,copyStatus:c}=iI();return g(as,{onCloseRequest:t,title:!1,size:"small",children:N("div",{className:"ShareableLinkDialog",children:[g("h3",{children:"Shareable link"}),N("div",{className:"ShareableLinkDialog__linkRow",children:[g(Au,{ref:o,label:"Link",readonly:!0,fullWidth:!0,value:e,selectOnRender:!0}),g(Rs,{size:"large",label:i("buttons.copyLink"),icon:Np,status:c,onClick:()=>{l(),a()}})]}),N("div",{className:"ShareableLinkDialog__description",children:[" ",i("alerts.uploadedSecurly")]})]})})},Cwe=300,Awe=5e3,Mwe=300,kwe=500,iL=2e4,Rwe=50,Dwe=33,Lwe=24*60*60*1e3,vI=4*1024*1024,Nwe=31536e3,cb={SERVER_VOLATILE:"server-volatile-broadcast",SERVER:"server-broadcast",USER_FOLLOW_CHANGE:"user-follow",USER_FOLLOW_ROOM_CHANGE:"user-follow-room-change"};var ar=(e=>(e.INVALID_RESPONSE="INVALID_RESPONSE",e.INIT="SCENE_INIT",e.UPDATE="SCENE_UPDATE",e.MOUSE_LOCATION="MOUSE_LOCATION",e.IDLE_STATUS="IDLE_STATUS",e.USER_VISIBLE_SCENE_BOUNDS="USER_VISIBLE_SCENE_BOUNDS",e))(ar||{});const jY={shareLinkFiles:"/files/shareLinks",collabFiles:"/files/rooms"},Owe=10,Sn={LOCAL_STORAGE_ELEMENTS:"excalidraw",LOCAL_STORAGE_APP_STATE:"excalidraw-state",LOCAL_STORAGE_COLLAB:"excalidraw-collab",LOCAL_STORAGE_THEME:"excalidraw-theme",LOCAL_STORAGE_DEBUG:"excalidraw-debug",VERSION_DATA_STATE:"version-dataState",VERSION_FILES:"version-files",IDB_LIBRARY:"excalidraw-library",__LEGACY_LOCAL_STORAGE_LIBRARY:"excalidraw-library"},Pwe={AUTH_STATE_COOKIE:"excplus-auth"},Mu=document.cookie.includes(Pwe.AUTH_STATE_COOKIE),Fwe=e=>{try{localStorage.setItem(Sn.LOCAL_STORAGE_COLLAB,JSON.stringify({username:e}))}catch(t){console.error(t)}},YY=()=>{try{const e=localStorage.getItem(Sn.LOCAL_STORAGE_COLLAB);if(e)return JSON.parse(e).username}catch(e){console.error(e)}return null},WY=()=>{let e=null,t=null;try{e=localStorage.getItem(Sn.LOCAL_STORAGE_ELEMENTS),t=localStorage.getItem(Sn.LOCAL_STORAGE_APP_STATE)}catch(r){console.error(r)}let n=[];if(e)try{n=kH(JSON.parse(e))}catch(r){console.error(r)}let i=null;if(t)try{i={...sa(),...lG(JSON.parse(t))}}catch(r){console.error(r)}return{elements:n,appState:i}},KY=()=>{try{const e=localStorage.getItem(Sn.LOCAL_STORAGE_ELEMENTS);return(e==null?void 0:e.length)||0}catch(e){return console.error(e),0}},Bwe=()=>{try{const e=localStorage.getItem(Sn.LOCAL_STORAGE_APP_STATE),t=localStorage.getItem(Sn.LOCAL_STORAGE_COLLAB),n=(e==null?void 0:e.length)||0,i=(t==null?void 0:t.length)||0;return n+i+KY()}catch(e){return console.error(e),0}},zwe=500,rL=ll(e=>{e({scene:KY(),total:Bwe()})},zwe),Hwe=e=>{const[t,n]=R.useState({scene:0,total:0});R.useEffect(()=>{rL(o=>{n(o)})},[e.elements,e.appState]),R.useEffect(()=>()=>rL.cancel(),[]);const i=S4();let r,s;return i!==bB?(s=i.slice(0,16).replace("T"," "),r=i.slice(21)):s=M("stats.versionNotAvailable"),N(Ma.StatsRows,{order:-1,children:[g(Ma.StatsRow,{heading:!0,children:M("stats.version")}),N(Ma.StatsRow,{style:{textAlign:"center",cursor:"pointer"},onClick:async()=>{try{await ud(S4()),e.setToast(M("toast.copyToClipboard"))}catch{}},title:M("stats.versionCopy"),children:[s,g("br",{}),r]}),g(Ma.StatsRow,{heading:!0,children:M("stats.storage")}),N(Ma.StatsRow,{columns:2,children:[g("div",{children:M("stats.scene")}),g("div",{children:kA(t.scene,1)})]}),N(Ma.StatsRow,{columns:2,children:[g("div",{children:M("stats.total")}),g("div",{children:kA(t.total,1)})]})]})},Zs=Dp(),Vwe=(e,t)=>{const[n,i]=Wh(e);return R.useLayoutEffect(()=>{i(typeof t=="function"?t():t)},[]),[n,i]};function $we(e={}){const{nonce:t,onScriptLoadSuccess:n,onScriptLoadError:i}=e,[r,s]=R.useState(!1),o=R.useRef(n);o.current=n;const a=R.useRef(i);return a.current=i,R.useEffect(()=>{const l=document.createElement("script");return l.src="https://accounts.google.com/gsi/client",l.async=!0,l.defer=!0,l.nonce=t,l.onload=()=>{var c;s(!0),(c=o.current)===null||c===void 0||c.call(o)},l.onerror=()=>{var c;s(!1),(c=a.current)===null||c===void 0||c.call(a)},document.body.appendChild(l),()=>{document.body.removeChild(l)}},[t]),r}const ZY=R.createContext(null);function Gwe({clientId:e,nonce:t,onScriptLoadSuccess:n,onScriptLoadError:i,children:r}){const s=$we({nonce:t,onScriptLoadSuccess:n,onScriptLoadError:i}),o=R.useMemo(()=>({clientId:e,scriptLoadedSuccessfully:s}),[e,s]);return de.createElement(ZY.Provider,{value:o},r)}function Xwe(){const e=R.useContext(ZY);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function jwe({flow:e="implicit",scope:t="",onSuccess:n,onError:i,onNonOAuthError:r,overrideScope:s,state:o,...a}){const{clientId:l,scriptLoadedSuccessfully:c}=Xwe(),d=R.useRef(),u=R.useRef(n);u.current=n;const f=R.useRef(i);f.current=i;const h=R.useRef(r);h.current=r,R.useEffect(()=>{var U,b;if(!c)return;const y=e==="implicit"?"initTokenClient":"initCodeClient",w=(b=(U=window==null?void 0:window.google)===null||U===void 0?void 0:U.accounts)===null||b===void 0?void 0:b.oauth2[y]({client_id:l,scope:s?t:`openid profile email ${t}`,callback:v=>{var I,C;if(v.error)return(I=f.current)===null||I===void 0?void 0:I.call(f,v);(C=u.current)===null||C===void 0||C.call(u,v)},error_callback:v=>{var I;(I=h.current)===null||I===void 0||I.call(h,v)},state:o,...a});d.current=w},[l,c,e,t,o]);const m=R.useCallback(U=>{var b;return(b=d.current)===null||b===void 0?void 0:b.requestAccessToken(U)},[]),p=R.useCallback(()=>{var U;return(U=d.current)===null||U===void 0?void 0:U.requestCode()},[]);return e==="implicit"?m:p}const qs={FOLDER_NAME:"Excalidraw",FILE_PREFIX:"session",FILE_EXTENSION:".excalidraw",MIME_TYPE:"application/json",FOLDER_MIME_TYPE:"application/vnd.google-apps.folder",THUMBNAIL_SIZE:"400x300",DEFAULT_AUTO_SAVE_INTERVAL:5*60*1e3,MAX_FILE_SIZE:10*1024*1024};function sL(e){const t=new Date,n=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");let s;if(e){const o=e.split("@")[0];s=o.charAt(0).toUpperCase()+o.slice(1).replace(/[^a-zA-Z0-9]/g,"")}else s=qs.FILE_PREFIX;return`${s}_${n}_${i}_${r}${qs.FILE_EXTENSION}`}function Zv(e){if(e===0)return"0 B";const t=1024,n=["B","KB","MB","GB","TB"],i=Math.floor(Math.log(e)/Math.log(t));return`${parseFloat((e/Math.pow(t,i)).toFixed(2))} ${n[i]}`}function Ywe(e){const t=new Date(e),i=new Date().getTime()-t.getTime(),r=Math.floor(i/(1e3*60)),s=Math.floor(i/(1e3*60*60)),o=Math.floor(i/(1e3*60*60*24));return r<1?"just now":r<60?`${r} minute${r>1?"s":""} ago`:s<24?`${s} hour${s>1?"s":""} ago`:o<30?`${o} day${o>1?"s":""} ago`:t.toLocaleDateString()}const wa="https://www.googleapis.com/drive/v3",oL="https://www.googleapis.com/upload/drive/v3";class Wwe{constructor(t){F(this,"accessToken",null);t&&(this.accessToken=t)}setAccessToken(t){this.accessToken=t}getHeaders(){if(!this.accessToken)throw new Error("No access token available. Please sign in first.");return{Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json"}}async handleResponse(t){if(!t.ok){let n=`HTTP ${t.status} ${t.statusText}`;try{const i=await t.text();console.error("Google Drive API Error Response:",i);const r=JSON.parse(i);r.error&&(n=`${r.error.code}: ${r.error.message}`)}catch(i){console.error("Failed to parse error response:",i)}throw new Error(`Google Drive API Error: ${n}`)}return t.json()}async findOrCreateFolder(){try{const t=`name='${qs.FOLDER_NAME}' and mimeType='${qs.FOLDER_MIME_TYPE}' and trashed=false`,n=`${wa}/files?q=${encodeURIComponent(t)}&fields=files(id,name)`,i=await fetch(n,{headers:this.getHeaders()}),r=await this.handleResponse(i);if(r.files&&r.files.length>0)return r.files[0].id;const s=await fetch(`${wa}/files`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({name:qs.FOLDER_NAME,mimeType:qs.FOLDER_MIME_TYPE})});return(await this.handleResponse(s)).id}catch(t){throw console.error("Error finding/creating folder:",t),t}}async uploadFile(t,n,i){try{const r=await this.findOrCreateFolder(),s={name:n,mimeType:qs.MIME_TYPE,parents:[r]},o="-------314159265358979323846",a=`\r
--${o}\r
`,l=`\r
--${o}--`;let c=a+`Content-Type: application/json; charset=UTF-8\r
\r
`+JSON.stringify(s)+a+`Content-Type: ${qs.MIME_TYPE}\r
\r
`+t+l;const d=await fetch(`${oL}/files?uploadType=multipart&fields=id,name,mimeType,size,createdTime,modifiedTime,thumbnailLink,webViewLink,webContentLink`,{method:"POST",headers:{Authorization:`Bearer ${this.accessToken}`,"Content-Type":`multipart/related; boundary=${o}`},body:c}),u=await this.handleResponse(d);return i&&await this.updateThumbnail(u.id,i),u}catch(r){throw console.error("Error uploading file:",r),r}}async updateFile(t,n,i){try{const r=await fetch(`${oL}/files/${t}?uploadType=media&fields=id,name,mimeType,size,createdTime,modifiedTime,thumbnailLink,webViewLink,webContentLink`,{method:"PATCH",headers:{Authorization:`Bearer ${this.accessToken}`,"Content-Type":qs.MIME_TYPE},body:n}),s=await this.handleResponse(r);return i&&await this.updateThumbnail(t,i),s}catch(r){throw console.error("Error updating file:",r),r}}async updateThumbnail(t,n){try{await fetch(`${wa}/files/${t}`,{method:"PATCH",headers:this.getHeaders(),body:JSON.stringify({properties:{thumbnail:n}})})}catch(i){console.error("Error updating thumbnail:",i)}}async listFiles(t=20){try{const i=`'${await this.findOrCreateFolder()}' in parents and trashed=false`,r=`${wa}/files?q=${encodeURIComponent(i)}&pageSize=${t}&orderBy=modifiedTime desc&fields=files(id,name,mimeType,size,createdTime,modifiedTime,thumbnailLink,webViewLink,webContentLink,properties)`,s=await fetch(r,{headers:this.getHeaders()});return(await this.handleResponse(s)).files||[]}catch(n){throw console.error("Error listing files:",n),n}}async downloadFile(t){try{const n=`${wa}/files/${t}?alt=media`,i=await fetch(n,{headers:this.getHeaders()});if(!i.ok)throw new Error(`Failed to download file: ${i.statusText}`);return i.text()}catch(n){throw console.error("Error downloading file:",n),n}}async deleteFile(t){try{const n=await fetch(`${wa}/files/${t}`,{method:"DELETE",headers:this.getHeaders()});if(!n.ok&&n.status!==204)throw new Error(`Failed to delete file: ${n.statusText}`)}catch(n){throw console.error("Error deleting file:",n),n}}async createShareLink(t,n){try{const i={type:n.type,role:n.role,...n.type==="anyone"&&{allowFileDiscovery:n.allowFileDiscovery??!1}};await fetch(`${wa}/files/${t}/permissions`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify(i)});const r=await fetch(`${wa}/files/${t}?fields=webViewLink`,{headers:this.getHeaders()});return(await this.handleResponse(r)).webViewLink}catch(i){throw console.error("Error creating share link:",i),i}}async getStorageInfo(){try{const t=`${wa}/about?fields=storageQuota`,n=await fetch(t,{headers:this.getHeaders()}),i=await this.handleResponse(n);return{limit:parseInt(i.storageQuota.limit),usage:parseInt(i.storageQuota.usage),usageInDrive:parseInt(i.storageQuota.usageInDrive),usageInDriveTrash:parseInt(i.storageQuota.usageInDriveTrash)}}catch(t){throw console.error("Error getting storage info:",t),t}}}const $s=new Wwe,qY=R.createContext(null);function Kwe({excalidrawAPI:e,children:t}){return g(qY.Provider,{value:{excalidrawAPI:e},children:t})}function Zwe(){const e=R.useContext(qY);return e?e.excalidrawAPI:(console.warn("useExcalidrawAPI must be used within ExcalidrawAPIProvider"),null)}function qwe({isOpen:e,onClose:t,onFileSelect:n}){const{listFiles:i}=wI(),[r,s]=R.useState([]),[o,a]=R.useState(!1),[l,c]=R.useState(""),[d,u]=R.useState(null);R.useEffect(()=>{e&&f()},[e]);const f=async()=>{try{a(!0),u(null);const p=await i(50);s(p)}catch(p){console.error("Error loading files:",p),u("Failed to load files from Google Drive")}finally{a(!1)}},h=p=>{n(p),t()},m=r.filter(p=>p.name.toLowerCase().includes(l.toLowerCase()));return e?g("div",{className:"google-drive-modal-overlay",onClick:t,children:N("div",{className:"google-drive-modal",onClick:p=>p.stopPropagation(),children:[N("div",{className:"google-drive-modal-header",children:[g("h2",{children:"Open from Google Drive"}),g("button",{type:"button",className:"google-drive-modal-close",onClick:t,"aria-label":"Close",children:""})]}),N("div",{className:"google-drive-modal-body",children:[g("div",{className:"google-drive-search",children:g("input",{type:"text",placeholder:" Search files...",value:l,onChange:p=>c(p.target.value),className:"google-drive-search-input"})}),o&&N("div",{className:"google-drive-loading",children:[g("div",{className:"google-drive-spinner"}),g("p",{children:"Loading files from Google Drive..."})]}),d&&N("div",{className:"google-drive-error",children:[N("p",{children:[" ",d]}),g("button",{type:"button",onClick:f,className:"google-drive-retry-button",children:"Retry"})]}),!o&&!d&&N("div",{className:"google-drive-file-list",children:[m.length===0&&g("div",{className:"google-drive-empty",children:g("p",{children:l?"No files match your search":"No files found. Create your first drawing!"})}),m.map(p=>N("button",{type:"button",className:"google-drive-file-item",onClick:()=>h(p.id),children:[g("div",{className:"google-drive-file-thumbnail",children:p.thumbnailLink?g("img",{src:p.thumbnailLink,alt:p.name,loading:"lazy"}):g("div",{className:"google-drive-file-thumbnail-placeholder",children:""})}),N("div",{className:"google-drive-file-info",children:[g("div",{className:"google-drive-file-name",title:p.name,children:p.name}),N("div",{className:"google-drive-file-meta",children:[g("span",{children:new Date(p.modifiedTime).toLocaleDateString()}),g("span",{className:"google-drive-file-separator",children:""}),g("span",{children:Zv(p.size)})]}),N("div",{className:"google-drive-file-time",children:["Last modified: ",Ywe(p.modifiedTime)]})]})]},p.id))]})]}),g("div",{className:"google-drive-modal-footer",children:g("button",{type:"button",onClick:t,className:"google-drive-button-secondary",children:"Cancel"})})]})}):null}var Qwe={};const aL=Qwe.VITE_GOOGLE_DRIVE_CLIENT_ID||"",Jwe="https://www.googleapis.com/auth/drive.file",QY=R.createContext(null);function e_e({children:e}){const t=Zwe(),[n,i]=R.useState(!1),[r,s]=R.useState(null),[o,a]=R.useState(null),[l,c]=R.useState({enabled:!0,interval:qs.DEFAULT_AUTO_SAVE_INTERVAL,lastSaveTime:null}),[d,u]=R.useState(null),[f,h]=R.useState(()=>typeof window<"u"?localStorage.getItem("gdrive_current_file_id"):null),[m,p]=R.useState(()=>typeof window<"u"?localStorage.getItem("gdrive_current_file_name"):null),[U,b]=R.useState(null),[y,w]=R.useState(!1),v=R.useCallback((X,K)=>{h(X),p(K),typeof window<"u"&&(X&&K?(localStorage.setItem("gdrive_current_file_id",X),localStorage.setItem("gdrive_current_file_name",K)):(localStorage.removeItem("gdrive_current_file_id"),localStorage.removeItem("gdrive_current_file_name")))},[]),I=jwe({onSuccess:async X=>{try{a(X.access_token),$s.setAccessToken(X.access_token);const ne=await(await fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:`Bearer ${X.access_token}`}})).json();s(ne.email),i(!0),await G();try{const se=await $s.findOrCreateFolder();b(se),console.log("Excalidraw folder ID:",se)}catch(se){console.error("Error finding/creating folder:",se)}console.log("Google Drive connected:",ne.email)}catch(K){console.error("Error during Google sign-in:",K),i(!1)}},onError:X=>{console.error("Google login error:",X),i(!1)},scope:Jwe}),C=R.useCallback(async()=>{try{I()}catch(X){throw console.error("Error signing in:",X),X}},[I]),_=R.useCallback(async()=>{try{i(!1),s(null),a(null),u(null),v(null,null),b(null),console.log("Signed out from Google Drive")}catch(X){throw console.error("Error signing out:",X),X}},[v]),T=R.useCallback(async X=>{if(!n)throw new Error("Not authenticated with Google Drive");try{const K=X||sL(r||void 0);if(!t)throw new Error("Excalidraw API not ready. Please try again.");const ne=t.getSceneElements(),se=t.getAppState(),oe=t.getFiles(),Ee=JSON.stringify({type:"excalidraw",version:2,source:"https://pierrre2db.github.io/excalidraw",elements:ne,appState:se,files:oe}),Re=void 0;let De;return f?(De=await $s.updateFile(f,Ee,Re),console.log("File updated:",De.name)):(De=await $s.uploadFile(Ee,K,Re),v(De.id,De.name),console.log("File created:",De.name)),c(vt=>({...vt,lastSaveTime:Date.now()})),De}catch(K){throw console.error("Error saving to Google Drive:",K),K}},[n,f,r,v,t]),k=R.useCallback(async X=>{if(!n)throw new Error("Not authenticated with Google Drive");try{if(!t)throw new Error("Excalidraw API not ready. Please try again.");const K=t.getSceneElements(),ne=t.getAppState(),se=t.getFiles(),oe=JSON.stringify({type:"excalidraw",version:2,source:"https://pierrre2db.github.io/excalidraw",elements:K,appState:ne,files:se}),Re=await $s.uploadFile(oe,X,void 0);return v(Re.id,Re.name),console.log("File created (Save As):",Re.name),c(De=>({...De,lastSaveTime:Date.now()})),Re}catch(K){throw console.error("Error saving as to Google Drive:",K),K}},[n,v,t]),x=R.useCallback(async()=>{if(!n)throw new Error("Not authenticated with Google Drive");try{const X=new Date,K=String(X.getHours()).padStart(2,"0"),ne=String(X.getMinutes()).padStart(2,"0"),se=`${K}h${ne}`;let oe;if(m?oe=`${m.replace(/\.excalidraw$/,"")}_${se}.excalidraw`:oe=`${sL(r||void 0).replace(/\.excalidraw$/,"")}_${se}.excalidraw`,!t)throw new Error("Excalidraw API not ready. Please try again.");const Ee=t.getSceneElements(),Re=t.getAppState(),De=t.getFiles(),vt=JSON.stringify({type:"excalidraw",version:2,source:"https://pierrre2db.github.io/excalidraw",elements:Ee,appState:Re,files:De}),Be=await $s.uploadFile(vt,oe,void 0);return v(Be.id,Be.name),console.log("Version created:",Be.name),c(Qe=>({...Qe,lastSaveTime:Date.now()})),Be}catch(X){throw console.error("Error creating version:",X),X}},[n,m,r,v,t]),D=R.useCallback(()=>{v(null,null),console.log("New file started")},[v]),O=R.useCallback(async()=>{if(!n)throw new Error("Not authenticated with Google Drive");try{w(!0)}catch(X){throw console.error("Error opening from Google Drive:",X),X}},[n]),L=R.useCallback(async X=>{if(!n)throw new Error("Not authenticated with Google Drive");if(!t)throw new Error("Excalidraw API not ready");try{console.log("Loading file from Google Drive:",X);const K=await $s.downloadFile(X),ne=JSON.parse(K),oe=(await $s.listFiles(50)).find(Re=>Re.id===X);oe&&(v(oe.id,oe.name),console.log("Loaded file:",oe.name));const Ee={};ne.appState&&(ne.appState.viewBackgroundColor!==void 0&&(Ee.viewBackgroundColor=ne.appState.viewBackgroundColor),ne.appState.gridSize!==void 0&&(Ee.gridSize=ne.appState.gridSize),ne.appState.currentChartType!==void 0&&(Ee.currentChartType=ne.appState.currentChartType)),t.updateScene({elements:ne.elements||[],appState:Object.keys(Ee).length>0?Ee:void 0}),ne.files&&Object.keys(ne.files).length>0&&t.addFiles(Object.values(ne.files)),console.log("File loaded successfully into Excalidraw")}catch(K){throw console.error("Error loading file from Google Drive:",K),K}},[n,t,v]),Y=R.useCallback(async(X=20)=>{if(!n)throw new Error("Not authenticated with Google Drive");try{return await $s.listFiles(X)}catch(K){throw console.error("Error listing files:",K),K}},[n]),$=R.useCallback(async(X,K)=>{if(!n)throw new Error("Not authenticated with Google Drive");try{const ne=await $s.createShareLink(X,K);return navigator.clipboard&&(await navigator.clipboard.writeText(ne),console.log("Share link copied to clipboard")),ne}catch(ne){throw console.error("Error sharing file:",ne),ne}},[n]),H=R.useCallback(()=>{c(X=>({...X,enabled:!X.enabled}))},[]),z=R.useCallback(X=>{c(K=>({...K,interval:X}))},[]),G=R.useCallback(async()=>{if(n)try{const X=await $s.getStorageInfo();u(X)}catch(X){console.error("Error refreshing storage info:",X)}},[n]);R.useEffect(()=>{if(!l.enabled||!n)return;const X=setInterval(async()=>{try{console.log("Auto-save triggered"),await T()}catch(K){console.error("Auto-save error:",K)}},l.interval);return()=>clearInterval(X)},[l,n,T]);const j={isAuthenticated:n,userEmail:r,signIn:C,signOut:_,saveToGoogleDrive:T,saveAsToGoogleDrive:k,createVersion:x,newFile:D,openFromGoogleDrive:O,listFiles:Y,shareFile:$,currentFileName:m,currentFileId:f,autoSaveConfig:l,toggleAutoSave:H,setAutoSaveInterval:z,storageInfo:d,refreshStorageInfo:G,folderId:U};return N(QY.Provider,{value:j,children:[e,g(qwe,{isOpen:y,onClose:()=>w(!1),onFileSelect:L})]})}function t_e({children:e}){return aL?g(Gwe,{clientId:aL,children:g(e_e,{children:e})}):(console.warn("Google Drive CLIENT_ID not configured. Please set VITE_GOOGLE_DRIVE_CLIENT_ID in .env file."),g(fe,{children:e}))}function wI(){const e=R.useContext(QY);return e||{isAuthenticated:!1,userEmail:null,signIn:async()=>{console.warn("Google Drive not configured")},signOut:async()=>{},saveToGoogleDrive:async()=>null,saveAsToGoogleDrive:async()=>null,createVersion:async()=>null,newFile:()=>{},openFromGoogleDrive:async()=>{},listFiles:async()=>[],shareFile:async()=>"",currentFileName:null,currentFileId:null,autoSaveConfig:{enabled:!1,interval:qs.DEFAULT_AUTO_SAVE_INTERVAL,lastSaveTime:null},toggleAutoSave:()=>{},setAutoSaveInterval:()=>{},storageInfo:null,refreshStorageInfo:async()=>{},folderId:null}}function n_e({className:e}){const{signIn:t,isAuthenticated:n}=wI();if(n)return null;const i=async()=>{try{await t()}catch(r){console.error("Failed to connect to Google Drive:",r)}};return N("button",{type:"button",className:`google-drive-connect-button ${e||""}`,onClick:i,"aria-label":"Connect to Google Drive",title:"Connect to Google Drive to save and sync your drawings",children:[N("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{marginRight:"6px"},children:[g("path",{d:"M5.33333 1.33333L10.6667 1.33333L14.6667 8L10.6667 14.6667L5.33333 14.6667L1.33333 8L5.33333 1.33333Z",fill:"#4285F4",opacity:"0.7"}),g("path",{d:"M10.6667 1.33333L14.6667 8L10.6667 14.6667",stroke:"#4285F4",strokeWidth:"1.5",strokeLinecap:"round"})]}),"Connect Google Drive"]})}function i_e(){const{isAuthenticated:e,userEmail:t,signOut:n,saveToGoogleDrive:i,saveAsToGoogleDrive:r,createVersion:s,newFile:o,openFromGoogleDrive:a,autoSaveConfig:l,toggleAutoSave:c,storageInfo:d,folderId:u,currentFileName:f}=wI(),[h,m]=R.useState(!1),[p,U]=R.useState(!1);if(!e)return null;const b=async()=>{try{U(!0),await i()}catch(T){console.error("Failed to save:",T)}finally{U(!1)}},y=async()=>{try{const T=prompt("Nom du fichier:",f||"");if(!T)return;U(!0),await r(T),m(!1)}catch(T){console.error("Failed to save as:",T)}finally{U(!1)}},w=async()=>{try{U(!0),await s(),m(!1)}catch(T){console.error("Failed to create version:",T)}finally{U(!1)}},v=()=>{confirm("Crer un nouveau fichier ? Les modifications non sauvegardes seront perdues.")&&(o(),m(!1))},I=async()=>{try{await a(),m(!1)}catch(T){console.error("Failed to open:",T)}},C=async()=>{try{await n(),m(!1)}catch(T){console.error("Failed to sign out:",T)}},_=()=>{const T=u?`https://drive.google.com/drive/folders/${u}`:"https://drive.google.com/drive/my-drive";window.open(T,"_blank")};return N("div",{className:"google-drive-menu",children:[N("button",{type:"button",className:"google-drive-autosave-toggle",onClick:c,title:`Auto-save is ${l.enabled?"ON":"OFF"}. Click to toggle.`,"aria-label":`Auto-save ${l.enabled?"enabled":"disabled"}`,children:[N("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{marginRight:"4px"},children:[g("path",{d:"M8 2C5 2 2.5 4.5 2.5 7.5C2.5 9.5 3.5 11 5 12L5 10C4 9.5 3.5 8.5 3.5 7.5C3.5 5.5 5.5 4 8 4C10.5 4 12.5 5.5 12.5 7.5C12.5 8.5 12 9.5 11 10L11 12C12.5 11 13.5 9.5 13.5 7.5C13.5 4.5 11 2 8 2Z",fill:l.enabled?"#4285F4":"#666"}),g("path",{d:"M7 8L7 14M7 14L5 12M7 14L9 12",stroke:l.enabled?"#4285F4":"#666",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),"Auto-save ",l.enabled?"ON":"OFF"]}),N("div",{className:"google-drive-user-menu",children:[N("button",{type:"button",className:"google-drive-user-button",onClick:()=>m(!h),"aria-label":"Google Drive menu","aria-expanded":h,children:[g("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{marginRight:"4px"},children:g("path",{d:"M1 8L5 2L11 2L15 8L11 14L5 14L1 8Z",fill:"#4285F4",opacity:"0.7"})}),"Drive: ",t," "]}),h&&N("div",{className:"google-drive-dropdown",children:[g("div",{className:"google-drive-dropdown-header",children:g("strong",{children:t})}),g("div",{className:"google-drive-dropdown-divider"}),N("button",{type:"button",className:"google-drive-menu-item",onClick:b,disabled:p,title:f||"Create new file",children:[g("span",{children:""}),p?"Saving...":f?`Save "${f}"`:"Save to Drive",g("span",{className:"google-drive-shortcut",children:"Ctrl+S"})]}),N("button",{type:"button",className:"google-drive-menu-item",onClick:y,disabled:p,children:[g("span",{children:""}),"Save As..."]}),N("button",{type:"button",className:"google-drive-menu-item",onClick:w,disabled:p,title:"Create a timestamped version",children:[g("span",{children:""}),"Create Version"]}),g("div",{className:"google-drive-dropdown-divider"}),N("button",{type:"button",className:"google-drive-menu-item",onClick:v,children:[g("span",{children:""}),"New File"]}),N("button",{type:"button",className:"google-drive-menu-item",onClick:I,children:[g("span",{children:""}),"Open from Drive",g("span",{className:"google-drive-shortcut",children:"Ctrl+O"})]}),N("button",{type:"button",className:"google-drive-menu-item",onClick:()=>{},children:[g("span",{children:""}),"Share from Drive"]}),g("div",{className:"google-drive-dropdown-divider"}),N("div",{className:"google-drive-autosave-config",children:[N("button",{type:"button",onClick:c,className:"google-drive-menu-item",children:[g("span",{children:l.enabled?"":""}),"Auto-save: ",l.enabled?"ON":"OFF"]}),N("div",{className:"google-drive-info-text",children:["Save interval: ",l.interval/6e4," min"]})]}),g("div",{className:"google-drive-dropdown-divider"}),d&&N(fe,{children:[N("div",{className:"google-drive-storage-info",children:[N("div",{className:"google-drive-info-text",children:["Storage: ",Zv(d.usageInDrive)," /"," ",Zv(d.limit)]}),g("div",{className:"google-drive-storage-bar",children:g("div",{className:"google-drive-storage-bar-fill",style:{width:`${d.usageInDrive/d.limit*100}%`}})})]}),g("div",{className:"google-drive-dropdown-divider"})]}),N("button",{type:"button",className:"google-drive-menu-item",onClick:_,children:[g("span",{children:""}),"View in Drive"]}),g("div",{className:"google-drive-dropdown-divider"}),N("button",{type:"button",className:"google-drive-menu-item google-drive-menu-item-danger",onClick:C,children:[g("span",{children:""}),"Disconnect"]})]})]})]})}class JY{constructor({getFiles:t,saveFiles:n}){F(this,"fetchingFiles",new Map);F(this,"erroredFiles_fetch",new Map);F(this,"savingFiles",new Map);F(this,"savedFiles",new Map);F(this,"erroredFiles_save",new Map);F(this,"_getFiles");F(this,"_saveFiles");F(this,"isFileTracked",t=>this.savedFiles.has(t)||this.savingFiles.has(t)||this.fetchingFiles.has(t)||this.erroredFiles_fetch.has(t)||this.erroredFiles_save.has(t));F(this,"isFileSavedOrBeingSaved",t=>{const n=this.getFileVersion(t);return this.savedFiles.get(t.id)===n||this.savingFiles.get(t.id)===n});F(this,"getFileVersion",t=>t.version??1);F(this,"saveFiles",async({elements:t,files:n})=>{const i=new Map;for(const r of t){const s=Dn(r)&&n[r.fileId];s&&!this.isFileSavedOrBeingSaved(s)&&(i.set(r.fileId,n[r.fileId]),this.savingFiles.set(r.fileId,this.getFileVersion(s)))}try{const{savedFiles:r,erroredFiles:s}=await this._saveFiles({addedFiles:i});for(const[o,a]of r)this.savedFiles.set(o,this.getFileVersion(a));for(const[o,a]of s)this.erroredFiles_save.set(o,this.getFileVersion(a));return{savedFiles:r,erroredFiles:s}}finally{for(const[r]of i)this.savingFiles.delete(r)}});F(this,"getFiles",async t=>{if(!t.length)return{loadedFiles:[],erroredFiles:new Map};for(const n of t)this.fetchingFiles.set(n,!0);try{const{loadedFiles:n,erroredFiles:i}=await this._getFiles(t);for(const r of n)this.savedFiles.set(r.id,this.getFileVersion(r));for(const[r]of i)this.erroredFiles_fetch.set(r,!0);return{loadedFiles:n,erroredFiles:i}}finally{for(const n of t)this.fetchingFiles.delete(n)}});F(this,"shouldPreventUnload",t=>t.some(n=>Dn(n)&&!n.isDeleted&&this.savingFiles.has(n.fileId)));F(this,"shouldUpdateImageElementStatus",t=>Dn(t)&&this.savedFiles.has(t.fileId)&&t.status==="pending");this._getFiles=t,this._saveFiles=n}reset(){this.fetchingFiles.clear(),this.savingFiles.clear(),this.savedFiles.clear(),this.erroredFiles_fetch.clear(),this.erroredFiles_save.clear()}}const _I=async({files:e,maxBytes:t,encryptionKey:n})=>{const i=[];for(const[r,s]of e){const o=new TextEncoder().encode(s.dataURL),a=await sX(o,{encryptionKey:n,metadata:{id:r,mimeType:s.mimeType,created:Date.now(),lastRetrieved:Date.now()}});if(o.byteLength>t)throw new Error(M("errors.fileTooBig",{maxSize:`${Math.trunc(t/1024/1024)}MB`}));i.push({id:r,buffer:a})}return i},q1=e=>{e.erroredFiles.size&&e.excalidrawAPI.updateScene({elements:e.excalidrawAPI.getSceneElementsIncludingDeleted().map(t=>Dn(t)&&e.erroredFiles.has(t.fileId)?Ie(t,{status:"error"}):t),captureUpdate:Z.NEVER})};var lL={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eW=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=r&63|128):(r&64512)===55296&&i+1<e.length&&(e.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(e.charCodeAt(++i)&1023),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=r&63|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=r&63|128)}return t},r_e=function(e){const t=[];let n=0,i=0;for(;n<e.length;){const r=e[n++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=e[n++];t[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=e[n++],o=e[n++],a=e[n++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;t[i++]=String.fromCharCode(55296+(l>>10)),t[i++]=String.fromCharCode(56320+(l&1023))}else{const s=e[n++],o=e[n++];t[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return t.join("")},tW={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<e.length;r+=3){const s=e[r],o=r+1<e.length,a=o?e[r+1]:0,l=r+2<e.length,c=l?e[r+2]:0,d=s>>2,u=(s&3)<<4|a>>4;let f=(a&15)<<2|c>>6,h=c&63;l||(h=64,o||(f=64)),i.push(n[d],n[u],n[f],n[h])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(eW(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):r_e(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<e.length;){const s=n[e.charAt(r++)],a=r<e.length?n[e.charAt(r)]:0;++r;const c=r<e.length?n[e.charAt(r)]:64;++r;const u=r<e.length?n[e.charAt(r)]:64;if(++r,s==null||a==null||c==null||u==null)throw new s_e;const f=s<<2|a>>4;if(i.push(f),c!==64){const h=a<<4&240|c>>2;if(i.push(h),u!==64){const m=c<<6&192|u;i.push(m)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class s_e extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const o_e=function(e){const t=eW(e);return tW.encodeByteArray(t,!0)},d5=function(e){return o_e(e).replace(/\./g,"")},a_e=function(e){try{return tW.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l_e(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c_e=()=>l_e().__FIREBASE_DEFAULTS__,d_e=()=>{if(typeof process>"u"||typeof lL>"u")return;const e=lL.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},u_e=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&a_e(e[1]);return t&&JSON.parse(t)},TI=()=>{try{return c_e()||d_e()||u_e()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},f_e=e=>{var t,n;return(n=(t=TI())===null||t===void 0?void 0:t.emulatorHosts)===null||n===void 0?void 0:n[e]},nW=e=>{const t=f_e(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),i]:[t.substring(0,n),i]},iW=()=>{var e;return(e=TI())===null||e===void 0?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_e{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rW(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=t||"demo-project",r=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[d5(JSON.stringify(n)),d5(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g_e(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function m_e(){var e;const t=(e=TI())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function p_e(){return!m_e()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function U_e(){try{return typeof indexedDB=="object"}catch{return!1}}function b_e(){return new Promise((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var s;t(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y_e="FirebaseError";class Ku extends Error{constructor(t,n,i){super(n),this.code=t,this.customData=i,this.name=y_e,Object.setPrototypeOf(this,Ku.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,sW.prototype.create)}}class sW{constructor(t,n,i){this.service=t,this.serviceName=n,this.errors=i}create(t,...n){const i=n[0]||{},r=`${this.service}/${t}`,s=this.errors[t],o=s?E_e(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Ku(r,a,i)}}function E_e(e,t){return e.replace(v_e,(n,i)=>{const r=t[i];return r!=null?String(r):`<${i}?>`})}const v_e=/\{\$([^}]+)}/g;function qv(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const r of n){if(!i.includes(r))return!1;const s=e[r],o=t[r];if(cL(s)&&cL(o)){if(!qv(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!n.includes(r))return!1;return!0}function cL(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function po(e){return e&&e._delegate?e._delegate:e}class rg{constructor(t,n,i){this.name=t,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xd="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_e{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const i=new h_e;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const i=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),r=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(T_e(t))try{this.getOrInitializeService({instanceIdentifier:xd})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(t=xd){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=xd){return this.instances.has(t)}getOptions(t=xd){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(t,n){var i;const r=this.normalizeInstanceIdentifier(n),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(t),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&t(o,r),()=>{s.delete(t)}}invokeOnInitCallbacks(t,n){const i=this.onInitCallbacks.get(n);if(i)for(const r of i)try{r(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:__e(t),options:n}),this.instances.set(t,i),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=xd){return this.component?this.component.multipleInstances?t:xd:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function __e(e){return e===xd?void 0:e}function T_e(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I_e{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new w_e(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ut;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(ut||(ut={}));const S_e={debug:ut.DEBUG,verbose:ut.VERBOSE,info:ut.INFO,warn:ut.WARN,error:ut.ERROR,silent:ut.SILENT},x_e=ut.INFO,C_e={[ut.DEBUG]:"log",[ut.VERBOSE]:"log",[ut.INFO]:"info",[ut.WARN]:"warn",[ut.ERROR]:"error"},A_e=(e,t,...n)=>{if(t<e.logLevel)return;const i=new Date().toISOString(),r=C_e[t];if(r)console[r](`[${i}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class oW{constructor(t){this.name=t,this._logLevel=x_e,this._logHandler=A_e,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in ut))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?S_e[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,ut.DEBUG,...t),this._logHandler(this,ut.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,ut.VERBOSE,...t),this._logHandler(this,ut.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,ut.INFO,...t),this._logHandler(this,ut.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,ut.WARN,...t),this._logHandler(this,ut.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,ut.ERROR,...t),this._logHandler(this,ut.ERROR,...t)}}const M_e=(e,t)=>t.some(n=>e instanceof n);let dL,uL;function k_e(){return dL||(dL=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function R_e(){return uL||(uL=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const aW=new WeakMap,Qv=new WeakMap,lW=new WeakMap,Q3=new WeakMap,II=new WeakMap;function D_e(e){const t=new Promise((n,i)=>{const r=()=>{e.removeEventListener("success",s),e.removeEventListener("error",o)},s=()=>{n(Ac(e.result)),r()},o=()=>{i(e.error),r()};e.addEventListener("success",s),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&aW.set(n,e)}).catch(()=>{}),II.set(t,e),t}function L_e(e){if(Qv.has(e))return;const t=new Promise((n,i)=>{const r=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",o),e.removeEventListener("abort",o)},s=()=>{n(),r()},o=()=>{i(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",s),e.addEventListener("error",o),e.addEventListener("abort",o)});Qv.set(e,t)}let Jv={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return Qv.get(e);if(t==="objectStoreNames")return e.objectStoreNames||lW.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ac(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function N_e(e){Jv=e(Jv)}function O_e(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const i=e.call(J3(this),t,...n);return lW.set(i,t.sort?t.sort():[t]),Ac(i)}:R_e().includes(e)?function(...t){return e.apply(J3(this),t),Ac(aW.get(this))}:function(...t){return Ac(e.apply(J3(this),t))}}function P_e(e){return typeof e=="function"?O_e(e):(e instanceof IDBTransaction&&L_e(e),M_e(e,k_e())?new Proxy(e,Jv):e)}function Ac(e){if(e instanceof IDBRequest)return D_e(e);if(Q3.has(e))return Q3.get(e);const t=P_e(e);return t!==e&&(Q3.set(e,t),II.set(t,e)),t}const J3=e=>II.get(e);function F_e(e,t,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(e,t),a=Ac(o);return i&&o.addEventListener("upgradeneeded",l=>{i(Ac(o.result),l.oldVersion,l.newVersion,Ac(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const B_e=["get","getKey","getAll","getAllKeys","count"],z_e=["put","add","delete","clear"],e7=new Map;function fL(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(e7.get(t))return e7.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=z_e.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(r||B_e.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,r?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),r&&l.done]))[0]};return e7.set(t,s),s}N_e(e=>({...e,get:(t,n,i)=>fL(t,n)||e.get(t,n,i),has:(t,n)=>!!fL(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H_e{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(V_e(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function V_e(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const ew="@firebase/app",hL="0.11.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yl=new oW("@firebase/app"),$_e="@firebase/app-compat",G_e="@firebase/analytics-compat",X_e="@firebase/analytics",j_e="@firebase/app-check-compat",Y_e="@firebase/app-check",W_e="@firebase/auth",K_e="@firebase/auth-compat",Z_e="@firebase/database",q_e="@firebase/data-connect",Q_e="@firebase/database-compat",J_e="@firebase/functions",e9e="@firebase/functions-compat",t9e="@firebase/installations",n9e="@firebase/installations-compat",i9e="@firebase/messaging",r9e="@firebase/messaging-compat",s9e="@firebase/performance",o9e="@firebase/performance-compat",a9e="@firebase/remote-config",l9e="@firebase/remote-config-compat",c9e="@firebase/storage",d9e="@firebase/storage-compat",u9e="@firebase/firestore",f9e="@firebase/vertexai",h9e="@firebase/firestore-compat",g9e="firebase",m9e="11.3.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw="[DEFAULT]",p9e={[ew]:"fire-core",[$_e]:"fire-core-compat",[X_e]:"fire-analytics",[G_e]:"fire-analytics-compat",[Y_e]:"fire-app-check",[j_e]:"fire-app-check-compat",[W_e]:"fire-auth",[K_e]:"fire-auth-compat",[Z_e]:"fire-rtdb",[q_e]:"fire-data-connect",[Q_e]:"fire-rtdb-compat",[J_e]:"fire-fn",[e9e]:"fire-fn-compat",[t9e]:"fire-iid",[n9e]:"fire-iid-compat",[i9e]:"fire-fcm",[r9e]:"fire-fcm-compat",[s9e]:"fire-perf",[o9e]:"fire-perf-compat",[a9e]:"fire-rc",[l9e]:"fire-rc-compat",[c9e]:"fire-gcs",[d9e]:"fire-gcs-compat",[u9e]:"fire-fst",[h9e]:"fire-fst-compat",[f9e]:"fire-vertex","fire-js":"fire-js",[g9e]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u5=new Map,U9e=new Map,nw=new Map;function gL(e,t){try{e.container.addComponent(t)}catch(n){yl.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Xm(e){const t=e.name;if(nw.has(t))return yl.debug(`There were multiple attempts to register component ${t}.`),!1;nw.set(t,e);for(const n of u5.values())gL(n,e);for(const n of U9e.values())gL(n,e);return!0}function cW(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function dW(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b9e={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Mc=new sW("app","Firebase",b9e);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y9e{constructor(t,n,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new rg("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Mc.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uW=m9e;function fW(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const i=Object.assign({name:tw,automaticDataCollectionEnabled:!1},t),r=i.name;if(typeof r!="string"||!r)throw Mc.create("bad-app-name",{appName:String(r)});if(n||(n=iW()),!n)throw Mc.create("no-options");const s=u5.get(r);if(s){if(qv(n,s.options)&&qv(i,s.config))return s;throw Mc.create("duplicate-app",{appName:r})}const o=new I_e(r);for(const l of nw.values())o.addComponent(l);const a=new y9e(n,i,o);return u5.set(r,a),a}function hW(e=tw){const t=u5.get(e);if(!t&&e===tw&&iW())return fW();if(!t)throw Mc.create("no-app",{appName:e});return t}function kc(e,t,n){var i;let r=(i=p9e[e])!==null&&i!==void 0?i:e;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const a=[`Unable to register library "${r}" with version "${t}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),yl.warn(a.join(" "));return}Xm(new rg(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E9e="firebase-heartbeat-database",v9e=1,jm="firebase-heartbeat-store";let t7=null;function gW(){return t7||(t7=F_e(E9e,v9e,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(jm)}catch(n){console.warn(n)}}}}).catch(e=>{throw Mc.create("idb-open",{originalErrorMessage:e.message})})),t7}async function w9e(e){try{const n=(await gW()).transaction(jm),i=await n.objectStore(jm).get(mW(e));return await n.done,i}catch(t){if(t instanceof Ku)yl.warn(t.message);else{const n=Mc.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});yl.warn(n.message)}}}async function mL(e,t){try{const i=(await gW()).transaction(jm,"readwrite");await i.objectStore(jm).put(t,mW(e)),await i.done}catch(n){if(n instanceof Ku)yl.warn(n.message);else{const i=Mc.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});yl.warn(i.message)}}}function mW(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _9e=1024,T9e=30;class I9e{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new x9e(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,n;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=pL();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats.length>T9e){const o=C9e(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){yl.warn(i)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=pL(),{heartbeatsToSend:i,unsentEntries:r}=S9e(this._heartbeatsCache.heartbeats),s=d5(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return yl.warn(n),""}}}function pL(){return new Date().toISOString().substring(0,10)}function S9e(e,t=_9e){const n=[];let i=e.slice();for(const r of e){const s=n.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),UL(n)>t){s.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),UL(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class x9e{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return U_e()?b_e().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await w9e(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return mL(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return mL(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...t.heartbeats]})}else return}}function UL(e){return d5(JSON.stringify({version:2,heartbeats:e})).length}function C9e(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let i=1;i<e.length;i++)e[i].date<n&&(n=e[i].date,t=i);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A9e(e){Xm(new rg("platform-logger",t=>new H_e(t),"PRIVATE")),Xm(new rg("heartbeat",t=>new I9e(t),"PRIVATE")),kc(ew,hL,e),kc(ew,hL,"esm2017"),kc("fire-js","")}A9e("");var M9e="firebase",k9e="11.3.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kc(M9e,k9e,"app");var bL=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Rc,pW;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(_,T){function k(){}k.prototype=T.prototype,_.D=T.prototype,_.prototype=new k,_.prototype.constructor=_,_.C=function(x,D,O){for(var L=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)L[Y-2]=arguments[Y];return T.prototype[D].apply(x,L)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(i,n),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(_,T,k){k||(k=0);var x=Array(16);if(typeof T=="string")for(var D=0;16>D;++D)x[D]=T.charCodeAt(k++)|T.charCodeAt(k++)<<8|T.charCodeAt(k++)<<16|T.charCodeAt(k++)<<24;else for(D=0;16>D;++D)x[D]=T[k++]|T[k++]<<8|T[k++]<<16|T[k++]<<24;T=_.g[0],k=_.g[1],D=_.g[2];var O=_.g[3],L=T+(O^k&(D^O))+x[0]+3614090360&4294967295;T=k+(L<<7&4294967295|L>>>25),L=O+(D^T&(k^D))+x[1]+3905402710&4294967295,O=T+(L<<12&4294967295|L>>>20),L=D+(k^O&(T^k))+x[2]+606105819&4294967295,D=O+(L<<17&4294967295|L>>>15),L=k+(T^D&(O^T))+x[3]+3250441966&4294967295,k=D+(L<<22&4294967295|L>>>10),L=T+(O^k&(D^O))+x[4]+4118548399&4294967295,T=k+(L<<7&4294967295|L>>>25),L=O+(D^T&(k^D))+x[5]+1200080426&4294967295,O=T+(L<<12&4294967295|L>>>20),L=D+(k^O&(T^k))+x[6]+2821735955&4294967295,D=O+(L<<17&4294967295|L>>>15),L=k+(T^D&(O^T))+x[7]+4249261313&4294967295,k=D+(L<<22&4294967295|L>>>10),L=T+(O^k&(D^O))+x[8]+1770035416&4294967295,T=k+(L<<7&4294967295|L>>>25),L=O+(D^T&(k^D))+x[9]+2336552879&4294967295,O=T+(L<<12&4294967295|L>>>20),L=D+(k^O&(T^k))+x[10]+4294925233&4294967295,D=O+(L<<17&4294967295|L>>>15),L=k+(T^D&(O^T))+x[11]+2304563134&4294967295,k=D+(L<<22&4294967295|L>>>10),L=T+(O^k&(D^O))+x[12]+1804603682&4294967295,T=k+(L<<7&4294967295|L>>>25),L=O+(D^T&(k^D))+x[13]+4254626195&4294967295,O=T+(L<<12&4294967295|L>>>20),L=D+(k^O&(T^k))+x[14]+2792965006&4294967295,D=O+(L<<17&4294967295|L>>>15),L=k+(T^D&(O^T))+x[15]+1236535329&4294967295,k=D+(L<<22&4294967295|L>>>10),L=T+(D^O&(k^D))+x[1]+4129170786&4294967295,T=k+(L<<5&4294967295|L>>>27),L=O+(k^D&(T^k))+x[6]+3225465664&4294967295,O=T+(L<<9&4294967295|L>>>23),L=D+(T^k&(O^T))+x[11]+643717713&4294967295,D=O+(L<<14&4294967295|L>>>18),L=k+(O^T&(D^O))+x[0]+3921069994&4294967295,k=D+(L<<20&4294967295|L>>>12),L=T+(D^O&(k^D))+x[5]+3593408605&4294967295,T=k+(L<<5&4294967295|L>>>27),L=O+(k^D&(T^k))+x[10]+38016083&4294967295,O=T+(L<<9&4294967295|L>>>23),L=D+(T^k&(O^T))+x[15]+3634488961&4294967295,D=O+(L<<14&4294967295|L>>>18),L=k+(O^T&(D^O))+x[4]+3889429448&4294967295,k=D+(L<<20&4294967295|L>>>12),L=T+(D^O&(k^D))+x[9]+568446438&4294967295,T=k+(L<<5&4294967295|L>>>27),L=O+(k^D&(T^k))+x[14]+3275163606&4294967295,O=T+(L<<9&4294967295|L>>>23),L=D+(T^k&(O^T))+x[3]+4107603335&4294967295,D=O+(L<<14&4294967295|L>>>18),L=k+(O^T&(D^O))+x[8]+1163531501&4294967295,k=D+(L<<20&4294967295|L>>>12),L=T+(D^O&(k^D))+x[13]+2850285829&4294967295,T=k+(L<<5&4294967295|L>>>27),L=O+(k^D&(T^k))+x[2]+4243563512&4294967295,O=T+(L<<9&4294967295|L>>>23),L=D+(T^k&(O^T))+x[7]+1735328473&4294967295,D=O+(L<<14&4294967295|L>>>18),L=k+(O^T&(D^O))+x[12]+2368359562&4294967295,k=D+(L<<20&4294967295|L>>>12),L=T+(k^D^O)+x[5]+4294588738&4294967295,T=k+(L<<4&4294967295|L>>>28),L=O+(T^k^D)+x[8]+2272392833&4294967295,O=T+(L<<11&4294967295|L>>>21),L=D+(O^T^k)+x[11]+1839030562&4294967295,D=O+(L<<16&4294967295|L>>>16),L=k+(D^O^T)+x[14]+4259657740&4294967295,k=D+(L<<23&4294967295|L>>>9),L=T+(k^D^O)+x[1]+2763975236&4294967295,T=k+(L<<4&4294967295|L>>>28),L=O+(T^k^D)+x[4]+1272893353&4294967295,O=T+(L<<11&4294967295|L>>>21),L=D+(O^T^k)+x[7]+4139469664&4294967295,D=O+(L<<16&4294967295|L>>>16),L=k+(D^O^T)+x[10]+3200236656&4294967295,k=D+(L<<23&4294967295|L>>>9),L=T+(k^D^O)+x[13]+681279174&4294967295,T=k+(L<<4&4294967295|L>>>28),L=O+(T^k^D)+x[0]+3936430074&4294967295,O=T+(L<<11&4294967295|L>>>21),L=D+(O^T^k)+x[3]+3572445317&4294967295,D=O+(L<<16&4294967295|L>>>16),L=k+(D^O^T)+x[6]+76029189&4294967295,k=D+(L<<23&4294967295|L>>>9),L=T+(k^D^O)+x[9]+3654602809&4294967295,T=k+(L<<4&4294967295|L>>>28),L=O+(T^k^D)+x[12]+3873151461&4294967295,O=T+(L<<11&4294967295|L>>>21),L=D+(O^T^k)+x[15]+530742520&4294967295,D=O+(L<<16&4294967295|L>>>16),L=k+(D^O^T)+x[2]+3299628645&4294967295,k=D+(L<<23&4294967295|L>>>9),L=T+(D^(k|~O))+x[0]+4096336452&4294967295,T=k+(L<<6&4294967295|L>>>26),L=O+(k^(T|~D))+x[7]+1126891415&4294967295,O=T+(L<<10&4294967295|L>>>22),L=D+(T^(O|~k))+x[14]+2878612391&4294967295,D=O+(L<<15&4294967295|L>>>17),L=k+(O^(D|~T))+x[5]+4237533241&4294967295,k=D+(L<<21&4294967295|L>>>11),L=T+(D^(k|~O))+x[12]+1700485571&4294967295,T=k+(L<<6&4294967295|L>>>26),L=O+(k^(T|~D))+x[3]+2399980690&4294967295,O=T+(L<<10&4294967295|L>>>22),L=D+(T^(O|~k))+x[10]+4293915773&4294967295,D=O+(L<<15&4294967295|L>>>17),L=k+(O^(D|~T))+x[1]+2240044497&4294967295,k=D+(L<<21&4294967295|L>>>11),L=T+(D^(k|~O))+x[8]+1873313359&4294967295,T=k+(L<<6&4294967295|L>>>26),L=O+(k^(T|~D))+x[15]+4264355552&4294967295,O=T+(L<<10&4294967295|L>>>22),L=D+(T^(O|~k))+x[6]+2734768916&4294967295,D=O+(L<<15&4294967295|L>>>17),L=k+(O^(D|~T))+x[13]+1309151649&4294967295,k=D+(L<<21&4294967295|L>>>11),L=T+(D^(k|~O))+x[4]+4149444226&4294967295,T=k+(L<<6&4294967295|L>>>26),L=O+(k^(T|~D))+x[11]+3174756917&4294967295,O=T+(L<<10&4294967295|L>>>22),L=D+(T^(O|~k))+x[2]+718787259&4294967295,D=O+(L<<15&4294967295|L>>>17),L=k+(O^(D|~T))+x[9]+3951481745&4294967295,_.g[0]=_.g[0]+T&4294967295,_.g[1]=_.g[1]+(D+(L<<21&4294967295|L>>>11))&4294967295,_.g[2]=_.g[2]+D&4294967295,_.g[3]=_.g[3]+O&4294967295}i.prototype.u=function(_,T){T===void 0&&(T=_.length);for(var k=T-this.blockSize,x=this.B,D=this.h,O=0;O<T;){if(D==0)for(;O<=k;)r(this,_,O),O+=this.blockSize;if(typeof _=="string"){for(;O<T;)if(x[D++]=_.charCodeAt(O++),D==this.blockSize){r(this,x),D=0;break}}else for(;O<T;)if(x[D++]=_[O++],D==this.blockSize){r(this,x),D=0;break}}this.h=D,this.o+=T},i.prototype.v=function(){var _=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);_[0]=128;for(var T=1;T<_.length-8;++T)_[T]=0;var k=8*this.o;for(T=_.length-8;T<_.length;++T)_[T]=k&255,k/=256;for(this.u(_),_=Array(16),T=k=0;4>T;++T)for(var x=0;32>x;x+=8)_[k++]=this.g[T]>>>x&255;return _};function s(_,T){var k=a;return Object.prototype.hasOwnProperty.call(k,_)?k[_]:k[_]=T(_)}function o(_,T){this.h=T;for(var k=[],x=!0,D=_.length-1;0<=D;D--){var O=_[D]|0;x&&O==T||(k[D]=O,x=!1)}this.g=k}var a={};function l(_){return-128<=_&&128>_?s(_,function(T){return new o([T|0],0>T?-1:0)}):new o([_|0],0>_?-1:0)}function c(_){if(isNaN(_)||!isFinite(_))return u;if(0>_)return U(c(-_));for(var T=[],k=1,x=0;_>=k;x++)T[x]=_/k|0,k*=4294967296;return new o(T,0)}function d(_,T){if(_.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(_.charAt(0)=="-")return U(d(_.substring(1),T));if(0<=_.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=c(Math.pow(T,8)),x=u,D=0;D<_.length;D+=8){var O=Math.min(8,_.length-D),L=parseInt(_.substring(D,D+O),T);8>O?(O=c(Math.pow(T,O)),x=x.j(O).add(c(L))):(x=x.j(k),x=x.add(c(L)))}return x}var u=l(0),f=l(1),h=l(16777216);e=o.prototype,e.m=function(){if(p(this))return-U(this).m();for(var _=0,T=1,k=0;k<this.g.length;k++){var x=this.i(k);_+=(0<=x?x:4294967296+x)*T,T*=4294967296}return _},e.toString=function(_){if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(m(this))return"0";if(p(this))return"-"+U(this).toString(_);for(var T=c(Math.pow(_,6)),k=this,x="";;){var D=v(k,T).g;k=b(k,D.j(T));var O=((0<k.g.length?k.g[0]:k.h)>>>0).toString(_);if(k=D,m(k))return O+x;for(;6>O.length;)O="0"+O;x=O+x}},e.i=function(_){return 0>_?0:_<this.g.length?this.g[_]:this.h};function m(_){if(_.h!=0)return!1;for(var T=0;T<_.g.length;T++)if(_.g[T]!=0)return!1;return!0}function p(_){return _.h==-1}e.l=function(_){return _=b(this,_),p(_)?-1:m(_)?0:1};function U(_){for(var T=_.g.length,k=[],x=0;x<T;x++)k[x]=~_.g[x];return new o(k,~_.h).add(f)}e.abs=function(){return p(this)?U(this):this},e.add=function(_){for(var T=Math.max(this.g.length,_.g.length),k=[],x=0,D=0;D<=T;D++){var O=x+(this.i(D)&65535)+(_.i(D)&65535),L=(O>>>16)+(this.i(D)>>>16)+(_.i(D)>>>16);x=L>>>16,O&=65535,L&=65535,k[D]=L<<16|O}return new o(k,k[k.length-1]&-2147483648?-1:0)};function b(_,T){return _.add(U(T))}e.j=function(_){if(m(this)||m(_))return u;if(p(this))return p(_)?U(this).j(U(_)):U(U(this).j(_));if(p(_))return U(this.j(U(_)));if(0>this.l(h)&&0>_.l(h))return c(this.m()*_.m());for(var T=this.g.length+_.g.length,k=[],x=0;x<2*T;x++)k[x]=0;for(x=0;x<this.g.length;x++)for(var D=0;D<_.g.length;D++){var O=this.i(x)>>>16,L=this.i(x)&65535,Y=_.i(D)>>>16,$=_.i(D)&65535;k[2*x+2*D]+=L*$,y(k,2*x+2*D),k[2*x+2*D+1]+=O*$,y(k,2*x+2*D+1),k[2*x+2*D+1]+=L*Y,y(k,2*x+2*D+1),k[2*x+2*D+2]+=O*Y,y(k,2*x+2*D+2)}for(x=0;x<T;x++)k[x]=k[2*x+1]<<16|k[2*x];for(x=T;x<2*T;x++)k[x]=0;return new o(k,0)};function y(_,T){for(;(_[T]&65535)!=_[T];)_[T+1]+=_[T]>>>16,_[T]&=65535,T++}function w(_,T){this.g=_,this.h=T}function v(_,T){if(m(T))throw Error("division by zero");if(m(_))return new w(u,u);if(p(_))return T=v(U(_),T),new w(U(T.g),U(T.h));if(p(T))return T=v(_,U(T)),new w(U(T.g),T.h);if(30<_.g.length){if(p(_)||p(T))throw Error("slowDivide_ only works with positive integers.");for(var k=f,x=T;0>=x.l(_);)k=I(k),x=I(x);var D=C(k,1),O=C(x,1);for(x=C(x,2),k=C(k,2);!m(x);){var L=O.add(x);0>=L.l(_)&&(D=D.add(k),O=L),x=C(x,1),k=C(k,1)}return T=b(_,D.j(T)),new w(D,T)}for(D=u;0<=_.l(T);){for(k=Math.max(1,Math.floor(_.m()/T.m())),x=Math.ceil(Math.log(k)/Math.LN2),x=48>=x?1:Math.pow(2,x-48),O=c(k),L=O.j(T);p(L)||0<L.l(_);)k-=x,O=c(k),L=O.j(T);m(O)&&(O=f),D=D.add(O),_=b(_,L)}return new w(D,_)}e.A=function(_){return v(this,_).h},e.and=function(_){for(var T=Math.max(this.g.length,_.g.length),k=[],x=0;x<T;x++)k[x]=this.i(x)&_.i(x);return new o(k,this.h&_.h)},e.or=function(_){for(var T=Math.max(this.g.length,_.g.length),k=[],x=0;x<T;x++)k[x]=this.i(x)|_.i(x);return new o(k,this.h|_.h)},e.xor=function(_){for(var T=Math.max(this.g.length,_.g.length),k=[],x=0;x<T;x++)k[x]=this.i(x)^_.i(x);return new o(k,this.h^_.h)};function I(_){for(var T=_.g.length+1,k=[],x=0;x<T;x++)k[x]=_.i(x)<<1|_.i(x-1)>>>31;return new o(k,_.h)}function C(_,T){var k=T>>5;T%=32;for(var x=_.g.length-k,D=[],O=0;O<x;O++)D[O]=0<T?_.i(O+k)>>>T|_.i(O+k+1)<<32-T:_.i(O+k);return new o(D,_.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,pW=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,Rc=o}).apply(typeof bL<"u"?bL:typeof self<"u"?self:typeof window<"u"?window:{});var f2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var UW,Q1,bW,db,iw,yW,EW,vW;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(E,A,P){return E==Array.prototype||E==Object.prototype||(E[A]=P.value),E};function n(E){E=[typeof globalThis=="object"&&globalThis,E,typeof window=="object"&&window,typeof self=="object"&&self,typeof f2=="object"&&f2];for(var A=0;A<E.length;++A){var P=E[A];if(P&&P.Math==Math)return P}throw Error("Cannot find global object")}var i=n(this);function r(E,A){if(A)e:{var P=i;E=E.split(".");for(var B=0;B<E.length-1;B++){var q=E[B];if(!(q in P))break e;P=P[q]}E=E[E.length-1],B=P[E],A=A(B),A!=B&&A!=null&&t(P,E,{configurable:!0,writable:!0,value:A})}}function s(E,A){E instanceof String&&(E+="");var P=0,B=!1,q={next:function(){if(!B&&P<E.length){var ee=P++;return{value:A(ee,E[ee]),done:!1}}return B=!0,{done:!0,value:void 0}}};return q[Symbol.iterator]=function(){return q},q}r("Array.prototype.values",function(E){return E||function(){return s(this,function(A,P){return P})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(E){var A=typeof E;return A=A!="object"?A:E?Array.isArray(E)?"array":A:"null",A=="array"||A=="object"&&typeof E.length=="number"}function c(E){var A=typeof E;return A=="object"&&E!=null||A=="function"}function d(E,A,P){return E.call.apply(E.bind,arguments)}function u(E,A,P){if(!E)throw Error();if(2<arguments.length){var B=Array.prototype.slice.call(arguments,2);return function(){var q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(q,B),E.apply(A,q)}}return function(){return E.apply(A,arguments)}}function f(E,A,P){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:u,f.apply(null,arguments)}function h(E,A){var P=Array.prototype.slice.call(arguments,1);return function(){var B=P.slice();return B.push.apply(B,arguments),E.apply(this,B)}}function m(E,A){function P(){}P.prototype=A.prototype,E.aa=A.prototype,E.prototype=new P,E.prototype.constructor=E,E.Qb=function(B,q,ee){for(var Ue=Array(arguments.length-2),Gt=2;Gt<arguments.length;Gt++)Ue[Gt-2]=arguments[Gt];return A.prototype[q].apply(B,Ue)}}function p(E){const A=E.length;if(0<A){const P=Array(A);for(let B=0;B<A;B++)P[B]=E[B];return P}return[]}function U(E,A){for(let P=1;P<arguments.length;P++){const B=arguments[P];if(l(B)){const q=E.length||0,ee=B.length||0;E.length=q+ee;for(let Ue=0;Ue<ee;Ue++)E[q+Ue]=B[Ue]}else E.push(B)}}class b{constructor(A,P){this.i=A,this.j=P,this.h=0,this.g=null}get(){let A;return 0<this.h?(this.h--,A=this.g,this.g=A.next,A.next=null):A=this.i(),A}}function y(E){return/^[\s\xa0]*$/.test(E)}function w(){var E=a.navigator;return E&&(E=E.userAgent)?E:""}function v(E){return v[" "](E),E}v[" "]=function(){};var I=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function C(E,A,P){for(const B in E)A.call(P,E[B],B,E)}function _(E,A){for(const P in E)A.call(void 0,E[P],P,E)}function T(E){const A={};for(const P in E)A[P]=E[P];return A}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(E,A){let P,B;for(let q=1;q<arguments.length;q++){B=arguments[q];for(P in B)E[P]=B[P];for(let ee=0;ee<k.length;ee++)P=k[ee],Object.prototype.hasOwnProperty.call(B,P)&&(E[P]=B[P])}}function D(E){var A=1;E=E.split(":");const P=[];for(;0<A&&E.length;)P.push(E.shift()),A--;return E.length&&P.push(E.join(":")),P}function O(E){a.setTimeout(()=>{throw E},0)}function L(){var E=j;let A=null;return E.g&&(A=E.g,E.g=E.g.next,E.g||(E.h=null),A.next=null),A}class Y{constructor(){this.h=this.g=null}add(A,P){const B=$.get();B.set(A,P),this.h?this.h.next=B:this.g=B,this.h=B}}var $=new b(()=>new H,E=>E.reset());class H{constructor(){this.next=this.g=this.h=null}set(A,P){this.h=A,this.g=P,this.next=null}reset(){this.next=this.g=this.h=null}}let z,G=!1,j=new Y,X=()=>{const E=a.Promise.resolve(void 0);z=()=>{E.then(K)}};var K=()=>{for(var E;E=L();){try{E.h.call(E.g)}catch(P){O(P)}var A=$;A.j(E),100>A.h&&(A.h++,E.next=A.g,A.g=E)}G=!1};function ne(){this.s=this.s,this.C=this.C}ne.prototype.s=!1,ne.prototype.ma=function(){this.s||(this.s=!0,this.N())},ne.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function se(E,A){this.type=E,this.g=this.target=A,this.defaultPrevented=!1}se.prototype.h=function(){this.defaultPrevented=!0};var oe=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var E=!1,A=Object.defineProperty({},"passive",{get:function(){E=!0}});try{const P=()=>{};a.addEventListener("test",P,A),a.removeEventListener("test",P,A)}catch{}return E}();function Ee(E,A){if(se.call(this,E?E.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,E){var P=this.type=E.type,B=E.changedTouches&&E.changedTouches.length?E.changedTouches[0]:null;if(this.target=E.target||E.srcElement,this.g=A,A=E.relatedTarget){if(I){e:{try{v(A.nodeName);var q=!0;break e}catch{}q=!1}q||(A=null)}}else P=="mouseover"?A=E.fromElement:P=="mouseout"&&(A=E.toElement);this.relatedTarget=A,B?(this.clientX=B.clientX!==void 0?B.clientX:B.pageX,this.clientY=B.clientY!==void 0?B.clientY:B.pageY,this.screenX=B.screenX||0,this.screenY=B.screenY||0):(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0),this.button=E.button,this.key=E.key||"",this.ctrlKey=E.ctrlKey,this.altKey=E.altKey,this.shiftKey=E.shiftKey,this.metaKey=E.metaKey,this.pointerId=E.pointerId||0,this.pointerType=typeof E.pointerType=="string"?E.pointerType:Re[E.pointerType]||"",this.state=E.state,this.i=E,E.defaultPrevented&&Ee.aa.h.call(this)}}m(Ee,se);var Re={2:"touch",3:"pen",4:"mouse"};Ee.prototype.h=function(){Ee.aa.h.call(this);var E=this.i;E.preventDefault?E.preventDefault():E.returnValue=!1};var De="closure_listenable_"+(1e6*Math.random()|0),vt=0;function Vt(E,A,P,B,q){this.listener=E,this.proxy=null,this.src=A,this.type=P,this.capture=!!B,this.ha=q,this.key=++vt,this.da=this.fa=!1}function Be(E){E.da=!0,E.listener=null,E.proxy=null,E.src=null,E.ha=null}function Qe(E){this.src=E,this.g={},this.h=0}Qe.prototype.add=function(E,A,P,B,q){var ee=E.toString();E=this.g[ee],E||(E=this.g[ee]=[],this.h++);var Ue=li(E,A,B,q);return-1<Ue?(A=E[Ue],P||(A.fa=!1)):(A=new Vt(A,this.src,ee,!!B,q),A.fa=P,E.push(A)),A};function $t(E,A){var P=A.type;if(P in E.g){var B=E.g[P],q=Array.prototype.indexOf.call(B,A,void 0),ee;(ee=0<=q)&&Array.prototype.splice.call(B,q,1),ee&&(Be(A),E.g[P].length==0&&(delete E.g[P],E.h--))}}function li(E,A,P,B){for(var q=0;q<E.length;++q){var ee=E[q];if(!ee.da&&ee.listener==A&&ee.capture==!!P&&ee.ha==B)return q}return-1}var Al="closure_lm_"+(1e6*Math.random()|0),zg={};function qp(E,A,P,B,q){if(Array.isArray(A)){for(var ee=0;ee<A.length;ee++)qp(E,A[ee],P,B,q);return null}return P=hS(P),E&&E[De]?E.K(A,P,c(B)?!!B.capture:!1,q):EE(E,A,P,!1,B,q)}function EE(E,A,P,B,q,ee){if(!A)throw Error("Invalid event type");var Ue=c(q)?!!q.capture:!!q,Gt=_E(E);if(Gt||(E[Al]=Gt=new Qe(E)),P=Gt.add(A,P,B,Ue,ee),P.proxy)return P;if(B=vE(),P.proxy=B,B.src=E,B.listener=P,E.addEventListener)oe||(q=Ue),q===void 0&&(q=!1),E.addEventListener(A.toString(),B,q);else if(E.attachEvent)E.attachEvent(fS(A.toString()),B);else if(E.addListener&&E.removeListener)E.addListener(B);else throw Error("addEventListener and attachEvent are unavailable.");return P}function vE(){function E(P){return A.call(E.src,E.listener,P)}const A=hZ;return E}function fd(E,A,P,B,q){if(Array.isArray(A))for(var ee=0;ee<A.length;ee++)fd(E,A[ee],P,B,q);else B=c(B)?!!B.capture:!!B,P=hS(P),E&&E[De]?(E=E.i,A=String(A).toString(),A in E.g&&(ee=E.g[A],P=li(ee,P,B,q),-1<P&&(Be(ee[P]),Array.prototype.splice.call(ee,P,1),ee.length==0&&(delete E.g[A],E.h--)))):E&&(E=_E(E))&&(A=E.g[A.toString()],E=-1,A&&(E=li(A,P,B,q)),(P=-1<E?A[E]:null)&&wE(P))}function wE(E){if(typeof E!="number"&&E&&!E.da){var A=E.src;if(A&&A[De])$t(A.i,E);else{var P=E.type,B=E.proxy;A.removeEventListener?A.removeEventListener(P,B,E.capture):A.detachEvent?A.detachEvent(fS(P),B):A.addListener&&A.removeListener&&A.removeListener(B),(P=_E(A))?($t(P,E),P.h==0&&(P.src=null,A[Al]=null)):Be(E)}}}function fS(E){return E in zg?zg[E]:zg[E]="on"+E}function hZ(E,A){if(E.da)E=!0;else{A=new Ee(A,this);var P=E.listener,B=E.ha||E.src;E.fa&&wE(E),E=P.call(B,A)}return E}function _E(E){return E=E[Al],E instanceof Qe?E:null}var TE="__closure_events_fn_"+(1e9*Math.random()>>>0);function hS(E){return typeof E=="function"?E:(E[TE]||(E[TE]=function(A){return E.handleEvent(A)}),E[TE])}function Oi(){ne.call(this),this.i=new Qe(this),this.M=this,this.F=null}m(Oi,ne),Oi.prototype[De]=!0,Oi.prototype.removeEventListener=function(E,A,P,B){fd(this,E,A,P,B)};function tr(E,A){var P,B=E.F;if(B)for(P=[];B;B=B.F)P.push(B);if(E=E.M,B=A.type||A,typeof A=="string")A=new se(A,E);else if(A instanceof se)A.target=A.target||E;else{var q=A;A=new se(B,E),x(A,q)}if(q=!0,P)for(var ee=P.length-1;0<=ee;ee--){var Ue=A.g=P[ee];q=Qp(Ue,B,!0,A)&&q}if(Ue=A.g=E,q=Qp(Ue,B,!0,A)&&q,q=Qp(Ue,B,!1,A)&&q,P)for(ee=0;ee<P.length;ee++)Ue=A.g=P[ee],q=Qp(Ue,B,!1,A)&&q}Oi.prototype.N=function(){if(Oi.aa.N.call(this),this.i){var E=this.i,A;for(A in E.g){for(var P=E.g[A],B=0;B<P.length;B++)Be(P[B]);delete E.g[A],E.h--}}this.F=null},Oi.prototype.K=function(E,A,P,B){return this.i.add(String(E),A,!1,P,B)},Oi.prototype.L=function(E,A,P,B){return this.i.add(String(E),A,!0,P,B)};function Qp(E,A,P,B){if(A=E.i.g[String(A)],!A)return!0;A=A.concat();for(var q=!0,ee=0;ee<A.length;++ee){var Ue=A[ee];if(Ue&&!Ue.da&&Ue.capture==P){var Gt=Ue.listener,Ti=Ue.ha||Ue.src;Ue.fa&&$t(E.i,Ue),q=Gt.call(Ti,B)!==!1&&q}}return q&&!B.defaultPrevented}function gS(E,A,P){if(typeof E=="function")P&&(E=f(E,P));else if(E&&typeof E.handleEvent=="function")E=f(E.handleEvent,E);else throw Error("Invalid listener argument");return 2147483647<Number(A)?-1:a.setTimeout(E,A||0)}function mS(E){E.g=gS(()=>{E.g=null,E.i&&(E.i=!1,mS(E))},E.l);const A=E.h;E.h=null,E.m.apply(null,A)}class gZ extends ne{constructor(A,P){super(),this.m=A,this.l=P,this.h=null,this.i=!1,this.g=null}j(A){this.h=arguments,this.g?this.i=!0:mS(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Hg(E){ne.call(this),this.h=E,this.g={}}m(Hg,ne);var pS=[];function US(E){C(E.g,function(A,P){this.g.hasOwnProperty(P)&&wE(A)},E),E.g={}}Hg.prototype.N=function(){Hg.aa.N.call(this),US(this)},Hg.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var IE=a.JSON.stringify,mZ=a.JSON.parse,pZ=class{stringify(E){return a.JSON.stringify(E,void 0)}parse(E){return a.JSON.parse(E,void 0)}};function SE(){}SE.prototype.h=null;function bS(E){return E.h||(E.h=E.i())}function yS(){}var Vg={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function xE(){se.call(this,"d")}m(xE,se);function CE(){se.call(this,"c")}m(CE,se);var hd={},ES=null;function Jp(){return ES=ES||new Oi}hd.La="serverreachability";function vS(E){se.call(this,hd.La,E)}m(vS,se);function $g(E){const A=Jp();tr(A,new vS(A))}hd.STAT_EVENT="statevent";function wS(E,A){se.call(this,hd.STAT_EVENT,E),this.stat=A}m(wS,se);function nr(E){const A=Jp();tr(A,new wS(A,E))}hd.Ma="timingevent";function _S(E,A){se.call(this,hd.Ma,E),this.size=A}m(_S,se);function Gg(E,A){if(typeof E!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){E()},A)}function Xg(){this.g=!0}Xg.prototype.xa=function(){this.g=!1};function UZ(E,A,P,B,q,ee){E.info(function(){if(E.g)if(ee)for(var Ue="",Gt=ee.split("&"),Ti=0;Ti<Gt.length;Ti++){var wt=Gt[Ti].split("=");if(1<wt.length){var Pi=wt[0];wt=wt[1];var Fi=Pi.split("_");Ue=2<=Fi.length&&Fi[1]=="type"?Ue+(Pi+"="+wt+"&"):Ue+(Pi+"=redacted&")}}else Ue=null;else Ue=ee;return"XMLHTTP REQ ("+B+") [attempt "+q+"]: "+A+`
`+P+`
`+Ue})}function bZ(E,A,P,B,q,ee,Ue){E.info(function(){return"XMLHTTP RESP ("+B+") [ attempt "+q+"]: "+A+`
`+P+`
`+ee+" "+Ue})}function ef(E,A,P,B){E.info(function(){return"XMLHTTP TEXT ("+A+"): "+EZ(E,P)+(B?" "+B:"")})}function yZ(E,A){E.info(function(){return"TIMEOUT: "+A})}Xg.prototype.info=function(){};function EZ(E,A){if(!E.g)return A;if(!A)return null;try{var P=JSON.parse(A);if(P){for(E=0;E<P.length;E++)if(Array.isArray(P[E])){var B=P[E];if(!(2>B.length)){var q=B[1];if(Array.isArray(q)&&!(1>q.length)){var ee=q[0];if(ee!="noop"&&ee!="stop"&&ee!="close")for(var Ue=1;Ue<q.length;Ue++)q[Ue]=""}}}}return IE(P)}catch{return A}}var eU={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},TS={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},AE;function tU(){}m(tU,SE),tU.prototype.g=function(){return new XMLHttpRequest},tU.prototype.i=function(){return{}},AE=new tU;function Ml(E,A,P,B){this.j=E,this.i=A,this.l=P,this.R=B||1,this.U=new Hg(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new IS}function IS(){this.i=null,this.g="",this.h=!1}var SS={},ME={};function kE(E,A,P){E.L=1,E.v=sU(ha(A)),E.m=P,E.P=!0,xS(E,null)}function xS(E,A){E.F=Date.now(),nU(E),E.A=ha(E.v);var P=E.A,B=E.R;Array.isArray(B)||(B=[String(B)]),HS(P.i,"t",B),E.C=0,P=E.j.J,E.h=new IS,E.g=sx(E.j,P?A:null,!E.m),0<E.O&&(E.M=new gZ(f(E.Y,E,E.g),E.O)),A=E.U,P=E.g,B=E.ca;var q="readystatechange";Array.isArray(q)||(q&&(pS[0]=q.toString()),q=pS);for(var ee=0;ee<q.length;ee++){var Ue=qp(P,q[ee],B||A.handleEvent,!1,A.h||A);if(!Ue)break;A.g[Ue.key]=Ue}A=E.H?T(E.H):{},E.m?(E.u||(E.u="POST"),A["Content-Type"]="application/x-www-form-urlencoded",E.g.ea(E.A,E.u,E.m,A)):(E.u="GET",E.g.ea(E.A,E.u,null,A)),$g(),UZ(E.i,E.u,E.A,E.l,E.R,E.m)}Ml.prototype.ca=function(E){E=E.target;const A=this.M;A&&ga(E)==3?A.j():this.Y(E)},Ml.prototype.Y=function(E){try{if(E==this.g)e:{const Fi=ga(this.g);var A=this.g.Ba();const rf=this.g.Z();if(!(3>Fi)&&(Fi!=3||this.g&&(this.h.h||this.g.oa()||WS(this.g)))){this.J||Fi!=4||A==7||(A==8||0>=rf?$g(3):$g(2)),RE(this);var P=this.g.Z();this.X=P;t:if(CS(this)){var B=WS(this.g);E="";var q=B.length,ee=ga(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){gd(this),jg(this);var Ue="";break t}this.h.i=new a.TextDecoder}for(A=0;A<q;A++)this.h.h=!0,E+=this.h.i.decode(B[A],{stream:!(ee&&A==q-1)});B.length=0,this.h.g+=E,this.C=0,Ue=this.h.g}else Ue=this.g.oa();if(this.o=P==200,bZ(this.i,this.u,this.A,this.l,this.R,Fi,P),this.o){if(this.T&&!this.K){t:{if(this.g){var Gt,Ti=this.g;if((Gt=Ti.g?Ti.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(Gt)){var wt=Gt;break t}}wt=null}if(P=wt)ef(this.i,this.l,P,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,DE(this,P);else{this.o=!1,this.s=3,nr(12),gd(this),jg(this);break e}}if(this.P){P=!0;let Bs;for(;!this.J&&this.C<Ue.length;)if(Bs=vZ(this,Ue),Bs==ME){Fi==4&&(this.s=4,nr(14),P=!1),ef(this.i,this.l,null,"[Incomplete Response]");break}else if(Bs==SS){this.s=4,nr(15),ef(this.i,this.l,Ue,"[Invalid Chunk]"),P=!1;break}else ef(this.i,this.l,Bs,null),DE(this,Bs);if(CS(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Fi!=4||Ue.length!=0||this.h.h||(this.s=1,nr(16),P=!1),this.o=this.o&&P,!P)ef(this.i,this.l,Ue,"[Invalid Chunked Response]"),gd(this),jg(this);else if(0<Ue.length&&!this.W){this.W=!0;var Pi=this.j;Pi.g==this&&Pi.ba&&!Pi.M&&(Pi.j.info("Great, no buffering proxy detected. Bytes received: "+Ue.length),BE(Pi),Pi.M=!0,nr(11))}}else ef(this.i,this.l,Ue,null),DE(this,Ue);Fi==4&&gd(this),this.o&&!this.J&&(Fi==4?tx(this.j,this):(this.o=!1,nU(this)))}else FZ(this.g),P==400&&0<Ue.indexOf("Unknown SID")?(this.s=3,nr(12)):(this.s=0,nr(13)),gd(this),jg(this)}}}catch{}finally{}};function CS(E){return E.g?E.u=="GET"&&E.L!=2&&E.j.Ca:!1}function vZ(E,A){var P=E.C,B=A.indexOf(`
`,P);return B==-1?ME:(P=Number(A.substring(P,B)),isNaN(P)?SS:(B+=1,B+P>A.length?ME:(A=A.slice(B,B+P),E.C=B+P,A)))}Ml.prototype.cancel=function(){this.J=!0,gd(this)};function nU(E){E.S=Date.now()+E.I,AS(E,E.I)}function AS(E,A){if(E.B!=null)throw Error("WatchDog timer not null");E.B=Gg(f(E.ba,E),A)}function RE(E){E.B&&(a.clearTimeout(E.B),E.B=null)}Ml.prototype.ba=function(){this.B=null;const E=Date.now();0<=E-this.S?(yZ(this.i,this.A),this.L!=2&&($g(),nr(17)),gd(this),this.s=2,jg(this)):AS(this,this.S-E)};function jg(E){E.j.G==0||E.J||tx(E.j,E)}function gd(E){RE(E);var A=E.M;A&&typeof A.ma=="function"&&A.ma(),E.M=null,US(E.U),E.g&&(A=E.g,E.g=null,A.abort(),A.ma())}function DE(E,A){try{var P=E.j;if(P.G!=0&&(P.g==E||LE(P.h,E))){if(!E.K&&LE(P.h,E)&&P.G==3){try{var B=P.Da.g.parse(A)}catch{B=null}if(Array.isArray(B)&&B.length==3){var q=B;if(q[0]==0){e:if(!P.u){if(P.g)if(P.g.F+3e3<E.F)uU(P),cU(P);else break e;FE(P),nr(18)}}else P.za=q[1],0<P.za-P.T&&37500>q[2]&&P.F&&P.v==0&&!P.C&&(P.C=Gg(f(P.Za,P),6e3));if(1>=RS(P.h)&&P.ca){try{P.ca()}catch{}P.ca=void 0}}else pd(P,11)}else if((E.K||P.g==E)&&uU(P),!y(A))for(q=P.Da.g.parse(A),A=0;A<q.length;A++){let wt=q[A];if(P.T=wt[0],wt=wt[1],P.G==2)if(wt[0]=="c"){P.K=wt[1],P.ia=wt[2];const Pi=wt[3];Pi!=null&&(P.la=Pi,P.j.info("VER="+P.la));const Fi=wt[4];Fi!=null&&(P.Aa=Fi,P.j.info("SVER="+P.Aa));const rf=wt[5];rf!=null&&typeof rf=="number"&&0<rf&&(B=1.5*rf,P.L=B,P.j.info("backChannelRequestTimeoutMs_="+B)),B=P;const Bs=E.g;if(Bs){const hU=Bs.g?Bs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(hU){var ee=B.h;ee.g||hU.indexOf("spdy")==-1&&hU.indexOf("quic")==-1&&hU.indexOf("h2")==-1||(ee.j=ee.l,ee.g=new Set,ee.h&&(NE(ee,ee.h),ee.h=null))}if(B.D){const zE=Bs.g?Bs.g.getResponseHeader("X-HTTP-Session-Id"):null;zE&&(B.ya=zE,Jt(B.I,B.D,zE))}}P.G=3,P.l&&P.l.ua(),P.ba&&(P.R=Date.now()-E.F,P.j.info("Handshake RTT: "+P.R+"ms")),B=P;var Ue=E;if(B.qa=rx(B,B.J?B.ia:null,B.W),Ue.K){DS(B.h,Ue);var Gt=Ue,Ti=B.L;Ti&&(Gt.I=Ti),Gt.B&&(RE(Gt),nU(Gt)),B.g=Ue}else JS(B);0<P.i.length&&dU(P)}else wt[0]!="stop"&&wt[0]!="close"||pd(P,7);else P.G==3&&(wt[0]=="stop"||wt[0]=="close"?wt[0]=="stop"?pd(P,7):PE(P):wt[0]!="noop"&&P.l&&P.l.ta(wt),P.v=0)}}$g(4)}catch{}}var wZ=class{constructor(E,A){this.g=E,this.map=A}};function MS(E){this.l=E||10,a.PerformanceNavigationTiming?(E=a.performance.getEntriesByType("navigation"),E=0<E.length&&(E[0].nextHopProtocol=="hq"||E[0].nextHopProtocol=="h2")):E=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=E?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function kS(E){return E.h?!0:E.g?E.g.size>=E.j:!1}function RS(E){return E.h?1:E.g?E.g.size:0}function LE(E,A){return E.h?E.h==A:E.g?E.g.has(A):!1}function NE(E,A){E.g?E.g.add(A):E.h=A}function DS(E,A){E.h&&E.h==A?E.h=null:E.g&&E.g.has(A)&&E.g.delete(A)}MS.prototype.cancel=function(){if(this.i=LS(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const E of this.g.values())E.cancel();this.g.clear()}};function LS(E){if(E.h!=null)return E.i.concat(E.h.D);if(E.g!=null&&E.g.size!==0){let A=E.i;for(const P of E.g.values())A=A.concat(P.D);return A}return p(E.i)}function _Z(E){if(E.V&&typeof E.V=="function")return E.V();if(typeof Map<"u"&&E instanceof Map||typeof Set<"u"&&E instanceof Set)return Array.from(E.values());if(typeof E=="string")return E.split("");if(l(E)){for(var A=[],P=E.length,B=0;B<P;B++)A.push(E[B]);return A}A=[],P=0;for(B in E)A[P++]=E[B];return A}function TZ(E){if(E.na&&typeof E.na=="function")return E.na();if(!E.V||typeof E.V!="function"){if(typeof Map<"u"&&E instanceof Map)return Array.from(E.keys());if(!(typeof Set<"u"&&E instanceof Set)){if(l(E)||typeof E=="string"){var A=[];E=E.length;for(var P=0;P<E;P++)A.push(P);return A}A=[],P=0;for(const B in E)A[P++]=B;return A}}}function NS(E,A){if(E.forEach&&typeof E.forEach=="function")E.forEach(A,void 0);else if(l(E)||typeof E=="string")Array.prototype.forEach.call(E,A,void 0);else for(var P=TZ(E),B=_Z(E),q=B.length,ee=0;ee<q;ee++)A.call(void 0,B[ee],P&&P[ee],E)}var OS=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function IZ(E,A){if(E){E=E.split("&");for(var P=0;P<E.length;P++){var B=E[P].indexOf("="),q=null;if(0<=B){var ee=E[P].substring(0,B);q=E[P].substring(B+1)}else ee=E[P];A(ee,q?decodeURIComponent(q.replace(/\+/g," ")):"")}}}function md(E){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,E instanceof md){this.h=E.h,iU(this,E.j),this.o=E.o,this.g=E.g,rU(this,E.s),this.l=E.l;var A=E.i,P=new Kg;P.i=A.i,A.g&&(P.g=new Map(A.g),P.h=A.h),PS(this,P),this.m=E.m}else E&&(A=String(E).match(OS))?(this.h=!1,iU(this,A[1]||"",!0),this.o=Yg(A[2]||""),this.g=Yg(A[3]||"",!0),rU(this,A[4]),this.l=Yg(A[5]||"",!0),PS(this,A[6]||"",!0),this.m=Yg(A[7]||"")):(this.h=!1,this.i=new Kg(null,this.h))}md.prototype.toString=function(){var E=[],A=this.j;A&&E.push(Wg(A,FS,!0),":");var P=this.g;return(P||A=="file")&&(E.push("//"),(A=this.o)&&E.push(Wg(A,FS,!0),"@"),E.push(encodeURIComponent(String(P)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),P=this.s,P!=null&&E.push(":",String(P))),(P=this.l)&&(this.g&&P.charAt(0)!="/"&&E.push("/"),E.push(Wg(P,P.charAt(0)=="/"?CZ:xZ,!0))),(P=this.i.toString())&&E.push("?",P),(P=this.m)&&E.push("#",Wg(P,MZ)),E.join("")};function ha(E){return new md(E)}function iU(E,A,P){E.j=P?Yg(A,!0):A,E.j&&(E.j=E.j.replace(/:$/,""))}function rU(E,A){if(A){if(A=Number(A),isNaN(A)||0>A)throw Error("Bad port number "+A);E.s=A}else E.s=null}function PS(E,A,P){A instanceof Kg?(E.i=A,kZ(E.i,E.h)):(P||(A=Wg(A,AZ)),E.i=new Kg(A,E.h))}function Jt(E,A,P){E.i.set(A,P)}function sU(E){return Jt(E,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),E}function Yg(E,A){return E?A?decodeURI(E.replace(/%25/g,"%2525")):decodeURIComponent(E):""}function Wg(E,A,P){return typeof E=="string"?(E=encodeURI(E).replace(A,SZ),P&&(E=E.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E):null}function SZ(E){return E=E.charCodeAt(0),"%"+(E>>4&15).toString(16)+(E&15).toString(16)}var FS=/[#\/\?@]/g,xZ=/[#\?:]/g,CZ=/[#\?]/g,AZ=/[#\?@]/g,MZ=/#/g;function Kg(E,A){this.h=this.g=null,this.i=E||null,this.j=!!A}function kl(E){E.g||(E.g=new Map,E.h=0,E.i&&IZ(E.i,function(A,P){E.add(decodeURIComponent(A.replace(/\+/g," ")),P)}))}e=Kg.prototype,e.add=function(E,A){kl(this),this.i=null,E=tf(this,E);var P=this.g.get(E);return P||this.g.set(E,P=[]),P.push(A),this.h+=1,this};function BS(E,A){kl(E),A=tf(E,A),E.g.has(A)&&(E.i=null,E.h-=E.g.get(A).length,E.g.delete(A))}function zS(E,A){return kl(E),A=tf(E,A),E.g.has(A)}e.forEach=function(E,A){kl(this),this.g.forEach(function(P,B){P.forEach(function(q){E.call(A,q,B,this)},this)},this)},e.na=function(){kl(this);const E=Array.from(this.g.values()),A=Array.from(this.g.keys()),P=[];for(let B=0;B<A.length;B++){const q=E[B];for(let ee=0;ee<q.length;ee++)P.push(A[B])}return P},e.V=function(E){kl(this);let A=[];if(typeof E=="string")zS(this,E)&&(A=A.concat(this.g.get(tf(this,E))));else{E=Array.from(this.g.values());for(let P=0;P<E.length;P++)A=A.concat(E[P])}return A},e.set=function(E,A){return kl(this),this.i=null,E=tf(this,E),zS(this,E)&&(this.h-=this.g.get(E).length),this.g.set(E,[A]),this.h+=1,this},e.get=function(E,A){return E?(E=this.V(E),0<E.length?String(E[0]):A):A};function HS(E,A,P){BS(E,A),0<P.length&&(E.i=null,E.g.set(tf(E,A),p(P)),E.h+=P.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const E=[],A=Array.from(this.g.keys());for(var P=0;P<A.length;P++){var B=A[P];const ee=encodeURIComponent(String(B)),Ue=this.V(B);for(B=0;B<Ue.length;B++){var q=ee;Ue[B]!==""&&(q+="="+encodeURIComponent(String(Ue[B]))),E.push(q)}}return this.i=E.join("&")};function tf(E,A){return A=String(A),E.j&&(A=A.toLowerCase()),A}function kZ(E,A){A&&!E.j&&(kl(E),E.i=null,E.g.forEach(function(P,B){var q=B.toLowerCase();B!=q&&(BS(this,B),HS(this,q,P))},E)),E.j=A}function RZ(E,A){const P=new Xg;if(a.Image){const B=new Image;B.onload=h(Rl,P,"TestLoadImage: loaded",!0,A,B),B.onerror=h(Rl,P,"TestLoadImage: error",!1,A,B),B.onabort=h(Rl,P,"TestLoadImage: abort",!1,A,B),B.ontimeout=h(Rl,P,"TestLoadImage: timeout",!1,A,B),a.setTimeout(function(){B.ontimeout&&B.ontimeout()},1e4),B.src=E}else A(!1)}function DZ(E,A){const P=new Xg,B=new AbortController,q=setTimeout(()=>{B.abort(),Rl(P,"TestPingServer: timeout",!1,A)},1e4);fetch(E,{signal:B.signal}).then(ee=>{clearTimeout(q),ee.ok?Rl(P,"TestPingServer: ok",!0,A):Rl(P,"TestPingServer: server error",!1,A)}).catch(()=>{clearTimeout(q),Rl(P,"TestPingServer: error",!1,A)})}function Rl(E,A,P,B,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),B(P)}catch{}}function LZ(){this.g=new pZ}function NZ(E,A,P){const B=P||"";try{NS(E,function(q,ee){let Ue=q;c(q)&&(Ue=IE(q)),A.push(B+ee+"="+encodeURIComponent(Ue))})}catch(q){throw A.push(B+"type="+encodeURIComponent("_badmap")),q}}function oU(E){this.l=E.Ub||null,this.j=E.eb||!1}m(oU,SE),oU.prototype.g=function(){return new aU(this.l,this.j)},oU.prototype.i=function(E){return function(){return E}}({});function aU(E,A){Oi.call(this),this.D=E,this.o=A,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(aU,Oi),e=aU.prototype,e.open=function(E,A){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=E,this.A=A,this.readyState=1,qg(this)},e.send=function(E){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const A={headers:this.u,method:this.B,credentials:this.m,cache:void 0};E&&(A.body=E),(this.D||a).fetch(new Request(this.A,A)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Zg(this)),this.readyState=0},e.Sa=function(E){if(this.g&&(this.l=E,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=E.headers,this.readyState=2,qg(this)),this.g&&(this.readyState=3,qg(this),this.g)))if(this.responseType==="arraybuffer")E.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in E){if(this.j=E.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;VS(this)}else E.text().then(this.Ra.bind(this),this.ga.bind(this))};function VS(E){E.j.read().then(E.Pa.bind(E)).catch(E.ga.bind(E))}e.Pa=function(E){if(this.g){if(this.o&&E.value)this.response.push(E.value);else if(!this.o){var A=E.value?E.value:new Uint8Array(0);(A=this.v.decode(A,{stream:!E.done}))&&(this.response=this.responseText+=A)}E.done?Zg(this):qg(this),this.readyState==3&&VS(this)}},e.Ra=function(E){this.g&&(this.response=this.responseText=E,Zg(this))},e.Qa=function(E){this.g&&(this.response=E,Zg(this))},e.ga=function(){this.g&&Zg(this)};function Zg(E){E.readyState=4,E.l=null,E.j=null,E.v=null,qg(E)}e.setRequestHeader=function(E,A){this.u.append(E,A)},e.getResponseHeader=function(E){return this.h&&this.h.get(E.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const E=[],A=this.h.entries();for(var P=A.next();!P.done;)P=P.value,E.push(P[0]+": "+P[1]),P=A.next();return E.join(`\r
`)};function qg(E){E.onreadystatechange&&E.onreadystatechange.call(E)}Object.defineProperty(aU.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(E){this.m=E?"include":"same-origin"}});function $S(E){let A="";return C(E,function(P,B){A+=B,A+=":",A+=P,A+=`\r
`}),A}function OE(E,A,P){e:{for(B in P){var B=!1;break e}B=!0}B||(P=$S(P),typeof E=="string"?P!=null&&encodeURIComponent(String(P)):Jt(E,A,P))}function En(E){Oi.call(this),this.headers=new Map,this.o=E||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(En,Oi);var OZ=/^https?$/i,PZ=["POST","PUT"];e=En.prototype,e.Ha=function(E){this.J=E},e.ea=function(E,A,P,B){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+E);A=A?A.toUpperCase():"GET",this.D=E,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():AE.g(),this.v=this.o?bS(this.o):bS(AE),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(A,String(E),!0),this.B=!1}catch(ee){GS(this,ee);return}if(E=P||"",P=new Map(this.headers),B)if(Object.getPrototypeOf(B)===Object.prototype)for(var q in B)P.set(q,B[q]);else if(typeof B.keys=="function"&&typeof B.get=="function")for(const ee of B.keys())P.set(ee,B.get(ee));else throw Error("Unknown input type for opt_headers: "+String(B));B=Array.from(P.keys()).find(ee=>ee.toLowerCase()=="content-type"),q=a.FormData&&E instanceof a.FormData,!(0<=Array.prototype.indexOf.call(PZ,A,void 0))||B||q||P.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ee,Ue]of P)this.g.setRequestHeader(ee,Ue);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{YS(this),this.u=!0,this.g.send(E),this.u=!1}catch(ee){GS(this,ee)}};function GS(E,A){E.h=!1,E.g&&(E.j=!0,E.g.abort(),E.j=!1),E.l=A,E.m=5,XS(E),lU(E)}function XS(E){E.A||(E.A=!0,tr(E,"complete"),tr(E,"error"))}e.abort=function(E){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=E||7,tr(this,"complete"),tr(this,"abort"),lU(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),lU(this,!0)),En.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?jS(this):this.bb())},e.bb=function(){jS(this)};function jS(E){if(E.h&&typeof o<"u"&&(!E.v[1]||ga(E)!=4||E.Z()!=2)){if(E.u&&ga(E)==4)gS(E.Ea,0,E);else if(tr(E,"readystatechange"),ga(E)==4){E.h=!1;try{const Ue=E.Z();e:switch(Ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var A=!0;break e;default:A=!1}var P;if(!(P=A)){var B;if(B=Ue===0){var q=String(E.D).match(OS)[1]||null;!q&&a.self&&a.self.location&&(q=a.self.location.protocol.slice(0,-1)),B=!OZ.test(q?q.toLowerCase():"")}P=B}if(P)tr(E,"complete"),tr(E,"success");else{E.m=6;try{var ee=2<ga(E)?E.g.statusText:""}catch{ee=""}E.l=ee+" ["+E.Z()+"]",XS(E)}}finally{lU(E)}}}}function lU(E,A){if(E.g){YS(E);const P=E.g,B=E.v[0]?()=>{}:null;E.g=null,E.v=null,A||tr(E,"ready");try{P.onreadystatechange=B}catch{}}}function YS(E){E.I&&(a.clearTimeout(E.I),E.I=null)}e.isActive=function(){return!!this.g};function ga(E){return E.g?E.g.readyState:0}e.Z=function(){try{return 2<ga(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(E){if(this.g){var A=this.g.responseText;return E&&A.indexOf(E)==0&&(A=A.substring(E.length)),mZ(A)}};function WS(E){try{if(!E.g)return null;if("response"in E.g)return E.g.response;switch(E.H){case"":case"text":return E.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in E.g)return E.g.mozResponseArrayBuffer}return null}catch{return null}}function FZ(E){const A={};E=(E.g&&2<=ga(E)&&E.g.getAllResponseHeaders()||"").split(`\r
`);for(let B=0;B<E.length;B++){if(y(E[B]))continue;var P=D(E[B]);const q=P[0];if(P=P[1],typeof P!="string")continue;P=P.trim();const ee=A[q]||[];A[q]=ee,ee.push(P)}_(A,function(B){return B.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Qg(E,A,P){return P&&P.internalChannelParams&&P.internalChannelParams[E]||A}function KS(E){this.Aa=0,this.i=[],this.j=new Xg,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Qg("failFast",!1,E),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Qg("baseRetryDelayMs",5e3,E),this.cb=Qg("retryDelaySeedMs",1e4,E),this.Wa=Qg("forwardChannelMaxRetries",2,E),this.wa=Qg("forwardChannelRequestTimeoutMs",2e4,E),this.pa=E&&E.xmlHttpFactory||void 0,this.Xa=E&&E.Tb||void 0,this.Ca=E&&E.useFetchStreams||!1,this.L=void 0,this.J=E&&E.supportsCrossDomainXhr||!1,this.K="",this.h=new MS(E&&E.concurrentRequestLimit),this.Da=new LZ,this.P=E&&E.fastHandshake||!1,this.O=E&&E.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=E&&E.Rb||!1,E&&E.xa&&this.j.xa(),E&&E.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&E&&E.detectBufferingProxy||!1,this.ja=void 0,E&&E.longPollingTimeout&&0<E.longPollingTimeout&&(this.ja=E.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=KS.prototype,e.la=8,e.G=1,e.connect=function(E,A,P,B){nr(0),this.W=E,this.H=A||{},P&&B!==void 0&&(this.H.OSID=P,this.H.OAID=B),this.F=this.X,this.I=rx(this,null,this.W),dU(this)};function PE(E){if(ZS(E),E.G==3){var A=E.U++,P=ha(E.I);if(Jt(P,"SID",E.K),Jt(P,"RID",A),Jt(P,"TYPE","terminate"),Jg(E,P),A=new Ml(E,E.j,A),A.L=2,A.v=sU(ha(P)),P=!1,a.navigator&&a.navigator.sendBeacon)try{P=a.navigator.sendBeacon(A.v.toString(),"")}catch{}!P&&a.Image&&(new Image().src=A.v,P=!0),P||(A.g=sx(A.j,null),A.g.ea(A.v)),A.F=Date.now(),nU(A)}ix(E)}function cU(E){E.g&&(BE(E),E.g.cancel(),E.g=null)}function ZS(E){cU(E),E.u&&(a.clearTimeout(E.u),E.u=null),uU(E),E.h.cancel(),E.s&&(typeof E.s=="number"&&a.clearTimeout(E.s),E.s=null)}function dU(E){if(!kS(E.h)&&!E.s){E.s=!0;var A=E.Ga;z||X(),G||(z(),G=!0),j.add(A,E),E.B=0}}function BZ(E,A){return RS(E.h)>=E.h.j-(E.s?1:0)?!1:E.s?(E.i=A.D.concat(E.i),!0):E.G==1||E.G==2||E.B>=(E.Va?0:E.Wa)?!1:(E.s=Gg(f(E.Ga,E,A),nx(E,E.B)),E.B++,!0)}e.Ga=function(E){if(this.s)if(this.s=null,this.G==1){if(!E){this.U=Math.floor(1e5*Math.random()),E=this.U++;const q=new Ml(this,this.j,E);let ee=this.o;if(this.S&&(ee?(ee=T(ee),x(ee,this.S)):ee=this.S),this.m!==null||this.O||(q.H=ee,ee=null),this.P)e:{for(var A=0,P=0;P<this.i.length;P++){t:{var B=this.i[P];if("__data__"in B.map&&(B=B.map.__data__,typeof B=="string")){B=B.length;break t}B=void 0}if(B===void 0)break;if(A+=B,4096<A){A=P;break e}if(A===4096||P===this.i.length-1){A=P+1;break e}}A=1e3}else A=1e3;A=QS(this,q,A),P=ha(this.I),Jt(P,"RID",E),Jt(P,"CVER",22),this.D&&Jt(P,"X-HTTP-Session-Id",this.D),Jg(this,P),ee&&(this.O?A="headers="+encodeURIComponent(String($S(ee)))+"&"+A:this.m&&OE(P,this.m,ee)),NE(this.h,q),this.Ua&&Jt(P,"TYPE","init"),this.P?(Jt(P,"$req",A),Jt(P,"SID","null"),q.T=!0,kE(q,P,null)):kE(q,P,A),this.G=2}}else this.G==3&&(E?qS(this,E):this.i.length==0||kS(this.h)||qS(this))};function qS(E,A){var P;A?P=A.l:P=E.U++;const B=ha(E.I);Jt(B,"SID",E.K),Jt(B,"RID",P),Jt(B,"AID",E.T),Jg(E,B),E.m&&E.o&&OE(B,E.m,E.o),P=new Ml(E,E.j,P,E.B+1),E.m===null&&(P.H=E.o),A&&(E.i=A.D.concat(E.i)),A=QS(E,P,1e3),P.I=Math.round(.5*E.wa)+Math.round(.5*E.wa*Math.random()),NE(E.h,P),kE(P,B,A)}function Jg(E,A){E.H&&C(E.H,function(P,B){Jt(A,B,P)}),E.l&&NS({},function(P,B){Jt(A,B,P)})}function QS(E,A,P){P=Math.min(E.i.length,P);var B=E.l?f(E.l.Na,E.l,E):null;e:{var q=E.i;let ee=-1;for(;;){const Ue=["count="+P];ee==-1?0<P?(ee=q[0].g,Ue.push("ofs="+ee)):ee=0:Ue.push("ofs="+ee);let Gt=!0;for(let Ti=0;Ti<P;Ti++){let wt=q[Ti].g;const Pi=q[Ti].map;if(wt-=ee,0>wt)ee=Math.max(0,q[Ti].g-100),Gt=!1;else try{NZ(Pi,Ue,"req"+wt+"_")}catch{B&&B(Pi)}}if(Gt){B=Ue.join("&");break e}}}return E=E.i.splice(0,P),A.D=E,B}function JS(E){if(!E.g&&!E.u){E.Y=1;var A=E.Fa;z||X(),G||(z(),G=!0),j.add(A,E),E.v=0}}function FE(E){return E.g||E.u||3<=E.v?!1:(E.Y++,E.u=Gg(f(E.Fa,E),nx(E,E.v)),E.v++,!0)}e.Fa=function(){if(this.u=null,ex(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var E=2*this.R;this.j.info("BP detection timer enabled: "+E),this.A=Gg(f(this.ab,this),E)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,nr(10),cU(this),ex(this))};function BE(E){E.A!=null&&(a.clearTimeout(E.A),E.A=null)}function ex(E){E.g=new Ml(E,E.j,"rpc",E.Y),E.m===null&&(E.g.H=E.o),E.g.O=0;var A=ha(E.qa);Jt(A,"RID","rpc"),Jt(A,"SID",E.K),Jt(A,"AID",E.T),Jt(A,"CI",E.F?"0":"1"),!E.F&&E.ja&&Jt(A,"TO",E.ja),Jt(A,"TYPE","xmlhttp"),Jg(E,A),E.m&&E.o&&OE(A,E.m,E.o),E.L&&(E.g.I=E.L);var P=E.g;E=E.ia,P.L=1,P.v=sU(ha(A)),P.m=null,P.P=!0,xS(P,E)}e.Za=function(){this.C!=null&&(this.C=null,cU(this),FE(this),nr(19))};function uU(E){E.C!=null&&(a.clearTimeout(E.C),E.C=null)}function tx(E,A){var P=null;if(E.g==A){uU(E),BE(E),E.g=null;var B=2}else if(LE(E.h,A))P=A.D,DS(E.h,A),B=1;else return;if(E.G!=0){if(A.o)if(B==1){P=A.m?A.m.length:0,A=Date.now()-A.F;var q=E.B;B=Jp(),tr(B,new _S(B,P)),dU(E)}else JS(E);else if(q=A.s,q==3||q==0&&0<A.X||!(B==1&&BZ(E,A)||B==2&&FE(E)))switch(P&&0<P.length&&(A=E.h,A.i=A.i.concat(P)),q){case 1:pd(E,5);break;case 4:pd(E,10);break;case 3:pd(E,6);break;default:pd(E,2)}}}function nx(E,A){let P=E.Ta+Math.floor(Math.random()*E.cb);return E.isActive()||(P*=2),P*A}function pd(E,A){if(E.j.info("Error code "+A),A==2){var P=f(E.fb,E),B=E.Xa;const q=!B;B=new md(B||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||iU(B,"https"),sU(B),q?RZ(B.toString(),P):DZ(B.toString(),P)}else nr(2);E.G=0,E.l&&E.l.sa(A),ix(E),ZS(E)}e.fb=function(E){E?(this.j.info("Successfully pinged google.com"),nr(2)):(this.j.info("Failed to ping google.com"),nr(1))};function ix(E){if(E.G=0,E.ka=[],E.l){const A=LS(E.h);(A.length!=0||E.i.length!=0)&&(U(E.ka,A),U(E.ka,E.i),E.h.i.length=0,p(E.i),E.i.length=0),E.l.ra()}}function rx(E,A,P){var B=P instanceof md?ha(P):new md(P);if(B.g!="")A&&(B.g=A+"."+B.g),rU(B,B.s);else{var q=a.location;B=q.protocol,A=A?A+"."+q.hostname:q.hostname,q=+q.port;var ee=new md(null);B&&iU(ee,B),A&&(ee.g=A),q&&rU(ee,q),P&&(ee.l=P),B=ee}return P=E.D,A=E.ya,P&&A&&Jt(B,P,A),Jt(B,"VER",E.la),Jg(E,B),B}function sx(E,A,P){if(A&&!E.J)throw Error("Can't create secondary domain capable XhrIo object.");return A=E.Ca&&!E.pa?new En(new oU({eb:P})):new En(E.pa),A.Ha(E.J),A}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function ox(){}e=ox.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function fU(){}fU.prototype.g=function(E,A){return new Nr(E,A)};function Nr(E,A){Oi.call(this),this.g=new KS(A),this.l=E,this.h=A&&A.messageUrlParams||null,E=A&&A.messageHeaders||null,A&&A.clientProtocolHeaderRequired&&(E?E["X-Client-Protocol"]="webchannel":E={"X-Client-Protocol":"webchannel"}),this.g.o=E,E=A&&A.initMessageHeaders||null,A&&A.messageContentType&&(E?E["X-WebChannel-Content-Type"]=A.messageContentType:E={"X-WebChannel-Content-Type":A.messageContentType}),A&&A.va&&(E?E["X-WebChannel-Client-Profile"]=A.va:E={"X-WebChannel-Client-Profile":A.va}),this.g.S=E,(E=A&&A.Sb)&&!y(E)&&(this.g.m=E),this.v=A&&A.supportsCrossDomainXhr||!1,this.u=A&&A.sendRawJson||!1,(A=A&&A.httpSessionIdParam)&&!y(A)&&(this.g.D=A,E=this.h,E!==null&&A in E&&(E=this.h,A in E&&delete E[A])),this.j=new nf(this)}m(Nr,Oi),Nr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Nr.prototype.close=function(){PE(this.g)},Nr.prototype.o=function(E){var A=this.g;if(typeof E=="string"){var P={};P.__data__=E,E=P}else this.u&&(P={},P.__data__=IE(E),E=P);A.i.push(new wZ(A.Ya++,E)),A.G==3&&dU(A)},Nr.prototype.N=function(){this.g.l=null,delete this.j,PE(this.g),delete this.g,Nr.aa.N.call(this)};function ax(E){xE.call(this),E.__headers__&&(this.headers=E.__headers__,this.statusCode=E.__status__,delete E.__headers__,delete E.__status__);var A=E.__sm__;if(A){e:{for(const P in A){E=P;break e}E=void 0}(this.i=E)&&(E=this.i,A=A!==null&&E in A?A[E]:void 0),this.data=A}else this.data=E}m(ax,xE);function lx(){CE.call(this),this.status=1}m(lx,CE);function nf(E){this.g=E}m(nf,ox),nf.prototype.ua=function(){tr(this.g,"a")},nf.prototype.ta=function(E){tr(this.g,new ax(E))},nf.prototype.sa=function(E){tr(this.g,new lx)},nf.prototype.ra=function(){tr(this.g,"b")},fU.prototype.createWebChannel=fU.prototype.g,Nr.prototype.send=Nr.prototype.o,Nr.prototype.open=Nr.prototype.m,Nr.prototype.close=Nr.prototype.close,vW=function(){return new fU},EW=function(){return Jp()},yW=hd,iw={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},eU.NO_ERROR=0,eU.TIMEOUT=8,eU.HTTP_ERROR=6,db=eU,TS.COMPLETE="complete",bW=TS,yS.EventType=Vg,Vg.OPEN="a",Vg.CLOSE="b",Vg.ERROR="c",Vg.MESSAGE="d",Oi.prototype.listen=Oi.prototype.K,Q1=yS,En.prototype.listenOnce=En.prototype.L,En.prototype.getLastError=En.prototype.Ka,En.prototype.getLastErrorCode=En.prototype.Ba,En.prototype.getStatus=En.prototype.Z,En.prototype.getResponseJson=En.prototype.Oa,En.prototype.getResponseText=En.prototype.oa,En.prototype.send=En.prototype.ea,En.prototype.setWithCredentials=En.prototype.Ha,UW=En}).apply(typeof f2<"u"?f2:typeof self<"u"?self:typeof window<"u"?window:{});const yL="@firebase/firestore",EL="4.7.8";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}$i.UNAUTHENTICATED=new $i(null),$i.GOOGLE_CREDENTIALS=new $i("google-credentials-uid"),$i.FIRST_PARTY=new $i("first-party-uid"),$i.MOCK_USER=new $i("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Og="11.3.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ku=new oW("@firebase/firestore");function Sf(){return ku.logLevel}function _e(e,...t){if(ku.logLevel<=ut.DEBUG){const n=t.map(SI);ku.debug(`Firestore (${Og}): ${e}`,...n)}}function El(e,...t){if(ku.logLevel<=ut.ERROR){const n=t.map(SI);ku.error(`Firestore (${Og}): ${e}`,...n)}}function sg(e,...t){if(ku.logLevel<=ut.WARN){const n=t.map(SI);ku.warn(`Firestore (${Og}): ${e}`,...n)}}function SI(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oe(e="Unexpected state"){const t=`FIRESTORE (${Og}) INTERNAL ASSERTION FAILED: `+e;throw El(t),new Error(t)}function jt(e,t){e||Oe()}function rt(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ae extends Ku{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wW{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class R9e{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n($i.UNAUTHENTICATED))}shutdown(){}}class D9e{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class L9e{constructor(t){this.t=t,this.currentUser=$i.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){jt(this.o===void 0);let i=this.i;const r=l=>this.i!==i?(i=this.i,n(l)):Promise.resolve();let s=new Dc;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Dc,t.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const l=s;t.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{_e("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(_e("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Dc)}},0),o()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(i=>this.i!==t?(_e("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(jt(typeof i.accessToken=="string"),new wW(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return jt(t===null||typeof t=="string"),new $i(t)}}class N9e{constructor(t,n,i){this.l=t,this.h=n,this.P=i,this.type="FirstParty",this.user=$i.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.T.set("Authorization",t),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class O9e{constructor(t,n,i){this.l=t,this.h=n,this.P=i}getToken(){return Promise.resolve(new N9e(this.l,this.h,this.P))}start(t,n){t.enqueueRetryable(()=>n($i.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class vL{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class P9e{constructor(t,n){this.A=n,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,dW(t)&&t.settings.appCheckToken&&(this.V=t.settings.appCheckToken)}start(t,n){jt(this.o===void 0);const i=s=>{s.error!=null&&_e("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,_e("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>i(s))};const r=s=>{_e("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?r(s):_e("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new vL(this.V));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(jt(typeof n.token=="string"),this.R=n.token,new vL(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F9e(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let i=0;i<e;i++)n[i]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _W{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=F9e(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<n&&(i+=t.charAt(r[s]%62))}return i}}function ft(e,t){return e<t?-1:e>t?1:0}function og(e,t,n){return e.length===t.length&&e.every((i,r)=>n(i,t[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wL=-62135596800,_L=1e6;class wi{static now(){return wi.fromMillis(Date.now())}static fromDate(t){return wi.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),i=Math.floor((t-1e3*n)*_L);return new wi(n,i)}constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new Ae(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Ae(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<wL)throw new Ae(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ae(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/_L}_compareTo(t){return this.seconds===t.seconds?ft(this.nanoseconds,t.nanoseconds):ft(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds-wL;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ze{static fromTimestamp(t){return new ze(t)}static min(){return new ze(new wi(0,0))}static max(){return new ze(new wi(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TL="__name__";class Ro{constructor(t,n,i){n===void 0?n=0:n>t.length&&Oe(),i===void 0?i=t.length-n:i>t.length-n&&Oe(),this.segments=t,this.offset=n,this.len=i}get length(){return this.len}isEqual(t){return Ro.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof Ro?t.forEach(i=>{n.push(i)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,i=this.limit();n<i;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const i=Math.min(t.length,n.length);for(let r=0;r<i;r++){const s=Ro.compareSegments(t.get(r),n.get(r));if(s!==0)return s}return Math.sign(t.length-n.length)}static compareSegments(t,n){const i=Ro.isNumericId(t),r=Ro.isNumericId(n);return i&&!r?-1:!i&&r?1:i&&r?Ro.extractNumericId(t).compare(Ro.extractNumericId(n)):t<n?-1:t>n?1:0}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Rc.fromString(t.substring(4,t.length-2))}}class cn extends Ro{construct(t,n,i){return new cn(t,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const n=[];for(const i of t){if(i.indexOf("//")>=0)throw new Ae(ae.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter(r=>r.length>0))}return new cn(n)}static emptyPath(){return new cn([])}}const B9e=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ji extends Ro{construct(t,n,i){return new ji(t,n,i)}static isValidIdentifier(t){return B9e.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ji.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===TL}static keyField(){return new ji([TL])}static fromServerFormat(t){const n=[];let i="",r=0;const s=()=>{if(i.length===0)throw new Ae(ae.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let o=!1;for(;r<t.length;){const a=t[r];if(a==="\\"){if(r+1===t.length)throw new Ae(ae.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Ae(ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=l,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new Ae(ae.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ji(n)}static emptyPath(){return new ji([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(t){this.path=t}static fromPath(t){return new Pe(cn.fromString(t))}static fromName(t){return new Pe(cn.fromString(t).popFirst(5))}static empty(){return new Pe(cn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&cn.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return cn.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Pe(new cn(t.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ym=-1;function z9e(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,r=ze.fromTimestamp(i===1e9?new wi(n+1,0):new wi(n,i));return new qc(r,Pe.empty(),t)}function H9e(e){return new qc(e.readTime,e.key,Ym)}class qc{constructor(t,n,i){this.readTime=t,this.documentKey=n,this.largestBatchId=i}static min(){return new qc(ze.min(),Pe.empty(),Ym)}static max(){return new qc(ze.max(),Pe.empty(),Ym)}}function V9e(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=Pe.comparator(e.documentKey,t.documentKey),n!==0?n:ft(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $9e="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class G9e{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oE(e){if(e.code!==ae.FAILED_PRECONDITION||e.message!==$9e)throw e;_e("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&Oe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new re((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(n,s).next(i,r)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof re?n:re.resolve(n)}catch(n){return re.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):re.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):re.reject(n)}static resolve(t){return new re((n,i)=>{n(t)})}static reject(t){return new re((n,i)=>{i(t)})}static waitFor(t){return new re((n,i)=>{let r=0,s=0,o=!1;t.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&n()},l=>i(l))}),o=!0,s===r&&n()})}static or(t){let n=re.resolve(!1);for(const i of t)n=n.next(r=>r?re.resolve(r):i());return n}static forEach(t,n){const i=[];return t.forEach((r,s)=>{i.push(n.call(this,r,s))}),this.waitFor(i)}static mapArray(t,n){return new re((i,r)=>{const s=t.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const c=l;n(t[c]).next(d=>{o[c]=d,++a,a===s&&i(o)},d=>r(d))}})}static doWhile(t,n){return new re((i,r)=>{const s=()=>{t()===!0?n().next(()=>{s()},r):i()};s()})}}function X9e(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Pg(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.oe(i),this._e=i=>n.writeSequenceNumber(i))}oe(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this._e&&this._e(t),t}}aE.ae=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j9e=-1;function jp(e){return e==null}function f5(e){return e===0&&1/e==-1/0}function Y9e(e){return typeof e=="number"&&Number.isInteger(e)&&!f5(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TW="";function W9e(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=IL(t)),t=K9e(e.get(n),t);return IL(t)}function K9e(e,t){let n=t;const i=e.length;for(let r=0;r<i;r++){const s=e.charAt(r);switch(s){case"\0":n+="";break;case TW:n+="";break;default:n+=s}}return n}function IL(e){return e+TW+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SL(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Zu(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function IW(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(t,n){this.comparator=t,this.root=n||Ai.EMPTY}insert(t,n){return new Ln(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Ai.BLACK,null,null))}remove(t){return new Ln(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Ai.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(t){let n=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(t,i.key);if(r===0)return n+i.left.size;r<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,i)=>(t(n,i),!1))}toString(){const t=[];return this.inorderTraversal((n,i)=>(t.push(`${n}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new h2(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new h2(this.root,t,this.comparator,!1)}getReverseIterator(){return new h2(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new h2(this.root,t,this.comparator,!0)}}class h2{constructor(t,n,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=n?i(t.key,n):1,n&&r&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Ai{constructor(t,n,i,r,s){this.key=t,this.value=n,this.color=i??Ai.RED,this.left=r??Ai.EMPTY,this.right=s??Ai.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,i,r,s){return new Ai(t??this.key,n??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,i){let r=this;const s=i(t,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(t,n,i),null):s===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(t,n,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Ai.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let i,r=this;if(n(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(t,r.key)===0){if(r.right.isEmpty())return Ai.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Ai.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Ai.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Oe();const t=this.left.check();if(t!==this.right.check())throw Oe();return t+(this.isRed()?0:1)}}Ai.EMPTY=null,Ai.RED=!0,Ai.BLACK=!1;Ai.EMPTY=new class{constructor(){this.size=0}get key(){throw Oe()}get value(){throw Oe()}get color(){throw Oe()}get left(){throw Oe()}get right(){throw Oe()}copy(t,n,i,r,s){return this}insert(t,n,i){return new Ai(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(t){this.comparator=t,this.data=new Ln(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,i)=>(t(n),!1))}forEachInRange(t,n){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,t[1])>=0)return;n(r.key)}}forEachWhile(t,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new xL(this.data.getIterator())}getIteratorFrom(t){return new xL(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(i=>{n=n.add(i)}),n}isEqual(t){if(!(t instanceof ii)||this.size!==t.size)return!1;const n=this.data.getIterator(),i=t.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new ii(this.comparator);return n.data=t,n}}class xL{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(t){this.fields=t,t.sort(ji.comparator)}static empty(){return new Ss([])}unionWith(t){let n=new ii(ji.comparator);for(const i of this.fields)n=n.add(i);for(const i of t)n=n.add(i);return new Ss(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return og(this.fields,t.fields,(n,i)=>n.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SW extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new SW("Invalid base64 string: "+s):s}}(t);return new Ni(n)}static fromUint8Array(t){const n=function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s}(t);return new Ni(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const i=new Uint8Array(n.length);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return ft(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Ni.EMPTY_BYTE_STRING=new Ni("");const Z9e=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qc(e){if(jt(!!e),typeof e=="string"){let t=0;const n=Z9e.exec(e);if(jt(!!n),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:kn(e.seconds),nanos:kn(e.nanos)}}function kn(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Jc(e){return typeof e=="string"?Ni.fromBase64String(e):Ni.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xW="server_timestamp",CW="__type__",AW="__previous_value__",MW="__local_write_time__";function xI(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[CW])===null||n===void 0?void 0:n.stringValue)===xW}function lE(e){const t=e.mapValue.fields[AW];return xI(t)?lE(t):t}function Wm(e){const t=Qc(e.mapValue.fields[MW].timestampValue);return new wi(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q9e{constructor(t,n,i,r,s,o,a,l,c){this.databaseId=t,this.appId=n,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}const h5="(default)";class Km{constructor(t,n){this.projectId=t,this.database=n||h5}static empty(){return new Km("","")}get isDefaultDatabase(){return this.database===h5}isEqual(t){return t instanceof Km&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kW="__type__",Q9e="__max__",g2={mapValue:{}},RW="__vector__",g5="value";function ed(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?xI(e)?4:eTe(e)?9007199254740991:J9e(e)?10:11:Oe()}function oa(e,t){if(e===t)return!0;const n=ed(e);if(n!==ed(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Wm(e).isEqual(Wm(t));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=Qc(r.timestampValue),a=Qc(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(r,s){return Jc(r.bytesValue).isEqual(Jc(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(r,s){return kn(r.geoPointValue.latitude)===kn(s.geoPointValue.latitude)&&kn(r.geoPointValue.longitude)===kn(s.geoPointValue.longitude)}(e,t);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return kn(r.integerValue)===kn(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=kn(r.doubleValue),a=kn(s.doubleValue);return o===a?f5(o)===f5(a):isNaN(o)&&isNaN(a)}return!1}(e,t);case 9:return og(e.arrayValue.values||[],t.arrayValue.values||[],oa);case 10:case 11:return function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(SL(o)!==SL(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!oa(o[l],a[l])))return!1;return!0}(e,t);default:return Oe()}}function Zm(e,t){return(e.values||[]).find(n=>oa(n,t))!==void 0}function ag(e,t){if(e===t)return 0;const n=ed(e),i=ed(t);if(n!==i)return ft(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return ft(e.booleanValue,t.booleanValue);case 2:return function(s,o){const a=kn(s.integerValue||s.doubleValue),l=kn(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(e,t);case 3:return CL(e.timestampValue,t.timestampValue);case 4:return CL(Wm(e),Wm(t));case 5:return ft(e.stringValue,t.stringValue);case 6:return function(s,o){const a=Jc(s),l=Jc(o);return a.compareTo(l)}(e.bytesValue,t.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const d=ft(a[c],l[c]);if(d!==0)return d}return ft(a.length,l.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,o){const a=ft(kn(s.latitude),kn(o.latitude));return a!==0?a:ft(kn(s.longitude),kn(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return AL(e.arrayValue,t.arrayValue);case 10:return function(s,o){var a,l,c,d;const u=s.fields||{},f=o.fields||{},h=(a=u[g5])===null||a===void 0?void 0:a.arrayValue,m=(l=f[g5])===null||l===void 0?void 0:l.arrayValue,p=ft(((c=h==null?void 0:h.values)===null||c===void 0?void 0:c.length)||0,((d=m==null?void 0:m.values)===null||d===void 0?void 0:d.length)||0);return p!==0?p:AL(h,m)}(e.mapValue,t.mapValue);case 11:return function(s,o){if(s===g2.mapValue&&o===g2.mapValue)return 0;if(s===g2.mapValue)return 1;if(o===g2.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),c=o.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let u=0;u<l.length&&u<d.length;++u){const f=ft(l[u],d[u]);if(f!==0)return f;const h=ag(a[l[u]],c[d[u]]);if(h!==0)return h}return ft(l.length,d.length)}(e.mapValue,t.mapValue);default:throw Oe()}}function CL(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return ft(e,t);const n=Qc(e),i=Qc(t),r=ft(n.seconds,i.seconds);return r!==0?r:ft(n.nanos,i.nanos)}function AL(e,t){const n=e.values||[],i=t.values||[];for(let r=0;r<n.length&&r<i.length;++r){const s=ag(n[r],i[r]);if(s)return s}return ft(n.length,i.length)}function lg(e){return rw(e)}function rw(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){const i=Qc(n);return`time(${i.seconds},${i.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return Jc(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return Pe.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let i="[",r=!0;for(const s of n.values||[])r?r=!1:i+=",",i+=rw(s);return i+"]"}(e.arrayValue):"mapValue"in e?function(n){const i=Object.keys(n.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${rw(n.fields[o])}`;return r+"}"}(e.mapValue):Oe()}function ub(e){switch(ed(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=lE(e);return t?16+ub(t):16;case 5:return 2*e.stringValue.length;case 6:return Jc(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((r,s)=>r+ub(s),0)}(e.arrayValue);case 10:case 11:return function(i){let r=0;return Zu(i.fields,(s,o)=>{r+=s.length+ub(o)}),r}(e.mapValue);default:throw Oe()}}function sw(e){return!!e&&"integerValue"in e}function CI(e){return!!e&&"arrayValue"in e}function ML(e){return!!e&&"nullValue"in e}function kL(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function n7(e){return!!e&&"mapValue"in e}function J9e(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[kW])===null||n===void 0?void 0:n.stringValue)===RW}function z0(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Zu(e.mapValue.fields,(n,i)=>t.mapValue.fields[n]=z0(i)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=z0(e.arrayValue.values[n]);return t}return Object.assign({},e)}function eTe(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Q9e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(t){this.value=t}static empty(){return new _r({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let i=0;i<t.length-1;++i)if(n=(n.mapValue.fields||{})[t.get(i)],!n7(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=z0(n)}setAll(t){let n=ji.emptyPath(),i={},r=[];t.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,i,r),i={},r=[],n=a.popLast()}o?i[a.lastSegment()]=z0(o):r.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,i,r)}delete(t){const n=this.field(t.popLast());n7(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return oa(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<t.length;++i){let r=n.mapValue.fields[t.get(i)];n7(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[t.get(i)]=r),n=r}return n.mapValue.fields}applyChanges(t,n,i){Zu(n,(r,s)=>t[r]=s);for(const r of i)delete t[r]}clone(){return new _r(z0(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(t,n,i,r,s,o,a){this.key=t,this.documentType=n,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(t){return new Ui(t,0,ze.min(),ze.min(),ze.min(),_r.empty(),0)}static newFoundDocument(t,n,i,r){return new Ui(t,1,n,ze.min(),i,r,0)}static newNoDocument(t,n){return new Ui(t,2,n,ze.min(),ze.min(),_r.empty(),0)}static newUnknownDocument(t,n){return new Ui(t,3,n,ze.min(),ze.min(),_r.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(ze.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=_r.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=_r.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ze.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Ui&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Ui(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m5{constructor(t,n){this.position=t,this.inclusive=n}}function RL(e,t,n){let i=0;for(let r=0;r<e.position.length;r++){const s=t[r],o=e.position[r];if(s.field.isKeyField()?i=Pe.comparator(Pe.fromName(o.referenceValue),n.key):i=ag(o,n.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function DL(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!oa(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p5{constructor(t,n="asc"){this.field=t,this.dir=n}}function tTe(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DW{}class ni extends DW{constructor(t,n,i){super(),this.field=t,this.op=n,this.value=i}static create(t,n,i){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,i):new iTe(t,n,i):n==="array-contains"?new oTe(t,i):n==="in"?new aTe(t,i):n==="not-in"?new lTe(t,i):n==="array-contains-any"?new cTe(t,i):new ni(t,n,i)}static createKeyFieldInFilter(t,n,i){return n==="in"?new rTe(t,i):new sTe(t,i)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ag(n,this.value)):n!==null&&ed(this.value)===ed(n)&&this.matchesComparison(ag(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Oe()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class aa extends DW{constructor(t,n){super(),this.filters=t,this.op=n,this.ce=null}static create(t,n){return new aa(t,n)}matches(t){return LW(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function LW(e){return e.op==="and"}function NW(e){return nTe(e)&&LW(e)}function nTe(e){for(const t of e.filters)if(t instanceof aa)return!1;return!0}function ow(e){if(e instanceof ni)return e.field.canonicalString()+e.op.toString()+lg(e.value);if(NW(e))return e.filters.map(t=>ow(t)).join(",");{const t=e.filters.map(n=>ow(n)).join(",");return`${e.op}(${t})`}}function OW(e,t){return e instanceof ni?function(i,r){return r instanceof ni&&i.op===r.op&&i.field.isEqual(r.field)&&oa(i.value,r.value)}(e,t):e instanceof aa?function(i,r){return r instanceof aa&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((s,o,a)=>s&&OW(o,r.filters[a]),!0):!1}(e,t):void Oe()}function PW(e){return e instanceof ni?function(n){return`${n.field.canonicalString()} ${n.op} ${lg(n.value)}`}(e):e instanceof aa?function(n){return n.op.toString()+" {"+n.getFilters().map(PW).join(" ,")+"}"}(e):"Filter"}class iTe extends ni{constructor(t,n,i){super(t,n,i),this.key=Pe.fromName(i.referenceValue)}matches(t){const n=Pe.comparator(t.key,this.key);return this.matchesComparison(n)}}class rTe extends ni{constructor(t,n){super(t,"in",n),this.keys=FW("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class sTe extends ni{constructor(t,n){super(t,"not-in",n),this.keys=FW("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function FW(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(i=>Pe.fromName(i.referenceValue))}class oTe extends ni{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return CI(n)&&Zm(n.arrayValue,this.value)}}class aTe extends ni{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&Zm(this.value.arrayValue,n)}}class lTe extends ni{constructor(t,n){super(t,"not-in",n)}matches(t){if(Zm(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&!Zm(this.value.arrayValue,n)}}class cTe extends ni{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!CI(n)||!n.arrayValue.values)&&n.arrayValue.values.some(i=>Zm(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dTe{constructor(t,n=null,i=[],r=[],s=null,o=null,a=null){this.path=t,this.collectionGroup=n,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.le=null}}function LL(e,t=null,n=[],i=[],r=null,s=null,o=null){return new dTe(e,t,n,i,r,s,o)}function AI(e){const t=rt(e);if(t.le===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(i=>ow(i)).join(","),n+="|ob:",n+=t.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),jp(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>lg(i)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>lg(i)).join(",")),t.le=n}return t.le}function MI(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!tTe(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!OW(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!DL(e.startAt,t.startAt)&&DL(e.endAt,t.endAt)}function aw(e){return Pe.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cE{constructor(t,n=null,i=[],r=[],s=null,o="F",a=null,l=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function uTe(e,t,n,i,r,s,o,a){return new cE(e,t,n,i,r,s,o,a)}function kI(e){return new cE(e)}function NL(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function fTe(e){return e.collectionGroup!==null}function H0(e){const t=rt(e);if(t.he===null){t.he=[];const n=new Set;for(const s of t.explicitOrderBy)t.he.push(s),n.add(s.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new ii(ji.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(t).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||t.he.push(new p5(s,i))}),n.has(ji.keyField().canonicalString())||t.he.push(new p5(ji.keyField(),i))}return t.he}function Wo(e){const t=rt(e);return t.Pe||(t.Pe=hTe(t,H0(e))),t.Pe}function hTe(e,t){if(e.limitType==="F")return LL(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(r=>{const s=r.dir==="desc"?"asc":"desc";return new p5(r.field,s)});const n=e.endAt?new m5(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new m5(e.startAt.position,e.startAt.inclusive):null;return LL(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}}function lw(e,t,n){return new cE(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function dE(e,t){return MI(Wo(e),Wo(t))&&e.limitType===t.limitType}function BW(e){return`${AI(Wo(e))}|lt:${e.limitType}`}function xf(e){return`Query(target=${function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map(r=>PW(r)).join(", ")}]`),jp(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map(r=>lg(r)).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map(r=>lg(r)).join(",")),`Target(${i})`}(Wo(e))}; limitType=${e.limitType})`}function uE(e,t){return t.isFoundDocument()&&function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):Pe.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(e,t)&&function(i,r){for(const s of H0(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(e,t)&&function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0}(e,t)&&function(i,r){return!(i.startAt&&!function(o,a,l){const c=RL(o,a,l);return o.inclusive?c<=0:c<0}(i.startAt,H0(i),r)||i.endAt&&!function(o,a,l){const c=RL(o,a,l);return o.inclusive?c>=0:c>0}(i.endAt,H0(i),r))}(e,t)}function gTe(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function zW(e){return(t,n)=>{let i=!1;for(const r of H0(e)){const s=mTe(r,t,n);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function mTe(e,t,n){const i=e.field.isKeyField()?Pe.comparator(t.key,n.key):function(s,o,a){const l=o.data.field(s),c=a.data.field(s);return l!==null&&c!==null?ag(l,c):Oe()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return Oe()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),i=this.inner[n];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,t))return s}}has(t){return this.get(t)!==void 0}set(t,n){const i=this.mapKeyFn(t),r=this.inner[i];if(r===void 0)return this.inner[i]=[[t,n]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],t))return void(r[s]=[t,n]);r.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),i=this.inner[n];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],t))return i.length===1?delete this.inner[n]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(t){Zu(this.inner,(n,i)=>{for(const[r,s]of i)t(r,s)})}isEmpty(){return IW(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pTe=new Ln(Pe.comparator);function td(){return pTe}const HW=new Ln(Pe.comparator);function J1(...e){let t=HW;for(const n of e)t=t.insert(n.key,n);return t}function UTe(e){let t=HW;return e.forEach((n,i)=>t=t.insert(n,i.overlayedDocument)),t}function Gd(){return V0()}function VW(){return V0()}function V0(){return new qu(e=>e.toString(),(e,t)=>e.isEqual(t))}const bTe=new ii(Pe.comparator);function Et(...e){let t=bTe;for(const n of e)t=t.add(n);return t}const yTe=new ii(ft);function ETe(){return yTe}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RI(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:f5(t)?"-0":t}}function $W(e){return{integerValue:""+e}}function vTe(e,t){return Y9e(t)?$W(t):RI(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fE{constructor(){this._=void 0}}function wTe(e,t,n){return e instanceof U5?function(r,s){const o={fields:{[CW]:{stringValue:xW},[MW]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&xI(s)&&(s=lE(s)),s&&(o.fields[AW]=s),{mapValue:o}}(n,t):e instanceof qm?GW(e,t):e instanceof Qm?XW(e,t):function(r,s){const o=TTe(r,s),a=OL(o)+OL(r.Ie);return sw(o)&&sw(r.Ie)?$W(a):RI(r.serializer,a)}(e,t)}function _Te(e,t,n){return e instanceof qm?GW(e,t):e instanceof Qm?XW(e,t):n}function TTe(e,t){return e instanceof b5?function(i){return sw(i)||function(s){return!!s&&"doubleValue"in s}(i)}(t)?t:{integerValue:0}:null}class U5 extends fE{}class qm extends fE{constructor(t){super(),this.elements=t}}function GW(e,t){const n=jW(t);for(const i of e.elements)n.some(r=>oa(r,i))||n.push(i);return{arrayValue:{values:n}}}class Qm extends fE{constructor(t){super(),this.elements=t}}function XW(e,t){let n=jW(t);for(const i of e.elements)n=n.filter(r=>!oa(r,i));return{arrayValue:{values:n}}}class b5 extends fE{constructor(t,n){super(),this.serializer=t,this.Ie=n}}function OL(e){return kn(e.integerValue||e.doubleValue)}function jW(e){return CI(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function ITe(e,t){return e.field.isEqual(t.field)&&function(i,r){return i instanceof qm&&r instanceof qm||i instanceof Qm&&r instanceof Qm?og(i.elements,r.elements,oa):i instanceof b5&&r instanceof b5?oa(i.Ie,r.Ie):i instanceof U5&&r instanceof U5}(e.transform,t.transform)}class ws{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new ws}static exists(t){return new ws(void 0,t)}static updateTime(t){return new ws(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function fb(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class hE{}function YW(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new DI(e.key,ws.none()):new Yp(e.key,e.data,ws.none());{const n=e.data,i=_r.empty();let r=new ii(ji.comparator);for(let s of t.fields)if(!r.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Qu(e.key,i,new Ss(r.toArray()),ws.none())}}function STe(e,t,n){e instanceof Yp?function(r,s,o){const a=r.value.clone(),l=FL(r.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(e,t,n):e instanceof Qu?function(r,s,o){if(!fb(r.precondition,s))return void s.convertToUnknownDocument(o.version);const a=FL(r.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(WW(r)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(e,t,n):function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,n)}function $0(e,t,n,i){return e instanceof Yp?function(s,o,a,l){if(!fb(s.precondition,o))return a;const c=s.value.clone(),d=BL(s.fieldTransforms,l,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(e,t,n,i):e instanceof Qu?function(s,o,a,l){if(!fb(s.precondition,o))return a;const c=BL(s.fieldTransforms,l,o),d=o.data;return d.setAll(WW(s)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(u=>u.field))}(e,t,n,i):function(s,o,a){return fb(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(e,t,n)}function PL(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&og(i,r,(s,o)=>ITe(s,o))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Yp extends hE{constructor(t,n,i,r=[]){super(),this.key=t,this.value=n,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Qu extends hE{constructor(t,n,i,r,s=[]){super(),this.key=t,this.data=n,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function WW(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}}),t}function FL(e,t,n){const i=new Map;jt(e.length===n.length);for(let r=0;r<n.length;r++){const s=e[r],o=s.transform,a=t.data.field(s.field);i.set(s.field,_Te(o,a,n[r]))}return i}function BL(e,t,n){const i=new Map;for(const r of e){const s=r.transform,o=n.data.field(r.field);i.set(r.field,wTe(s,o,t))}return i}class DI extends hE{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class KW extends hE{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xTe{constructor(t,n,i,r){this.batchId=t,this.localWriteTime=n,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(t,n){const i=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(t.key)&&STe(s,t,i[r])}}applyToLocalView(t,n){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(n=$0(i,t,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(n=$0(i,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const i=VW();return this.mutations.forEach(r=>{const s=t.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(r.key)?null:a;const l=YW(o,a);l!==null&&i.set(r.key,l),o.isValidDocument()||o.convertToNoDocument(ze.min())}),i}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),Et())}isEqual(t){return this.batchId===t.batchId&&og(this.mutations,t.mutations,(n,i)=>PL(n,i))&&og(this.baseMutations,t.baseMutations,(n,i)=>PL(n,i))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CTe{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ATe{constructor(t,n){this.count=t,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fn,dt;function MTe(e){switch(e){case ae.OK:return Oe();case ae.CANCELLED:case ae.UNKNOWN:case ae.DEADLINE_EXCEEDED:case ae.RESOURCE_EXHAUSTED:case ae.INTERNAL:case ae.UNAVAILABLE:case ae.UNAUTHENTICATED:return!1;case ae.INVALID_ARGUMENT:case ae.NOT_FOUND:case ae.ALREADY_EXISTS:case ae.PERMISSION_DENIED:case ae.FAILED_PRECONDITION:case ae.ABORTED:case ae.OUT_OF_RANGE:case ae.UNIMPLEMENTED:case ae.DATA_LOSS:return!0;default:return Oe()}}function ZW(e){if(e===void 0)return El("GRPC error has no .code"),ae.UNKNOWN;switch(e){case Fn.OK:return ae.OK;case Fn.CANCELLED:return ae.CANCELLED;case Fn.UNKNOWN:return ae.UNKNOWN;case Fn.DEADLINE_EXCEEDED:return ae.DEADLINE_EXCEEDED;case Fn.RESOURCE_EXHAUSTED:return ae.RESOURCE_EXHAUSTED;case Fn.INTERNAL:return ae.INTERNAL;case Fn.UNAVAILABLE:return ae.UNAVAILABLE;case Fn.UNAUTHENTICATED:return ae.UNAUTHENTICATED;case Fn.INVALID_ARGUMENT:return ae.INVALID_ARGUMENT;case Fn.NOT_FOUND:return ae.NOT_FOUND;case Fn.ALREADY_EXISTS:return ae.ALREADY_EXISTS;case Fn.PERMISSION_DENIED:return ae.PERMISSION_DENIED;case Fn.FAILED_PRECONDITION:return ae.FAILED_PRECONDITION;case Fn.ABORTED:return ae.ABORTED;case Fn.OUT_OF_RANGE:return ae.OUT_OF_RANGE;case Fn.UNIMPLEMENTED:return ae.UNIMPLEMENTED;case Fn.DATA_LOSS:return ae.DATA_LOSS;default:return Oe()}}(dt=Fn||(Fn={}))[dt.OK=0]="OK",dt[dt.CANCELLED=1]="CANCELLED",dt[dt.UNKNOWN=2]="UNKNOWN",dt[dt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",dt[dt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",dt[dt.NOT_FOUND=5]="NOT_FOUND",dt[dt.ALREADY_EXISTS=6]="ALREADY_EXISTS",dt[dt.PERMISSION_DENIED=7]="PERMISSION_DENIED",dt[dt.UNAUTHENTICATED=16]="UNAUTHENTICATED",dt[dt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",dt[dt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",dt[dt.ABORTED=10]="ABORTED",dt[dt.OUT_OF_RANGE=11]="OUT_OF_RANGE",dt[dt.UNIMPLEMENTED=12]="UNIMPLEMENTED",dt[dt.INTERNAL=13]="INTERNAL",dt[dt.UNAVAILABLE=14]="UNAVAILABLE",dt[dt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kTe(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RTe=new Rc([4294967295,4294967295],0);function zL(e){const t=kTe().encode(e),n=new pW;return n.update(t),new Uint8Array(n.digest())}function HL(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),r=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Rc([n,i],0),new Rc([r,s],0)]}class LI{constructor(t,n,i){if(this.bitmap=t,this.padding=n,this.hashCount=i,n<0||n>=8)throw new e0(`Invalid padding: ${n}`);if(i<0)throw new e0(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new e0(`Invalid hash count: ${i}`);if(t.length===0&&n!==0)throw new e0(`Invalid padding when bitmap length is 0: ${n}`);this.Ee=8*t.length-n,this.de=Rc.fromNumber(this.Ee)}Ae(t,n,i){let r=t.add(n.multiply(Rc.fromNumber(i)));return r.compare(RTe)===1&&(r=new Rc([r.getBits(0),r.getBits(1)],0)),r.modulo(this.de).toNumber()}Re(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.Ee===0)return!1;const n=zL(t),[i,r]=HL(n);for(let s=0;s<this.hashCount;s++){const o=this.Ae(i,r,s);if(!this.Re(o))return!1}return!0}static create(t,n,i){const r=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),o=new LI(s,r,n);return i.forEach(a=>o.insert(a)),o}insert(t){if(this.Ee===0)return;const n=zL(t),[i,r]=HL(n);for(let s=0;s<this.hashCount;s++){const o=this.Ae(i,r,s);this.Ve(o)}}Ve(t){const n=Math.floor(t/8),i=t%8;this.bitmap[n]|=1<<i}}class e0 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE{constructor(t,n,i,r,s){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,n,i){const r=new Map;return r.set(t,Wp.createSynthesizedTargetChangeForCurrentChange(t,n,i)),new gE(ze.min(),r,new Ln(ft),td(),Et())}}class Wp{constructor(t,n,i,r,s){this.resumeToken=t,this.current=n,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,n,i){return new Wp(i,n,Et(),Et(),Et())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb{constructor(t,n,i,r){this.me=t,this.removedTargetIds=n,this.key=i,this.fe=r}}class qW{constructor(t,n){this.targetId=t,this.ge=n}}class QW{constructor(t,n,i=Ni.EMPTY_BYTE_STRING,r=null){this.state=t,this.targetIds=n,this.resumeToken=i,this.cause=r}}class VL{constructor(){this.pe=0,this.ye=$L(),this.we=Ni.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.be}Ce(t){t.approximateByteSize()>0&&(this.be=!0,this.we=t)}Fe(){let t=Et(),n=Et(),i=Et();return this.ye.forEach((r,s)=>{switch(s){case 0:t=t.add(r);break;case 2:n=n.add(r);break;case 1:i=i.add(r);break;default:Oe()}}),new Wp(this.we,this.Se,t,n,i)}Me(){this.be=!1,this.ye=$L()}xe(t,n){this.be=!0,this.ye=this.ye.insert(t,n)}Oe(t){this.be=!0,this.ye=this.ye.remove(t)}Ne(){this.pe+=1}Be(){this.pe-=1,jt(this.pe>=0)}Le(){this.be=!0,this.Se=!0}}class DTe{constructor(t){this.ke=t,this.qe=new Map,this.Qe=td(),this.$e=m2(),this.Ke=m2(),this.Ue=new Ln(ft)}We(t){for(const n of t.me)t.fe&&t.fe.isFoundDocument()?this.Ge(n,t.fe):this.ze(n,t.key,t.fe);for(const n of t.removedTargetIds)this.ze(n,t.key,t.fe)}je(t){this.forEachTarget(t,n=>{const i=this.He(n);switch(t.state){case 0:this.Je(n)&&i.Ce(t.resumeToken);break;case 1:i.Be(),i.De||i.Me(),i.Ce(t.resumeToken);break;case 2:i.Be(),i.De||this.removeTarget(n);break;case 3:this.Je(n)&&(i.Le(),i.Ce(t.resumeToken));break;case 4:this.Je(n)&&(this.Ye(n),i.Ce(t.resumeToken));break;default:Oe()}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.qe.forEach((i,r)=>{this.Je(r)&&n(r)})}Ze(t){const n=t.targetId,i=t.ge.count,r=this.Xe(n);if(r){const s=r.target;if(aw(s))if(i===0){const o=new Pe(s.path);this.ze(n,o,Ui.newNoDocument(o,ze.min()))}else jt(i===1);else{const o=this.et(n);if(o!==i){const a=this.tt(t),l=a?this.nt(a,t,o):1;if(l!==0){this.Ye(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ue=this.Ue.insert(n,c)}}}}}tt(t){const n=t.ge.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=n;let o,a;try{o=Jc(i).toUint8Array()}catch(l){if(l instanceof SW)return sg("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new LI(o,r,s)}catch(l){return sg(l instanceof e0?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ee===0?null:a}nt(t,n,i){return n.ge.count===i-this.st(t,n.targetId)?0:2}st(t,n){const i=this.ke.getRemoteKeysForTarget(n);let r=0;return i.forEach(s=>{const o=this.ke.it(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.mightContain(a)||(this.ze(n,s,null),r++)}),r}ot(t){const n=new Map;this.qe.forEach((s,o)=>{const a=this.Xe(o);if(a){if(s.current&&aw(a.target)){const l=new Pe(a.target.path);this._t(l).has(o)||this.ut(o,l)||this.ze(o,l,Ui.newNoDocument(l,t))}s.ve&&(n.set(o,s.Fe()),s.Me())}});let i=Et();this.Ke.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Xe(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(s))}),this.Qe.forEach((s,o)=>o.setReadTime(t));const r=new gE(t,n,this.Ue,this.Qe,i);return this.Qe=td(),this.$e=m2(),this.Ke=m2(),this.Ue=new Ln(ft),r}Ge(t,n){if(!this.Je(t))return;const i=this.ut(t,n.key)?2:0;this.He(t).xe(n.key,i),this.Qe=this.Qe.insert(n.key,n),this.$e=this.$e.insert(n.key,this._t(n.key).add(t)),this.Ke=this.Ke.insert(n.key,this.ct(n.key).add(t))}ze(t,n,i){if(!this.Je(t))return;const r=this.He(t);this.ut(t,n)?r.xe(n,1):r.Oe(n),this.Ke=this.Ke.insert(n,this.ct(n).delete(t)),this.Ke=this.Ke.insert(n,this.ct(n).add(t)),i&&(this.Qe=this.Qe.insert(n,i))}removeTarget(t){this.qe.delete(t)}et(t){const n=this.He(t).Fe();return this.ke.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}Ne(t){this.He(t).Ne()}He(t){let n=this.qe.get(t);return n||(n=new VL,this.qe.set(t,n)),n}ct(t){let n=this.Ke.get(t);return n||(n=new ii(ft),this.Ke=this.Ke.insert(t,n)),n}_t(t){let n=this.$e.get(t);return n||(n=new ii(ft),this.$e=this.$e.insert(t,n)),n}Je(t){const n=this.Xe(t)!==null;return n||_e("WatchChangeAggregator","Detected inactive target",t),n}Xe(t){const n=this.qe.get(t);return n&&n.De?null:this.ke.lt(t)}Ye(t){this.qe.set(t,new VL),this.ke.getRemoteKeysForTarget(t).forEach(n=>{this.ze(t,n,null)})}ut(t,n){return this.ke.getRemoteKeysForTarget(t).has(n)}}function m2(){return new Ln(Pe.comparator)}function $L(){return new Ln(Pe.comparator)}const LTe={asc:"ASCENDING",desc:"DESCENDING"},NTe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},OTe={and:"AND",or:"OR"};class PTe{constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function cw(e,t){return e.useProto3Json||jp(t)?t:{value:t}}function y5(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function JW(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function FTe(e,t){return y5(e,t.toTimestamp())}function il(e){return jt(!!e),ze.fromTimestamp(function(n){const i=Qc(n);return new wi(i.seconds,i.nanos)}(e))}function NI(e,t){return dw(e,t).canonicalString()}function dw(e,t){const n=function(r){return new cn(["projects",r.projectId,"databases",r.database])}(e).child("documents");return t===void 0?n:n.child(t)}function eK(e){const t=cn.fromString(e);return jt(sK(t)),t}function E5(e,t){return NI(e.databaseId,t.path)}function G0(e,t){const n=eK(t);if(n.get(1)!==e.databaseId.projectId)throw new Ae(ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Ae(ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Pe(nK(n))}function tK(e,t){return NI(e.databaseId,t)}function BTe(e){const t=eK(e);return t.length===4?cn.emptyPath():nK(t)}function GL(e){return new cn(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function nK(e){return jt(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function XL(e,t,n){return{name:E5(e,t),fields:n.value.mapValue.fields}}function zTe(e,t){return"found"in t?function(i,r){jt(!!r.found),r.found.name,r.found.updateTime;const s=G0(i,r.found.name),o=il(r.found.updateTime),a=r.found.createTime?il(r.found.createTime):ze.min(),l=new _r({mapValue:{fields:r.found.fields}});return Ui.newFoundDocument(s,o,a,l)}(e,t):"missing"in t?function(i,r){jt(!!r.missing),jt(!!r.readTime);const s=G0(i,r.missing),o=il(r.readTime);return Ui.newNoDocument(s,o)}(e,t):Oe()}function HTe(e,t){let n;if("targetChange"in t){t.targetChange;const i=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Oe()}(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],s=function(c,d){return c.useProto3Json?(jt(d===void 0||typeof d=="string"),Ni.fromBase64String(d||"")):(jt(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Ni.fromUint8Array(d||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(c){const d=c.code===void 0?ae.UNKNOWN:ZW(c.code);return new Ae(d,c.message||"")}(o);n=new QW(i,r,s,a||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const r=G0(e,i.document.name),s=il(i.document.updateTime),o=i.document.createTime?il(i.document.createTime):ze.min(),a=new _r({mapValue:{fields:i.document.fields}}),l=Ui.newFoundDocument(r,s,o,a),c=i.targetIds||[],d=i.removedTargetIds||[];n=new hb(c,d,l.key,l)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const r=G0(e,i.document),s=i.readTime?il(i.readTime):ze.min(),o=Ui.newNoDocument(r,s),a=i.removedTargetIds||[];n=new hb([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const r=G0(e,i.document),s=i.removedTargetIds||[];n=new hb([],s,r,null)}else{if(!("filter"in t))return Oe();{t.filter;const i=t.filter;i.targetId;const{count:r=0,unchangedNames:s}=i,o=new ATe(r,s),a=i.targetId;n=new qW(a,o)}}return n}function VTe(e,t){let n;if(t instanceof Yp)n={update:XL(e,t.key,t.value)};else if(t instanceof DI)n={delete:E5(e,t.key)};else if(t instanceof Qu)n={update:XL(e,t.key,t.data),updateMask:ZTe(t.fieldMask)};else{if(!(t instanceof KW))return Oe();n={verify:E5(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(i=>function(s,o){const a=o.transform;if(a instanceof U5)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof qm)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Qm)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof b5)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw Oe()}(0,i))),t.precondition.isNone||(n.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:FTe(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Oe()}(e,t.precondition)),n}function $Te(e,t){return{documents:[tK(e,t.path)]}}function GTe(e,t){const n={structuredQuery:{}},i=t.path;let r;t.collectionGroup!==null?(r=i,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=tK(e,r);const s=function(c){if(c.length!==0)return rK(aa.create(c,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(c){if(c.length!==0)return c.map(d=>function(f){return{field:Cf(f.field),direction:YTe(f.dir)}}(d))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=cw(e,t.limit);return a!==null&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),{ht:n,parent:r}}function XTe(e){let t=BTe(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){jt(i===1);const d=n.from[0];d.allDescendants?r=d.collectionId:t=t.child(d.collectionId)}let s=[];n.where&&(s=function(u){const f=iK(u);return f instanceof aa&&NW(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(u){return u.map(f=>function(m){return new p5(Af(m.field),function(U){switch(U){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(f))}(n.orderBy));let a=null;n.limit&&(a=function(u){let f;return f=typeof u=="object"?u.value:u,jp(f)?null:f}(n.limit));let l=null;n.startAt&&(l=function(u){const f=!!u.before,h=u.values||[];return new m5(h,f)}(n.startAt));let c=null;return n.endAt&&(c=function(u){const f=!u.before,h=u.values||[];return new m5(h,f)}(n.endAt)),uTe(t,r,o,s,a,"F",l,c)}function jTe(e,t){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Oe()}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function iK(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=Af(n.unaryFilter.field);return ni.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Af(n.unaryFilter.field);return ni.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Af(n.unaryFilter.field);return ni.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Af(n.unaryFilter.field);return ni.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Oe()}}(e):e.fieldFilter!==void 0?function(n){return ni.create(Af(n.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Oe()}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return aa.create(n.compositeFilter.filters.map(i=>iK(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Oe()}}(n.compositeFilter.op))}(e):Oe()}function YTe(e){return LTe[e]}function WTe(e){return NTe[e]}function KTe(e){return OTe[e]}function Cf(e){return{fieldPath:e.canonicalString()}}function Af(e){return ji.fromServerFormat(e.fieldPath)}function rK(e){return e instanceof ni?function(n){if(n.op==="=="){if(kL(n.value))return{unaryFilter:{field:Cf(n.field),op:"IS_NAN"}};if(ML(n.value))return{unaryFilter:{field:Cf(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(kL(n.value))return{unaryFilter:{field:Cf(n.field),op:"IS_NOT_NAN"}};if(ML(n.value))return{unaryFilter:{field:Cf(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Cf(n.field),op:WTe(n.op),value:n.value}}}(e):e instanceof aa?function(n){const i=n.getFilters().map(r=>rK(r));return i.length===1?i[0]:{compositeFilter:{op:KTe(n.op),filters:i}}}(e):Oe()}function ZTe(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function sK(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc{constructor(t,n,i,r,s=ze.min(),o=ze.min(),a=Ni.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=n,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(t){return new fc(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new fc(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new fc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new fc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qTe{constructor(t){this.Tt=t}}function QTe(e){const t=XTe({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?lw(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JTe{constructor(){this.Tn=new eIe}addToCollectionParentIndex(t,n){return this.Tn.add(n),re.resolve()}getCollectionParents(t,n){return re.resolve(this.Tn.getEntries(n))}addFieldIndex(t,n){return re.resolve()}deleteFieldIndex(t,n){return re.resolve()}deleteAllFieldIndexes(t){return re.resolve()}createTargetIndexes(t,n){return re.resolve()}getDocumentsMatchingTarget(t,n){return re.resolve(null)}getIndexType(t,n){return re.resolve(0)}getFieldIndexes(t,n){return re.resolve([])}getNextCollectionGroupToUpdate(t){return re.resolve(null)}getMinOffset(t,n){return re.resolve(qc.min())}getMinOffsetFromCollectionGroup(t,n){return re.resolve(qc.min())}updateCollectionGroup(t,n,i){return re.resolve()}updateIndexEntries(t,n){return re.resolve()}}class eIe{constructor(){this.index={}}add(t){const n=t.lastSegment(),i=t.popLast(),r=this.index[n]||new ii(cn.comparator),s=!r.has(i);return this.index[n]=r.add(i),s}has(t){const n=t.lastSegment(),i=t.popLast(),r=this.index[n];return r&&r.has(i)}getEntries(t){return(this.index[t]||new ii(cn.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jL={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},oK=41943040;class wr{static withCacheSize(t){return new wr(t,wr.DEFAULT_COLLECTION_PERCENTILE,wr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,n,i){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wr.DEFAULT_COLLECTION_PERCENTILE=10,wr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,wr.DEFAULT=new wr(oK,wr.DEFAULT_COLLECTION_PERCENTILE,wr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),wr.DISABLED=new wr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cg{constructor(t){this.$n=t}next(){return this.$n+=2,this.$n}static Kn(){return new cg(0)}static Un(){return new cg(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YL="LruGarbageCollector",tIe=1048576;function WL([e,t],[n,i]){const r=ft(e,n);return r===0?ft(t,i):r}class nIe{constructor(t){this.Hn=t,this.buffer=new ii(WL),this.Jn=0}Yn(){return++this.Jn}Zn(t){const n=[t,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();WL(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class iIe{constructor(t,n,i){this.garbageCollector=t,this.asyncQueue=n,this.localStore=i,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(t){_e(YL,`Garbage collection scheduled in ${t}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Pg(n)?_e(YL,"Ignoring IndexedDB error during garbage collection: ",n):await oE(n)}await this.er(3e5)})}}class rIe{constructor(t,n){this.tr=t,this.params=n}calculateTargetCount(t,n){return this.tr.nr(t).next(i=>Math.floor(n/100*i))}nthSequenceNumber(t,n){if(n===0)return re.resolve(aE.ae);const i=new nIe(n);return this.tr.forEachTarget(t,r=>i.Zn(r.sequenceNumber)).next(()=>this.tr.rr(t,r=>i.Zn(r))).next(()=>i.maxValue)}removeTargets(t,n,i){return this.tr.removeTargets(t,n,i)}removeOrphanedDocuments(t,n){return this.tr.removeOrphanedDocuments(t,n)}collect(t,n){return this.params.cacheSizeCollectionThreshold===-1?(_e("LruGarbageCollector","Garbage collection skipped; disabled"),re.resolve(jL)):this.getCacheSize(t).next(i=>i<this.params.cacheSizeCollectionThreshold?(_e("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),jL):this.ir(t,n))}getCacheSize(t){return this.tr.getCacheSize(t)}ir(t,n){let i,r,s,o,a,l,c;const d=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(u=>(u>this.params.maximumSequenceNumbersToCollect?(_e("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${u}`),r=this.params.maximumSequenceNumbersToCollect):r=u,o=Date.now(),this.nthSequenceNumber(t,r))).next(u=>(i=u,a=Date.now(),this.removeTargets(t,i,n))).next(u=>(s=u,l=Date.now(),this.removeOrphanedDocuments(t,i))).next(u=>(c=Date.now(),Sf()<=ut.DEBUG&&_e("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${u} documents in `+(c-l)+`ms
Total Duration: ${c-d}ms`),re.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:u})))}}function sIe(e,t){return new rIe(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oIe{constructor(){this.changes=new qu(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,Ui.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?re.resolve(i):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aIe{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lIe{constructor(t,n,i,r){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=r}getDocument(t,n){let i=null;return this.documentOverlayCache.getOverlay(t,n).next(r=>(i=r,this.remoteDocumentCache.getEntry(t,n))).next(r=>(i!==null&&$0(i.mutation,r,Ss.empty(),wi.now()),r))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(i=>this.getLocalViewOfDocuments(t,i,Et()).next(()=>i))}getLocalViewOfDocuments(t,n,i=Et()){const r=Gd();return this.populateOverlays(t,r,n).next(()=>this.computeViews(t,n,r,i).next(s=>{let o=J1();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(t,n){const i=Gd();return this.populateOverlays(t,i,n).next(()=>this.computeViews(t,n,i,Et()))}populateOverlays(t,n,i){const r=[];return i.forEach(s=>{n.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(t,r).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(t,n,i,r){let s=td();const o=V0(),a=function(){return V0()}();return n.forEach((l,c)=>{const d=i.get(c.key);r.has(c.key)&&(d===void 0||d.mutation instanceof Qu)?s=s.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),$0(d.mutation,c,d.mutation.getFieldMask(),wi.now())):o.set(c.key,Ss.empty())}),this.recalculateAndSaveOverlays(t,s).next(l=>(l.forEach((c,d)=>o.set(c,d)),n.forEach((c,d)=>{var u;return a.set(c,new aIe(d,(u=o.get(c))!==null&&u!==void 0?u:null))}),a))}recalculateAndSaveOverlays(t,n){const i=V0();let r=new Ln((o,a)=>o-a),s=Et();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let d=i.get(l)||Ss.empty();d=a.applyToLocalView(c,d),i.set(l,d);const u=(r.get(a.batchId)||Et()).add(l);r=r.insert(a.batchId,u)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,d=l.value,u=VW();d.forEach(f=>{if(!s.has(f)){const h=YW(n.get(f),i.get(f));h!==null&&u.set(f,h),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(t,c,u))}return re.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,n,i,r){return function(o){return Pe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):fTe(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,i,r):this.getDocumentsMatchingCollectionQuery(t,n,i,r)}getNextDocuments(t,n,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,i,r).next(s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,i.largestBatchId,r-s.size):re.resolve(Gd());let a=Ym,l=s;return o.next(c=>re.forEach(c,(d,u)=>(a<u.largestBatchId&&(a=u.largestBatchId),s.get(d)?re.resolve():this.remoteDocumentCache.getEntry(t,d).next(f=>{l=l.insert(d,f)}))).next(()=>this.populateOverlays(t,c,s)).next(()=>this.computeViews(t,l,c,Et())).next(d=>({batchId:a,changes:UTe(d)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new Pe(n)).next(i=>{let r=J1();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(t,n,i,r){const s=n.collectionGroup;let o=J1();return this.indexManager.getCollectionParents(t,s).next(a=>re.forEach(a,l=>{const c=function(u,f){return new cE(f,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(t,c,i,r).next(d=>{d.forEach((u,f)=>{o=o.insert(u,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,n,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,i.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,i,s,r))).next(o=>{s.forEach((l,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,Ui.newInvalidDocument(d)))});let a=J1();return o.forEach((l,c)=>{const d=s.get(l);d!==void 0&&$0(d.mutation,c,Ss.empty(),wi.now()),uE(n,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cIe{constructor(t){this.serializer=t,this.dr=new Map,this.Ar=new Map}getBundleMetadata(t,n){return re.resolve(this.dr.get(n))}saveBundleMetadata(t,n){return this.dr.set(n.id,function(r){return{id:r.id,version:r.version,createTime:il(r.createTime)}}(n)),re.resolve()}getNamedQuery(t,n){return re.resolve(this.Ar.get(n))}saveNamedQuery(t,n){return this.Ar.set(n.name,function(r){return{name:r.name,query:QTe(r.bundledQuery),readTime:il(r.readTime)}}(n)),re.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dIe{constructor(){this.overlays=new Ln(Pe.comparator),this.Rr=new Map}getOverlay(t,n){return re.resolve(this.overlays.get(n))}getOverlays(t,n){const i=Gd();return re.forEach(n,r=>this.getOverlay(t,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(t,n,i){return i.forEach((r,s)=>{this.Et(t,n,s)}),re.resolve()}removeOverlaysForBatchId(t,n,i){const r=this.Rr.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.Rr.delete(i)),re.resolve()}getOverlaysForCollection(t,n,i){const r=Gd(),s=n.length+1,o=new Pe(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>i&&r.set(l.getKey(),l)}return re.resolve(r)}getOverlaysForCollectionGroup(t,n,i,r){let s=new Ln((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>i){let d=s.get(c.largestBatchId);d===null&&(d=Gd(),s=s.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=Gd(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=r)););return re.resolve(a)}Et(t,n,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.Rr.get(r.largestBatchId).delete(i.key);this.Rr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new CTe(n,i));let s=this.Rr.get(n);s===void 0&&(s=Et(),this.Rr.set(n,s)),this.Rr.set(n,s.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uIe{constructor(){this.sessionToken=Ni.EMPTY_BYTE_STRING}getSessionToken(t){return re.resolve(this.sessionToken)}setSessionToken(t,n){return this.sessionToken=n,re.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OI{constructor(){this.Vr=new ii(hi.mr),this.gr=new ii(hi.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(t,n){const i=new hi(t,n);this.Vr=this.Vr.add(i),this.gr=this.gr.add(i)}yr(t,n){t.forEach(i=>this.addReference(i,n))}removeReference(t,n){this.wr(new hi(t,n))}Sr(t,n){t.forEach(i=>this.removeReference(i,n))}br(t){const n=new Pe(new cn([])),i=new hi(n,t),r=new hi(n,t+1),s=[];return this.gr.forEachInRange([i,r],o=>{this.wr(o),s.push(o.key)}),s}Dr(){this.Vr.forEach(t=>this.wr(t))}wr(t){this.Vr=this.Vr.delete(t),this.gr=this.gr.delete(t)}vr(t){const n=new Pe(new cn([])),i=new hi(n,t),r=new hi(n,t+1);let s=Et();return this.gr.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(t){const n=new hi(t,0),i=this.Vr.firstAfterOrEqual(n);return i!==null&&t.isEqual(i.key)}}class hi{constructor(t,n){this.key=t,this.Cr=n}static mr(t,n){return Pe.comparator(t.key,n.key)||ft(t.Cr,n.Cr)}static pr(t,n){return ft(t.Cr,n.Cr)||Pe.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fIe{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.Fr=1,this.Mr=new ii(hi.mr)}checkEmpty(t){return re.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,i,r){const s=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new xTe(s,n,i,r);this.mutationQueue.push(o);for(const a of r)this.Mr=this.Mr.add(new hi(a.key,s)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return re.resolve(o)}lookupMutationBatch(t,n){return re.resolve(this.Or(n))}getNextMutationBatchAfterBatchId(t,n){const i=n+1,r=this.Nr(i),s=r<0?0:r;return re.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return re.resolve(this.mutationQueue.length===0?j9e:this.Fr-1)}getAllMutationBatches(t){return re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const i=new hi(n,0),r=new hi(n,Number.POSITIVE_INFINITY),s=[];return this.Mr.forEachInRange([i,r],o=>{const a=this.Or(o.Cr);s.push(a)}),re.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,n){let i=new ii(ft);return n.forEach(r=>{const s=new hi(r,0),o=new hi(r,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([s,o],a=>{i=i.add(a.Cr)})}),re.resolve(this.Br(i))}getAllMutationBatchesAffectingQuery(t,n){const i=n.path,r=i.length+1;let s=i;Pe.isDocumentKey(s)||(s=s.child(""));const o=new hi(new Pe(s),0);let a=new ii(ft);return this.Mr.forEachWhile(l=>{const c=l.key.path;return!!i.isPrefixOf(c)&&(c.length===r&&(a=a.add(l.Cr)),!0)},o),re.resolve(this.Br(a))}Br(t){const n=[];return t.forEach(i=>{const r=this.Or(i);r!==null&&n.push(r)}),n}removeMutationBatch(t,n){jt(this.Lr(n.batchId,"removed")===0),this.mutationQueue.shift();let i=this.Mr;return re.forEach(n.mutations,r=>{const s=new hi(r.key,n.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,r.key)}).next(()=>{this.Mr=i})}qn(t){}containsKey(t,n){const i=new hi(n,0),r=this.Mr.firstAfterOrEqual(i);return re.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(t){return this.mutationQueue.length,re.resolve()}Lr(t,n){return this.Nr(t)}Nr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Or(t){const n=this.Nr(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hIe{constructor(t){this.kr=t,this.docs=function(){return new Ln(Pe.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const i=n.key,r=this.docs.get(i),s=r?r.size:0,o=this.kr(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const i=this.docs.get(n);return re.resolve(i?i.document.mutableCopy():Ui.newInvalidDocument(n))}getEntries(t,n){let i=td();return n.forEach(r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Ui.newInvalidDocument(r))}),re.resolve(i)}getDocumentsMatchingQuery(t,n,i,r){let s=td();const o=n.path,a=new Pe(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||V9e(H9e(d),i)<=0||(r.has(d.key)||uE(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return re.resolve(s)}getAllFromCollectionGroup(t,n,i,r){Oe()}qr(t,n){return re.forEach(this.docs,i=>n(i))}newChangeBuffer(t){return new gIe(this)}getSize(t){return re.resolve(this.size)}}class gIe extends oIe{constructor(t){super(),this.Ir=t}applyChanges(t){const n=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?n.push(this.Ir.addEntry(t,r)):this.Ir.removeEntry(i)}),re.waitFor(n)}getFromCache(t,n){return this.Ir.getEntry(t,n)}getAllFromCache(t,n){return this.Ir.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mIe{constructor(t){this.persistence=t,this.Qr=new qu(n=>AI(n),MI),this.lastRemoteSnapshotVersion=ze.min(),this.highestTargetId=0,this.$r=0,this.Kr=new OI,this.targetCount=0,this.Ur=cg.Kn()}forEachTarget(t,n){return this.Qr.forEach((i,r)=>n(r)),re.resolve()}getLastRemoteSnapshotVersion(t){return re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return re.resolve(this.$r)}allocateTargetId(t){return this.highestTargetId=this.Ur.next(),re.resolve(this.highestTargetId)}setTargetsMetadata(t,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.$r&&(this.$r=n),re.resolve()}zn(t){this.Qr.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this.Ur=new cg(n),this.highestTargetId=n),t.sequenceNumber>this.$r&&(this.$r=t.sequenceNumber)}addTargetData(t,n){return this.zn(n),this.targetCount+=1,re.resolve()}updateTargetData(t,n){return this.zn(n),re.resolve()}removeTargetData(t,n){return this.Qr.delete(n.target),this.Kr.br(n.targetId),this.targetCount-=1,re.resolve()}removeTargets(t,n,i){let r=0;const s=[];return this.Qr.forEach((o,a)=>{a.sequenceNumber<=n&&i.get(a.targetId)===null&&(this.Qr.delete(o),s.push(this.removeMatchingKeysForTargetId(t,a.targetId)),r++)}),re.waitFor(s).next(()=>r)}getTargetCount(t){return re.resolve(this.targetCount)}getTargetData(t,n){const i=this.Qr.get(n)||null;return re.resolve(i)}addMatchingKeys(t,n,i){return this.Kr.yr(n,i),re.resolve()}removeMatchingKeys(t,n,i){this.Kr.Sr(n,i);const r=this.persistence.referenceDelegate,s=[];return r&&n.forEach(o=>{s.push(r.markPotentiallyOrphaned(t,o))}),re.waitFor(s)}removeMatchingKeysForTargetId(t,n){return this.Kr.br(n),re.resolve()}getMatchingKeysForTargetId(t,n){const i=this.Kr.vr(n);return re.resolve(i)}containsKey(t,n){return re.resolve(this.Kr.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aK{constructor(t,n){this.Wr={},this.overlays={},this.Gr=new aE(0),this.zr=!1,this.zr=!0,this.jr=new uIe,this.referenceDelegate=t(this),this.Hr=new mIe(this),this.indexManager=new JTe,this.remoteDocumentCache=function(r){return new hIe(r)}(i=>this.referenceDelegate.Jr(i)),this.serializer=new qTe(n),this.Yr=new cIe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new dIe,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let i=this.Wr[t.toKey()];return i||(i=new fIe(n,this.referenceDelegate),this.Wr[t.toKey()]=i),i}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(t,n,i){_e("MemoryPersistence","Starting transaction:",t);const r=new pIe(this.Gr.next());return this.referenceDelegate.Zr(),i(r).next(s=>this.referenceDelegate.Xr(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}ei(t,n){return re.or(Object.values(this.Wr).map(i=>()=>i.containsKey(t,n)))}}class pIe extends G9e{constructor(t){super(),this.currentSequenceNumber=t}}class PI{constructor(t){this.persistence=t,this.ti=new OI,this.ni=null}static ri(t){return new PI(t)}get ii(){if(this.ni)return this.ni;throw Oe()}addReference(t,n,i){return this.ti.addReference(i,n),this.ii.delete(i.toString()),re.resolve()}removeReference(t,n,i){return this.ti.removeReference(i,n),this.ii.add(i.toString()),re.resolve()}markPotentiallyOrphaned(t,n){return this.ii.add(n.toString()),re.resolve()}removeTarget(t,n){this.ti.br(n.targetId).forEach(r=>this.ii.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,n.targetId).next(r=>{r.forEach(s=>this.ii.add(s.toString()))}).next(()=>i.removeTargetData(t,n))}Zr(){this.ni=new Set}Xr(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return re.forEach(this.ii,i=>{const r=Pe.fromPath(i);return this.si(t,r).next(s=>{s||n.removeEntry(r,ze.min())})}).next(()=>(this.ni=null,n.apply(t)))}updateLimboDocument(t,n){return this.si(t,n).next(i=>{i?this.ii.delete(n.toString()):this.ii.add(n.toString())})}Jr(t){return 0}si(t,n){return re.or([()=>re.resolve(this.ti.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.ei(t,n)])}}class v5{constructor(t,n){this.persistence=t,this.oi=new qu(i=>W9e(i.path),(i,r)=>i.isEqual(r)),this.garbageCollector=sIe(this,n)}static ri(t,n){return new v5(t,n)}Zr(){}Xr(t){return re.resolve()}forEachTarget(t,n){return this.persistence.getTargetCache().forEachTarget(t,n)}nr(t){const n=this.sr(t);return this.persistence.getTargetCache().getTargetCount(t).next(i=>n.next(r=>i+r))}sr(t){let n=0;return this.rr(t,i=>{n++}).next(()=>n)}rr(t,n){return re.forEach(this.oi,(i,r)=>this.ar(t,i,r).next(s=>s?re.resolve():n(r)))}removeTargets(t,n,i){return this.persistence.getTargetCache().removeTargets(t,n,i)}removeOrphanedDocuments(t,n){let i=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.qr(t,o=>this.ar(t,o,n).next(a=>{a||(i++,s.removeEntry(o,ze.min()))})).next(()=>s.apply(t)).next(()=>i)}markPotentiallyOrphaned(t,n){return this.oi.set(n,t.currentSequenceNumber),re.resolve()}removeTarget(t,n){const i=n.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,i)}addReference(t,n,i){return this.oi.set(i,t.currentSequenceNumber),re.resolve()}removeReference(t,n,i){return this.oi.set(i,t.currentSequenceNumber),re.resolve()}updateLimboDocument(t,n){return this.oi.set(n,t.currentSequenceNumber),re.resolve()}Jr(t){let n=t.key.toString().length;return t.isFoundDocument()&&(n+=ub(t.data.value)),n}ar(t,n,i){return re.or([()=>this.persistence.ei(t,n),()=>this.persistence.getTargetCache().containsKey(t,n),()=>{const r=this.oi.get(n);return re.resolve(r!==void 0&&r>i)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FI{constructor(t,n,i,r){this.targetId=t,this.fromCache=n,this.Hi=i,this.Ji=r}static Yi(t,n){let i=Et(),r=Et();for(const s of n.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new FI(t,n.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UIe{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bIe{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return p_e()?8:X9e(g_e())>0?6:4}()}initialize(t,n){this.ns=t,this.indexManager=n,this.Zi=!0}getDocumentsMatchingQuery(t,n,i,r){const s={result:null};return this.rs(t,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ss(t,n,r,i).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new UIe;return this._s(t,n,o).next(a=>{if(s.result=a,this.Xi)return this.us(t,n,o,a.size)})}).next(()=>s.result)}us(t,n,i,r){return i.documentReadCount<this.es?(Sf()<=ut.DEBUG&&_e("QueryEngine","SDK will not create cache indexes for query:",xf(n),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),re.resolve()):(Sf()<=ut.DEBUG&&_e("QueryEngine","Query:",xf(n),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.ts*r?(Sf()<=ut.DEBUG&&_e("QueryEngine","The SDK decides to create cache indexes for query:",xf(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Wo(n))):re.resolve())}rs(t,n){if(NL(n))return re.resolve(null);let i=Wo(n);return this.indexManager.getIndexType(t,i).next(r=>r===0?null:(n.limit!==null&&r===1&&(n=lw(n,null,"F"),i=Wo(n)),this.indexManager.getDocumentsMatchingTarget(t,i).next(s=>{const o=Et(...s);return this.ns.getDocuments(t,o).next(a=>this.indexManager.getMinOffset(t,i).next(l=>{const c=this.cs(n,a);return this.ls(n,c,o,l.readTime)?this.rs(t,lw(n,null,"F")):this.hs(t,c,n,l)}))})))}ss(t,n,i,r){return NL(n)||r.isEqual(ze.min())?re.resolve(null):this.ns.getDocuments(t,i).next(s=>{const o=this.cs(n,s);return this.ls(n,o,i,r)?re.resolve(null):(Sf()<=ut.DEBUG&&_e("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),xf(n)),this.hs(t,o,n,z9e(r,Ym)).next(a=>a))})}cs(t,n){let i=new ii(zW(t));return n.forEach((r,s)=>{uE(t,s)&&(i=i.add(s))}),i}ls(t,n,i,r){if(t.limit===null)return!1;if(i.size!==n.size)return!0;const s=t.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}_s(t,n,i){return Sf()<=ut.DEBUG&&_e("QueryEngine","Using full collection scan to execute query:",xf(n)),this.ns.getDocumentsMatchingQuery(t,n,qc.min(),i)}hs(t,n,i,r){return this.ns.getDocumentsMatchingQuery(t,i,r).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BI="LocalStore",yIe=3e8;class EIe{constructor(t,n,i,r){this.persistence=t,this.Ps=n,this.serializer=r,this.Ts=new Ln(ft),this.Is=new qu(s=>AI(s),MI),this.Es=new Map,this.ds=t.getRemoteDocumentCache(),this.Hr=t.getTargetCache(),this.Yr=t.getBundleCache(),this.As(i)}As(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new lIe(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.Ts))}}function vIe(e,t,n,i){return new EIe(e,t,n,i)}async function lK(e,t){const n=rt(e);return await n.persistence.runTransaction("Handle user change","readonly",i=>{let r;return n.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,n.As(t),n.mutationQueue.getAllMutationBatches(i))).next(s=>{const o=[],a=[];let l=Et();for(const c of r){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of s){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(i,l).next(c=>({Rs:c,removedBatchIds:o,addedBatchIds:a}))})})}function cK(e){const t=rt(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.Hr.getLastRemoteSnapshotVersion(n))}function wIe(e,t){const n=rt(e),i=t.snapshotVersion;let r=n.Ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.ds.newChangeBuffer({trackRemovals:!0});r=n.Ts;const a=[];t.targetChanges.forEach((d,u)=>{const f=r.get(u);if(!f)return;a.push(n.Hr.removeMatchingKeys(s,d.removedDocuments,u).next(()=>n.Hr.addMatchingKeys(s,d.addedDocuments,u)));let h=f.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(u)!==null?h=h.withResumeToken(Ni.EMPTY_BYTE_STRING,ze.min()).withLastLimboFreeSnapshotVersion(ze.min()):d.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(d.resumeToken,i)),r=r.insert(u,h),function(p,U,b){return p.resumeToken.approximateByteSize()===0||U.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=yIe?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(f,h,d)&&a.push(n.Hr.updateTargetData(s,h))});let l=td(),c=Et();if(t.documentUpdates.forEach(d=>{t.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(_Ie(s,o,t.documentUpdates).next(d=>{l=d.Vs,c=d.fs})),!i.isEqual(ze.min())){const d=n.Hr.getLastRemoteSnapshotVersion(s).next(u=>n.Hr.setTargetsMetadata(s,s.currentSequenceNumber,i));a.push(d)}return re.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(n.Ts=r,s))}function _Ie(e,t,n){let i=Et(),r=Et();return n.forEach(s=>i=i.add(s)),t.getEntries(e,i).next(s=>{let o=td();return n.forEach((a,l)=>{const c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(ze.min())?(t.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),o=o.insert(a,l)):_e(BI,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Vs:o,fs:r}})}function TIe(e,t){const n=rt(e);return n.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return n.Hr.getTargetData(i,t).next(s=>s?(r=s,re.resolve(r)):n.Hr.allocateTargetId(i).next(o=>(r=new fc(t,o,"TargetPurposeListen",i.currentSequenceNumber),n.Hr.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=n.Ts.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ts=n.Ts.insert(i.targetId,i),n.Is.set(t,i.targetId)),i})}async function uw(e,t,n){const i=rt(e),r=i.Ts.get(t),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,o=>i.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!Pg(o))throw o;_e(BI,`Failed to update sequence numbers for target ${t}: ${o}`)}i.Ts=i.Ts.remove(t),i.Is.delete(r.target)}function KL(e,t,n){const i=rt(e);let r=ze.min(),s=Et();return i.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,d){const u=rt(l),f=u.Is.get(d);return f!==void 0?re.resolve(u.Ts.get(f)):u.Hr.getTargetData(c,d)}(i,o,Wo(t)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.Hr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>i.Ps.getDocumentsMatchingQuery(o,t,n?r:ze.min(),n?s:Et())).next(a=>(IIe(i,gTe(t),a),{documents:a,gs:s})))}function IIe(e,t,n){let i=e.Es.get(t)||ze.min();n.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),e.Es.set(t,i)}class ZL{constructor(){this.activeTargetIds=ETe()}Ds(t){this.activeTargetIds=this.activeTargetIds.add(t)}vs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}bs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class SIe{constructor(){this.ho=new ZL,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,i){}addLocalQueryTarget(t,n=!0){return n&&this.ho.Ds(t),this.Po[t]||"not-current"}updateQueryState(t,n,i){this.Po[t]=n}removeLocalQueryTarget(t){this.ho.vs(t)}isLocalQueryTarget(t){return this.ho.activeTargetIds.has(t)}clearQueryState(t){delete this.Po[t]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(t){return this.ho.activeTargetIds.has(t)}start(){return this.ho=new ZL,Promise.resolve()}handleUserChange(t,n,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xIe{To(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL="ConnectivityMonitor";class QL{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(t){this.Vo.push(t)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){_e(qL,"Network connectivity changed: AVAILABLE");for(const t of this.Vo)t(0)}Ro(){_e(qL,"Network connectivity changed: UNAVAILABLE");for(const t of this.Vo)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let p2=null;function fw(){return p2===null?p2=function(){return 268435456+Math.round(2147483648*Math.random())}():p2++,"0x"+p2.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i7="RestConnection",CIe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class AIe{get fo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.po=n+"://"+t.host,this.yo=`projects/${i}/databases/${r}`,this.wo=this.databaseId.database===h5?`project_id=${i}`:`project_id=${i}&database_id=${r}`}So(t,n,i,r,s){const o=fw(),a=this.bo(t,n.toUriEncodedString());_e(i7,`Sending RPC '${t}' ${o}:`,a,i);const l={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(l,r,s),this.vo(t,a,l,i).then(c=>(_e(i7,`Received RPC '${t}' ${o}: `,c),c),c=>{throw sg(i7,`RPC '${t}' ${o} failed with error: `,c,"url: ",a,"request:",i),c})}Co(t,n,i,r,s,o){return this.So(t,n,i,r,s)}Do(t,n,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Og}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((r,s)=>t[s]=r),i&&i.headers.forEach((r,s)=>t[s]=r)}bo(t,n){const i=CIe[t];return`${this.po}/v1/${n}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MIe{constructor(t){this.Fo=t.Fo,this.Mo=t.Mo}xo(t){this.Oo=t}No(t){this.Bo=t}Lo(t){this.ko=t}onMessage(t){this.qo=t}close(){this.Mo()}send(t){this.Fo(t)}Qo(){this.Oo()}$o(){this.Bo()}Ko(t){this.ko(t)}Uo(t){this.qo(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zi="WebChannelConnection";class kIe extends AIe{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}vo(t,n,i,r){const s=fw();return new Promise((o,a)=>{const l=new UW;l.setWithCredentials(!0),l.listenOnce(bW.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case db.NO_ERROR:const d=l.getResponseJson();_e(zi,`XHR for RPC '${t}' ${s} received:`,JSON.stringify(d)),o(d);break;case db.TIMEOUT:_e(zi,`RPC '${t}' ${s} timed out`),a(new Ae(ae.DEADLINE_EXCEEDED,"Request time out"));break;case db.HTTP_ERROR:const u=l.getStatus();if(_e(zi,`RPC '${t}' ${s} failed with status:`,u,"response text:",l.getResponseText()),u>0){let f=l.getResponseJson();Array.isArray(f)&&(f=f[0]);const h=f==null?void 0:f.error;if(h&&h.status&&h.message){const m=function(U){const b=U.toLowerCase().replace(/_/g,"-");return Object.values(ae).indexOf(b)>=0?b:ae.UNKNOWN}(h.status);a(new Ae(m,h.message))}else a(new Ae(ae.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new Ae(ae.UNAVAILABLE,"Connection failed."));break;default:Oe()}}finally{_e(zi,`RPC '${t}' ${s} completed.`)}});const c=JSON.stringify(r);_e(zi,`RPC '${t}' ${s} sending request:`,r),l.send(n,"POST",c,i,15)})}Wo(t,n,i){const r=fw(),s=[this.po,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=vW(),a=EW(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Do(l.initMessageHeaders,n,i),l.encodeInitMessageHeaders=!0;const d=s.join("");_e(zi,`Creating RPC '${t}' stream ${r}: ${d}`,l);const u=o.createWebChannel(d,l);let f=!1,h=!1;const m=new MIe({Fo:U=>{h?_e(zi,`Not sending because RPC '${t}' stream ${r} is closed:`,U):(f||(_e(zi,`Opening RPC '${t}' stream ${r} transport.`),u.open(),f=!0),_e(zi,`RPC '${t}' stream ${r} sending:`,U),u.send(U))},Mo:()=>u.close()}),p=(U,b,y)=>{U.listen(b,w=>{try{y(w)}catch(v){setTimeout(()=>{throw v},0)}})};return p(u,Q1.EventType.OPEN,()=>{h||(_e(zi,`RPC '${t}' stream ${r} transport opened.`),m.Qo())}),p(u,Q1.EventType.CLOSE,()=>{h||(h=!0,_e(zi,`RPC '${t}' stream ${r} transport closed`),m.Ko())}),p(u,Q1.EventType.ERROR,U=>{h||(h=!0,sg(zi,`RPC '${t}' stream ${r} transport errored:`,U),m.Ko(new Ae(ae.UNAVAILABLE,"The operation could not be completed")))}),p(u,Q1.EventType.MESSAGE,U=>{var b;if(!h){const y=U.data[0];jt(!!y);const w=y,v=(w==null?void 0:w.error)||((b=w[0])===null||b===void 0?void 0:b.error);if(v){_e(zi,`RPC '${t}' stream ${r} received error:`,v);const I=v.status;let C=function(k){const x=Fn[k];if(x!==void 0)return ZW(x)}(I),_=v.message;C===void 0&&(C=ae.INTERNAL,_="Unknown error status: "+I+" with message "+v.message),h=!0,m.Ko(new Ae(C,_)),u.close()}else _e(zi,`RPC '${t}' stream ${r} received:`,y),m.Uo(y)}}),p(a,yW.STAT_EVENT,U=>{U.stat===iw.PROXY?_e(zi,`RPC '${t}' stream ${r} detected buffering proxy`):U.stat===iw.NOPROXY&&_e(zi,`RPC '${t}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{m.$o()},0),m}}function r7(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mE(e){return new PTe(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zI{constructor(t,n,i=1e3,r=1.5,s=6e4){this.Ti=t,this.timerId=n,this.Go=i,this.zo=r,this.jo=s,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(t){this.cancel();const n=Math.floor(this.Ho+this.e_()),i=Math.max(0,Date.now()-this.Yo),r=Math.max(0,n-i);r>0&&_e("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ho} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,r,()=>(this.Yo=Date.now(),t())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JL="PersistentStream";class RIe{constructor(t,n,i,r,s,o,a,l){this.Ti=t,this.n_=i,this.r_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new zI(t,n)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(t){this.E_(),this.stream.send(t)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(t,n){this.E_(),this.d_(),this.a_.cancel(),this.i_++,t!==4?this.a_.reset():n&&n.code===ae.RESOURCE_EXHAUSTED?(El(n.toString()),El("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):n&&n.code===ae.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Lo(n)}A_(){}auth(){this.state=1;const t=this.R_(this.i_),n=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.i_===n&&this.V_(i,r)},i=>{t(()=>{const r=new Ae(ae.UNKNOWN,"Fetching auth token failed: "+i.message);return this.m_(r)})})}V_(t,n){const i=this.R_(this.i_);this.stream=this.f_(t,n),this.stream.xo(()=>{i(()=>this.listener.xo())}),this.stream.No(()=>{i(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(r=>{i(()=>this.m_(r))}),this.stream.onMessage(r=>{i(()=>++this.__==1?this.g_(r):this.onNext(r))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(t){return _e(JL,`close with error: ${t}`),this.stream=null,this.close(4,t)}R_(t){return n=>{this.Ti.enqueueAndForget(()=>this.i_===t?n():(_e(JL,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class DIe extends RIe{constructor(t,n,i,r,s,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,r,o),this.serializer=s}f_(t,n){return this.connection.Wo("Listen",t,n)}g_(t){return this.onNext(t)}onNext(t){this.a_.reset();const n=HTe(this.serializer,t),i=function(s){if(!("targetChange"in s))return ze.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ze.min():o.readTime?il(o.readTime):ze.min()}(t);return this.listener.p_(n,i)}y_(t){const n={};n.database=GL(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=aw(l)?{documents:$Te(s,l)}:{query:GTe(s,l).ht},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=JW(s,o.resumeToken);const c=cw(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(ze.min())>0){a.readTime=y5(s,o.snapshotVersion.toTimestamp());const c=cw(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,t);const i=jTe(this.serializer,t);i&&(n.labels=i),this.I_(n)}w_(t){const n={};n.database=GL(this.serializer),n.removeTarget=t,this.I_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LIe{}class NIe extends LIe{constructor(t,n,i,r){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=i,this.serializer=r,this.F_=!1}M_(){if(this.F_)throw new Ae(ae.FAILED_PRECONDITION,"The client has already been terminated.")}So(t,n,i,r){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(t,dw(n,i),r,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ae(ae.UNKNOWN,s.toString())})}Co(t,n,i,r,s){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Co(t,dw(n,i),r,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ae(ae.UNKNOWN,o.toString())})}terminate(){this.F_=!0,this.connection.terminate()}}class OIe{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(t){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.L_("Offline")))}set(t){this.Q_(),this.x_=0,t==="Online"&&(this.N_=!1),this.L_(t)}L_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}k_(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(El(n),this.N_=!1):_e("OnlineStateTracker",n)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dg="RemoteStore";class PIe{constructor(t,n,i,r,s){this.localStore=t,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.K_=[],this.U_=new Map,this.W_=new Set,this.G_=[],this.z_=s,this.z_.To(o=>{i.enqueueAndForget(async()=>{Zp(this)&&(_e(dg,"Restarting streams for network reachability change."),await async function(l){const c=rt(l);c.W_.add(4),await Kp(c),c.j_.set("Unknown"),c.W_.delete(4),await pE(c)}(this))})}),this.j_=new OIe(i,r)}}async function pE(e){if(Zp(e))for(const t of e.G_)await t(!0)}async function Kp(e){for(const t of e.G_)await t(!1)}function dK(e,t){const n=rt(e);n.U_.has(t.targetId)||(n.U_.set(t.targetId,t),GI(n)?$I(n):Fg(n).c_()&&VI(n,t))}function HI(e,t){const n=rt(e),i=Fg(n);n.U_.delete(t),i.c_()&&uK(n,t),n.U_.size===0&&(i.c_()?i.P_():Zp(n)&&n.j_.set("Unknown"))}function VI(e,t){if(e.H_.Ne(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(ze.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Fg(e).y_(t)}function uK(e,t){e.H_.Ne(t),Fg(e).w_(t)}function $I(e){e.H_=new DTe({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),lt:t=>e.U_.get(t)||null,it:()=>e.datastore.serializer.databaseId}),Fg(e).start(),e.j_.B_()}function GI(e){return Zp(e)&&!Fg(e).u_()&&e.U_.size>0}function Zp(e){return rt(e).W_.size===0}function fK(e){e.H_=void 0}async function FIe(e){e.j_.set("Online")}async function BIe(e){e.U_.forEach((t,n)=>{VI(e,t)})}async function zIe(e,t){fK(e),GI(e)?(e.j_.q_(t),$I(e)):e.j_.set("Unknown")}async function HIe(e,t,n){if(e.j_.set("Online"),t instanceof QW&&t.state===2&&t.cause)try{await async function(r,s){const o=s.cause;for(const a of s.targetIds)r.U_.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.U_.delete(a),r.H_.removeTarget(a))}(e,t)}catch(i){_e(dg,"Failed to remove targets %s: %s ",t.targetIds.join(","),i),await eN(e,i)}else if(t instanceof hb?e.H_.We(t):t instanceof qW?e.H_.Ze(t):e.H_.je(t),!n.isEqual(ze.min()))try{const i=await cK(e.localStore);n.compareTo(i)>=0&&await function(s,o){const a=s.H_.ot(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.U_.get(c);d&&s.U_.set(c,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const d=s.U_.get(l);if(!d)return;s.U_.set(l,d.withResumeToken(Ni.EMPTY_BYTE_STRING,d.snapshotVersion)),uK(s,l);const u=new fc(d.target,l,c,d.sequenceNumber);VI(s,u)}),s.remoteSyncer.applyRemoteEvent(a)}(e,n)}catch(i){_e(dg,"Failed to raise snapshot:",i),await eN(e,i)}}async function eN(e,t,n){if(!Pg(t))throw t;e.W_.add(1),await Kp(e),e.j_.set("Offline"),n||(n=()=>cK(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{_e(dg,"Retrying IndexedDB access"),await n(),e.W_.delete(1),await pE(e)})}async function tN(e,t){const n=rt(e);n.asyncQueue.verifyOperationInProgress(),_e(dg,"RemoteStore received new credentials");const i=Zp(n);n.W_.add(3),await Kp(n),i&&n.j_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.W_.delete(3),await pE(n)}async function VIe(e,t){const n=rt(e);t?(n.W_.delete(2),await pE(n)):t||(n.W_.add(2),await Kp(n),n.j_.set("Unknown"))}function Fg(e){return e.J_||(e.J_=function(n,i,r){const s=rt(n);return s.M_(),new DIe(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(e.datastore,e.asyncQueue,{xo:FIe.bind(null,e),No:BIe.bind(null,e),Lo:zIe.bind(null,e),p_:HIe.bind(null,e)}),e.G_.push(async t=>{t?(e.J_.h_(),GI(e)?$I(e):e.j_.set("Unknown")):(await e.J_.stop(),fK(e))})),e.J_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI{constructor(t,n,i,r,s){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new Dc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,i,r,s){const o=Date.now()+i,a=new XI(t,n,o,r,s);return a.start(i),a}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ae(ae.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function hK(e,t){if(El("AsyncQueue",`${t}: ${e}`),Pg(e))return new Ae(ae.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{static emptySet(t){return new Th(t.comparator)}constructor(t){this.comparator=t?(n,i)=>t(n,i)||Pe.comparator(n.key,i.key):(n,i)=>Pe.comparator(n.key,i.key),this.keyedMap=J1(),this.sortedSet=new Ln(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,i)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof Th)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const i=new Th;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=n,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nN{constructor(){this.Z_=new Ln(Pe.comparator)}track(t){const n=t.doc.key,i=this.Z_.get(n);i?t.type!==0&&i.type===3?this.Z_=this.Z_.insert(n,t):t.type===3&&i.type!==1?this.Z_=this.Z_.insert(n,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.Z_=this.Z_.insert(n,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.Z_=this.Z_.insert(n,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.Z_=this.Z_.remove(n):t.type===1&&i.type===2?this.Z_=this.Z_.insert(n,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.Z_=this.Z_.insert(n,{type:2,doc:t.doc}):Oe():this.Z_=this.Z_.insert(n,t)}X_(){const t=[];return this.Z_.inorderTraversal((n,i)=>{t.push(i)}),t}}class ug{constructor(t,n,i,r,s,o,a,l,c){this.query=t,this.docs=n,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,n,i,r,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new ug(t,n,Th.emptySet(n),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&dE(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,i=t.docChanges;if(n.length!==i.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==i[r].type||!n[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $Ie{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(t=>t.ra())}}class GIe{constructor(){this.queries=iN(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(n,i){const r=rt(n),s=r.queries;r.queries=iN(),s.forEach((o,a)=>{for(const l of a.ta)l.onError(i)})})(this,new Ae(ae.ABORTED,"Firestore shutting down"))}}function iN(){return new qu(e=>BW(e),dE)}async function XIe(e,t){const n=rt(e);let i=3;const r=t.query;let s=n.queries.get(r);s?!s.na()&&t.ra()&&(i=2):(s=new $Ie,i=t.ra()?0:1);try{switch(i){case 0:s.ea=await n.onListen(r,!0);break;case 1:s.ea=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(o){const a=hK(o,`Initialization of query '${xf(t.query)}' failed`);return void t.onError(a)}n.queries.set(r,s),s.ta.push(t),t.sa(n.onlineState),s.ea&&t.oa(s.ea)&&jI(n)}async function jIe(e,t){const n=rt(e),i=t.query;let r=3;const s=n.queries.get(i);if(s){const o=s.ta.indexOf(t);o>=0&&(s.ta.splice(o,1),s.ta.length===0?r=t.ra()?0:1:!s.na()&&t.ra()&&(r=2))}switch(r){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function YIe(e,t){const n=rt(e);let i=!1;for(const r of t){const s=r.query,o=n.queries.get(s);if(o){for(const a of o.ta)a.oa(r)&&(i=!0);o.ea=r}}i&&jI(n)}function WIe(e,t,n){const i=rt(e),r=i.queries.get(t);if(r)for(const s of r.ta)s.onError(n);i.queries.delete(t)}function jI(e){e.ia.forEach(t=>{t.next()})}var hw,rN;(rN=hw||(hw={}))._a="default",rN.Cache="cache";class KIe{constructor(t,n,i){this.query=t,this.aa=n,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=i||{}}oa(t){if(!this.options.includeMetadataChanges){const i=[];for(const r of t.docChanges)r.type!==3&&i.push(r);t=new ug(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.ua?this.la(t)&&(this.aa.next(t),n=!0):this.ha(t,this.onlineState)&&(this.Pa(t),n=!0),this.ca=t,n}onError(t){this.aa.error(t)}sa(t){this.onlineState=t;let n=!1;return this.ca&&!this.ua&&this.ha(this.ca,t)&&(this.Pa(this.ca),n=!0),n}ha(t,n){if(!t.fromCache||!this.ra())return!0;const i=n!=="Offline";return(!this.options.Ta||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}la(t){if(t.docChanges.length>0)return!0;const n=this.ca&&this.ca.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Pa(t){t=ug.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.ua=!0,this.aa.next(t)}ra(){return this.options.source!==hw.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gK{constructor(t){this.key=t}}class mK{constructor(t){this.key=t}}class ZIe{constructor(t,n){this.query=t,this.fa=n,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=Et(),this.mutatedKeys=Et(),this.ya=zW(t),this.wa=new Th(this.ya)}get Sa(){return this.fa}ba(t,n){const i=n?n.Da:new nN,r=n?n.wa:this.wa;let s=n?n.mutatedKeys:this.mutatedKeys,o=r,a=!1;const l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,c=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(t.inorderTraversal((d,u)=>{const f=r.get(d),h=uE(this.query,u)?u:null,m=!!f&&this.mutatedKeys.has(f.key),p=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let U=!1;f&&h?f.data.isEqual(h.data)?m!==p&&(i.track({type:3,doc:h}),U=!0):this.va(f,h)||(i.track({type:2,doc:h}),U=!0,(l&&this.ya(h,l)>0||c&&this.ya(h,c)<0)&&(a=!0)):!f&&h?(i.track({type:0,doc:h}),U=!0):f&&!h&&(i.track({type:1,doc:f}),U=!0,(l||c)&&(a=!0)),U&&(h?(o=o.add(h),s=p?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),i.track({type:1,doc:d})}return{wa:o,Da:i,ls:a,mutatedKeys:s}}va(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,i,r){const s=this.wa;this.wa=t.wa,this.mutatedKeys=t.mutatedKeys;const o=t.Da.X_();o.sort((d,u)=>function(h,m){const p=U=>{switch(U){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Oe()}};return p(h)-p(m)}(d.type,u.type)||this.ya(d.doc,u.doc)),this.Ca(i),r=r!=null&&r;const a=n&&!r?this.Fa():[],l=this.pa.size===0&&this.current&&!r?1:0,c=l!==this.ga;return this.ga=l,o.length!==0||c?{snapshot:new ug(this.query,t.wa,s,o,t.mutatedKeys,l===0,c,!1,!!i&&i.resumeToken.approximateByteSize()>0),Ma:a}:{Ma:a}}sa(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new nN,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(t){return!this.fa.has(t)&&!!this.wa.has(t)&&!this.wa.get(t).hasLocalMutations}Ca(t){t&&(t.addedDocuments.forEach(n=>this.fa=this.fa.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.fa=this.fa.delete(n)),this.current=t.current)}Fa(){if(!this.current)return[];const t=this.pa;this.pa=Et(),this.wa.forEach(i=>{this.xa(i.key)&&(this.pa=this.pa.add(i.key))});const n=[];return t.forEach(i=>{this.pa.has(i)||n.push(new mK(i))}),this.pa.forEach(i=>{t.has(i)||n.push(new gK(i))}),n}Oa(t){this.fa=t.gs,this.pa=Et();const n=this.ba(t.documents);return this.applyChanges(n,!0)}Na(){return ug.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}}const YI="SyncEngine";class qIe{constructor(t,n,i){this.query=t,this.targetId=n,this.view=i}}class QIe{constructor(t){this.key=t,this.Ba=!1}}class JIe{constructor(t,n,i,r,s,o){this.localStore=t,this.remoteStore=n,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.La={},this.ka=new qu(a=>BW(a),dE),this.qa=new Map,this.Qa=new Set,this.$a=new Ln(Pe.comparator),this.Ka=new Map,this.Ua=new OI,this.Wa={},this.Ga=new Map,this.za=cg.Un(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}}async function eSe(e,t,n=!0){const i=EK(e);let r;const s=i.ka.get(t);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.Na()):r=await pK(i,t,n,!0),r}async function tSe(e,t){const n=EK(e);await pK(n,t,!0,!1)}async function pK(e,t,n,i){const r=await TIe(e.localStore,Wo(t)),s=r.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let a;return i&&(a=await nSe(e,t,s,o==="current",r.resumeToken)),e.isPrimaryClient&&n&&dK(e.remoteStore,r),a}async function nSe(e,t,n,i,r){e.Ha=(u,f,h)=>async function(p,U,b,y){let w=U.view.ba(b);w.ls&&(w=await KL(p.localStore,U.query,!1).then(({documents:_})=>U.view.ba(_,w)));const v=y&&y.targetChanges.get(U.targetId),I=y&&y.targetMismatches.get(U.targetId)!=null,C=U.view.applyChanges(w,p.isPrimaryClient,v,I);return oN(p,U.targetId,C.Ma),C.snapshot}(e,u,f,h);const s=await KL(e.localStore,t,!0),o=new ZIe(t,s.gs),a=o.ba(s.documents),l=Wp.createSynthesizedTargetChangeForCurrentChange(n,i&&e.onlineState!=="Offline",r),c=o.applyChanges(a,e.isPrimaryClient,l);oN(e,n,c.Ma);const d=new qIe(t,n,o);return e.ka.set(t,d),e.qa.has(n)?e.qa.get(n).push(t):e.qa.set(n,[t]),c.snapshot}async function iSe(e,t,n){const i=rt(e),r=i.ka.get(t),s=i.qa.get(r.targetId);if(s.length>1)return i.qa.set(r.targetId,s.filter(o=>!dE(o,t))),void i.ka.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await uw(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),n&&HI(i.remoteStore,r.targetId),gw(i,r.targetId)}).catch(oE)):(gw(i,r.targetId),await uw(i.localStore,r.targetId,!0))}async function rSe(e,t){const n=rt(e),i=n.ka.get(t),r=n.qa.get(i.targetId);n.isPrimaryClient&&r.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),HI(n.remoteStore,i.targetId))}async function UK(e,t){const n=rt(e);try{const i=await wIe(n.localStore,t);t.targetChanges.forEach((r,s)=>{const o=n.Ka.get(s);o&&(jt(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.Ba=!0:r.modifiedDocuments.size>0?jt(o.Ba):r.removedDocuments.size>0&&(jt(o.Ba),o.Ba=!1))}),await yK(n,i,t)}catch(i){await oE(i)}}function sN(e,t,n){const i=rt(e);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const r=[];i.ka.forEach((s,o)=>{const a=o.view.sa(t);a.snapshot&&r.push(a.snapshot)}),function(o,a){const l=rt(o);l.onlineState=a;let c=!1;l.queries.forEach((d,u)=>{for(const f of u.ta)f.sa(a)&&(c=!0)}),c&&jI(l)}(i.eventManager,t),r.length&&i.La.p_(r),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function sSe(e,t,n){const i=rt(e);i.sharedClientState.updateQueryState(t,"rejected",n);const r=i.Ka.get(t),s=r&&r.key;if(s){let o=new Ln(Pe.comparator);o=o.insert(s,Ui.newNoDocument(s,ze.min()));const a=Et().add(s),l=new gE(ze.min(),new Map,new Ln(ft),o,a);await UK(i,l),i.$a=i.$a.remove(s),i.Ka.delete(t),WI(i)}else await uw(i.localStore,t,!1).then(()=>gw(i,t,n)).catch(oE)}function gw(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.qa.get(t))e.ka.delete(i),n&&e.La.Ja(i,n);e.qa.delete(t),e.isPrimaryClient&&e.Ua.br(t).forEach(i=>{e.Ua.containsKey(i)||bK(e,i)})}function bK(e,t){e.Qa.delete(t.path.canonicalString());const n=e.$a.get(t);n!==null&&(HI(e.remoteStore,n),e.$a=e.$a.remove(t),e.Ka.delete(n),WI(e))}function oN(e,t,n){for(const i of n)i instanceof gK?(e.Ua.addReference(i.key,t),oSe(e,i)):i instanceof mK?(_e(YI,"Document no longer in limbo: "+i.key),e.Ua.removeReference(i.key,t),e.Ua.containsKey(i.key)||bK(e,i.key)):Oe()}function oSe(e,t){const n=t.key,i=n.path.canonicalString();e.$a.get(n)||e.Qa.has(i)||(_e(YI,"New document in limbo: "+n),e.Qa.add(i),WI(e))}function WI(e){for(;e.Qa.size>0&&e.$a.size<e.maxConcurrentLimboResolutions;){const t=e.Qa.values().next().value;e.Qa.delete(t);const n=new Pe(cn.fromString(t)),i=e.za.next();e.Ka.set(i,new QIe(n)),e.$a=e.$a.insert(n,i),dK(e.remoteStore,new fc(Wo(kI(n.path)),i,"TargetPurposeLimboResolution",aE.ae))}}async function yK(e,t,n){const i=rt(e),r=[],s=[],o=[];i.ka.isEmpty()||(i.ka.forEach((a,l)=>{o.push(i.Ha(l,t,n).then(c=>{var d;if((c||n)&&i.isPrimaryClient){const u=c?!c.fromCache:(d=n==null?void 0:n.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;i.sharedClientState.updateQueryState(l.targetId,u?"current":"not-current")}if(c){r.push(c);const u=FI.Yi(l.targetId,c);s.push(u)}}))}),await Promise.all(o),i.La.p_(r),await async function(l,c){const d=rt(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>re.forEach(c,f=>re.forEach(f.Hi,h=>d.persistence.referenceDelegate.addReference(u,f.targetId,h)).next(()=>re.forEach(f.Ji,h=>d.persistence.referenceDelegate.removeReference(u,f.targetId,h)))))}catch(u){if(!Pg(u))throw u;_e(BI,"Failed to update sequence numbers: "+u)}for(const u of c){const f=u.targetId;if(!u.fromCache){const h=d.Ts.get(f),m=h.snapshotVersion,p=h.withLastLimboFreeSnapshotVersion(m);d.Ts=d.Ts.insert(f,p)}}}(i.localStore,s))}async function aSe(e,t){const n=rt(e);if(!n.currentUser.isEqual(t)){_e(YI,"User change. New user:",t.toKey());const i=await lK(n.localStore,t);n.currentUser=t,function(s,o){s.Ga.forEach(a=>{a.forEach(l=>{l.reject(new Ae(ae.CANCELLED,o))})}),s.Ga.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await yK(n,i.Rs)}}function lSe(e,t){const n=rt(e),i=n.Ka.get(t);if(i&&i.Ba)return Et().add(i.key);{let r=Et();const s=n.qa.get(t);if(!s)return r;for(const o of s){const a=n.ka.get(o);r=r.unionWith(a.view.Sa)}return r}}function EK(e){const t=rt(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=UK.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=lSe.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=sSe.bind(null,t),t.La.p_=YIe.bind(null,t.eventManager),t.La.Ja=WIe.bind(null,t.eventManager),t}class w5{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=mE(t.databaseInfo.databaseId),this.sharedClientState=this.Za(t),this.persistence=this.Xa(t),await this.persistence.start(),this.localStore=this.eu(t),this.gcScheduler=this.tu(t,this.localStore),this.indexBackfillerScheduler=this.nu(t,this.localStore)}tu(t,n){return null}nu(t,n){return null}eu(t){return vIe(this.persistence,new bIe,t.initialUser,this.serializer)}Xa(t){return new aK(PI.ri,this.serializer)}Za(t){return new SIe}async terminate(){var t,n;(t=this.gcScheduler)===null||t===void 0||t.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}w5.provider={build:()=>new w5};class cSe extends w5{constructor(t){super(),this.cacheSizeBytes=t}tu(t,n){jt(this.persistence.referenceDelegate instanceof v5);const i=this.persistence.referenceDelegate.garbageCollector;return new iIe(i,t.asyncQueue,n)}Xa(t){const n=this.cacheSizeBytes!==void 0?wr.withCacheSize(this.cacheSizeBytes):wr.DEFAULT;return new aK(i=>v5.ri(i,n),this.serializer)}}class mw{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>sN(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=aSe.bind(null,this.syncEngine),await VIe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new GIe}()}createDatastore(t){const n=mE(t.databaseInfo.databaseId),i=function(s){return new kIe(s)}(t.databaseInfo);return function(s,o,a,l){return new NIe(s,o,a,l)}(t.authCredentials,t.appCheckCredentials,i,n)}createRemoteStore(t){return function(i,r,s,o,a){return new PIe(i,r,s,o,a)}(this.localStore,this.datastore,t.asyncQueue,n=>sN(this.syncEngine,n,0),function(){return QL.D()?new QL:new xIe}())}createSyncEngine(t,n){return function(r,s,o,a,l,c,d){const u=new JIe(r,s,o,a,l,c);return d&&(u.ja=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}async terminate(){var t,n;await async function(r){const s=rt(r);_e(dg,"RemoteStore shutting down."),s.W_.add(5),await Kp(s),s.z_.shutdown(),s.j_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}mw.provider={build:()=>new mw};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dSe{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.iu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.iu(this.observer.error,t):El("Uncaught Error in snapshot listener:",t.toString()))}su(){this.muted=!0}iu(t,n){setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uSe{constructor(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(t){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Ae(ae.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(r,s){const o=rt(r),a={documents:s.map(u=>E5(o.serializer,u))},l=await o.Co("BatchGetDocuments",o.serializer.databaseId,cn.emptyPath(),a,s.length),c=new Map;l.forEach(u=>{const f=zTe(o.serializer,u);c.set(f.key.toString(),f)});const d=[];return s.forEach(u=>{const f=c.get(u.toString());jt(!!f),d.push(f)}),d}(this.datastore,t);return n.forEach(i=>this.recordVersion(i)),n}set(t,n){this.write(n.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())}update(t,n){try{this.write(n.toMutation(t,this.preconditionForUpdate(t)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(t.toString())}delete(t){this.write(new DI(t,this.precondition(t))),this.writtenDocs.add(t.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const t=this.readVersions;this.mutations.forEach(n=>{t.delete(n.key.toString())}),t.forEach((n,i)=>{const r=Pe.fromPath(i);this.mutations.push(new KW(r,this.precondition(r)))}),await async function(i,r){const s=rt(i),o={writes:r.map(a=>VTe(s.serializer,a))};await s.So("Commit",s.serializer.databaseId,cn.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(t){let n;if(t.isFoundDocument())n=t.version;else{if(!t.isNoDocument())throw Oe();n=ze.min()}const i=this.readVersions.get(t.key.toString());if(i){if(!n.isEqual(i))throw new Ae(ae.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),n)}precondition(t){const n=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&n?n.isEqual(ze.min())?ws.exists(!1):ws.updateTime(n):ws.none()}preconditionForUpdate(t){const n=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&n){if(n.isEqual(ze.min()))throw new Ae(ae.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ws.updateTime(n)}return ws.exists(!0)}write(t){this.ensureCommitNotCalled(),this.mutations.push(t)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fSe{constructor(t,n,i,r,s){this.asyncQueue=t,this.datastore=n,this.options=i,this.updateFunction=r,this.deferred=s,this.Tu=i.maxAttempts,this.a_=new zI(this.asyncQueue,"transaction_retry")}Iu(){this.Tu-=1,this.Eu()}Eu(){this.a_.Xo(async()=>{const t=new uSe(this.datastore),n=this.du(t);n&&n.then(i=>{this.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{this.deferred.resolve(i)}).catch(r=>{this.Au(r)}))}).catch(i=>{this.Au(i)})})}du(t){try{const n=this.updateFunction(t);return!jp(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Au(t){this.Tu>0&&this.Ru(t)?(this.Tu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Eu(),Promise.resolve()))):this.deferred.reject(t)}Ru(t){if(t.name==="FirebaseError"){const n=t.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!MTe(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nd="FirestoreClient";class hSe{constructor(t,n,i,r,s){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=r,this.user=$i.UNAUTHENTICATED,this.clientId=_W.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,async o=>{_e(nd,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(i,o=>(_e(nd,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Dc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const i=hK(n,"Failed to shutdown persistence");t.reject(i)}}),t.promise}}async function s7(e,t){e.asyncQueue.verifyOperationInProgress(),_e(nd,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener(async r=>{i.isEqual(r)||(await lK(t.localStore,r),i=r)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function aN(e,t){e.asyncQueue.verifyOperationInProgress();const n=await gSe(e);_e(nd,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(i=>tN(t.remoteStore,i)),e.setAppCheckTokenChangeListener((i,r)=>tN(t.remoteStore,r)),e._onlineComponents=t}async function gSe(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){_e(nd,"Using user provided OfflineComponentProvider");try{await s7(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(r){return r.name==="FirebaseError"?r.code===ae.FAILED_PRECONDITION||r.code===ae.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(n))throw n;sg("Error using user provided cache. Falling back to memory cache: "+n),await s7(e,new w5)}}else _e(nd,"Using default OfflineComponentProvider"),await s7(e,new cSe(void 0));return e._offlineComponents}async function vK(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(_e(nd,"Using user provided OnlineComponentProvider"),await aN(e,e._uninitializedComponentsProvider._online)):(_e(nd,"Using default OnlineComponentProvider"),await aN(e,new mw))),e._onlineComponents}function mSe(e){return vK(e).then(t=>t.datastore)}async function pSe(e){const t=await vK(e),n=t.eventManager;return n.onListen=eSe.bind(null,t.syncEngine),n.onUnlisten=iSe.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=tSe.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=rSe.bind(null,t.syncEngine),n}function USe(e,t,n={}){const i=new Dc;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const d=new dSe({next:f=>{d.su(),o.enqueueAndForget(()=>jIe(s,u));const h=f.docs.has(a);!h&&f.fromCache?c.reject(new Ae(ae.UNAVAILABLE,"Failed to get document because the client is offline.")):h&&f.fromCache&&l&&l.source==="server"?c.reject(new Ae(ae.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),u=new KIe(kI(a.path),d,{includeMetadataChanges:!0,Ta:!0});return XIe(s,u)}(await pSe(e),e.asyncQueue,t,n,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wK(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lN=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bSe(e,t,n){if(!n)throw new Ae(ae.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function ySe(e,t,n,i){if(t===!0&&i===!0)throw new Ae(ae.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function cN(e){if(!Pe.isDocumentKey(e))throw new Ae(ae.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function KI(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(i){return i.constructor?i.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":Oe()}function _5(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Ae(ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=KI(e);throw new Ae(ae.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _K="firestore.googleapis.com",dN=!0;class uN{constructor(t){var n,i;if(t.host===void 0){if(t.ssl!==void 0)throw new Ae(ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=_K,this.ssl=dN}else this.host=t.host,this.ssl=(n=t.ssl)!==null&&n!==void 0?n:dN;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=oK;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<tIe)throw new Ae(ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}ySe("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=wK((i=t.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Ae(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Ae(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Ae(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class ZI{constructor(t,n,i,r){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new uN({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ae(ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new Ae(ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new uN(t),t.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new R9e;switch(i.type){case"firstParty":return new O9e(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ae(ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const i=lN.get(n);i&&(_e("ComponentProvider","Removing Datastore"),lN.delete(n),i.terminate())}(this),Promise.resolve()}}function ESe(e,t,n,i={}){var r;const s=(e=_5(e,ZI))._getSettings(),o=`${t}:${n}`;if(s.host!==_K&&s.host!==o&&sg("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let a,l;if(typeof i.mockUserToken=="string")a=i.mockUserToken,l=$i.MOCK_USER;else{a=rW(i.mockUserToken,(r=e._app)===null||r===void 0?void 0:r.options.projectId);const c=i.mockUserToken.sub||i.mockUserToken.user_id;if(!c)throw new Ae(ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new $i(c)}e._authCredentials=new D9e(new wW(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qI{constructor(t,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new qI(this.firestore,t,this._query)}}class Ds{constructor(t,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Jm(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Ds(this.firestore,t,this._key)}}class Jm extends qI{constructor(t,n,i){super(t,n,kI(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Ds(this.firestore,null,new Pe(t))}withConverter(t){return new Jm(this.firestore,t,this._path)}}function TK(e,t,...n){if(e=po(e),arguments.length===1&&(t=_W.newId()),bSe("doc","path",t),e instanceof ZI){const i=cn.fromString(t,...n);return cN(i),new Ds(e,null,new Pe(i))}{if(!(e instanceof Ds||e instanceof Jm))throw new Ae(ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(cn.fromString(t,...n));return cN(i),new Ds(e.firestore,e instanceof Jm?e.converter:null,new Pe(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fN="AsyncQueue";class hN{constructor(t=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new zI(this,"async_queue_retry"),this.Su=()=>{const i=r7();i&&_e(fN,"Visibility state changed to "+i.visibilityState),this.a_.t_()},this.bu=t;const n=r7();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Du(),this.vu(t)}enterRestrictedMode(t){if(!this.mu){this.mu=!0,this.yu=t||!1;const n=r7();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Su)}}enqueue(t){if(this.Du(),this.mu)return new Promise(()=>{});const n=new Dc;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Vu.push(t),this.Cu()))}async Cu(){if(this.Vu.length!==0){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(t){if(!Pg(t))throw t;_e(fN,"Operation failed with retryable error: "+t)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}}vu(t){const n=this.bu.then(()=>(this.pu=!0,t().catch(i=>{this.gu=i,this.pu=!1;const r=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(i);throw El("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.pu=!1,i))));return this.bu=n,n}enqueueAfterDelay(t,n,i){this.Du(),this.wu.indexOf(t)>-1&&(n=0);const r=XI.createAndSchedule(this,t,n,i,s=>this.Fu(s));return this.fu.push(r),r}Du(){this.gu&&Oe()}verifyOperationInProgress(){}async Mu(){let t;do t=this.bu,await t;while(t!==this.bu)}xu(t){for(const n of this.fu)if(n.timerId===t)return!0;return!1}Ou(t){return this.Mu().then(()=>{this.fu.sort((n,i)=>n.targetTimeMs-i.targetTimeMs);for(const n of this.fu)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.Mu()})}Nu(t){this.wu.push(t)}Fu(t){const n=this.fu.indexOf(t);this.fu.splice(n,1)}}class QI extends ZI{constructor(t,n,i,r){super(t,n,i,r),this.type="firestore",this._queue=new hN,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new hN(t),this._firestoreClient=void 0,await t}}}function vSe(e,t){const n=typeof e=="object"?e:hW(),i=typeof e=="string"?e:h5,r=cW(n,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=nW("firestore");s&&ESe(r,...s)}return r}function IK(e){if(e._terminated)throw new Ae(ae.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||wSe(e),e._firestoreClient}function wSe(e){var t,n,i;const r=e._freezeSettings(),s=function(a,l,c,d){return new q9e(a,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,wK(d.experimentalLongPollingOptions),d.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,r);e._componentsProvider||!((n=r.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(e._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),e._firestoreClient=new hSe(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl{constructor(t){this._byteString=t}static fromBase64String(t){try{return new vl(Ni.fromBase64String(t))}catch(n){throw new Ae(ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new vl(Ni.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UE{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new Ae(ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ji(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JI{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new Ae(ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new Ae(ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return ft(this._lat,t._lat)||ft(this._long,t._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS{constructor(t){this._values=(t||[]).map(n=>n)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(this._values,t._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _Se=/^__.*__$/;class TSe{constructor(t,n,i){this.data=t,this.fieldMask=n,this.fieldTransforms=i}toMutation(t,n){return this.fieldMask!==null?new Qu(t,this.data,this.fieldMask,n,this.fieldTransforms):new Yp(t,this.data,n,this.fieldTransforms)}}class SK{constructor(t,n,i){this.data=t,this.fieldMask=n,this.fieldTransforms=i}toMutation(t,n){return new Qu(t,this.data,this.fieldMask,n,this.fieldTransforms)}}function xK(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Oe()}}class nS{constructor(t,n,i,r,s,o){this.settings=t,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.Bu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(t){return new nS(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(t){var n;const i=(n=this.path)===null||n===void 0?void 0:n.child(t),r=this.ku({path:i,Qu:!1});return r.$u(t),r}Ku(t){var n;const i=(n=this.path)===null||n===void 0?void 0:n.child(t),r=this.ku({path:i,Qu:!1});return r.Bu(),r}Uu(t){return this.ku({path:void 0,Qu:!0})}Wu(t){return T5(t,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}Bu(){if(this.path)for(let t=0;t<this.path.length;t++)this.$u(this.path.get(t))}$u(t){if(t.length===0)throw this.Wu("Document fields must not be empty");if(xK(this.Lu)&&_Se.test(t))throw this.Wu('Document fields cannot begin and end with "__"')}}class ISe{constructor(t,n,i){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=i||mE(t)}ju(t,n,i,r=!1){return new nS({Lu:t,methodName:n,zu:i,path:ji.emptyPath(),Qu:!1,Gu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function SSe(e){const t=e._freezeSettings(),n=mE(e._databaseId);return new ISe(e._databaseId,!!t.ignoreUndefinedProperties,n)}function xSe(e,t,n,i,r,s={}){const o=e.ju(s.merge||s.mergeFields?2:0,t,n,r);iS("Data must be an object, but it was:",o,i);const a=CK(i,o);let l,c;if(s.merge)l=new Ss(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const u of s.mergeFields){const f=pw(t,u,n);if(!o.contains(f))throw new Ae(ae.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);MK(d,f)||d.push(f)}l=new Ss(d),c=o.fieldTransforms.filter(u=>l.covers(u.field))}else l=null,c=o.fieldTransforms;return new TSe(new _r(a),l,c)}class bE extends JI{_toFieldTransform(t){if(t.Lu!==2)throw t.Lu===1?t.Wu(`${this._methodName}() can only appear at the top level of your update data`):t.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof bE}}function CSe(e,t,n,i){const r=e.ju(1,t,n);iS("Data must be an object, but it was:",r,i);const s=[],o=_r.empty();Zu(i,(l,c)=>{const d=rS(t,l,n);c=po(c);const u=r.Ku(d);if(c instanceof bE)s.push(d);else{const f=yE(c,u);f!=null&&(s.push(d),o.set(d,f))}});const a=new Ss(s);return new SK(o,a,r.fieldTransforms)}function ASe(e,t,n,i,r,s){const o=e.ju(1,t,n),a=[pw(t,i,n)],l=[r];if(s.length%2!=0)throw new Ae(ae.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)a.push(pw(t,s[f])),l.push(s[f+1]);const c=[],d=_r.empty();for(let f=a.length-1;f>=0;--f)if(!MK(c,a[f])){const h=a[f];let m=l[f];m=po(m);const p=o.Ku(h);if(m instanceof bE)c.push(h);else{const U=yE(m,p);U!=null&&(c.push(h),d.set(h,U))}}const u=new Ss(c);return new SK(d,u,o.fieldTransforms)}function yE(e,t){if(AK(e=po(e)))return iS("Unsupported field value:",t,e),CK(e,t);if(e instanceof JI)return function(i,r){if(!xK(r.Lu))throw r.Wu(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Wu(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Qu&&t.Lu!==4)throw t.Wu("Nested arrays are not supported");return function(i,r){const s=[];let o=0;for(const a of i){let l=yE(a,r.Uu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(e,t)}return function(i,r){if((i=po(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return vTe(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=wi.fromDate(i);return{timestampValue:y5(r.serializer,s)}}if(i instanceof wi){const s=new wi(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:y5(r.serializer,s)}}if(i instanceof eS)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof vl)return{bytesValue:JW(r.serializer,i._byteString)};if(i instanceof Ds){const s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.Wu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:NI(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof tS)return function(o,a){return{mapValue:{fields:{[kW]:{stringValue:RW},[g5]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Wu("VectorValues must only contain numeric values.");return RI(a.serializer,c)})}}}}}}(i,r);throw r.Wu(`Unsupported field value: ${KI(i)}`)}(e,t)}function CK(e,t){const n={};return IW(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Zu(e,(i,r)=>{const s=yE(r,t.qu(i));s!=null&&(n[i]=s)}),{mapValue:{fields:n}}}function AK(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof wi||e instanceof eS||e instanceof vl||e instanceof Ds||e instanceof JI||e instanceof tS)}function iS(e,t,n){if(!AK(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const i=KI(n);throw i==="an object"?t.Wu(e+" a custom object"):t.Wu(e+" "+i)}}function pw(e,t,n){if((t=po(t))instanceof UE)return t._internalPath;if(typeof t=="string")return rS(e,t);throw T5("Field path arguments must be of type string or ",e,!1,void 0,n)}const MSe=new RegExp("[~\\*/\\[\\]]");function rS(e,t,n){if(t.search(MSe)>=0)throw T5(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new UE(...t.split("."))._internalPath}catch{throw T5(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function T5(e,t,n,i,r){const s=i&&!i.isEmpty(),o=r!==void 0;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${i}`),o&&(l+=` in document ${r}`),l+=")"),new Ae(ae.INVALID_ARGUMENT,a+e+l)}function MK(e,t){return e.some(n=>n.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I5{constructor(t,n,i,r,s){this._firestore=t,this._userDataWriter=n,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ds(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new kSe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const n=this._document.data.field(kK("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class kSe extends I5{data(){return super.data()}}function kK(e,t){return typeof t=="string"?rS(e,t):t instanceof UE?t._internalPath:t._delegate._internalPath}class RK{convertValue(t,n="none"){switch(ed(t)){case 0:return null;case 1:return t.booleanValue;case 2:return kn(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(Jc(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 11:return this.convertObject(t.mapValue,n);case 10:return this.convertVectorValue(t.mapValue);default:throw Oe()}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){const i={};return Zu(t,(r,s)=>{i[r]=this.convertValue(s,n)}),i}convertVectorValue(t){var n,i,r;const s=(r=(i=(n=t.fields)===null||n===void 0?void 0:n[g5].arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.map(o=>kn(o.doubleValue));return new tS(s)}convertGeoPoint(t){return new eS(kn(t.latitude),kn(t.longitude))}convertArray(t,n){return(t.values||[]).map(i=>this.convertValue(i,n))}convertServerTimestamp(t,n){switch(n){case"previous":const i=lE(t);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(Wm(t));default:return null}}convertTimestamp(t){const n=Qc(t);return new wi(n.seconds,n.nanos)}convertDocumentKey(t,n){const i=cn.fromString(t);jt(sK(i));const r=new Km(i.get(1),i.get(3)),s=new Pe(i.popFirst(5));return r.isEqual(n)||El(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RSe(e,t,n){let i;return i=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,i}class DSe extends RK{constructor(t){super(),this.firestore=t}convertBytes(t){return new vl(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new Ds(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DK{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class sS extends I5{constructor(t,n,i,r,s,o){super(t,n,i,r,o),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new LSe(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const i=this._document.data.field(kK("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}}class LSe extends sS{data(t={}){return super.data(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NSe(e){e=_5(e,Ds);const t=_5(e.firestore,QI);return USe(IK(t),e._key).then(n=>OSe(t,e,n))}class LK extends RK{constructor(t){super(),this.firestore=t}convertBytes(t){return new vl(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new Ds(this.firestore,null,n)}}function OSe(e,t,n){const i=n.docs.get(t._key),r=new LK(e);return new sS(e,r,t._key,i,new DK(n.hasPendingWrites,n.fromCache),t.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PSe={maxAttempts:5};function t0(e,t){if((e=po(e)).firestore!==t)throw new Ae(ae.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FSe{constructor(t,n){this._firestore=t,this._transaction=n,this._dataReader=SSe(t)}get(t){const n=t0(t,this._firestore),i=new DSe(this._firestore);return this._transaction.lookup([n._key]).then(r=>{if(!r||r.length!==1)return Oe();const s=r[0];if(s.isFoundDocument())return new I5(this._firestore,i,s.key,s,n.converter);if(s.isNoDocument())return new I5(this._firestore,i,n._key,null,n.converter);throw Oe()})}set(t,n,i){const r=t0(t,this._firestore),s=RSe(r.converter,n,i),o=xSe(this._dataReader,"Transaction.set",r._key,s,r.converter!==null,i);return this._transaction.set(r._key,o),this}update(t,n,i,...r){const s=t0(t,this._firestore);let o;return o=typeof(n=po(n))=="string"||n instanceof UE?ASe(this._dataReader,"Transaction.update",s._key,n,i,r):CSe(this._dataReader,"Transaction.update",s._key,n),this._transaction.update(s._key,o),this}delete(t){const n=t0(t,this._firestore);return this._transaction.delete(n._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BSe extends FSe{constructor(t,n){super(t,n),this._firestore=t}get(t){const n=t0(t,this._firestore),i=new LK(this._firestore);return super.get(t).then(r=>new sS(this._firestore,i,n._key,r._document,new DK(!1,!1),n.converter))}}function zSe(e,t,n){e=_5(e,QI);const i=Object.assign(Object.assign({},PSe),n);return function(s){if(s.maxAttempts<1)throw new Ae(ae.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(s,o,a){const l=new Dc;return s.asyncQueue.enqueueAndForget(async()=>{const c=await mSe(s);new fSe(s.asyncQueue,c,a,o,l).Iu()}),l.promise}(IK(e),r=>t(new BSe(e,r)),i)}(function(t,n=!0){(function(r){Og=r})(uW),Xm(new rg("firestore",(i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),a=new QI(new L9e(i.getProvider("auth-internal")),new P9e(o,i.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Ae(ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Km(c.options.projectId,d)}(o,r),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),kc(yL,EL,t),kc(yL,EL,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NK="firebasestorage.googleapis.com",OK="storageBucket",HSe=2*60*1e3,VSe=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn extends Ku{constructor(t,n,i=0){super(o7(t),`Firebase Storage: ${n} (${o7(t)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Zn.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return o7(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Kn;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Kn||(Kn={}));function o7(e){return"storage/"+e}function oS(){const e="An unknown error occurred, please check the error payload for server response.";return new Zn(Kn.UNKNOWN,e)}function $Se(e){return new Zn(Kn.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function GSe(){const e="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Zn(Kn.UNAUTHENTICATED,e)}function XSe(){return new Zn(Kn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function jSe(e){return new Zn(Kn.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}function YSe(){return new Zn(Kn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function WSe(){return new Zn(Kn.CANCELED,"User canceled the upload/download.")}function KSe(e){return new Zn(Kn.INVALID_URL,"Invalid URL '"+e+"'.")}function ZSe(e){return new Zn(Kn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function qSe(){return new Zn(Kn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+OK+"' property when initializing the app?")}function QSe(){return new Zn(Kn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function JSe(e){return new Zn(Kn.UNSUPPORTED_ENVIRONMENT,`${e} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Uw(e){return new Zn(Kn.INVALID_ARGUMENT,e)}function PK(){return new Zn(Kn.APP_DELETED,"The Firebase app was deleted.")}function exe(e){return new Zn(Kn.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function X0(e,t){return new Zn(Kn.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function C1(e){throw new Zn(Kn.INTERNAL_ERROR,"Internal error: "+e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(t,n){this.bucket=t,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,n){let i;try{i=Kr.makeFromUrl(t,n)}catch{return new Kr(t,"")}if(i.path==="")return i;throw ZSe(t)}static makeFromUrl(t,n){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(v){v.path.charAt(v.path.length-1)==="/"&&(v.path_=v.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),l={bucket:1,path:3};function c(v){v.path_=decodeURIComponent(v.path)}const d="v[A-Za-z0-9_]+",u=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",h=new RegExp(`^https?://${u}/${d}/b/${r}/o${f}`,"i"),m={bucket:1,path:3},p=n===NK?"(?:storage.googleapis.com|storage.cloud.google.com)":n,U="([^?#]*)",b=new RegExp(`^https?://${p}/${r}/${U}`,"i"),w=[{regex:a,indices:l,postModify:s},{regex:h,indices:m,postModify:c},{regex:b,indices:{bucket:1,path:2},postModify:c}];for(let v=0;v<w.length;v++){const I=w[v],C=I.regex.exec(t);if(C){const _=C[I.indices.bucket];let T=C[I.indices.path];T||(T=""),i=new Kr(_,T),I.postModify(i);break}}if(i==null)throw KSe(t);return i}}class txe{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nxe(e,t,n){let i=1,r=null,s=null,o=!1,a=0;function l(){return a===2}let c=!1;function d(...U){c||(c=!0,t.apply(null,U))}function u(U){r=setTimeout(()=>{r=null,e(h,l())},U)}function f(){s&&clearTimeout(s)}function h(U,...b){if(c){f();return}if(U){f(),d.call(null,U,...b);return}if(l()||o){f(),d.call(null,U,...b);return}i<64&&(i*=2);let w;a===1?(a=2,w=0):w=(i+Math.random())*1e3,u(w)}let m=!1;function p(U){m||(m=!0,f(),!c&&(r!==null?(U||(a=2),clearTimeout(r),u(0)):U||(a=1)))}return u(0),s=setTimeout(()=>{o=!0,p(!0)},n),p}function ixe(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rxe(e){return e!==void 0}function sxe(e){return typeof e=="object"&&!Array.isArray(e)}function FK(e){return typeof e=="string"||e instanceof String}function gN(e){return aS()&&e instanceof Blob}function aS(){return typeof Blob<"u"}function mN(e,t,n,i){if(i<t)throw Uw(`Invalid value for '${e}'. Expected ${t} or greater.`);if(i>n)throw Uw(`Invalid value for '${e}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oxe(e,t,n){let i=t;return n==null&&(i=`https://${t}`),`${n}://${i}/v0${e}`}function axe(e){const t=encodeURIComponent;let n="?";for(const i in e)if(e.hasOwnProperty(i)){const r=t(i)+"="+t(e[i]);n=n+r+"&"}return n=n.slice(0,-1),n}var ru;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(ru||(ru={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lxe(e,t){const n=e>=500&&e<600,r=[408,429].indexOf(e)!==-1,s=t.indexOf(e)!==-1;return n||r||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cxe{constructor(t,n,i,r,s,o,a,l,c,d,u,f=!0){this.url_=t,this.method_=n,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=d,this.connectionFactory_=u,this.retry=f,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((h,m)=>{this.resolve_=h,this.reject_=m,this.start_()})}start_(){const t=(i,r)=>{if(r){i(!1,new U2(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===ru.NO_ERROR,l=s.getStatus();if(!a||lxe(l,this.additionalRetryCodes_)&&this.retry){const d=s.getErrorCode()===ru.ABORT;i(!1,new U2(!1,null,d));return}const c=this.successCodes_.indexOf(l)!==-1;i(!0,new U2(c,s))})},n=(i,r)=>{const s=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());rxe(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=oS();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(r.canceled){const l=this.appDelete_?PK():WSe();o(l)}else{const l=YSe();o(l)}};this.canceled_?n(!1,new U2(!1,null,!0)):this.backoffId_=nxe(t,n,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&ixe(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class U2{constructor(t,n,i){this.wasSuccessCode=t,this.connection=n,this.canceled=!!i}}function dxe(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function uxe(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function fxe(e,t){t&&(e["X-Firebase-GMPID"]=t)}function hxe(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function gxe(e,t,n,i,r,s,o=!0){const a=axe(e.urlParams),l=e.url+a,c=Object.assign({},e.headers);return fxe(c,t),dxe(c,n),uxe(c,s),hxe(c,i),new cxe(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,r,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mxe(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function pxe(...e){const t=mxe();if(t!==void 0){const n=new t;for(let i=0;i<e.length;i++)n.append(e[i]);return n.getBlob()}else{if(aS())return new Blob(e);throw new Zn(Kn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function Uxe(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bxe(e){if(typeof atob>"u")throw JSe("base-64");return atob(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ho={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class a7{constructor(t,n){this.data=t,this.contentType=n||null}}function yxe(e,t){switch(e){case Ho.RAW:return new a7(BK(t));case Ho.BASE64:case Ho.BASE64URL:return new a7(zK(e,t));case Ho.DATA_URL:return new a7(vxe(t),wxe(t))}throw oS()}function BK(e){const t=[];for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);if(i<=127)t.push(i);else if(i<=2047)t.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(n<e.length-1&&(e.charCodeAt(n+1)&64512)===56320))t.push(239,191,189);else{const s=i,o=e.charCodeAt(++n);i=65536|(s&1023)<<10|o&1023,t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?t.push(239,191,189):t.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(t)}function Exe(e){let t;try{t=decodeURIComponent(e)}catch{throw X0(Ho.DATA_URL,"Malformed data URL.")}return BK(t)}function zK(e,t){switch(e){case Ho.BASE64:{const r=t.indexOf("-")!==-1,s=t.indexOf("_")!==-1;if(r||s)throw X0(e,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case Ho.BASE64URL:{const r=t.indexOf("+")!==-1,s=t.indexOf("/")!==-1;if(r||s)throw X0(e,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=bxe(t)}catch(r){throw r.message.includes("polyfill")?r:X0(e,"Invalid character found")}const i=new Uint8Array(n.length);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i}class HK{constructor(t){this.base64=!1,this.contentType=null;const n=t.match(/^data:([^,]+)?,/);if(n===null)throw X0(Ho.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=n[1]||null;i!=null&&(this.base64=_xe(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=t.substring(t.indexOf(",")+1)}}function vxe(e){const t=new HK(e);return t.base64?zK(Ho.BASE64,t.rest):Exe(t.rest)}function wxe(e){return new HK(e).contentType}function _xe(e,t){return e.length>=t.length?e.substring(e.length-t.length)===t:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(t,n){let i=0,r="";gN(t)?(this.data_=t,i=t.size,r=t.type):t instanceof ArrayBuffer?(n?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),i=this.data_.length):t instanceof Uint8Array&&(n?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),i=t.length),this.size_=i,this.type_=r}size(){return this.size_}type(){return this.type_}slice(t,n){if(gN(this.data_)){const i=this.data_,r=Uxe(i,t,n);return r===null?null:new sc(r)}else{const i=new Uint8Array(this.data_.buffer,t,n-t);return new sc(i,!0)}}static getBlob(...t){if(aS()){const n=t.map(i=>i instanceof sc?i.data_:i);return new sc(pxe.apply(null,n))}else{const n=t.map(o=>FK(o)?yxe(Ho.RAW,o).data:o.data_);let i=0;n.forEach(o=>{i+=o.byteLength});const r=new Uint8Array(i);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)r[s++]=o[a]}),new sc(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Txe(e){let t;try{t=JSON.parse(e)}catch{return null}return sxe(t)?t:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ixe(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function Sxe(e,t){const n=t.split("/").filter(i=>i.length>0).join("/");return e.length===0?n:e+"/"+n}function VK(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xxe(e,t){return t}class ir{constructor(t,n,i,r){this.server=t,this.local=n||t,this.writable=!!i,this.xform=r||xxe}}let b2=null;function Cxe(e){return!FK(e)||e.length<2?e:VK(e)}function Axe(){if(b2)return b2;const e=[];e.push(new ir("bucket")),e.push(new ir("generation")),e.push(new ir("metageneration")),e.push(new ir("name","fullPath",!0));function t(s,o){return Cxe(o)}const n=new ir("name");n.xform=t,e.push(n);function i(s,o){return o!==void 0?Number(o):o}const r=new ir("size");return r.xform=i,e.push(r),e.push(new ir("timeCreated")),e.push(new ir("updated")),e.push(new ir("md5Hash",null,!0)),e.push(new ir("cacheControl",null,!0)),e.push(new ir("contentDisposition",null,!0)),e.push(new ir("contentEncoding",null,!0)),e.push(new ir("contentLanguage",null,!0)),e.push(new ir("contentType",null,!0)),e.push(new ir("metadata","customMetadata",!0)),b2=e,b2}function Mxe(e,t){function n(){const i=e.bucket,r=e.fullPath,s=new Kr(i,r);return t._makeStorageReference(s)}Object.defineProperty(e,"ref",{get:n})}function kxe(e,t,n){const i={};i.type="file";const r=n.length;for(let s=0;s<r;s++){const o=n[s];i[o.local]=o.xform(i,t[o.server])}return Mxe(i,e),i}function Rxe(e,t,n){const i=Txe(t);return i===null?null:kxe(e,i,n)}function Dxe(e,t){const n={},i=t.length;for(let r=0;r<i;r++){const s=t[r];s.writable&&(n[s.server]=e[s.local])}return JSON.stringify(n)}class Lxe{constructor(t,n,i,r){this.url=t,this.method=n,this.handler=i,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nxe(e){if(!e)throw oS()}function Oxe(e,t){function n(i,r){const s=Rxe(e,r,t);return Nxe(s!==null),s}return n}function Pxe(e){function t(n,i){let r;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?r=XSe():r=GSe():n.getStatus()===402?r=$Se(e.bucket):n.getStatus()===403?r=jSe(e.path):r=i,r.status=n.getStatus(),r.serverResponse=i.serverResponse,r}return t}function Fxe(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function Bxe(e,t,n){const i=Object.assign({},n);return i.fullPath=e.path,i.size=t.size(),i.contentType||(i.contentType=Fxe(null,t)),i}function zxe(e,t,n,i,r){const s=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let w="";for(let v=0;v<2;v++)w=w+Math.random().toString().slice(2);return w}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=Bxe(t,i,r),d=Dxe(c,n),u="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,f=`\r
--`+l+"--",h=sc.getBlob(u,i,f);if(h===null)throw QSe();const m={name:c.fullPath},p=oxe(s,e.host,e._protocol),U="POST",b=e.maxUploadRetryTime,y=new Lxe(p,U,Oxe(e,n),b);return y.urlParams=m,y.headers=o,y.body=h.uploadData(),y.errorHandler=Pxe(t),y}class Hxe{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ru.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ru.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ru.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,n,i,r){if(this.sent_)throw C1("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,t,!0),r!==void 0)for(const s in r)r.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,r[s].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw C1("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw C1("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw C1("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw C1("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}class Vxe extends Hxe{initXhr(){this.xhr_.responseType="text"}}function $xe(){return new Vxe}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(t,n){this._service=t,n instanceof Kr?this._location=n:this._location=Kr.makeFromUrl(n,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,n){return new Ru(t,n)}get root(){const t=new Kr(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return VK(this._location.path)}get storage(){return this._service}get parent(){const t=Ixe(this._location.path);if(t===null)return null;const n=new Kr(this._location.bucket,t);return new Ru(this._service,n)}_throwIfRoot(t){if(this._location.path==="")throw exe(t)}}function Gxe(e,t,n){e._throwIfRoot("uploadBytes");const i=zxe(e.storage,e._location,Axe(),new sc(t,!0),n);return e.storage.makeRequestWithTokens(i,$xe).then(r=>({metadata:r,ref:e}))}function Xxe(e,t){const n=Sxe(e._location.path,t),i=new Kr(e._location.bucket,n);return new Ru(e.storage,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jxe(e){return/^[A-Za-z]+:\/\//.test(e)}function Yxe(e,t){return new Ru(e,t)}function $K(e,t){if(e instanceof lS){const n=e;if(n._bucket==null)throw qSe();const i=new Ru(n,n._bucket);return t!=null?$K(i,t):i}else return t!==void 0?Xxe(e,t):e}function Wxe(e,t){if(t&&jxe(t)){if(e instanceof lS)return Yxe(e,t);throw Uw("To use ref(service, url), the first argument must be a Storage instance.")}else return $K(e,t)}function pN(e,t){const n=t==null?void 0:t[OK];return n==null?null:Kr.makeFromBucketSpec(n,e)}function Kxe(e,t,n,i={}){e.host=`${t}:${n}`,e._protocol="http";const{mockUserToken:r}=i;r&&(e._overrideAuthToken=typeof r=="string"?r:rW(r,e.app.options.projectId))}class lS{constructor(t,n,i,r,s){this.app=t,this._authProvider=n,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._bucket=null,this._host=NK,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=HSe,this._maxUploadRetryTime=VSe,this._requests=new Set,r!=null?this._bucket=Kr.makeFromBucketSpec(r,this._host):this._bucket=pN(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=Kr.makeFromBucketSpec(this._url,t):this._bucket=pN(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){mN("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){mN("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const n=await t.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(dW(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Ru(this,t)}_makeRequest(t,n,i,r,s=!0){if(this._deleted)return new txe(PK());{const o=gxe(t,this._appId,i,r,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(t,n){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,n,i,r).getPromise()}}const UN="@firebase/storage",bN="0.13.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GK="storage";function XK(e,t,n){return e=po(e),Gxe(e,t,n)}function jK(e,t){return e=po(e),Wxe(e,t)}function Zxe(e=hW(),t){e=po(e);const i=cW(e,GK).getImmediate({identifier:t}),r=nW("storage");return r&&qxe(i,...r),i}function qxe(e,t,n,i={}){Kxe(e,t,n,i)}function Qxe(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return new lS(n,i,r,t,uW)}function Jxe(){Xm(new rg(GK,Qxe,"PUBLIC").setMultipleInstances(!0)),kc(UN,bN,""),kc(UN,bN,"esm2017")}Jxe();let S5;try{S5=JSON.parse('{"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}')}catch{console.warn('Error JSON parsing firebase config. Supplied value: {"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}'),S5={}}let l7=null,c7=null,d7=null;const YK=()=>(l7||(l7=fW(S5)),l7),WK=()=>(c7||(c7=vSe(YK())),c7),eCe=()=>(d7||(d7=Zxe(YK())),d7),KK=async()=>eCe(),tCe=async(e,t)=>{const n=JSON.stringify(t),i=new TextEncoder().encode(n),{encryptedBuffer:r,iv:s}=await Hy(e,i);return{ciphertext:r,iv:s}},bw=async(e,t)=>{const n=e.ciphertext.toUint8Array(),i=e.iv.toUint8Array(),r=await Nm(i,n,t),s=new TextDecoder("utf-8").decode(new Uint8Array(r));return JSON.parse(s)},Dd=class Dd{};F(Dd,"cache",new WeakMap),F(Dd,"get",t=>Dd.cache.get(t)),F(Dd,"set",(t,n)=>{Dd.cache.set(t,ic(n))});let ep=Dd;const ZK=(e,t)=>{if(e.socket&&e.roomId&&e.roomKey){const n=ic(t);return ep.get(e.socket)===n}return!0},cS=async({prefix:e,files:t})=>{const n=await KK(),i=[],r=[];return await Promise.all(t.map(async({id:s,buffer:o})=>{try{const a=jK(n,`${e}/${s}`);await XK(a,o,{cacheControl:`public, max-age=${Nwe}`}),r.push(s)}catch{i.push(s)}})),{savedFiles:r,erroredFiles:i}},yN=async(e,t)=>{const n=ic(e),{ciphertext:i,iv:r}=await tCe(t,e);return{sceneVersion:n,ciphertext:vl.fromUint8Array(new Uint8Array(i)),iv:vl.fromUint8Array(r)}},nCe=async(e,t,n)=>{const{roomId:i,roomKey:r,socket:s}=e;if(!i||!r||!s||ZK(e,t))return null;const o=WK(),a=TK(o,"scenes",i),l=await zSe(o,async d=>{const u=await d.get(a);if(!u.exists()){const U=await yN(t,r);return d.set(a,U),U}const f=u.data(),h=hc(xu(await bw(f,r),null)),m=hc(EI(t,h,n)),p=await yN(m,r);return d.update(a,p),p}),c=hc(xu(await bw(l,r),null));return ep.set(s,c),c},iCe=async(e,t,n)=>{const i=WK(),r=TK(i,"scenes",e),s=await NSe(r);if(!s.exists())return null;const o=s.data(),a=hc(xu(await bw(o,t),null,{deleteInvisibleElements:!0}));return n&&ep.set(n,a),a},qK=async(e,t,n)=>{const i=[],r=new Map;return await Promise.all([...new Set(n)].map(async s=>{try{const o=`https://firebasestorage.googleapis.com/v0/b/${S5.storageBucket}/o/${encodeURIComponent(e.replace(/^\//,""))}%2F${s}`,a=await fetch(`${o}?alt=media`);if(a.status<400){const l=await a.arrayBuffer(),{data:c,metadata:d}=await oX(new Uint8Array(l),{decryptionKey:t}),u=new TextDecoder().decode(c);i.push({mimeType:d.mimeType||Te.binary,id:s,dataURL:u,created:(d==null?void 0:d.created)||Date.now(),lastRetrieved:(d==null?void 0:d.created)||Date.now()})}else r.set(s,!0)}catch(o){r.set(s,!0),console.error(o)}})),{loadedFiles:i,erroredFiles:r}},QK=e=>e.isDeleted?e.updated>Date.now()-Lwe:!tl(e),hc=e=>e.filter(t=>QK(t)),rCe="https://json.excalidraw.com/api/v2/",sCe="https://json.excalidraw.com/api/v2/post/",oCe=async()=>{const e=new Uint8Array(Owe);return window.crypto.getRandomValues(e),XB(e)},JK=/^#room=([a-zA-Z0-9_-]+),([a-zA-Z0-9_-]+)$/,EN=e=>{const t=new URL(e).hash;return JK.test(t)},aCe=e=>{const n=new URL(e).hash.match(JK);return n&&n[2].length!==22?(window.alert(M("alerts.invalidEncryptionKey")),null):n?{roomId:n[1],roomKey:n[2]}:null},lCe=async()=>{const e=await oCe(),t=await DT();if(!t)throw new Error("Couldn't generate room key");return{roomId:e,roomKey:t}},cCe=e=>`${window.location.origin}${window.location.pathname}#room=${e.roomId},${e.roomKey}`,dCe=async({buffer:e,decryptionKey:t})=>{let n;try{const s=e.slice(0,nb),o=e.slice(nb,e.byteLength);n=await Nm(new Uint8Array(s),o,t)}catch{const o=new Uint8Array(nb);n=await Nm(o,e,t)}const i=new window.TextDecoder("utf-8").decode(new Uint8Array(n)),r=JSON.parse(i);return{elements:r.elements||null,appState:r.appState||null}},uCe=async(e,t)=>{try{const n=await fetch(`${rCe}${e}`);if(!n.ok)return window.alert(M("alerts.importBackendFailed")),{};const i=await n.arrayBuffer();try{const{data:r}=await oX(new Uint8Array(i),{decryptionKey:t}),s=JSON.parse(new TextDecoder().decode(r));return{elements:s.elements||null,appState:s.appState||null}}catch(r){return console.warn("error when decoding shareLink data using the new format:",r),dCe({buffer:i,decryptionKey:t})}}catch(n){return window.alert(M("alerts.importBackendFailed")),console.error(n),{}}},vN=async(e,t,n)=>{let i;return e!=null&&t!=null?i=Cu(await uCe(e,t),n==null?void 0:n.appState,n==null?void 0:n.elements,{repairBindings:!0,refreshDimensions:!1,deleteInvisibleElements:!0}):i=Cu(n||null,null,null,{repairBindings:!0,deleteInvisibleElements:!0}),{elements:i.elements,appState:i.appState,files:i.files}},fCe=async(e,t,n)=>{const i=await DT("string"),r=await sX(new TextEncoder().encode(Lg(e,t,n,"database")),{encryptionKey:i});try{const s=new Map;for(const c of e)Dn(c)&&n[c.fileId]&&s.set(c.fileId,n[c.fileId]);const o=await _I({files:s,encryptionKey:i,maxBytes:vI}),l=await(await fetch(sCe,{method:"POST",body:r.buffer})).json();if(l.id){const c=new URL(window.location.href);c.hash=`json=${l.id},${i}`;const d=c.toString();return await cS({prefix:`/files/shareLinks/${l.id}`,files:o}),{url:d,errorMessage:null}}else if(l.error_class==="RequestTooLargeError")return{url:null,errorMessage:M("alerts.couldNotCreateShareableLinkTooBig")};return{url:null,errorMessage:M("alerts.couldNotCreateShareableLink")}}catch(s){return console.error(s),{url:null,errorMessage:M("alerts.couldNotCreateShareableLink")}}};function hCe(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(n){var i=function(){return indexedDB.databases().finally(n)};t=setInterval(i,100),i()}).finally(function(){return clearInterval(t)})}function Ju(e){return new Promise((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)})}function dS(e,t){const n=hCe().then(()=>{const i=indexedDB.open(e);return i.onupgradeneeded=()=>i.result.createObjectStore(t),Ju(i)});return(i,r)=>n.then(s=>r(s.transaction(t,i).objectStore(t)))}let u7;function Bg(){return u7||(u7=dS("keyval-store","keyval")),u7}function gCe(e,t=Bg()){return t("readonly",n=>Ju(n.get(e)))}function eZ(e,t,n=Bg()){return n("readwrite",i=>(i.put(t,e),Ju(i.transaction)))}function mCe(e,t=Bg()){return t("readwrite",n=>(e.forEach(i=>n.put(i[1],i[0])),Ju(n.transaction)))}function pCe(e,t=Bg()){return t("readonly",n=>Promise.all(e.map(i=>Ju(n.get(i)))))}function UCe(e,t=Bg()){return t("readwrite",n=>(n.delete(e),Ju(n.transaction)))}function bCe(e,t){return e("readonly",n=>(n.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Ju(n.transaction)))}function yCe(e=Bg()){const t=[];return bCe(e,n=>t.push([n.key,n.value])).then(()=>t)}class ECe{constructor(){F(this,"locks",new Map);F(this,"lock",t=>{this.locks.set(t,!0)});F(this,"unlock",t=>(this.locks.delete(t),!this.isLocked()))}isLocked(t){return t?this.locks.has(t):!!this.locks.size}}const x5={[Sn.VERSION_DATA_STATE]:-1,[Sn.VERSION_FILES]:-1},wN=e=>JSON.parse(localStorage.getItem(e)||"-1")>x5[e],tZ=e=>{const t=Date.now();try{localStorage.setItem(e,JSON.stringify(t)),x5[e]=t}catch(n){console.error("error while updating browser state verison",n)}},vCe=()=>{try{for(const e of Object.keys(x5))localStorage.setItem(e,JSON.stringify(-1)),x5[e]=-1}catch(e){console.error("error while resetting browser state verison",e)}},j0=dS("files-db","files-store"),gb=Wt(!1);class wCe extends JY{constructor(){super(...arguments);F(this,"clearObsoleteFiles",async n=>{await yCe(j0).then(i=>{for(const[r,s]of i)(!s.lastRetrieved||Date.now()-s.lastRetrieved>24*3600*1e3)&&!n.currentFileIds.includes(r)&&UCe(r,j0)})})}}const _Ce=(e,t)=>{var i;const n=Zs.get(gb);try{const r=lG(t);((i=r.openSidebar)==null?void 0:i.name)===As.name&&r.openSidebar.tab===Qd&&(r.openSidebar=null),localStorage.setItem(Sn.LOCAL_STORAGE_ELEMENTS,JSON.stringify(kH(e))),localStorage.setItem(Sn.LOCAL_STORAGE_APP_STATE,JSON.stringify(r)),tZ(Sn.VERSION_DATA_STATE),n&&Zs.set(gb,!1)}catch(r){console.error(r),TCe(r)&&!n&&Zs.set(gb,!0)}},TCe=e=>e instanceof DOMException&&e.name==="QuotaExceededError",Ii=class Ii{};F(Ii,"_save",ll(async(t,n,i,r)=>{_Ce(t,n),await Ii.fileStorage.saveFiles({elements:t,files:i}),r()},Cwe)),F(Ii,"save",(t,n,i,r)=>{Ii.isSavePaused()||Ii._save(t,n,i,r)}),F(Ii,"flushSave",()=>{Ii._save.flush()}),F(Ii,"locker",new ECe),F(Ii,"pauseSave",t=>{Ii.locker.lock(t)}),F(Ii,"resumeSave",t=>{Ii.locker.unlock(t)}),F(Ii,"isSavePaused",()=>document.hidden||Ii.locker.isLocked()),F(Ii,"fileStorage",new wCe({getFiles(t){return pCe(t,j0).then(async n=>{const i=[],r=new Map,s=[];n.forEach((o,a)=>{const l=t[a];if(o){const c={...o,lastRetrieved:Date.now()};s.push([l,c]),i.push(c)}else r.set(l,!0)});try{mCe(s,j0)}catch(o){console.warn(o)}return{loadedFiles:i,erroredFiles:r}})},async saveFiles({addedFiles:t}){const n=new Map,i=new Map;return tZ(Sn.VERSION_FILES),await Promise.all([...t].map(async([r,s])=>{try{await eZ(r,s,j0),n.set(r,s)}catch(o){console.error(o),i.set(r,s)}})),{savedFiles:n,erroredFiles:i}}}));let Ci=Ii;const Xs=class Xs{static async load(){return await gCe(Xs.key,Xs.store)||null}static save(t){return eZ(Xs.key,t,Xs.store)}};F(Xs,"idb_name",Sn.IDB_LIBRARY),F(Xs,"key","libraryData"),F(Xs,"store",dS(`${Xs.idb_name}-db`,`${Xs.idb_name}-store`));let C5=Xs;class ICe{static load(){const t=localStorage.getItem(Sn.__LEGACY_LOCAL_STORAGE_LIBRARY);if(t!=null){const n=JSON.parse(t);if(n)return{libraryItems:n}}return null}static clear(){localStorage.removeItem(Sn.__LEGACY_LOCAL_STORAGE_LIBRARY)}}const yw=Wt({message:null,nonce:0}),nZ=({collabError:e})=>{const[t,n]=R.useState(!1),i=R.useRef(0);return R.useEffect(()=>(n(!0),i.current=window.setTimeout(()=>{n(!1)},1e3),()=>{window.clearTimeout(i.current)}),[e.message,e.nonce]),e.message?g(Ul,{label:e.message,long:!0,children:g("div",{className:le("collab-errors-button",{"collab-errors-button-shake":t}),children:Vue})}):null};nZ.displayName="CollabError";class SCe{constructor(t){F(this,"collab");F(this,"socket",null);F(this,"socketInitialized",!1);F(this,"roomId",null);F(this,"roomKey",null);F(this,"broadcastedElementVersions",new Map);F(this,"queueFileUpload",zo(async()=>{try{await this.collab.fileManager.saveFiles({elements:this.collab.excalidrawAPI.getSceneElementsIncludingDeleted(),files:this.collab.excalidrawAPI.getFiles()})}catch(i){i.name!=="AbortError"&&this.collab.excalidrawAPI.updateScene({appState:{errorMessage:i.message}})}let t=!1;const n=this.collab.excalidrawAPI.getSceneElementsIncludingDeleted().map(i=>this.collab.fileManager.shouldUpdateImageElementStatus(i)?(t=!0,Ie(i,{status:"saved"})):i);t&&this.collab.excalidrawAPI.updateScene({elements:n,captureUpdate:Z.NEVER})},Mwe));F(this,"broadcastScene",async(t,n,i)=>{if(t===ar.INIT&&!i)throw new Error("syncAll must be true when sending SCENE.INIT");const r=n.reduce((o,a)=>((i||!this.broadcastedElementVersions.has(a.id)||a.version>this.broadcastedElementVersions.get(a.id))&&QK(a)&&o.push(a),o),[]),s={type:t,payload:{elements:r}};for(const o of r)this.broadcastedElementVersions.set(o.id,o.version);this.queueFileUpload(),await this._broadcastSocketData(s)});F(this,"broadcastIdleChange",t=>{var n;if((n=this.socket)!=null&&n.id){const i={type:ar.IDLE_STATUS,payload:{socketId:this.socket.id,userState:t,username:this.collab.state.username}};return this._broadcastSocketData(i,!0)}});F(this,"broadcastMouseLocation",t=>{var n;if((n=this.socket)!=null&&n.id){const i={type:ar.MOUSE_LOCATION,payload:{socketId:this.socket.id,pointer:t.pointer,button:t.button||"up",selectedElementIds:this.collab.excalidrawAPI.getAppState().selectedElementIds,username:this.collab.state.username}};return this._broadcastSocketData(i,!0)}});F(this,"broadcastVisibleSceneBounds",(t,n)=>{var i;if((i=this.socket)!=null&&i.id){const r={type:ar.USER_VISIBLE_SCENE_BOUNDS,payload:{socketId:this.socket.id,username:this.collab.state.username,sceneBounds:t.sceneBounds}};return this._broadcastSocketData(r,!0,n)}});F(this,"broadcastUserFollowed",t=>{var n;(n=this.socket)!=null&&n.id&&this.socket.emit(cb.USER_FOLLOW_CHANGE,t)});this.collab=t}open(t,n,i){return this.socket=t,this.roomId=n,this.roomKey=i,this.socket.on("init-room",()=>{this.socket&&(this.socket.emit("join-room",this.roomId),et("share","room joined"))}),this.socket.on("new-user",async r=>{this.broadcastScene(ar.INIT,this.collab.getSceneElementsIncludingDeleted(),!0)}),this.socket.on("room-user-change",r=>{this.collab.setCollaborators(r)}),t}close(){this.socket&&(this.queueFileUpload.flush(),this.socket.close(),this.socket=null,this.roomId=null,this.roomKey=null,this.socketInitialized=!1,this.broadcastedElementVersions=new Map)}isOpen(){return!!(this.socketInitialized&&this.socket&&this.roomId&&this.roomKey)}async _broadcastSocketData(t,n=!1,i){var r;if(this.isOpen()){const s=JSON.stringify(t),o=new TextEncoder().encode(s),{encryptedBuffer:a,iv:l}=await Hy(this.roomKey,o);(r=this.socket)==null||r.emit(n?cb.SERVER_VOLATILE:cb.SERVER,i??this.roomId,a,l)}}}var xCe={};const iZ=Wt(null),Ew=Wt(!1),rZ=Wt(!1),sZ=Wt(null);class CCe extends R.PureComponent{constructor(n){super(n);F(this,"portal");F(this,"fileManager");F(this,"excalidrawAPI");F(this,"activeIntervalId");F(this,"idleTimeoutId");F(this,"socketInitializationTimer");F(this,"lastBroadcastedOrReceivedSceneVersion",-1);F(this,"collaborators",new Map);F(this,"onUmmount",null);F(this,"onOfflineStatusToggle",()=>{Zs.set(rZ,!window.navigator.onLine)});F(this,"isCollaborating",()=>Zs.get(Ew));F(this,"setIsCollaborating",n=>{Zs.set(Ew,n)});F(this,"onUnload",()=>{this.destroySocketClient({isUnload:!0})});F(this,"beforeUnload",an(n=>{const i=hc(this.getSceneElementsIncludingDeleted());this.isCollaborating()&&(this.fileManager.shouldPreventUnload(i)||!ZK(this.portal,i))&&(this.saveCollabRoomToFirebase(i),xCe.VITE_APP_DISABLE_PREVENT_UNLOAD!=="true"?W_(n):console.warn("preventing unload disabled (VITE_APP_DISABLE_PREVENT_UNLOAD)"))}));F(this,"saveCollabRoomToFirebase",async n=>{try{const i=await nCe(this.portal,n,this.excalidrawAPI.getAppState());this.resetErrorIndicator(),this.isCollaborating()&&i&&this.handleRemoteSceneUpdate(this._reconcileElements(i))}catch(i){const r=/is longer than.*?bytes/.test(i.message)?M("errors.collabSaveFailed_sizeExceeded"):M("errors.collabSaveFailed");(!this.state.dialogNotifiedErrors[r]||!this.isCollaborating())&&(this.setErrorDialog(r),this.setState({dialogNotifiedErrors:{...this.state.dialogNotifiedErrors,[r]:!0}})),this.isCollaborating()&&this.setErrorIndicator(r),console.error(i)}});F(this,"stopCollaboration",(n=!0)=>{if(this.queueBroadcastAllElements.cancel(),this.queueSaveToFirebase.cancel(),this.loadImageFiles.cancel(),this.resetErrorIndicator(!0),this.saveCollabRoomToFirebase(hc(this.excalidrawAPI.getSceneElementsIncludingDeleted())),this.portal.socket&&this.fallbackInitializationHandler&&this.portal.socket.off("connect_error",this.fallbackInitializationHandler),!n)Ci.fileStorage.reset(),this.destroySocketClient();else if(window.confirm(M("alerts.collabStopOverridePrompt"))){vCe(),window.history.pushState({},wc,window.location.origin),this.destroySocketClient(),Ci.fileStorage.reset();const i=this.excalidrawAPI.getSceneElementsIncludingDeleted().map(r=>yt(r)&&r.status==="saved"?Ie(r,{status:"pending"}):r);this.excalidrawAPI.updateScene({elements:i,captureUpdate:Z.NEVER})}});F(this,"destroySocketClient",n=>{this.lastBroadcastedOrReceivedSceneVersion=-1,this.portal.close(),this.fileManager.reset(),n!=null&&n.isUnload||(this.setIsCollaborating(!1),this.setActiveRoomLink(null),this.collaborators=new Map,this.excalidrawAPI.updateScene({collaborators:this.collaborators}),Ci.resumeSave("collaboration"))});F(this,"fetchImageFilesFromFirebase",async n=>{const i=n.elements.filter(r=>Dn(r)&&!this.fileManager.isFileTracked(r.fileId)&&!r.isDeleted&&(n.forceFetchFiles?r.status!=="pending"||Date.now()-r.updated>1e4:r.status==="saved")).map(r=>r.fileId);return await this.fileManager.getFiles(i)});F(this,"decryptPayload",async(n,i,r)=>{try{const s=await Nm(n,i,r),o=new TextDecoder("utf-8").decode(new Uint8Array(s));return JSON.parse(o)}catch(s){return window.alert(M("alerts.decryptFailed")),console.error(s),{type:ar.INVALID_RESPONSE}}});F(this,"fallbackInitializationHandler",null);F(this,"startCollaboration",async n=>{if(this.state.username||ye(()=>import("./random-username.esm-__vdrxyo.js"),__vite__mapDeps([])).then(({getRandomUsername:l})=>{const c=l();this.setUsername(c)}),this.portal.socket)return null;let i,r;n?{roomId:i,roomKey:r}=n:({roomId:i,roomKey:r}=await lCe(),window.history.pushState({},wc,cCe({roomId:i,roomKey:r})));const s=iy();this.setIsCollaborating(!0),Ci.pauseSave("collaboration");const{default:o}=await ye(()=>import("./index-ChGp7972.js"),__vite__mapDeps([])),a=()=>{this.initializeRoom({roomLinkData:n,fetchScene:!0}).then(l=>{s.resolve(l)})};this.fallbackInitializationHandler=a;try{this.portal.socket=this.portal.open(o("https://oss-collab.excalidraw.com",{transports:["websocket","polling"]}),i,r),this.portal.socket.once("connect_error",a)}catch(l){return console.error(l),this.setErrorDialog(l.message),null}if(n)this.excalidrawAPI.resetScene();else{const l=this.excalidrawAPI.getSceneElements().map(c=>yt(c)&&c.status==="saved"?Ie(c,{status:"pending"}):c);this.excalidrawAPI.updateScene({elements:l,captureUpdate:Z.NEVER}),this.saveCollabRoomToFirebase(hc(l))}return this.socketInitializationTimer=window.setTimeout(a,Awe),this.portal.socket.on("client-broadcast",async(l,c)=>{var u;if(!this.portal.roomKey)return;const d=await this.decryptPayload(c,l,this.portal.roomKey);switch(d.type){case ar.INVALID_RESPONSE:return;case ar.INIT:{if(!this.portal.socketInitialized){this.initializeRoom({fetchScene:!1});const f=d.payload.elements,h=this._reconcileElements(f);this.handleRemoteSceneUpdate(h),s.resolve({elements:h,scrollToContent:!0})}break}case ar.UPDATE:this.handleRemoteSceneUpdate(this._reconcileElements(d.payload.elements));break;case ar.MOUSE_LOCATION:{const{pointer:f,button:h,username:m,selectedElementIds:p}=d.payload,U=d.payload.socketId||d.payload.socketID;this.updateCollaborator(U,{pointer:f,button:h,selectedElementIds:p,username:m});break}case ar.USER_VISIBLE_SCENE_BOUNDS:{const{sceneBounds:f,socketId:h}=d.payload,m=this.excalidrawAPI.getAppState();if(((u=m.userToFollow)==null?void 0:u.socketId)!==h){console.warn(`receiving remote client's (from ${h}) viewport bounds even though we're not subscribed to it!`);return}if(m.userToFollow&&m.followedBy.has(m.userToFollow.socketId))return;this.excalidrawAPI.updateScene({appState:gG({appState:m,bounds:f,fitToViewport:!0,viewportZoomFactor:1}).appState});break}case ar.IDLE_STATUS:{const{userState:f,socketId:h,username:m}=d.payload;this.updateCollaborator(h,{userState:f,username:m});break}default:qo(d,null)}}),this.portal.socket.on("first-in-room",async()=>{this.portal.socket&&this.portal.socket.off("first-in-room");const l=await this.initializeRoom({fetchScene:!0,roomLinkData:n});s.resolve(l)}),this.portal.socket.on(cb.USER_FOLLOW_ROOM_CHANGE,l=>{this.excalidrawAPI.updateScene({appState:{followedBy:new Set(l)}}),this.relayVisibleSceneBounds({force:!0})}),this.initializeIdleDetector(),this.setActiveRoomLink(window.location.href),s});F(this,"initializeRoom",async({fetchScene:n,roomLinkData:i})=>{if(clearTimeout(this.socketInitializationTimer),this.portal.socket&&this.fallbackInitializationHandler&&this.portal.socket.off("connect_error",this.fallbackInitializationHandler),n&&i&&this.portal.socket){this.excalidrawAPI.resetScene();try{const r=await iCe(i.roomId,i.roomKey,this.portal.socket);if(r)return this.setLastBroadcastedOrReceivedSceneVersion(ic(r)),{elements:r,scrollToContent:!0}}catch(r){console.error(r)}finally{this.portal.socketInitialized=!0}}else this.portal.socketInitialized=!0;return null});F(this,"_reconcileElements",n=>{const i=this.getSceneElementsIncludingDeleted(),r=this.excalidrawAPI.getAppState(),s=xu(n,null),o=EI(i,s,r);return this.setLastBroadcastedOrReceivedSceneVersion(ic(o)),o});F(this,"loadImageFiles",zo(async()=>{const{loadedFiles:n,erroredFiles:i}=await this.fetchImageFilesFromFirebase({elements:this.excalidrawAPI.getSceneElementsIncludingDeleted()});this.excalidrawAPI.addFiles(n),q1({excalidrawAPI:this.excalidrawAPI,erroredFiles:i,elements:this.excalidrawAPI.getSceneElementsIncludingDeleted()})},kwe));F(this,"handleRemoteSceneUpdate",n=>{this.excalidrawAPI.updateScene({elements:n,captureUpdate:Z.NEVER}),this.loadImageFiles()});F(this,"onPointerMove",()=>{this.idleTimeoutId&&(window.clearTimeout(this.idleTimeoutId),this.idleTimeoutId=null),this.idleTimeoutId=window.setTimeout(this.reportIdle,EA),this.activeIntervalId||(this.activeIntervalId=window.setInterval(this.reportActive,vA))});F(this,"onVisibilityChange",()=>{document.hidden?(this.idleTimeoutId&&(window.clearTimeout(this.idleTimeoutId),this.idleTimeoutId=null),this.activeIntervalId&&(window.clearInterval(this.activeIntervalId),this.activeIntervalId=null),this.onIdleStateChange(Od.AWAY)):(this.idleTimeoutId=window.setTimeout(this.reportIdle,EA),this.activeIntervalId=window.setInterval(this.reportActive,vA),this.onIdleStateChange(Od.ACTIVE))});F(this,"reportIdle",()=>{this.onIdleStateChange(Od.IDLE),this.activeIntervalId&&(window.clearInterval(this.activeIntervalId),this.activeIntervalId=null)});F(this,"reportActive",()=>{this.onIdleStateChange(Od.ACTIVE)});F(this,"initializeIdleDetector",()=>{document.addEventListener(te.POINTER_MOVE,this.onPointerMove),document.addEventListener(te.VISIBILITY_CHANGE,this.onVisibilityChange)});F(this,"updateCollaborator",(n,i)=>{var o;const r=new Map(this.collaborators),s=Object.assign({},r.get(n),i,{isCurrentUser:n===((o=this.portal.socket)==null?void 0:o.id)});r.set(n,s),this.collaborators=r,this.excalidrawAPI.updateScene({collaborators:r})});F(this,"setLastBroadcastedOrReceivedSceneVersion",n=>{this.lastBroadcastedOrReceivedSceneVersion=n});F(this,"getLastBroadcastedOrReceivedSceneVersion",()=>this.lastBroadcastedOrReceivedSceneVersion);F(this,"getSceneElementsIncludingDeleted",()=>this.excalidrawAPI.getSceneElementsIncludingDeleted());F(this,"onPointerUpdate",zo(n=>{n.pointersMap.size<2&&this.portal.socket&&this.portal.broadcastMouseLocation(n)},Dwe));F(this,"relayVisibleSceneBounds",n=>{const i=this.excalidrawAPI.getAppState();this.portal.socket&&(i.followedBy.size>0||n!=null&&n.force)&&this.portal.broadcastVisibleSceneBounds({sceneBounds:eH(i)},`follow@${this.portal.socket.id}`)});F(this,"onIdleStateChange",n=>{this.portal.broadcastIdleChange(n)});F(this,"broadcastElements",n=>{ic(n)>this.getLastBroadcastedOrReceivedSceneVersion()&&(this.portal.broadcastScene(ar.UPDATE,n,!1),this.lastBroadcastedOrReceivedSceneVersion=ic(n),this.queueBroadcastAllElements())});F(this,"syncElements",n=>{this.broadcastElements(n),this.queueSaveToFirebase()});F(this,"queueBroadcastAllElements",zo(()=>{this.portal.broadcastScene(ar.UPDATE,this.excalidrawAPI.getSceneElementsIncludingDeleted(),!0);const n=this.getLastBroadcastedOrReceivedSceneVersion(),i=Math.max(n,ic(this.getSceneElementsIncludingDeleted()));this.setLastBroadcastedOrReceivedSceneVersion(i)},iL));F(this,"queueSaveToFirebase",zo(()=>{this.portal.socketInitialized&&this.saveCollabRoomToFirebase(hc(this.excalidrawAPI.getSceneElementsIncludingDeleted()))},iL,{leading:!1}));F(this,"setUsername",n=>{this.setState({username:n}),Fwe(n)});F(this,"getUsername",()=>this.state.username);F(this,"setActiveRoomLink",n=>{this.setState({activeRoomLink:n}),Zs.set(sZ,n)});F(this,"getActiveRoomLink",()=>this.state.activeRoomLink);F(this,"setErrorIndicator",n=>{Zs.set(yw,{message:n,nonce:Date.now()})});F(this,"resetErrorIndicator",(n=!1)=>{Zs.set(yw,{message:null,nonce:0}),n&&this.setState({dialogNotifiedErrors:{}})});F(this,"setErrorDialog",n=>{this.setState({errorMessage:n})});this.state={errorMessage:null,dialogNotifiedErrors:{},username:YY()||"",activeRoomLink:null},this.portal=new SCe(this),this.fileManager=new JY({getFiles:async i=>{const{roomId:r,roomKey:s}=this.portal;if(!r||!s)throw new Kh;return qK(`files/rooms/${r}`,s,i)},saveFiles:async({addedFiles:i})=>{const{roomId:r,roomKey:s}=this.portal;if(!r||!s)throw new Kh;const{savedFiles:o,erroredFiles:a}=await cS({prefix:`${jY.collabFiles}/${r}`,files:await _I({files:i,encryptionKey:s,maxBytes:vI})});return{savedFiles:o.reduce((l,c)=>{const d=i.get(c);return d&&l.set(c,d),l},new Map),erroredFiles:a.reduce((l,c)=>{const d=i.get(c);return d&&l.set(c,d),l},new Map)}}}),this.excalidrawAPI=n.excalidrawAPI,this.activeIntervalId=null,this.idleTimeoutId=null}componentDidMount(){window.addEventListener(te.BEFORE_UNLOAD,this.beforeUnload),window.addEventListener("online",this.onOfflineStatusToggle),window.addEventListener("offline",this.onOfflineStatusToggle),window.addEventListener(te.UNLOAD,this.onUnload);const n=this.excalidrawAPI.onUserFollow(o=>{this.portal.socket&&this.portal.broadcastUserFollowed(o)}),i=vp(this.relayVisibleSceneBounds),r=this.excalidrawAPI.onScrollChange(()=>i());this.onUmmount=()=>{n(),r()},this.onOfflineStatusToggle();const s={isCollaborating:this.isCollaborating,onPointerUpdate:this.onPointerUpdate,startCollaboration:this.startCollaboration,syncElements:this.syncElements,fetchImageFilesFromFirebase:this.fetchImageFilesFromFirebase,stopCollaboration:this.stopCollaboration,setUsername:this.setUsername,getUsername:this.getUsername,getActiveRoomLink:this.getActiveRoomLink,setCollabError:this.setErrorDialog};Zs.set(iZ,s)}componentWillUnmount(){var n;window.removeEventListener("online",this.onOfflineStatusToggle),window.removeEventListener("offline",this.onOfflineStatusToggle),window.removeEventListener(te.BEFORE_UNLOAD,this.beforeUnload),window.removeEventListener(te.UNLOAD,this.onUnload),window.removeEventListener(te.POINTER_MOVE,this.onPointerMove),window.removeEventListener(te.VISIBILITY_CHANGE,this.onVisibilityChange),this.activeIntervalId&&(window.clearInterval(this.activeIntervalId),this.activeIntervalId=null),this.idleTimeoutId&&(window.clearTimeout(this.idleTimeoutId),this.idleTimeoutId=null),(n=this.onUmmount)==null||n.call(this)}setCollaborators(n){var r;const i=new Map;for(const s of n)i.set(s,Object.assign({},this.collaborators.get(s),{isCurrentUser:s===((r=this.portal.socket)==null?void 0:r.id)}));this.collaborators=i,this.excalidrawAPI.updateScene({collaborators:i})}render(){const{errorMessage:n}=this.state;return g(fe,{children:n!=null&&g(nI,{onClose:()=>this.setErrorDialog(null),children:n})})}}const ACe=(e,t,n,i)=>{e.save(),e.strokeStyle=i,e.beginPath(),e.moveTo(n[0][0]*t,n[0][1]*t),e.lineTo(n[1][0]*t,n[1][1]*t),e.stroke(),e.restore()},MCe=(e,t,[n,i,r,s],o)=>{e.save(),e.strokeStyle=o,e.beginPath(),e.moveTo(n[0]*t,n[1]*t),e.bezierCurveTo(i[0]*t,i[1]*t,r[0]*t,r[1]*t,s[0]*t,s[1]*t),e.stroke(),e.restore()},kCe=(e,t)=>{e.strokeStyle="#888",e.save(),e.beginPath(),e.moveTo(-10*t,-10*t),e.lineTo(10*t,10*t),e.moveTo(10*t,-10*t),e.lineTo(-10*t,10*t),e.stroke(),e.save()},_N=(e,t,n,i,r,s,o)=>{if(Vh(t)){if(!t.fixedPoint){console.warn("Binding must have a fixedPoint");return}const a=n.get(t.elementId),[l,c]=mm(t.fixedPoint,a,n);e.save(),e.strokeStyle=o,e.lineWidth=1,e.beginPath(),e.moveTo(l*i,c*i),e.bezierCurveTo(l*i-r,c*i-s,l*i-r,c*i+s,l*i,c*i),e.stroke(),e.restore()}},TN=(e,t,n,i,r,s,o)=>{if(Vh(e)){const a=n.get(e.elementId);if(!e.fixedPoint){console.warn("Binding must have a fixedPoint");return}const[l,c]=mm(e.fixedPoint,a,n);t.save(),t.strokeStyle=o,t.lineWidth=1,t.beginPath(),t.moveTo(l*i,c*i),t.bezierCurveTo(l*i+r,c*i+s,l*i+r,c*i-s,l*i,c*i),t.stroke(),t.restore()}},RCe=(e,t,n)=>{const i=ve(t),r=16;t.forEach(s=>{var o,a,l,c,d;if(!s.isDeleted){if(Ce(s)){if(s.startBinding){if(!((a=(o=i.get(s.startBinding.elementId))==null?void 0:o.boundElements)!=null&&a.find(u=>u.id===s.id)))return;_N(e,s.startBinding,i,n,r,r,"red")}if(s.endBinding){if(!((c=(l=i.get(s.endBinding.elementId))==null?void 0:l.boundElements)!=null&&c.find(u=>u.id===s.id)))return;_N(e,s.endBinding,i,n,r,r,"red")}}ss(s)&&((d=s.boundElements)!=null&&d.length)&&s.boundElements.forEach(u=>{var h,m;if(u.type!=="arrow")return;const f=i.get(u.id);f&&((h=f.startBinding)==null?void 0:h.elementId)===s.id&&TN(f.startBinding,e,i,n,r,r,"green"),f&&((m=f.endBinding)==null?void 0:m.elementId)===s.id&&TN(f.endBinding,e,i,n,r,r,"green")})}})},IN=(e,t,n)=>{e.forEach(i=>{switch(!0){case Pse(i.data):ACe(t,n.zoom.value,i.data,i.color);break;case Mse(i.data):MCe(t,n.zoom.value,i.data,i.color);break;default:throw new Error(`Unknown element type ${JSON.stringify(i)}`)}})},DCe=(e,t,n,i)=>{var a,l,c,d;const[r,s]=$y(e,i),o=Gy({canvas:e,scale:i,normalizedWidth:r,normalizedHeight:s,viewBackgroundColor:"transparent"});if(o.save(),o.translate(t.scrollX*t.zoom.value,t.scrollY*t.zoom.value),kCe(o,t.zoom.value),RCe(o,n,t.zoom.value),(a=window.visualDebug)!=null&&a.currentFrame&&((l=window.visualDebug)!=null&&l.data)&&window.visualDebug.data.length>0){const[u]=LCe();IN(window.visualDebug.data[u],o,t)}else(c=window.visualDebug)==null||c.data.forEach(u=>{IN(u,o,t)});window.visualDebug&&(window.visualDebug.data=((d=window.visualDebug)==null?void 0:d.data.map(u=>u.filter(f=>f.permanent)))??[])},LCe=()=>{var n,i,r;const e=((n=window.visualDebug)==null?void 0:n.currentFrame)??0,t=((i=window.visualDebug)==null?void 0:i.data.length)??0;return t>0?[e%t,((r=window.visualDebug)==null?void 0:r.currentFrame)??0]:[0,0]},NCe=vp((e,t,n,i)=>{DCe(e,t,n,i)},{trailing:!0}),oZ=()=>{var e;return Array.isArray((e=window.visualDebug)==null?void 0:e.data)},OCe=({onChange:e})=>{const t=R.useCallback(()=>{var s,o;(!((s=window.visualDebug)!=null&&s.currentFrame)||isNaN(((o=window.visualDebug)==null?void 0:o.currentFrame)??-1))&&(window.visualDebug.currentFrame=0),window.visualDebug.currentFrame+=1,e()},[e]),n=R.useCallback(()=>{var s,o,a;(!((s=window.visualDebug)!=null&&s.currentFrame)||isNaN(((o=window.visualDebug)==null?void 0:o.currentFrame)??-1)||((a=window.visualDebug)==null?void 0:a.currentFrame)<1)&&(window.visualDebug.currentFrame=1),window.visualDebug.currentFrame-=1,e()},[e]),i=R.useCallback(()=>{window.visualDebug.currentFrame=void 0,e()},[e]),r=R.useCallback(()=>{window.visualDebug&&(window.visualDebug.currentFrame=void 0,window.visualDebug.data=[]),e()},[e]);return N(fe,{children:[g("button",{className:"ToolIcon_type_button","data-testid":"debug-forward","aria-label":"Move forward",type:"button",onClick:r,children:g("div",{className:"ToolIcon__icon","aria-hidden":"true","aria-disabled":"false",children:Xc})}),g("button",{className:"ToolIcon_type_button","data-testid":"debug-forward","aria-label":"Move forward",type:"button",onClick:n,children:g("div",{className:"ToolIcon__icon","aria-hidden":"true","aria-disabled":"false",children:g(av,{flip:!0})})}),g("button",{className:"ToolIcon_type_button","data-testid":"debug-forward","aria-label":"Move forward",type:"button",onClick:i,children:g("div",{className:"ToolIcon__icon","aria-hidden":"true","aria-disabled":"false",children:ju})}),g("button",{className:"ToolIcon_type_button","data-testid":"debug-backward","aria-label":"Move backward",type:"button",onClick:t,children:g("div",{className:"ToolIcon__icon","aria-hidden":"true","aria-disabled":"false",children:g(av,{})})})]})},PCe=de.forwardRef(({appState:e,scale:t},n)=>{const{width:i,height:r}=e;return g("canvas",{style:{width:i,height:r,position:"absolute",zIndex:2,pointerEvents:"none"},width:i*t,height:r*t,ref:n,children:"Debug Canvas"})}),FCe=()=>{const{t:e}=fn();return g("a",{className:"encrypted-icon tooltip",href:"https://plus.excalidraw.com/blog/end-to-end-encryption",target:"_blank",rel:"noopener","aria-label":e("encrypted.link"),children:g(Ul,{label:e("encrypted.tooltip"),long:!0,children:Wue})})},BCe=de.memo(({onChange:e})=>g(FY,{children:N("div",{style:{display:"flex",gap:".5rem",alignItems:"center"},children:[oZ()&&g(OCe,{onChange:e}),!Mu&&g(FCe,{})]})}));function zCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tp(e){"@babel/helpers - typeof";return tp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tp(e)}function HCe(e,t){if(tp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(tp(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function VCe(e){var t=HCe(e,"string");return tp(t)=="symbol"?t:t+""}function $Ce(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,VCe(i.key),i)}}function GCe(e,t,n){return t&&$Ce(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var aZ=[],XCe=aZ.forEach,jCe=aZ.slice;function YCe(e){return XCe.call(jCe.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e}var SN=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,WCe=function(t,n,i){var r=i||{};r.path=r.path||"/";var s=encodeURIComponent(n),o=t+"="+s;if(r.maxAge>0){var a=r.maxAge-0;if(isNaN(a))throw new Error("maxAge should be a Number");o+="; Max-Age="+Math.floor(a)}if(r.domain){if(!SN.test(r.domain))throw new TypeError("option domain is invalid");o+="; Domain="+r.domain}if(r.path){if(!SN.test(r.path))throw new TypeError("option path is invalid");o+="; Path="+r.path}if(r.expires){if(typeof r.expires.toUTCString!="function")throw new TypeError("option expires is invalid");o+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(o+="; HttpOnly"),r.secure&&(o+="; Secure"),r.sameSite){var l=typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite;switch(l){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return o},xN={create:function(t,n,i,r){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};i&&(s.expires=new Date,s.expires.setTime(s.expires.getTime()+i*60*1e3)),r&&(s.domain=r),document.cookie=WCe(t,encodeURIComponent(n),s)},read:function(t){for(var n=t+"=",i=document.cookie.split(";"),r=0;r<i.length;r++){for(var s=i[r];s.charAt(0)===" ";)s=s.substring(1,s.length);if(s.indexOf(n)===0)return s.substring(n.length,s.length)}return null},remove:function(t){this.create(t,"",-1)}},KCe={name:"cookie",lookup:function(t){var n;if(t.lookupCookie&&typeof document<"u"){var i=xN.read(t.lookupCookie);i&&(n=i)}return n},cacheUserLanguage:function(t,n){n.lookupCookie&&typeof document<"u"&&xN.create(n.lookupCookie,t,n.cookieMinutes,n.cookieDomain,n.cookieOptions)}},ZCe={name:"querystring",lookup:function(t){var n;if(typeof window<"u"){var i=window.location.search;!window.location.search&&window.location.hash&&window.location.hash.indexOf("?")>-1&&(i=window.location.hash.substring(window.location.hash.indexOf("?")));for(var r=i.substring(1),s=r.split("&"),o=0;o<s.length;o++){var a=s[o].indexOf("=");if(a>0){var l=s[o].substring(0,a);l===t.lookupQuerystring&&(n=s[o].substring(a+1))}}}return n}},A1=null,CN=function(){if(A1!==null)return A1;try{A1=window!=="undefined"&&window.localStorage!==null;var t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch{A1=!1}return A1},qCe={name:"localStorage",lookup:function(t){var n;if(t.lookupLocalStorage&&CN()){var i=window.localStorage.getItem(t.lookupLocalStorage);i&&(n=i)}return n},cacheUserLanguage:function(t,n){n.lookupLocalStorage&&CN()&&window.localStorage.setItem(n.lookupLocalStorage,t)}},M1=null,AN=function(){if(M1!==null)return M1;try{M1=window!=="undefined"&&window.sessionStorage!==null;var t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch{M1=!1}return M1},QCe={name:"sessionStorage",lookup:function(t){var n;if(t.lookupSessionStorage&&AN()){var i=window.sessionStorage.getItem(t.lookupSessionStorage);i&&(n=i)}return n},cacheUserLanguage:function(t,n){n.lookupSessionStorage&&AN()&&window.sessionStorage.setItem(n.lookupSessionStorage,t)}},JCe={name:"navigator",lookup:function(t){var n=[];if(typeof navigator<"u"){if(navigator.languages)for(var i=0;i<navigator.languages.length;i++)n.push(navigator.languages[i]);navigator.userLanguage&&n.push(navigator.userLanguage),navigator.language&&n.push(navigator.language)}return n.length>0?n:void 0}},eAe={name:"htmlTag",lookup:function(t){var n,i=t.htmlTag||(typeof document<"u"?document.documentElement:null);return i&&typeof i.getAttribute=="function"&&(n=i.getAttribute("lang")),n}},tAe={name:"path",lookup:function(t){var n;if(typeof window<"u"){var i=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(i instanceof Array)if(typeof t.lookupFromPathIndex=="number"){if(typeof i[t.lookupFromPathIndex]!="string")return;n=i[t.lookupFromPathIndex].replace("/","")}else n=i[0].replace("/","")}return n}},nAe={name:"subdomain",lookup:function(t){var n;if(typeof window<"u"){var i=window.location.href.match(/(?:http[s]*\:\/\/)*(.*?)\.(?=[^\/]*\..{2,5})/gi);i instanceof Array&&(typeof t.lookupFromSubdomainIndex=="number"?n=i[t.lookupFromSubdomainIndex].replace("http://","").replace("https://","").replace(".",""):n=i[0].replace("http://","").replace("https://","").replace(".",""))}return n}};function iAe(){return{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"]}}var lZ=function(){function e(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};zCe(this,e),this.type="languageDetector",this.detectors={},this.init(t,n)}return GCe(e,[{key:"init",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=n,this.options=YCe(i,this.options||{},iAe()),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=r,this.addDetector(KCe),this.addDetector(ZCe),this.addDetector(qCe),this.addDetector(QCe),this.addDetector(JCe),this.addDetector(eAe),this.addDetector(tAe),this.addDetector(nAe)}},{key:"addDetector",value:function(n){this.detectors[n.name]=n}},{key:"detect",value:function(n){var i=this;n||(n=this.options.order);var r=[];return n.forEach(function(s){if(i.detectors[s]){var o=i.detectors[s].lookup(i.options);o&&typeof o=="string"&&(o=[o]),o&&(r=r.concat(o))}}),this.services.languageUtils.getBestMatchFromCodes?r:r.length>0?r[0]:null}},{key:"cacheUserLanguage",value:function(n,i){var r=this;i||(i=this.options.caches),i&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(n)>-1||i.forEach(function(s){r.detectors[s]&&r.detectors[s].cacheUserLanguage(n,r.options)}))}}]),e}();lZ.type="languageDetector";const uS=new lZ;uS.init({languageUtils:{}});const cZ=()=>{var i;const e=uS.detect(),t=Array.isArray(e)?e[0]:e;return(t?(i=Uy.find(r=>r.code.startsWith(t)))==null?void 0:i.code:null)||Xu.code},dZ=Wt(cZ()),rAe=()=>{const[e,t]=Wh(dZ);return R.useEffect(()=>{uS.cacheUserLanguage(e)},[e]),[e,t]},sAe=({style:e})=>{const{t,langCode:n}=fn(),i=H9(dZ);return g("select",{className:"dropdown-select dropdown-select__language",onChange:({target:r})=>i(r.value),value:n,"aria-label":t("buttons.selectLanguage"),style:e,children:Uy.map(r=>g("option",{value:r.code,children:r.label},r.code))})},oAe=de.memo(e=>N(It,{children:[g(It.DefaultItems.LoadScene,{}),g(It.DefaultItems.SaveToActiveFile,{}),g(It.DefaultItems.Export,{}),g(It.DefaultItems.SaveAsImage,{}),e.isCollabEnabled&&g(It.DefaultItems.LiveCollaborationTrigger,{isCollaborating:e.isCollaborating,onSelect:()=>e.onCollabDialogOpen()}),g(It.DefaultItems.CommandPalette,{className:"highlighted"}),g(It.DefaultItems.SearchMenu,{}),g(It.DefaultItems.Help,{}),g(It.DefaultItems.ClearCanvas,{}),g(It.Separator,{}),g(It.ItemLink,{icon:iv,href:"https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=hamburger",className:"",children:"Excalidraw+"}),g(It.DefaultItems.Socials,{}),g(It.ItemLink,{icon:jV,href:`https://app.excalidraw.com${Mu?"":"/sign-up"}?utm_source=signin&utm_medium=app&utm_content=hamburger`,className:"highlighted",children:Mu?"Sign in":"Sign up"}),K_(),g(It.Separator,{}),g(It.DefaultItems.ToggleTheme,{allowSystemTheme:!0,theme:e.theme,onSelect:e.setTheme}),g(It.ItemCustom,{children:g(sAe,{style:{width:"100%"}})}),g(It.DefaultItems.ChangeCanvasBackground,{})]})),aAe=de.memo(e=>{const{t}=fn();let n;return Mu?n=t("welcomeScreen.app.center_heading_plus").split(/(Excalidraw\+)/).map((i,r)=>i==="Excalidraw+"?g("a",{style:{pointerEvents:Td.inheritFromUI},href:"https://app.excalidraw.com?utm_source=excalidraw&utm_medium=app&utm_content=welcomeScreenSignedInUser",children:"Excalidraw+"},r):i):n=t("welcomeScreen.app.center_heading"),N(sr,{children:[g(sr.Hints.MenuHint,{children:t("welcomeScreen.app.menuHint")}),g(sr.Hints.ToolbarHint,{}),g(sr.Hints.HelpHint,{}),N(sr.Center,{children:[g(sr.Center.Logo,{}),g(sr.Center.Heading,{children:n}),N(sr.Center.Menu,{children:[g(sr.Center.MenuItemLoadScene,{}),g(sr.Center.MenuItemHelp,{}),e.isCollabEnabled&&g(sr.Center.MenuItemLiveCollaborationTrigger,{onSelect:()=>e.onCollabDialogOpen()}),!Mu&&g(sr.Center.MenuItemLink,{href:"https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=welcomeScreenGuest",shortcut:null,icon:jV,children:"Sign up"})]})]})]})}),vw=async(e,t,n,i)=>{const r=await KK(),s=`${zB(12)}`,o=await DT(),a=await Hy(o,Lg(e,t,n,"database")),l=new Blob([a.iv,new Uint8Array(a.encryptedBuffer)],{type:Te.binary}),c=jK(r,`/migrations/scenes/${s}`);await XK(c,l,{customMetadata:{data:JSON.stringify({version:2,name:i}),created:Date.now().toString()}});const d=new Map;for(const u of e)Dn(u)&&n[u.fileId]&&d.set(u.fileId,n[u.fileId]);if(d.size){const u=await _I({files:d,encryptionKey:o,maxBytes:vI});await cS({prefix:`/migrations/files/scenes/${s}`,files:u})}window.open(`https://app.excalidraw.com/import?excalidraw=${s},${o}`)},lAe=({elements:e,appState:t,files:n,name:i,onError:r,onSuccess:s})=>{const{t:o}=fn();return N(Wv,{color:"primary",children:[g("div",{className:"Card-icon",children:g(zY,{style:{"--color-logo-icon":"#fff",width:"2.8rem",height:"2.8rem"}})}),g("h2",{children:"Excalidraw+"}),g("div",{className:"Card-details",children:o("exportDialog.excalidrawplus_description")}),g(je,{className:"Card-button",type:"button",title:o("exportDialog.excalidrawplus_button"),"aria-label":o("exportDialog.excalidrawplus_button"),showAriaLabel:!0,onClick:async()=>{try{et("export","eplus",`ui (${wp()})`),await vw(e,t,n,i),s()}catch(a){console.error(a),a.name!=="AbortError"&&r(new Error(o("exportDialog.excalidrawplus_exportError")))}}})]})};class cAe extends de.Component{constructor(){super(...arguments);F(this,"state",{hasError:!1,sentryEventId:"",localStorage:""})}render(){return this.state.hasError?this.errorSplash():this.props.children}componentDidCatch(n,i){const r={};for(const[s,o]of Object.entries({...localStorage}))try{r[s]=JSON.parse(o)}catch{r[s]=o}C_(s=>{s.setExtras(i);const o=R_(n);this.setState(a=>({hasError:!0,sentryEventId:o,localStorage:JSON.stringify(r)}))})}selectTextArea(n){n.target!==document.activeElement&&(n.preventDefault(),n.target.select())}async createGithubIssue(){let n="";try{const i=(await ye(()=>import("./bug-issue-template-BID_ABWq.js"),__vite__mapDeps([]))).default;n=encodeURIComponent(i(this.state.sentryEventId))}catch(i){console.error(i)}window.open(`https://github.com/excalidraw/excalidraw/issues/new?body=${n}`,"_blank","noopener noreferrer")}errorSplash(){return g("div",{className:"ErrorSplash excalidraw",children:N("div",{className:"ErrorSplash-messageContainer",children:[g("div",{className:"ErrorSplash-paragraph bigger align-center",children:g(xr,{i18nKey:"errorSplash.headingMain",button:n=>g("button",{onClick:()=>window.location.reload(),children:n})})}),N("div",{className:"ErrorSplash-paragraph align-center",children:[g(xr,{i18nKey:"errorSplash.clearCanvasMessage",button:n=>g("button",{onClick:()=>{try{localStorage.clear(),window.location.reload()}catch(i){console.error(i)}},children:n})}),g("br",{}),N("div",{className:"smaller",children:[g("span",{role:"img","aria-label":"warning",children:""}),M("errorSplash.clearCanvasCaveat"),g("span",{role:"img","aria-hidden":"true",children:""})]})]}),N("div",{children:[g("div",{className:"ErrorSplash-paragraph",children:M("errorSplash.trackedToSentry",{eventId:this.state.sentryEventId})}),g("div",{className:"ErrorSplash-paragraph",children:g(xr,{i18nKey:"errorSplash.openIssueMessage",button:n=>g("button",{onClick:()=>this.createGithubIssue(),children:n})})}),g("div",{className:"ErrorSplash-paragraph",children:N("div",{className:"ErrorSplash-details",children:[g("label",{children:M("errorSplash.sceneContent")}),g("textarea",{rows:5,onPointerDown:this.selectTextArea,readOnly:!0,value:this.state.localStorage})]})})]})]})})}}const uZ=Wt({isOpen:!1}),dAe=()=>{const e=window.navigator,t=/Apple/.test(e.vendor),n=e.appVersion.indexOf("Win")!==-1;return t?$ue:n?Xue:q9},uAe=({collabAPI:e,activeRoomLink:t,handleClose:n})=>{const{t:i}=fn(),[,r]=R.useState(!1),s=R.useRef(0),o=R.useRef(null),a="share"in navigator,{onCopy:l,copyStatus:c}=iI(),d=async()=>{var f;try{await ud(t)}catch{e.setCollabError(i("errors.copyToSystemClipboardFailed"))}r(!0),s.current&&window.clearTimeout(s.current),s.current=window.setTimeout(()=>{r(!1)},3e3),(f=o.current)==null||f.select()},u=async()=>{try{await navigator.share({title:i("roomDialog.shareTitle"),text:i("roomDialog.shareTitle"),url:t})}catch{}};return N(fe,{children:[g("h3",{className:"ShareDialog__active__header",children:i("labels.liveCollaboration").replace(/\./g,"")}),g(Au,{defaultValue:e.getUsername(),placeholder:"Your name",label:"Your name",onChange:e.setUsername,onKeyDown:f=>f.key===V.ENTER&&n()}),N("div",{className:"ShareDialog__active__linkRow",children:[g(Au,{ref:o,label:"Link",readonly:!0,fullWidth:!0,value:t}),a&&g(Rs,{size:"large",variant:"icon",label:"Share",icon:dAe(),className:"ShareDialog__active__share",onClick:u}),g(Rs,{size:"large",label:i("buttons.copyLink"),icon:Np,status:c,onClick:()=>{d(),l()}})]}),N("div",{className:"ShareDialog__active__description",children:[N("p",{children:[N("span",{role:"img","aria-hidden":"true",className:"ShareDialog__active__description__emoji",children:[""," "]}),i("roomDialog.desc_privacy")]}),g("p",{children:i("roomDialog.desc_exitSession")})]}),g("div",{className:"ShareDialog__active__actions",children:g(Rs,{size:"large",variant:"outlined",color:"danger",label:i("roomDialog.button_stopSession"),icon:Lfe,onClick:()=>{et("share","room closed"),e.stopCollaboration(),e.isCollaborating()||n()}})})]})},fAe=e=>{const{t}=fn(),{collabAPI:n}=e,i=n?N(fe,{children:[g("div",{className:"ShareDialog__picker__header",children:t("labels.liveCollaboration").replace(/\./g,"")}),N("div",{className:"ShareDialog__picker__description",children:[g("div",{style:{marginBottom:"1em"},children:t("roomDialog.desc_intro")}),t("roomDialog.desc_privacy")]}),g("div",{className:"ShareDialog__picker__button",children:g(Rs,{size:"large",label:t("roomDialog.button_startSession"),icon:Dfe,onClick:()=>{et("share","room creation",`ui (${wp()})`),n.startCollaboration(null)}})}),e.type==="share"&&g("div",{className:"ShareDialog__separator",children:g("span",{children:t("shareDialog.or")})})]}):null;return N(fe,{children:[i,e.type==="share"&&N(fe,{children:[g("div",{className:"ShareDialog__picker__header",children:t("exportDialog.link_title")}),g("div",{className:"ShareDialog__picker__description",children:t("exportDialog.link_details")}),g("div",{className:"ShareDialog__picker__button",children:g(Rs,{size:"large",label:t("exportDialog.link_button"),icon:N6,onClick:async()=>{await e.onExportToBackend(),e.handleClose()}})})]})]})},hAe=e=>{const t=ph(sZ);return g(as,{size:"small",onCloseRequest:e.handleClose,title:!1,children:g("div",{className:"ShareDialog",children:e.collabAPI&&t?g(uAe,{collabAPI:e.collabAPI,activeRoomLink:t,handleClose:e.handleClose}):g(fAe,{...e})})})},gAe=e=>{const[t,n]=Wh(uZ),{openDialog:i}=ai();return R.useEffect(()=>{i&&n({isOpen:!1})},[i,n]),t.isOpen?g(hAe,{handleClose:()=>n({isOpen:!1}),collabAPI:e.collabAPI,onExportToBackend:e.onExportToBackend,type:t.type}):null},MN=()=>{var e;return(e=window.matchMedia)==null?void 0:e.call(window,"(prefers-color-scheme: dark)")},mAe=()=>{const[e,t]=R.useState(()=>localStorage.getItem(Sn.LOCAL_STORAGE_THEME)||ke.LIGHT),[n,i]=R.useState(ke.LIGHT);return R.useEffect(()=>{const r=MN(),s=a=>{i(a.matches?ke.DARK:ke.LIGHT)};e==="system"&&(r==null||r.addEventListener("change",s));const o=a=>{!a[V.CTRL_OR_CMD]&&a.altKey&&a.shiftKey&&a.code===it.D&&(a.preventDefault(),a.stopImmediatePropagation(),t(n===ke.DARK?ke.LIGHT:ke.DARK))};return document.addEventListener(te.KEYDOWN,o,{capture:!0}),()=>{r==null||r.removeEventListener("change",s),document.removeEventListener(te.KEYDOWN,o,{capture:!0})}},[e,n,t]),R.useLayoutEffect(()=>{var r;localStorage.setItem(Sn.LOCAL_STORAGE_THEME,e),i(e==="system"?(r=MN())!=null&&r.matches?ke.DARK:ke.LIGHT:e)},[e]),{editorTheme:n,appTheme:e,setAppTheme:t}},pAe=({excalidrawAPI:e})=>N(fe,{children:[g(Twe,{generate:async({frame:t,children:n})=>{const i=e.getAppState(),r=await f8e({elements:n,appState:{...i,exportBackground:!0,viewBackgroundColor:i.viewBackgroundColor},exportingFrame:t,files:e.getFiles(),mimeType:Te.jpg}),s=await TX(r),o=bz(n),a=await fetch("https://oss-ai.excalidraw.com/v1/ai/diagram-to-code/generate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({texts:o,image:s,theme:i.theme})});if(!a.ok){const l=await a.text(),c=coe(l);if(!c)throw new Error(l);if(c.statusCode===429)return{html:`<html>
                <body style="margin: 0; text-align: center">
                <div style="display: flex; align-items: center; justify-content: center; flex-direction: column; height: 100vh; padding: 0 60px">
                  <div style="color:red">Too many requests today,</br>please try again tomorrow!</div>
                  </br>
                  </br>
                  <div>You can also try <a href="https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=d2c" target="_blank" rel="noopener">Excalidraw+</a> to get more requests.</div>
                </div>
                </body>
                </html>`};throw new Error(c.message||l)}try{const{html:l}=await a.json();if(!l)throw new Error("Generation failed (invalid response)");return{html:l}}catch{throw new Error("Generation failed (invalid response)")}}}),g(kY,{onTextSubmit:async t=>{try{const n=await fetch("https://oss-ai.excalidraw.com/v1/ai/text-to-diagram/generate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({prompt:t})}),i=n.headers.has("X-Ratelimit-Limit")?parseInt(n.headers.get("X-Ratelimit-Limit")||"0",10):void 0,r=n.headers.has("X-Ratelimit-Remaining")?parseInt(n.headers.get("X-Ratelimit-Remaining")||"0",10):void 0,s=await n.json();if(!n.ok){if(n.status===429)return{rateLimit:i,rateLimitRemaining:r,error:new Error("Too many requests today, please try again tomorrow!")};throw new Error(s.message||"Generation failed...")}const o=s.generatedResponse;if(!o)throw new Error("Generation failed...");return{generatedResponse:o,rateLimit:i,rateLimitRemaining:r}}catch{throw new Error("Request failed")}}})]}),UAe="REQUEST_SCENE",y2="https://app.excalidraw.com",bAe=async({rawElementsString:e,rawAppStateString:t})=>{if(!e||!t)throw new io("Elements or appstate is missing.");try{const n=JSON.parse(e);if(!n.length)throw new io("Scene is empty, nothing to export.");const i=JSON.parse(t),r=n.reduce((o,a)=>("fileId"in a&&a.fileId&&o.push(a.fileId),o),[]),s=await Ci.fileStorage.getFiles(r);return{type:"SCENE_DATA",elements:n,appState:i,files:s}}catch(n){throw n instanceof io?n:new io("Failed to parse scene data.")}},yAe=async({token:e,publicKey:t})=>{try{const[n,i,r]=e.split(".");if(!n||!i||!r)throw new io("Invalid JWT format");const s=RR(i),o=RR(r),a=`${n}.${i}`,l=Uint8Array.from(o,p=>p.charCodeAt(0)),c=t.replace(/-----\w+ PUBLIC KEY-----/g,""),d=Uint8Array.from(atob(c),p=>p.charCodeAt(0)),u=await crypto.subtle.importKey("spki",d,{name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"},!0,["verify"]);if(!await crypto.subtle.verify("RSASSA-PKCS1-v1_5",u,l,new TextEncoder().encode(a)))throw new Error("Invalid JWT");const h=JSON.parse(s),m=Math.floor(Date.now()/1e3);if(h.exp&&h.exp<m)throw new Error("JWT has expired")}catch(n){throw console.error("Failed to verify JWT:",n),new Error(n instanceof Error?n.message:"Invalid JWT")}},EAe=()=>{const e=R.useRef(!1);return R.useLayoutEffect(()=>{const t=async n=>{if(n.origin!==y2)throw new io("Invalid origin");if(n.data.type===UAe){if(!n.data.jwt)throw new io("JWT is missing");try{try{await yAe({token:n.data.jwt,publicKey:`MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApQ0jM9Qz8TdFLzcuAZZX
/WvuKSOJxiw6AR/ZcE3eFQWM/mbFdhQgyK8eHGkKQifKzH1xUZjCxyXcxW6ZO02t
kPOPxhz+nxUrIoWCD/V4NGmUA1lxwHuO21HN1gzKrN3xHg5EGjyouR9vibT9VDGF
gq6+4Ic/kJX+AD2MM7Yre2+FsOdysrmuW2Fu3ahuC1uQE7pOe1j0k7auNP0y1q53
PrB8Ts2LUpepWC1l7zIXFm4ViDULuyWXTEpUcHSsEH8vpd1tckjypxCwkipfZsXx
iPszy0o0Dx2iArPfWMXlFAI9mvyFCyFC3+nSvfyAUb2C4uZgCwAuyFh/ydPF4DEE
PQIDAQAB`})}catch(r){throw console.error(`Failed to verify JWT: ${r.message}`),new io("Failed to verify JWT")}const i=await bAe({rawAppStateString:localStorage.getItem(Sn.LOCAL_STORAGE_APP_STATE),rawElementsString:localStorage.getItem(Sn.LOCAL_STORAGE_ELEMENTS)});n.source.postMessage(i,{targetOrigin:y2})}catch(i){const r={type:"ERROR",message:i instanceof io?i.message:"Failed to export scene data"};n.source.postMessage(r,{targetOrigin:y2})}}};if(window.addEventListener("message",t),!e.current){e.current=!0;const n={type:"READY"};window.parent.postMessage(n,y2)}return()=>{window.removeEventListener("message",t)}},[]),null},vAe=({isSignedIn:e})=>g("a",{href:e?"https://app.excalidraw.com":"https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=guestBanner#excalidraw-redirect",target:"_blank",rel:"noopener",className:"plus-banner",children:"Excalidraw+"}),kN=({children:e,href:t})=>g("a",{href:t,target:"_blank",rel:"noopener",className:"link-button",children:g(Rs,{children:e})}),wAe=()=>{const{theme:e,openSidebar:t}=ai();return N(s5,{children:[N(s5.TabTriggers,{children:[g(vr.TabTrigger,{tab:"comments",style:{opacity:(t==null?void 0:t.tab)==="comments"?1:.4},children:lhe}),g(vr.TabTrigger,{tab:"presentation",style:{opacity:(t==null?void 0:t.tab)==="presentation"?1:.4},children:che})]}),g(vr.Tab,{tab:"comments",children:N("div",{className:"app-sidebar-promo-container",children:[g("div",{className:"app-sidebar-promo-image",style:{"--image-source":`url(/oss_promo_comments_${e===ke.DARK?"dark":"light"}.jpg)`,opacity:.7}}),g("div",{className:"app-sidebar-promo-text",children:"Make comments with Excalidraw+"}),g(kN,{href:"https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=comments_promo#excalidraw-redirect",children:"Sign up now"})]})}),g(vr.Tab,{tab:"presentation",className:"px-3",children:N("div",{className:"app-sidebar-promo-container",children:[g("div",{className:"app-sidebar-promo-image",style:{"--image-source":`url(/oss_promo_presentations_${e===ke.DARK?"dark":"light"}.svg)`,backgroundSize:"60%",opacity:.4}}),g("div",{className:"app-sidebar-promo-text",children:"Create presentations with Excalidraw+"}),g(kN,{href:"https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=presentations_promo#excalidraw-redirect",children:"Sign up now"})]})})]})};var _Ae={};$Y();window.EXCALIDRAW_THROTTLE_RENDER=!0;let Mf=null;window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),Mf=e});let fZ=!1;if(window.self!==window.top)try{const e=new URL(document.referrer),t=new URL(window.location.href);e.origin===t.origin&&(fZ=!0)}catch{}const RN={title:M("overwriteConfirm.modal.shareableLink.title"),description:g(xr,{i18nKey:"overwriteConfirm.modal.shareableLink.description",bold:e=>g("strong",{children:e}),br:()=>g("br",{})}),actionLabel:M("overwriteConfirm.modal.shareableLink.button"),color:"danger"},ww=async e=>{var c,d;const n=new URLSearchParams(window.location.search).get("id"),i=window.location.hash.match(/^#json=([a-zA-Z0-9_-]+),([a-zA-Z0-9_-]+)$/),r=window.location.hash.match(/^#url=(.*)$/),s=WY();let o=await vN(null,null,s),a=aCe(window.location.href);const l=!!(n||i||a);if(l)if(!o.elements.length||a||await $v(RN))i&&(o=await vN(i[1],i[2],s)),o.scrollToContent=!0,a||window.history.replaceState({},wc,window.location.origin);else{if(document.hidden)return new Promise((u,f)=>{window.addEventListener("focus",()=>ww(e).then(u).catch(f),{once:!0})});a=null,window.history.replaceState({},wc,window.location.origin)}else if(r){window.history.replaceState({},wc,window.location.origin);const u=r[1];try{const f=await fetch(window.decodeURIComponent(u)),h=await BT(await f.blob(),null,null);if(!o.elements.length||await $v(RN))return{scene:h,isExternalScene:l}}catch{return{scene:{appState:{errorMessage:M("alerts.invalidSceneUrl")}},isExternalScene:l}}}if(a&&e.collabAPI){const{excalidrawAPI:u}=e,f=await e.collabAPI.startCollaboration(a);return{scene:{...f,appState:{...bX({...f==null?void 0:f.appState,theme:((c=s==null?void 0:s.appState)==null?void 0:c.theme)||((d=f==null?void 0:f.appState)==null?void 0:d.theme)},u.getAppState()),isLoading:!1},elements:EI((f==null?void 0:f.elements)||[],u.getSceneElementsIncludingDeleted(),u.getAppState())},isExternalScene:!0,id:a.roomId,key:a.roomKey}}else if(o)return l&&i?{scene:o,isExternalScene:l,id:i[1],key:i[2]}:{scene:o,isExternalScene:!1};return{scene:null,isExternalScene:!1}},TAe=()=>{const[e,t]=R.useState(""),n=soe(),{editorTheme:i,appTheme:r,setAppTheme:s}=mAe(),[o,a]=rAe(),l=Nn(),c=R.useRef({promise:null});c.current.promise||(c.current.promise=iy());const d=R.useRef(null);R.useEffect(()=>{et("load","frame",wp()),setTimeout(()=>{et("load","version",S4())},Yre)},[]);const[u,f]=jX(),[,h]=Wh(uZ),[m]=Wh(iZ),[p]=Vwe(Ew,()=>EN(window.location.href)),U=ph(yw);b8e({excalidrawAPI:u,adapter:C5,migrationAdapter:ICe});const[,b]=R.useState(!1);R.useEffect(()=>{},[u]),R.useEffect(()=>{if(!u||!n&&!m)return;const O=(z,G=!1)=>{var j;if(z.scene)if(m!=null&&m.isCollaborating())z.scene.elements&&m.fetchImageFilesFromFirebase({elements:z.scene.elements,forceFetchFiles:!0}).then(({loadedFiles:X,erroredFiles:K})=>{u.addFiles(X),q1({excalidrawAPI:u,erroredFiles:K,elements:u.getSceneElementsIncludingDeleted()})});else{const X=((j=z.scene.elements)==null?void 0:j.reduce((K,ne)=>Dn(ne)?K.concat(ne.fileId):K,[]))||[];z.isExternalScene?qK(`${jY.shareLinkFiles}/${z.id}`,z.key,X).then(({loadedFiles:K,erroredFiles:ne})=>{u.addFiles(K),q1({excalidrawAPI:u,erroredFiles:ne,elements:u.getSceneElementsIncludingDeleted()})}):G&&(X.length&&Ci.fileStorage.getFiles(X).then(({loadedFiles:K,erroredFiles:ne})=>{K.length&&u.addFiles(K),q1({excalidrawAPI:u,erroredFiles:ne,elements:u.getSceneElementsIncludingDeleted()})}),Ci.fileStorage.clearObsoleteFiles({currentFileIds:X}))}};ww({collabAPI:m,excalidrawAPI:u}).then(async z=>{O(z,!0),c.current.promise.resolve(z.scene)});const L=async z=>{z.preventDefault(),Lv()||(m!=null&&m.isCollaborating()&&!EN(window.location.href)&&m.stopCollaboration(!1),u.updateScene({appState:{isLoading:!0}}),ww({collabAPI:m,excalidrawAPI:u}).then(j=>{O(j),j.scene&&u.updateScene({...j.scene,...Cu(j.scene,null,null,{repairBindings:!0}),captureUpdate:Z.IMMEDIATELY})}))},Y=ll(()=>{if(!document.hidden&&(m&&!m.isCollaborating()||n)){if(wN(Sn.VERSION_DATA_STATE)){const z=WY(),G=YY();a(cZ()),u.updateScene({...z,captureUpdate:Z.NEVER}),C5.load().then(j=>{j&&u.updateLibrary({libraryItems:j.libraryItems})}),m==null||m.setUsername(G||"")}if(wN(Sn.VERSION_FILES)){const z=u.getSceneElementsIncludingDeleted(),G=u.getFiles(),j=(z==null?void 0:z.reduce((X,K)=>Dn(K)&&!G[K.fileId]?X.concat(K.fileId):X,[]))||[];j.length&&Ci.fileStorage.getFiles(j).then(({loadedFiles:X,erroredFiles:K})=>{X.length&&u.addFiles(X),q1({excalidrawAPI:u,erroredFiles:K,elements:u.getSceneElementsIncludingDeleted()})})}}},Rwe),$=()=>{Ci.flushSave()},H=z=>{(z.type===te.BLUR||document.hidden)&&Ci.flushSave(),(z.type===te.VISIBILITY_CHANGE||z.type===te.FOCUS)&&Y()};return window.addEventListener(te.HASHCHANGE,L,!1),window.addEventListener(te.UNLOAD,$,!1),window.addEventListener(te.BLUR,H,!1),document.addEventListener(te.VISIBILITY_CHANGE,H,!1),window.addEventListener(te.FOCUS,H,!1),()=>{window.removeEventListener(te.HASHCHANGE,L,!1),window.removeEventListener(te.UNLOAD,$,!1),window.removeEventListener(te.BLUR,H,!1),window.removeEventListener(te.FOCUS,H,!1),document.removeEventListener(te.VISIBILITY_CHANGE,H,!1)}},[n,m,u,a]),R.useEffect(()=>{const O=L=>{Ci.flushSave(),u&&Ci.fileStorage.shouldPreventUnload(u.getSceneElements())&&(_Ae.VITE_APP_DISABLE_PREVENT_UNLOAD!=="true"?W_(L):console.warn("preventing unload disabled (VITE_APP_DISABLE_PREVENT_UNLOAD)"))};return window.addEventListener(te.BEFORE_UNLOAD,O),()=>{window.removeEventListener(te.BEFORE_UNLOAD,O)}},[u]);const y=(O,L,Y)=>{m!=null&&m.isCollaborating()&&m.syncElements(O),Ci.isSavePaused()||Ci.save(O,L,Y,()=>{if(u){let $=!1;const H=u.getSceneElementsIncludingDeleted().map(z=>{if(Ci.fileStorage.shouldUpdateImageElementStatus(z)){const G=Ie(z,{status:"saved"});return G!==z&&($=!0),G}return z});$&&u.updateScene({elements:H,captureUpdate:Z.NEVER})}}),d.current&&u&&NCe(d.current,L,O,window.devicePixelRatio)},[w,v]=R.useState(null),I=async(O,L,Y)=>{if(O.length===0)throw new Error(M("alerts.cannotExportEmptyCanvas"));try{const{url:$,errorMessage:H}=await fCe(O,{...L,viewBackgroundColor:L.exportBackground?L.viewBackgroundColor:sa().viewBackgroundColor},Y);if(H)throw new Error(H);$&&v($)}catch($){if($.name!=="AbortError"){const{width:H,height:z}=L;throw console.error($,{width:H,height:z,devicePixelRatio:window.devicePixelRatio}),new Error($.message)}}},C=(O,L)=>g(Hwe,{setToast:Y=>u.setToast({message:Y}),appState:L,elements:O}),_=ph(rZ),T=ph(gb),k=R.useCallback(()=>h({isOpen:!0,type:"collaborationOnly"}),[h]);if(fZ)return g("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",height:"100%"},children:g("h1",{children:"I'm not a pretzel!"})});const x={label:"Excalidraw+",category:ot.links,predicate:!0,icon:g("div",{style:{width:14},children:iv}),keywords:["plus","cloud","server"],perform:()=>{window.open("https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=command_palette","_blank")}},D={label:"Sign up",category:ot.links,predicate:!0,icon:g("div",{style:{width:14},children:iv}),keywords:["excalidraw","plus","cloud","server","signin","login","signup"],perform:()=>{window.open("https://app.excalidraw.com?utm_source=excalidraw&utm_medium=app&utm_content=command_palette","_blank")}};return g(Kwe,{excalidrawAPI:u,children:g(t_e,{children:g("div",{style:{height:"100%"},className:le("excalidraw-app",{"is-collaborating":p}),children:N(XY,{excalidrawAPI:f,onChange:y,initialData:c.current.promise,isCollaborating:p,onPointerUpdate:m==null?void 0:m.onPointerUpdate,UIOptions:{canvasActions:{toggleTheme:!0,export:{onExportToBackend:I,renderCustomUI:u?(O,L,Y)=>g(lAe,{elements:O,appState:L,files:Y,name:u.getName(),onError:$=>{u==null||u.updateScene({appState:{errorMessage:$.message}})},onSuccess:()=>{u.updateScene({appState:{openDialog:null}})}}):void 0}}},langCode:o,renderCustomStats:C,detectScroll:!1,handleKeyboardGlobally:!0,autoFocus:!0,theme:i,renderTopRightUI:O=>O?null:N("div",{className:"excalidraw-ui-top-right",children:[g(n_e,{}),g(i_e,{}),!n&&m&&N(fe,{children:[(u==null?void 0:u.getEditorInterface().formFactor)==="desktop"&&g(vAe,{isSignedIn:Mu}),U.message&&g(nZ,{collabError:U}),g(BY,{isCollaborating:p,onSelect:()=>h({isOpen:!0,type:"share"}),editorInterface:l})]})]}),onLinkOpen:(O,L)=>{O.link&&hh(O.link)&&(L.preventDefault(),u==null||u.scrollToContent(O.link,{animate:!0}))},children:[g(oAe,{onCollabDialogOpen:k,isCollaborating:p,isCollabEnabled:!n,theme:r,setTheme:O=>s(O),refresh:()=>b(O=>!O)}),g(aAe,{onCollabDialogOpen:k,isCollabEnabled:!n}),N($d,{children:[g($d.Actions.ExportToImage,{}),g($d.Actions.SaveToDisk,{}),u&&g($d.Action,{title:M("overwriteConfirm.action.excalidrawPlus.title"),actionLabel:M("overwriteConfirm.action.excalidrawPlus.button"),onClick:()=>{vw(u.getSceneElements(),u.getAppState(),u.getFiles(),u.getName())},children:M("overwriteConfirm.action.excalidrawPlus.description")})]}),g(BCe,{onChange:()=>u==null?void 0:u.refresh()}),u&&g(pAe,{excalidrawAPI:u}),g(GY,{}),p&&_&&g("div",{className:"alertalert--warning",children:M("alerts.collabOfflineWarning")}),T&&g("div",{className:"alert alert--danger",children:M("alerts.localStorageQuotaExceeded")}),w&&g(xwe,{link:w,onCloseRequest:()=>v(null),setErrorMessage:t}),u&&!n&&g(CCe,{excalidrawAPI:u}),g(gAe,{collabAPI:m,onExportToBackend:async()=>{if(u)try{await I(u.getSceneElements(),u.getAppState(),u.getFiles())}catch(O){t(O.message)}}}),g(wAe,{}),e&&g(nI,{onClose:()=>t(""),children:e}),g(fD,{customCommandPaletteItems:[{label:M("labels.liveCollaboration"),category:ot.app,keywords:["team","multiplayer","share","public","session","invite"],icon:Q9,perform:()=>{h({isOpen:!0,type:"collaborationOnly"})}},{label:M("roomDialog.button_stopSession"),category:ot.app,predicate:()=>!!(m!=null&&m.isCollaborating()),keywords:["stop","session","end","leave","close","exit","collaboration"],perform:()=>{m&&(m.stopCollaboration(),m.isCollaborating()||h({isOpen:!1}))}},{label:M("labels.share"),category:ot.app,predicate:!0,icon:q9,keywords:["link","shareable","readonly","export","publish","snapshot","url","collaborate","invite"],perform:async()=>{h({isOpen:!0,type:"share"})}},{label:"GitHub",icon:K9,category:ot.links,predicate:!0,keywords:["issues","bugs","requests","report","features","social","community"],perform:()=>{window.open("https://github.com/excalidraw/excalidraw","_blank","noopener noreferrer")}},{label:M("labels.followUs"),icon:PV,category:ot.links,predicate:!0,keywords:["twitter","contact","social","community"],perform:()=>{window.open("https://x.com/excalidraw","_blank","noopener noreferrer")}},{label:M("labels.discordChat"),category:ot.links,predicate:!0,icon:OV,keywords:["chat","talk","contact","bugs","requests","report","feedback","suggestions","social","community"],perform:()=>{window.open("https://discord.gg/UexuTaE","_blank","noopener noreferrer")}},{label:"YouTube",icon:YV,category:ot.links,predicate:!0,keywords:["features","tutorials","howto","help","community"],perform:()=>{window.open("https://youtube.com/@excalidraw","_blank","noopener noreferrer")}},...Mu?[{...D,label:"Sign in / Go to Excalidraw+"}]:[x,D],{label:M("overwriteConfirm.action.excalidrawPlus.button"),category:ot.export,icon:Gue,predicate:!0,keywords:["plus","export","save","backup"],perform:()=>{u&&vw(u.getSceneElements(),u.getAppState(),u.getFiles(),u.getName())}},{...fD.defaultItems.toggleTheme,perform:()=>{s(i===ke.DARK?ke.LIGHT:ke.DARK)}},{label:M("labels.installPWA"),category:ot.app,predicate:()=>!!Mf,perform:()=>{Mf&&(Mf.prompt(),Mf.userChoice.then(()=>{Mf=null}))}}]}),oZ()&&u&&g(PCe,{appState:u.getAppState(),scale:window.devicePixelRatio,ref:d})]})})})})},IAe=()=>window.location.pathname==="/excalidraw-plus-export"?g(EAe,{}):g(cAe,{children:g(fue,{store:Zs,children:g(TAe,{})})});window.__EXCALIDRAW_SHA__="";const SAe=document.getElementById("root"),xAe=zJ.createRoot(SAe);$J();xAe.render(g(R.StrictMode,{children:g(IAe,{})}));export{ye as _,Fa as c,wl as g};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/subset-worker.chunk-CVR6pt27.js","assets/subset-shared.chunk-D3ioWSie.js","assets/pica-55E-7_ef.js","assets/_commonjs-dynamic-modules-TDtrdbi3.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
//# sourceMappingURL=index-BhPBoG-n.js.map
